[2;36m[01/12/26 21:22:20][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=272538;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=203284;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp1206wgee[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768252940.57297[0m                                                       [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-poi_poi-full-01_vuln_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m        ]8;id=300749;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=230396;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/12/26 21:25:13][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m Took  ]8;id=325632;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=222914;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m172.75[0m seconds; [33mexception[0m=[3;91mFalse[0m                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN            ]8;id=758112;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=615643;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN           ]8;id=126534;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=900303;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=222109;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=904671;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m172[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=782010;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=185862;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 21:25:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.97[0m seconds;            ]8;id=300689;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=311621;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 21:25:16][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=887923;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=305141;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=702011;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=286928;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=346098;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=345851;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=246433;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=39792;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 21:25:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m1.18[0m seconds;            ]8;id=902300;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=475291;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=251241;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=668697;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 21:25:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.87[0m seconds;            ]8;id=786384;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=568781;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 21:25:24][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=840840;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=658773;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp4763370924388119697/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m             [2m                [0m
[2;36m                    [0m         Entry/..[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1m([0mPOIFSDump.jav[1;92ma:108[0m[1m)[0m              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1m([0mPOIFSDump.jav[1;92ma:80[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1m([0mPOIPOIFSDumpFuzzer.jav[1;92ma:74[0m[1m)[0m    [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ac6e69a60acc10da                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp4763370924388119697/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m             [2m                [0m
[2;36m                    [0m         Entry/..[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1m([0mPOIFSDump.jav[1;92ma:108[0m[1m)[0m              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1m([0mPOIFSDump.jav[1;92ma:80[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1m([0mPOIPOIFSDumpFuzzer.jav[1;92ma:74[0m[1m)[0m    [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ac6e69a60acc10da                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/12/26 21:25:44][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=239898;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=989872;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/12/26 21:29:47][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=838266;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=885764;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/12/26 21:30:44][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=142209;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=180323;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=862889;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=386471;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 21:30:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.98[0m seconds;            ]8;id=531513;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=509935;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 21:30:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Started[33m...[0m                          ]8;id=934153;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=741557;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpaszt1el6[0m                                                 ]8;id=171499;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=377966;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/12/26 21:32:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Took [1;36m120.29[0m seconds;               ]8;id=567195;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=138229;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Started[33m...[0m                    ]8;id=728161;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=413124;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 21:33:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Took [1;36m37.16[0m seconds;          ]8;id=442447;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=102647;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Started[33m...[0m                       ]8;id=992556;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=137336;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 21:33:29][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Took [1;36m5.86[0m seconds;              ]8;id=691397;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=375113;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Started[33m...[0m                           ]8;id=479947;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=547090;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=726445;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=758315;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=141365;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=810410;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 21:33:30][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.87[0m seconds;            ]8;id=890471;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=625634;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 21:33:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=46642;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=712831;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 21:33:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.92[0m seconds;            ]8;id=522477;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=367698;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=444497;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=12146;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 21:33:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.90[0m seconds;            ]8;id=209463;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=831111;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=99357;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=822997;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/poi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.java                     [2m                [0m
[2;36m                    [0m         +++ b/poi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.java                     [2m                [0m
[2;36m                    [0m         @@ [1;36m-42[0m,[1;36m6[0m +[1;36m42[0m,[1;36m57[0m @@                                                                  [2m                [0m
[2;36m                    [0m          public final class POIFSDump [1m{[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              private [1;35mPOIFSDump[0m[1m([0m[1m)[0m [1m{[0m[1m}[0m                                                         [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +    [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         +     * Sanitizes an entry name to prevent path traversal attacks.                  [2m                [0m
[2;36m                    [0m         +     * Removes or replaces characters that could allow escaping the intended       [2m                [0m
[2;36m                    [0m         directory structure.                                                                [2m                [0m
[2;36m                    [0m         +     *                                                                             [2m                [0m
[2;36m                    [0m         +     * @param entryName the entry name from POIFS file                             [2m                [0m
[2;36m                    [0m         +     * @return sanitized name safe for filesystem operations                       [2m                [0m
[2;36m                    [0m         +     *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         +    private static String [1;35msanitizeEntryName[0m[1m([0mString entryName[1m)[0m [1m{[0m                    [2m                [0m
[2;36m                    [0m         +        if [1m([0mentryName == null || [1;35mentryName.trim[0m[1m([0m[1m)[0m[1;35m.isEmpty[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         +            return [32m"unnamed_entry"[0m;                                                [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        String sanitized = [1;35mentryName.trim[0m[1m([0m[1m)[0m;                                       [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Replace path separators                                                 [2m                [0m
[2;36m                    [0m         +        sanitized = [1;35msanitized.replaceAll[0m[1m([0m[32m"[0m[32m[[0m[32m/\\\\[0m[32m][0m[32m"[0m, [32m"_"[0m[1m)[0m;                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Replace relative path components [1m([0m., .., etc[1m)[0m                           [2m                [0m
[2;36m                    [0m         +        sanitized = [1;35msanitized.replaceAll[0m[1m([0m[32m"^\\.+$|^\\.+[0m[32m([0m[32m?=[0m[32m[[0m[32m^.[0m[32m][0m[32m)[0m[32m|[0m[32m([0m[32m?[0m[32m<[0m[32m=[0m[32m[[0m[32m^.[0m[32m][0m[32m)[0m[32m\\.+$"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [32m"_"[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Replace problematic filesystem characters[0m                               [2m                [0m
[2;36m                    [0m         [39m+        sanitized = [0m[1;35msanitized.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Replace control characters[0m                                              [2m                [0m
[2;36m                    [0m         [39m+        sanitized = [0m[1;35msanitized.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m\\p[0m[32m{[0m[32mCntrl[0m[32m}[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m If after sanitization the name is empty, use default[0m                    [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35msanitized.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+            return [0m[32m"unnamed_entry"[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        return sanitized;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[39m**[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m+     * Validates that a file path stays within the intended parent directory.[0m      [2m                [0m
[2;36m                    [0m         [39m+     *[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+     * @param file the file to validate[0m                                            [2m                [0m
[2;36m                    [0m         [39m+     * @param parent the expected parent directory[0m                                 [2m                [0m
[2;36m                    [0m         [39m+     * @throws IOException if the file would be outside the parent directory[0m       [2m                [0m
[2;36m                    [0m         [39m+     *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m+    private static void [0m[1;35mvalidatePath[0m[1;39m([0m[39mFile file, File parent[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [39m+        String canonicalFilePath = [0m[1;35mfile.getCanonicalPath[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m+        String canonicalParentPath = [0m[1;35mparent.getCanonicalPath[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39m![0m[1;35mcanonicalFilePath.startsWith[0m[1;39m([0m[39mcanonicalParentPath + File.separator[0m[1;39m)[0m[39m &&[0m [2m                [0m
[2;36m                    [0m         [39m+            ![0m[1;35mcanonicalFilePath.equals[0m[1;39m([0m[39mcanonicalParentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [39m+            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Security violation: Entry would create path [0m    [2m                [0m
[2;36m                    [0m         [32moutside intended directory structure"[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     public static void [0m[1;35mmain[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m args[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39margs.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-105[0m[39m,[0m[1;36m12[0m[39m +[0m[1;36m156[0m[39m,[0m[1;36m17[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m                 try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m                    bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m-                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m    [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+                String safeName = [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m+                File outputFile = new [0m[1;35mFile[0m[1;39m([0m[39mparent, safeName[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;35mvalidatePath[0m[1;39m([0m[39moutputFile, parent[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m+                try [0m[1;39m([0m[39mOutputStream out = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[1;35moutputFile.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m                     [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [39m                 DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                        [2m                [0m
[2;36m                    [0m         [39m-                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+                String safeName = [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m+                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, safeName[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;35mvalidatePath[0m[1;39m([0m[39mfile, parent[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + file[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp4763370924388119697/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39mEntry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:108[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:80[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIPOIFSDumpFuzzer.jav[0m[1;92ma:74[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: ac6e69a60acc10da[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA critical security vulnerability has been detected in the Apache POI library's [0m    [2m                [0m
[2;36m                    [0m         [39mPOIFSDump functionality. The fuzzer identified a file path traversal vulnerability [0m [2m                [0m
[2;36m                    [0m         [39mthat allows manipulation of file paths to access locations outside the intended [0m    [2m                [0m
[2;36m                    [0m         [39mdirectory structure using path traversal sequences [0m[1;39m([0m[32m"../../../../"[0m[1;39m)[0m[39m. This was [0m      [2m                [0m
[2;36m                    [0m         [39mdiscovered during fuzzing of the POIPOIFSDumpFuzzer with a crafted input that [0m      [2m                [0m
[2;36m                    [0m         [39mtriggered security checks in Jazzer's FilePathTraversal sanitizer.[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue represents a **file path traversal vulnerability** [0m[1;39m([0m[39malso known as [0m        [2m                [0m
[2;36m                    [0m         [39mdirectory traversal or path traversal[0m[1;39m)[0m[39m in the Apache POI codebase. This type of [0m    [2m                [0m
[2;36m                    [0m         [39mvulnerability occurs when an application uses user-supplied input to construct file[0m [2m                [0m
[2;36m                    [0m         [39mpaths without proper validation or sanitization, potentially allowing attackers to [0m [2m                [0m
[2;36m                    [0m         [39maccess files and directories outside the intended scope.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Technical Details[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe stack trace reveals the following execution flow:[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer entry point `[0m[1;35mPOIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` processes a [0m    [2m                [0m
[2;36m                    [0m         [39mmalicious input[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Execution flows through `[0m[1;35mPOIFSDump.main[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m80[0m                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `[0m[1;35mPOIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m108[0m[39m attempts to create or access a file path[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Jazzer's security instrumentation intercepts the operation via [0m                  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mFilePathTraversal.pathFirstArgHook[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m177[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. The path checking logic in `[0m[1;35mFilePathTraversal.checkPath[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m293[0m[39m evaluates[0m [2m                [0m
[2;36m                    [0m         [39mthe constructed path[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Finally, `[0m[1;35mFilePathTraversal.check[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m346[0m[39m detects and raises a critical [0m  [2m                [0m
[2;36m                    [0m         [39msecurity exception[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Malicious Path Construction**: The vulnerable path is [0m                         [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/tmp/expander-tmp4763370924388119697/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39mEntry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m[39m`, which contains the classic path traversal [0m     [2m                [0m
[2;36m                    [0m         [39mpattern `..[0m[35m/../../../[0m[39m` intended to escape the designated directory structure.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Input Structure**: The path construction involves multiple components:[0m         [2m                [0m
[2;36m                    [0m         [39m   - A temporary directory: `[0m[35m/tmp/expander-tmp4763370924388119697/output/[0m[39m`[0m          [2m                [0m
[2;36m                    [0m         [39m   - A structured path: `q/r/s/t/input.bin_dump/`[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - A compound filesystem entry: `Root Entry/`[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - The traversal payload: `..[0m[35m/../../../[0m[95mjazzer-traversal[0m[39m`[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **POIFS Component**: The issue occurs within the POIFS [0m[1;39m([0m[39mPoor Obfuscation [0m        [2m                [0m
[2;36m                    [0m         [39mImplementation Filesystem[0m[1;39m)[0m[39m component, specifically in the POIFSDump utility which [0m  [2m                [0m
[2;36m                    [0m         [39mis designed to extract and dump contents from Microsoft Office files.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Investigation[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a comprehensive understanding of this vulnerability, the following [0m       [2m                [0m
[2;36m                    [0m         [39mcomponents should be examined:[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **POIFSDump.java**:[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m108[0m[39m in the `[0m[1;35mdump[0m[1;39m([0m[1;39m)[0m[39m` method where the vulnerable file operation occurs[0m     [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m80[0m[39m in the `[0m[1;35mmain[0m[1;39m([0m[1;39m)[0m[39m` method to understand the input processing flow[0m         [2m                [0m
[2;36m                    [0m         [39m   - How file paths are constructed from POIFS entry names[0m                          [2m                [0m
[2;36m                    [0m         [39m   - Any existing validation or sanitization logic for entry names[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **POIFS Entry Name Handling**:[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - How entry names [0m[1;39m([0m[39mlike [0m[32m"Root Entry"[0m[1;39m)[0m[39m are extracted from input files[0m             [2m                [0m
[2;36m                    [0m         [39m   - Whether entry names are used directly in file path construction[0m                [2m                [0m
[2;36m                    [0m         [39m   - Any assumptions made about the safety of entry names from parsed files[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **File Path Construction Logic**:[0m                                                [2m                [0m
[2;36m                    [0m         [39m   - All locations where directory paths are combined with entry names[0m              [2m                [0m
[2;36m                    [0m         [39m   - Methods that create output directories or files based on input data[0m            [2m                [0m
[2;36m                    [0m         [39m   - Any path normalization or validation that may be present [0m[1;39m([0m[39mor absent[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Related POIFS Components**:[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - Classes that handle filesystem entries and their naming[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Any other utilities that extract or process POIFS content[0m                      [2m                [0m
[2;36m                    [0m         [39m   - Common path handling utilities used across the POIFS module[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis vulnerability represents a critical security issue as it could allow malicious[0m [2m                [0m
[2;36m                    [0m         [39mOffice documents to cause file operations outside intended boundaries when [0m         [2m                [0m
[2;36m                    [0m         [39mprocessed by POIFSDump or similar utilities.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp4763370924388119697/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39mEntry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:108[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:80[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIPOIFSDumpFuzzer.jav[0m[1;92ma:74[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: ac6e69a60acc10da[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:1[0m[39m-[0m[1;36m27[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.poi.poifs.dev;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:99[0m[39m-[0m[1;36m122[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mentry instanceof DocumentNode[0m[1;39m)[0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                final DocumentNode node = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                final byte[0m[1;39m[[0m[1;39m][0m[39m bytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                   bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mdir, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Skipping unsupported POIFS entry: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mentry[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/Entry.jav[0m[1;92ma:19[0m[39m-[0m[1;36m95[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.poi.poifs.filesystem;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: * This interface provides access to an object managed by a Filesystem[0m           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: * instance. Entry objects are further divided into DocumentEntry and[0m            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: * DirectoryEntry instances.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public interface Entry[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     * get the name of the Entry[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * @return name[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     * is this a DirectoryEntry?[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * @return true if the Entry is a DirectoryEntry, else false[0m                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    public boolean [0m[1;35misDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * is this a DocumentEntry?[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @return true if the Entry is a DocumentEntry, else false[0m                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public boolean [0m[1;35misDocumentEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * get this Entry's parent [0m[1;39m([0m[39mthe DirectoryEntry that owns this[0m                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * Entry[0m[1;39m)[0m[39m. All Entry objects, except the root Entry, has a parent.[0m           [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * @return this Entry's parent; null iff this is the root Entry[0m              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public DirectoryEntry [0m[1;35mgetParent[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * Delete this Entry. This operation should succeed, but there are[0m           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * special circumstances when it will not:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * If this Entry is the root of the Entry tree, it cannot be[0m                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * deleted, as there is no way to create another one.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * If this Entry is a directory, it cannot be deleted unless it is[0m           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * empty.[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @return true if the Entry was successfully deleted, else false[0m            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    public boolean [0m[1;35mdelete[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * Rename this Entry. This operation will fail if:[0m                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     * There is a sibling Entry [0m[1;39m([0m[39mi.e., an Entry whose parent is the[0m              [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * same as this Entry's parent[0m[1;39m)[0m[39m with the same name.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * This Entry is the root of the Entry tree. Its name is dictated[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     * by the Filesystem and many not be changed.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     * @param newName the new name for this Entry[0m                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * @return true if the operation succeeded, else false[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public boolean [0m[1;35mrenameTo[0m[1;39m([0m[39mfinal String newName[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m[1;39m}[0m[39m   [0m[35m/[0m[35m/[0m[39m end public interface Entry[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/DocumentNode.jav[0m[1;92ma:20[0m[39m-[0m[1;36m52[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.poi.poifs.filesystem;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.poi.poifs.dev.POIFSViewable;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.poifs.property.DocumentProperty;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * Simple implementation of DocumentEntry for OPOIFS[0m                             [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:public class DocumentNode[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    extends EntryNode[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    implements DocumentEntry, POIFSViewable[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[35m/[0m[39m underlying POIFSDocument instance[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private POIFSDocument _document;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * create a DocumentNode. This method is not public by design; it[0m            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * is intended strictly for the internal use of this package[0m                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * @param property the DocumentProperty for this DocumentEntry[0m               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * @param parent the parent of this entry[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[1;35mDocumentNode[0m[1;39m([0m[39mfinal DocumentProperty property, final DirectoryNode parent[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mproperty, parent[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        _document = [0m[1;35mproperty.getDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/DocumentNode.jav[0m[1;92ma:163[0m[39m-[0m[1;36m166[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    public String [0m[1;35mgetShortDescription[0m[1;39m([0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        return [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/EntryNode.jav[0m[1;92ma:20[0m[39m-[0m[1;36m66[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.poi.poifs.filesystem;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.poi.poifs.property.Property;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: * Abstract implementation of Entry[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: * Extending classes should override [0m[1;35misDocument[0m[1;39m([0m[1;39m)[0m[39m or [0m[1;35misDirectory[0m[1;39m([0m[1;39m)[0m[39m, as[0m           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: * appropriate[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * Extending classes must override [0m[1;35misDeleteOK[0m[1;39m([0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:public abstract class EntryNode[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    implements Entry[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[35m/[0m[39m the DocumentProperty backing this object[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private Property      _property;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[35m/[0m[35m/[0m[39m this object's parent Entry[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private DirectoryNode _parent;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * create a DocumentNode. This method is not public by design; it[0m            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * is intended strictly for the internal use of extending classes[0m            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param property the Property for this Entry[0m                               [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param parent the parent of this entry[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    protected [0m[1;35mEntryNode[0m[1;39m([0m[39mfinal Property property, final DirectoryNode parent[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        _property = property;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        _parent   = parent;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * grant access to the property[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * @return the property backing this entry[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    protected Property [0m[1;35mgetProperty[0m[1;39m([0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        return _property;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/EntryNode.jav[0m[1;92ma:99[0m[39m-[0m[1;36m102[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        return [0m[1;35m_property.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:18[0m[39m-[0m[1;36m43[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.poifs.property;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.poi.hpsf.ClassID;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.poifs.common.POIFSConstants;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.poifs.dev.POIFSViewable;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.util.ByteField;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.util.IntegerField;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.util.LittleEndianConsts;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.util.ShortField;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * This abstract base class is the ancestor of all classes[0m                       [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: * implementing POIFS Property behavior.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:public abstract class Property implements Child, POIFSViewable [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    static final private byte   _default_fill             = [0m[1;39m([0m[39m byte [0m[1;39m)[0m[39m [0m[1;36m0x00[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    static final private int    _name_size_offset         = [0m[1;36m0x40[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    static final private int    _max_name_length          =[0m                      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        [0m[1;39m([0m[39m_name_size_offset [0m[35m/[0m[39m LittleEndianConsts.SHORT_SIZE[0m[1;39m)[0m[39m - [0m[1;36m1[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:66[0m[39m-[0m[1;36m114[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private String              _name;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private ShortField          _name_size;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private ByteField           _property_type;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    private ByteField           _node_color;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    private IntegerField        _previous_property;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private IntegerField        _next_property;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    private IntegerField        _child_property;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private ClassID             _storage_clsid;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    private IntegerField        _user_flags;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private IntegerField        _seconds_1;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private IntegerField        _days_1;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private IntegerField        _seconds_2;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private IntegerField        _days_2;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    private IntegerField        _start_block;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private IntegerField        _size;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m              _raw_data;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private int                 _index;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    private Child               _next_child;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    private Child               _previous_child;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    protected [0m[1;35mProperty[0m[1;39m([0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        _raw_data = new byte[0m[1;39m[[0m[39m POIFSConstants.PROPERTY_SIZE [0m[1;39m][0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mArrays.fill[0m[1;39m([0m[39m_raw_data, _default_fill[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        _name_size         = new [0m[1;35mShortField[0m[1;39m([0m[39m_name_size_offset[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        _property_type     =[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            new [0m[1;35mByteField[0m[1;39m([0m[39mPropertyConstants.PROPERTY_TYPE_OFFSET[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        _node_color        = new [0m[1;35mByteField[0m[1;39m([0m[39m_node_color_offset[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        _previous_property = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_previous_property_offset,[0m         [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                                              _NO_INDEX, _raw_data[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        _next_property     = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_next_property_offset,[0m             [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:                                              _NO_INDEX, _raw_data[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        _child_property    = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_child_property_offset,[0m            [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                                              _NO_INDEX, _raw_data[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        _storage_clsid     = new [0m[1;35mClassID[0m[1;39m([0m[39m_raw_data,_storage_clsid_offset[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        _user_flags        = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_user_flags_offset, [0m[1;36m0[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        _seconds_1         = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_seconds_1_offset, [0m[1;36m0[0m[39m,[0m             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                                              _raw_data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        _days_1            = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_days_1_offset, [0m[1;36m0[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        _seconds_2         = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_seconds_2_offset, [0m[1;36m0[0m[39m,[0m             [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                                              _raw_data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        _days_2            = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_days_2_offset, [0m[1;36m0[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        _start_block       = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_start_block_offset[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        _size              = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_size_offset, [0m[1;36m0[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        _index             = _NO_INDEX;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        [0m[1;35msetName[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        [0m[1;35msetNextChild[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[1;35msetPreviousChild[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:123[0m[39m-[0m[1;36m162[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    protected [0m[1;35mProperty[0m[1;39m([0m[39mint index, byte [0m[1;39m[[0m[1;39m][0m[39m array, int offset[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        _raw_data          = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39marray, offset, offset + [0m        [2m                [0m
[2;36m                    [0m         [39mPOIFSConstants.PROPERTY_SIZE[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        _name_size         = new [0m[1;35mShortField[0m[1;39m([0m[39m_name_size_offset, _raw_data[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        _property_type     = new [0m                                               [2m                [0m
[2;36m                    [0m         [1;35mByteField[0m[1;39m([0m[39mPropertyConstants.PROPERTY_TYPE_OFFSET, _raw_data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        _node_color        = new [0m[1;35mByteField[0m[1;39m([0m[39m_node_color_offset, _raw_data[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        _previous_property = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_previous_property_offset, [0m       [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        _next_property     = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_next_property_offset, [0m           [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        _child_property    = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_child_property_offset, [0m          [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        _storage_clsid     = new [0m[1;35mClassID[0m[1;39m([0m[39m_raw_data,_storage_clsid_offset[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        _user_flags        = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_user_flags_offset, [0m[1;36m0[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        _seconds_1         = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_seconds_1_offset, _raw_data[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        _days_1            = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_days_1_offset, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        _seconds_2         = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_seconds_2_offset, _raw_data[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        _days_2            = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_days_2_offset, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        _start_block       = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_start_block_offset, _raw_data[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        _size              = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_size_offset, _raw_data[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        _index             = index;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        int name_length = [0m[1;39m([0m[1;35m_name_size.get[0m[1;39m([0m[1;39m)[0m[39m [0m[35m/[0m[39m LittleEndianConsts.SHORT_SIZE[0m[1;39m)[0m[39m - [0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        if [0m[1;39m([0m[39mname_length < [0m[1;36m1[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            _name = [0m[32m""[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            char[0m[1;39m[[0m[1;39m][0m[39m char_array  = new char[0m[1;39m[[0m[39m name_length [0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            int    name_offset = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            for [0m[1;39m([0m[39mint j = [0m[1;36m0[0m[39m; j < name_length; j++[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                char_array[0m[1;39m[[0m[39m j [0m[1;39m][0m[39m = [0m[1;39m([0m[39m char [0m[1;39m)[0m[39m new [0m[1;35mShortField[0m[1;39m([0m[39mname_offset,[0m          [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                                                          _raw_data[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                name_offset     += LittleEndianConsts.SHORT_SIZE;[0m               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            _name = new [0m[1;35mString[0m[1;39m([0m[39mchar_array, [0m[1;36m0[0m[39m, name_length[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        _next_child     = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        _previous_child = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:237[0m[39m-[0m[1;36m240[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:        return _name;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:262[0m[39m-[0m[1;36m286[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    protected void [0m[1;35msetName[0m[1;39m([0m[39mString name[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        char[0m[1;39m[[0m[1;39m][0m[39m char_array = [0m[1;35mname.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        int    limit      = [0m[1;35mMath.min[0m[1;39m([0m[39mchar_array.length, _max_name_length[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:        _name = new [0m[1;35mString[0m[1;39m([0m[39mchar_array, [0m[1;36m0[0m[39m, limit[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:        short offset = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:        int   j      = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        for [0m[1;39m([0m[39m; j < limit; j++[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:            new [0m[1;35mShortField[0m[1;39m([0m[39moffset, [0m[1;39m([0m[39m short [0m[1;39m)[0m[39m char_array[0m[1;39m[[0m[39m j [0m[1;39m][0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            offset += [0m[1;39m([0m[39mshort[0m[1;39m)[0m[39m LittleEndianConsts.SHORT_SIZE;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:        for [0m[1;39m([0m[39m; j < _max_name_length + [0m[1;36m1[0m[39m; j++[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:            new [0m[1;35mShortField[0m[1;39m([0m[39moffset, [0m[1;39m([0m[39m short [0m[1;39m)[0m[39m [0m[1;36m0[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:            offset += [0m[1;39m([0m[39mshort[0m[1;39m)[0m[39m LittleEndianConsts.SHORT_SIZE;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        [0m[35m/[0m[35m/[0m[39m double the count, and include the null at the end[0m                    [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        _name_size[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:            [0m[1;35m.set[0m[1;39m([0m[1;39m([0m[39m short [0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mlimit + [0m[1;36m1[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:                            * LittleEndianConsts.SHORT_SIZE[0m[1;39m)[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/xdgf/util/Util.jav[0m[1;92ma:34[0m[39m-[0m[1;36m36[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static String [0m[1;35msanitizeFilename[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/xdgf/util/Util.jav[0m[1;92ma:1[0m[39m-[0m[1;36m37[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.xdgf.util;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:public class Util [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:    public static int [0m[1;35mcountLines[0m[1;39m([0m[39mString str[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:        int lines = [0m[1;36m1[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        int pos = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        while [0m[1;39m([0m[1;39m([0m[39mpos = [0m[1;35mstr.indexOf[0m[1;39m([0m[32m'\n'[0m[39m, pos[0m[1;39m)[0m[39m + [0m[1;36m1[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:            lines++;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:        return lines;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[35m/[0m[39m this probably isn't [0m[1;36m100[0m[39m% correct, so don't use it in security-sensitive[0m   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[35m/[0m[35m/[0m[39m applications![0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[35m/[0m[39m from: [0m[4;94mhttp://www.rgagnon.com/javadetails/java-0662.html[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static String [0m[1;35msanitizeFilename[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSLister.jav[0m[1;92ma:20[0m[39m-[0m[1;36m30[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.poifs.filesystem.DirectoryNode;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.poifs.filesystem.DocumentNode;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.poifs.filesystem.Entry;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.poifs.filesystem.POIFSFileSystem;[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSLister.jav[0m[1;92ma:79[0m[39m-[0m[1;36m107[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:   public static void [0m[1;35mdisplayDirectory[0m[1;39m([0m[39mDirectoryNode dir, String indent, boolean[0m [2m                [0m
[2;36m                    [0m         [39mwithSizes[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      [0m[1;35mSystem.out.println[0m[1;39m([0m[39mindent + [0m[1;35mdir.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" -"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      String newIndent = indent + [0m[32m"  "[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:      boolean hadChildren = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:      [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mdir.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:         hadChildren = true;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:         Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:         if [0m[1;39m([0m[39mentry instanceof DirectoryNode[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            [0m[1;35mdisplayDirectory[0m[1;39m([0m[1;39m([0m[39mDirectoryNode[0m[1;39m)[0m[39m entry, newIndent, withSizes[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:         [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            DocumentNode doc = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            String name = [0m[1;35mdoc.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            String size = [0m[32m""[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            if [0m[1;39m([0m[1;35mname.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m < [0m[1;36m10[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:               String altname = [0m[32m"[0m[32m([0m[32m0x0"[0m[39m + [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m [0m[1;35mname.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m + [0m[32m"[0m[32m)[0m[32m"[0m[39m + [0m           [2m                [0m
[2;36m                    [0m         [1;35mname.substring[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:               name = [0m[1;35mname.substring[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m + [0m[32m" <"[0m[39m + altname + [0m[32m">"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            if [0m[1;39m([0m[39mwithSizes[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:               size = [0m[32m" [0m[32m[[0m[32m"[0m[39m + [0m[1;35mdoc.getSize[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" / 0x"[0m[39m +[0m                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                      [0m[1;35mInteger.toHexString[0m[1;39m([0m[1;35mdoc.getSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m + [0m[32m"[0m[32m][0m[32m"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;35mSystem.out.println[0m[1;39m([0m[39mnewIndent + name + size[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:         [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:      if [0m[1;39m([0m[39m!hadChildren[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:         [0m[1;35mSystem.out.println[0m[1;39m([0m[39mnewIndent + [0m[32m"[0m[32m([0m[32mno children[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/EntryUtils.jav[0m[1;92ma:19[0m[39m-[0m[1;36m31[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.stream.Collectors;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.stream.StreamSupport;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.hpsf.NoPropertySetStreamException;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.hpsf.PropertySet;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.hpsf.PropertySetFactory;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.util.Internal;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/EntryUtils.jav[0m[1;92ma:37[0m[39m-[0m[1;36m58[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * Copies an Entry into a target POIFS directory, recursively[0m                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Internal[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public static void [0m[1;35mcopyNodeRecursively[0m[1;39m([0m[39m Entry entry, DirectoryEntry target [0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    throws IOException [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        if [0m[1;39m([0m[39m [0m[1;35mentry.isDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            DirectoryEntry dirEntry = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:            DirectoryEntry newTarget = [0m[1;35mtarget.createDirectory[0m[1;39m([0m[39m [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:            [0m[1;35mnewTarget.setStorageClsid[0m[1;39m([0m[39m [0m[1;35mdirEntry.getStorageClsid[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:            Iterator<Entry> entries = [0m[1;35mdirEntry.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            while [0m[1;39m([0m[39m [0m[1;35mentries.hasNext[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                [0m[1;35mcopyNodeRecursively[0m[1;39m([0m[39m [0m[1;35mentries.next[0m[1;39m([0m[1;39m)[0m[39m, newTarget [0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            DocumentEntry dentry = [0m[1;39m([0m[39mDocumentEntry[0m[1;39m)[0m[39m entry;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            DocumentInputStream dstream = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39m dentry [0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            [0m[1;35mtarget.createDocument[0m[1;39m([0m[39m [0m[1;35mdentry.getName[0m[1;39m([0m[1;39m)[0m[39m, dstream [0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:            [0m[1;35mdstream.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/test/java/org/apache/poi/poifs/crypt/tests/TestEncryptor.jav[0m[1;92ma:416[0m[39m-[0m[1;36m427[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:    private void [0m[1;35mlistEntry[0m[1;39m([0m[39mDocumentNode de, String ext, String path[0m[1;39m)[0m[39m throws [0m    [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:        path += [0m[32m"\\" + de.getName[0m[32m([0m[32m)[0m[32m.replaceAll[0m[32m([0m[32m"[0m[1;39m[[0m[39m\\p[0m[1;39m{[0m[39mCntrl[0m[1;39m}[0m[1;39m][0m[32m", "[0m[39m_"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:        [0m[1;35mSystem.out.println[0m[1;39m([0m[39mext+[0m[32m": "[0m[39m+path+[0m[32m" [0m[32m([0m[32m"[0m[39m+[0m[1;35mde.getSize[0m[1;39m([0m[1;39m)[0m[39m+[0m[32m" bytes[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        String name = [0m[1;35mde.getName[0m[1;39m([0m[1;39m)[0m[1;35m.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m\\p[0m[32m{[0m[32mCntrl[0m[32m}[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:        InputStream is = [0m                                                       [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39mDirectoryNode[0m[1;39m)[0m[1;35mde.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.createDocumentInputStream[0m[1;39m([0m[39mde[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:        FileOutputStream fos = new [0m[1;35mFileOutputStream[0m[1;39m([0m[32m"solr."[0m[39m+name+[0m[32m"."[0m[39m+ext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, fos[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:        [0m[1;35mfos.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:        [0m[1;35mis.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/test/java/org/apache/poi/poifs/dev/TestPOIFSDump.jav[0m[1;92ma:1[0m[39m-[0m[1;36m49[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.poi.poifs.dev;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;[0m               [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import static org.junit.jupiter.api.Assertions.assertNotNull;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import static org.junit.jupiter.api.Assertions.assertThrows;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static org.junit.jupiter.api.Assertions.assertTrue;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.FileInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.FileNotFoundException;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.PrintStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.UnsupportedEncodingException;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.security.Permission;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.commons.io.output.NullPrintStream;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.poi.POITestCase;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.poi.hssf.HSSFTestDataSamples;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.poi.poifs.filesystem.NotOLE2FileException;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.poi.poifs.filesystem.OfficeXmlFileException;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.poi.poifs.filesystem.POIFSFileSystem;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.poi.poifs.property.PropertyTable;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.poi.util.SuppressForbidden;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.poi.util.TempFile;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.junit.jupiter.api.AfterAll;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.junit.jupiter.api.AfterEach;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.junit.jupiter.api.Assumptions;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.junit.jupiter.api.BeforeAll;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.junit.jupiter.api.Test;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/test/java/org/apache/poi/poifs/dev/TestPOIFSDump.jav[0m[1;92ma:140[0m[39m-[0m[1;36m161[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    void [0m[1;35mtestMain[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        Path tmpDir = [0m[1;35mFiles.createTempDirectory[0m[1;39m([0m[32m"poi-dump-tst-"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:            Path tmpFile = [0m[1;35mtmpDir.resolve[0m[1;39m([0m[32m"46515.xls"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            [0m[1;35mFiles.copy[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mTEST_FILE[0m[1;39m)[0m[39m, tmpFile[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            [0m[1;35mPOIFSDump.main[0m[1;39m([0m[39mnew String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;35mtmpFile.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            File f = [0m[1;35mtmpFile.toFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            File dump = new [0m[1;35mFile[0m[1;39m([0m[1;35mf.getParent[0m[1;39m([0m[1;39m)[0m[39m, [0m[32m"46515.xls_dump"[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[1;35massertTrue[0m[1;39m([0m[1;35mdump.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            File root = new [0m[1;35mFile[0m[1;39m([0m[39mdump, [0m[32m"Root Entry"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;35massertTrue[0m[1;39m([0m[1;35mroot.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            File compObj = new [0m[1;35mFile[0m[1;39m([0m[39mroot, [0m[32m"CompObj"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            [0m[1;35massertTrue[0m[1;39m([0m[1;35mcompObj.isFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            for [0m[1;39m([0m[39mString option : DUMP_[0m[1;33mOPTIONS[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                [0m[1;35massertDoesNotThrow[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;35mPOIFSDump.main[0m[1;39m([0m[39mnew String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[39moption,[0m    [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                        [0m[1;35mf.getAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            [0m[1;35mforceDelete[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/test/java/org/apache/poi/poifs/dev/TestPOIFSDump.jav[0m[1;92ma:202[0m[39m-[0m[1;36m219[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:    void [0m[1;35mtestFailToWrite[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:        File dir = [0m[1;35mTempFile.createTempFile[0m[1;39m([0m[32m"TestPOIFSDump"[0m[39m, [0m[32m".tst"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mdir.exists[0m[1;39m([0m[1;39m)[0m[39m, [0m[32m"Had: "[0m[39m + dir[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mdir.delete[0m[1;39m([0m[1;39m)[0m[39m, [0m[32m"Had: "[0m[39m + dir[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mdir.mkdirs[0m[1;39m([0m[1;39m)[0m[39m, [0m[32m"Had: "[0m[39m + dir[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:        FileInputStream is = new [0m[1;35mFileInputStream[0m[1;39m([0m[39mTEST_FILE[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        POIFSFileSystem fs = new [0m[1;35mPOIFSFileSystem[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        [0m[1;35mis.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        PropertyTable props = [0m[1;35mfs.getPropertyTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[39mprops[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        [0m[35m/[0m[35m/[0m[39m try with an invalid startBlock to trigger an exception[0m               [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        [0m[35m/[0m[35m/[0m[39m to validate that file-handles are closed properly[0m                    [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:        [0m[1;35massertThrows[0m[1;39m([0m[39mIndexOutOfBoundsException.class, [0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;35mPOIFSDump.dump[0m[1;39m([0m[39mfs, [0m [2m                [0m
[2;36m                    [0m         [1;36m999999999[0m[39m, [0m[32m"mini-stream"[0m[39m, dir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:46[0m[39m-[0m[1;36m97[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public static void [0m[1;35mmain[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m args[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        if [0m[1;39m([0m[39margs.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Must specify at least one file to dump"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        boolean dumpProps = false, dumpMini = false;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        for [0m[1;39m([0m[39mString filename : args[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            if [0m[1;39m([0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dumprops"[0m[1;39m)[0m[39m ||[0m                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-props"[0m[1;39m)[0m[39m ||[0m                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-properties"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:                dumpProps = true;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:                continue;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            if [0m[1;39m([0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dumpmini"[0m[1;39m)[0m[39m ||[0m                        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-mini"[0m[1;39m)[0m[39m ||[0m                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-ministream"[0m[1;39m)[0m[39m ||[0m             [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-mini-stream"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:                dumpMini = true;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                continue;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                 POIFSFileSystem fs = new [0m[1;35mPOIFSFileSystem[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                DirectoryEntry root = [0m[1;35mfs.getRoot[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                String filenameWithoutPath = new [0m[1;35mFile[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                File dumpDir =[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                        [0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                                [0m[1;35m.resolve[0m[1;39m([0m[39mfilenameWithoutPath + [0m                  [2m                [0m
[2;36m                    [0m         [32m"_dump"[0m[1;39m)[0m[1;35m.toFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + file[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mroot, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                if [0m[1;39m([0m[39mdumpProps[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                    HeaderBlock header = [0m[1;35mfs.getHeaderBlock[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    [0m[1;35mdump[0m[1;39m([0m[39mfs, [0m[1;35mheader.getPropertyStart[0m[1;39m([0m[1;39m)[0m[39m, [0m[32m"properties"[0m[39m, file[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                if [0m[1;39m([0m[39mdumpMini[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                    PropertyTable props = [0m[1;35mfs.getPropertyTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    int startBlock = [0m[1;35mprops.getRoot[0m[1;39m([0m[1;39m)[0m[1;35m.getStartBlock[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                    if [0m[1;39m([0m[39mstartBlock == POIFSConstants.END_OF_CHAIN[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                        [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"No Mini Stream in file"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                        [0m[1;35mdump[0m[1;39m([0m[39mfs, startBlock, [0m[32m"mini-stream"[0m[39m, file[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/test/java/org/apache/poi/util/TestThreadLocalTempFile.jav[0m[1;92ma:36[0m[39m-[0m[1;36m46[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    @[0m[1;35mRepeatedTest[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m [0m[35m/[0m[35m/[0m[39m Repeat it to ensure testing the case[0m                     [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    void [0m[1;35mtestThreadLocalStrategy[0m[1;39m([0m[39m@TempDir Path tmpDir[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        Path rootDir = [0m[1;35mtmpDir.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        Path globalTmpDir = [0m[1;35mrootDir.resolve[0m[1;39m([0m[32m"global-tmp-dir"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        Path localTmpDir1 = [0m[1;35mrootDir.resolve[0m[1;39m([0m[32m"local-tmp-dir1"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        Path localTmpDir2 = [0m[1;35mrootDir.resolve[0m[1;39m([0m[32m"local-tmp-dir2"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        [0m[1;35mTempFile.setTempFileCreationStrategy[0m[1;39m([0m[39mnew [0m                                [2m                [0m
[2;36m                    [0m         [1;35mDefaultTempFileCreationStrategy[0m[1;39m([0m[1;35mglobalTmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        [0m[1;35massertTempFileIn[0m[1;39m([0m[39mglobalTmpDir[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        String result = [0m[1;35mTempFile.withStrategy[0m[1;39m([0m[39mnew [0m                               [2m                [0m
[2;36m                    [0m         [1;35mDefaultTempFileCreationStrategy[0m[1;39m([0m[1;35mlocalTmpDir1.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, [0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:123[0m[39m-[0m[1;36m139[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mPOIFSFileSystem fs, int startBlock, String name, [0m   [2m                [0m
[2;36m                    [0m         [39mFile parent[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, name[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            POIFSStream stream = new [0m[1;35mPOIFSStream[0m[1;39m([0m[39mfs, startBlock[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m b = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[1;35mfs.getBigBlockSize[0m[1;39m([0m[1;39m)[0m[39m, [0m            [2m                [0m
[2;36m                    [0m         [1;35mPOIFSFileSystem.getMaxRecordLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            for [0m[1;39m([0m[39mByteBuffer bb : stream[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                int len = [0m[1;35mbb.remaining[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                [0m[1;35mbb.get[0m[1;39m([0m[39mb[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                [0m[1;35mout.write[0m[1;39m([0m[39mb, [0m[1;36m0[0m[39m, len[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:99[0m[39m-[0m[1;36m122[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mentry instanceof DocumentNode[0m[1;39m)[0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                final DocumentNode node = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                final byte[0m[1;39m[[0m[1;39m][0m[39m bytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                   bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mdir, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Skipping unsupported POIFS entry: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mentry[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/xdgf/util/Util.jav[0m[1;92ma:31[0m[39m-[0m[1;36m36[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[35m/[0m[39m this probably isn't [0m[1;36m100[0m[39m% correct, so don't use it in security-sensitive[0m   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[35m/[0m[35m/[0m[39m applications![0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[35m/[0m[39m from: [0m[4;94mhttp://www.rgagnon.com/javadetails/java-0662.html[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static String [0m[1;35msanitizeFilename[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/test/java/org/apache/poi/poifs/crypt/tests/TestEncryptor.jav[0m[1;92ma:416[0m[39m-[0m[1;36m427[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:    private void [0m[1;35mlistEntry[0m[1;39m([0m[39mDocumentNode de, String ext, String path[0m[1;39m)[0m[39m throws [0m    [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:        path += [0m[32m"\\" + de.getName[0m[32m([0m[32m)[0m[32m.replaceAll[0m[32m([0m[32m"[0m[1;39m[[0m[39m\\p[0m[1;39m{[0m[39mCntrl[0m[1;39m}[0m[1;39m][0m[32m", "[0m[39m_"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:        [0m[1;35mSystem.out.println[0m[1;39m([0m[39mext+[0m[32m": "[0m[39m+path+[0m[32m" [0m[32m([0m[32m"[0m[39m+[0m[1;35mde.getSize[0m[1;39m([0m[1;39m)[0m[39m+[0m[32m" bytes[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        String name = [0m[1;35mde.getName[0m[1;39m([0m[1;39m)[0m[1;35m.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m\\p[0m[32m{[0m[32mCntrl[0m[32m}[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:        InputStream is = [0m                                                       [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39mDirectoryNode[0m[1;39m)[0m[1;35mde.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.createDocumentInputStream[0m[1;39m([0m[39mde[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:        FileOutputStream fos = new [0m[1;35mFileOutputStream[0m[1;39m([0m[32m"solr."[0m[39m+name+[0m[32m"."[0m[39m+ext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, fos[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:        [0m[1;35mfos.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:        [0m[1;35mis.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:17[0m[39m-[0m[1;36m44[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.poi.poifs.dev;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.poifs.common.POIFSConstants;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.poifs.filesystem.DirectoryEntry;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.poifs.filesystem.DocumentInputStream;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.poifs.filesystem.DocumentNode;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.poifs.filesystem.Entry;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.poi.poifs.filesystem.POIFSFileSystem;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.poi.poifs.filesystem.POIFSStream;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.poi.poifs.property.PropertyTable;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.poi.poifs.storage.HeaderBlock;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.poi.util.IOUtils;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: * Dump internal structure of a OLE2 file into file system[0m                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:public final class POIFSDump [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    private [0m[1;35mPOIFSDump[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:99[0m[39m-[0m[1;36m122[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mentry instanceof DocumentNode[0m[1;39m)[0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                final DocumentNode node = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                final byte[0m[1;39m[[0m[1;39m][0m[39m bytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                   bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mdir, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Skipping unsupported POIFS entry: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mentry[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Analysis of Code Snippets and Vulnerability[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Root Cause Identification:**[0m                                                      [2m                [0m
[2;36m                    [0m         [39mThe vulnerability exists in `[0m[1;35mPOIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m` method at lines [0m[1;36m108[0m[39m and [0m[1;36m113[0m[39m, where [0m  [2m                [0m
[2;36m                    [0m         [39muntrusted entry names from parsed POIFS files are used directly to construct [0m       [2m                [0m
[2;36m                    [0m         [39mfilesystem paths without any validation or sanitization:[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Line [0m[1;36m108[0m[39m**: `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m` - Only applies `[0m[1;35mtrim[0m[1;39m([0m[1;39m)[0m[39m`, [0m [2m                [0m
[2;36m                    [0m         [39mno path traversal protection[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- **Line [0m[1;36m113[0m[39m**: `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m` - No sanitization at all[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Attack Vector:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mMalicious POIFS files can contain entry names with path traversal sequences [0m[1;39m([0m[39me.g., [0m [2m                [0m
[2;36m                    [0m         [39m`..[0m[35m/../../../[0m[95mjazzer-traversal[0m[39m`[0m[1;39m)[0m[39m that escape the intended dump directory structure.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Critical Logic to Preserve:**[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Recursive dumping of POIFS directory structure[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Creation of files for DocumentNode entries[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Creation of directories for DirectoryEntry entries[0m                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Error handling for directory creation failures[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Support for the existing test cases and expected directory structure[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Existing Sanitization Patterns in Codebase:**[0m                                     [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mUtil.sanitizeFilename[0m[1;39m([0m[1;39m)[0m[39m`: Uses `[0m[1;35mreplaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m` but [0m         [2m                [0m
[2;36m                    [0m         [39mexplicitly marked as insufficient for security[0m                                      [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mTestEncryptor.listEntry[0m[1;39m([0m[1;39m)[0m[39m`: Uses `[0m[1;35mreplaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m\\p[0m[32m{[0m[32mCntrl[0m[32m}[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m` but doesn't [0m  [2m                [0m
[2;36m                    [0m         [39mprevent path traversal[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- Both patterns are inadequate for preventing path traversal attacks[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Fix Strategy Implementation[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1[0m[39m: Create a Secure Path Sanitization Method**[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd a new private static method to `POIFSDump.java` that properly sanitizes entry [0m  [2m                [0m
[2;36m                    [0m         [39mnames to prevent path traversal:[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mprivate static String [0m[1;35msanitizeEntryName[0m[1;39m([0m[39mString entryName[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis method should:[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Replace all path separator characters [0m[1;39m([0m[39m`[0m[35m/[0m[39m`, `\`[0m[1;39m)[0m[39m with underscores[0m                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Replace or remove relative path components [0m[1;39m([0m[39m`.`, `..`[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Replace any remaining problematic characters that could cause issues[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Preserve meaningful characters that represent the original entry name[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Handle edge cases [0m[1;39m([0m[39mnull, empty strings, names with only problematic characters[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Sanitization Logic:**[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- Remove leading/trailing whitespace with `[0m[1;35mtrim[0m[1;39m([0m[1;39m)[0m[39m`[0m                                  [2m                [0m
[2;36m                    [0m         [39m- Replace path separators: `[0m[1;35mreplaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m/\\\\[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m`[0m                             [2m                [0m
[2;36m                    [0m         [39m- Replace relative path components: [0m                                                [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mreplaceAll[0m[1;39m([0m[32m"^\\.+$|^\\.+[0m[32m([0m[32m?=[0m[32m[[0m[32m^.[0m[32m][0m[32m)[0m[32m|[0m[32m([0m[32m?<=[0m[32m[[0m[32m^.[0m[32m][0m[32m)[0m[32m\\.+$"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m`[0m                            [2m                [0m
[2;36m                    [0m         [39m- Replace other problematic filesystem characters: `[0m[1;35mreplaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [32m"_"[0m[1;39m)[0m[39m`[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- Replace control characters: `[0m[1;35mreplaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m\\p[0m[32m{[0m[32mCntrl[0m[32m}[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m`[0m                     [2m                [0m
[2;36m                    [0m         [39m- Ensure the result is not empty; if empty after sanitization, use a default name [0m  [2m                [0m
[2;36m                    [0m         [39mlike [0m[32m"unnamed_entry"[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m2[0m[39m: Apply Sanitization in [0m[1;35mdump[0m[1;39m([0m[1;39m)[0m[39m Method**[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mModify `[0m[1;35mPOIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m` method at lines [0m[1;36m99[0m[39m-[0m[1;36m122[0m[39m:[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For DocumentNode [0m[1;39m([0m[39maround line [0m[1;36m108[0m[1;39m)[0m[39m:**[0m                                             [2m                [0m
[2;36m                    [0m         [39m- Replace: `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[39m`[0m                       [2m                [0m
[2;36m                    [0m         [39m- With: `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[39m`[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For DirectoryEntry [0m[1;39m([0m[39maround line [0m[1;36m113[0m[1;39m)[0m[39m:**[0m                                           [2m                [0m
[2;36m                    [0m         [39m- Replace: `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m`[0m                                      [2m                [0m
[2;36m                    [0m         [39m- With: `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m`[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m3[0m[39m: Add Path Validation**[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter constructing the File object with sanitized name, validate that the resulting[0m [2m                [0m
[2;36m                    [0m         [39mpath stays within the intended parent directory:[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Validation Logic [0m[1;39m([0m[39mto be added after File construction[0m[1;39m)[0m[39m:**[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Get the canonical path of the constructed file[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Get the canonical path of the parent directory[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Verify that the file's canonical path starts with the parent's canonical path[0m    [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. If validation fails, throw an IOException with a descriptive error message[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis ensures defense-in-depth: even if sanitization misses an edge case, the path [0m  [2m                [0m
[2;36m                    [0m         [39mvalidation will catch attempts to escape the parent directory.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m4[0m[39m: Integration Points**[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe changes should be made to:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- `poi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.java` at lines [0m[1;36m99[0m[39m-[0m[1;36m122[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd the sanitization method before the existing methods [0m[1;39m([0m[39me.g., after line [0m[1;36m44[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39mbefore line [0m[1;36m46[0m[1;39m)[0m[39m.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Justification and Impact Analysis[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why This Approach is Optimal:**[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Minimal Code Changes**: Only modifies POIFSDump.java, no changes to core POIFS[0m [2m                [0m
[2;36m                    [0m         [39mclasses or Entry interfaces[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Defense in Depth**: Combines sanitization with path validation for maximum [0m    [2m                [0m
[2;36m                    [0m         [39msecurity[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Backward Compatible**: Legitimate entry names remain readable, only malicious [0m [2m                [0m
[2;36m                    [0m         [39mpatterns are neutralized[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserves Functionality**: The dump structure and file hierarchy remain the [0m   [2m                [0m
[2;36m                    [0m         [39msame for valid files[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **No External Dependencies**: Uses only standard Java APIs [0m[1;39m([0m[39mString.replaceAll, [0m  [2m                [0m
[2;36m                    [0m         [39mFile.getCanonicalPath[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Preserves Existing Logic:**[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The recursive dumping logic remains unchanged[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. File and directory creation flow is preserved[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Error handling for directory creation is maintained[0m                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. The test expectations [0m[1;39m([0m[39msubdirectories like [0m[32m"Root Entry"[0m[39m, files like [0m[32m"CompObj"[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mcontinue to work[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. The `-dumprops` and `-dumpmini` options remain functional[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Addresses the Security Issue:**[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Sanitization**: Removes path traversal sequences before they reach File [0m       [2m                [0m
[2;36m                    [0m         [39mconstructor[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Validation**: Ensures the resulting path is within bounds even if sanitization[0m [2m                [0m
[2;36m                    [0m         [39mhas edge cases[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Multiple Attack Vectors Blocked**:[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - `..[0m[35m/[0m[39m` sequences replaced with `_`[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - Absolute paths blocked by removing `[0m[35m/[0m[39m` and `\`[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - `.` and `..` components neutralized[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Control characters that might bypass filters are removed[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects and Mitigation:**[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Name Changes**: [0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - **Effect**: Files with problematic names will have sanitized names on disk[0m     [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: This is acceptable as POIFSDump is a diagnostic tool, and [0m     [2m                [0m
[2;36m                    [0m         [39msecurity takes precedence[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - **Alternative**: Log original vs sanitized names for transparency[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Name Collisions**:[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - **Effect**: Multiple entries with similar names [0m[1;39m([0m[39me.g., [0m[32m"file/../data"[0m[39m and [0m     [2m                [0m
[2;36m                    [0m         [32m"file/data"[0m[1;39m)[0m[39m might sanitize to the same name[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: Add collision detection - append numbers to duplicates [0m[1;39m([0m[39me.g., [0m [2m                [0m
[2;36m                    [0m         [32m"file_data"[0m[39m, [0m[32m"file_data_1"[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Empty Names**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - **Effect**: An entry with only problematic characters becomes empty after [0m     [2m                [0m
[2;36m                    [0m         [39msanitization[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: Use a default name like [0m[32m"unnamed_entry_<index>"[0m[39m when [0m          [2m                [0m
[2;36m                    [0m         [39msanitization results in empty string[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Performance**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - **Effect**: Additional regex operations per entry[0m                              [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: Negligible impact as POIFSDump typically processes hundreds of[0m [2m                [0m
[2;36m                    [0m         [39mentries, not millions[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Similar Solutions in Codebase:**[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix follows patterns seen in:[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- `TestThreadLocalTempFile.java` [0m[1;39m([0m[39mlines [0m[1;36m36[0m[39m-[0m[1;36m46[0m[1;39m)[0m[39m: Uses `[0m[1;35mnormalize[0m[1;39m([0m[1;39m)[0m[39m` and [0m             [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mtoAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m` for safe path handling[0m                                           [2m                [0m
[2;36m                    [0m         [39m- `TestEncryptor.java` [0m[1;39m([0m[39mlines [0m[1;36m416[0m[39m-[0m[1;36m427[0m[1;39m)[0m[39m: Uses character replacement for sanitization[0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mthough insufficient[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mUtil.sanitizeFilename[0m[1;39m([0m[1;39m)[0m[39m`: Provides character replacement pattern [0m[1;39m([0m[39mthough marked [0m [2m                [0m
[2;36m                    [0m         [39mas inadequate[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mOur solution improves upon these by combining:[0m                                      [2m                [0m
[2;36m                    [0m         [39m- Comprehensive character replacement [0m[1;39m([0m[39mfrom Util.sanitizeFilename[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m- Control character removal [0m[1;39m([0m[39mfrom TestEncryptor[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m- Path validation using canonical paths [0m[1;39m([0m[39minspired by TestThreadLocalTempFile's safe[0m [2m                [0m
[2;36m                    [0m         [39mpath practices[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Implementation Details[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Sanitization Method Signature and Location:**[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd after line [0m[1;36m44[0m[39m in POIFSDump.java:[0m                                                [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[39m**[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m * Sanitizes an entry name to prevent path traversal attacks.[0m                       [2m                [0m
[2;36m                    [0m         [39m * Removes or replaces characters that could allow escaping the intended directory [0m [2m                [0m
[2;36m                    [0m         [39mstructure.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m *[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m * @param entryName the entry name from POIFS file[0m                                  [2m                [0m
[2;36m                    [0m         [39m * @return sanitized name safe for filesystem operations[0m                            [2m                [0m
[2;36m                    [0m         [39m *[0m[35m/[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mprivate static String [0m[1;35msanitizeEntryName[0m[1;39m([0m[39mString entryName[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Implementation here[0m                                                          [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Path Validation Helper Method:**[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd after the sanitization method:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[39m**[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m * Validates that a file path stays within the intended parent directory.[0m           [2m                [0m
[2;36m                    [0m         [39m *[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m * @param file the file to validate[0m                                                 [2m                [0m
[2;36m                    [0m         [39m * @param parent the expected parent directory[0m                                      [2m                [0m
[2;36m                    [0m         [39m * @throws IOException if the file would be outside the parent directory[0m            [2m                [0m
[2;36m                    [0m         [39m *[0m[35m/[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mprivate static void [0m[1;35mvalidatePath[0m[1;39m([0m[39mFile file, File parent[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Implementation here[0m                                                          [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Modified [0m[1;35mdump[0m[1;39m([0m[1;39m)[0m[39m Method Pattern:**[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAt line [0m[1;36m108[0m[39m, change from:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mtry [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m                     [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mString safeName = [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39mFile outputFile = new [0m[1;35mFile[0m[1;39m([0m[39mparent, safeName[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;35mvalidatePath[0m[1;39m([0m[39moutputFile, parent[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39mtry [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[1;35moutputFile.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAt line [0m[1;36m113[0m[39m, change from:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mFile file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mString safeName = [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39mFile file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, safeName[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;35mvalidatePath[0m[1;39m([0m[39mfile, parent[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Error Messages:**[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWhen validation fails, throw descriptive IOException:[0m                               [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mthrow new [0m[1;35mIOException[0m[1;39m([0m[32m"Security violation: Entry name '"[0m[39m + entryName + [0m             [2m                [0m
[2;36m                    [0m         [39m    [0m[32m"' would create path outside intended directory structure"[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Testing Considerations[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must support existing test cases:[0m                                           [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mTestPOIFSDump.testMain[0m[1;39m([0m[1;39m)[0m[39m` expects specific directory structure [0m[1;39m([0m[32m"Root Entry"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [32m"CompObj"[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- These legitimate names will pass through sanitization unchanged[0m                   [2m                [0m
[2;36m                    [0m         [39m- The validation will confirm they're within the parent directory[0m                   [2m                [0m
[2;36m                    [0m         [39m- No changes to test code required if legitimate entry names aren't affected[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix prevents the fuzzer's malicious input:[0m                                      [2m                [0m
[2;36m                    [0m         [39m- Entry name: `..[0m[35m/../../../[0m[95mjazzer-traversal[0m[39m`[0m                                        [2m                [0m
[2;36m                    [0m         [39m- After sanitization: `____jazzer-traversal` [0m[1;39m([0m[39mpath separators replaced[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m- Path validation: Confirms the file is within parent directory[0m                     [2m                [0m
[2;36m                    [0m         [39m- Result: Safe file creation without path traversal[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/12/26 21:33:34][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=800636;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=843967;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=352109;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=629845;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp1206wgee[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768253614.0522456[0m                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-poi_poi-full-01_vuln_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/12/26 21:33:36][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mapache-poi[0m     ]8;id=866826;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=577674;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=66257;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=953224;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-poi[0m            [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=178916;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=607081;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-poi[0m             [2m               [0m
