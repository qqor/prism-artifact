[2;36m[01/13/26 11:22:24][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=249497;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=450751;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpngfvya_3[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-full-01_vuln_7/[0m[95magent-[0m [2m               [0m
[2;36m                    [0m         [95moutput-1768303344.778477[0m                                                             [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/tika_tk-full-01_vuln_7.toml  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=558366;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=821298;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:24:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Took [1;36m97.05[0m  ]8;id=143443;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=878813;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=80677;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=690188;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=847693;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=825061;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=947443;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=473273;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m97[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=304771;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=714389;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:24:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.96[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=684453;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=3131;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 11:24:04][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=658221;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=373058;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=566256;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=985541;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=692198;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=83029;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=142956;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=508620;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:24:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.25[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=775713;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=468280;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 11:24:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=322137;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=43761;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:24:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.99[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=955449;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=282610;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 11:24:17][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=669338;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=441602;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazzer.com:[1;36m443[0m                                             [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.security.ssl.SSLSocketImpl.connect[0m[1m([0mSSLSocketImpl.jav[1;92ma:299[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:178[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/sun.net.www.protocol.https.HttpsClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpsClient.jav[0m[1;92ma:266[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.https.HttpsClient.New[0m[1;39m([0m[39mHttpsClient.jav[0m[1;92ma:380[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.getNewHttpC[0m [2m                [0m
[2;36m                    [0m         [1;35mlient[0m[1;39m([0m[39mAbstractDelegateHttpsURLConnection.jav[0m[1;92ma:189[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect[0m[1;39m([0m[39mAbs[0m [2m                [0m
[2;36m                    [0m         [39mtractDelegateHttpsURLConnection.jav[0m[1;92ma:175[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream[0m[1;39m([0m[39mHttpsURL[0m [2m                [0m
[2;36m                    [0m         [39mConnectionImpl.jav[0m[1;92ma:224[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.csv.TextAndCSVParser.processURL[0m[1;39m([0m[39mTextAndCSVParser.jav[0m[1;92ma:278[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.csv.TextAndCSVParser.processCell[0m[1;39m([0m[39mTextAndCSVParser.jav[0m[1;92ma:261[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.csv.TextAndCSVParser.parse[0m[1;39m([0m[39mTextAndCSVParser.jav[0m[1;92ma:211[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TextAndCSVParserFuzzer.parseOne[0m[1;39m([0m[39mTextAndCSVParserFuzzer.jav[0m[1;92ma:57[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TextAndCSVParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mTextAndCSVParserFuzzer.jav[0m[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m1[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 092377579d0e2656[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazzer.com:[0m[1;36m443[0m                                             [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.security.ssl.SSLSocketImpl.connect[0m[1;39m([0m[39mSSLSocketImpl.jav[0m[1;92ma:299[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:178[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/sun.net.www.protocol.https.HttpsClient.<init[0m[1m>[0m[1m([0mHttpsClient.jav[1;92ma:266[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.https.HttpsClient.New[0m[1m([0mHttpsClient.jav[1;92ma:380[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.getNewHttpC[0m [2m                [0m
[2;36m                    [0m         [1;35mlient[0m[1m([0mAbstractDelegateHttpsURLConnection.jav[1;92ma:189[0m[1m)[0m                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1m([0mHttpURLConnecti [2m                [0m
[2;36m                    [0m         on.jav[1;92ma:1242[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1m([0mHttpURLConnectio [2m                [0m
[2;36m                    [0m         n.jav[1;92ma:1128[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect[0m[1m([0mAbs [2m                [0m
[2;36m                    [0m         tractDelegateHttpsURLConnection.jav[1;92ma:175[0m[1m)[0m                                           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1m([0mHttpURLConnec [2m                [0m
[2;36m                    [0m         tion.jav[1;92ma:1665[0m[1m)[0m                                                                     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1m([0mHttpURLConnect [2m                [0m
[2;36m                    [0m         ion.jav[1;92ma:1589[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream[0m[1m([0mHttpsURL [2m                [0m
[2;36m                    [0m         ConnectionImpl.jav[1;92ma:224[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.csv.TextAndCSVParser.processURL[0m[1m([0mTextAndCSVParser.jav[1;92ma:278[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.csv.TextAndCSVParser.processCell[0m[1m([0mTextAndCSVParser.jav[1;92ma:261[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.csv.TextAndCSVParser.parse[0m[1m([0mTextAndCSVParser.jav[1;92ma:211[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TextAndCSVParserFuzzer.parseOne[0m[1m([0mTextAndCSVParserFuzzer.jav[1;92ma:57[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TextAndCSVParserFuzzer.fuzzerTestOneInput[0m[1m([0mTextAndCSVParserFuzzer.jav[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m1[0m[1m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 092377579d0e2656                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 11:24:35][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=94406;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=548651;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 11:28:32][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=206905;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=40098;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 11:30:51][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=354093;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=445534;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=312951;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=863415;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:30:52][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.99[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=393256;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=877644;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=259601;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=436810;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpwk83ibb2[0m                                                 ]8;id=846329;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=120284;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 11:32:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m70.95[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=930694;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=275009;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Started[33m...[0m                          ]8;id=916019;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=271788;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:32:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Took [1;36m32.63[0m seconds;                ]8;id=353111;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=990692;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Started[33m...[0m                             ]8;id=610838;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=923997;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:32:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Took [1;36m8.97[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=546755;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=651408;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Started[33m...[0m                                 ]8;id=698233;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=455542;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=840319;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=739179;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=94880;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=615724;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:32:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.97[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=983931;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=264501;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 11:32:47][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=561825;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=567520;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:32:48][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.94[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=390827;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=244396;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 11:32:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=285640;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=64742;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.93[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=342139;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=248585;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 11:32:50][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=536760;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=658974;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         ---                                                                                 [2m                [0m
[2;36m                    [0m         a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text [2m                [0m
[2;36m                    [0m         -module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java              [2m                [0m
[2;36m                    [0m         +++                                                                                 [2m                [0m
[2;36m                    [0m         b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text [2m                [0m
[2;36m                    [0m         -module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java              [2m                [0m
[2;36m                    [0m         @@ [1;36m-22[0m,[1;36m8[0m +[1;36m22[0m,[1;36m6[0m @@                                                                   [2m                [0m
[2;36m                    [0m          import java.io.InputStreamReader;                                                  [2m                [0m
[2;36m                    [0m          import java.io.Reader;                                                             [2m                [0m
[2;36m                    [0m          import java.io.UncheckedIOException;                                               [2m                [0m
[2;36m                    [0m         -import java.net.URL;                                                               [2m                [0m
[2;36m                    [0m         -import java.net.URLConnection;                                                     [2m                [0m
[2;36m                    [0m          import java.nio.charset.Charset;                                                   [2m                [0m
[2;36m                    [0m          import java.nio.charset.UnsupportedCharsetException;                               [2m                [0m
[2;36m                    [0m          import java.util.Arrays;                                                           [2m                [0m
[2;36m                    [0m         @@ [1;36m-258[0m,[1;36m30[0m +[1;36m256[0m,[1;36m10[0m @@                                                               [2m                [0m
[2;36m                    [0m                      [1;35mxhtml.startElement[0m[1m([0m[32m"a"[0m, [32m"href"[0m, url[1m)[0m;                                  [2m                [0m
[2;36m                    [0m                      [1;35mxhtml.characters[0m[1m([0mname[1m)[0m;                                                [2m                [0m
[2;36m                    [0m                      [1;35mxhtml.endElement[0m[1m([0m[32m"a"[0m[1m)[0m;                                                 [2m                [0m
[2;36m                    [0m         -            [1;35mprocessURL[0m[1m([0murl, name, xhtml, metadata, context[1m)[0m;                       [2m                [0m
[2;36m                    [0m                  [1m}[0m else [1m{[0m                                                                   [2m                [0m
[2;36m                    [0m                      [1;35mxhtml.characters[0m[1m([0mcellContent[1m)[0m;                                         [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                  [1;35mxhtml.endElement[0m[1m([0mTD[1m)[0m;                                                      [2m                [0m
[2;36m                    [0m         -    [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m         -                                                                                   [2m                [0m
[2;36m                    [0m         -    private void [1;35mprocessURL[0m[1m([0mString urlString, String name, XHTMLContentHandler     [2m                [0m
[2;36m                    [0m         xhtml,                                                                              [2m                [0m
[2;36m                    [0m         -                            Metadata parentMetadata,                               [2m                [0m
[2;36m                    [0m         -                            ParseContext context[1m)[0m throws IOException, SAXException [2m                [0m
[2;36m                    [0m         [1m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         -        EmbeddedDocumentExtractor ex =                                             [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1m([0mcontext[1m)[0m;                         [2m                [0m
[2;36m                    [0m         -        Metadata metadata = new [1;35mMetadata[0m[1m([0m[1m)[0m;                                        [2m                [0m
[2;36m                    [0m         -        [1;35mmetadata.set[0m[1m([0mTikaCoreProperties.RESOURCE_NAME_KEY, name[1m)[0m;                  [2m                [0m
[2;36m                    [0m         -        try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -            URL url = new [1;35mURL[0m[1m([0murlString[1m)[0m;                                          [2m                [0m
[2;36m                    [0m         -            URLConnection connection = [1;35murl.openConnection[0m[1m([0m[1m)[0m;                       [2m                [0m
[2;36m                    [0m         -            [1;35mconnection.setConnectTimeout[0m[1m([0m[1;36m5000[0m[1m)[0m;                                    [2m                [0m
[2;36m                    [0m         -            try [1m([0mTikaInputStream tis =                                             [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1m([0m[1;35mconnection.getInputStream[0m[1m([0m[1m)[0m[1m)[0m[1m)[0m [1m{[0m                                 [2m                [0m
[2;36m                    [0m         -                [1;35mex.parseEmbedded[0m[1m([0mtis, xhtml, metadata, false[1m)[0m;                     [2m                [0m
[2;36m                    [0m         -            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         -        [1m}[0m catch [1m([0mException e[1m)[0m [1m{[0m                                                    [2m                [0m
[2;36m                    [0m         -            [1;35mparentMetadata.set[0m[1m([0mTikaCoreProperties.EMBEDDED_EXCEPTION,              [2m                [0m
[2;36m                    [0m         -                    [1;35mExceptionUtils.getStackTrace[0m[1m([0me[1m)[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazzer.com:[1;36m443[0m                                             [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.security.ssl.SSLSocketImpl.connect[0m[1m([0mSSLSocketImpl.jav[1;92ma:299[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:178[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/sun.net.www.protocol.https.HttpsClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpsClient.jav[0m[1;92ma:266[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.https.HttpsClient.New[0m[1;39m([0m[39mHttpsClient.jav[0m[1;92ma:380[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.getNewHttpC[0m [2m                [0m
[2;36m                    [0m         [1;35mlient[0m[1;39m([0m[39mAbstractDelegateHttpsURLConnection.jav[0m[1;92ma:189[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect[0m[1;39m([0m[39mAbs[0m [2m                [0m
[2;36m                    [0m         [39mtractDelegateHttpsURLConnection.jav[0m[1;92ma:175[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream[0m[1;39m([0m[39mHttpsURL[0m [2m                [0m
[2;36m                    [0m         [39mConnectionImpl.jav[0m[1;92ma:224[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.csv.TextAndCSVParser.processURL[0m[1;39m([0m[39mTextAndCSVParser.jav[0m[1;92ma:278[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.csv.TextAndCSVParser.processCell[0m[1;39m([0m[39mTextAndCSVParser.jav[0m[1;92ma:261[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.csv.TextAndCSVParser.parse[0m[1;39m([0m[39mTextAndCSVParser.jav[0m[1;92ma:211[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TextAndCSVParserFuzzer.parseOne[0m[1;39m([0m[39mTextAndCSVParserFuzzer.jav[0m[1;92ma:57[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TextAndCSVParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mTextAndCSVParserFuzzer.jav[0m[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m1[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 092377579d0e2656[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability has been detected in the Apache [0m [2m                [0m
[2;36m                    [0m         [39mTika CSV/Text parser component. The fuzzer identified that the parser attempts to [0m  [2m                [0m
[2;36m                    [0m         [39mmake an outbound HTTPS connection to an external domain [0m[1;39m([0m[39mjazzer.com:[0m[1;36m443[0m[1;39m)[0m[39m when [0m      [2m                [0m
[2;36m                    [0m         [39mprocessing untrusted input data. This vulnerability is classified as a [0m             [2m                [0m
[2;36m                    [0m         [39mmedium-severity security issue that could potentially lead to exfiltration of [0m      [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue represents a Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability, which [0m     [2m                [0m
[2;36m                    [0m         [39moccurs when an application accepts user-controlled input and uses it to initiate [0m   [2m                [0m
[2;36m                    [0m         [39mnetwork requests without proper validation or sanitization. In this case, the [0m      [2m                [0m
[2;36m                    [0m         [39mvulnerability manifests when processing CSV or text file content through Apache [0m    [2m                [0m
[2;36m                    [0m         [39mTika's TextAndCSVParser.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe stack trace reveals the following critical flow:[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer entry point calls `[0m[1;35mTextAndCSVParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m`, [0m     [2m                [0m
[2;36m                    [0m         [39mwhich invokes `[0m[1;35mparseOne[0m[1;39m([0m[1;39m)[0m[39m` to process input data[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The parsing operation proceeds through `[0m[1;35mTextAndCSVParser.parse[0m[1;39m([0m[1;39m)[0m[39m`, which [0m        [2m                [0m
[2;36m                    [0m         [39mprocesses individual cells via `[0m[1;35mprocessCell[0m[1;39m([0m[1;39m)[0m[39m`[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The `[0m[1;35mprocessURL[0m[1;39m([0m[1;39m)[0m[39m` method at line [0m[1;36m278[0m[39m of TextAndCSVParser attempts to establish [0m [2m                [0m
[2;36m                    [0m         [39ma connection[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. This triggers a complete HTTPS connection sequence through Java's standard [0m      [2m                [0m
[2;36m                    [0m         [39mnetworking libraries [0m[1;39m([0m[39mHttpsURLConnectionImpl, HttpURLConnection, SSLSocketImpl, [0m    [2m                [0m
[2;36m                    [0m         [39mSocket[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. The SSRF sanitizer detects and reports the attempted connection to the external [0m [2m                [0m
[2;36m                    [0m         [39mdomain [0m[32m"jazzer.com:443"[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mKey observations from this issue:[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- The vulnerability occurs during URL processing within CSV/text cell content, [0m     [2m                [0m
[2;36m                    [0m         [39msuggesting that the parser treats certain cell values as URLs and attempts to fetch[0m [2m                [0m
[2;36m                    [0m         [39mthem[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m- The connection attempt reaches the actual socket connection level, indicating [0m    [2m                [0m
[2;36m                    [0m         [39mthat URL validation and sanitization controls are either absent or insufficient [0m    [2m                [0m
[2;36m                    [0m         [39mbefore network operations are initiated[0m                                             [2m                [0m
[2;36m                    [0m         [39m- The issue was triggered by fuzzer-generated input, demonstrating that malicious [0m  [2m                [0m
[2;36m                    [0m         [39mor crafted input can cause the parser to make arbitrary network requests[0m            [2m                [0m
[2;36m                    [0m         [39m- The attempted connection is to an external domain over HTTPS [0m[1;39m([0m[39mport [0m[1;36m443[0m[1;39m)[0m[39m, which [0m   [2m                [0m
[2;36m                    [0m         [39mrepresents a clear security risk in environments where the parser processes [0m        [2m                [0m
[2;36m                    [0m         [39muntrusted data[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a comprehensive understanding of this vulnerability, the following areas [0m [2m                [0m
[2;36m                    [0m         [39mof the codebase should be investigated:[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **[0m[1;35mTextAndCSVParser.processURL[0m[1;39m([0m[1;39m)[0m[39m** [0m[1;39m([0m[39mline [0m[1;36m278[0m[1;39m)[0m[39m - This method appears to be [0m        [2m                [0m
[2;36m                    [0m         [39mdirectly responsible for initiating the URL connection and should be examined to [0m   [2m                [0m
[2;36m                    [0m         [39munderstand what triggers URL processing and whether any validation exists[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **[0m[1;35mTextAndCSVParser.processCell[0m[1;39m([0m[1;39m)[0m[39m** [0m[1;39m([0m[39mline [0m[1;36m261[0m[1;39m)[0m[39m - This method determines how cell [0m [2m                [0m
[2;36m                    [0m         [39mcontent is interpreted and when URL processing is invoked, which is crucial for [0m    [2m                [0m
[2;36m                    [0m         [39munderstanding the attack surface[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **[0m[1;35mTextAndCSVParser.parse[0m[1;39m([0m[1;39m)[0m[39m** [0m[1;39m([0m[39mline [0m[1;36m211[0m[1;39m)[0m[39m - The main parsing logic that [0m           [2m                [0m
[2;36m                    [0m         [39morchestrates cell processing and may contain configuration options or conditions [0m   [2m                [0m
[2;36m                    [0m         [39mthat affect URL handling behavior[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. The parser's configuration and initialization logic to determine if there are [0m   [2m                [0m
[2;36m                    [0m         [39msettings that control URL fetching behavior or if this is default functionality[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Any URL validation, allowlist/blocklist mechanisms, or input sanitization [0m       [2m                [0m
[2;36m                    [0m         [39mroutines that should be preventing external network requests from untrusted input[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Documentation and intended design of the TextAndCSVParser to understand whether [0m [2m                [0m
[2;36m                    [0m         [39mURL fetching is an intentional feature or an unintended side effect of the [0m         [2m                [0m
[2;36m                    [0m         [39mimplementation[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazzer.com:[0m[1;36m443[0m                                             [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.security.ssl.SSLSocketImpl.connect[0m[1;39m([0m[39mSSLSocketImpl.jav[0m[1;92ma:299[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:178[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/sun.net.www.protocol.https.HttpsClient.<init>[0m[1;39m([0m[39mHttpsClient.jav[0m[1;92ma:266[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.https.HttpsClient.New[0m[1;39m([0m[39mHttpsClient.jav[0m[1;92ma:380[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.getNewHttpC[0m [2m                [0m
[2;36m                    [0m         [1;35mlient[0m[1;39m([0m[39mAbstractDelegateHttpsURLConnection.jav[0m[1;92ma:189[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect[0m[1;39m([0m[39mAbs[0m [2m                [0m
[2;36m                    [0m         [39mtractDelegateHttpsURLConnection.jav[0m[1;92ma:175[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream[0m[1;39m([0m[39mHttpsURL[0m [2m                [0m
[2;36m                    [0m         [39mConnectionImpl.jav[0m[1;92ma:224[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.csv.TextAndCSVParser.processURL[0m[1;39m([0m[39mTextAndCSVParser.jav[0m[1;92ma:278[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.csv.TextAndCSVParser.processCell[0m[1;39m([0m[39mTextAndCSVParser.jav[0m[1;92ma:261[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.csv.TextAndCSVParser.parse[0m[1;39m([0m[39mTextAndCSVParser.jav[0m[1;92ma:211[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TextAndCSVParserFuzzer.parseOne[0m[1;39m([0m[39mTextAndCSVParserFuzzer.jav[0m[1;92ma:57[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TextAndCSVParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mTextAndCSVParserFuzzer.jav[0m[1;92ma:4[0m [2m                [0m
[2;36m                    [0m         [1;92m1[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 092377579d0e2656[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.jav[0m[1;92ma:19[0m[39m-[0m[1;36m61[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.BufferedReader;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStreamReader;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.Reader;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.UncheckedIOException;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.net.URLConnection;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.charset.UnsupportedCharsetException;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.commons.csv.CSVFormat;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.csv.CSVParser;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.csv.CSVRecord;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.io.input.CloseShieldInputStream;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.config.Field;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.detect.AutoDetectReader;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.detect.EncodingDetector;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.exception.TikaConfigException;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:import org.apache.tika.parser.AbstractEncodingDetectorParser;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:import org.apache.tika.utils.ExceptionUtils;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.jav[0m[1;92ma:268[0m[39m-[0m[1;36m285[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    private void [0m[1;35mprocessURL[0m[1;39m([0m[39mString urlString, String name, XHTMLContentHandler [0m [2m                [0m
[2;36m                    [0m         [39mxhtml,[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:                            Metadata parentMetadata,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:                            ParseContext context[0m[1;39m)[0m[39m throws IOException, [0m          [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        EmbeddedDocumentExtractor ex = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        Metadata metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY, name[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:            URL url = new [0m[1;35mURL[0m[1;39m([0m[39murlString[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:            URLConnection connection = [0m[1;35murl.openConnection[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:            [0m[1;35mconnection.setConnectTimeout[0m[1;39m([0m[1;36m5000[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream tis = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mconnection.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:                [0m[1;35mex.parseEmbedded[0m[1;39m([0m[39mtis, xhtml, metadata, false[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:            [0m[1;35mparentMetadata.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_EXCEPTION,[0m           [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:                    [0m[1;35mExceptionUtils.getStackTrace[0m[1;39m([0m[39me[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.jav[0m[1;92ma:104[0m[39m-[0m[1;36m106[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    private static final Pattern HYPERLINK_PATTERN =[0m                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;35mPattern.compile[0m[1;39m([0m[32m"[0m[32m([0m[32m?i[0m[32m)[0m[32m[[0m[32m\"[0m[32m][0m[32m*=HYPERLINK\\[0m[32m([0m[32m[[0m[32m\"[0m[32m][0m[32m+[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m([0m[32m?:[0m[32m[[0m[32m\" [0m[32m][0m[32m+,[0m[32m[[0m[32m [0m    [2m                [0m
[2;36m                    [0m         [32m\"[0m[32m][0m[32m+[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m)[0m[32m?"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.jav[0m[1;92ma:247[0m[39m-[0m[1;36m266[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    private void [0m[1;35mprocessCell[0m[1;39m([0m[39mString cellContent, XHTMLContentHandler xhtml,[0m     [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:                             Metadata metadata,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:                             ParseContext context[0m[1;39m)[0m[39m throws IOException, [0m         [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:        [0m[1;35mxhtml.startElement[0m[1;39m([0m[39mTD[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:        Matcher m = [0m[1;35mHYPERLINK_PATTERN.matcher[0m[1;39m([0m[39mcellContent[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:        if [0m[1;39m([0m[1;35mm.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:            String url = [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:            String name = [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:            if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:                name = url;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"a"[0m[39m, [0m[32m"href"[0m[39m, url[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"a"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:            [0m[1;35mprocessURL[0m[1;39m([0m[39murl, name, xhtml, metadata, context[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[39mcellContent[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        [0m[1;35mxhtml.endElement[0m[1;39m([0m[39mTD[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVConfig.jav[0m[1;92ma:19[0m[39m-[0m[1;36m58[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:public class TextAndCSVConfig implements Serializable [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:    private static final Map<Character, String> DELIMITER_TO_NAME_MAP = new [0m     [2m                [0m
[2;36m                    [0m         [39mHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    private static final Map<String, Character> NAME_TO_DELIMITER_MAP = new [0m     [2m                [0m
[2;36m                    [0m         [39mHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    static [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:        [0m[1;35mDELIMITER_TO_NAME_MAP.put[0m[1;39m([0m[32m','[0m[39m, [0m[32m"comma"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        [0m[1;35mDELIMITER_TO_NAME_MAP.put[0m[1;39m([0m[32m'\t'[0m[39m, [0m[32m"tab"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:        [0m[1;35mDELIMITER_TO_NAME_MAP.put[0m[1;39m([0m[32m'|'[0m[39m, [0m[32m"pipe"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        [0m[1;35mDELIMITER_TO_NAME_MAP.put[0m[1;39m([0m[32m';'[0m[39m, [0m[32m"semicolon"[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    static [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:        for [0m[1;39m([0m[39mMap.Entry<Character, String> e : [0m[1;35mDELIMITER_TO_NAME_MAP.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:            [0m[1;35mNAME_TO_DELIMITER_MAP.put[0m[1;39m([0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35me.getKey[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private Map<String, Character> nameToDelimiterMap = NAME_TO_DELIMITER_MAP;[0m   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    private Map<Character, String> delimiterToNameMap = DELIMITER_TO_NAME_MAP;[0m   [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    public Map<String, Character> [0m[1;35mgetNameToDelimiterMap[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        return nameToDelimiterMap;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    public Map<Character, String> [0m[1;35mgetDelimiterToNameMap[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        return delimiterToNameMap;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public void [0m[1;35msetNameToDelimiterMap[0m[1;39m([0m[39mMap<String, Character> nameToDelimiterMap[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        this.nameToDelimiterMap = new HashMap<>[0m[1;39m([0m[39mnameToDelimiterMap[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        this.delimiterToNameMap = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;35mnameToDelimiterMap.entrySet[0m[1;39m([0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                          [0m[1;35m.forEach[0m[1;39m([0m[39me -> [0m[1;35mdelimiterToNameMap.put[0m[1;39m([0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;35me.getKey[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.jav[0m[1;92ma:195[0m[39m-[0m[1;36m245[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        CSVFormat csvFormat = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mCSVFormat.EXCEL.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setDelimiter[0m[1;39m([0m[1;35mparams.getDelimiter[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[39mDELIMITER_PROPERTY, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mtextAndCSVConfig.getDelimiterToNameMap[0m[1;39m([0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;35mcsvFormat.getDelimiterString[0m[1;39m([0m[1;39m)[0m[1;35m.charAt[0m[1;39m([0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        XHTMLContentHandler xhtmlContentHandler = new [0m                          [2m                [0m
[2;36m                    [0m         [1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, metadata[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        int totalRows = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        try [0m[1;39m([0m[39mCSVParser commonsParser = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mCSVParser.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setReader[0m[1;39m([0m[39mreader[0m[1;39m)[0m[1;35m.setFormat[0m[1;39m([0m[39mcsvFormat[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;35mxhtmlContentHandler.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:            [0m[1;35mxhtmlContentHandler.startElement[0m[1;39m([0m[39mTABLE[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            int firstRowColCount = [0m[1;36m0[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                for [0m[1;39m([0m[39mCSVRecord row : commonsParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:                    [0m[1;35mxhtmlContentHandler.startElement[0m[1;39m([0m[39mTR[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:                    for [0m[1;39m([0m[39mString cell : row[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:                        if [0m[1;39m([0m[39mtotalRows == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                            firstRowColCount++;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:                        [0m[1;35mprocessCell[0m[1;39m([0m[39mcell, xhtmlContentHandler, metadata, [0m       [2m                [0m
[2;36m                    [0m         [39mcontext[0m[1;39m)[0m[39m;                    [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:                    [0m[1;35mxhtmlContentHandler.endElement[0m[1;39m([0m[39mTR[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:                    if [0m[1;39m([0m[39mtotalRows == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                        [0m[1;35mmetadata.set[0m[1;39m([0m[39mNUM_COLUMNS, firstRowColCount[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                    totalRows++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mNUM_ROWS, totalRows[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mUncheckedIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                if [0m[1;39m([0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[39m != null && [0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[1;35m.getMessage[0m[1;39m([0m[1;39m)[0m[39m != null [0m  [2m                [0m
[2;36m                    [0m         [39m&&[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                        [0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[1;35m.getMessage[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"encapsulated"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                    [0m[35m/[0m[35m/[0m[95mif[0m[39m there's a parse exception[0m                              [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                    [0m[35m/[0m[35m/[0m[95mtry[0m[39m to get the rest of the content[0m[33m...[0m[39mtreat it as text for[0m [2m                [0m
[2;36m                    [0m         [39mnow[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                    [0m[35m/[0m[35m/[0m[95mThere[0m[39m will be some content lost because of buffering.[0m     [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                    [0m[35m/[0m[35m/[0m[95mTODO[0m[39m -- figure out how to improve this[0m                    [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                    [0m[1;35mxhtmlContentHandler.endElement[0m[1;39m([0m[39mTABLE[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                    [0m[1;35mxhtmlContentHandler.startElement[0m[1;39m([0m[32m"div"[0m[39m, [0m[32m"name"[0m[39m, [0m[32m"after [0m     [2m                [0m
[2;36m                    [0m         [32mexception"[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                    [0m[1;35mhandleText[0m[1;39m([0m[39mreader, xhtmlContentHandler[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                    [0m[1;35mxhtmlContentHandler.endElement[0m[1;39m([0m[32m"div"[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                    [0m[1;35mxhtmlContentHandler.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                    [0m[35m/[0m[35m/[0m[95mTODO[0m[39m -- consider dumping what's left in the reader as [0m    [2m                [0m
[2;36m                    [0m         [39mtext[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                    throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"exception parsing the csv"[0m[39m, e[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                    if [0m[1;39m([0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                        throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"exception parsing the csv"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [1;35me.getCause[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                        throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"exception parsing the csv"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39me[0m[1;39m)[0m[39m;[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:            [0m[1;35mxhtmlContentHandler.endElement[0m[1;39m([0m[39mTABLE[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:            [0m[1;35mxhtmlContentHandler.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/test/java/org/apache/tika/parser/csv/TextAndCSVParserTest.jav[0m[1;92ma:255[0m[39m-[0m[1;36m265[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    public void [0m[1;35mtestHyperlink[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:        Metadata metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:        MediaType mediaType = [0m[1;35mMediaType.parse[0m[1;39m([0m[32m"text/csv; [0m[32mdelimiter[0m[32m=[0m[32mcomma[0m[32m; [0m      [2m                [0m
[2;36m                    [0m         [32mcharset[0m[32m=[0m[32mISO[0m[32m-8859-1"[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_USER_OVERRIDE,[0m             [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:                [0m[1;35mmediaType.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:        String xml = [0m[1;35mgetXML[0m[1;39m([0m[32m"testCSV_hyperlink.csv"[0m[39m, metadata[0m[1;39m)[0m[39m.xml;[0m             [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:        String needle = [0m[32m"<a [0m[32mhref[0m[32m=\"https://tika.apache.org\">tika</a>"[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:        [0m[1;35massertContains[0m[1;39m([0m[39mneedle, xml[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        [0m[1;35massertNotContained[0m[1;39m([0m[32m"HYPERLINK"[0m[39m, xml[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:19[0m[39m-[0m[1;36m40[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static org.apache.tika.sax.XHTMLContentHandler.XHTML;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.FilenameFilter;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.xml.sax.helpers.AttributesImpl;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.exception.CorruptedFileException;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.exception.EncryptedDocumentException;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.parser.DelegatingParser;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.parser.ParseRecord;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.sax.BodyContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.sax.EmbeddedContentHandler;[0m                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:48[0m[39m-[0m[1;36m139[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:public class ParsingEmbeddedDocumentExtractor implements [0m                        [2m                [0m
[2;36m                    [0m         [39mEmbeddedDocumentExtractor [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    private static final File ABSTRACT_PATH = new [0m[1;35mFile[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private static final Parser DELEGATING_PARSER = new [0m[1;35mDelegatingParser[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private boolean writeFileNameToContent = true;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    protected final ParseContext context;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public [0m[1;35mParsingEmbeddedDocumentExtractor[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        this.context = context;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    public boolean [0m[1;35mshouldParseEmbedded[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        DocumentSelector selector = [0m[1;35mcontext.get[0m[1;39m([0m[39mDocumentSelector.class[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39mselector != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            return [0m[1;35mselector.select[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        FilenameFilter filter = [0m[1;35mcontext.get[0m[1;39m([0m[39mFilenameFilter.class[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        if [0m[1;39m([0m[39mfilter != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                return [0m[1;35mfilter.accept[0m[1;39m([0m[39mABSTRACT_PATH, name[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        return true;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public void [0m[1;35mparseEmbedded[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            TikaInputStream tis, ContentHandler handler, Metadata metadata, [0m     [2m                [0m
[2;36m                    [0m         [39mboolean outputHtml[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            throws SAXException, IOException [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            AttributesImpl attributes = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            [0m[1;35mattributes.addAttribute[0m[1;39m([0m[32m""[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"CDATA"[0m[39m, [0m              [2m                [0m
[2;36m                    [0m         [32m"package-entry"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[39m, attributes[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        if [0m[1;39m([0m[39mwriteFileNameToContent && name != null && [0m[1;35mname.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[39m && [0m      [2m                [0m
[2;36m                    [0m         [39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[39m, new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            char[0m[1;39m[[0m[1;39m][0m[39m chars = [0m[1;35mname.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            [0m[1;35mhandler.characters[0m[1;39m([0m[39mchars, [0m[1;36m0[0m[39m, chars.length[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[35m/[0m[35m/[0m[39m Use the delegate parser to parse this entry[0m                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            [0m[1;35mtis.setCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;35mDELEGATING_PARSER.parse[0m[1;39m([0m[39mtis, new [0m[1;35mEmbeddedContentHandler[0m[1;39m([0m[39mnew [0m        [2m                [0m
[2;36m                    [0m         [1;35mBodyContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[1;39m)[0m[39m,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                    metadata, context[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mEncryptedDocumentException ede[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39mede, context[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mCorruptedFileException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[35m/[0m[35m/[0m[95mnecessary[0m[39m to stop the parse to avoid infinite loops[0m               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            [0m[35m/[0m[35m/[0m[95mon[0m[39m corrupt sqlite3 files[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39me, context[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[1;35mtis.removeCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    void [0m[1;35mrecordException[0m[1;39m([0m[39mException e, ParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        ParseRecord record = [0m[1;35mcontext.get[0m[1;39m([0m[39mParseRecord.class[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        if [0m[1;39m([0m[39mrecord == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        [0m[1;35mrecord.addException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    public Parser [0m[1;35mgetDelegatingParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        return DELEGATING_PARSER;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    public void [0m[1;35msetWriteFileNameToContent[0m[1;39m([0m[39mboolean writeFileNameToContent[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        this.writeFileNameToContent = writeFileNameToContent;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    public boolean [0m[1;35misWriteFileNameToContent[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        return writeFileNameToContent;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractorF[0m [2m                [0m
[2;36m                    [0m         [39mactory.jav[0m[1;92ma:19[0m[39m-[0m[1;36m40[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.tika.config.Field;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:public class ParsingEmbeddedDocumentExtractorFactory[0m                             [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        implements EmbeddedDocumentExtractorFactory [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    private boolean writeFileNameToContent = true;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    @Field[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    public void [0m[1;35msetWriteFileNameToContent[0m[1;39m([0m[39mboolean writeFileNameToContent[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        this.writeFileNameToContent = writeFileNameToContent;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public EmbeddedDocumentExtractor [0m[1;35mnewInstance[0m[1;39m([0m[39mMetadata metadata, ParseContext[0m [2m                [0m
[2;36m                    [0m         [39mparseContext[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        ParsingEmbeddedDocumentExtractor ex =[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:                new [0m[1;35mParsingEmbeddedDocumentExtractor[0m[1;39m([0m[39mparseContext[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        [0m[1;35mex.setWriteFileNameToContent[0m[1;39m([0m[39mwriteFileNameToContent[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        return ex;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/EmbeddedDocumentUtil.jav[0m[1;92ma:20[0m[39m-[0m[1;36m42[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.tika.config.TikaConfig;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.tika.detect.Detector;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.mime.MimeType;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.mime.MimeTypeException;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.mime.MimeTypes;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.parser.AutoDetectParser;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.parser.CompositeParser;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.parser.ParserDecorator;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.parser.PasswordProvider;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.parser.StatefulParser;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.utils.ExceptionUtils;[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/EmbeddedDocumentUtil.jav[0m[1;92ma:52[0m[39m-[0m[1;36m97[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:public class EmbeddedDocumentUtil implements Serializable [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private final ParseContext context;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private final EmbeddedDocumentExtractor embeddedDocumentExtractor;[0m           [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[35m/[0m[95mthese[0m[39m are lazily initialized and can be null[0m                               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private TikaConfig tikaConfig;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    private MimeTypes mimeTypes;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private Detector detector;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public [0m[1;35mEmbeddedDocumentUtil[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        this.context = context;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        this.embeddedDocumentExtractor = [0m[1;35mgetEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * This offers a uniform way to get an EmbeddedDocumentExtractor from a [0m     [2m                [0m
[2;36m                    [0m         [39mParseContext.[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * As of Tika [0m[1;36m1.15[0m[39m, an AutoDetectParser will automatically be added to parse[0m [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * embedded documents if no Parser.class is specified in the ParseContext.[0m   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * <p/>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * If you'd prefer not to parse embedded documents, set Parser.class[0m         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * to [0m[1;39m{[0m[39m@link org.apache.tika.parser.EmptyParser[0m[1;39m}[0m[39m in the ParseContext.[0m        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @param context[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @return EmbeddedDocumentExtractor[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    public static EmbeddedDocumentExtractor [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mgetEmbeddedDocumentExtractor[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        EmbeddedDocumentExtractor extractor = [0m                                   [2m                [0m
[2;36m                    [0m         [1;35mcontext.get[0m[1;39m([0m[39mEmbeddedDocumentExtractor.class[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        if [0m[1;39m([0m[39mextractor != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            return extractor;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[35m/[0m[35m/[0m[95mensure[0m[39m that an AutoDetectParser is[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[35m/[0m[35m/[0m[95mavailable[0m[39m for parsing embedded docs TIKA-[0m[1;36m2096[0m                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        Parser embeddedParser = [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        if [0m[1;39m([0m[39membeddedParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            TikaConfig tikaConfig = [0m[1;35mcontext.get[0m[1;39m([0m[39mTikaConfig.class[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            if [0m[1;39m([0m[39mtikaConfig == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;35mcontext.set[0m[1;39m([0m[39mParser.class, new [0m[1;35mAutoDetectParser[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                [0m[1;35mcontext.set[0m[1;39m([0m[39mParser.class, new [0m[1;35mAutoDetectParser[0m[1;39m([0m[39mtikaConfig[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        EmbeddedDocumentExtractor ex = new [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mParsingEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;35mcontext.set[0m[1;39m([0m[39mEmbeddedDocumentExtractor.class, ex[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        return ex;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/DocumentSelector.jav[0m[1;92ma:19[0m[39m-[0m[1;36m42[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: * Interface for different document selection strategies for purposes like[0m       [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: * embedded document extraction by a [0m[1;39m{[0m[39m@link ContainerExtractor[0m[1;39m}[0m[39m instance.[0m        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: * An implementation of this interface defines some specific selection[0m           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: * criteria to be applied against the document metadata passed to the[0m            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * [0m[1;39m{[0m[39m@link #[0m[1;35mselect[0m[1;39m([0m[39mMetadata[0m[1;39m)[0m[1;39m}[0m[39m method.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: * @since Apache Tika [0m[1;36m0.8[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:public interface DocumentSelector [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     * Checks if a document with the given metadata matches the specified[0m        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * selection criteria.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * @param metadata document metadata[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * @return <code>true<[0m[35m/[0m[95mcode[0m[39m> if the document matches the selection criteria,[0m [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * <code>false<[0m[35m/[0m[95mcode[0m[39m> otherwise[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    boolean [0m[1;35mselect[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/onenote/OneNoteTreeWalker[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:66[0m[39m-[0m[1;36m73[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * See spec MS-DTYP - [0m[1;36m2.3[0m[39m.[0m[1;36m3[0m[39m - DATETIME dates are based on epoch of jan [0m[1;36m1[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m UTC.[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * So we create this offset used to calculate number of seconds between this[0m [2m                [0m
[2;36m                    [0m         [39mand the Instant[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * .EPOCH.[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    private static final long DATETIME_EPOCH_DIFF_1601;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final Pattern HYPERLINK_PATTERN =[0m                             [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            [0m[1;35mPattern.compile[0m[1;39m([0m[32m"\uFDDFHYPERLINK\\s+\"[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m\"[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m$"[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/onenote/OneNoteTreeWalker[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:585[0m[39m-[0m[1;36m600[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:        if [0m[1;39m([0m[39mfirstNull == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:        String txt = new [0m[1;35mString[0m[1;39m([0m[39marr, [0m[1;36m0[0m[39m, firstNull, StandardCharsets.UTF_16LE[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:        Matcher m = [0m[1;35mHYPERLINK_PATTERN.matcher[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:        if [0m[1;39m([0m[1;35mm.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"a"[0m[39m, [0m[32m"href"[0m[39m, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"a"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[39mP[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[39mP[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/onenote/fsshttpb/MSOneSto[0m [2m                [0m
[2;36m                    [0m         [39mrePackage.jav[0m[1;92ma:73[0m[39m-[0m[1;36m80[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * See spec MS-DTYP - [0m[1;36m2.3[0m[39m.[0m[1;36m3[0m[39m - DATETIME dates are based on epoch of jan [0m[1;36m1[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m UTC.[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * So we create this offset used to calculate number of seconds between this[0m [2m                [0m
[2;36m                    [0m         [39mand the Instant[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * .EPOCH.[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private static final long DATETIME_EPOCH_DIFF_1601;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private static final Pattern HYPERLINK_PATTERN =[0m                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;35mPattern.compile[0m[1;39m([0m[32m"\uFDDFHYPERLINK\\s+\"[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m\"[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m$"[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private static final String P = [0m[32m"p"[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/onenote/fsshttpb/MSOneSto[0m [2m                [0m
[2;36m                    [0m         [39mrePackage.jav[0m[1;92ma:281[0m[39m-[0m[1;36m291[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        if [0m[1;39m([0m[39mfirstNull == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:        String txt = new [0m[1;35mString[0m[1;39m([0m[39marr, [0m[1;36m0[0m[39m, firstNull, StandardCharsets.UTF_16LE[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        Matcher m = [0m[1;35mHYPERLINK_PATTERN.matcher[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:        if [0m[1;39m([0m[1;35mm.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"a"[0m[39m, [0m[32m"href"[0m[39m, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"a"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.jav[0m[1;92ma:158[0m[39m-[0m[1;36m167[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    private final TextAndCSVConfig defaultTextAndCSVConfig = new [0m               [2m                [0m
[2;36m                    [0m         [1;35mTextAndCSVConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        return SUPPORTED_TYPES;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        TextAndCSVConfig textAndCSVConfig = [0m[1;35mcontext.get[0m[1;39m([0m[39mTextAndCSVConfig.class,[0m [2m                [0m
[2;36m                    [0m         [39mdefaultTextAndCSVConfig[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.jav[0m[1;92ma:418[0m[39m-[0m[1;36m430[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:    @Field[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:    public void [0m[1;35msetNameToDelimiterMap[0m[1;39m([0m[39mMap<String, String> map[0m[1;39m)[0m[39m throws [0m          [2m                [0m
[2;36m                    [0m         [39mTikaConfigException [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        Map<String, Character> m = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:        for [0m[1;39m([0m[39mMap.Entry<String, String> e : [0m[1;35mmap.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:            if [0m[1;39m([0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[1;35m.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:                throw new [0m[1;35mTikaConfigException[0m[1;39m([0m[32m"delimiter must be a single [0m      [2m                [0m
[2;36m                    [0m         [32mcharacter: "[0m[39m + [0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:            [0m[1;35mm.put[0m[1;39m([0m[1;35me.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[1;35m.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:        [0m[1;35mdefaultTextAndCSVConfig.setNameToDelimiterMap[0m[1;39m([0m[39mm[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/test/resources/test-documents/testCSV_hyperlink.csv:[0m[1;36m1[0m[39m-[0m[1;36m7[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:name,number[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;92m2:ca[0m[39mt,[0m[1;36m10[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;92m3:d[0m[39mog,[0m[1;36m15[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:jaguar,[0m[1;36m23[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;92m5:a[0m[39mntelope,[0m[1;36m43[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[32m"=HYPERLINK[0m[32m([0m[32m"[0m[32m"https://tika.apache.org"[0m[32m","[0m[32m"tika"[0m[32m"[0m[32m)[0m[32m"[0m[39m,[0m[1;36m100[0m                            [2m                [0m
[2;36m                    [0m         [1;92m7:e[0m[39mlephant,[0m[1;36m1[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/EmptyParser.jav[0m[1;92ma:19[0m[39m-[0m[1;36m55[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * Dummy parser that always produces an empty XHTML document without even[0m        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * attempting to parse the given document stream. Useful as a sentinel parser[0m    [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: * for unknown document types.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:public class EmptyParser implements Parser [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Singleton instance of this class.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    public static final EmptyParser INSTANCE = new [0m[1;35mEmptyParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * Serial version UID.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private static final long serialVersionUID = -4218649699095732123L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        return [0m[1;35mCollections.emptySet[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, metadata[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;35mxhtml.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;35mxhtml.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.jav[0m[1;92ma:247[0m[39m-[0m[1;36m266[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    private void [0m[1;35mprocessCell[0m[1;39m([0m[39mString cellContent, XHTMLContentHandler xhtml,[0m     [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:                             Metadata metadata,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:                             ParseContext context[0m[1;39m)[0m[39m throws IOException, [0m         [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:        [0m[1;35mxhtml.startElement[0m[1;39m([0m[39mTD[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:        Matcher m = [0m[1;35mHYPERLINK_PATTERN.matcher[0m[1;39m([0m[39mcellContent[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:        if [0m[1;39m([0m[1;35mm.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:            String url = [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:            String name = [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:            if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:                name = url;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"a"[0m[39m, [0m[32m"href"[0m[39m, url[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"a"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:            [0m[1;35mprocessURL[0m[1;39m([0m[39murl, name, xhtml, metadata, context[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[39mcellContent[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        [0m[1;35mxhtml.endElement[0m[1;39m([0m[39mTD[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.jav[0m[1;92ma:268[0m[39m-[0m[1;36m285[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    private void [0m[1;35mprocessURL[0m[1;39m([0m[39mString urlString, String name, XHTMLContentHandler [0m [2m                [0m
[2;36m                    [0m         [39mxhtml,[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:                            Metadata parentMetadata,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:                            ParseContext context[0m[1;39m)[0m[39m throws IOException, [0m          [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        EmbeddedDocumentExtractor ex = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        Metadata metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY, name[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:            URL url = new [0m[1;35mURL[0m[1;39m([0m[39murlString[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:            URLConnection connection = [0m[1;35murl.openConnection[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:            [0m[1;35mconnection.setConnectTimeout[0m[1;39m([0m[1;36m5000[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream tis = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mconnection.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:                [0m[1;35mex.parseEmbedded[0m[1;39m([0m[39mtis, xhtml, metadata, false[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:            [0m[1;35mparentMetadata.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_EXCEPTION,[0m           [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:                    [0m[1;35mExceptionUtils.getStackTrace[0m[1;39m([0m[39me[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.jav[0m[1;92ma:104[0m[39m-[0m[1;36m106[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    private static final Pattern HYPERLINK_PATTERN =[0m                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;35mPattern.compile[0m[1;39m([0m[32m"[0m[32m([0m[32m?i[0m[32m)[0m[32m[[0m[32m\"[0m[32m][0m[32m*=HYPERLINK\\[0m[32m([0m[32m[[0m[32m\"[0m[32m][0m[32m+[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m([0m[32m?:[0m[32m[[0m[32m\" [0m[32m][0m[32m+,[0m[32m[[0m[32m [0m    [2m                [0m
[2;36m                    [0m         [32m\"[0m[32m][0m[32m+[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m)[0m[32m?"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/onenote/OneNoteTreeWalker[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:71[0m[39m-[0m[1;36m72[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final Pattern HYPERLINK_PATTERN =[0m                             [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            [0m[1;35mPattern.compile[0m[1;39m([0m[32m"\uFDDFHYPERLINK\\s+\"[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m\"[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m$"[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/onenote/fsshttpb/MSOneSto[0m [2m                [0m
[2;36m                    [0m         [39mrePackage.jav[0m[1;92ma:78[0m[39m-[0m[1;36m79[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private static final Pattern HYPERLINK_PATTERN =[0m                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;35mPattern.compile[0m[1;39m([0m[32m"\uFDDFHYPERLINK\\s+\"[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m\"[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m$"[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/onenote/OneNoteTreeWalker[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:592[0m[39m-[0m[1;36m596[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:        Matcher m = [0m[1;35mHYPERLINK_PATTERN.matcher[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:        if [0m[1;39m([0m[1;35mm.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"a"[0m[39m, [0m[32m"href"[0m[39m, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"a"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/onenote/fsshttpb/MSOneSto[0m [2m                [0m
[2;36m                    [0m         [39mrePackage.jav[0m[1;92ma:286[0m[39m-[0m[1;36m290[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        Matcher m = [0m[1;35mHYPERLINK_PATTERN.matcher[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:        if [0m[1;39m([0m[1;35mm.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"a"[0m[39m, [0m[32m"href"[0m[39m, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"a"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.jav[0m[1;92ma:195[0m[39m-[0m[1;36m217[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        CSVFormat csvFormat = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mCSVFormat.EXCEL.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setDelimiter[0m[1;39m([0m[1;35mparams.getDelimiter[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[39mDELIMITER_PROPERTY, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mtextAndCSVConfig.getDelimiterToNameMap[0m[1;39m([0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;35mcsvFormat.getDelimiterString[0m[1;39m([0m[1;39m)[0m[1;35m.charAt[0m[1;39m([0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        XHTMLContentHandler xhtmlContentHandler = new [0m                          [2m                [0m
[2;36m                    [0m         [1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, metadata[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        int totalRows = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        try [0m[1;39m([0m[39mCSVParser commonsParser = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mCSVParser.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setReader[0m[1;39m([0m[39mreader[0m[1;39m)[0m[1;35m.setFormat[0m[1;39m([0m[39mcsvFormat[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;35mxhtmlContentHandler.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:            [0m[1;35mxhtmlContentHandler.startElement[0m[1;39m([0m[39mTABLE[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            int firstRowColCount = [0m[1;36m0[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                for [0m[1;39m([0m[39mCSVRecord row : commonsParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:                    [0m[1;35mxhtmlContentHandler.startElement[0m[1;39m([0m[39mTR[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:                    for [0m[1;39m([0m[39mString cell : row[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:                        if [0m[1;39m([0m[39mtotalRows == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                            firstRowColCount++;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:                        [0m[1;35mprocessCell[0m[1;39m([0m[39mcell, xhtmlContentHandler, metadata, [0m       [2m                [0m
[2;36m                    [0m         [39mcontext[0m[1;39m)[0m[39m;                    [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:                    [0m[1;35mxhtmlContentHandler.endElement[0m[1;39m([0m[39mTR[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:                    if [0m[1;39m([0m[39mtotalRows == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                        [0m[1;35mmetadata.set[0m[1;39m([0m[39mNUM_COLUMNS, firstRowColCount[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                    totalRows++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.jav[0m[1;92ma:81[0m[39m-[0m[1;36m162[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:public class TextAndCSVParser extends AbstractEncodingDetectorParser [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    static final MediaType CSV = [0m[1;35mMediaType.text[0m[1;39m([0m[32m"csv"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    static final MediaType TSV = [0m[1;35mMediaType.text[0m[1;39m([0m[32m"tsv"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private static final String CSV_PREFIX = [0m[32m"csv"[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    private static final String CHARSET = [0m[32m"charset"[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private static final String DELIMITER = [0m[32m"delimiter"[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    public static final Property DELIMITER_PROPERTY = [0m[1;35mProperty.externalText[0m[1;39m([0m     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:            CSV_PREFIX + TikaCoreProperties.NAMESPACE_PREFIX_DELIMITER + [0m        [2m                [0m
[2;36m                    [0m         [39mDELIMITER[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     * If the file is detected as a csv/tsv, this is the number of columns in [0m   [2m                [0m
[2;36m                    [0m         [39mthe first row.[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    public static final Property NUM_COLUMNS = [0m[1;35mProperty.externalInteger[0m[1;39m([0m         [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            CSV_PREFIX + TikaCoreProperties.NAMESPACE_PREFIX_DELIMITER + [0m        [2m                [0m
[2;36m                    [0m         [32m"num_columns"[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     * If the file is detected as a csv/tsv, this is the number of rows if the [0m  [2m                [0m
[2;36m                    [0m         [39mfile[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * is successfully read [0m[1;39m([0m[39me.g. no encapsulation exceptions, etc[0m[1;39m)[0m[39m.[0m             [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    public static final Property NUM_ROWS = [0m[1;35mProperty.externalInteger[0m[1;39m([0m           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            CSV_PREFIX + TikaCoreProperties.NAMESPACE_PREFIX_DELIMITER + [0m       [2m                [0m
[2;36m                    [0m         [32m"num_rows"[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    private static final Pattern HYPERLINK_PATTERN =[0m                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;35mPattern.compile[0m[1;39m([0m[32m"[0m[32m([0m[32m?i[0m[32m)[0m[32m[[0m[32m\"[0m[32m][0m[32m*=HYPERLINK\\[0m[32m([0m[32m[[0m[32m\"[0m[32m][0m[32m+[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m([0m[32m?:[0m[32m[[0m[32m\" [0m[32m][0m[32m+,[0m[32m[[0m[32m [0m    [2m                [0m
[2;36m                    [0m         [32m\"[0m[32m][0m[32m+[0m[32m([0m[32m[[0m[32m^\"[0m[32m][0m[32m+[0m[32m)[0m[32m)[0m[32m?"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    private static final String TD = [0m[32m"td"[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    private static final String TR = [0m[32m"tr"[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    private static final String TABLE = [0m[32m"table"[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    private static final int DEFAULT_MARK_LIMIT = [0m[1;36m20000[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    private static final Set<MediaType> SUPPORTED_TYPES = Collections[0m           [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            [0m[1;35m.unmodifiableSet[0m[1;39m([0m[39mnew HashSet<>[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m[39mCSV, TSV, [0m             [2m                [0m
[2;36m                    [0m         [39mMediaType.TEXT_PLAIN[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:     * This is the mark limit in characters [0m[1;39m([0m[39mnot bytes[0m[1;39m)[0m[39m to[0m                      [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:     * read from the stream when classifying the stream as[0m                      [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:     * csv, tsv or txt.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    @Field[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    private int markLimit = DEFAULT_MARK_LIMIT;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:     * minimum confidence score that there's enough[0m                             [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:     * evidence to determine csv/tsv vs. txt[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    @Field[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    private double minConfidence = [0m[1;36m0.50[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    public [0m[1;35mTextAndCSVParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    public [0m[1;35mTextAndCSVParser[0m[1;39m([0m[39mEncodingDetector encodingDetector[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mencodingDetector[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    private static void [0m[1;35mhandleText[0m[1;39m([0m[39mReader reader, XHTMLContentHandler xhtml[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            throws SAXException, IOException [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        char[0m[1;39m[[0m[1;39m][0m[39m buffer = new char[0m[1;39m[[0m[1;36m4096[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        int n = [0m[1;35mreader.read[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        while [0m[1;39m([0m[39mn != [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[39mbuffer, [0m[1;36m0[0m[39m, n[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            n = [0m[1;35mreader.read[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    static boolean [0m[1;35misCSVOrTSV[0m[1;39m([0m[39mMediaType mediaType[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        if [0m[1;39m([0m[39mmediaType == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            return false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:        return [0m[1;35mmediaType.getBaseType[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[39mTSV[0m[1;39m)[0m[39m || [0m                          [2m                [0m
[2;36m                    [0m         [1;35mmediaType.getBaseType[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[39mCSV[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    private final TextAndCSVConfig defaultTextAndCSVConfig = new [0m               [2m                [0m
[2;36m                    [0m         [1;35mTextAndCSVConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        return SUPPORTED_TYPES;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.jav[0m[1;92ma:247[0m[39m-[0m[1;36m285[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    private void [0m[1;35mprocessCell[0m[1;39m([0m[39mString cellContent, XHTMLContentHandler xhtml,[0m     [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:                             Metadata metadata,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:                             ParseContext context[0m[1;39m)[0m[39m throws IOException, [0m         [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:        [0m[1;35mxhtml.startElement[0m[1;39m([0m[39mTD[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:        Matcher m = [0m[1;35mHYPERLINK_PATTERN.matcher[0m[1;39m([0m[39mcellContent[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:        if [0m[1;39m([0m[1;35mm.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:            String url = [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:            String name = [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:            if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:                name = url;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"a"[0m[39m, [0m[32m"href"[0m[39m, url[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"a"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:            [0m[1;35mprocessURL[0m[1;39m([0m[39murl, name, xhtml, metadata, context[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[39mcellContent[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        [0m[1;35mxhtml.endElement[0m[1;39m([0m[39mTD[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    private void [0m[1;35mprocessURL[0m[1;39m([0m[39mString urlString, String name, XHTMLContentHandler [0m [2m                [0m
[2;36m                    [0m         [39mxhtml,[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:                            Metadata parentMetadata,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:                            ParseContext context[0m[1;39m)[0m[39m throws IOException, [0m          [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        EmbeddedDocumentExtractor ex = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        Metadata metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY, name[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:            URL url = new [0m[1;35mURL[0m[1;39m([0m[39murlString[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:            URLConnection connection = [0m[1;35murl.openConnection[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:            [0m[1;35mconnection.setConnectTimeout[0m[1;39m([0m[1;36m5000[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream tis = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mconnection.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:                [0m[1;35mex.parseEmbedded[0m[1;39m([0m[39mtis, xhtml, metadata, false[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:            [0m[1;35mparentMetadata.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_EXCEPTION,[0m           [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:                    [0m[1;35mExceptionUtils.getStackTrace[0m[1;39m([0m[39me[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy for SSRF Vulnerability in TextAndCSVParser[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Analysis Summary[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe SSRF vulnerability is caused by the `[0m[1;35mprocessURL[0m[1;39m([0m[1;39m)[0m[39m` method in TextAndCSVParser, [0m [2m                [0m
[2;36m                    [0m         [39mwhich automatically fetches content from URLs found in Excel HYPERLINK formulas [0m    [2m                [0m
[2;36m                    [0m         [39mwithin CSV cells. When a HYPERLINK pattern like [0m                                    [2m                [0m
[2;36m                    [0m         [39m`=[0m[1;35mHYPERLINK[0m[1;39m([0m[32m"https://jazzer.com:443"[0m[39m, [0m[32m"text"[0m[1;39m)[0m[39m` is detected, the parser:[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Extracts the URL without validation[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Creates a URL connection[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Calls `[0m[1;35mconnection.getInputStream[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m278[0m[39m, establishing an actual network [0m [2m                [0m
[2;36m                    [0m         [39mconnection[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Fetches and parses the remote content[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Critical findings:**[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- Similar parsers [0m[1;39m([0m[39mOneNoteTreeWalker, MSOneStorePackage[0m[1;39m)[0m[39m only render hyperlinks as [0m [2m                [0m
[2;36m                    [0m         [39mHTML anchors WITHOUT fetching content[0m                                               [2m                [0m
[2;36m                    [0m         [39m- Existing safety mechanisms [0m[1;39m([0m[39mEmptyParser, DocumentSelector[0m[1;39m)[0m[39m cannot prevent this [0m   [2m                [0m
[2;36m                    [0m         [39mSSRF because the network request happens BEFORE any embedded document extractor [0m    [2m                [0m
[2;36m                    [0m         [39mchecks[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m- The test case only verifies anchor tag rendering, not URL content fetching[0m        [2m                [0m
[2;36m                    [0m         [39m- No configuration exists to disable this behavior[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Root Cause[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability exists in two locations:[0m                                          [2m                [0m
[2;36m                    [0m         [39m- **Line [0m[1;36m261[0m[39m** of `[0m[1;35mTextAndCSVParser.processCell[0m[1;39m([0m[1;39m)[0m[39m`: Unconditional call to [0m          [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mprocessURL[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- **Lines [0m[1;36m268[0m[39m-[0m[1;36m285[0m[39m** of `[0m[1;35mTextAndCSVParser.processURL[0m[1;39m([0m[1;39m)[0m[39m`: Network request without [0m    [2m                [0m
[2;36m                    [0m         [39mvalidation[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Recommended Fix Strategy[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Remove the URL fetching functionality entirely** [0m[1;39m([0m[39maligns with safe patterns in [0m   [2m                [0m
[2;36m                    [0m         [39mcodebase[0m[1;39m)[0m[39m:[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m1[0m[39m: Remove the `[0m[1;35mprocessURL[0m[1;39m([0m[1;39m)[0m[39m` method call[0m                                  [2m                [0m
[2;36m                    [0m         [39m- In `[0m[1;35mprocessCell[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mline [0m[1;36m261[0m[1;39m)[0m[39m, remove the call to `[0m[1;35mprocessURL[0m[1;39m([0m[39murl, name, [0m  [2m                [0m
[2;36m                    [0m         [39mxhtml, metadata, context[0m[1;39m)[0m[39m`[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- Keep the HYPERLINK pattern matching logic [0m[1;39m([0m[39mlines [0m[1;36m251[0m[39m-[0m[1;36m257[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m- Keep the HTML anchor tag rendering [0m[1;39m([0m[39mlines [0m[1;36m258[0m[39m-[0m[1;36m260[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m2[0m[39m: Remove the `[0m[1;35mprocessURL[0m[1;39m([0m[1;39m)[0m[39m` method[0m                                       [2m                [0m
[2;36m                    [0m         [39m- Delete the entire `[0m[1;35mprocessURL[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m268[0m[39m-[0m[1;36m285[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [39m- This method is only called from line [0m[1;36m261[0m[39m and has no other callers[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m3[0m[39m: Remove unused imports [0m[1;39m([0m[39mif any[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [39m- After removing `[0m[1;35mprocessURL[0m[1;39m([0m[1;39m)[0m[39m`, check if any imports are no longer needed[0m          [2m                [0m
[2;36m                    [0m         [39m- Specifically, `java.net.URL` and `java.net.URLConnection` [0m[1;39m([0m[39mlines [0m[1;36m25[0m[39m-[0m[1;36m26[0m[1;39m)[0m[39m may no [0m   [2m                [0m
[2;36m                    [0m         [39mlonger be required[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- Keep these imports ONLY if they are used elsewhere in the file[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Implementation Details[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe modified `[0m[1;35mprocessCell[0m[1;39m([0m[1;39m)[0m[39m` method should look like:[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate void [0m[1;35mprocessCell[0m[1;39m([0m[39mString cellContent, XHTMLContentHandler xhtml,[0m             [2m                [0m
[2;36m                    [0m         [39m                         Metadata metadata,[0m                                         [2m                [0m
[2;36m                    [0m         [39m                         ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mxhtml.startElement[0m[1;39m([0m[39mTD[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m    Matcher m = [0m[1;35mHYPERLINK_PATTERN.matcher[0m[1;39m([0m[39mcellContent[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mm.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        String url = [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m        String name = [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [39m            name = url;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"a"[0m[39m, [0m[32m"href"[0m[39m, url[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mxhtml.characters[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"a"[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[35m/[0m[39m REMOVED: [0m[1;35mprocessURL[0m[1;39m([0m[39murl, name, xhtml, metadata, context[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mxhtml.characters[0m[1;39m([0m[39mcellContent[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mxhtml.endElement[0m[1;39m([0m[39mTD[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis change:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- Preserves HYPERLINK detection and extraction[0m                                      [2m                [0m
[2;36m                    [0m         [39m- Maintains HTML anchor tag rendering with href attribute[0m                           [2m                [0m
[2;36m                    [0m         [39m- Removes the SSRF vulnerability by not fetching URL content[0m                        [2m                [0m
[2;36m                    [0m         [39m- Aligns with the safe pattern used in OneNoteTreeWalker and MSOneStorePackage[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Justification[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why this is the optimal approach:**[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Security**: Completely eliminates the SSRF vulnerability by removing network [0m  [2m                [0m
[2;36m                    [0m         [39mrequests from untrusted input[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Consistency**: Aligns with how other Tika parsers [0m[1;39m([0m[39mOneNoteTreeWalker, [0m         [2m                [0m
[2;36m                    [0m         [39mMSOneStorePackage[0m[1;39m)[0m[39m handle HYPERLINK formulas[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Simplicity**: Simple removal without adding configuration complexity[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Backward Compatibility**: The test case expects only anchor tag rendering, not[0m [2m                [0m
[2;36m                    [0m         [39mcontent fetching[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Functionality Preservation**: Users can still see and access hyperlinks in the[0m [2m                [0m
[2;36m                    [0m         [39mparsed output as HTML anchors[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How it preserves existing logic:**[0m                                                [2m                [0m
[2;36m                    [0m         [39m- CSV/TSV parsing remains unchanged[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- Delimiter detection works as before[0m                                               [2m                [0m
[2;36m                    [0m         [39m- Character encoding detection is preserved[0m                                         [2m                [0m
[2;36m                    [0m         [39m- HYPERLINK pattern matching continues to work[0m                                      [2m                [0m
[2;36m                    [0m         [39m- HTML table structure [0m[1;39m([0m[39mtable/tr/td elements[0m[1;39m)[0m[39m is maintained[0m                         [2m                [0m
[2;36m                    [0m         [39m- Metadata extraction [0m[1;39m([0m[39mdelimiter, row/column counts[0m[1;39m)[0m[39m is preserved[0m                   [2m                [0m
[2;36m                    [0m         [39m- All other cell content processing remains identical[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How it addresses the evaluation report:**[0m                                         [2m                [0m
[2;36m                    [0m         [39m- Eliminates the network connection attempt to external domains[0m                     [2m                [0m
[2;36m                    [0m         [39m- Prevents potential data exfiltration through malicious URLs[0m                       [2m                [0m
[2;36m                    [0m         [39m- Removes the ability to probe internal networks via SSRF[0m                           [2m                [0m
[2;36m                    [0m         [39m- Blocks attempts to access internal services through CSV hyperlinks[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential side effects and mitigation:**[0m                                          [2m                [0m
[2;36m                    [0m         [39m- **Side effect**: If any users rely on automatic URL content fetching [0m[1;39m([0m[39munlikely [0m   [2m                [0m
[2;36m                    [0m         [39mbased on test expectations[0m[1;39m)[0m[39m, this feature will be removed[0m                           [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: This is intentional - the feature is a security vulnerability. [0m   [2m                [0m
[2;36m                    [0m         [39mUsers who need embedded document extraction from URLs can:[0m                          [2m                [0m
[2;36m                    [0m         [39m  - Extract URLs from the parsed output and fetch them separately with proper [0m      [2m                [0m
[2;36m                    [0m         [39mvalidation[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m  - Use a custom EmbeddedDocumentExtractor with URL validation if needed[0m            [2m                [0m
[2;36m                    [0m         [39m- **Test impact**: The existing test case `[0m[1;35mtestHyperlink[0m[1;39m([0m[1;39m)[0m[39m` should pass without [0m    [2m                [0m
[2;36m                    [0m         [39mmodification as it only checks for anchor tag rendering, not content fetching[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m6[0m[39m. Alternative Approach [0m[1;39m([0m[39mNot Recommended[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAn alternative would be to add a configuration flag to make URL fetching opt-in [0m    [2m                [0m
[2;36m                    [0m         [39mwith validation:[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- Add `shouldFetchHyperlinkUrls` flag to TextAndCSVConfig [0m[1;39m([0m[39mdefault: false[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m- Implement URL validation [0m[1;39m([0m[39mscheme checking, IP address filtering, [0m                 [2m                [0m
[2;36m                    [0m         [39mallowlist/blocklist[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [39m- Check configuration before calling [0m[1;35mprocessURL[0m[1;39m([0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why this is NOT recommended:**[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Adds complexity without clear benefit[0m                                             [2m                [0m
[2;36m                    [0m         [39m- Even with validation, SSRF protection is difficult to implement correctly[0m         [2m                [0m
[2;36m                    [0m         [39m- No evidence that URL fetching is an intentional or required feature[0m               [2m                [0m
[2;36m                    [0m         [39m- Other parsers don't fetch URL content, so there's no expectation for this [0m        [2m                [0m
[2;36m                    [0m         [39mbehavior[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m7[0m[39m. Files to Modify[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mOnly one file needs modification:[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- [0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m`tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-[0m [2m                [0m
[2;36m                    [0m         [39mmodule/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java`[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mChanges required:[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Line [0m[1;36m261[0m[39m: Remove the `[0m[1;35mprocessURL[0m[1;39m([0m[1;39m)[0m[39m` call[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Lines [0m[1;36m268[0m[39m-[0m[1;36m285[0m[39m: Delete the entire `[0m[1;35mprocessURL[0m[1;39m([0m[1;39m)[0m[39m` method[0m                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Lines [0m[1;36m25[0m[39m-[0m[1;36m26[0m[39m: Optionally remove unused imports [0m[1;39m([0m[39mURL, URLConnection[0m[1;39m)[0m[39m if not used [0m  [2m                [0m
[2;36m                    [0m         [39melsewhere[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mNo changes needed to:[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Test files [0m[1;39m([0m[39mexisting tests should pass[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m- Configuration files [0m[1;39m([0m[39mTextAndCSVConfig[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [39m- Other parsers or utility classes[0m                                                  [2m                [0m
[2;36m                    [0m         [39m- Harness or fuzzing code[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=344500;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=359674;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=151430;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=282555;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpngfvya_3[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-full-01_vuln_7/[0m[95magent-[0m [2m               [0m
[2;36m                    [0m         [95moutput-1768303970.793827[0m                                                             [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/tika_tk-full-01_vuln_7.toml  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/13/26 11:32:53][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mtika[0m           ]8;id=103486;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=456765;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=520302;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=891509;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=938711;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=536109;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mtika[0m                   [2m               [0m
