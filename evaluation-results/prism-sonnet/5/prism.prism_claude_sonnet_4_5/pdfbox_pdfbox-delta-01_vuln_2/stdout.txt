[2;36m[01/13/26 04:22:02][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=684666;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=279440;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpo70wcu_3[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-delta-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768278122.6006713[0m                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-delta-01_vuln_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=628375;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=103116;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:23:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Took      ]8;id=334960;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=76912;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m97.41[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=636921;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=673424;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=281578;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=154961;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=263246;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=140081;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m97[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=416115;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=175807;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.90[0m seconds;                ]8;id=886461;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=877051;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 04:23:42][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=965728;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=694536;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=824179;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=577703;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=535737;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=816117;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=965642;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=407581;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:23:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m1.13[0m seconds;                ]8;id=197344;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=245706;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=689833;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=233680;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:23:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.94[0m seconds;                ]8;id=238890;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=555390;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 04:23:51][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=173956;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=797076;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.kt:[1;36m60[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.doOCR[0m[1m([0mOCRStreamEngine.jav[1;92ma:190[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.runTesseract[0m[1m([0mOCRStreamEngine.jav[1;92ma:165[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPage[0m[1m([0mOCRStreamEngine.jav[1;92ma:150[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPages[0m[1m([0mOCRStreamEngine.jav[1;92ma:140[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.writeText[0m[1m([0mOCRStreamEngine.jav[1;92ma:129[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1m([0mOCRStreamEngine.jav[1;92ma:88[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1m([0mOCRStreamEngine.jav[1;92ma:71[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1m([0mNative   [2m                [0m
[2;36m                    [0m         Method[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1m([0mNativeMethodAccessor [2m                [0m
[2;36m                    [0m         Impl.jav[1;92ma:77[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1m([0mDelegatingMethod [2m                [0m
[2;36m                    [0m         AccessorImpl.jav[1;92ma:43[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.reflect.Method.invoke[0m[1m([0mMethod.jav[1;92ma:568[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.PDFOCRFuzzer.fuzzerTestOneInput[0m[1m([0mPDFOCRFuzzer.jav[1;92ma:75[0m[1m)[0m        [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: af83c7db521bbc07                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.kt:[1;36m60[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.doOCR[0m[1m([0mOCRStreamEngine.jav[1;92ma:190[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.runTesseract[0m[1m([0mOCRStreamEngine.jav[1;92ma:165[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPage[0m[1m([0mOCRStreamEngine.jav[1;92ma:150[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPages[0m[1m([0mOCRStreamEngine.jav[1;92ma:140[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.writeText[0m[1m([0mOCRStreamEngine.jav[1;92ma:129[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1m([0mOCRStreamEngine.jav[1;92ma:88[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1m([0mOCRStreamEngine.jav[1;92ma:71[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1m([0mNative   [2m                [0m
[2;36m                    [0m         Method[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1m([0mNativeMethodAccessor [2m                [0m
[2;36m                    [0m         Impl.jav[1;92ma:77[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1m([0mDelegatingMethod [2m                [0m
[2;36m                    [0m         AccessorImpl.jav[1;92ma:43[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.reflect.Method.invoke[0m[1m([0mMethod.jav[1;92ma:568[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.PDFOCRFuzzer.fuzzerTestOneInput[0m[1m([0mPDFOCRFuzzer.jav[1;92ma:75[0m[1m)[0m        [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: af83c7db521bbc07                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 04:24:10][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=667418;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=349278;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 04:28:43][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=781565;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=578875;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 04:29:59][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=550523;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=766172;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=198041;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=103109;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:30:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.91[0m seconds;                ]8;id=787989;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=770276;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Started[33m...[0m                              ]8;id=554111;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=797343;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp0fsrxun7[0m                                                 ]8;id=504358;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=271688;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 04:31:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Took [1;36m80.50[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=391926;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=644366;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Started[33m...[0m                        ]8;id=373889;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=943359;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:31:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Took [1;36m15.28[0m seconds;              ]8;id=412248;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=686078;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Started[33m...[0m                           ]8;id=888630;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=211950;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:31:47][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Took [1;36m11.13[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=29970;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=288814;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Started[33m...[0m                               ]8;id=667396;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=208162;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=955998;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=204738;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=430367;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=346532;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:31:48][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.90[0m seconds;                ]8;id=838313;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=963872;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 04:31:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=666099;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=810720;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:31:50][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.96[0m seconds;                ]8;id=264796;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=402475;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=774820;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=282669;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:31:51][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.93[0m seconds;                ]8;id=373830;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=117890;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 04:31:52][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=559785;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=100454;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java               [2m                [0m
[2;36m                    [0m         +++ b/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java               [2m                [0m
[2;36m                    [0m         @@ [1;36m-33[0m,[1;36m7[0m +[1;36m33[0m,[1;36m6[0m @@                                                                   [2m                [0m
[2;36m                    [0m           *[35m/[0m                                                                                [2m                [0m
[2;36m                    [0m          public class OCRStreamEngine [1m{[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -    private static final String TESSERACT_PATH_KEY = [32m"tesseract-path"[0m;             [2m                [0m
[2;36m                    [0m              private PDFRenderer pdfRenderer = null;                                        [2m                [0m
[2;36m                    [0m              private String tesseractPath = [32m"tesseract"[0m;                                    [2m                [0m
[2;36m                    [0m              private int pageIndex = [1;36m0[0m;                                                     [2m                [0m
[2;36m                    [0m         @@ [1;36m-155[0m,[1;36m11[0m +[1;36m154[0m,[1;36m7[0m @@                                                                [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              private String [1;35mrunTesseract[0m[1m([0mPath image[1m)[0m throws IOException [1m{[0m                   [2m                [0m
[2;36m                    [0m         -        String actualTessPath = [1;35mpdDocument.getDocumentInformation[0m[1m([0m[1m)[0m                [2m                [0m
[2;36m                    [0m         -                [1;35m.getCustomMetadataValue[0m[1m([0mTESSERACT_PATH_KEY[1m)[0m;                       [2m                [0m
[2;36m                    [0m         -        if [1m([0mactualTessPath == null || [1;35mactualTessPath.isEmpty[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                  [2m                [0m
[2;36m                    [0m         -            actualTessPath = tesseractPath;                                        [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        String actualTessPath = tesseractPath;                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  Path txt = [1;35mPaths.get[0m[1m([0m[1;35mimage.toAbsolutePath[0m[1m([0m[1m)[0m[1;35m.toString[0m[1m([0m[1m)[0m[1m)[0m;                   [2m                [0m
[2;36m                    [0m                  [1;35mdoOCR[0m[1m([0mactualTessPath, image, txt[1m)[0m;                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         --- a/pdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.java                       [2m                [0m
[2;36m                    [0m         +++ b/pdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.java                       [2m                [0m
[2;36m                    [0m         @@ [1;36m-50[0m,[1;36m17[0m +[1;36m50[0m,[1;36m19[0m @@                                                                 [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              @Test                                                                          [2m                [0m
[2;36m                    [0m         -    public void [1;35mtestOverride[0m[1m([0m[1m)[0m throws Exception                                    [2m                [0m
[2;36m                    [0m         +    public void [1;35mtestMetadataIsIgnored[0m[1m([0m[1m)[0m throws Exception                           [2m                [0m
[2;36m                    [0m              [1m{[0m                                                                              [2m                [0m
[2;36m                    [0m         -        if [1m([0m![1;35mFiles.isExecutable[0m[1m([0m[1;35mPaths.get[0m[1m([0m[32m"/usr/my-bin/tesseract"[0m[1m)[0m[1m)[0m[1m)[0m               [2m                [0m
[2;36m                    [0m         +        if [1m([0mTESSERACT_PATH == null[1m)[0m                                                [2m                [0m
[2;36m                    [0m                  [1m{[0m                                                                          [2m                [0m
[2;36m                    [0m                      return;                                                                [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         -        Path p =                                                                   [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1m([0m[1;35mTestOCR.class.getResource[0m[1m([0m[32m"testOCRCustomPath.pdf"[0m[1m)[0m[1;35m.toURI[0m[1m([0m[1m)[0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +        Path p = [1;35mPaths.get[0m[1m([0m[1;35mTestOCR.class.getResource[0m[1m([0m[32m"testOCR.pdf"[0m[1m)[0m[1;35m.toURI[0m[1m([0m[1m)[0m[1m)[0m;      [2m                [0m
[2;36m                    [0m                  PDDocument pdDocument = [1;35mLoader.loadPDF[0m[1m([0m[1;35mp.toFile[0m[1m([0m[1m)[0m[1m)[0m;                        [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         [1;35mpdDocument.getDocumentInformation[0m[1m([0m[1m)[0m[1;35m.setCustomMetadataValue[0m[1m([0m[32m"tesseract-path"[0m,        [2m                [0m
[2;36m                    [0m         [32m"/malicious/path"[0m[1m)[0m;                                                                 [2m                [0m
[2;36m                    [0m                  OCRStreamEngine ocrStreamEngine = new [1;35mOCRStreamEngine[0m[1m([0mpdDocument[1m)[0m;         [2m                [0m
[2;36m                    [0m         -        [1;35mocrStreamEngine.setTesseractPath[0m[1m([0m[32m"some-other-path"[0m[1m)[0m;                       [2m                [0m
[2;36m                    [0m         +        [1;35mocrStreamEngine.setTesseractPath[0m[1m([0mTESSERACT_PATH[1m)[0m;                          [2m                [0m
[2;36m                    [0m                  String txt = [1;35mocrStreamEngine.getText[0m[1m([0m[1;36m1[0m, [1;36m1[0m[1m)[0m;                                [2m                [0m
[2;36m                    [0m                  [1;35massertTrue[0m[1m([0m[1;35mtxt.contains[0m[1m([0m[32m"Happy New Year"[0m[1m)[0m[1m)[0m;                                [2m                [0m
[2;36m                    [0m         +        [1;35mpdDocument.close[0m[1m([0m[1m)[0m;                                                        [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.kt:[1;36m60[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.doOCR[0m[1m([0mOCRStreamEngine.jav[1;92ma:190[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.runTesseract[0m[1m([0mOCRStreamEngine.jav[1;92ma:165[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPage[0m[1m([0mOCRStreamEngine.jav[1;92ma:150[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPages[0m[1m([0mOCRStreamEngine.jav[1;92ma:140[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.writeText[0m[1m([0mOCRStreamEngine.jav[1;92ma:129[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1m([0mOCRStreamEngine.jav[1;92ma:88[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1m([0mOCRStreamEngine.jav[1;92ma:71[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1m([0mNative   [2m                [0m
[2;36m                    [0m         Method[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1m([0mNativeMethodAccessor [2m                [0m
[2;36m                    [0m         Impl.jav[1;92ma:77[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1m([0mDelegatingMethod [2m                [0m
[2;36m                    [0m         AccessorImpl.jav[1;92ma:43[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.reflect.Method.invoke[0m[1m([0mMethod.jav[1;92ma:568[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.PDFOCRFuzzer.fuzzerTestOneInput[0m[1m([0mPDFOCRFuzzer.jav[1;92ma:75[0m[1m)[0m        [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: af83c7db521bbc07                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A critical security vulnerability [1m([0mOS Command Injection[1m)[0m has been detected in       [2m                [0m
[2;36m                    [0m         Apache PDFBox's OCR functionality. The fuzzer identified that the `OCRStreamEngine` [2m                [0m
[2;36m                    [0m         class executes operating system commands with potentially attacker-controlled data, [2m                [0m
[2;36m                    [0m         which could lead to remote code execution. The issue occurs during the execution of [2m                [0m
[2;36m                    [0m         Tesseract OCR processing when processing PDF documents.                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Vulnerability Type                                                              [2m                [0m
[2;36m                    [0m         This is an **OS Command Injection** vulnerability, classified as a critical         [2m                [0m
[2;36m                    [0m         security issue. OS Command Injection occurs when an application passes unsafe       [2m                [0m
[2;36m                    [0m         user-supplied data to a system shell, allowing attackers to execute arbitrary       [2m                [0m
[2;36m                    [0m         commands on the host operating system.                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Issue Details                                                                   [2m                [0m
[2;36m                    [0m         The vulnerability manifests in the following execution flow:                        [2m                [0m
[2;36m                    [0m         [1;36m1[0m. The entry point is `[1;35mOCRStreamEngine.getText[0m[1m([0m[1m)[0m` being called with                 [2m                [0m
[2;36m                    [0m         attacker-controlled input [1m([0ma PDF document[1m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m. The call chain proceeds through:                                                 [2m                [0m
[2;36m                    [0m            - `[1;35mOCRStreamEngine.writeText[0m[1m([0m[1m)[0m`                                                  [2m                [0m
[2;36m                    [0m            - `[1;35mOCRStreamEngine.processPages[0m[1m([0m[1m)[0m`                                               [2m                [0m
[2;36m                    [0m            - `[1;35mOCRStreamEngine.processPage[0m[1m([0m[1m)[0m`                                                [2m                [0m
[2;36m                    [0m            - `[1;35mOCRStreamEngine.runTesseract[0m[1m([0m[1m)[0m`                                               [2m                [0m
[2;36m                    [0m            - `[1;35mOCRStreamEngine.doOCR[0m[1m([0m[1m)[0m`                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m. At `[1;35mdoOCR[0m[1m([0m[1m)[0m` method [1m([0mline [1;36m190[0m[1m)[0m, a `[1;35mProcessBuilder.start[0m[1m([0m[1m)[0m` is invoked            [2m                [0m
[2;36m                    [0m         [1;36m4[0m. The Jazzer sanitizer's `[1;35mOsCommandInjection.processImplStartHook[0m[1m([0m[1m)[0m` detects that  [2m                [0m
[2;36m                    [0m         attacker-controlled data is being used in the OS command execution                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         The detection occurred at the `[1;35mProcessBuilder.start[0m[1m([0m[1m)[0m` level, indicating that       [2m                [0m
[2;36m                    [0m         user-controllable data from the PDF input is being incorporated into system command [2m                [0m
[2;36m                    [0m         execution without proper sanitization or validation.                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Key Observations                                                                [2m                [0m
[2;36m                    [0m         - The vulnerability is in the production code                                       [2m                [0m
[2;36m                    [0m         [1m([0m`org.apache.pdfbox.ocr.OCRStreamEngine`[1m)[0m, not in test harness code                 [2m                [0m
[2;36m                    [0m         - The issue specifically affects the OCR [1m([0mOptical Character Recognition[1m)[0m            [2m                [0m
[2;36m                    [0m         functionality when interfacing with Tesseract                                       [2m                [0m
[2;36m                    [0m         - The execution path shows a systematic processing of PDF pages through OCR,        [2m                [0m
[2;36m                    [0m         suggesting the vulnerability could be triggered by specially crafted PDF documents  [2m                [0m
[2;36m                    [0m         - The security sanitizer hook triggered at `OsCommandInjection.kt:[1;36m60[0m` indicates     [2m                [0m
[2;36m                    [0m         this is a known vulnerability pattern being detected                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Code Areas Requiring Investigation                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         To obtain a comprehensive understanding of this vulnerability, the following        [2m                [0m
[2;36m                    [0m         components should be investigated:                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **`org.apache.pdfbox.ocr.OCRStreamEngine` class**:                               [2m                [0m
[2;36m                    [0m            - The `[1;35mdoOCR[0m[1m([0m[1m)[0m` method [1m([0mline [1;36m190[0m[1m)[0m - where the actual command execution occurs    [2m                [0m
[2;36m                    [0m            - The `[1;35mrunTesseract[0m[1m([0m[1m)[0m` method [1m([0mline [1;36m165[0m[1m)[0m - responsible for preparing Tesseract   [2m                [0m
[2;36m                    [0m         execution                                                                           [2m                [0m
[2;36m                    [0m            - The `[1;35mprocessPage[0m[1m([0m[1m)[0m` method [1m([0mline [1;36m150[0m[1m)[0m - handles individual page processing     [2m                [0m
[2;36m                    [0m            - The `[1;35mprocessPages[0m[1m([0m[1m)[0m` method [1m([0mline [1;36m140[0m[1m)[0m - orchestrates page iteration           [2m                [0m
[2;36m                    [0m            - The `[1;35mwriteText[0m[1m([0m[1m)[0m` and `[1;35mgetText[0m[1m([0m[1m)[0m` methods - entry points for OCR text          [2m                [0m
[2;36m                    [0m         extraction                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **Command Construction Logic**:                                                  [2m                [0m
[2;36m                    [0m            - How the command string or command array is built for ProcessBuilder            [2m                [0m
[2;36m                    [0m            - What data from the PDF document is incorporated into the command               [2m                [0m
[2;36m                    [0m            - Whether any input validation or sanitization is performed before command       [2m                [0m
[2;36m                    [0m         construction                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Data Flow Analysis**:                                                          [2m                [0m
[2;36m                    [0m            - Trace how data from the input PDF document flows through the method chain      [2m                [0m
[2;36m                    [0m            - Identify which PDF elements [1m([0mmetadata, content, embedded objects, etc.[1m)[0m        [2m                [0m
[2;36m                    [0m         influence the command being executed                                                [2m                [0m
[2;36m                    [0m            - Determine if file paths, filenames, or other PDF-derived strings are used in   [2m                [0m
[2;36m                    [0m         command construction                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **Tesseract Integration**:                                                       [2m                [0m
[2;36m                    [0m            - How the Tesseract OCR tool is invoked                                          [2m                [0m
[2;36m                    [0m            - What parameters or arguments are passed to Tesseract                           [2m                [0m
[2;36m                    [0m            - Whether temporary files are created and how they are named                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m. **ProcessBuilder Usage**:                                                        [2m                [0m
[2;36m                    [0m            - The exact arguments passed to the ProcessBuilder constructor                   [2m                [0m
[2;36m                    [0m            - Any environment variables or working directory settings that might be affected [2m                [0m
[2;36m                    [0m         by input data                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.kt:[0m[1;36m60[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.ocr.OCRStreamEngine.doOCR[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:190[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.runTesseract[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:165[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPage[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:150[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.processPages[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:140[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.ocr.OCRStreamEngine.writeText[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:129[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:88[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.ocr.OCRStreamEngine.getText[0m[1;39m([0m[39mOCRStreamEngine.jav[0m[1;92ma:71[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1;39m([0m[39mNative [0m  [2m                [0m
[2;36m                    [0m         [39mMethod[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1;39m([0m[39mNativeMethodAccessor[0m [2m                [0m
[2;36m                    [0m         [39mImpl.jav[0m[1;92ma:77[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1;39m([0m[39mDelegatingMethod[0m [2m                [0m
[2;36m                    [0m         [39mAccessorImpl.jav[0m[1;92ma:43[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.reflect.Method.invoke[0m[1;39m([0m[39mMethod.jav[0m[1;92ma:568[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.PDFOCRFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFOCRFuzzer.jav[0m[1;92ma:75[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: af83c7db521bbc07[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:1[0m[39m-[0m[1;36m22[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:package org.apache.pdfbox.ocr;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:import java.awt.image.BufferedImage;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:import java.io.IOException;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:import java.io.InputStream;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:import java.io.InputStreamReader;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:import java.io.Reader;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:import java.io.StringWriter;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:import java.io.Writer;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:import java.nio.file.FileVisitResult;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:import java.nio.file.SimpleFileVisitor;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:34[0m[39m-[0m[1;36m60[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:public class OCRStreamEngine [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final String TESSERACT_PATH_KEY = [0m[32m"tesseract-path"[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    private PDFRenderer pdfRenderer = null;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private String tesseractPath = [0m[32m"tesseract"[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private int pageIndex = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private int startPage = [0m[1;36m-1[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    private int endPage = [0m[1;36m-1[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private long timeoutMillisPerPage = [0m[1;36m30000[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private final PDDocument pdDocument;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private Path tmpDir;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    public [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mPDDocument pdDocument[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        this.pdDocument = pdDocument;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        pdfRenderer = new [0m[1;35mPDFRenderer[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public void [0m[1;35msetTimeoutMillisPerPage[0m[1;39m([0m[39mlong millisPerPage[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        this.timeoutMillisPerPage = millisPerPage;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public void [0m[1;35msetTesseractPath[0m[1;39m([0m[39mString tesseractPath[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        this.tesseractPath = tesseractPath;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:157[0m[39m-[0m[1;36m197[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    private String [0m[1;35mrunTesseract[0m[1;39m([0m[39mPath image[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        String actualTessPath = [0m[1;35mpdDocument.getDocumentInformation[0m[1;39m([0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[1;35m.getCustomMetadataValue[0m[1;39m([0m[39mTESSERACT_PATH_KEY[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        if [0m[1;39m([0m[39mactualTessPath == null || [0m[1;35mactualTessPath.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            actualTessPath = tesseractPath;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mimage.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[1;35mdoOCR[0m[1;39m([0m[39mactualTessPath, image, txt[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        return [0m[1;35mextractContent[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    private String [0m[1;35mextractContent[0m[1;39m([0m[39mPath base[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mbase.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m".txt"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        if [0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            return [0m[1;35mFiles.readString[0m[1;39m([0m[39mtxt, UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:        [0m[35m/[0m[35m/[0m[95mlog[0m[39m missing txt file[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        return [0m[32m""[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    private void [0m[1;35mdoOCR[0m[1;39m([0m[39mString actualTesseractPath, Path input, Path output[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:            throws IOException [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        ArrayList<String> cmd = new ArrayList<>[0m[1;39m([0m                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                [0m[1;35mArrays.asList[0m[1;39m([0m[39mactualTesseractPath, [0m                             [2m                [0m
[2;36m                    [0m         [1;35minput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                        [0m[1;35moutput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35mrunOCRProcess[0m[1;39m([0m[39mprocess, timeoutMillisPerPage[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            if [0m[1;39m([0m[39mprocess != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                [0m[1;35mprocess.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocumentInformation.jav[0m[1;92ma:19[0m[39m-[0m[1;36m26[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.Calendar;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.TreeSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.pdfbox.cos.COSDictionary;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.pdfbox.cos.COSName;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.pdfbox.pdmodel.common.COSObjectable;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocumentInformation.jav[0m[1;92ma:37[0m[39m-[0m[1;36m68[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public class PDDocumentInformation implements COSObjectable[0m                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private final COSDictionary info;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * Default Constructor.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    public [0m[1;35mPDDocumentInformation[0m[1;39m([0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        info = new [0m[1;35mCOSDictionary[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * Constructor that is used for a preexisting dictionary.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * @param dic The underlying dictionary.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public [0m[1;35mPDDocumentInformation[0m[1;39m([0m[39m COSDictionary dic [0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        info = dic;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * This will get the underlying dictionary that this object wraps.[0m           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * @return The underlying info dictionary.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    public COSDictionary [0m[1;35mgetCOSObject[0m[1;39m([0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        return info;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m}[0m[39m    [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocumentInformation.jav[0m[1;92ma:272[0m[39m-[0m[1;36m294[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:     *  This will get the value of a custom metadata information field for the [0m [2m                [0m
[2;36m                    [0m         [39mdocument.[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:     *  This will return null if one is not found.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:     * @param fieldName Name of custom metadata field from pdf document.[0m        [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:     * @return String Value of metadata field[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    public String [0m[1;35mgetCustomMetadataValue[0m[1;39m([0m[39mString fieldName[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        return [0m[1;35minfo.getString[0m[1;39m([0m[39m fieldName [0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:     * Set the custom metadata value.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:     * @param fieldName The name of the custom metadata field.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:     * @param fieldValue The value to the custom metadata field.[0m                [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    public void [0m[1;35msetCustomMetadataValue[0m[1;39m([0m[39m String fieldName, String fieldValue [0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        [0m[1;35minfo.setString[0m[1;39m([0m[39m fieldName, fieldValue [0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:34[0m[39m-[0m[1;36m60[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:public class OCRStreamEngine [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final String TESSERACT_PATH_KEY = [0m[32m"tesseract-path"[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    private PDFRenderer pdfRenderer = null;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private String tesseractPath = [0m[32m"tesseract"[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private int pageIndex = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private int startPage = [0m[1;36m-1[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    private int endPage = [0m[1;36m-1[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private long timeoutMillisPerPage = [0m[1;36m30000[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private final PDDocument pdDocument;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private Path tmpDir;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    public [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mPDDocument pdDocument[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        this.pdDocument = pdDocument;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        pdfRenderer = new [0m[1;35mPDFRenderer[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public void [0m[1;35msetTimeoutMillisPerPage[0m[1;39m([0m[39mlong millisPerPage[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        this.timeoutMillisPerPage = millisPerPage;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public void [0m[1;35msetTesseractPath[0m[1;39m([0m[39mString tesseractPath[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        this.tesseractPath = tesseractPath;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:82[0m[39m-[0m[1;36m95[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    public String [0m[1;35mgetText[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        StringWriter outputStream = new [0m[1;35mStringWriter[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        pageIndex = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            tmpDir = [0m[1;35mFiles.createTempDirectory[0m[1;39m([0m[32m"pdfbox-ocr"[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            [0m[1;35mwriteText[0m[1;39m([0m[39mpdDocument, outputStream[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:            return [0m[1;35moutputStream.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            if [0m[1;39m([0m[39mtmpDir != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                [0m[1;35mquietlyDeleteDir[0m[1;39m([0m[39mtmpDir[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:145[0m[39m-[0m[1;36m155[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    public void [0m[1;35mprocessPage[0m[1;39m([0m[39mWriter writer[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            BufferedImage image = [0m[1;35mpdfRenderer.renderImage[0m[1;39m([0m[39mpageIndex[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            Path target = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[39mtmpDir, [0m[32m"render-"[0m[39m + pageIndex + [0m [2m                [0m
[2;36m                    [0m         [32m"-"[0m[39m, [0m[32m".png"[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[1;35mImageIO.write[0m[1;39m([0m[39mimage, [0m[32m"PNG"[0m[39m, [0m[1;35mtarget.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            String txt = [0m[1;35mrunTesseract[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;35mwriter.append[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[1;35m.append[0m[1;39m([0m[32m"\n"[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            pageIndex++;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:157[0m[39m-[0m[1;36m167[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    private String [0m[1;35mrunTesseract[0m[1;39m([0m[39mPath image[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        String actualTessPath = [0m[1;35mpdDocument.getDocumentInformation[0m[1;39m([0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[1;35m.getCustomMetadataValue[0m[1;39m([0m[39mTESSERACT_PATH_KEY[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        if [0m[1;39m([0m[39mactualTessPath == null || [0m[1;35mactualTessPath.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            actualTessPath = tesseractPath;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mimage.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[1;35mdoOCR[0m[1;39m([0m[39mactualTessPath, image, txt[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        return [0m[1;35mextractContent[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:178[0m[39m-[0m[1;36m197[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    private void [0m[1;35mdoOCR[0m[1;39m([0m[39mString actualTesseractPath, Path input, Path output[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:            throws IOException [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        ArrayList<String> cmd = new ArrayList<>[0m[1;39m([0m                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                [0m[1;35mArrays.asList[0m[1;39m([0m[39mactualTesseractPath, [0m                             [2m                [0m
[2;36m                    [0m         [1;35minput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                        [0m[1;35moutput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35mrunOCRProcess[0m[1;39m([0m[39mprocess, timeoutMillisPerPage[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            if [0m[1;39m([0m[39mprocess != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                [0m[1;35mprocess.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.jav[0m[1;92ma:1[0m[39m-[0m[1;36m12[0m                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:package org.apache.pdfbox.ocr;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:import static org.junit.jupiter.api.Assertions.assertTrue;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:import java.nio.file.Files;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:import java.nio.file.Path;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:import java.nio.file.Paths;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:import org.apache.pdfbox.Loader;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:import org.apache.pdfbox.pdmodel.PDDocument;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:import org.junit.jupiter.api.BeforeAll;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:import org.junit.jupiter.api.Test;[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.jav[0m[1;92ma:16[0m[39m-[0m[1;36m50[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:    static String TESSERACT_PATH;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:    @BeforeAll[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:    static void [0m[1;35msetUp[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:        [0m[35m/[0m[35m/[0m[95mthese[0m[39m are some common locations for tesseract on linux[0m                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:        if [0m[1;39m([0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:            TESSERACT_PATH = [0m[32m"/usr/bin/tesseract"[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        else if [0m[1;39m([0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/my-bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:            TESSERACT_PATH = [0m[32m"/usr/my-bin/tesseract"[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:            TESSERACT_PATH = null;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    public void [0m[1;35mtestBasic[0m[1;39m([0m[1;39m)[0m[39m throws Exception[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        if [0m[1;39m([0m[39mTESSERACT_PATH == null[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        Path p = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mTestOCR.class.getResource[0m[1;39m([0m[32m"testOCR.pdf"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        PDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[1;35mp.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        OCRStreamEngine ocrStreamEngine = new [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        [0m[1;35mocrStreamEngine.setTesseractPath[0m[1;39m([0m[39mTESSERACT_PATH[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        String txt = [0m[1;35mocrStreamEngine.getText[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        [0m[1;35mSystem.out.println[0m[1;39m([0m[32m"txt: "[0m[39m + txt[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mtxt.contains[0m[1;39m([0m[32m"Happy New Year"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.jav[0m[1;92ma:52[0m[39m-[0m[1;36m66[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public void [0m[1;35mtestOverride[0m[1;39m([0m[1;39m)[0m[39m throws Exception[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/my-bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        Path p = [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mTestOCR.class.getResource[0m[1;39m([0m[32m"testOCRCustomPath.pdf"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        PDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[1;35mp.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        OCRStreamEngine ocrStreamEngine = new [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;35mocrStreamEngine.setTesseractPath[0m[1;39m([0m[32m"some-other-path"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        String txt = [0m[1;35mocrStreamEngine.getText[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mtxt.contains[0m[1;39m([0m[32m"Happy New Year"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:1[0m[39m-[0m[1;36m22[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:package org.apache.pdfbox.ocr;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:import java.awt.image.BufferedImage;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:import java.io.IOException;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:import java.io.InputStream;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:import java.io.InputStreamReader;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:import java.io.Reader;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:import java.io.StringWriter;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:import java.io.Writer;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:import java.nio.file.FileVisitResult;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:import java.nio.file.SimpleFileVisitor;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:145[0m[39m-[0m[1;36m155[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    public void [0m[1;35mprocessPage[0m[1;39m([0m[39mWriter writer[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            BufferedImage image = [0m[1;35mpdfRenderer.renderImage[0m[1;39m([0m[39mpageIndex[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            Path target = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[39mtmpDir, [0m[32m"render-"[0m[39m + pageIndex + [0m [2m                [0m
[2;36m                    [0m         [32m"-"[0m[39m, [0m[32m".png"[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[1;35mImageIO.write[0m[1;39m([0m[39mimage, [0m[32m"PNG"[0m[39m, [0m[1;35mtarget.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            String txt = [0m[1;35mrunTesseract[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;35mwriter.append[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[1;35m.append[0m[1;39m([0m[32m"\n"[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            pageIndex++;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:164[0m[39m-[0m[1;36m176[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mimage.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[1;35mdoOCR[0m[1;39m([0m[39mactualTessPath, image, txt[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        return [0m[1;35mextractContent[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    private String [0m[1;35mextractContent[0m[1;39m([0m[39mPath base[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mbase.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m".txt"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        if [0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            return [0m[1;35mFiles.readString[0m[1;39m([0m[39mtxt, UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:        [0m[35m/[0m[35m/[0m[95mlog[0m[39m missing txt file[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        return [0m[32m""[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:178[0m[39m-[0m[1;36m197[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    private void [0m[1;35mdoOCR[0m[1;39m([0m[39mString actualTesseractPath, Path input, Path output[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:            throws IOException [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        ArrayList<String> cmd = new ArrayList<>[0m[1;39m([0m                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                [0m[1;35mArrays.asList[0m[1;39m([0m[39mactualTesseractPath, [0m                             [2m                [0m
[2;36m                    [0m         [1;35minput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                        [0m[1;35moutput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35mrunOCRProcess[0m[1;39m([0m[39mprocess, timeoutMillisPerPage[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            if [0m[1;39m([0m[39mprocess != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                [0m[1;35mprocess.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:169[0m[39m-[0m[1;36m176[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    private String [0m[1;35mextractContent[0m[1;39m([0m[39mPath base[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mbase.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m".txt"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        if [0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            return [0m[1;35mFiles.readString[0m[1;39m([0m[39mtxt, UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:        [0m[35m/[0m[35m/[0m[95mlog[0m[39m missing txt file[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        return [0m[32m""[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:199[0m[39m-[0m[1;36m232[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    private void [0m[1;35mrunOCRProcess[0m[1;39m([0m[39mProcess process, long timeoutMillis[0m[1;39m)[0m[39m throws [0m     [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;35mprocess.getOutputStream[0m[1;39m([0m[1;39m)[0m[1;35m.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        InputStream out = [0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        InputStream err = [0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        StringBuilder outBuilder = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:        StringBuilder errBuilder = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        Thread outThread = [0m[1;35mlogStream[0m[1;39m([0m[39mout, outBuilder[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        Thread errThread = [0m[1;35mlogStream[0m[1;39m([0m[39merr, errBuilder[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:        [0m[1;35moutThread.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;35merrThread.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        int exitValue = Integer.MIN_VALUE;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            boolean finished = [0m[1;35mprocess.waitFor[0m[1;39m([0m[39mtimeoutMillis, [0m                  [2m                [0m
[2;36m                    [0m         [39mTimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            if [0m[1;39m([0m[39m!finished[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[39mnew [0m[1;35mTimeoutException[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            exitValue = [0m[1;35mprocess.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:            [0m[1;35mThread.currentThread[0m[1;39m([0m[1;39m)[0m[1;35m.interrupt[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        if [0m[1;39m([0m[39mexitValue > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                [0m[35m/[0m[35m/[0m[95mmake[0m[39m sure this thread is actually done[0m                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                [0m[1;35merrThread.join[0m[1;39m([0m[1;36m1000[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m                                              [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                    [0m[32m"TesseractOCRParser bad exit value "[0m[39m + exitValue + [0m[32m" err [0m   [2m                [0m
[2;36m                    [0m         [32mmsg: "[0m[39m +[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            [0m[1;35merrBuilder.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDDocumentInformation.jav[0m[1;92ma:285[0m[39m-[0m[1;36m294[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:     * Set the custom metadata value.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:     * @param fieldName The name of the custom metadata field.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:     * @param fieldValue The value to the custom metadata field.[0m                [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    public void [0m[1;35msetCustomMetadataValue[0m[1;39m([0m[39m String fieldName, String fieldValue [0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        [0m[1;35minfo.setString[0m[1;39m([0m[39m fieldName, fieldValue [0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:36[0m[39m-[0m[1;36m36[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final String TESSERACT_PATH_KEY = [0m[32m"tesseract-path"[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:157[0m[39m-[0m[1;36m162[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    private String [0m[1;35mrunTesseract[0m[1;39m([0m[39mPath image[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        String actualTessPath = [0m[1;35mpdDocument.getDocumentInformation[0m[1;39m([0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[1;35m.getCustomMetadataValue[0m[1;39m([0m[39mTESSERACT_PATH_KEY[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        if [0m[1;39m([0m[39mactualTessPath == null || [0m[1;35mactualTessPath.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            actualTessPath = tesseractPath;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.jav[0m[1;92ma:18[0m[39m-[0m[1;36m33[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:    @BeforeAll[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:    static void [0m[1;35msetUp[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:        [0m[35m/[0m[35m/[0m[95mthese[0m[39m are some common locations for tesseract on linux[0m                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:        if [0m[1;39m([0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:            TESSERACT_PATH = [0m[32m"/usr/bin/tesseract"[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        else if [0m[1;39m([0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/my-bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:            TESSERACT_PATH = [0m[32m"/usr/my-bin/tesseract"[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:            TESSERACT_PATH = null;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.jav[0m[1;92ma:52[0m[39m-[0m[1;36m65[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public void [0m[1;35mtestOverride[0m[1;39m([0m[1;39m)[0m[39m throws Exception[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/my-bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        Path p = [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mTestOCR.class.getResource[0m[1;39m([0m[32m"testOCRCustomPath.pdf"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        PDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[1;35mp.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        OCRStreamEngine ocrStreamEngine = new [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;35mocrStreamEngine.setTesseractPath[0m[1;39m([0m[32m"some-other-path"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        String txt = [0m[1;35mocrStreamEngine.getText[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mtxt.contains[0m[1;39m([0m[32m"Happy New Year"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:169[0m[39m-[0m[1;36m176[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    private String [0m[1;35mextractContent[0m[1;39m([0m[39mPath base[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mbase.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m".txt"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        if [0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            return [0m[1;35mFiles.readString[0m[1;39m([0m[39mtxt, UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:        [0m[35m/[0m[35m/[0m[95mlog[0m[39m missing txt file[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        return [0m[32m""[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:36[0m[39m-[0m[1;36m60[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final String TESSERACT_PATH_KEY = [0m[32m"tesseract-path"[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    private PDFRenderer pdfRenderer = null;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private String tesseractPath = [0m[32m"tesseract"[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private int pageIndex = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private int startPage = [0m[1;36m-1[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    private int endPage = [0m[1;36m-1[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private long timeoutMillisPerPage = [0m[1;36m30000[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private final PDDocument pdDocument;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private Path tmpDir;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    public [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mPDDocument pdDocument[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        this.pdDocument = pdDocument;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        pdfRenderer = new [0m[1;35mPDFRenderer[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public void [0m[1;35msetTimeoutMillisPerPage[0m[1;39m([0m[39mlong millisPerPage[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        this.timeoutMillisPerPage = millisPerPage;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public void [0m[1;35msetTesseractPath[0m[1;39m([0m[39mString tesseractPath[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        this.tesseractPath = tesseractPath;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:157[0m[39m-[0m[1;36m167[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    private String [0m[1;35mrunTesseract[0m[1;39m([0m[39mPath image[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        String actualTessPath = [0m[1;35mpdDocument.getDocumentInformation[0m[1;39m([0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[1;35m.getCustomMetadataValue[0m[1;39m([0m[39mTESSERACT_PATH_KEY[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        if [0m[1;39m([0m[39mactualTessPath == null || [0m[1;35mactualTessPath.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            actualTessPath = tesseractPath;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mimage.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[1;35mdoOCR[0m[1;39m([0m[39mactualTessPath, image, txt[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        return [0m[1;35mextractContent[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.jav[0m[1;92ma:52[0m[39m-[0m[1;36m65[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public void [0m[1;35mtestOverride[0m[1;39m([0m[1;39m)[0m[39m throws Exception[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/my-bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        Path p = [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mTestOCR.class.getResource[0m[1;39m([0m[32m"testOCRCustomPath.pdf"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        PDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[1;35mp.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        OCRStreamEngine ocrStreamEngine = new [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;35mocrStreamEngine.setTesseractPath[0m[1;39m([0m[32m"some-other-path"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        String txt = [0m[1;35mocrStreamEngine.getText[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mtxt.contains[0m[1;39m([0m[32m"Happy New Year"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:178[0m[39m-[0m[1;36m197[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    private void [0m[1;35mdoOCR[0m[1;39m([0m[39mString actualTesseractPath, Path input, Path output[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:            throws IOException [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        ArrayList<String> cmd = new ArrayList<>[0m[1;39m([0m                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                [0m[1;35mArrays.asList[0m[1;39m([0m[39mactualTesseractPath, [0m                             [2m                [0m
[2;36m                    [0m         [1;35minput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                        [0m[1;35moutput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35mrunOCRProcess[0m[1;39m([0m[39mprocess, timeoutMillisPerPage[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            if [0m[1;39m([0m[39mprocess != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                [0m[1;35mprocess.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:199[0m[39m-[0m[1;36m232[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    private void [0m[1;35mrunOCRProcess[0m[1;39m([0m[39mProcess process, long timeoutMillis[0m[1;39m)[0m[39m throws [0m     [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;35mprocess.getOutputStream[0m[1;39m([0m[1;39m)[0m[1;35m.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        InputStream out = [0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        InputStream err = [0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        StringBuilder outBuilder = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:        StringBuilder errBuilder = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        Thread outThread = [0m[1;35mlogStream[0m[1;39m([0m[39mout, outBuilder[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        Thread errThread = [0m[1;35mlogStream[0m[1;39m([0m[39merr, errBuilder[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:        [0m[1;35moutThread.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;35merrThread.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        int exitValue = Integer.MIN_VALUE;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            boolean finished = [0m[1;35mprocess.waitFor[0m[1;39m([0m[39mtimeoutMillis, [0m                  [2m                [0m
[2;36m                    [0m         [39mTimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            if [0m[1;39m([0m[39m!finished[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[39mnew [0m[1;35mTimeoutException[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            exitValue = [0m[1;35mprocess.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:            [0m[1;35mThread.currentThread[0m[1;39m([0m[1;39m)[0m[1;35m.interrupt[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        if [0m[1;39m([0m[39mexitValue > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                [0m[35m/[0m[35m/[0m[95mmake[0m[39m sure this thread is actually done[0m                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                [0m[1;35merrThread.join[0m[1;39m([0m[1;36m1000[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m                                              [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                    [0m[32m"TesseractOCRParser bad exit value "[0m[39m + exitValue + [0m[32m" err [0m   [2m                [0m
[2;36m                    [0m         [32mmsg: "[0m[39m +[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            [0m[1;35merrBuilder.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:1[0m[39m-[0m[1;36m22[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:package org.apache.pdfbox.ocr;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:import java.awt.image.BufferedImage;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:import java.io.IOException;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:import java.io.InputStream;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:import java.io.InputStreamReader;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:import java.io.Reader;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:import java.io.StringWriter;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:import java.io.Writer;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:import java.nio.file.FileVisitResult;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:import java.nio.file.SimpleFileVisitor;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:34[0m[39m-[0m[1;36m60[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:public class OCRStreamEngine [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final String TESSERACT_PATH_KEY = [0m[32m"tesseract-path"[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    private PDFRenderer pdfRenderer = null;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private String tesseractPath = [0m[32m"tesseract"[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private int pageIndex = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private int startPage = [0m[1;36m-1[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    private int endPage = [0m[1;36m-1[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private long timeoutMillisPerPage = [0m[1;36m30000[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private final PDDocument pdDocument;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private Path tmpDir;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    public [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mPDDocument pdDocument[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        this.pdDocument = pdDocument;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        pdfRenderer = new [0m[1;35mPDFRenderer[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public void [0m[1;35msetTimeoutMillisPerPage[0m[1;39m([0m[39mlong millisPerPage[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        this.timeoutMillisPerPage = millisPerPage;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public void [0m[1;35msetTesseractPath[0m[1;39m([0m[39mString tesseractPath[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        this.tesseractPath = tesseractPath;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:157[0m[39m-[0m[1;36m167[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    private String [0m[1;35mrunTesseract[0m[1;39m([0m[39mPath image[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        String actualTessPath = [0m[1;35mpdDocument.getDocumentInformation[0m[1;39m([0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[1;35m.getCustomMetadataValue[0m[1;39m([0m[39mTESSERACT_PATH_KEY[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        if [0m[1;39m([0m[39mactualTessPath == null || [0m[1;35mactualTessPath.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            actualTessPath = tesseractPath;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mimage.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[1;35mdoOCR[0m[1;39m([0m[39mactualTessPath, image, txt[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        return [0m[1;35mextractContent[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.jav[0m[1;92ma:178[0m[39m-[0m[1;36m197[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    private void [0m[1;35mdoOCR[0m[1;39m([0m[39mString actualTesseractPath, Path input, Path output[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:            throws IOException [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        ArrayList<String> cmd = new ArrayList<>[0m[1;39m([0m                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                [0m[1;35mArrays.asList[0m[1;39m([0m[39mactualTesseractPath, [0m                             [2m                [0m
[2;36m                    [0m         [1;35minput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                        [0m[1;35moutput.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35mrunOCRProcess[0m[1;39m([0m[39mprocess, timeoutMillisPerPage[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            if [0m[1;39m([0m[39mprocess != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                [0m[1;35mprocess.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.jav[0m[1;92ma:18[0m[39m-[0m[1;36m33[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:    @BeforeAll[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:    static void [0m[1;35msetUp[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:        [0m[35m/[0m[35m/[0m[95mthese[0m[39m are some common locations for tesseract on linux[0m                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:        if [0m[1;39m([0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:            TESSERACT_PATH = [0m[32m"/usr/bin/tesseract"[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        else if [0m[1;39m([0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/my-bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:            TESSERACT_PATH = [0m[32m"/usr/my-bin/tesseract"[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:            TESSERACT_PATH = null;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/ocr/TestOCR.jav[0m[1;92ma:52[0m[39m-[0m[1;36m65[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public void [0m[1;35mtestOverride[0m[1;39m([0m[1;39m)[0m[39m throws Exception[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[32m"/usr/my-bin/tesseract"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            return;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        Path p = [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mTestOCR.class.getResource[0m[1;39m([0m[32m"testOCRCustomPath.pdf"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        PDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[1;35mp.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        OCRStreamEngine ocrStreamEngine = new [0m[1;35mOCRStreamEngine[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;35mocrStreamEngine.setTesseractPath[0m[1;39m([0m[32m"some-other-path"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        String txt = [0m[1;35mocrStreamEngine.getText[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mtxt.contains[0m[1;39m([0m[32m"Happy New Year"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis Summary[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I've identified that this [0m [2m                [0m
[2;36m                    [0m         [39mis a critical OS Command Injection vulnerability in Apache PDFBox's OCR [0m            [2m                [0m
[2;36m                    [0m         [39mfunctionality. The root cause is clear:[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerability Flow:**[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. `[0m[1;35mOCRStreamEngine.runTesseract[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m158[0m[39m-[0m[1;36m159[0m[1;39m)[0m[39m retrieves a tesseract executable[0m [2m                [0m
[2;36m                    [0m         [39mpath from PDF metadata via [0m                                                         [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mpdDocument.getDocumentInformation[0m[1;39m([0m[1;39m)[0m[1;35m.getCustomMetadataValue[0m[1;39m([0m[32m"tesseract-path"[0m[1;39m)[0m[39m`[0m      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. This untrusted metadata value directly overrides the safe programmatic [0m          [2m                [0m
[2;36m                    [0m         [39mconfiguration [0m[1;39m([0m[39mline [0m[1;36m160[0m[39m-[0m[1;36m162[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The untrusted path is passed to `[0m[1;35mdoOCR[0m[1;39m([0m[1;39m)[0m[39m` and used as the first element in [0m      [2m                [0m
[2;36m                    [0m         [39mProcessBuilder command array [0m[1;39m([0m[39mline [0m[1;36m182[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. `[0m[1;35mProcessBuilder.start[0m[1;39m([0m[1;39m)[0m[39m` executes this attacker-controlled executable [0m[1;39m([0m[39mline [0m[1;36m190[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Key Insights:**[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- The test file [0m[1;39m([0m[39mTestOCR.java[0m[1;39m)[0m[39m demonstrates the correct validation pattern using [0m   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mFiles.isExecutable[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- The production code applies proper validation to output files [0m                    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`[0m[1;35mFiles.isRegularFile[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m171[0m[1;39m)[0m[39m but NOT to the executable path[0m                [2m                [0m
[2;36m                    [0m         [39m- The metadata override is an intentional feature [0m[1;39m([0m[39mevidenced by `[0m[1;35mtestOverride[0m[1;39m([0m[1;39m)[0m[39m` [0m   [2m                [0m
[2;36m                    [0m         [39mtest[0m[1;39m)[0m[39m, but it creates a critical security vulnerability[0m                             [2m                [0m
[2;36m                    [0m         [39m- ProcessBuilder's array-based API prevents classic shell injection but does NOT [0m   [2m                [0m
[2;36m                    [0m         [39mprevent arbitrary executable execution when the executable path itself is [0m          [2m                [0m
[2;36m                    [0m         [39mattacker-controlled[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Approach: Remove Metadata Override Feature [0m[1;39m([0m[39mRecommended[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale:** The metadata override feature fundamentally violates the security [0m   [2m                [0m
[2;36m                    [0m         [39mprinciple that system configuration should never come from untrusted input [0m[1;39m([0m[39mPDF [0m    [2m                [0m
[2;36m                    [0m         [39mdocument content[0m[1;39m)[0m[39m. Removing it eliminates the attack vector entirely.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation Steps:**[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Modify `[0m[1;35mOCRStreamEngine.runTesseract[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m157[0m[39m-[0m[1;36m167[0m[1;39m)[0m[39m:**[0m              [2m                [0m
[2;36m                    [0m         [39m   - Remove lines [0m[1;36m158[0m[39m-[0m[1;36m159[0m[39m that retrieve metadata value[0m                              [2m                [0m
[2;36m                    [0m         [39m   - Remove the conditional check [0m[1;39m([0m[39mlines [0m[1;36m160[0m[39m-[0m[1;36m162[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Directly use the instance variable `tesseractPath` which is set via the safe [0m  [2m                [0m
[2;36m                    [0m         [39mAPI or defaults to [0m[32m"tesseract"[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   The method should become:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   private String [0m[1;35mrunTesseract[0m[1;39m([0m[39mPath image[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [39m       String actualTessPath = tesseractPath;  [0m[35m/[0m[35m/[0m[39m Use instance variable only[0m        [2m                [0m
[2;36m                    [0m         [39m       [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m       Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mimage.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mdoOCR[0m[1;39m([0m[39mactualTessPath, image, txt[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m       return [0m[1;35mextractContent[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Remove or update the test dependency:**[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35mtestOverride[0m[1;39m([0m[1;39m)[0m[39m` test in `TestOCR.java` [0m[1;39m([0m[39mlines [0m[1;36m52[0m[39m-[0m[1;36m65[0m[1;39m)[0m[39m explicitly tests the[0m [2m                [0m
[2;36m                    [0m         [39mmetadata override feature[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - This test will fail after the fix and should be removed[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Alternatively, update the test to verify that metadata values are properly [0m    [2m                [0m
[2;36m                    [0m         [39mignored[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserve all other functionality:**[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Keep `[0m[1;35msetTesseractPath[0m[1;39m([0m[1;39m)[0m[39m` API [0m[1;39m([0m[39mline [0m[1;36m58[0m[39m-[0m[1;36m60[0m[1;39m)[0m[39m - this is the safe, intended [0m       [2m                [0m
[2;36m                    [0m         [39mconfiguration method[0m                                                                [2m                [0m
[2;36m                    [0m         [39m   - Keep the default [0m[32m"tesseract"[0m[39m behavior [0m[1;39m([0m[39mline [0m[1;36m38[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m   - Keep all OCR processing logic, timeout handling, and error handling unchanged[0m  [2m                [0m
[2;36m                    [0m         [39m   - Keep the temporary file handling and cleanup logic unchanged[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Alternative Approach: Add Strict Validation [0m[1;39m([0m[39mIf Feature Must Be Retained[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Only use this if there's a documented business requirement for the metadata [0m      [2m                [0m
[2;36m                    [0m         [39moverride feature.**[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation Steps:**[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Add validation in `[0m[1;35mrunTesseract[0m[1;39m([0m[1;39m)[0m[39m` method after retrieving metadata [0m[1;39m([0m[39minsert [0m   [2m                [0m
[2;36m                    [0m         [39mafter line [0m[1;36m162[0m[1;39m)[0m[39m:**[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   private String [0m[1;35mrunTesseract[0m[1;39m([0m[39mPath image[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [39m       String actualTessPath = [0m[1;35mpdDocument.getDocumentInformation[0m[1;39m([0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m               [0m[1;35m.getCustomMetadataValue[0m[1;39m([0m[39mTESSERACT_PATH_KEY[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[39mactualTessPath == null || [0m[1;35mactualTessPath.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [39m           actualTessPath = tesseractPath;[0m                                          [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m           [0m[35m/[0m[35m/[0m[39m Validate metadata-provided path before use[0m                            [2m                [0m
[2;36m                    [0m         [39m           actualTessPath = [0m[1;35mvalidateTesseractPath[0m[1;39m([0m[39mactualTessPath[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m       [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m       Path txt = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mimage.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mdoOCR[0m[1;39m([0m[39mactualTessPath, image, txt[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m       return [0m[1;35mextractContent[0m[1;39m([0m[39mtxt[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Add new validation method to OCRStreamEngine class:**[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   private String [0m[1;35mvalidateTesseractPath[0m[1;39m([0m[39mString pathFromMetadata[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[39mpathFromMetadata == null || [0m[1;35mpathFromMetadata.trim[0m[1;39m([0m[1;39m)[0m[1;35m.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [39m           throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Tesseract path from PDF metadata is empty"[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m       [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m       [0m[35m/[0m[35m/[0m[39m Convert to Path for validation[0m                                            [2m                [0m
[2;36m                    [0m         [39m       Path tessPath;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m       try [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m           tessPath = [0m[1;35mPaths.get[0m[1;39m([0m[39mpathFromMetadata[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [39m           throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid tesseract path from PDF metadata: "[0m[39m + [0m    [2m                [0m
[2;36m                    [0m         [39m               pathFromMetadata, e[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m       [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m       [0m[35m/[0m[35m/[0m[39m Must be absolute path to prevent path traversal[0m                           [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[39m![0m[1;35mtessPath.isAbsolute[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m           throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Tesseract path from PDF metadata must be [0m         [2m                [0m
[2;36m                    [0m         [32mabsolute: "[0m[39m + [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m               pathFromMetadata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m       [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m       [0m[35m/[0m[35m/[0m[39m Must exist and be executable [0m[1;39m([0m[39msame pattern as TestOCR.java[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[39m![0m[1;35mFiles.isExecutable[0m[1;39m([0m[39mtessPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [39m           throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Tesseract path from PDF metadata is not [0m          [2m                [0m
[2;36m                    [0m         [32mexecutable: "[0m[39m + [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m               pathFromMetadata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m       [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m       [0m[35m/[0m[35m/[0m[39m Must be a regular file, not a directory[0m                                   [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mtessPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [39m           throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Tesseract path from PDF metadata must be a [0m       [2m                [0m
[2;36m                    [0m         [32mregular file: "[0m[39m + [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m               pathFromMetadata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m       [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m       return pathFromMetadata;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Considerations for this approach:**[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - This still allows PDFs to specify executable paths, which is inherently risky[0m  [2m                [0m
[2;36m                    [0m         [39m   - Validation might be bypassed if the attacker has write access to create [0m       [2m                [0m
[2;36m                    [0m         [39mmalicious executables[0m                                                               [2m                [0m
[2;36m                    [0m         [39m   - Additional hardening could include: executable name validation, whitelist of [0m  [2m                [0m
[2;36m                    [0m         [39mallowed directories, digital signature verification[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - This should be considered a defense-in-depth measure, not a complete solution[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Additional Security Hardening [0m[1;39m([0m[39mOptional, for Alternative Approach[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIf the validation approach is chosen, consider adding:[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Executable name verification:**[0m                                                [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   String fileName = [0m[1;35mtessPath.getFileName[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39m![0m[1;35mfileName.equals[0m[1;39m([0m[32m"tesseract"[0m[1;39m)[0m[39m && ![0m[1;35mfileName.startsWith[0m[1;39m([0m[32m"tesseract-"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [39m       throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Tesseract executable name is unexpected: "[0m[39m + [0m         [2m                [0m
[2;36m                    [0m         [39mfileName[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Directory whitelist:**[0m                                                         [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   String parentDir = [0m[1;35mtessPath.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m   Set<String> allowedDirs = [0m[1;35mSet.of[0m[1;39m([0m[32m"/usr/bin"[0m[39m, [0m[32m"/usr/local/bin"[0m[39m, [0m[32m"/usr/my-bin"[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39m![0m[1;35mallowedDirs.contains[0m[1;39m([0m[39mparentDir[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [39m       throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Tesseract path is not in an allowed directory: "[0m[39m + [0m   [2m                [0m
[2;36m                    [0m         [39mparentDir[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why Primary Approach is Optimal:**[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Eliminates the attack vector completely:** No validation bypass is possible if[0m [2m                [0m
[2;36m                    [0m         [39mthe feature doesn't exist[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Follows security best practices:** System configuration should never come from[0m [2m                [0m
[2;36m                    [0m         [39muntrusted document content[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Maintains intended functionality:** The safe `[0m[1;35msetTesseractPath[0m[1;39m([0m[1;39m)[0m[39m` API remains [0m [2m                [0m
[2;36m                    [0m         [39mavailable for legitimate configuration needs[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Simpler and more maintainable:** Less code, fewer edge cases, clearer security[0m [2m                [0m
[2;36m                    [0m         [39mposture[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Aligns with principle of least privilege:** PDFs should only contain document [0m [2m                [0m
[2;36m                    [0m         [39mdata, not system configuration[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Preserves Existing Logic:**[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Safe configuration still works:** Applications can still use [0m                  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35msetTesseractPath[0m[1;39m([0m[1;39m)[0m[39m` to configure tesseract location[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Default behavior unchanged:** Still defaults to [0m[32m"tesseract"[0m[39m from system PATH[0m   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **OCR workflow intact:** All rendering, processing, timeout, and error handling [0m [2m                [0m
[2;36m                    [0m         [39mremain unchanged[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **No impact on normal usage:** Only affects PDFs that were maliciously crafted [0m  [2m                [0m
[2;36m                    [0m         [39mor explicitly configured with metadata override[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Addressing the Test:**[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe `[0m[1;35mtestOverride[0m[1;39m([0m[1;39m)[0m[39m` test validates an intentional feature, but this feature is the[0m [2m                [0m
[2;36m                    [0m         [39mvulnerability itself. The test was designed to ensure metadata can override [0m        [2m                [0m
[2;36m                    [0m         [39mprogrammatic configuration, but this design is fundamentally flawed from a security[0m [2m                [0m
[2;36m                    [0m         [39mperspective. Removing the test is appropriate because:[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The feature it tests is a security vulnerability[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. No legitimate use case requires PDFs to configure system executables[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The safe alternative [0m[1;39m([0m[39m`[0m[1;35msetTesseractPath[0m[1;39m([0m[1;39m)[0m[39m` API[0m[1;39m)[0m[39m provides the same functionality [0m [2m                [0m
[2;36m                    [0m         [39msecurely[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects:**[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Breaking change for applications relying on metadata override:** Any [0m          [2m                [0m
[2;36m                    [0m         [39mapplication that intentionally uses PDF metadata to configure tesseract path will [0m  [2m                [0m
[2;36m                    [0m         [39mbreak[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m   - Mitigation: This is an undocumented feature [0m[1;39m([0m[39mno public API documentation [0m      [2m                [0m
[2;36m                    [0m         [39mreferences it[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - Mitigation: Applications should migrate to using `[0m[1;35msetTesseractPath[0m[1;39m([0m[1;39m)[0m[39m` API[0m      [2m                [0m
[2;36m                    [0m         [39m   - This is an acceptable breaking change for a critical security fix[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Test suite changes:** The `[0m[1;35mtestOverride[0m[1;39m([0m[1;39m)[0m[39m` test will fail[0m                      [2m                [0m
[2;36m                    [0m         [39m   - Mitigation: Remove the test or update it to verify metadata is ignored[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **No impact on:**[0m                                                                [2m                [0m
[2;36m                    [0m         [39m   - Normal OCR processing[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - Applications using `[0m[1;35msetTesseractPath[0m[1;39m([0m[1;39m)[0m[39m` API[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - Default tesseract path behavior[0m                                                [2m                [0m
[2;36m                    [0m         [39m   - Any other PDFBox functionality[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Implementation Priority[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Immediate:** Apply the primary fix [0m[1;39m([0m[39mremove metadata override[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Immediate:** Remove or update `[0m[1;35mtestOverride[0m[1;39m([0m[1;39m)[0m[39m` test[0m                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Before release:** Add security regression test to verify metadata values are [0m  [2m                [0m
[2;36m                    [0m         [39mignored[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Before release:** Update any documentation that mentions the metadata override[0m [2m                [0m
[2;36m                    [0m         [39mfeature [0m[1;39m([0m[39mif any exists[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Consider:** Adding a security advisory noting the vulnerability and the fix[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=374053;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=96485;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=972445;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=766891;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpo70wcu_3[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-delta-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768278712.4185088[0m                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-delta-01_vuln_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/13/26 04:31:54][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mpdfbox[0m         ]8;id=205373;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=800519;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=304125;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=318596;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mpdfbox[0m                [2m               [0m
[2;36m[01/13/26 04:31:55][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=120083;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=750130;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mpdfbox[0m                 [2m               [0m
