[2;36m[01/13/26 04:39:33][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=316045;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=926322;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp_0xgfqze[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_1/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768279173.7569537[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-full-01_vuln_1.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=679817;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=257898;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:40:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Took      ]8;id=718242;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=706687;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m81.17[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=706030;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=599428;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=847392;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=245788;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=106787;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=910509;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m81[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=806714;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=408148;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:40:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.93[0m seconds;                ]8;id=106251;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=518332;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 04:40:56][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=482543;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=607523;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=221363;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=793880;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=582761;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=982672;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=372889;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=673339;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:40:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m1.10[0m seconds;                ]8;id=342516;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=13929;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=861262;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=259891;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:40:59][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.90[0m seconds;                ]8;id=661159;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=982946;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 04:41:05][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=528331;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=231735;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazze.com:[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:583[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:183[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/sun.net.www.http.HttpClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntit[0m [2m                [0m
[2;36m                    [0m         [1;35my[0m[1;39m([0m[39mXMLEntityManager.jav[0m[1;92ma:677[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1397[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1333[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnEntityReference[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:1859[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$[0m[1;35mFra[0m [2m                [0m
[2;36m                    [0m         [1;35mgmentContentDriver.next[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:3001[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next[0m[1;39m([0m[39mXMLDoc[0m [2m                [0m
[2;36m                    [0m         [39mumentScannerImpl.jav[0m[1;92ma:605[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next[0m[1;39m([0m[39mXMLN[0m [2m                [0m
[2;36m                    [0m         [39mSDocumentScannerImpl.jav[0m[1;92ma:112[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnDocument[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:542[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:889[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:825[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XMLParser.parse[0m[1;39m([0m[39mXMLParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m141[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.DOMParser.parse[0m[1;39m([0m[39mDOMParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m247[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse[0m[1;39m([0m[39mDocument[0m [2m                [0m
[2;36m                    [0m         [39mBuilderImpl.jav[0m[1;92ma:342[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mjavax.xml.parsers.DocumentBuilder.parse[0m[1;39m([0m[39mDocumentBuilder.jav[0m[1;92ma:122[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.interactive.form.PDXFAResource.getDocument[0m[1;39m([0m[39mPDXFAResource.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:139[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.DomXfaParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mDomXfaParserFuzzer.jav[0m[1;92ma:59[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 16287e730c24509c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazze.com:[0m[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init[0m[1m>[0m[1m([0mHttpClient.jav[1;92ma:246[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.New[0m[1m([0mHttpClient.jav[1;92ma:351[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.New[0m[1m([0mHttpClient.jav[1;92ma:373[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1m([0mHttpURLConne [2m                [0m
[2;36m                    [0m         ction.jav[1;92ma:1309[0m[1m)[0m                                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1m([0mHttpURLConnecti [2m                [0m
[2;36m                    [0m         on.jav[1;92ma:1242[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1m([0mHttpURLConnectio [2m                [0m
[2;36m                    [0m         n.jav[1;92ma:1128[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1m([0mHttpURLConnection.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1m([0mHttpURLConnec [2m                [0m
[2;36m                    [0m         tion.jav[1;92ma:1665[0m[1m)[0m                                                                     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1m([0mHttpURLConnect [2m                [0m
[2;36m                    [0m         ion.jav[1;92ma:1589[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntit[0m [2m                [0m
[2;36m                    [0m         [1;35my[0m[1m([0mXMLEntityManager.jav[1;92ma:677[0m[1m)[0m                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1m([0mXMLEn [2m                [0m
[2;36m                    [0m         tityManager.jav[1;92ma:1397[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1m([0mXMLEn [2m                [0m
[2;36m                    [0m         tityManager.jav[1;92ma:1333[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnEntityReference[0m[1m([0mXMLDocumentFragmentScannerImpl.jav[1;92ma:1859[0m[1m)[0m                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$[1;35mFra[0m [2m                [0m
[2;36m                    [0m         [1;35mgmentContentDriver.next[0m[1m([0mXMLDocumentFragmentScannerImpl.jav[1;92ma:3001[0m[1m)[0m                   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next[0m[1m([0mXMLDoc [2m                [0m
[2;36m                    [0m         umentScannerImpl.jav[1;92ma:605[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next[0m[1m([0mXMLN [2m                [0m
[2;36m                    [0m         SDocumentScannerImpl.jav[1;92ma:112[0m[1m)[0m                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnDocument[0m[1m([0mXMLDocumentFragmentScannerImpl.jav[1;92ma:542[0m[1m)[0m                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1m([0mXML11C [2m                [0m
[2;36m                    [0m         onfiguration.jav[1;92ma:889[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1m([0mXML11C [2m                [0m
[2;36m                    [0m         onfiguration.jav[1;92ma:825[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.parsers.XMLParser.parse[0m[1m([0mXMLParser.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m141[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.parsers.DOMParser.parse[0m[1m([0mDOMParser.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m247[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse[0m[1m([0mDocument [2m                [0m
[2;36m                    [0m         BuilderImpl.jav[1;92ma:342[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mjavax.xml.parsers.DocumentBuilder.parse[0m[1m([0mDocumentBuilder.jav[1;92ma:122[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.interactive.form.PDXFAResource.getDocument[0m[1m([0mPDXFAResource. [2m                [0m
[2;36m                    [0m         jav[1;92ma:139[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.DomXfaParserFuzzer.fuzzerTestOneInput[0m[1m([0mDomXfaParserFuzzer.jav[1;92ma:59[0m[1m)[0m       [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 16287e730c24509c                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 04:41:28][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=500036;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=609479;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 04:45:30][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=237743;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=324774;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 04:46:06][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=105583;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=216934;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=129521;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=712169;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:46:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.98[0m seconds;                ]8;id=732518;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=53276;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 04:46:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Started[33m...[0m                              ]8;id=592671;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=386017;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp68b_9oh8[0m                                                 ]8;id=464485;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=41340;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 04:47:10][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Took [1;36m62.77[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=13604;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=643064;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Started[33m...[0m                        ]8;id=23587;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=807613;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:47:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Took [1;36m14.35[0m seconds;              ]8;id=617946;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=508480;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Started[33m...[0m                           ]8;id=761172;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=818238;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:47:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Took [1;36m6.92[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=458923;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=716601;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Started[33m...[0m                               ]8;id=954306;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=263406;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=792532;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=305031;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=479398;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=652976;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:47:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.92[0m seconds;                ]8;id=314547;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=911566;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=111606;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=289901;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:47:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.93[0m seconds;                ]8;id=426707;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=530045;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 04:47:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=354782;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=876238;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:47:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.94[0m seconds;                ]8;id=564043;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=273140;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=924307;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=899400;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         ---                                                                                 [2m                [0m
[2;36m                    [0m         a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav [2m                [0m
[2;36m                    [0m         a                                                                                   [2m                [0m
[2;36m                    [0m         +++                                                                                 [2m                [0m
[2;36m                    [0m         b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav [2m                [0m
[2;36m                    [0m         a                                                                                   [2m                [0m
[2;36m                    [0m         @@ [1;36m-26[0m,[1;36m6[0m +[1;36m26[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m          import javax.xml.parsers.ParserConfigurationException;                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          import org.apache.pdfbox.cos.COSArray;                                             [2m                [0m
[2;36m                    [0m         +import org.apache.pdfbox.util.XMLUtil;                                             [2m                [0m
[2;36m                    [0m          import org.apache.pdfbox.cos.COSBase;                                              [2m                [0m
[2;36m                    [0m          import org.apache.pdfbox.cos.COSStream;                                            [2m                [0m
[2;36m                    [0m          import org.apache.pdfbox.pdmodel.common.COSObjectable;                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-132[0m,[1;36m13[0m +[1;36m133[0m,[1;36m6[0m @@                                                                [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m              public Document [1;35mgetDocument[0m[1m([0m[1m)[0m throws IOException                               [2m                [0m
[2;36m                    [0m              [1m{[0m                                                                              [2m                [0m
[2;36m                    [0m         -        DocumentBuilderFactory factory = [1;35mDocumentBuilderFactory.newInstance[0m[1m([0m[1m)[0m;     [2m                [0m
[2;36m                    [0m         -        [1;35mfactory.setNamespaceAware[0m[1m([0mtrue[1m)[0m;                                           [2m                [0m
[2;36m                    [0m         -        try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -            DocumentBuilder builder = [1;35mfactory.newDocumentBuilder[0m[1m([0m[1m)[0m;                [2m                [0m
[2;36m                    [0m         -            return [1;35mbuilder.parse[0m[1m([0mnew [1;35mByteArrayInputStream[0m[1m([0m[1;35mthis.getBytes[0m[1m([0m[1m)[0m[1m)[0m[1m)[0m;       [2m                [0m
[2;36m                    [0m         -        [1m}[0m catch [1m([0mParserConfigurationException | SAXException e[1m)[0m [1m{[0m                  [2m                [0m
[2;36m                    [0m         -            throw new [1;35mIOException[0m[1m([0me[1m)[0m;                                              [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        return [1;35mXMLUtil.parse[0m[1m([0mnew [1;35mByteArrayInputStream[0m[1m([0m[1;35mthis.getBytes[0m[1m([0m[1m)[0m[1m)[0m, true[1m)[0m;     [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazze.com:[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:583[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:183[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/sun.net.www.http.HttpClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntit[0m [2m                [0m
[2;36m                    [0m         [1;35my[0m[1;39m([0m[39mXMLEntityManager.jav[0m[1;92ma:677[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1397[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1333[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnEntityReference[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:1859[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$[0m[1;35mFra[0m [2m                [0m
[2;36m                    [0m         [1;35mgmentContentDriver.next[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:3001[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next[0m[1;39m([0m[39mXMLDoc[0m [2m                [0m
[2;36m                    [0m         [39mumentScannerImpl.jav[0m[1;92ma:605[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next[0m[1;39m([0m[39mXMLN[0m [2m                [0m
[2;36m                    [0m         [39mSDocumentScannerImpl.jav[0m[1;92ma:112[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnDocument[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:542[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:889[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:825[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XMLParser.parse[0m[1;39m([0m[39mXMLParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m141[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.DOMParser.parse[0m[1;39m([0m[39mDOMParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m247[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse[0m[1;39m([0m[39mDocument[0m [2m                [0m
[2;36m                    [0m         [39mBuilderImpl.jav[0m[1;92ma:342[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mjavax.xml.parsers.DocumentBuilder.parse[0m[1;39m([0m[39mDocumentBuilder.jav[0m[1;92ma:122[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.interactive.form.PDXFAResource.getDocument[0m[1;39m([0m[39mPDXFAResource.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:139[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.DomXfaParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mDomXfaParserFuzzer.jav[0m[1;92ma:59[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 16287e730c24509c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability has been detected during fuzzing[0m [2m                [0m
[2;36m                    [0m         [39mof PDF/XFA document parsing functionality. The fuzzer identified an attempted [0m      [2m                [0m
[2;36m                    [0m         [39mconnection to `jazze.com:[0m[1;36m80[0m[39m`, indicating that XML entity processing in XFA [0m         [2m                [0m
[2;36m                    [0m         [39mresources is performing external network requests based on potentially untrusted [0m   [2m                [0m
[2;36m                    [0m         [39minput data. This vulnerability is classified as medium severity and could lead to [0m  [2m                [0m
[2;36m                    [0m         [39mexfiltration of sensitive data or exposure of internal services.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is a Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability, which occurs when an [0m   [2m                [0m
[2;36m                    [0m         [39mapplication makes network requests to destinations that are influenced or [0m          [2m                [0m
[2;36m                    [0m         [39mcontrolled by untrusted input data. SSRF vulnerabilities can allow attackers to:[0m    [2m                [0m
[2;36m                    [0m         [39m- Access internal services that should not be publicly accessible[0m                   [2m                [0m
[2;36m                    [0m         [39m- Exfiltrate sensitive data to external servers[0m                                     [2m                [0m
[2;36m                    [0m         [39m- Perform port scanning of internal networks[0m                                        [2m                [0m
[2;36m                    [0m         [39m- Bypass firewall restrictions[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Details[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mThe vulnerability manifests during the parsing of XFA [0m[1;39m([0m[39mXML Forms Architecture[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mresources embedded in PDF documents. The stack trace reveals the following [0m         [2m                [0m
[2;36m                    [0m         [39mexecution flow:[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer entry point is at `[0m[1;35mDomXfaParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m59[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The execution proceeds through `[0m[1;35mPDXFAResource.getDocument[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m139[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Standard Java XML parsing components are invoked via `[0m[1;35mDocumentBuilder.parse[0m[1;39m([0m[1;39m)[0m[39m`[0m   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. During XML parsing, an entity reference is encountered and scanned by [0m           [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mXMLDocumentFragmentScannerImpl.scanEntityReference[0m[1;39m([0m[1;39m)[0m[39m`[0m                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. The XML entity manager attempts to start an entity at [0m                           [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mXMLEntityManager.startEntity[0m[1;39m([0m[1;39m)[0m[39m` and `[0m[1;35mXMLEntityManager.setupCurrentEntity[0m[1;39m([0m[1;39m)[0m[39m`[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. This triggers an HTTP connection attempt through Java's networking stack[0m         [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. The connection attempt to `jazze.com:[0m[1;36m80[0m[39m` is intercepted by Jazzer's SSRF [0m        [2m                [0m
[2;36m                    [0m         [39mdetection sanitizer[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **External Entity Processing**: The XML parser is processing external entities, [0m [2m                [0m
[2;36m                    [0m         [39mwhich triggers network connections. This is evidenced by the call path through [0m     [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mXMLEntityManager.setupCurrentEntity[0m[1;39m([0m[1;39m)[0m[39m` and the subsequent HTTP connection [0m         [2m                [0m
[2;36m                    [0m         [39mestablishment.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Unvalidated Input**: The network destination [0m[1;39m([0m[39m`jazze.com:[0m[1;36m80[0m[39m`[0m[1;39m)[0m[39m appears to be [0m   [2m                [0m
[2;36m                    [0m         [39mderived from the fuzzer input data, demonstrating that untrusted PDF/XFA content [0m   [2m                [0m
[2;36m                    [0m         [39mcan control network request destinations.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Default Parser Configuration**: The Java XML parser components [0m                [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`DocumentBuilderImpl`, `DOMParser`, `XMLParser`[0m[1;39m)[0m[39m are being used, likely with [0m      [2m                [0m
[2;36m                    [0m         [39mdefault settings that permit external entity resolution.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Apache PDFBox Integration**: The vulnerability occurs within Apache PDFBox's [0m  [2m                [0m
[2;36m                    [0m         [39mXFA resource handling, specifically when obtaining the Document object from XFA [0m    [2m                [0m
[2;36m                    [0m         [39mdata.[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a comprehensive understanding of this vulnerability, the following [0m       [2m                [0m
[2;36m                    [0m         [39mcomponents should be investigated:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **PDXFAResource Class** [0m                                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`org.apache.pdfbox.pdmodel.interactive.form.PDXFAResource`[0m[1;39m)[0m[39m:[0m                       [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m139[0m[39m where `[0m[1;35mgetDocument[0m[1;39m([0m[1;39m)[0m[39m` is called[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - How the DocumentBuilder is configured and initialized[0m                          [2m                [0m
[2;36m                    [0m         [39m   - Whether any XML parser security features are enabled or disabled[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **XML Parser Configuration**:[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - Examine how `DocumentBuilder` instances are created in the PDFBox codebase[0m     [2m                [0m
[2;36m                    [0m         [39m   - Check if features like `FEATURE_SECURE_PROCESSING` are enabled[0m                 [2m                [0m
[2;36m                    [0m         [39m   - Verify settings for external entity resolution and DTD processing[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **XFA Processing Pipeline**:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - Understand the complete flow of XFA data processing[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Identify all locations where XML parsing occurs on XFA content[0m                 [2m                [0m
[2;36m                    [0m         [39m   - Determine if there are other entry points with similar vulnerabilities[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Input Validation**:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - Assess whether XFA content undergoes any validation before parsing[0m             [2m                [0m
[2;36m                    [0m         [39m   - Check if there are sanitization mechanisms for XML content[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Examine trust boundaries in the PDF/XFA processing workflow[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **DomXfaParserFuzzer Harness** [0m[1;39m([0m[39mfor context only[0m[1;39m)[0m[39m:[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m59[0m[39m to understand how test input is provided to the vulnerable code path[0m   [2m                [0m
[2;36m                    [0m         [39m   - This helps reproduce and validate the issue but is not the root cause[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability requires remediation in the XML parser configuration used by [0m     [2m                [0m
[2;36m                    [0m         [39mPDFBox when processing XFA resources to prevent external entity resolution and [0m     [2m                [0m
[2;36m                    [0m         [39munauthorized network requests.[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazze.com:[0m[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntit[0m [2m                [0m
[2;36m                    [0m         [1;35my[0m[1;39m([0m[39mXMLEntityManager.jav[0m[1;92ma:677[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1397[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1333[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnEntityReference[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:1859[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$[0m[1;35mFra[0m [2m                [0m
[2;36m                    [0m         [1;35mgmentContentDriver.next[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:3001[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next[0m[1;39m([0m[39mXMLDoc[0m [2m                [0m
[2;36m                    [0m         [39mumentScannerImpl.jav[0m[1;92ma:605[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next[0m[1;39m([0m[39mXMLN[0m [2m                [0m
[2;36m                    [0m         [39mSDocumentScannerImpl.jav[0m[1;92ma:112[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnDocument[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:542[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:889[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:825[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XMLParser.parse[0m[1;39m([0m[39mXMLParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m141[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.DOMParser.parse[0m[1;39m([0m[39mDOMParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m247[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse[0m[1;39m([0m[39mDocument[0m [2m                [0m
[2;36m                    [0m         [39mBuilderImpl.jav[0m[1;92ma:342[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mjavax.xml.parsers.DocumentBuilder.parse[0m[1;39m([0m[39mDocumentBuilder.jav[0m[1;92ma:122[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.interactive.form.PDXFAResource.getDocument[0m[1;39m([0m[39mPDXFAResource.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:139[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.DomXfaParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mDomXfaParserFuzzer.jav[0m[1;92ma:59[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 16287e730c24509c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m1[0m[39m-[0m[1;36m27[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.pdfbox.pdmodel.interactive.form;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import javax.xml.parsers.DocumentBuilder;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import javax.xml.parsers.DocumentBuilderFactory;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m133[0m[39m-[0m[1;36m144[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    public Document [0m[1;35mgetDocument[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        DocumentBuilderFactory factory = [0m[1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            DocumentBuilder builder = [0m[1;35mfactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            return [0m[1;35mbuilder.parse[0m[1;39m([0m[39mnew [0m[1;35mByteArrayInputStream[0m[1;39m([0m[1;35mthis.getBytes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException | SAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/util/XMLUtil.jav[0m[1;92ma:18[0m[39m-[0m[1;36m28[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import javax.xml.parsers.DocumentBuilder;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import javax.xml.parsers.DocumentBuilderFactory;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import javax.xml.parsers.FactoryConfigurationError;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.w3c.dom.Document;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.w3c.dom.Element;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/util/XMLUtil.jav[0m[1;92ma:68[0m[39m-[0m[1;36m90[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    public static Document [0m[1;35mparse[0m[1;39m([0m[39mInputStream is, boolean nsAware[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        try[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            DocumentBuilderFactory builderFactory = [0m                             [2m                [0m
[2;36m                    [0m         [1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://apache.org/xml/features/disallow-doctype-decl"[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-general-entities"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    false[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-parameter-entities"[0m [2m                [0m
[2;36m                    [0m         [39m,[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                    false[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;35mbuilderFactory.setFeature[0m[1;39m([0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                    [0m                                                             [2m                [0m
[2;36m                    [0m         [32m"http://apache.org/xml/features/nonvalidating/load-external-dtd"[0m[39m, false[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            [0m[1;35mbuilderFactory.setXIncludeAware[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            [0m[1;35mbuilderFactory.setExpandEntityReferences[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[1;35mbuilderFactory.setNamespaceAware[0m[1;39m([0m[39mnsAware[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            DocumentBuilder builder = [0m[1;35mbuilderFactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35mbuilder.parse[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        catch [0m[1;39m([0m[39mFactoryConfigurationError | ParserConfigurationException | [0m       [2m                [0m
[2;36m                    [0m         [39mSAXException e[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35me.getMessage[0m[1;39m([0m[1;39m)[0m[39m, e[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/util/XMLUtil.jav[0m[1;92ma:1[0m[39m-[0m[1;36m32[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.pdfbox.util;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import javax.xml.parsers.DocumentBuilder;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import javax.xml.parsers.DocumentBuilderFactory;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import javax.xml.parsers.FactoryConfigurationError;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.w3c.dom.Document;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.w3c.dom.Element;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.w3c.dom.Node;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.w3c.dom.NodeList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.w3c.dom.Text;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/util/XMLUtil.jav[0m[1;92ma:49[0m[39m-[0m[1;36m91[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * This will parse an XML stream and create a DOM document.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * @param is The stream to get the XML from.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * @return The DOM document.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * @throws IOException It there is an error creating the dom.[0m                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    public static Document [0m[1;35mparse[0m[1;39m([0m[39mInputStream is[0m[1;39m)[0m[39m throws IOException[0m              [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        return [0m[1;35mparse[0m[1;39m([0m[39mis, false[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * This will parse an XML stream and create a DOM document.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * @param is The stream to get the XML from.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * @param nsAware activates namespace awareness of the parser[0m                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * @return The DOM document.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * @throws IOException It there is an error creating the dom.[0m                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    public static Document [0m[1;35mparse[0m[1;39m([0m[39mInputStream is, boolean nsAware[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        try[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            DocumentBuilderFactory builderFactory = [0m                             [2m                [0m
[2;36m                    [0m         [1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://apache.org/xml/features/disallow-doctype-decl"[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-general-entities"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    false[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-parameter-entities"[0m [2m                [0m
[2;36m                    [0m         [39m,[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                    false[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;35mbuilderFactory.setFeature[0m[1;39m([0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                    [0m                                                             [2m                [0m
[2;36m                    [0m         [32m"http://apache.org/xml/features/nonvalidating/load-external-dtd"[0m[39m, false[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            [0m[1;35mbuilderFactory.setXIncludeAware[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            [0m[1;35mbuilderFactory.setExpandEntityReferences[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[1;35mbuilderFactory.setNamespaceAware[0m[1;39m([0m[39mnsAware[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            DocumentBuilder builder = [0m[1;35mbuilderFactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35mbuilder.parse[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        catch [0m[1;39m([0m[39mFactoryConfigurationError | ParserConfigurationException | [0m       [2m                [0m
[2;36m                    [0m         [39mSAXException e[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35me.getMessage[0m[1;39m([0m[1;39m)[0m[39m, e[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mxmpbox/src/main/java/org/apache/xmpbox/xml/DomXmpParser.jav[0m[1;92ma:30[0m[39m-[0m[1;36m40[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.Deque;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.StringTokenizer;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import javax.xml.XMLConstants;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import javax.xml.namespace.QName;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import javax.xml.parsers.DocumentBuilder;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import javax.xml.parsers.DocumentBuilderFactory;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mxmpbox/src/main/java/org/apache/xmpbox/xml/DomXmpParser.jav[0m[1;92ma:77[0m[39m-[0m[1;36m90[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    public [0m[1;35mDomXmpParser[0m[1;39m([0m[1;39m)[0m[39m throws XmpParsingException[0m                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        try[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            DocumentBuilderFactory dbFactory = [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            [0m[1;35mdbFactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            dBuilder = [0m[1;35mdbFactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            nsFinder = new [0m[1;35mNamespaceFinder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        catch [0m[1;39m([0m[39mParserConfigurationException e[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            throw new [0m[1;35mXmpParsingException[0m[1;39m([0m[39mErrorType.Configuration, [0m[32m"Failed to [0m   [2m                [0m
[2;36m                    [0m         [32minitialize"[0m[39m, e[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResourceTest.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:19[0m[39m-[0m[1;36m29[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static org.junit.jupiter.api.Assertions.assertEquals;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import static org.junit.jupiter.api.Assertions.assertNotNull;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.pdfbox.Loader;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.pdfbox.pdmodel.PDDocument;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.junit.jupiter.api.Test;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.w3c.dom.Document;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.w3c.dom.Node;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/test/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResourceTest.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:36[0m[39m-[0m[1;36m51[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:public class PDXFAResourceTest [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    public void [0m[1;35mtestBasic[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        Path p = [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mPDXFAResourceTest.class.getResource[0m[1;39m([0m[32m"testXFA.pdf"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        PDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[1;35mp.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        PDAcroForm pdAcroForm = [0m                                                 [2m                [0m
[2;36m                    [0m         [1;35mpdDocument.getDocumentCatalog[0m[1;39m([0m[1;39m)[0m[1;35m.getAcroForm[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[39mpdAcroForm[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        PDXFAResource pdxfa = [0m[1;35mpdAcroForm.getXFA[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[39mpdxfa[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        Document document = [0m[1;35mpdxfa.getDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        Node node = [0m[1;35mdocument.getFirstChild[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"xdp:xdp"[0m[39m, [0m[1;35mnode.getNodeName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m9[0m[39m, [0m[1;35mnode.getChildNodes[0m[1;39m([0m[1;39m)[0m[1;35m.getLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDAcroForm.jav[0m[1;92ma:582[0m [2m                [0m
[2;36m                    [0m         [39m-[0m[1;36m592[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:     * @return The xfa resource or null if it does not exist.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:    public PDXFAResource [0m[1;35mgetXFA[0m[1;39m([0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        COSBase base = [0m[1;35mdictionary.getDictionaryObject[0m[1;39m([0m[39mCOSName.XFA[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:        return base != null ? new [0m[1;35mPDXFAResource[0m[1;39m([0m[39mbase[0m[1;39m)[0m[39m : null;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:     * Set the XFA resource, this is only used for PDF [0m[1;36m1.5[0m[39m+ forms.[0m              [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m65[0m[39m-[0m[1;36m91[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * Get the XFA content as byte array.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * The XFA is either a stream containing the entire XFA resource or an array[0m [2m                [0m
[2;36m                    [0m         [39mspecifying individual packets that[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * together make up the XFA resource.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * A packet is a pair of a string and stream. The string contains the name [0m  [2m                [0m
[2;36m                    [0m         [39mof the XML element and the stream[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * contains the complete text of this XML element. Each packet represents a [0m [2m                [0m
[2;36m                    [0m         [39mcomplete XML element, with the exception[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * of the first and last packet, which specify begin and end tags for the [0m   [2m                [0m
[2;36m                    [0m         [39mxdp:xdp element. [0m[1;39m[[0m[39mIS0 [0m[1;36m32000[0m[39m-[0m[1;92m1:2008[0m[39m:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * [0m[1;36m12.7[0m[39m.[0m[1;36m8[0m[1;39m][0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @return the XFA content[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * @throws IOException if the XFA content could not be created[0m               [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     *[0m[35m/[0m[39m    [0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetBytes[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[35m/[0m[39m handle the case if the XFA is split into individual parts[0m             [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        if [0m[1;39m([0m[1;35mthis.getCOSObject[0m[1;39m([0m[1;39m)[0m[39m instanceof COSArray[0m[1;39m)[0m[39m [0m                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            return [0m[1;35mgetBytesFromPacket[0m[1;39m([0m[1;39m([0m[39mCOSArray[0m[1;39m)[0m[39m [0m[1;35mthis.getCOSObject[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        else if [0m[1;39m([0m[1;35mxfa.getCOSObject[0m[1;39m([0m[1;39m)[0m[39m instanceof COSStream[0m[1;39m)[0m[39m [0m                       [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            return [0m[1;35mgetBytesFromStream[0m[1;39m([0m[1;39m([0m[39mCOSStream[0m[1;39m)[0m[39m [0m[1;35mthis.getCOSObject[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        return new byte[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m122[0m[39m-[0m[1;36m143[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:     * Get the XFA content as W3C document.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:     * @see #[0m[1;35mgetBytes[0m[1;39m([0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:     * @return the XFA content[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:     * @throws IOException if something went wrong when reading the XFA [0m        [2m                [0m
[2;36m                    [0m         [39mcontent.[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:     *[0m[35m/[0m[39m        [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    public Document [0m[1;35mgetDocument[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        DocumentBuilderFactory factory = [0m[1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            DocumentBuilder builder = [0m[1;35mfactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            return [0m[1;35mbuilder.parse[0m[1;39m([0m[39mnew [0m[1;35mByteArrayInputStream[0m[1;39m([0m[1;35mthis.getBytes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException | SAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m133[0m[39m-[0m[1;36m143[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    public Document [0m[1;35mgetDocument[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        DocumentBuilderFactory factory = [0m[1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            DocumentBuilder builder = [0m[1;35mfactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            return [0m[1;35mbuilder.parse[0m[1;39m([0m[39mnew [0m[1;35mByteArrayInputStream[0m[1;39m([0m[1;35mthis.getBytes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException | SAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/util/XMLUtil.jav[0m[1;92ma:68[0m[39m-[0m[1;36m91[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    public static Document [0m[1;35mparse[0m[1;39m([0m[39mInputStream is, boolean nsAware[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        try[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            DocumentBuilderFactory builderFactory = [0m                             [2m                [0m
[2;36m                    [0m         [1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://apache.org/xml/features/disallow-doctype-decl"[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-general-entities"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    false[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-parameter-entities"[0m [2m                [0m
[2;36m                    [0m         [39m,[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                    false[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;35mbuilderFactory.setFeature[0m[1;39m([0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                    [0m                                                             [2m                [0m
[2;36m                    [0m         [32m"http://apache.org/xml/features/nonvalidating/load-external-dtd"[0m[39m, false[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            [0m[1;35mbuilderFactory.setXIncludeAware[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            [0m[1;35mbuilderFactory.setExpandEntityReferences[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[1;35mbuilderFactory.setNamespaceAware[0m[1;39m([0m[39mnsAware[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            DocumentBuilder builder = [0m[1;35mbuilderFactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35mbuilder.parse[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        catch [0m[1;39m([0m[39mFactoryConfigurationError | ParserConfigurationException | [0m       [2m                [0m
[2;36m                    [0m         [39mSAXException e[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35me.getMessage[0m[1;39m([0m[1;39m)[0m[39m, e[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m19[0m[39m-[0m[1;36m33[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import javax.xml.parsers.DocumentBuilder;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import javax.xml.parsers.DocumentBuilderFactory;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.pdfbox.cos.COSArray;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.pdfbox.cos.COSBase;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.pdfbox.cos.COSStream;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.pdfbox.pdmodel.common.COSObjectable;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.w3c.dom.Document;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m133[0m[39m-[0m[1;36m143[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    public Document [0m[1;35mgetDocument[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        DocumentBuilderFactory factory = [0m[1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            DocumentBuilder builder = [0m[1;35mfactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            return [0m[1;35mbuilder.parse[0m[1;39m([0m[39mnew [0m[1;35mByteArrayInputStream[0m[1;39m([0m[1;35mthis.getBytes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException | SAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/Loader.jav[0m[1;92ma:140[0m[39m-[0m[1;36m152[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:     * This will load a document from an input stream. The stream is loaded to [0m [2m                [0m
[2;36m                    [0m         [39mthe memory to establish random access to[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:     * the data.[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:     * @param input The stream that contains the document.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:     * @return The document that was loaded.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:     * @throws IOException If there is an error reading from the stream.[0m        [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    public static FDFDocument [0m[1;35mloadXFDF[0m[1;39m([0m[39mInputStream input[0m[1;39m)[0m[39m throws IOException[0m    [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        return new [0m[1;35mFDFDocument[0m[1;39m([0m[1;35mXMLUtil.parse[0m[1;39m([0m[39minput[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/Loader.jav[0m[1;92ma:17[0m[39m-[0m[1;36m30[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.pdfbox;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.FileInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.pdfbox.io.IOUtils;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.pdfbox.io.RandomAccessReadBufferedFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.pdfbox.io.RandomAccessStreamCache.StreamCacheCreateFunction;[0m   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.pdfbox.io.RandomAccessReadBuffer;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.pdfbox.io.RandomAccessRead;[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/Loader.jav[0m[1;92ma:140[0m[39m-[0m[1;36m152[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:     * This will load a document from an input stream. The stream is loaded to [0m [2m                [0m
[2;36m                    [0m         [39mthe memory to establish random access to[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:     * the data.[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:     * @param input The stream that contains the document.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:     * @return The document that was loaded.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:     * @throws IOException If there is an error reading from the stream.[0m        [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    public static FDFDocument [0m[1;35mloadXFDF[0m[1;39m([0m[39mInputStream input[0m[1;39m)[0m[39m throws IOException[0m    [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        return new [0m[1;35mFDFDocument[0m[1;39m([0m[1;35mXMLUtil.parse[0m[1;39m([0m[39minput[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/Loader.jav[0m[1;92ma:35[0m[39m-[0m[1;36m37[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.pdfbox.pdmodel.fdf.FDFDocument;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.pdfbox.util.XMLUtil;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/Loader.jav[0m[1;92ma:149[0m[39m-[0m[1;36m152[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    public static FDFDocument [0m[1;35mloadXFDF[0m[1;39m([0m[39mInputStream input[0m[1;39m)[0m[39m throws IOException[0m    [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        return new [0m[1;35mFDFDocument[0m[1;39m([0m[1;35mXMLUtil.parse[0m[1;39m([0m[39minput[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m19[0m[39m-[0m[1;36m33[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import javax.xml.parsers.DocumentBuilder;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import javax.xml.parsers.DocumentBuilderFactory;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.pdfbox.cos.COSArray;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.pdfbox.cos.COSBase;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.pdfbox.cos.COSStream;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.pdfbox.pdmodel.common.COSObjectable;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.w3c.dom.Document;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m133[0m[39m-[0m[1;36m143[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    public Document [0m[1;35mgetDocument[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        DocumentBuilderFactory factory = [0m[1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            DocumentBuilder builder = [0m[1;35mfactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            return [0m[1;35mbuilder.parse[0m[1;39m([0m[39mnew [0m[1;35mByteArrayInputStream[0m[1;39m([0m[1;35mthis.getBytes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException | SAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m1[0m[39m-[0m[1;36m33[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.pdfbox.pdmodel.interactive.form;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import javax.xml.parsers.DocumentBuilder;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import javax.xml.parsers.DocumentBuilderFactory;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.pdfbox.cos.COSArray;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.pdfbox.cos.COSBase;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.pdfbox.cos.COSStream;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.pdfbox.pdmodel.common.COSObjectable;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.w3c.dom.Document;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m79[0m[39m-[0m[1;36m91[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetBytes[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[35m/[0m[39m handle the case if the XFA is split into individual parts[0m             [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        if [0m[1;39m([0m[1;35mthis.getCOSObject[0m[1;39m([0m[1;39m)[0m[39m instanceof COSArray[0m[1;39m)[0m[39m [0m                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            return [0m[1;35mgetBytesFromPacket[0m[1;39m([0m[1;39m([0m[39mCOSArray[0m[1;39m)[0m[39m [0m[1;35mthis.getCOSObject[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        else if [0m[1;39m([0m[1;35mxfa.getCOSObject[0m[1;39m([0m[1;39m)[0m[39m instanceof COSStream[0m[1;39m)[0m[39m [0m                       [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            return [0m[1;35mgetBytesFromStream[0m[1;39m([0m[1;39m([0m[39mCOSStream[0m[1;39m)[0m[39m [0m[1;35mthis.getCOSObject[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        return new byte[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m133[0m[39m-[0m[1;36m143[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    public Document [0m[1;35mgetDocument[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        DocumentBuilderFactory factory = [0m[1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            DocumentBuilder builder = [0m[1;35mfactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            return [0m[1;35mbuilder.parse[0m[1;39m([0m[39mnew [0m[1;35mByteArrayInputStream[0m[1;39m([0m[1;35mthis.getBytes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException | SAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/util/XMLUtil.jav[0m[1;92ma:49[0m[39m-[0m[1;36m91[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * This will parse an XML stream and create a DOM document.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * @param is The stream to get the XML from.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * @return The DOM document.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * @throws IOException It there is an error creating the dom.[0m                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    public static Document [0m[1;35mparse[0m[1;39m([0m[39mInputStream is[0m[1;39m)[0m[39m throws IOException[0m              [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        return [0m[1;35mparse[0m[1;39m([0m[39mis, false[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * This will parse an XML stream and create a DOM document.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * @param is The stream to get the XML from.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * @param nsAware activates namespace awareness of the parser[0m                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * @return The DOM document.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * @throws IOException It there is an error creating the dom.[0m                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    public static Document [0m[1;35mparse[0m[1;39m([0m[39mInputStream is, boolean nsAware[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        try[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            DocumentBuilderFactory builderFactory = [0m                             [2m                [0m
[2;36m                    [0m         [1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://apache.org/xml/features/disallow-doctype-decl"[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-general-entities"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    false[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            [0m                                                                     [2m                [0m
[2;36m                    [0m         [1;35mbuilderFactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-parameter-entities"[0m [2m                [0m
[2;36m                    [0m         [39m,[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                    false[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;35mbuilderFactory.setFeature[0m[1;39m([0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                    [0m                                                             [2m                [0m
[2;36m                    [0m         [32m"http://apache.org/xml/features/nonvalidating/load-external-dtd"[0m[39m, false[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            [0m[1;35mbuilderFactory.setXIncludeAware[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            [0m[1;35mbuilderFactory.setExpandEntityReferences[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[1;35mbuilderFactory.setNamespaceAware[0m[1;39m([0m[39mnsAware[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            DocumentBuilder builder = [0m[1;35mbuilderFactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35mbuilder.parse[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        catch [0m[1;39m([0m[39mFactoryConfigurationError | ParserConfigurationException | [0m       [2m                [0m
[2;36m                    [0m         [39mSAXException e[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35me.getMessage[0m[1;39m([0m[1;39m)[0m[39m, e[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy for SSRF Vulnerability in PDXFAResource[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Analysis Summary[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Root Cause Identified:**[0m                                                          [2m                [0m
[2;36m                    [0m         [39mThe `[0m[1;35mPDXFAResource.getDocument[0m[1;39m([0m[1;39m)[0m[39m` method at lines [0m[1;36m133[0m[39m-[0m[1;36m143[0m[39m creates a [0m                [2m                [0m
[2;36m                    [0m         [39m`DocumentBuilderFactory` and `DocumentBuilder` without any XML security features [0m   [2m                [0m
[2;36m                    [0m         [39menabled. It only sets `[0m[1;35msetNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m136[0m[1;39m)[0m[39m but fails to disable [0m    [2m                [0m
[2;36m                    [0m         [39mexternal entity resolution, which allows XXE/SSRF attacks when parsing untrusted [0m   [2m                [0m
[2;36m                    [0m         [39mXFA content from PDF files.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerability Path:**[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- Untrusted PDF → PDAcroForm → PDXFAResource → [0m[1;35mgetBytes[0m[1;39m([0m[1;39m)[0m[39m extracts XML → [0m           [2m                [0m
[2;36m                    [0m         [1;35mgetDocument[0m[1;39m([0m[1;39m)[0m[39m parses XML with insecure parser → External entities resolved → SSRF [0m  [2m                [0m
[2;36m                    [0m         [39mto jazze.com:[0m[1;36m80[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Key Insights:**[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. PDFBox already has a secure XML parsing utility: `[0m[1;35mXMLUtil.parse[0m[1;39m([0m[1;39m)[0m[39m` in [0m           [2m                [0m
[2;36m                    [0m         [39m`org.apache.pdfbox.util.XMLUtil`[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. XMLUtil implements all required security features to prevent XXE/SSRF attacks[0m    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The Loader class already uses XMLUtil for secure FDF/XFDF parsing [0m[1;39m([0m[39mline [0m[1;36m151[0m[39m: [0m    [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mXMLUtil.parse[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m`[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. This is related to CVE-[0m[1;36m2019[0m[39m-[0m[1;36m0228[0m[39m [0m[1;39m([0m[39mPDFBOX-[0m[1;36m4505[0m[1;39m)[0m[39m where XMLUtil was created as part[0m [2m                [0m
[2;36m                    [0m         [39mof DRY fixes[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. PDXFAResource requires namespace-aware parsing [0m[1;39m([0m[39mcurrently set at line [0m[1;36m136[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Recommended Fix Strategy[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Primary Approach: Leverage [0m[1;35mXMLUtil.parse[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39mPreferred[0m[1;39m)[0m[39m**[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis approach follows the DRY [0m[1;39m([0m[39mDon't Repeat Yourself[0m[1;39m)[0m[39m principle and maintains [0m      [2m                [0m
[2;36m                    [0m         [39mconsistency with the existing secure XML parsing pattern in PDFBox.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1[0m[39m: Add XMLUtil import**[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- Location: [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m`pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.java[0m [2m                [0m
[2;36m                    [0m         [39m`[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m- After line [0m[1;36m26[0m[39m [0m[1;39m([0m[39mafter `javax.xml.parsers.ParserConfigurationException`[0m[1;39m)[0m[39m, add:[0m      [2m                [0m
[2;36m                    [0m         [39m  ```java[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  import org.apache.pdfbox.util.XMLUtil;[0m                                            [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m2[0m[39m: Replace [0m[1;35mgetDocument[0m[1;39m([0m[1;39m)[0m[39m method implementation**[0m                             [2m                [0m
[2;36m                    [0m         [39m- Location: Lines [0m[1;36m133[0m[39m-[0m[1;36m143[0m[39m in PDXFAResource.java[0m                                     [2m                [0m
[2;36m                    [0m         [39m- Replace the entire method body with a single call to [0m[1;35mXMLUtil.parse[0m[1;39m([0m[1;39m)[0m[39m:[0m             [2m                [0m
[2;36m                    [0m         [39m  ```java[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  public Document [0m[1;35mgetDocument[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [39m  [0m[1;39m{[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m      return [0m[1;35mXMLUtil.parse[0m[1;39m([0m[39mnew [0m[1;35mByteArrayInputStream[0m[1;39m([0m[1;35mthis.getBytes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, true[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [39m  [0m[1;39m}[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale:**[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- The second parameter `true` enables namespace awareness, preserving the existing [0m [2m                [0m
[2;36m                    [0m         [39mbehavior [0m[1;39m([0m[39mline [0m[1;36m136[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- [0m[1;35mXMLUtil.parse[0m[1;39m([0m[1;39m)[0m[39m automatically provides all [0m[1;36m6[0m[39m security features:[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. Disallows DOCTYPE declarations[0m                                                 [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. Disables external general entities[0m                                             [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. Disables external parameter entities[0m                                           [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. Prevents loading external DTDs[0m                                                 [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m5[0m[39m. Disables XInclude processing[0m                                                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m6[0m[39m. Prevents entity reference expansion[0m                                            [2m                [0m
[2;36m                    [0m         [39m- This eliminates code duplication and ensures future security updates to XMLUtil [0m  [2m                [0m
[2;36m                    [0m         [39mautomatically apply to XFA parsing[0m                                                  [2m                [0m
[2;36m                    [0m         [39m- Simplifies the code from [0m[1;36m9[0m[39m lines to [0m[1;36m3[0m[39m lines[0m                                       [2m                [0m
[2;36m                    [0m         [39m- Matches the pattern used in [0m[1;35mLoader.loadXFDF[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39mline [0m[1;36m151[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m3[0m[39m: Optional cleanup of unused imports**[0m                                      [2m                [0m
[2;36m                    [0m         [39m- After the fix, if DocumentBuilder and DocumentBuilderFactory are no longer used [0m  [2m                [0m
[2;36m                    [0m         [39melsewhere in PDXFAResource, the following imports can be removed:[0m                   [2m                [0m
[2;36m                    [0m         [39m  - Line [0m[1;36m24[0m[39m: `javax.xml.parsers.DocumentBuilder`[0m                                    [2m                [0m
[2;36m                    [0m         [39m  - Line [0m[1;36m25[0m[39m: `javax.xml.parsers.DocumentBuilderFactory`[0m                             [2m                [0m
[2;36m                    [0m         [39m  - Line [0m[1;36m26[0m[39m: `javax.xml.parsers.ParserConfigurationException`[0m                       [2m                [0m
[2;36m                    [0m         [39m- However, verify these aren't used by other methods in the class first[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Alternative Fix Strategy [0m[1;39m([0m[39mIf XMLUtil cannot be used[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Inline Security Configuration Approach**[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIf there are constraints against adding the XMLUtil dependency, apply the security [0m [2m                [0m
[2;36m                    [0m         [39mconfiguration inline:[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Replace lines [0m[1;36m133[0m[39m-[0m[1;36m143[0m[39m:**[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mpublic Document [0m[1;35mgetDocument[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                    [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    DocumentBuilderFactory factory = [0m[1;35mDocumentBuilderFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [39m    try [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mfactory.setFeature[0m[1;39m([0m[32m"http://apache.org/xml/features/disallow-doctype-decl"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mfactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-general-entities"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mfactory.setFeature[0m[1;39m([0m[32m"http://xml.org/sax/features/external-parameter-entities[0m [2m                [0m
[2;36m                    [0m         [32m"[0m[39m, false[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mfactory.setFeature[0m[1;39m([0m[32m"http://apache.org/xml/features/nonvalidating/load-exter[0m [2m                [0m
[2;36m                    [0m         [32mnal-dtd"[0m[39m, false[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mfactory.setXIncludeAware[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mfactory.setExpandEntityReferences[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m        DocumentBuilder builder = [0m[1;35mfactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m        return [0m[1;35mbuilder.parse[0m[1;39m([0m[39mnew [0m[1;35mByteArrayInputStream[0m[1;39m([0m[1;35mthis.getBytes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException | SAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Note:** This matches the configuration in [0m[1;35mXMLUtil.parse[0m[1;39m([0m[1;39m)[0m[39m exactly, maintaining [0m   [2m                [0m
[2;36m                    [0m         [39mthe same security posture.[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Justification and Impact Analysis[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why This is Optimal:**[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Security:** Completely eliminates XXE/SSRF vulnerabilities by disabling all [0m   [2m                [0m
[2;36m                    [0m         [39mexternal entity resolution mechanisms[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Consistency:** Uses the same security pattern as other XML parsing in PDFBox [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mFDF/XFDF loading[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Maintainability:** DRY principle - single source of truth for secure XML [0m      [2m                [0m
[2;36m                    [0m         [39mparsing configuration[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Simplicity:** Reduces code complexity and potential for future security [0m       [2m                [0m
[2;36m                    [0m         [39mregressions[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Backward Compatibility:** Preserves namespace awareness required for XFA [0m      [2m                [0m
[2;36m                    [0m         [39mparsing[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Preserves Existing Logic:**[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- The `[0m[1;35mgetBytes[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m79[0m[39m-[0m[1;36m91[0m[1;39m)[0m[39m remains unchanged - still extracts XFA [0m     [2m                [0m
[2;36m                    [0m         [39mcontent from PDF[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- Namespace awareness is maintained [0m[1;39m([0m[39mrequired for XFA: xdp:xdp elements, etc.[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m- Return type [0m[1;39m([0m[39mDocument[0m[1;39m)[0m[39m unchanged[0m                                                  [2m                [0m
[2;36m                    [0m         [39m- Exception handling unchanged [0m[1;39m([0m[39mIOException thrown for parsing errors[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m- Existing test `[0m[1;35mPDXFAResourceTest.testBasic[0m[1;39m([0m[1;39m)[0m[39m` will continue to pass:[0m              [2m                [0m
[2;36m                    [0m         [39m  - Test expects `xdp:xdp` root node [0m[1;39m([0m[39mnamespace-aware parsing[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [39m  - Test expects [0m[1;36m9[0m[39m child nodes in the parsed structure[0m                              [2m                [0m
[2;36m                    [0m         [39m  - Both requirements are satisfied with namespace-aware secure parsing[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Addresses Evaluation Report Issues:**[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- ✅ Prevents external entity resolution [0m[1;39m([0m[39mdisables all entity processing[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m- ✅ Blocks connection attempts to external hosts [0m[1;39m([0m[39mjazze.com:[0m[1;36m80[0m[39m will not be [0m        [2m                [0m
[2;36m                    [0m         [39mcontacted[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- ✅ Mitigates SSRF attack vector completely[0m                                        [2m                [0m
[2;36m                    [0m         [39m- ✅ Prevents DTD processing attacks[0m                                                [2m                [0m
[2;36m                    [0m         [39m- ✅ Disables XInclude processing[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- ✅ No impact on fuzzing harness [0m[1;39m([0m[39mfuzzer can still test with malicious inputs, but[0m [2m                [0m
[2;36m                    [0m         [39mthey won't trigger SSRF[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects:**[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Mitigation:** If legitimate XFA documents rely on external entities, they will [0m [2m                [0m
[2;36m                    [0m         [39mfail to parse after this fix[0m                                                        [2m                [0m
[2;36m                    [0m         [39m  - **Assessment:** This is acceptable - XFA in PDF should be self-contained; [0m      [2m                [0m
[2;36m                    [0m         [39mexternal entities in PDF/XFA pose security risks[0m                                    [2m                [0m
[2;36m                    [0m         [39m  - **Industry Standard:** Disabling external entities is the recommended security [0m [2m                [0m
[2;36m                    [0m         [39mpractice [0m[1;39m([0m[39mOWASP, CWE-[0m[1;36m611[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Mitigation:** DOCTYPE declarations in XFA will be rejected[0m                      [2m                [0m
[2;36m                    [0m         [39m  - **Assessment:** XFA specification doesn't require DOCTYPE declarations in [0m      [2m                [0m
[2;36m                    [0m         [39membedded forms[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m  - **Validation:** Existing test suite should verify no legitimate use cases are [0m  [2m                [0m
[2;36m                    [0m         [39mbroken[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Similar Solutions in Codebase:**[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mLoader.loadXFDF[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m151[0m[1;39m)[0m[39m: Uses `[0m[1;35mXMLUtil.parse[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m` for secure FDF [0m       [2m                [0m
[2;36m                    [0m         [39mparsing[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mXMLUtil.parse[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m69[0m[39m-[0m[1;36m91[0m[1;39m)[0m[39m: Reference implementation of secure XML parsing[0m   [2m                [0m
[2;36m                    [0m         [39m- All follow the same pattern of using XMLUtil for XML parsing from untrusted [0m      [2m                [0m
[2;36m                    [0m         [39msources[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Implementation Notes[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Testing Requirements:**[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- Verify existing test `[0m[1;35mPDXFAResourceTest.testBasic[0m[1;39m([0m[1;39m)[0m[39m` passes after the fix[0m         [2m                [0m
[2;36m                    [0m         [39m- Verify fuzzer no longer reports SSRF vulnerability when processing XFA with [0m      [2m                [0m
[2;36m                    [0m         [39mexternal entity references[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- No new tests required - the fix doesn't change functionality, only adds security[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**No Changes Required To:**[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- Fuzzing harness [0m[1;39m([0m[39mDomXfaParserFuzzer.java[0m[1;39m)[0m[39m - remains unchanged[0m                     [2m                [0m
[2;36m                    [0m         [39m- Test files or test infrastructure[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- External libraries or dependencies[0m                                                [2m                [0m
[2;36m                    [0m         [39m- Any other modules [0m[1;39m([0m[39mxmpbox has a separate similar issue but should be fixed [0m       [2m                [0m
[2;36m                    [0m         [39mseparately[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Files Modified:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- [0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m`pdfbox/src/main/java/org/apache/pdfbox/pdmodel/interactive/form/PDXFAResource.java[0m [2m                [0m
[2;36m                    [0m         [39m`[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m  - Add import for XMLUtil[0m                                                          [2m                [0m
[2;36m                    [0m         [39m  - Replace [0m[1;35mgetDocument[0m[1;39m([0m[1;39m)[0m[39m method implementation[0m                                     [2m                [0m
[2;36m                    [0m         [39m  - Optionally remove unused imports[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=876391;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=504213;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=266786;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=72442;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp_0xgfqze[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_1/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768279656.773974[0m                                                       [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-full-01_vuln_1.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/13/26 04:47:38][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mpdfbox[0m         ]8;id=972686;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=859672;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m[01/13/26 04:47:39][0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=102379;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=772011;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mpdfbox[0m                [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=149353;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=966905;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mpdfbox[0m                 [2m               [0m
