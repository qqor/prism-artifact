--- a/libexif/fuji/exif-mnote-data-fuji.c
+++ b/libexif/fuji/exif-mnote-data-fuji.c
@@ -163,12 +163,12 @@
 			  "ExifMnoteDataFuji", "Short MakerNote");
 		return;
 	}
-	if (CHECKOVERFLOW(n->offset, buf_size, 6+8+4)) {
+	datao = 6 + n->offset;
+	if (CHECKOVERFLOW(datao, buf_size, 12)) {
 		exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
 			  "ExifMnoteDataFuji", "Short MakerNote");
 		return;
 	}
-	datao = 6 + n->offset;
 
 	n->order = EXIF_BYTE_ORDER_INTEL;
 
