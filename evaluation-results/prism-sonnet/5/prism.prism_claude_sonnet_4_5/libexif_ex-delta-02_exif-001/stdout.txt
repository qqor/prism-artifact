[2;36m[01/13/26 02:27:21][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=627187;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=39418;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpe6ewiolt[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/libexif_ex-delta-02_exif-001/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768271241.0229223[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/libexif_ex-delta-02_exif-[1;36m001.[0mtoml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-libexif[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Building Cached for CLEAN environment[1m)[0m           ]8;id=705760;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=767097;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/13/26 02:27:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Building Cached for CLEAN environment[1m)[0m Took     ]8;id=809889;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=637766;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m28.58[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=458515;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=595069;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running tests for Cached for CLEAN environment[1m)[0m ]8;id=86720;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=530957;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=20919;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=526445;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m28[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=212958;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=844924;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 02:27:50][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.86[0m seconds;               ]8;id=793042;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=874512;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=269100;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=993716;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=740611;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=826776;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=420379;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=642759;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=124735;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=910392;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 02:27:51][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m1.00[0m seconds;               ]8;id=78795;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=392487;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 02:27:52][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=922069;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=179739;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 02:27:53][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.96[0m seconds;               ]8;id=126600;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=793852;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 02:27:55][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=500799;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=215021;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer exif_from_data_fuzzer -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m       [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3174441528[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2731[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2731[0m[39m [0m[1;39m[[0m[1;36m0x560b9c8f86b8[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x560b9c8f9163[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2731[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2731[0m[39m [0m[1;39m[[0m[1;36m0x560b9c8f9168[0m[39m,[0m[1;36m0x560b9c903c18[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x50600000011f[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x560b9c83572b[0m[39m bp [0m[1;36m0x7fff5b159b70[0m[39m sp [0m[1;36m0x7fff5b159b68[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x50600000011f[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560b9c83572a[0m[39m in exif_get_slong [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m137:36[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560b9c83572a[0m[39m in exif_get_long [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m167:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560b9c83e237[0m[39m in exif_mnote_data_fuji_load [0m                                 [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/fuji/[0m[95mexif-mnote-data-fuji.c[0m[39m:[0m[1;92m175:11[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560b9c81af56[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1025:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560b9c81a36e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560b9c8178af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x560b9c6cc330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x560b9c6b75a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x560b9c6bd03f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x560b9c6e82e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f2a4a56b082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x560b9c6af78d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8578d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: exif_get_slong--exif_get_long--exif_mnote_data_fuji_load[0m               [2m                [0m
[2;36m                    [0m         [1;36m0x50600000011f[0m[39m is located [0m[1;36m7[0m[39m bytes after [0m[1;36m56[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5060000000e0[0m[39m,[0m[1;36m0x506000000118[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560b9c7d80ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560b9c852283[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560b9c6b75a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560b9c6bd03f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560b9c6e82e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7f2a4a56b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m137:36[0m[39m in exif_get_slong[0m                          [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000000[0m[39m: fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m04[0m[39m fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000080[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x506000000100[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpy3f9v0u0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3174441528[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2731[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2731[0m[39m [0m[1;39m[[0m[1;36m0x560b9c8f86b8[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x560b9c8f9163[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2731[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2731[0m[39m [0m[1;39m[[0m[1;36m0x560b9c8f9168[0m[39m,[0m[1;36m0x560b9c903c18[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x50600000011f[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x560b9c83572b[0m[39m bp [0m[1;36m0x7fff5b159b70[0m[39m sp [0m[1;36m0x7fff5b159b68[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x50600000011f[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560b9c83572a[0m[39m in exif_get_slong [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m137:36[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560b9c83572a[0m[39m in exif_get_long [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m167:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560b9c83e237[0m[39m in exif_mnote_data_fuji_load [0m                                 [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/fuji/[0m[95mexif-mnote-data-fuji.c[0m[39m:[0m[1;92m175:11[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560b9c81af56[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1025:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560b9c81a36e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560b9c8178af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x560b9c6cc330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x560b9c6b75a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x560b9c6bd03f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x560b9c6e82e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f2a4a56b082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x560b9c6af78d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8578d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: exif_get_slong--exif_get_long--exif_mnote_data_fuji_load[0m               [2m                [0m
[2;36m                    [0m         [1;36m0x50600000011f[0m[39m is located [0m[1;36m7[0m[39m bytes after [0m[1;36m56[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5060000000e0[0m[39m,[0m[1;36m0x506000000118[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560b9c7d80ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560b9c852283[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560b9c6b75a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560b9c6bd03f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560b9c6e82e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7f2a4a56b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m137:36[0m[39m in exif_get_slong[0m                          [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000000[0m[39m: fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m04[0m[39m fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000080[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x506000000100[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0mfa[1m][0mfa fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x506000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpy3f9v0u0[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         exif_from_data_fuzzer -[33mruns[0m=[1;36m100[0m.                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 02:28:15][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=562973;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=901081;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 02:36:12][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=249209;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=574166;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 02:36:45][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=931781;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=692424;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=471440;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=993396;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 02:36:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.88[0m seconds;               ]8;id=614932;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=433975;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Patching[1m)[0m Started[33m...[0m                             ]8;id=514608;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=934041;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp5gz70z9b[0m                                                 ]8;id=625739;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=136925;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 02:37:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Patching[1m)[0m Took [1;36m25.32[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=781132;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=180534;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Checking build[1m)[0m Started[33m...[0m                       ]8;id=178644;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=929141;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 02:37:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Checking build[1m)[0m Took [1;36m3.93[0m seconds;              ]8;id=519634;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=838193;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running PoV[1m)[0m Started[33m...[0m                          ]8;id=204746;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=920203;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 02:37:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running PoV[1m)[0m Took [1;36m2.17[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=492454;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=705731;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Testing[1m)[0m Started[33m...[0m                              ]8;id=962326;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=191509;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=785597;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=84703;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=968336;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=832624;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 02:37:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.91[0m seconds;               ]8;id=910415;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=759073;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 02:37:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=261017;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=409413;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 02:37:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.90[0m seconds;               ]8;id=207292;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=593306;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=264516;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=774648;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 02:37:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.88[0m seconds;               ]8;id=718904;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=449507;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=700321;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=70414;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/libexif/fuji/exif-mnote-data-fuji.c                                           [2m                [0m
[2;36m                    [0m         +++ b/libexif/fuji/exif-mnote-data-fuji.c                                           [2m                [0m
[2;36m                    [0m         @@ [1;36m-163[0m,[1;36m12[0m +[1;36m163[0m,[1;36m12[0m @@                                                               [2m                [0m
[2;36m                    [0m                                   [32m"ExifMnoteDataFuji"[0m, [32m"Short MakerNote"[0m[1m)[0m;                  [2m                [0m
[2;36m                    [0m                         return;                                                             [2m                [0m
[2;36m                    [0m                 [1m}[0m                                                                           [2m                [0m
[2;36m                    [0m         -       if [1m([0m[1;35mCHECKOVERFLOW[0m[1m([0mn->offset, buf_size, [1;36m6[0m+[1;36m8[0m+[1;36m4[0m[1m)[0m[1m)[0m [1m{[0m                            [2m                [0m
[2;36m                    [0m         +       datao = [1;36m6[0m + n->offset;                                                      [2m                [0m
[2;36m                    [0m         +       if [1m([0m[1;35mCHECKOVERFLOW[0m[1m([0mdatao, buf_size, [1;36m12[0m[1m)[0m[1m)[0m [1m{[0m                                   [2m                [0m
[2;36m                    [0m                         exif_log [1m([0men->log, EXIF_LOG_CODE_CORRUPT_DATA,                      [2m                [0m
[2;36m                    [0m                                   [32m"ExifMnoteDataFuji"[0m, [32m"Short MakerNote"[0m[1m)[0m;                  [2m                [0m
[2;36m                    [0m                         return;                                                             [2m                [0m
[2;36m                    [0m                 [1m}[0m                                                                           [2m                [0m
[2;36m                    [0m         -       datao = [1;36m6[0m + n->offset;                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 n->order = EXIF_BYTE_ORDER_INTEL;                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer exif_from_data_fuzzer -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m       [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3174441528[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2731[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2731[0m[39m [0m[1;39m[[0m[1;36m0x560b9c8f86b8[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x560b9c8f9163[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2731[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2731[0m[39m [0m[1;39m[[0m[1;36m0x560b9c8f9168[0m[39m,[0m[1;36m0x560b9c903c18[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x50600000011f[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x560b9c83572b[0m[39m bp [0m[1;36m0x7fff5b159b70[0m[39m sp [0m[1;36m0x7fff5b159b68[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x50600000011f[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560b9c83572a[0m[39m in exif_get_slong [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m137:36[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560b9c83572a[0m[39m in exif_get_long [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m167:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560b9c83e237[0m[39m in exif_mnote_data_fuji_load [0m                                 [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/fuji/[0m[95mexif-mnote-data-fuji.c[0m[39m:[0m[1;92m175:11[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560b9c81af56[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1025:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560b9c81a36e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560b9c8178af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x560b9c6cc330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x560b9c6b75a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x560b9c6bd03f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x560b9c6e82e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f2a4a56b082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x560b9c6af78d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8578d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: exif_get_slong--exif_get_long--exif_mnote_data_fuji_load[0m               [2m                [0m
[2;36m                    [0m         [1;36m0x50600000011f[0m[39m is located [0m[1;36m7[0m[39m bytes after [0m[1;36m56[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5060000000e0[0m[39m,[0m[1;36m0x506000000118[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560b9c7d80ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560b9c852283[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560b9c6b75a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560b9c6bd03f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560b9c6e82e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7f2a4a56b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m137:36[0m[39m in exif_get_slong[0m                          [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000000[0m[39m: fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m04[0m[39m fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000080[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x506000000100[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpy3f9v0u0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow vulnerability has been detected in the libexif library when [0m [2m                [0m
[2;36m                    [0m         [39mprocessing EXIF data. The issue occurs during the parsing of Fuji makernote data, [0m  [2m                [0m
[2;36m                    [0m         [39mwhere the code attempts to read [0m[1;36m1[0m[39m byte beyond the allocated heap buffer boundary. [0m  [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is triggered through the `exif_from_data_fuzzer` and has a [0m       [2m                [0m
[2;36m                    [0m         [39mSCARINESS score of [0m[1;36m12[0m[39m, indicating a [0m[1;36m1[0m[39m-byte-read heap-buffer-overflow.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Details[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe AddressSanitizer detected a heap-buffer-overflow error at address [0m              [2m                [0m
[2;36m                    [0m         [39m`[0m[1;36m0x50600000011f[0m[39m`, which is located [0m[1;36m7[0m[39m bytes after the end of a [0m[1;36m56[0m[39m-byte allocated [0m    [2m                [0m
[2;36m                    [0m         [39mheap region [0m[1;39m([0m[39m`[0m[1;36m0x5060000000e0[0m[39m` to `[0m[1;36m0x506000000118[0m[39m`[0m[1;39m)[0m[39m. The overflow involves a READ [0m   [2m                [0m
[2;36m                    [0m         [39moperation of [0m[1;36m1[0m[39m byte, occurring in thread T0.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis is a **heap-buffer-overflow** vulnerability, specifically a read operation [0m    [2m                [0m
[2;36m                    [0m         [39mthat accesses memory beyond the bounds of an allocated heap buffer. This type of [0m   [2m                [0m
[2;36m                    [0m         [39mvulnerability can lead to information disclosure, program crashes, or potentially [0m  [2m                [0m
[2;36m                    [0m         [39mbe exploited for more severe security impacts depending on the context.[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Call Stack Analysis[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is triggered through the following call chain:[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Point**: The fuzzer [0m[1;39m([0m[39m`LLVMFuzzerTestOneInput`[0m[1;39m)[0m[39m in [0m                       [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;36m51[0m[39m` calls `exif_data_new_from_data`[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Data Loading**: `exif_data_new_from_data` in [0m                                  [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;36m159[0m[39m` calls `exif_data_load_data`[0m                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Makernote Processing**: `exif_data_load_data` in [0m                              [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;36m1025[0m[39m` calls `exif_mnote_data_fuji_load`[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Data Extraction**: `exif_mnote_data_fuji_load` in [0m                             [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/libexif/libexif/fuji/[0m[95mexif-mnote-data-fuji.c[0m[39m:[0m[1;36m175[0m[39m` calls `exif_get_long`[0m        [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Critical Point**: `exif_get_long` in `[0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;36m167[0m[39m` [0m  [2m                [0m
[2;36m                    [0m         [39mcalls `exif_get_slong`[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Overflow Location**: The actual overflow occurs in `exif_get_slong` at [0m        [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m137:36[0m[39m`[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Deduplication Token**: [0m                                                        [2m                [0m
[2;36m                    [0m         [39m`exif_get_slong--exif_get_long--exif_mnote_data_fuji_load` indicates the unique [0m    [2m                [0m
[2;36m                    [0m         [39msignature of this vulnerability[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Memory State**: The shadow bytes around the buggy address show:[0m                [2m                [0m
[2;36m                    [0m         [39m   - The target address `[0m[1;36m0x50600000011f[0m[39m` is marked as `fa` [0m[1;39m([0m[39mheap left redzone[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m   - This confirms the read operation is accessing memory outside the allocated [0m    [2m                [0m
[2;36m                    [0m         [39mregion's valid boundary[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Allocation Context**: The [0m[1;36m56[0m[39m-byte region was allocated through a `malloc` call[0m [2m                [0m
[2;36m                    [0m         [39mchain originating from the fuzzer's test execution[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo understand this vulnerability comprehensively, the following components should [0m  [2m                [0m
[2;36m                    [0m         [39mbe examined:[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **`exif-utils.c`**: Specifically the `exif_get_slong` function at line [0m[1;36m137[0m[39m and [0m  [2m                [0m
[2;36m                    [0m         [39m`exif_get_long` function at line [0m[1;36m167[0m[39m, to understand how these functions read data [0m  [2m                [0m
[2;36m                    [0m         [39mand what boundary checks are performed[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **`exif-mnote-data-fuji.c`**: The `exif_mnote_data_fuji_load` function at line [0m  [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m, which processes Fuji-specific makernote data and determines how much data is [0m  [2m                [0m
[2;36m                    [0m         [39mpassed to the utility functions[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **`exif-data.c`**: The `exif_data_load_data` function at line [0m[1;36m1025[0m[39m and [0m          [2m                [0m
[2;36m                    [0m         [39m`exif_data_new_from_data` function at line [0m[1;36m159[0m[39m, to understand the overall data [0m     [2m                [0m
[2;36m                    [0m         [39mloading flow and size validations[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Buffer Size Calculations**: Investigate how the [0m[1;36m56[0m[39m-byte buffer size is [0m        [2m                [0m
[2;36m                    [0m         [39mdetermined and whether it correctly accounts for all data that will be read during [0m [2m                [0m
[2;36m                    [0m         [39mFuji makernote processing[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Input Validation**: Examine what validation is performed on the input data [0m    [2m                [0m
[2;36m                    [0m         [39msize and structure before attempting to parse Fuji makernote data[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Byte Order and Data Size**: Review how the code handles different byte orders [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mendianness[0m[1;39m)[0m[39m and data type sizes, as these factors are critical in the [0m             [2m                [0m
[2;36m                    [0m         [39m`exif_get_slong` and `exif_get_long` functions[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3174441528[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2731[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2731[0m[39m [0m[1;39m[[0m[1;36m0x560b9c8f86b8[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x560b9c8f9163[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2731[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2731[0m[39m [0m[1;39m[[0m[1;36m0x560b9c8f9168[0m[39m,[0m[1;36m0x560b9c903c18[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x50600000011f[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x560b9c83572b[0m[39m bp [0m[1;36m0x7fff5b159b70[0m[39m sp [0m[1;36m0x7fff5b159b68[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x50600000011f[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560b9c83572a[0m[39m in exif_get_slong [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m137:36[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560b9c83572a[0m[39m in exif_get_long [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m167:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560b9c83e237[0m[39m in exif_mnote_data_fuji_load [0m                                 [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/fuji/[0m[95mexif-mnote-data-fuji.c[0m[39m:[0m[1;92m175:11[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560b9c81af56[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1025:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560b9c81a36e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560b9c8178af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x560b9c6cc330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x560b9c6b75a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x560b9c6bd03f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x560b9c6e82e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f2a4a56b082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x560b9c6af78d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8578d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: exif_get_slong--exif_get_long--exif_mnote_data_fuji_load[0m               [2m                [0m
[2;36m                    [0m         [1;36m0x50600000011f[0m[39m is located [0m[1;36m7[0m[39m bytes after [0m[1;36m56[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5060000000e0[0m[39m,[0m[1;36m0x506000000118[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560b9c7d80ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560b9c852283[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560b9c6b75a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560b9c6bd03f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560b9c6e82e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7f2a4a56b082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m137:36[0m[39m in exif_get_slong[0m                          [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x505fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000000[0m[39m: fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m04[0m[39m fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000080[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x506000000100[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x506000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpy3f9v0u0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-utils.[0m[1;92mc:130[0m[39m-[0m[1;36m142[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m130:e[0m[39mxif_get_slong [0m[1;39m([0m[39mconst unsigned char *b, ExifByteOrder order[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!b[0m[1;39m)[0m[39m return [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        switch [0m[1;39m([0m[39morder[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        case EXIF_BYTE_ORDER_MOTOROLA:[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m << [0m[1;36m24[0m[1;39m)[0m[39m | [0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m16[0m[1;39m)[0m[39m | [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        case EXIF_BYTE_ORDER_INTEL:[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m24[0m[1;39m)[0m[39m | [0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m << [0m[1;36m16[0m[1;39m)[0m[39m | [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[35m/[0m[39m* Won't be reached *[0m[35m/[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39mreturn [0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-utils.[0m[1;92mc:164[0m[39m-[0m[1;36m168[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m164:E[0m[39mxifLong[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;92m165:e[0m[39mxif_get_long [0m[1;39m([0m[39mconst unsigned char *buf, ExifByteOrder order[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        return [0m[1;39m([0m[39mexif_get_slong [0m[1;39m([0m[39mbuf, order[0m[1;39m)[0m[39m & [0m[1;36m0xffffffff[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:153[0m[39m-[0m[1;36m180[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m154:e[0m[39mxif_mnote_data_fuji_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39mExifMnoteDataFuji *n = [0m[1;39m([0m[39mExifMnoteDataFuji*[0m[1;39m)[0m[39m en;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mExifLong c;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39mdatao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:31[0m[39m-[0m[1;36m32[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:166[0m[39m-[0m[1;36m180[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39mdatao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:33[0m[39m-[0m[1;36m34[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:217[0m[39m-[0m[1;36m226[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, n->order[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:290[0m[39m-[0m[1;36m291[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:    [0m[39m        [0m[39m        [0m[39msize_t dataofs = o + [0m[1;36m8[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m[39m dataofs = exif_get_long [0m[1;39m([0m[39mbuf + dataofs, [0m         [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m + [0m[1;36m6[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:38[0m[39m-[0m[1;36m39[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:345[0m[39m-[0m[1;36m386[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:    [0m[39mcase nikonV2:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m6[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo2,buf_size,[0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteDataOlympus"[0m[39m,[0m     [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:    [0m[39m        [0m[39m        [0m[32m"Parsing Nikon maker note v2 [0m[32m([0m[32m0x%02x, %02x, %02x, "[0m         [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:    [0m[39m        [0m[39m        [0m[32m"%02x, %02x, %02x, %02x, %02x[0m[32m)[0m[32m..."[0m[39m,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf[0m[1;39m[[0m[39mo2 + [0m[1;36m0[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m1[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m2[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m3[0m[1;39m][0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf[0m[1;39m[[0m[39mo2 + [0m[1;36m4[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m5[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m6[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m7[0m[1;39m][0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Skip version number *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Skip an unknown byte [0m[1;39m([0m[1;36m00[0m[39m or 0A[0m[1;39m)[0m[39m. *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Skip [0m[1;36m2[0m[39m unknown bytes [0m[1;39m([0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m)[0m[39m. *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m2[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:    [0m[39m        [0m[35m/[0m[39m*[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:    [0m[39m        [0m[39m * Byte order. From here the data offset[0m                            [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:    [0m[39m        [0m[39m * gets calculated.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:    [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:    [0m[39m        [0m[39mdatao = o2;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!strncmp [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m&buf[0m[1;39m[[0m[39mo2[0m[1;39m][0m[39m, [0m[32m"II"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:    [0m[39m        [0m[39melse if [0m[1;39m([0m[39m!strncmp [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m&buf[0m[1;39m[[0m[39mo2[0m[1;39m][0m[39m, [0m[32m"MM"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:    [0m[39m        [0m[39melse [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m[32m"Unknown "[0m                  [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[32m"byte order '%c%c'"[0m[39m, buf[0m[1;39m[[0m[39mo2[0m[1;39m][0m[39m,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mbuf[0m[1;39m[[0m[39mo2 + [0m[1;36m1[0m[1;39m][0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m2[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Skip [0m[1;36m2[0m[39m unknown bytes [0m[1;39m([0m[1;36m00[0m[39m 2A[0m[1;39m)[0m[39m. *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m2[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Go to where the number of entries is. *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    [0m[39m        [0m[39mo2 = datao + exif_get_long [0m[1;39m([0m[39mbuf + o2, n->order[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:51[0m[39m-[0m[1;36m52[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:791[0m[39m-[0m[1;36m840[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:[0m[1;35minterpret_maker_note[0m[1;39m([0m[39mExifData *data, const unsigned char *d, unsigned int ds[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:    [0m[39mint mnoteid;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:    [0m[39mExifEntry* e = exif_data_get_entry [0m[1;39m([0m[39mdata, EXIF_TAG_MAKER_NOTE[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!e[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_olympus_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Olympus MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_olympus_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_canon_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Canon MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_canon_new [0m[1;39m([0m[39mdata->priv->mem, [0m       [2m                [0m
[2;36m                    [0m         [39mdata->priv->options[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_fuji_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Fuji MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_fuji_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:    [0m[35m/[0m[39m* NOTE: Must do Pentax detection last because some of the[0m                  [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:    [0m[39m * heuristics are pretty general. *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_pentax_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Pentax MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_pentax_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:[0m[35m/[0m[39m* Marcus: disabled until apple makernote can also be saved[0m                     [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:    [0m[39melse if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_apple_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Apple MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_apple_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:*[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    [0m[35m/[0m[39m* [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    [0m[39m * If we are able to interpret the maker note, do so.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdata->priv->md[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_log [0m[1;39m([0m[39mdata->priv->md, data->priv->log[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_set_byte_order [0m[1;39m([0m[39mdata->priv->md,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mdata->priv->order[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_set_offset [0m[1;39m([0m[39mdata->priv->md,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m837[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m    data->priv->offset_mnote[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_load [0m[1;39m([0m[39mdata->priv->md, d, ds[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:153[0m[39m-[0m[1;36m180[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m154:e[0m[39mxif_mnote_data_fuji_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39mExifMnoteDataFuji *n = [0m[1;39m([0m[39mExifMnoteDataFuji*[0m[1;39m)[0m[39m en;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mExifLong c;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39mdatao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:340[0m[39m-[0m[1;36m345[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:int[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;92m341:e[0m[39mxif_mnote_data_fuji_identify [0m[1;39m([0m[39mconst ExifData *ed, const ExifEntry *e[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:    [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m ed;  [0m[35m/[0m[39m* unused *[0m[35m/[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:    [0m[39mreturn [0m[1;39m([0m[1;39m([0m[39me->size >= [0m[1;36m12[0m[1;39m)[0m[39m && !memcmp [0m[1;39m([0m[39me->data, [0m[32m"FUJIFILM"[0m[39m, [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:51[0m[39m-[0m[1;36m52[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:98[0m[39m-[0m[1;36m115[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39m        [0m[39m*buf_size = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[39m * Header: [0m[32m"FUJIFILM"[0m[39m and [0m[1;36m4[0m[39m bytes offset to the first entry.[0m                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[39m * As the first entry will start right thereafter, the offset is [0m[1;36m12[0m[39m.[0m        [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[39mmemcpy [0m[1;39m([0m[39m*buf, [0m[32m"FUJIFILM"[0m[39m, [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[39mexif_set_long [0m[1;39m([0m[39m*buf + [0m[1;36m8[0m[39m, n->order, [0m[1;36m12[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[35m/[0m[39m* Save the number of entries *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + [0m[1;36m8[0m[39m + [0m[1;36m4[0m[39m, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m n->count[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[35m/[0m[39m* Save each entry *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < n->count; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[39m        [0m[39mo = [0m[1;36m8[0m[39m + [0m[1;36m4[0m[39m + [0m[1;36m2[0m[39m + i * [0m[1;36m12[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[39m        [0m[39mexif_set_short [0m[1;39m([0m[39m*buf + o + [0m[1;36m0[0m[39m, n->order, [0m[1;39m([0m[39mExifShort[0m[1;39m)[0m[39m [0m                [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:228[0m[39m-[0m[1;36m233[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataPentax"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:62[0m[39m-[0m[1;36m72[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     [0m[39mExifMem *mem;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     [0m[39munsigned int ref_count;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     [0m[35m/[0m[39m* Temporarily used while loading data *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     [0m[39munsigned int offset_mnote;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     [0m[39mExifDataOption options;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mExifDataType data_type;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:228[0m[39m-[0m[1;36m238[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       [0m[32m"%02x %02x %02x...[0m[32m)[0m[32m."[0m[39m,[0m               [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       entry->data[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, entry->data[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mentry->data[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       entry->data[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m, entry->data[0m[1;39m[[0m[1;36m4[0m[1;39m][0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mentry->data[0m[1;39m[[0m[1;36m5[0m[1;39m][0m[39m,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       entry->data[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[39m        [0m[39mdata->priv->offset_mnote = doff;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[39mreturn [0m[1;36m1[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:832[0m[39m-[0m[1;36m840[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdata->priv->md[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_log [0m[1;39m([0m[39mdata->priv->md, data->priv->log[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_set_byte_order [0m[1;39m([0m[39mdata->priv->md,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mdata->priv->order[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_set_offset [0m[1;39m([0m[39mdata->priv->md,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m837[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m    data->priv->offset_mnote[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_load [0m[1;39m([0m[39mdata->priv->md, d, ds[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:217[0m[39m-[0m[1;36m226[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, n->order[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:166[0m[39m-[0m[1;36m176[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39mdatao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:250[0m[39m-[0m[1;36m256[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39mo2 = [0m[1;36m6[0m[39m + n->offset; [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo2,buf_size,[0m[1;36m10[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:345[0m[39m-[0m[1;36m386[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:    [0m[39mcase nikonV2:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m6[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo2,buf_size,[0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteDataOlympus"[0m[39m,[0m     [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:    [0m[39m        [0m[39m        [0m[32m"Parsing Nikon maker note v2 [0m[32m([0m[32m0x%02x, %02x, %02x, "[0m         [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:    [0m[39m        [0m[39m        [0m[32m"%02x, %02x, %02x, %02x, %02x[0m[32m)[0m[32m..."[0m[39m,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf[0m[1;39m[[0m[39mo2 + [0m[1;36m0[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m1[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m2[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m3[0m[1;39m][0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf[0m[1;39m[[0m[39mo2 + [0m[1;36m4[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m5[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m6[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m7[0m[1;39m][0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Skip version number *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Skip an unknown byte [0m[1;39m([0m[1;36m00[0m[39m or 0A[0m[1;39m)[0m[39m. *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Skip [0m[1;36m2[0m[39m unknown bytes [0m[1;39m([0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m)[0m[39m. *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m2[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:    [0m[39m        [0m[35m/[0m[39m*[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:    [0m[39m        [0m[39m * Byte order. From here the data offset[0m                            [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:    [0m[39m        [0m[39m * gets calculated.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:    [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:    [0m[39m        [0m[39mdatao = o2;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!strncmp [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m&buf[0m[1;39m[[0m[39mo2[0m[1;39m][0m[39m, [0m[32m"II"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:    [0m[39m        [0m[39melse if [0m[1;39m([0m[39m!strncmp [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m&buf[0m[1;39m[[0m[39mo2[0m[1;39m][0m[39m, [0m[32m"MM"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:    [0m[39m        [0m[39melse [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m[32m"Unknown "[0m                  [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[32m"byte order '%c%c'"[0m[39m, buf[0m[1;39m[[0m[39mo2[0m[1;39m][0m[39m,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mbuf[0m[1;39m[[0m[39mo2 + [0m[1;36m1[0m[1;39m][0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m2[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Skip [0m[1;36m2[0m[39m unknown bytes [0m[1;39m([0m[1;36m00[0m[39m 2A[0m[1;39m)[0m[39m. *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m2[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Go to where the number of entries is. *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    [0m[39m        [0m[39mo2 = datao + exif_get_long [0m[1;39m([0m[39mbuf + o2, n->order[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:161[0m[39m-[0m[1;36m180[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39mdatao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:228[0m[39m-[0m[1;36m260[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataPentax"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[35m/[0m[39m* Detect variant of Pentax/Casio MakerNote found *[0m[35m/[0m                        [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmemcmp[0m[1;39m([0m[39mbuf + datao, [0m[32m"AOC"[0m[39m, [0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mdatao + [0m[1;36m4[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mdatao + [0m[1;36m5[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->version = pentaxV3;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mdatao + [0m[1;36m4[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mdatao + [0m[1;36m5[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->version = pentaxV3;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Uses Casio v2 tags *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->version = pentaxV2;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteDataPentax"[0m[39m,[0m      [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    [0m[39m        [0m[39m        [0m[32m"Parsing Pentax maker note v%d..."[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mn->version[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39m        [0m[39mdatao += [0m[1;36m4[0m[39m + [0m[1;36m2[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39m        [0m[39mbase = MNOTE_PENTAX2_TAG_BASE;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m![0m[1;35mmemcmp[0m[1;39m([0m[39mbuf + datao, [0m[32m"QVC"[0m[39m, [0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteDataPentax"[0m[39m,[0m      [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39m        [0m[32m"Parsing Casio maker note v2..."[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[39mn->version = casioV2;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    [0m[39m        [0m[39mbase = MNOTE_CASIO2_TAG_BASE;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[39m        [0m[39mdatao += [0m[1;36m4[0m[39m + [0m[1;36m2[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39m        [0m[35m/[0m[39m* probably [0m[1;35massert[0m[1;39m([0m[39m![0m[1;35mmemcmp[0m[1;39m([0m[39mbuf + datao, [0m[32m"\x00\x1b"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteDataPentax"[0m[39m,[0m      [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:    [0m[39m        [0m[39m        [0m[32m"Parsing Pentax maker note v1..."[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:279[0m[39m-[0m[1;36m320[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:    [0m[39mswitch [0m[1;39m([0m[39mn->version[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    [0m[39mcase olympusV1:[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:    [0m[39mcase sanyoV1:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:    [0m[39mcase epsonV1:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteDataOlympus"[0m[39m,[0m     [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:    [0m[39m        [0m[39m        [0m[32m"Parsing Olympus/Sanyo/Epson maker note v1..."[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:    [0m[39m        [0m[35m/[0m[39m* The number of entries is at position [0m[1;36m8[0m[39m. *[0m[35m/[0m                       [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mo2 + [0m[1;36m6[0m[1;39m][0m[39m == [0m[1;36m1[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:    [0m[39m        [0m[39melse if [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mo2 + [0m[1;36m6[0m[39m + [0m[1;36m1[0m[1;39m][0m[39m == [0m[1;36m1[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m8[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[39m        [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + o2, n->order[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;39m([0m[39m![0m[1;39m([0m[39mc & [0m[1;36m0xFF[0m[1;39m)[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mc > [0m[1;36m0x500[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mn->order == EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mn->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:    [0m[39mcase olympusV2:[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Olympus S760, S770 *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:    [0m[39m        [0m[39mdatao = o2;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m8[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo2,buf_size,[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteDataOlympus"[0m[39m,[0m     [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:    [0m[39m        [0m[39m        [0m[32m"Parsing Olympus maker note v2 [0m[32m([0m[32m0x%02x, %02x, %02x, [0m        [2m                [0m
[2;36m                    [0m         [32m%02x[0m[32m)[0m[32m..."[0m[39m,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf[0m[1;39m[[0m[39mo2 + [0m[1;36m0[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m1[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m2[0m[1;39m][0m[39m, buf[0m[1;39m[[0m[39mo2 + [0m[1;36m3[0m[1;39m][0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mo2[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mo2 + [0m[1;36m1[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:    [0m[39m        [0m[39melse if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mo2[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mo2 + [0m[1;36m1[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:    [0m[39m        [0m[35m/[0m[39m* The number of entries is at position [0m[1;36m8[0m[39m+[0m[1;36m4[0m[39m. *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m4[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:    [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:    [0m[39mcase nikonV1:[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:153[0m[39m-[0m[1;36m180[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m154:e[0m[39mxif_mnote_data_fuji_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39mExifMnoteDataFuji *n = [0m[1;39m([0m[39mExifMnoteDataFuji*[0m[1;39m)[0m[39m en;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mExifLong c;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39mdatao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:204[0m[39m-[0m[1;36m266[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[35m/[0m[39m* Parse all c entries, storing ones that are successfully parsed *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteFujiEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteDataFuji"[0m[39m,[0m        [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"Loading entry 0x%x [0m[32m([0m[32m'%s'[0m[32m)[0m[32m..."[0m[39m, n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag,[0m   [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:    [0m[39m        [0m[39m        [0m[39m  mnote_fuji_tag_get_name [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Check if we overflow the multiplication. Use buf_size as the max[0m [2m                [0m
[2;36m                    [0m         [39msize for integer overflow detection,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39m        [0m[39m * we will check the buffer sizes closer later. *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m    [0m[39mexif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf_size [0m[35m/[0m[39m exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m< n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39m        [0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Tag size overflow [0m  [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u * %lu[0m[32m)[0m[32m"[0m[39m, exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m, [0m            [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[39m        [0m[35m/[0m[39m*[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[39m        [0m[39m * Size? If bigger than [0m[1;36m4[0m[39m bytes, the actual data is not[0m             [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[39m        [0m[39m * in the entry but somewhere else [0m[1;39m([0m[39moffset[0m[1;39m)[0m[39m.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[39m        [0m[39ms = exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m             [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.size = s;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39m        [0m[39m        [0m[39msize_t dataofs = o + [0m[1;36m8[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[35m/[0m[39m* The data in this case is merely a pointer *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mdataofs = exif_get_long [0m[1;39m([0m[39mbuf + dataofs, n->order[0m[1;39m)[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m + n->offset;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdataofs, buf_size, s[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m      [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Tag data [0m   [2m                [0m
[2;36m                    [0m         [32mpast end of "[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"buffer [0m[32m([0m[32m%u >= %u[0m[32m)[0m[32m"[0m[39m, [0m[1;39m([0m[39munsigned[0m[1;39m)[0m[1;39m([0m[39mdataofs +[0m [2m                [0m
[2;36m                    [0m         [39ms[0m[1;39m)[0m[39m, buf_size[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data = exif_mem_alloc [0m[1;39m([0m[39men->mem, s[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m!n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39men->log, [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39ms[0m[1;39m)[0m[39m;[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39m        [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data, buf + dataofs, s[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Tag was successfully parsed *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    [0m[39m        [0m[39m++tcount;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:    [0m[35m/[0m[39m* Store the count of successfully parsed tags *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:    [0m[39mn->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:153[0m[39m-[0m[1;36m180[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m154:e[0m[39mxif_mnote_data_fuji_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39mExifMnoteDataFuji *n = [0m[1;39m([0m[39mExifMnoteDataFuji*[0m[1;39m)[0m[39m en;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mExifLong c;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39mdatao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:228[0m[39m-[0m[1;36m233[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataPentax"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:250[0m[39m-[0m[1;36m256[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39mo2 = [0m[1;36m6[0m[39m + n->offset; [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo2,buf_size,[0m[1;36m10[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:305[0m[39m-[0m[1;36m307[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:    [0m[39m        [0m[39mo2 += [0m[1;36m8[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo2,buf_size,[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteDataOlympus"[0m[39m,[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:31[0m[39m-[0m[1;36m32[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:51[0m[39m-[0m[1;36m52[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:153[0m[39m-[0m[1;36m180[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m154:e[0m[39mxif_mnote_data_fuji_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39mExifMnoteDataFuji *n = [0m[1;39m([0m[39mExifMnoteDataFuji*[0m[1;39m)[0m[39m en;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mExifLong c;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39mdatao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:204[0m[39m-[0m[1;36m220[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[35m/[0m[39m* Parse all c entries, storing ones that are successfully parsed *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteFujiEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:153[0m[39m-[0m[1;36m180[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m154:e[0m[39mxif_mnote_data_fuji_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39mExifMnoteDataFuji *n = [0m[1;39m([0m[39mExifMnoteDataFuji*[0m[1;39m)[0m[39m en;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mExifLong c;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39mdatao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:217[0m[39m-[0m[1;36m226[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, n->order[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:228[0m[39m-[0m[1;36m233[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataPentax"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.h:[0m[1;36m31[0m[39m-[0m[1;36m39[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:struct _ExifMnoteDataFuji [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     [0m[39mExifMnoteData parent;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     [0m[39mMnoteFujiEntry *entries;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     [0m[39munsigned int count;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     [0m[39mExifByteOrder order;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     [0m[39munsigned int offset;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:157[0m[39m-[0m[1;36m159[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39mExifMnoteDataFuji *n = [0m[1;39m([0m[39mExifMnoteDataFuji*[0m[1;39m)[0m[39m en;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mExifLong c;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:153[0m[39m-[0m[1;36m184[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m154:e[0m[39mxif_mnote_data_fuji_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39mExifMnoteDataFuji *n = [0m[1;39m([0m[39mExifMnoteDataFuji*[0m[1;39m)[0m[39m en;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mExifLong c;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39mdatao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-utils.[0m[1;92mc:129[0m[39m-[0m[1;36m142[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m129:E[0m[39mxifSLong[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;92m130:e[0m[39mxif_get_slong [0m[1;39m([0m[39mconst unsigned char *b, ExifByteOrder order[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!b[0m[1;39m)[0m[39m return [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        switch [0m[1;39m([0m[39morder[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        case EXIF_BYTE_ORDER_MOTOROLA:[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m << [0m[1;36m24[0m[1;39m)[0m[39m | [0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m16[0m[1;39m)[0m[39m | [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        case EXIF_BYTE_ORDER_INTEL:[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m24[0m[1;39m)[0m[39m | [0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m << [0m[1;36m16[0m[1;39m)[0m[39m | [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[35m/[0m[39m* Won't be reached *[0m[35m/[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39mreturn [0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-utils.[0m[1;92mc:164[0m[39m-[0m[1;36m168[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m164:E[0m[39mxifLong[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;92m165:e[0m[39mxif_get_long [0m[1;39m([0m[39mconst unsigned char *buf, ExifByteOrder order[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        return [0m[1;39m([0m[39mexif_get_slong [0m[1;39m([0m[39mbuf, order[0m[1;39m)[0m[39m & [0m[1;36m0xffffffff[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-mnote-data-priv.h:[0m[1;36m60[0m[39m-[0m[1;36m65[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:struct _ExifMnoteData [0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     [0m[39mExifMnoteDataPriv *priv;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     [0m[39mExifMnoteDataMethods methods;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-mnote-data.[0m[1;92mc:29[0m[39m-[0m[1;36m32[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:struct _ExifMnoteDataPriv[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     [0m[39munsigned int ref_count;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.h:[0m[1;36m31[0m[39m-[0m[1;36m39[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:struct _ExifMnoteDataFuji [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     [0m[39mExifMnoteData parent;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     [0m[39mMnoteFujiEntry *entries;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     [0m[39munsigned int count;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     [0m[39mExifByteOrder order;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     [0m[39munsigned int offset;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:153[0m[39m-[0m[1;36m200[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m154:e[0m[39mxif_mnote_data_fuji_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39mExifMnoteDataFuji *n = [0m[1;39m([0m[39mExifMnoteDataFuji*[0m[1;39m)[0m[39m en;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mExifLong c;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39mdatao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing to much memory[0m [2m                [0m
[2;36m                    [0m         [39mor time. There are [0m[1;36m50[0m[39m named tags currently.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    [0m[39m * Fuji XT2 had [0m[1;36m56[0m[39m entries or so, GFX500 has [0m[1;36m68[0m[39m. [0m[1;36m150[0m[39m seems a safe upper [0m    [2m                [0m
[2;36m                    [0m         [39mbound currently.[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[39m * The format allows specifying the same range of memory as often as it [0m    [2m                [0m
[2;36m                    [0m         [39mcan, so this multiplies quickly. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    [0m[39mif [0m[1;39m([0m[39mc > [0m[1;36m150[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifMnoteDataFuji"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [32m"Too much tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Fuji MakerNote"[0m[39m, c[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:    [0m[35m/[0m[39m* Remove any old entries *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    [0m[39mexif_mnote_data_fuji_clear [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    [0m[39mn->entries = exif_mem_alloc [0m[1;39m([0m[39men->mem, sizeof [0m[1;39m([0m[39mMnoteFujiEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39men->log, [0m[32m"ExifMnoteDataFuji"[0m[39m, sizeof [0m            [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mMnoteFujiEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis Summary[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter extensive analysis of the code snippets and evaluation report, I have [0m        [2m                [0m
[2;36m                    [0m         [39midentified the root cause of the heap-buffer-overflow vulnerability in the libexif [0m [2m                [0m
[2;36m                    [0m         [39mlibrary's Fuji makernote parser.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability occurs in `libexif/fuji/exif-mnote-data-fuji.c` at lines [0m[1;36m166[0m[39m-[0m[1;36m175[0m[39m.[0m [2m                [0m
[2;36m                    [0m         [39mThe boundary check is performed **before** calculating the actual offset [0m[1;39m([0m[39m`datao`[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mthat will be used for memory access, which violates the established pattern used in[0m [2m                [0m
[2;36m                    [0m         [39mother makernote loaders [0m[1;39m([0m[39mPentax, Olympus, Canon[0m[1;39m)[0m[39m and within the same Fuji loader [0m   [2m                [0m
[2;36m                    [0m         [39mfunction itself.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerable Code Pattern:**[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mLine [0m[1;36m166[0m[39m: if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Check BEFORE [0m  [2m                [0m
[2;36m                    [0m         [39mcalculating datao[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mLine [0m[1;36m171[0m[39m: datao = [0m[1;36m6[0m[39m + n->offset;                                    [0m[35m/[0m[35m/[0m[39m Calculate [0m   [2m                [0m
[2;36m                    [0m         [39mactual offset[0m                                                                       [2m                [0m
[2;36m                    [0m         [39mLine [0m[1;36m175[0m[39m: datao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Read[0m [2m                [0m
[2;36m                    [0m         [39mat datao+[0m[1;36m8[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue is that while mathematically the check should be sufficient [0m[1;39m([0m[39m`n->offset +[0m [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m <= buf_size` implies `datao + [0m[1;36m12[0m[39m <= buf_size` where `datao = n->offset + [0m[1;36m6[0m[39m`[0m[1;39m)[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39mthis pattern:[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Is inconsistent with other makernote loaders in the codebase[0m                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Makes it harder to verify that the exact offset being accessed has been [0m         [2m                [0m
[2;36m                    [0m         [39mvalidated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. May have edge cases in boundary conditions[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Evidence from Codebase Patterns[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Pentax [0m[1;39m([0m[39mCORRECT pattern[0m[1;39m)[0m[39m:**[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mLine [0m[1;36m228[0m[39m: datao = [0m[1;36m6[0m[39m + n->offset;                [0m[35m/[0m[35m/[0m[39m Calculate FIRST[0m                  [2m                [0m
[2;36m                    [0m         [39mLine [0m[1;36m229[0m[39m: if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Check SECOND[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Olympus [0m[1;39m([0m[39mCORRECT pattern[0m[1;39m)[0m[39m:**[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mLine [0m[1;36m250[0m[39m: o2 = [0m[1;36m6[0m[39m + n->offset;                   [0m[35m/[0m[35m/[0m[39m Calculate FIRST[0m                  [2m                [0m
[2;36m                    [0m         [39mLine [0m[1;36m251[0m[39m: if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo2, buf_size, [0m[1;36m10[0m[1;39m)[0m[1;39m)[0m[39m return;    [0m[35m/[0m[35m/[0m[39m Check SECOND[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Within same Fuji function [0m[1;39m([0m[39mCORRECT pattern[0m[1;39m)[0m[39m:**[0m                                    [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mLine [0m[1;36m210[0m[39m: if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m break;      [0m[35m/[0m[35m/[0m[39m Check offset before [0m   [2m                [0m
[2;36m                    [0m         [39mreading [0m[1;36m12[0m[39m bytes[0m                                                                    [2m                [0m
[2;36m                    [0m         [39mLine [0m[1;36m246[0m[39m: if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdataofs, buf_size, s[0m[1;39m)[0m[1;39m)[0m[39m continue;  [0m[35m/[0m[35m/[0m[39m Check offset [0m      [2m                [0m
[2;36m                    [0m         [39mbefore copying data[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Memory Access Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAt line [0m[1;36m175[0m[39m, the code calls `[0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, [0m                        [2m                [0m
[2;36m                    [0m         [39mEXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m`, which:[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Calls `[0m[1;35mexif_get_slong[0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m`[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. In Intel byte order mode [0m[1;39m([0m[39mline [0m[1;36m137[0m[1;39m)[0m[39m, accesses: `b[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m`, `b[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m`, `b[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m`, `b[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m`[0m    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Where `b = buf + datao + [0m[1;36m8[0m[39m`, so actual accesses are: `buf[0m[1;39m[[0m[39mdatao+[0m[1;36m11[0m[1;39m][0m[39m`, [0m           [2m                [0m
[2;36m                    [0m         [39m`buf[0m[1;39m[[0m[39mdatao+[0m[1;36m10[0m[1;39m][0m[39m`, `buf[0m[1;39m[[0m[39mdatao+[0m[1;36m9[0m[1;39m][0m[39m`, `buf[0m[1;39m[[0m[39mdatao+[0m[1;36m8[0m[1;39m][0m[39m`[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFor safe access, we need `datao + [0m[1;36m11[0m[39m < buf_size`, i.e., `datao + [0m[1;36m12[0m[39m <= buf_size`.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fuji Makernote Structure[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFrom the analysis of the save function and comments:[0m                                [2m                [0m
[2;36m                    [0m         [39m- Bytes [0m[1;39m[[0m[39mdatao+[0m[1;36m0[0m[39m to datao+[0m[1;36m7[0m[1;39m][0m[39m: [0m[32m"FUJIFILM"[0m[39m signature [0m[1;39m([0m[1;36m8[0m[39m bytes[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [39m- Bytes [0m[1;39m[[0m[39mdatao+[0m[1;36m8[0m[39m to datao+[0m[1;36m11[0m[1;39m][0m[39m: Offset value [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [39m- Total: [0m[1;36m12[0m[39m bytes from `datao` must be accessible[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Patch Location[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File:** `libexif/fuji/exif-mnote-data-fuji.c`  [0m                                   [2m                [0m
[2;36m                    [0m         [39m**Lines:** [0m[1;36m166[0m[39m-[0m[1;36m175[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Detailed Patch Steps[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Move the calculation of `datao` to occur BEFORE the boundary check**[0m           [2m                [0m
[2;36m                    [0m         [39m   - This aligns with the pattern used in Pentax, Olympus, and elsewhere in the [0m    [2m                [0m
[2;36m                    [0m         [39mcodebase[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Modify the CHECKOVERFLOW check to validate `datao` directly with the correct [0m  [2m                [0m
[2;36m                    [0m         [39msize [0m[1;39m([0m[1;36m12[0m[39m bytes[0m[1;39m)[0m[39m**[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;36m12[0m[39m bytes = [0m[1;36m8[0m[39m bytes for [0m[32m"FUJIFILM"[0m[39m signature + [0m[1;36m4[0m[39m bytes for offset value[0m         [2m                [0m
[2;36m                    [0m         [39m   - This ensures we're checking the exact offset that will be used for the [0m        [2m                [0m
[2;36m                    [0m         [39m`exif_get_long` call at line [0m[1;36m175[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Keep all other logic unchanged**[0m                                               [2m                [0m
[2;36m                    [0m         [39m   - The byte order setting [0m[1;39m([0m[39mline [0m[1;36m173[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - The offset read operation [0m[1;39m([0m[39mline [0m[1;36m175[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - The subsequent validation check [0m[1;39m([0m[39mline [0m[1;36m176[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Specific Code Changes[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Remove lines [0m[1;36m166[0m[39m-[0m[1;36m171[0m[39m:**[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m    exif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                                  [2m                [0m
[2;36m                    [0m         [39m              [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m    return;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Replace with:**[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                              [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m    exif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                                  [2m                [0m
[2;36m                    [0m         [39m              [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m    return;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Keep lines [0m[1;36m173[0m[39m-[0m[1;36m180[0m[39m unchanged:**[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mdatao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [39m    exif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                                  [2m                [0m
[2;36m                    [0m         [39m              [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m    return;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Is Optimal[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Minimal Change:** Only reorders two operations [0m[1;39m([0m[39mcalculation and check[0m[1;39m)[0m[39m without[0m [2m                [0m
[2;36m                    [0m         [39mchanging any functional logic[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Consistency:** Matches the established pattern in Pentax, Olympus, Canon, and [0m [2m                [0m
[2;36m                    [0m         [39mwithin the same Fuji function[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Clarity:** Makes it immediately clear that we're validating the exact offset [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`datao`[0m[1;39m)[0m[39m used for memory access[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Safety:** Ensures the boundary check directly corresponds to the memory access[0m [2m                [0m
[2;36m                    [0m         [39mpattern[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Maintainability:** Future developers can easily verify the check is correct by[0m [2m                [0m
[2;36m                    [0m         [39mcomparing offset and size[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Preserves Existing Logic[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- The calculation `datao = [0m[1;36m6[0m[39m + n->offset` is unchanged [0m[1;39m([0m[39mjust moved earlier[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m- The boundary check still ensures [0m[1;36m12[0m[39m bytes are accessible [0m[1;39m([0m[39mequivalent to the [0m      [2m                [0m
[2;36m                    [0m         [39moriginal `[0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[39m`[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- The byte order is still set to Intel before reading[0m                               [2m                [0m
[2;36m                    [0m         [39m- The offset read operation remains identical[0m                                       [2m                [0m
[2;36m                    [0m         [39m- The subsequent validation after modifying `datao` is preserved[0m                    [2m                [0m
[2;36m                    [0m         [39m- All error logging messages remain the same[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Issue[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Direct Validation:** By checking `datao` directly with size [0m[1;36m12[0m[39m, we ensure that[0m [2m                [0m
[2;36m                    [0m         [39maccessing `buf[0m[1;39m[[0m[39mdatao+[0m[1;36m8[0m[1;39m][0m[39m` through `buf[0m[1;39m[[0m[39mdatao+[0m[1;36m11[0m[1;39m][0m[39m` is safe[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **No Edge Cases:** The check explicitly validates the exact memory region that [0m  [2m                [0m
[2;36m                    [0m         [39mwill be accessed[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Clear Semantics:** The code now reads: [0m[32m"calculate the offset, check if it's [0m   [2m                [0m
[2;36m                    [0m         [32mvalid, then use it"[0m[39m - a clear and verifiable pattern[0m                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Prevents Overflow:** The check ensures `datao + [0m[1;36m12[0m[39m <= buf_size`, preventing [0m   [2m                [0m
[2;36m                    [0m         [39mthe [0m[1;36m1[0m[39m-byte heap-buffer-overflow reported in the evaluation[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effects:** [0m[3;35mNone[0m[39m expected, as this is a reordering of existing operations [0m    [2m                [0m
[2;36m                    [0m         [39mwith equivalent mathematical properties.[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Verification:**[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- The check `[0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m12[0m[1;39m)[0m[39m` is mathematically equivalent to [0m   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mn->offset, buf_size, [0m[1;36m6[0m[39m+[0m[1;36m8[0m[39m+[0m[1;36m4[0m[1;39m)[0m[39m` when `datao = [0m[1;36m6[0m[39m + n->offset`[0m            [2m                [0m
[2;36m                    [0m         [39m- Both check if [0m[1;36m12[0m[39m bytes are accessible from `datao` [0m[1;39m([0m[39mor equivalently, [0m[1;36m18[0m[39m bytes [0m    [2m                [0m
[2;36m                    [0m         [39mfrom `n->offset`[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- The fix only makes the code structure clearer and more consistent[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**No Breaking Changes:**[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- Existing valid EXIF files will continue to work identically[0m                       [2m                [0m
[2;36m                    [0m         [39m- Invalid files will still be rejected [0m[1;39m([0m[39mpossibly at a slightly different point, but[0m [2m                [0m
[2;36m                    [0m         [39mwith the same result[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- The API and external behavior remain unchanged[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix directly follows the pattern established in:[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Pentax loader** [0m[1;39m([0m[39m`libexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:228[0m[39m-[0m[1;36m233[0m[39m`[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Olympus loader** [0m[1;39m([0m[39m`libexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:250[0m[39m-[0m[1;36m256[0m[39m`[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Within Fuji loader** [0m[1;39m([0m[39mlines [0m[1;36m210[0m[39m, [0m[1;36m246[0m[39m of the same function[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAll these implementations calculate the offset first, then validate it before use, [0m [2m                [0m
[2;36m                    [0m         [39mwhich is the industry-standard practice for preventing buffer overflows.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Conclusion[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix strategy addresses the heap-buffer-overflow vulnerability by restructuring[0m [2m                [0m
[2;36m                    [0m         [39mthe boundary check to follow the established pattern in the libexif codebase. The [0m  [2m                [0m
[2;36m                    [0m         [39mchange is minimal, safe, and maintains all existing functionality while preventing [0m [2m                [0m
[2;36m                    [0m         [39mthe reported security issue. The fix makes the code more maintainable and [0m          [2m                [0m
[2;36m                    [0m         [39mconsistent with the rest of the makernote loader implementations.[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=916641;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=851473;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=318531;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=600699;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpe6ewiolt[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/libexif_ex-delta-02_exif-001/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768271841.7137473[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/libexif_ex-delta-02_exif-[1;36m001.[0mtoml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-libexif[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/13/26 02:37:23][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mlibexif[0m        ]8;id=999593;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=429956;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=900793;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=281919;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mlibexif[0m               [2m               [0m
[2;36m[01/13/26 02:37:24][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=597194;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=310807;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m                [2m               [0m
