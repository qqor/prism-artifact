--- a/epan/dissectors/packet-aim.c
+++ b/epan/dissectors/packet-aim.c
@@ -581,14 +581,19 @@
 static int
 aim_get_buddyname(wmem_allocator_t *pool, uint8_t **name, tvbuff_t *tvb, int offset)
 {
-	uint16_t buddyname_length;
-
-	*name = wmem_alloc(pool, 256);
-
-	buddyname_length = tvb_get_ntohs(tvb, offset);
-
-	if (pool)
-		memcpy(*name, tvb_get_ptr(tvb,offset,1), buddyname_length);
+	uint8_t buddyname_length;
+
+	buddyname_length = tvb_get_uint8(tvb, offset);
+
+	if (buddyname_length > 255) {
+		buddyname_length = 255;
+	}
+
+	if (pool && buddyname_length > 0) {
+		*name = tvb_get_string_enc(pool, tvb, offset+1, buddyname_length, ENC_UTF_8|ENC_NA);
+	} else {
+		*name = (uint8_t *)wmem_strdup(pool, "");
+	}
 
 	return buddyname_length;
 }
