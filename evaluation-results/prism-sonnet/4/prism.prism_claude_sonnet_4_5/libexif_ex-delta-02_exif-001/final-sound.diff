--- a/libexif/fuji/exif-mnote-data-fuji.c
+++ b/libexif/fuji/exif-mnote-data-fuji.c
@@ -172,7 +172,30 @@
 
 	n->order = EXIF_BYTE_ORDER_INTEL;
 
-	datao += exif_get_long (buf + datao + 8, EXIF_BYTE_ORDER_INTEL);
+	if (CHECKOVERFLOW(datao + 8, buf_size, 4)) {
+		exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
+			  "ExifMnoteDataFuji", "Short MakerNote header");
+		return;
+	}
+
+	ExifLong offset_to_entries = exif_get_long (buf + datao + 8, EXIF_BYTE_ORDER_INTEL);
+
+	if (offset_to_entries > buf_size) {
+		exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
+			  "ExifMnoteDataFuji", "Invalid entry offset in MakerNote (%u > %u)", 
+			  offset_to_entries, buf_size);
+		return;
+	}
+
+	if (datao > buf_size - offset_to_entries) {
+		exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
+			  "ExifMnoteDataFuji", "Entry offset out of bounds (%u + %u > %u)",
+			  (unsigned int)datao, offset_to_entries, buf_size);
+		return;
+	}
+
+	datao += offset_to_entries;
+
 	if (CHECKOVERFLOW(datao, buf_size, 2)) {
 		exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
 			  "ExifMnoteDataFuji", "Short MakerNote");
@@ -239,9 +262,24 @@
 		n->entries[tcount].size = s;
 		if (s) {
 			size_t dataofs = o + 8;
-			if (s > 4)
-				/* The data in this case is merely a pointer */
-				dataofs = exif_get_long (buf + dataofs, n->order) + 6 + n->offset;
+			if (s > 4) {
+				ExifLong data_offset = exif_get_long (buf + dataofs, n->order);
+
+				if (data_offset > buf_size) {
+					exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
+							  "ExifMnoteDataFuji", "Invalid data offset in entry");
+					continue;
+				}
+
+				size_t base_offset = 6 + n->offset;
+				if (base_offset > buf_size || data_offset > buf_size - base_offset) {
+					exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
+							  "ExifMnoteDataFuji", "Data offset out of bounds");
+					continue;
+				}
+
+				dataofs = data_offset + base_offset;
+			}
 
 			if (CHECKOVERFLOW(dataofs, buf_size, s)) {
 				exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
