--- a/libfreerdp/codec/rfx.c
+++ b/libfreerdp/codec/rfx.c
@@ -671,13 +671,6 @@
 	Stream_Read_UINT32(
 	    s, frameIdx); /* frameIdx (4 bytes), if codec is in video mode, must be ignored */
 	Stream_Read_UINT16(s, numRegions); /* numRegions (2 bytes) */
-	if (Stream_GetRemainingLength(s) >= 8)
-	{
-	        UINT64 blockOffset = 0;
-	        Stream_Read_UINT64(s, blockOffset);
-	        Stream_Read_UINT64(s, metadataData);
-	        metadataBlock += blockOffset;
-	}
 	WLog_Print(context->priv->log, WLOG_DEBUG,
 	           "RFX_FRAME_BEGIN: frameIdx: %" PRIu32 " numRegions: %" PRIu16 "", frameIdx,
 	           numRegions);
@@ -1316,11 +1309,6 @@
 				                                 &context->expectedDataBlockType);
 				break;
 
-			case WBT_METADATA:
-				ok = rfx_process_message_metadata(context, message, subStream,
-				                                 &context->expectedDataBlockType);
-				break;
-
 			case WBT_FRAME_END:
 				ok = rfx_process_message_frame_end(context, message, subStream,
 				                                   &context->expectedDataBlockType);

--- a/libfreerdp/codec/rfx_constants.h
+++ b/libfreerdp/codec/rfx_constants.h
@@ -35,7 +35,7 @@
 #define WBT_FRAME_END 0xCCC5
 #define WBT_REGION 0xCCC6
 #define WBT_EXTENSION 0xCCC7
-#define WBT_METADATA 0xCCC8
+/* #define WBT_METADATA 0xCCC8 */ /* Removed - was part of malicious code injection */
 #define CBT_REGION 0xCAC1
 #define CBT_TILESET 0xCAC2
 #define CBT_TILE 0xCAC3
