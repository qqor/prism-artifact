{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-delta-03_vuln_003",
  "source_directory": "/home/user/crete/.cache/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 2.9933670000000006,
    "prompt_tokens": 858549,
    "completion_tokens": 27848
  },
  "variant": "sound",
  "diff": "--- a/libfreerdp/codec/rfx.c\n+++ b/libfreerdp/codec/rfx.c\n@@ -671,13 +671,6 @@\n \tStream_Read_UINT32(\n \t    s, frameIdx); /* frameIdx (4 bytes), if codec is in video mode, must be ignored */\n \tStream_Read_UINT16(s, numRegions); /* numRegions (2 bytes) */\n-\tif (Stream_GetRemainingLength(s) >= 8)\n-\t{\n-\t        UINT64 blockOffset = 0;\n-\t        Stream_Read_UINT64(s, blockOffset);\n-\t        Stream_Read_UINT64(s, metadataData);\n-\t        metadataBlock += blockOffset;\n-\t}\n \tWLog_Print(context->priv->log, WLOG_DEBUG,\n \t           \"RFX_FRAME_BEGIN: frameIdx: %\" PRIu32 \" numRegions: %\" PRIu16 \"\", frameIdx,\n \t           numRegions);\n@@ -1316,11 +1309,6 @@\n \t\t\t\t                                 &context->expectedDataBlockType);\n \t\t\t\tbreak;\n \n-\t\t\tcase WBT_METADATA:\n-\t\t\t\tok = rfx_process_message_metadata(context, message, subStream,\n-\t\t\t\t                                 &context->expectedDataBlockType);\n-\t\t\t\tbreak;\n-\n \t\t\tcase WBT_FRAME_END:\n \t\t\t\tok = rfx_process_message_frame_end(context, message, subStream,\n \t\t\t\t                                   &context->expectedDataBlockType);\n\n--- a/libfreerdp/codec/rfx_constants.h\n+++ b/libfreerdp/codec/rfx_constants.h\n@@ -35,7 +35,7 @@\n #define WBT_FRAME_END 0xCCC5\n #define WBT_REGION 0xCCC6\n #define WBT_EXTENSION 0xCCC7\n-#define WBT_METADATA 0xCCC8\n+/* #define WBT_METADATA 0xCCC8 */ /* Removed - was part of malicious code injection */\n #define CBT_REGION 0xCAC1\n #define CBT_TILESET 0xCAC2\n #define CBT_TILE 0xCAC3\n",
  "stdout": "",
  "stderr": ""
}