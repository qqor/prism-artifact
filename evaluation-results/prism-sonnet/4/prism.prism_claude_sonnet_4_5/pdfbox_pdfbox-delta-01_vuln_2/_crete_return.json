{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-delta-01_vuln_2",
  "source_directory": "/home/user/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 1.6532609999999999,
    "prompt_tokens": 486167,
    "completion_tokens": 12984
  },
  "variant": "sound",
  "diff": "--- a/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java\n+++ b/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java\n@@ -155,14 +155,8 @@\n     }\n \n     private String runTesseract(Path image) throws IOException {\n-        String actualTessPath = pdDocument.getDocumentInformation()\n-                .getCustomMetadataValue(TESSERACT_PATH_KEY);\n-        if (actualTessPath == null || actualTessPath.isEmpty()) {\n-            actualTessPath = tesseractPath;\n-        }\n-\n         Path txt = Paths.get(image.toAbsolutePath().toString());\n-        doOCR(actualTessPath, image, txt);\n+        doOCR(tesseractPath, image, txt);\n         return extractContent(txt);\n     }\n \n@@ -177,6 +171,11 @@\n \n     private void doOCR(String actualTesseractPath, Path input, Path output)\n             throws IOException {\n+\n+        Path tesseractExecutable = Paths.get(actualTesseractPath);\n+        if (!Files.isExecutable(tesseractExecutable)) {\n+            throw new IOException(\"Tesseract executable not found or not executable: \" + actualTesseractPath);\n+        }\n \n         ArrayList<String> cmd = new ArrayList<>(\n                 Arrays.asList(actualTesseractPath, input.toAbsolutePath().toString(),\n",
  "stdout": "",
  "stderr": ""
}