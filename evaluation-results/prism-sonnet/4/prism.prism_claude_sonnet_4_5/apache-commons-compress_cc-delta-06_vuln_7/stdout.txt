[2;36m[01/11/26 12:35:46][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=907588;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=875041;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmphjsyq8jd[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-de[0m [2m               [0m
[2;36m                    [0m         [35mlta-06_vuln_7/[0m[95magent-output-1768134946.4683917[0m                                        [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-commons-compress_cc-delta-06_vuln_7.toml     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN        ]8;id=575942;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=786800;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m[01/11/26 12:37:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN       ]8;id=16352;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=990432;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m76.25[0m seconds; [33mexception[0m=[3;91mFalse[0m                              [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for     ]8;id=630423;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=957029;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Started[33m...[0m                                                  [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for    ]8;id=560846;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=934196;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                         [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=68831;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=886600;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m76[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=342497;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=947756;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:37:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.83[0m        ]8;id=68835;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=211209;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/11/26 12:37:04][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=419925;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=694426;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=11587;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=420589;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=572878;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=474155;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=473462;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=876251;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:37:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m1.03[0m        ]8;id=25695;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=124169;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/11/26 12:37:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=651845;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=442087;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:37:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.88[0m        ]8;id=613928;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=382049;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/11/26 12:37:12][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=1117;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=310345;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp9454191103484925524/output/q/r/[0m[95mjazzer-traversal[0m                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:460[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:400[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:324[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a87e9aa6b0374484                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp9454191103484925524/output/q/r/[0m[95mjazzer-traversal[0m                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:460[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:400[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:324[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a87e9aa6b0374484                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/11/26 12:37:32][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=201429;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=246760;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/11/26 12:42:02][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=267231;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=645777;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/11/26 12:42:33][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=162476;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=919362;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=186201;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=395965;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:42:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.97[0m        ]8;id=821129;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=172625;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/11/26 12:42:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Started[33m...[0m             ]8;id=595898;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=138335;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmprrx5dbs9[0m                                                 ]8;id=37323;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=903649;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/11/26 12:43:10][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Took [1;36m35.68[0m seconds;   ]8;id=721490;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=674050;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Started[33m...[0m       ]8;id=140131;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=257744;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:43:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Took [1;36m20.43[0m      ]8;id=927441;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=739724;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Started[33m...[0m          ]8;id=970909;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=305721;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:43:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Took [1;36m5.32[0m seconds; ]8;id=680771;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=827868;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Started[33m...[0m              ]8;id=230973;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=872464;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Took [1;36m0.00[0m seconds;     ]8;id=206304;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=733366;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=612616;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=422288;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:43:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.90[0m        ]8;id=322496;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=948886;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=860762;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=723036;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:43:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.91[0m        ]8;id=932606;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=138162;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/11/26 12:43:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=807459;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=467530;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:43:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.86[0m        ]8;id=15910;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=48362;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=900768;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=433694;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.java  [2m                [0m
[2;36m                    [0m         +++ b/src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.java  [2m                [0m
[2;36m                    [0m         @@ [1;36m-1484[0m,[1;36m11[0m +[1;36m1484[0m,[1;36m12[0m @@                                                             [2m                [0m
[2;36m                    [0m              @Override                                                                      [2m                [0m
[2;36m                    [0m              public Path [1;35mresolveIn[0m[1m([0mfinal Path parentPath[1m)[0m throws IOException [1m{[0m              [2m                [0m
[2;36m                    [0m                  final String name = [1;35mgetName[0m[1m([0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         -        final Path outputFile = [1;35mparentPath.resolve[0m[1m([0mname[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +        final String normalizedName = [1;35mNormalizer.normalize[0m[1m([0mname,                   [2m                [0m
[2;36m                    [0m         Normalizer.Form.NFKD[1m)[0m;                                                              [2m                [0m
[2;36m                    [0m         +        final Path outputFile = [1;35mparentPath.resolve[0m[1m([0mnormalizedName[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;    [2m                [0m
[2;36m                    [0m                  if [1m([0m![1;35moutputFile.startsWith[0m[1m([0mparentPath[1m)[0m[1m)[0m [1m{[0m                                  [2m                [0m
[2;36m                    [0m                      throw new [1;35mIOException[0m[1m([0m[1;35mString.format[0m[1m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m,    [2m                [0m
[2;36m                    [0m         parentPath, name, outputFile[1m)[0m[1m)[0m;                                                     [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         -        return [1;35mparentPath.resolve[0m[1m([0m[1;35mNormalizer.normalize[0m[1m([0mname,                       [2m                [0m
[2;36m                    [0m         Normalizer.Form.NFKD[1m)[0m[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;                                                 [2m                [0m
[2;36m                    [0m         +        return outputFile;                                                         [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp9454191103484925524/output/q/r/[0m[95mjazzer-traversal[0m                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:460[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:400[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:324[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a87e9aa6b0374484                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A critical file path traversal vulnerability has been detected in the Apache        [2m                [0m
[2;36m                    [0m         Commons Compress library's `Expander` class. The fuzzer identified that the         [2m                [0m
[2;36m                    [0m         application attempts to access a file path                                          [2m                [0m
[2;36m                    [0m         [1m([0m`[35m/tmp/expander-tmp9454191103484925524/output/q/r/[0m[95mjazzer-traversal[0m`[1m)[0m that appears   [2m                [0m
[2;36m                    [0m         to be outside the intended directory scope, triggering a security exception during  [2m                [0m
[2;36m                    [0m         archive expansion operations.                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Issue Overview                                                                  [2m                [0m
[2;36m                    [0m         The issue manifests as a `FuzzerSecurityIssueCritical` exception thrown by the      [2m                [0m
[2;36m                    [0m         Jazzer fuzzing framework's security sanitizer. The exception specifically           [2m                [0m
[2;36m                    [0m         identifies a [32m"File path traversal"[0m vulnerability, which is a critical security flaw [2m                [0m
[2;36m                    [0m         that allows access to files and directories outside of the intended restricted      [2m                [0m
[2;36m                    [0m         directory.                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Vulnerability Type                                                              [2m                [0m
[2;36m                    [0m         This is a **Path Traversal vulnerability** [1m([0malso known as Directory Traversal[1m)[0m,     [2m                [0m
[2;36m                    [0m         classified as a critical security issue. Path traversal vulnerabilities occur when  [2m                [0m
[2;36m                    [0m         an application uses user-supplied input to construct file paths without proper      [2m                [0m
[2;36m                    [0m         validation or sanitization, potentially allowing attackers to access files outside  [2m                [0m
[2;36m                    [0m         the intended directory structure.                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Stack Trace Analysis                                                            [2m                [0m
[2;36m                    [0m         The vulnerability is triggered through the following call chain:                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **Entry Point**: `[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0m[1m)[0m` - The fuzzer harness that [2m                [0m
[2;36m                    [0m         feeds test input to the system                                                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **Expansion Chain**: Multiple calls to `[1;35mExpander.expand[0m[1m([0m[1m)[0m` methods at different  [2m                [0m
[2;36m                    [0m         levels [1m([0mlines [1;36m204[0m, [1;36m324[0m, [1;36m400[0m, [1;36m460[0m[1m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Vulnerable Point**: `[1;35mExpander.expand[0m[1m([0m[1m)[0m` at line [1;36m86[0m, where path validation      [2m                [0m
[2;36m                    [0m         occurs                                                                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **Detection**: Jazzer's `FilePathTraversal` sanitizer hooks detect the violation [2m                [0m
[2;36m                    [0m         through:                                                                            [2m                [0m
[2;36m                    [0m            - `[1;35mpathFirstArgHook[0m[1m([0m[1m)[0m` - Intercepts path-related operations                      [2m                [0m
[2;36m                    [0m            - `[1;35mcheckPath[0m[1m([0m[1m)[0m` - Validates the path                                             [2m                [0m
[2;36m                    [0m            - `[1;35mcheck[0m[1m([0m[1m)[0m` - Performs the final security assessment                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Key Observations                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **Problematic Path**: The detected path                                          [2m                [0m
[2;36m                    [0m         `[35m/tmp/expander-tmp9454191103484925524/output/q/r/[0m[95mjazzer-traversal[0m` suggests that:   [2m                [0m
[2;36m                    [0m            - A temporary directory is being used for extraction [1m([0m`expander-tmp[33m...[0m`[1m)[0m         [2m                [0m
[2;36m                    [0m            - The path contains subdirectories [1m([0m`q/r/`[1m)[0m                                      [2m                [0m
[2;36m                    [0m            - The final component `jazzer-traversal` appears to be a test marker from the    [2m                [0m
[2;36m                    [0m         fuzzer                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **Multiple Expansion Layers**: The stack trace shows five consecutive calls to   [2m                [0m
[2;36m                    [0m         `[1;35mExpander.expand[0m[1m([0m[1m)[0m` at different line numbers, indicating recursive or nested       [2m                [0m
[2;36m                    [0m         archive processing, which is a common scenario for path traversal vulnerabilities   [2m                [0m
[2;36m                    [0m         in archive extraction utilities.                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Security Hook Activation**: The Jazzer sanitizer successfully intercepted the  [2m                [0m
[2;36m                    [0m         operation before it could complete, demonstrating that the path                     [2m                [0m
[2;36m                    [0m         validation/sanitization is either missing or occurs too late in the process.        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Areas Requiring Investigation                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         To obtain a comprehensive understanding of this vulnerability, the following        [2m                [0m
[2;36m                    [0m         components should be examined:                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **Expander.java Core Logic**:                                                    [2m                [0m
[2;36m                    [0m            - Line [1;36m86[0m: The specific expand operation where the path is used                  [2m                [0m
[2;36m                    [0m            - Lines [1;36m204[0m, [1;36m324[0m, [1;36m400[0m, [1;36m460[0m: All intermediate expand methods to understand the    [2m                [0m
[2;36m                    [0m         call flow                                                                           [2m                [0m
[2;36m                    [0m            - Path construction and normalization logic                                      [2m                [0m
[2;36m                    [0m            - Input validation mechanisms for archive entries                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **Archive Entry Processing**:                                                    [2m                [0m
[2;36m                    [0m            - How archive entry names are extracted and processed                            [2m                [0m
[2;36m                    [0m            - Whether relative paths [1m([0me.g., `..[35m/[0m`, `..[35m/../[0m`[1m)[0m in archive entries are handled  [2m                [0m
[2;36m                    [0m            - How symbolic links within archives are processed                               [2m                [0m
[2;36m                    [0m            - Treatment of absolute paths in archive entries                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Output Directory Management**:                                                 [2m                [0m
[2;36m                    [0m            - How the temporary output directory is created and secured                      [2m                [0m
[2;36m                    [0m            - Validation logic for ensuring extracted files remain within the intended       [2m                [0m
[2;36m                    [0m         directory                                                                           [2m                [0m
[2;36m                    [0m            - Canonicalization of paths before file operations                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **Security Controls**:                                                           [2m                [0m
[2;36m                    [0m            - Current path sanitization mechanisms, if any                                   [2m                [0m
[2;36m                    [0m            - Validation of entry names before extraction                                    [2m                [0m
[2;36m                    [0m            - Checks for malicious path patterns [1m([0me.g., path separators, parent directory    [2m                [0m
[2;36m                    [0m         references[1m)[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m. **Integration Points**:                                                          [2m                [0m
[2;36m                    [0m            - How the Expander class interacts with the underlying archive format            [2m                [0m
[2;36m                    [0m         implementations                                                                     [2m                [0m
[2;36m                    [0m            - Whether different archive formats [1m([0mZIP, TAR, etc.[1m)[0m have consistent security    [2m                [0m
[2;36m                    [0m         controls                                                                            [2m                [0m
[2;36m                    [0m            - File system operation wrappers and their security checks                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp9454191103484925524/output/q/r/[0m[95mjazzer-traversal[0m                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:86[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:460[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:400[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:324[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:204[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mExpanderFuzzer.jav[0m[1;92ma:52[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: a87e9aa6b0374484[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:19[0m[39m-[0m[1;36m46[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.examples;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.channels.Channels;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.commons.compress.archivers.ArchiveException;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.commons.compress.archivers.ArchiveInputStream;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.commons.compress.archivers.ArchiveStreamFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZFile;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.tar.TarArchiveEntry;[0m                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.archivers.tar.TarFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.archivers.zip.ZipArchiveEntry;[0m                [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.compress.archivers.zip.ZipFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.commons.io.output.NullOutputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:67[0m[39m-[0m[1;36m93[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:1[0m[39m-[0m[1;36m84[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * An entry of an archive.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public interface ArchiveEntry [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     * Special value [0m[1;39m([0m[1;39m{[0m[39m@value[0m[1;39m}[0m[1;39m)[0m[39m indicating that the size is unknown.[0m             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    long SIZE_UNKNOWN = [0m[1;36m-1[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * Gets the last modified date of this entry.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @return the last modified date of this entry.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * @since [0m[1;36m1.1[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    Date [0m[1;35mgetLastModifiedDate[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Gets the name of the entry in this archive. May refer to a file or [0m       [2m                [0m
[2;36m                    [0m         [39mdirectory or other item.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * This method returns the raw name as it is stored inside of the archive.[0m   [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @return The name of this entry in the archive.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * Gets the uncompressed size of this entry. May be [0m[1;36m-1[0m[39m [0m[1;39m([0m[39mSIZE_UNKNOWN[0m[1;39m)[0m[39m if the[0m [2m                [0m
[2;36m                    [0m         [39msize is unknown[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * @return the uncompressed size of this entry.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    long [0m[1;35mgetSize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * Tests whether this entry refers to a directory [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * @return true if this entry refers to a directory.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    boolean [0m[1;35misDirectory[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Resolves this entry in the given parent Path.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return a resolved and normalized Path.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:1[0m[39m-[0m[1;36m53[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.examples;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static org.junit.jupiter.api.Assertions.assertArrayEquals;[0m                [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import static org.junit.jupiter.api.Assertions.assertEquals;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import static org.junit.jupiter.api.Assertions.assertFalse;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import static org.junit.jupiter.api.Assertions.assertThrows;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import static org.junit.jupiter.api.Assertions.assertTrue;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import static org.junit.jupiter.api.Assumptions.assumeFalse;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import static org.junit.jupiter.api.Assumptions.assumeTrue;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.AbstractTest;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.compress.archivers.ArchiveException;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.commons.compress.archivers.ArchiveOutputStream;[0m                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.commons.compress.archivers.ArchiveStreamFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.commons.compress.archivers.StreamingNotSupportedException;[0m     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZFile;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZOutputFile;[0m            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.commons.compress.archivers.tar.TarFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.commons.compress.archivers.zip.ZipFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.junit.jupiter.api.Test;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.junit.jupiter.api.io.TempDir;[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:178[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m215[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    void [0m[1;35mtestCompress603Tar[0m[1;39m([0m[1;39m)[0m[39m throws IOException, ArchiveException [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:        [0m[1;35msetupTarForCompress603[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        try [0m[1;39m([0m[39mTarFile f = new [0m[1;35mTarFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, tempResultDir[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        [0m[1;35mverifyTargetDir[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, ArchiveException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../foo"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPathWithSimilarSibling[0m[1;39m([0m[1;39m)[0m[39m throws [0m            [2m                [0m
[2;36m                    [0m         [39mIOException, ArchiveException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        final String sibling = [0m[1;35mtempResultDir.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"x"[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        final File s = new [0m[1;35mFile[0m[1;39m([0m[1;35mtempResultDir.getParentFile[0m[1;39m([0m[1;39m)[0m[39m, sibling[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[1;35massumeFalse[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;35ms.mkdirs[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        [0m[1;35massumeTrue[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../"[0m[39m + sibling + [0m[32m"/a"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    void [0m[1;35mtestFileCantEscapeViaAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, [0m               [2m                [0m
[2;36m                    [0m         [39mArchiveException [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"/tmp/foo"[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        [0m[1;35massertFalse[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mtempResultDir, [0m[32m"tmp/foo"[0m[1;39m)[0m[1;35m.isFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:21[0m[39m-[0m[1;36m44[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.LinkOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.file.attribute.FileTime;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.text.Normalizer;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.NoSuchElementException;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.function.Function;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.archivers.EntryStreamOffsets;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.utils.ByteUtils;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.io.file.attribute.FileTimes;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.lang3.ArrayUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:1476[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m492[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1476[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:     * Resolves this entry in the given parent Path.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m              [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:     * @return a resolved and Unicode normalized Path.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:    @Override[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:    public Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> [0m      [2m                [0m
[2;36m                    [0m         [32m'%s'"[0m[39m, parentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:        return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mNormalizer.normalize[0m[1;39m([0m[39mname, [0m                  [2m                [0m
[2;36m                    [0m         [39mNormalizer.Form.NFKD[0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:21[0m[39m-[0m[1;36m44[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.LinkOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.file.attribute.FileTime;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.text.Normalizer;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.NoSuchElementException;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.function.Function;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.archivers.EntryStreamOffsets;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.utils.ByteUtils;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.io.file.attribute.FileTimes;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.lang3.ArrayUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:1476[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m492[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1476[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:     * Resolves this entry in the given parent Path.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m              [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:     * @return a resolved and Unicode normalized Path.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:    @Override[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:    public Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> [0m      [2m                [0m
[2;36m                    [0m         [32m'%s'"[0m[39m, parentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:        return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mNormalizer.normalize[0m[1;39m([0m[39mname, [0m                  [2m                [0m
[2;36m                    [0m         [39mNormalizer.Form.NFKD[0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:67[0m[39m-[0m[1;36m82[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Resolves this entry in the given parent Path.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return a resolved and normalized Path.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:1484[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m492[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:    @Override[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:    public Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> [0m      [2m                [0m
[2;36m                    [0m         [32m'%s'"[0m[39m, parentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:        return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mNormalizer.normalize[0m[1;39m([0m[39mname, [0m                  [2m                [0m
[2;36m                    [0m         [39mNormalizer.Form.NFKD[0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:67[0m[39m-[0m[1;36m93[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:291[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m300[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    public void [0m[1;35mtestUnicodeNormalization[0m[1;39m([0m[39m@TempDir Path tmp[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        Path input =[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mExpanderTest.class.getResource[0m[1;39m([0m[32m"/testUnicodeNormalization.zip"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39minput, tmp[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        File[0m[1;39m[[0m[1;39m][0m[39m files = [0m[1;35mtmp.toFile[0m[1;39m([0m[1;39m)[0m[1;35m.listFiles[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m1[0m[39m, files.length[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[39mfiles[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;35m.startsWith[0m[1;39m([0m[32m"\u0041"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:67[0m[39m-[0m[1;36m93[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:67[0m[39m-[0m[1;36m82[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Resolves this entry in the given parent Path.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return a resolved and normalized Path.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:1476[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m492[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1476[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:     * Resolves this entry in the given parent Path.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m              [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:     * @return a resolved and Unicode normalized Path.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:    @Override[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:    public Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> [0m      [2m                [0m
[2;36m                    [0m         [32m'%s'"[0m[39m, parentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:        return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mNormalizer.normalize[0m[1;39m([0m[39mname, [0m                  [2m                [0m
[2;36m                    [0m         [39mNormalizer.Form.NFKD[0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:21[0m[39m-[0m[1;36m44[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.LinkOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.file.attribute.FileTime;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.text.Normalizer;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.NoSuchElementException;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.function.Function;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.archivers.EntryStreamOffsets;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.utils.ByteUtils;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.io.file.attribute.FileTimes;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.lang3.ArrayUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:1476[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m492[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1476[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:     * Resolves this entry in the given parent Path.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m              [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:     * @return a resolved and Unicode normalized Path.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:    @Override[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:    public Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> [0m      [2m                [0m
[2;36m                    [0m         [32m'%s'"[0m[39m, parentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:        return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mNormalizer.normalize[0m[1;39m([0m[39mname, [0m                  [2m                [0m
[2;36m                    [0m         [39mNormalizer.Form.NFKD[0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:67[0m[39m-[0m[1;36m82[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Resolves this entry in the given parent Path.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return a resolved and normalized Path.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:1484[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m492[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:    @Override[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:    public Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> [0m      [2m                [0m
[2;36m                    [0m         [32m'%s'"[0m[39m, parentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:        return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mNormalizer.normalize[0m[1;39m([0m[39mname, [0m                  [2m                [0m
[2;36m                    [0m         [39mNormalizer.Form.NFKD[0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:67[0m[39m-[0m[1;36m93[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:188[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m215[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, ArchiveException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../foo"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPathWithSimilarSibling[0m[1;39m([0m[1;39m)[0m[39m throws [0m            [2m                [0m
[2;36m                    [0m         [39mIOException, ArchiveException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        final String sibling = [0m[1;35mtempResultDir.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"x"[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        final File s = new [0m[1;35mFile[0m[1;39m([0m[1;35mtempResultDir.getParentFile[0m[1;39m([0m[1;39m)[0m[39m, sibling[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[1;35massumeFalse[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;35ms.mkdirs[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        [0m[1;35massumeTrue[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../"[0m[39m + sibling + [0m[32m"/a"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    void [0m[1;35mtestFileCantEscapeViaAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, [0m               [2m                [0m
[2;36m                    [0m         [39mArchiveException [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"/tmp/foo"[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        [0m[1;35massertFalse[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mtempResultDir, [0m[32m"tmp/foo"[0m[1;39m)[0m[1;35m.isFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:291[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m299[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    public void [0m[1;35mtestUnicodeNormalization[0m[1;39m([0m[39m@TempDir Path tmp[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        Path input =[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mExpanderTest.class.getResource[0m[1;39m([0m[32m"/testUnicodeNormalization.zip"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39minput, tmp[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        File[0m[1;39m[[0m[1;39m][0m[39m files = [0m[1;35mtmp.toFile[0m[1;39m([0m[1;39m)[0m[1;35m.listFiles[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m1[0m[39m, files.length[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[39mfiles[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;35m.startsWith[0m[1;39m([0m[32m"\u0041"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:1484[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m492[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:    @Override[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:    public Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> [0m      [2m                [0m
[2;36m                    [0m         [32m'%s'"[0m[39m, parentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:        return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mNormalizer.normalize[0m[1;39m([0m[39mname, [0m                  [2m                [0m
[2;36m                    [0m         [39mNormalizer.Form.NFKD[0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:67[0m[39m-[0m[1;36m82[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Resolves this entry in the given parent Path.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return a resolved and normalized Path.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:1484[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m492[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:    @Override[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:    public Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> [0m      [2m                [0m
[2;36m                    [0m         [32m'%s'"[0m[39m, parentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:        return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mNormalizer.normalize[0m[1;39m([0m[39mname, [0m                  [2m                [0m
[2;36m                    [0m         [39mNormalizer.Form.NFKD[0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:67[0m[39m-[0m[1;36m93[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:1484[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m492[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:    @Override[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:    public Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> [0m      [2m                [0m
[2;36m                    [0m         [32m'%s'"[0m[39m, parentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:        return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mNormalizer.normalize[0m[1;39m([0m[39mname, [0m                  [2m                [0m
[2;36m                    [0m         [39mNormalizer.Form.NFKD[0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:188[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m215[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, ArchiveException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../foo"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPathWithSimilarSibling[0m[1;39m([0m[1;39m)[0m[39m throws [0m            [2m                [0m
[2;36m                    [0m         [39mIOException, ArchiveException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        final String sibling = [0m[1;35mtempResultDir.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"x"[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        final File s = new [0m[1;35mFile[0m[1;39m([0m[1;35mtempResultDir.getParentFile[0m[1;39m([0m[1;39m)[0m[39m, sibling[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[1;35massumeFalse[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;35ms.mkdirs[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        [0m[1;35massumeTrue[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../"[0m[39m + sibling + [0m[32m"/a"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    void [0m[1;35mtestFileCantEscapeViaAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, [0m               [2m                [0m
[2;36m                    [0m         [39mArchiveException [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"/tmp/foo"[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        [0m[1;35massertFalse[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mtempResultDir, [0m[32m"tmp/foo"[0m[1;39m)[0m[1;35m.isFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Issue[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause of the path traversal vulnerability:[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Core Problem[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe `[0m[1;35mZipArchiveEntry.resolveIn[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m1484[0m[39m-[0m[1;36m1492[0m[1;39m)[0m[39m has a critical security [0m [2m                [0m
[2;36m                    [0m         [39mflaw:[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Line [0m[1;36m1487[0m[39m**: Validates `[0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m` [0m                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Line [0m[1;36m1491[0m[39m**: Returns `[0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mNormalizer.normalize[0m[1;39m([0m[39mname, [0m           [2m                [0m
[2;36m                    [0m         [39mNFKD[0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe method validates one path but returns a **different** path after Unicode [0m       [2m                [0m
[2;36m                    [0m         [39mnormalization. This creates a Time-of-Check-Time-of-Use [0m[1;39m([0m[39mTOCTOU[0m[1;39m)[0m[39m vulnerability [0m     [2m                [0m
[2;36m                    [0m         [39mwhere:[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m- The validation checks the non-Unicode-normalized path[0m                             [2m                [0m
[2;36m                    [0m         [39m- But returns the Unicode-normalized [0m[1;39m([0m[39mNFKD[0m[1;39m)[0m[39m path[0m                                    [2m                [0m
[2;36m                    [0m         [39m- These can be different paths that point to different locations[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mUnicode NFKD normalization can change the structure of filenames in ways that [0m      [2m                [0m
[2;36m                    [0m         [39maffect path security:[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Certain Unicode characters might normalize to path separators [0m[1;39m([0m[32m"/"[0m[39m or "\\"[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m- Characters might normalize to [0m[32m".."[0m[39m sequences[0m                                      [2m                [0m
[2;36m                    [0m         [39m- The normalized form might escape the parent directory even if the original [0m       [2m                [0m
[2;36m                    [0m         [39mdoesn't[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why Jazzer Detected It[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe Jazzer security sanitizer intercepts the `[0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m` [0m   [2m                [0m
[2;36m                    [0m         [39mcall at `Expander.jav[0m[1;92ma:86[0m[39m` and detects that the path is outside the expected [0m       [2m                [0m
[2;36m                    [0m         [39mdirectory. Even though the code has validation logic, the validation checks a [0m      [2m                [0m
[2;36m                    [0m         [39mdifferent path than what's actually used.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Scope of Impact[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mOnly `ZipArchiveEntry` is affected - other archive entry types [0m[1;39m([0m[39mTAR, 7z, AR, etc.[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39muse the default `[0m[1;35mArchiveEntry.resolveIn[0m[1;39m([0m[1;39m)[0m[39m` implementation which correctly validates[0m [2m                [0m
[2;36m                    [0m         [39mand returns the same path.[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Fix: Correct [0m[1;35mZipArchiveEntry.resolveIn[0m[1;39m([0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File**: [0m                                                                          [2m                [0m
[2;36m                    [0m         [39m`src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.java`[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: Lines [0m[1;36m1484[0m[39m-[0m[1;36m1492[0m[39m [0m[1;39m([0m[39mthe `resolveIn` method[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Strategy**:[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Apply Unicode normalization **BEFORE** path validation, not after[0m                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Validate the exact path that will be returned[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Return the validated path[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation Steps**:[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Normalize the entry name first: `String normalizedName = [0m                        [2m                [0m
[2;36m                    [0m         [1;35mNormalizer.normalize[0m[1;39m([0m[39mname, Normalizer.Form.NFKD[0m[1;39m)[0m[39m`[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Create the path from the normalized name: `Path outputFile = [0m                    [2m                [0m
[2;36m                    [0m         [1;35mparentPath.resolve[0m[1;39m([0m[39mnormalizedName[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m`[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Validate this path: `if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m throw IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m`[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Return the validated path: `return outputFile`[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Pseudocode**:[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m@Override[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mpublic Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [39m    final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Step [0m[1;36m1[0m[39m: Apply Unicode normalization FIRST[0m                                    [2m                [0m
[2;36m                    [0m         [39m    final String normalizedName = [0m[1;35mNormalizer.normalize[0m[1;39m([0m[39mname, Normalizer.Form.NFKD[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Step [0m[1;36m2[0m[39m: Create path from normalized name[0m                                     [2m                [0m
[2;36m                    [0m         [39m    final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mnormalizedName[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Step [0m[1;36m3[0m[39m: Validate the path that will be returned[0m                              [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Step [0m[1;36m4[0m[39m: Return the VALIDATED path[0m                                            [2m                [0m
[2;36m                    [0m         [39m    return outputFile;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Fix Is Optimal[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Eliminates the TOCTOU vulnerability**: The validation and return value are now[0m [2m                [0m
[2;36m                    [0m         [39mconsistent - we validate exactly what we return[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Preserves existing functionality**:[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Still performs Unicode NFKD normalization [0m[1;39m([0m[39mrequired for cross-platform [0m        [2m                [0m
[2;36m                    [0m         [39mcompatibility[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - Still validates against parent path [0m[1;39m([0m[39msecurity requirement[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Still returns normalized path [0m[1;39m([0m[39mexpected behavior from the javadoc comment on [0m  [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m1480[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - Maintains compatibility with the `testUnicodeNormalization` test[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Minimal code change**: Only reorders operations, doesn't add new logic or [0m     [2m                [0m
[2;36m                    [0m         [39mchange the API[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **No breaking changes**: [0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - Same method signature[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - Same exception behavior[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - Same return type[0m                                                               [2m                [0m
[2;36m                    [0m         [39m   - Only the order of operations changes[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Performance neutral**: [0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - Same number of operations[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - Actually creates one fewer Path object [0m[1;39m([0m[39mreuses `outputFile` for return[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m   - No additional overhead[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Addresses the root cause**: The fuzzer detected that the path used at [0m         [2m                [0m
[2;36m                    [0m         [39m`Expander.jav[0m[1;92ma:86[0m[39m` wasn't properly validated. This fix ensures validation happens [0m  [2m                [0m
[2;36m                    [0m         [39mon the actual path that will be used.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Preserves Existing Logic[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix maintains all the security and functionality requirements:[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Unicode Normalization**: Still normalizes to NFKD form as intended [0m[1;39m([0m[39mpreserves [0m [2m                [0m
[2;36m                    [0m         [39m`testUnicodeNormalization` test[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Path Traversal Prevention**: Still checks `[0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[39m` [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mpreserves all path traversal tests[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Error Messages**: Still throws IOException with the same format string[0m         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Expander Integration**: Works seamlessly with `[0m[1;35mExpander.expand[0m[1;39m([0m[1;39m)[0m[39m` which [0m       [2m                [0m
[2;36m                    [0m         [39mexpects `[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m` to return a safe path[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe only difference is **when** normalization occurs - before validation instead of[0m [2m                [0m
[2;36m                    [0m         [39mafter.[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effects and Mitigation[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects**:[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **More paths rejected**: If Unicode normalization creates path traversal [0m        [2m                [0m
[2;36m                    [0m         [39msequences, they will now be caught [0m[1;39m([0m[39mthis is the intended behavior[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Error messages**: The error message will show the normalized name in the [0m      [2m                [0m
[2;36m                    [0m         [39mexception, which is more accurate since that's what was actually validated[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation**:[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- These are not negative side effects - they're security improvements[0m               [2m                [0m
[2;36m                    [0m         [39m- The error message change makes it clearer what was actually checked[0m               [2m                [0m
[2;36m                    [0m         [39m- Any paths that are now rejected were security vulnerabilities waiting to happen[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why Other Approaches Were Not Chosen[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Alternative [0m[1;36m1[0m[39m: Add validation after returning the path in Expander**[0m              [2m                [0m
[2;36m                    [0m         [39m- ❌ Would require modifying multiple files[0m                                         [2m                [0m
[2;36m                    [0m         [39m- ❌ Violates separation of concerns - validation should be in `[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m`[0m        [2m                [0m
[2;36m                    [0m         [39m- ❌ Could miss other code paths that use `[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m`[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Alternative [0m[1;36m2[0m[39m: Remove Unicode normalization**[0m                                     [2m                [0m
[2;36m                    [0m         [39m- ❌ Would break existing functionality [0m[1;39m([0m[39mtestUnicodeNormalization would fail[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m- ❌ Cross-platform compatibility would be lost[0m                                     [2m                [0m
[2;36m                    [0m         [39m- ❌ Would affect users who rely on normalized filenames[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Alternative [0m[1;36m3[0m[39m: Validate both paths**[0m                                              [2m                [0m
[2;36m                    [0m         [39m- ❌ Redundant - if we validate the normalized path, we don't need to validate the [0m [2m                [0m
[2;36m                    [0m         [39mnon-normalized path[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- ❌ More complex code[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- ❌ Performance overhead[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Alternative [0m[1;36m4[0m[39m: Use [0m[1;35mPath.toRealPath[0m[1;39m([0m[1;39m)[0m[39m for stronger validation**[0m                    [2m                [0m
[2;36m                    [0m         [39m- ❌ Requires parent directory to exist[0m                                             [2m                [0m
[2;36m                    [0m         [39m- ❌ Resolves symlinks which may not be desired[0m                                     [2m                [0m
[2;36m                    [0m         [39m- ❌ Performance overhead[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- ❌ Platform-specific behavior[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe default `[0m[1;35mArchiveEntry.resolveIn[0m[1;39m([0m[1;39m)[0m[39m` implementation [0m[1;39m([0m[39mlines [0m[1;36m75[0m[39m-[0m[1;36m82[0m[1;39m)[0m[39m follows the [0m    [2m                [0m
[2;36m                    [0m         [39mcorrect pattern:[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mfinal Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mreturn outputFile;  [0m[35m/[0m[35m/[0m[39m Returns the VALIDATED path[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix makes `[0m[1;35mZipArchiveEntry.resolveIn[0m[1;39m([0m[1;39m)[0m[39m` consistent with this pattern, just with[0m [2m                [0m
[2;36m                    [0m         [39mUnicode normalization applied first.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=263563;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=446340;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=350004;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=609299;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmphjsyq8jd[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-de[0m [2m               [0m
[2;36m                    [0m         [35mlta-06_vuln_7/[0m[95magent-output-1768135420.7285206[0m                                        [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-commons-compress_cc-delta-06_vuln_7.toml     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/11/26 12:43:42][0m[2;36m [0m[34mINFO    [0m Deleting environments directory:                                                     ]8;id=879256;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=514511;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/.cache/environments/[0m[95mapache-commons-compress[0m                         [2m               [0m
[2;36m[01/11/26 12:43:43][0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=344528;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=260934;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-commons-compre[0m [2m               [0m
[2;36m                    [0m         [95mss[0m                                                                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=955047;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=190853;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-commons-compres[0m [2m               [0m
[2;36m                    [0m         [95ms[0m                                                                                    [2m               [0m
