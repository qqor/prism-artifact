{
  "project_name": "libavif",
  "vulnerability_identifier": "libavif_av-delta-02_avif-002",
  "source_directory": "/home/qqor/crete/.cache/official-afc-libavif",
  "llm_usage": {
    "total_cost": 2.1089279999999997,
    "prompt_tokens": 597096,
    "completion_tokens": 21176
  },
  "variant": "sound",
  "diff": "--- a/src/reformat.c\n+++ b/src/reformat.c\n@@ -774,10 +774,10 @@\n                     int adjCol = (i%2) ? -1 : 1;\n                     int adjRow = (j%2) ? -1 : 1;\n                     // check the bounds\n-                    if (i + adjCol >= image->width){\n+                    if ((int)i + adjCol < 0 || (int)i + adjCol >= (int)image->width){\n                         adjCol = 0;\n                     }\n-                    if (j + adjRow >= image->height){\n+                    if ((int)j + adjRow < 0 || (int)j + adjRow >= (int)image->height){\n                         adjRow = 0;\n                     }\n                     float pSpillCb = spill_Cb/3;\n@@ -807,6 +807,13 @@\n                         }else{\n                             b = -1;\n                         }\n+                        // Add bounds checking for a and b to prevent buffer overflow\n+                        if ((int)i + a < 0 || (int)i + a >= (int)image->width) {\n+                            a = 0;\n+                        }\n+                        if ((int)j + b < 0 || (int)j + b >= (int)image->height) {\n+                            b = 0;\n+                        }\n                         uspill_image[i][j] -= pSpillCb;\n                         vspill_image[i][j] -= pSpillCb;\n                         uspill_image[i+a][j] -= pSpillCb;\n@@ -815,7 +822,7 @@\n                         vspill_image[i][j+b] -= pSpillCr;\n                         uspill_image[i+a][j+b] -= pSpillCb;\n                         vspill_image[i+a][j+b] -= pSpillCr;\n-                    }   \n+                    }\n                 }\n             }\n             // break out of iteration if improvement is small compared to the size of the image\n",
  "stdout": "",
  "stderr": ""
}