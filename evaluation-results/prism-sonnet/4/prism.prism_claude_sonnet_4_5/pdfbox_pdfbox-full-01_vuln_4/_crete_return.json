{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_4",
  "source_directory": "/home/qqor/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 13.489620000000006,
    "prompt_tokens": 3562715,
    "completion_tokens": 186765
  },
  "variant": "uncompilable",
  "diff": "--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java\n+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java\n@@ -214,11 +214,20 @@\n             // 0 1 255 {1 index exch /.notdef put } for\n             // we have to check \"readonly\" and \"def\" too\n             // as some fonts don't provide any dup-values, see PDFBOX-2134\n-            while (!(lexer.peekKind(Token.NAME)\n-                    && (lexer.peekToken().getText().equals(\"dup\")\n-                            || lexer.peekToken().getText().equals(\"readonly\")\n-                            || lexer.peekToken().getText().equals(\"def\"))))\n-            {\n+            while (true)\n+            {\n+                Token token = lexer.peekToken();\n+                if (token == null)\n+                {\n+                    throw new IOException(\"Unexpected end of file while reading encoding\");\n+                }\n+                if (lexer.peekKind(Token.NAME)\n+                        && (token.getText().equals(\"dup\")\n+                                || token.getText().equals(\"readonly\")\n+                                || token.getText().equals(\"def\")))\n+                {\n+                    break;\n+                }\n                 lexer.nextToken();\n             }\n             \n@@ -637,9 +646,18 @@\n         // some fonts have \"2 index\" here, others have \"end noaccess put\"\n         // sometimes followed by \"put\". Either way, we just skip until\n         // the /CharStrings dict is found\n-        while (!(lexer.peekKind(Token.LITERAL)\n-                && lexer.peekToken().getText().equals(\"CharStrings\")))\n-        {\n+        while (true)\n+        {\n+            peekToken = lexer.peekToken();\n+            if (peekToken == null)\n+            {\n+                throw new IOException(\"/CharStrings token not found\");\n+            }\n+            if (lexer.peekKind(Token.LITERAL)\n+                    && peekToken.getText().equals(\"CharStrings\"))\n+            {\n+                break;\n+            }\n             lexer.nextToken();\n         }\n \n\n--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java\n+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java\n@@ -22,6 +22,7 @@\n import java.util.HashSet;\n import java.util.Map;\n import java.util.Optional;\n+import java.util.Set;\n import java.util.Map.Entry;\n \n import org.apache.logging.log4j.LogManager;\n@@ -98,13 +99,17 @@\n         }\n         document.setStartXref(startXrefOffset);\n         long prev = startXrefOffset;\n-        //lastPrev prevents potential infinite loops in crafted files\n-        long lastPrev = -1;\n+        // Set to detect any cycle in the PREV chain\n+        Set<Long> prevSet = new HashSet<>();\n         // ---- parse whole chain of xref tables/object streams using PREV reference\n         COSDictionary trailer = null;\n-        while (prev > 0 && prev != lastPrev)\n-        {\n-            lastPrev = prev;\n+        while (prev > 0)\n+        {\n+            if (prevSet.contains(prev))\n+            {\n+                throw new IOException(\"/Prev loop detected at offset \" + prev);\n+            }\n+            prevSet.add(prev);\n             // seek to xref table\n             source.seek(prev);\n             // skip white spaces\n@@ -169,10 +174,6 @@\n                     prev = fixedOffset;\n                     trailer.setLong(COSName.PREV, prev);\n                 }\n-            }\n-            if (prev == lastPrev)\n-            {\n-                throw new IOException(\"/Prev loop at offset \" + prev);\n             }\n         }\n         // ---- build valid xrefs out of the xref chain\n\n--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n@@ -180,6 +180,7 @@\n     private final class PageIterator implements Iterator<PDPage>\n     {\n         private final Queue<COSDictionary> queue = new ArrayDeque<>();\n+        private final Set<COSDictionary> visited = new HashSet<>();\n \n         private PageIterator(COSDictionary node)\n         {\n@@ -205,20 +206,33 @@\n          */\n         private List<COSDictionary> enqueueKids(COSDictionary node)\n         {\n+            if (node == null)\n+            {\n+                LOG.error(\"Page skipped due to null node\");\n+                return Collections.EMPTY_LIST;\n+            }\n+            \n+            if (visited.contains(node))\n+            {\n+                LOG.warn(\"Circular reference detected in page tree, skipping node\");\n+                return Collections.EMPTY_LIST;\n+            }\n+            visited.add(node);\n+            \n             if (isPageTreeNode(node))\n             {\n                 return getKids(node);\n             }\n             else\n             {\n-                if (node != null && COSName.PAGE.equals(node.getCOSName(COSName.TYPE)))\n+                if (COSName.PAGE.equals(node.getCOSName(COSName.TYPE)))\n                 {\n                     queue.add(node);\n                 }\n                 else\n                 {\n                     LOG.error(\"Page skipped due to an invalid or missing type {}\",\n-                            () -> (node == null ? \"(null)\" : node.getCOSName(COSName.TYPE)));\n+                            () -> node.getCOSName(COSName.TYPE));\n                 }\n             }\n             return Collections.EMPTY_LIST;\n\n--- a/fontbox/src/main/java/org/apache/fontbox/cff/Type1CharStringParser.java\n+++ b/fontbox/src/main/java/org/apache/fontbox/cff/Type1CharStringParser.java\n@@ -46,6 +46,9 @@\n     private static final int TWO_BYTE = 12;\n     private static final int CALLOTHERSUBR = 16;\n     private static final int POP = 17;\n+\n+    // Maximum recursion depth for CALLSUBR\n+    private static final int MAX_RECURSION_DEPTH = 10;\n \n     private final String fontName;\n     private String currentGlyph;\n@@ -72,19 +75,24 @@\n     public List<Object> parse(byte[] bytes, List<byte[]> subrs, String glyphName) throws IOException\n     {\n         currentGlyph = glyphName;\n-        return parse(bytes, subrs, new ArrayList<>());\n-    }\n-\n-    private List<Object> parse(byte[] bytes, List<byte[]> subrs, List<Object> sequence)\n+        return parse(bytes, subrs, new ArrayList<>(), 0);\n+    }\n+\n+    private List<Object> parse(byte[] bytes, List<byte[]> subrs, List<Object> sequence, int depth)\n             throws IOException\n     {\n+        if (depth > MAX_RECURSION_DEPTH)\n+        {\n+            throw new IOException(\"Maximum recursion depth exceeded in charstring parsing for glyph '\"\n+                    + currentGlyph + \"' of font \" + fontName);\n+        }\n         DataInput input = new DataInputByteArray(bytes);\n         while (input.hasRemaining())\n         {\n             int b0 = input.readUnsignedByte();\n             if (b0 == CALLSUBR)\n             {\n-                processCallSubr(subrs, sequence);\n+                processCallSubr(subrs, sequence, depth);\n             }\n             else if (b0 == TWO_BYTE && input.peekUnsignedByte(0) == CALLOTHERSUBR)\n             {\n",
  "stdout": "/src /src/project-parent/pdfbox\r\n/src/project-parent/pdfbox\r\n---------------------------------------------------------------\r\nvm.mmap_rnd_bits = 28\r\n---------------------------------------------------------------\r\nCC=clang\r\nCXX=clang++\r\nCFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types   -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension   -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -fno-sanitize=leak\r\nCXXFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types   -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension   -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -stdlib=libc++ -fno-sanitize=leak\r\nRUSTFLAGS=--cfg fuzzing -Zsanitizer=address -Cdebuginfo=1 -Cforce-frame-pointers\r\n---------------------------------------------------------------\r\n+ __REAL_MAVEN_REPO=/root/.m2/repository\r\n+ __SHARED_MAVEN_REPO=/work/mavencache\r\n+ '[' '!' -L /root/.m2/repository ']'\r\n+ unset __REAL_MAVEN_REPO\r\n+ unset __SHARED_MAVEN_REPO\r\n+ PROJECT=pdfbox\r\n+ PROJECT_GROUP_ID=org.apache.pdfbox\r\n+ PROJECT_ARTIFACT_ID=pdfbox\r\n+ XMPBOX_ARTIFACT_ID=xmpbox\r\n+ MAIN_REPOSITORY=https://github.com/apache/pdfbox/\r\n+ MAVEN_ARGS='-Djavac.src.version=11 -Djavac.target.version=11 -DskipTests'\r\n+ cd /src/project-parent\r\n+ [[ -v LOCAL_DEV ]]\r\n+ mv /src/PDFStreamParserFuzzer.dict /src/PDFWriteReadFuzzer.dict /out\r\n+ set_project_version_in_fuzz_targets_dependency\r\n++ cd pdfbox\r\n++ /src/maven/apache-maven-3.9.9/bin/mvn org.apache.maven.plugins:maven-help-plugin:3.2.0:evaluate -Dexpression=project.version -q -DforceStdout\r\n+ PROJECT_VERSION=4.0.0-SNAPSHOT\r\n+ cd fuzz-targets\r\n+ /src/maven/apache-maven-3.9.9/bin/mvn versions:use-dep-version -Dexcludes=com.code-intelligence:jazzer -DdepVersion=4.0.0-SNAPSHOT -DforceVersion=true\r\n[INFO] Scanning for projects...\r\n[INFO] \r\n[INFO] ----------------------< com.fuzzer:fuzz-targets >-----------------------\r\n[INFO] Building fuzz 0.0.1-SNAPSHOT\r\n[INFO]   from pom.xml\r\n[INFO] --------------------------------[ jar ]---------------------------------\r\n[INFO] \r\n[INFO] --- versions:2.20.1:use-dep-version (default-cli) @ fuzz-targets ---\r\n[INFO] Updated org.apache.pdfbox:pdfbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT\r\n[INFO] Updated org.apache.pdfbox:xmpbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] BUILD SUCCESS\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Total time:  0.695 s\r\n[INFO] Finished at: 2026-01-12T00:41:57Z\r\n[INFO] ------------------------------------------------------------------------\r\n+ cd pdfbox\r\n+ /src/maven/apache-maven-3.9.9/bin/mvn install -Djavac.src.version=11 -Djavac.target.version=11 -DskipTests -Dmaven.repo.local=/out/m2\r\n[INFO] Scanning for projects...\r\n\r\n\r\n\r\n\r\n\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Reactor Build Order:\r\n[INFO] \r\n[INFO] Apache PDFBox parent                                               [pom]\r\n[INFO] Apache PDFBox io                                                [bundle]\r\n[INFO] Apache FontBox                                                  [bundle]\r\n[INFO] Apache XmpBox                                                   [bundle]\r\n[INFO] Apache PDFBox                                                   [bundle]\r\n[INFO] Apache PDFBox Debugger                                             [jar]\r\n[INFO] Apache PDFBox tools                                                [jar]\r\n[INFO] Apache PDFBox application                                          [jar]\r\n[INFO] Apache PDFBox Debugger application                                 [jar]\r\n[INFO] Apache PDFBox examples                                             [jar]\r\n[INFO] pdfbox-reactor                                                     [pom]\r\n[INFO] \r\n[INFO] ------------------< org.apache.pdfbox:pdfbox-parent >-------------------\r\n[INFO] Building Apache PDFBox parent 4.0.0-SNAPSHOT                      [1/11]\r\n[INFO]   from parent/pom.xml\r\n[INFO] --------------------------------[ pom ]---------------------------------\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-parent ---\r\n\r\n[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-parent ---\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-parent ---\r\n[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed\r\n[INFO] \r\n[INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-parent ---\r\n\r\n[INFO] \r\n[INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-parent ---\r\n[INFO] Skipping JaCoCo execution because property jacoco.skip is set.\r\n[INFO] \r\n[INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-parent ---\r\n[INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7\r\n[INFO] Copying 3 resources from 1 bundle.\r\n[INFO] \r\n[INFO] --- jacoco:0.8.13:report (report) @ pdfbox-parent ---\r\n[INFO] Skipping JaCoCo execution because property jacoco.skip is set.\r\n[INFO] \r\n[INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-parent ---\r\n[INFO] \r\n[INFO] --- install:3.1.4:install (default-install) @ pdfbox-parent ---\r\n[INFO] Installing /src/project-parent/pdfbox/parent/pom.xml to /out/m2/org/apache/pdfbox/pdfbox-parent/4.0.0-SNAPSHOT/pdfbox-parent-4.0.0-SNAPSHOT.pom\r\n[INFO] \r\n[INFO] --------------------< org.apache.pdfbox:pdfbox-io >---------------------\r\n[INFO] Building Apache PDFBox io 4.0.0-SNAPSHOT                          [2/11]\r\n[INFO]   from io/pom.xml\r\n[INFO] -------------------------------[ bundle ]-------------------------------\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-io ---\r\n[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-io ---\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-io ---\r\n[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed\r\n[INFO] \r\n[INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-io ---\r\n[INFO] \r\n[INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-io ---\r\n[INFO] Skipping JaCoCo execution because property jacoco.skip is set.\r\n[INFO] \r\n[INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-io ---\r\n[INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7\r\n[INFO] Copying 3 resources from 1 bundle.\r\n[INFO] \r\n[INFO] --- resources:3.3.1:resources (default-resources) @ pdfbox-io ---\r\n[INFO] skip non existing resourceDirectory /src/project-parent/pdfbox/io/src/main/resources\r\n[INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes\r\n[INFO] \r\n[INFO] --- compiler:3.14.0:compile (default-compile) @ pdfbox-io ---\r\n[INFO] Recompiling the module because of changed source code.\r\n[INFO] Compiling 18 source files with javac [debug deprecation release 11] to target/classes\r\n[INFO] \r\n[INFO] --- resources:3.3.1:testResources (default-testResources) @ pdfbox-io ---\r\n[INFO] Copying 2 resources from src/test/resources to target/test-classes\r\n[INFO] Copying 3 resources from target/maven-shared-archive-resources to target/test-classes\r\n[INFO] \r\n[INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ pdfbox-io ---\r\n[INFO] Recompiling the module because of changed dependency.\r\n[INFO] Compiling 10 source files with javac [debug deprecation release 11] to target/test-classes\r\n[WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[45,29] populateBuffer(java.io.InputStream,byte[]) in org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal\r\n[WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[50,24] populateBuffer(java.io.InputStream,byte[]) in org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal\r\n[WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[57,24] populateBuffer(java.io.InputStream,byte[]) in org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal\r\n[INFO] \r\n[INFO] --- surefire:3.5.2:test (default-test) @ pdfbox-io ---\r\n[INFO] Tests are skipped.\r\n[INFO] \r\n[INFO] --- jacoco:0.8.13:report (report) @ pdfbox-io ---\r\n[INFO] Skipping JaCoCo execution because property jacoco.skip is set.\r\n[INFO] \r\n[INFO] --- bundle:5.1.9:bundle (default-bundle) @ pdfbox-io ---\r\n[INFO] Building bundle: /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar\r\n[INFO] Writing manifest: /src/project-parent/pdfbox/io/target/classes/META-INF/MANIFEST.MF\r\n[INFO] \r\n[INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-io ---\r\n[INFO] Building jar: /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar\r\n[INFO] \r\n[INFO] --- install:3.1.4:install (default-install) @ pdfbox-io ---\r\n[INFO] Installing /src/project-parent/pdfbox/io/pom.xml to /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.pom\r\n[INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar to /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar\r\n[INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar to /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT-sources.jar\r\n[INFO] \r\n[INFO] --- bundle:5.1.9:install (default-install) @ pdfbox-io ---\r\n[INFO] Writing OBR metadata\r\n[INFO] Installing org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar\r\n[INFO] Writing OBR metadata\r\n[INFO] \r\n[INFO] ---------------------< org.apache.pdfbox:fontbox >----------------------\r\n[INFO] Building Apache FontBox 4.0.0-SNAPSHOT                            [3/11]\r\n[INFO]   from fontbox/pom.xml\r\n[INFO] -------------------------------[ bundle ]-------------------------------\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (default) @ fontbox ---\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ fontbox ---\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ fontbox ---\r\n[INFO] \r\n[INFO] --- checkstyle:3.6.0:check (check) @ fontbox ---\r\n[INFO] \r\n[INFO] --- jacoco:0.8.13:prepare-agent (default) @ fontbox ---\r\n[INFO] Skipping JaCoCo execution because property jacoco.skip is set.\r\n[INFO] \r\n[INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ fontbox ---\r\n[INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7\r\n[INFO] Copying 3 resources from 1 bundle.\r\n[INFO] Copying appended resource: META-INF/LICENSE\r\n[INFO] Copying appended resource: META-INF/NOTICE\r\n[INFO] \r\n[INFO] --- resources:3.3.1:resources (default-resources) @ fontbox ---\r\n[INFO] Copying 93 resources from src/main/resources to target/classes\r\n[INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes\r\n[INFO] \r\n[INFO] --- compiler:3.14.0:compile (default-compile) @ fontbox ---\r\n[INFO] Recompiling the module because of changed dependency.\r\n[INFO] Compiling 141 source files with javac [debug deprecation release 11] to target/classes\r\n[INFO] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java: Some input files use unchecked or unsafe operations.\r\n[INFO] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java: Recompile with -Xlint:unchecked for details.\r\n[INFO] Some messages have been simplified; recompile with -Xdiags:verbose to get full output\r\n[INFO] -------------------------------------------------------------\r\n[ERROR] COMPILATION ERROR : \r\n[INFO] -------------------------------------------------------------\r\n[ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/Type1CharStringParser.java:[95,17] method processCallSubr in class org.apache.fontbox.cff.Type1CharStringParser cannot be applied to given types;\r\n  required: java.util.List<byte[]>,java.util.List<java.lang.Object>\r\n  found:    java.util.List<byte[]>,java.util.List<java.lang.Object>,int\r\n  reason: actual and formal argument lists differ in length\r\n[ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/Type1CharStringParser.java:[133,37] incompatible types: java.util.List<java.lang.Object> cannot be converted to java.lang.String\r\n[INFO] 2 errors \r\n[INFO] -------------------------------------------------------------\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:\r\n[INFO] \r\n[INFO] Apache PDFBox parent ............................... SUCCESS [  8.659 s]\r\n[INFO] Apache PDFBox io ................................... SUCCESS [  4.435 s]\r\n[INFO] Apache FontBox ..................................... FAILURE [  1.953 s]\r\n[INFO] Apache XmpBox ...................................... SKIPPED\r\n[INFO] Apache PDFBox ...................................... SKIPPED\r\n[INFO] Apache PDFBox Debugger ............................. SKIPPED\r\n[INFO] Apache PDFBox tools ................................ SKIPPED\r\n[INFO] Apache PDFBox application .......................... SKIPPED\r\n[INFO] Apache PDFBox Debugger application ................. SKIPPED\r\n[INFO] Apache PDFBox examples ............................. SKIPPED\r\n[INFO] pdfbox-reactor ..................................... SKIPPED\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] BUILD FAILURE\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Total time:  21.984 s\r\n[INFO] Finished at: 2026-01-12T00:42:19Z\r\n[INFO] ------------------------------------------------------------------------\r\n[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project fontbox: Compilation failure: Compilation failure: \r\n[ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/Type1CharStringParser.java:[95,17] method processCallSubr in class org.apache.fontbox.cff.Type1CharStringParser cannot be applied to given types;\r\n[ERROR]   required: java.util.List<byte[]>,java.util.List<java.lang.Object>\r\n[ERROR]   found:    java.util.List<byte[]>,java.util.List<java.lang.Object>,int\r\n[ERROR]   reason: actual and formal argument lists differ in length\r\n[ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/Type1CharStringParser.java:[133,37] incompatible types: java.util.List<java.lang.Object> cannot be converted to java.lang.String\r\n[ERROR] -> [Help 1]\r\n[ERROR] \r\n[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.\r\n[ERROR] Re-run Maven using the -X switch to enable full debug logging.\r\n[ERROR] \r\n[ERROR] For more information about the errors and possible solutions, please read the following articles:\r\n[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException\r\n[ERROR] \r\n[ERROR] After correcting the problems, you can resume the build with the command\r\n[ERROR]   mvn <args> -rf :fontbox\r\nsubprocess command returned a non-zero exit status: 1\n",
  "stderr": "INFO:__main__:Running: docker build -t aixcc-afc/pdfbox:latest --file /home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/projects/pdfbox/Dockerfile /home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/projects/pdfbox.\n#0 building with \"default\" instance using docker driver\n\n#1 [internal] load build definition from Dockerfile\n#1 transferring dockerfile: 2.07kB done\n#1 DONE 0.0s\n\n#2 [internal] load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0\n#2 DONE 0.0s\n\n#3 [internal] load .dockerignore\n#3 transferring context: 2B done\n#3 DONE 0.0s\n\n#4 [ 1/13] FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0\n#4 DONE 0.0s\n\n#5 [internal] load build context\n#5 transferring context: 1.23kB done\n#5 DONE 0.0s\n\n#6 [ 2/13] RUN set -eux     && apt-get update     && apt-get install --yes --no-install-recommends         tesseract-ocr=4.1.1-2build2         tesseract-ocr-eng=1:4.00~git30-7274cfa-1     && apt-get clean     && rm -rf /var/lib/apt/lists/*\n#6 CACHED\n\n#7 [10/13] COPY pkgs/pdfbox.tar.gz /src/pdfbox.tar.gz\n#7 CACHED\n\n#8 [ 5/13] RUN unzip /src/maven.zip -d /src/maven && rm /src/maven.zip\n#8 CACHED\n\n#9 [ 8/13] COPY project-parent /src/project-parent/\n#9 CACHED\n\n#10 [ 9/13] RUN rm -rf /src/project-parent/pdfbox\n#10 CACHED\n\n#11 [ 7/13] RUN gunzip /src/pdf.dict.gz &&     mv /src/pdf.dict /src/PDFStreamParserFuzzer.dict &&     cp /src/PDFStreamParserFuzzer.dict /src/PDFWriteReadFuzzer.dict\n#11 CACHED\n\n#12 [ 4/13] COPY pkgs/maven.zip /src/maven.zip\n#12 CACHED\n\n#13 [ 6/13] COPY pkgs/pdf.dict.gz /src/pdf.dict.gz\n#13 CACHED\n\n#14 [ 3/13] RUN mkdir /usr/my-bin && mv /usr/bin/tesseract /usr/my-bin/tesseract\n#14 CACHED\n\n#15 [11/13] RUN tar -zxf /src/pdfbox.tar.gz -C /src/project-parent && rm /src/pdfbox.tar.gz\n#15 CACHED\n\n#16 [12/13] COPY build.sh /src/\n#16 CACHED\n\n#17 [13/13] WORKDIR /src/project-parent/pdfbox\n#17 CACHED\n\n#18 exporting to image\n#18 exporting layers done\n#18 writing image sha256:c176373707955b9b023fb504b892a04e2e71f8a0d3105d1eed7fdf349acf9998 done\n#18 naming to docker.io/aixcc-afc/pdfbox:latest done\n#18 DONE 0.0s\nINFO:__main__:Keeping existing build artifacts as-is (if any).\nINFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e ARCHITECTURE=x86_64 -e PROJECT_NAME=pdfbox -e HELPER=True -e FUZZING_LANGUAGE=jvm -e BASH_ENV=/work/bashrc0 -e MAVEN_OPTS=-Dmaven.repo.local=/work/mavencache -v /home/qqor/crete/.cache/official-afc-pdfbox:/local-source-mount:ro -v /home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/pdfbox/:/out -v /home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/pdfbox:/work -t aixcc-afc/pdfbox:latest /bin/bash -c 'pushd $SRC && rm -rf /src/project-parent/pdfbox && cp -r /local-source-mount /src/project-parent/pdfbox && popd && compile'.\nERROR:__main__:Building fuzzers failed.\n"
}