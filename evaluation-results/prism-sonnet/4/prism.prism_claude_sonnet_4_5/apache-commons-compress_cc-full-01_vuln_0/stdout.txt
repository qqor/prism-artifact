[2;36m[01/11/26 12:52:05][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=924222;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=711773;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpb5osy7_n[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-fu[0m [2m               [0m
[2;36m                    [0m         [35mll-01_vuln_0/[0m[95magent-output-1768135925.27072[0m                                           [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-commons-compress_cc-full-01_vuln_0.toml      [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN        ]8;id=152524;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=967396;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m[01/11/26 12:53:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN       ]8;id=452228;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=600340;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m73.59[0m seconds; [33mexception[0m=[3;91mFalse[0m                              [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for     ]8;id=266806;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=912100;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Started[33m...[0m                                                  [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for    ]8;id=308805;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=461987;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                         [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=91273;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=812545;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m73[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=789230;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=216789;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:53:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.87[0m        ]8;id=627120;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=260061;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/11/26 12:53:20][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=585788;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=266154;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=663529;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=955511;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m[01/11/26 12:53:21][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=980516;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=388562;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=535555;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=539119;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:53:22][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m1.08[0m        ]8;id=232894;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=826412;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=196273;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=73539;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:53:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.84[0m        ]8;id=649024;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=168333;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/11/26 12:53:28][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=201364;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=106009;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazze.com:[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:583[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:183[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/sun.net.www.http.HttpClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URL.openStream[0m[1;39m([0m[39mURL.jav[0m[1;92ma:1161[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.readCentralDirectoryEntry[0m[1;39m([0m[39mZipFile[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:1552[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.populateFromCentralDirectory[0m[1;39m([0m[39mZipF[0m [2m                [0m
[2;36m                    [0m         [39mile.jav[0m[1;92ma:1329[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:905[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:971[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:938[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:876[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mCompressZipFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mCompressZipFuzzer.jav[0m[1;92ma:30[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b38823cc610751ee[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazze.com:[0m[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URL.openStream[0m[1;39m([0m[39mURL.jav[0m[1;92ma:1161[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.readCentralDirectoryEntry[0m[1;39m([0m[39mZipFile[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:1552[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.populateFromCentralDirectory[0m[1;39m([0m[39mZipF[0m [2m                [0m
[2;36m                    [0m         [39mile.jav[0m[1;92ma:1329[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:905[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:971[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:938[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init[0m[1m>[0m[1m([0mZipFile.jav[1;92ma:876[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35mCompressZipFuzzer.fuzzerTestOneInput[0m[1m([0mCompressZipFuzzer.jav[1;92ma:30[0m[1m)[0m          [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: b38823cc610751ee                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/11/26 12:53:48][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=685728;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=739388;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/11/26 12:57:46][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=640245;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=936176;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/11/26 12:58:28][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=91954;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=270006;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=38100;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=190022;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:58:29][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.92[0m        ]8;id=878136;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=835122;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/11/26 12:58:30][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Started[33m...[0m             ]8;id=718928;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=970837;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmps5mfhahh[0m                                                 ]8;id=704400;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=861447;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/11/26 12:59:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Took [1;36m35.42[0m seconds;   ]8;id=740133;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=776434;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Started[33m...[0m       ]8;id=252413;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=461127;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:59:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Took [1;36m20.18[0m      ]8;id=469195;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=915428;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Started[33m...[0m          ]8;id=987129;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=967719;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:59:30][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Took [1;36m4.89[0m seconds; ]8;id=451935;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=833032;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Started[33m...[0m              ]8;id=736800;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=33111;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Took [1;36m0.00[0m seconds;     ]8;id=114360;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=518350;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=80610;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=738012;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:59:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.88[0m        ]8;id=776378;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=95104;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/11/26 12:59:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=12285;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=93616;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:59:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.91[0m        ]8;id=634611;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=865869;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=515514;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=774444;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:59:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.91[0m        ]8;id=395928;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=178898;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=29987;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=881000;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java          [2m                [0m
[2;36m                    [0m         +++ b/src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java          [2m                [0m
[2;36m                    [0m         @@ [1;36m-27[0m,[1;36m7[0m +[1;36m27[0m,[1;36m6[0m @@                                                                   [2m                [0m
[2;36m                    [0m          import java.io.IOException;                                                        [2m                [0m
[2;36m                    [0m          import java.io.InputStream;                                                        [2m                [0m
[2;36m                    [0m          import java.io.SequenceInputStream;                                                [2m                [0m
[2;36m                    [0m         -import java.net.URL;                                                               [2m                [0m
[2;36m                    [0m          import java.nio.ByteBuffer;                                                        [2m                [0m
[2;36m                    [0m          import java.nio.ByteOrder;                                                         [2m                [0m
[2;36m                    [0m          import java.nio.channels.FileChannel;                                              [2m                [0m
[2;36m                    [0m         @@ [1;36m-1548[0m,[1;36m15[0m +[1;36m1547[0m,[1;36m6[0m @@                                                              [2m                [0m
[2;36m                    [0m                      throw new [1;35mEOFException[0m[1m([0m[1m)[0m;                                              [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                  String commentString = [1;35mentryEncoding.decode[0m[1m([0mcomment[1m)[0m;                      [2m                [0m
[2;36m                    [0m         -        if [1m([0m[1;35mcommentString.startsWith[0m[1m([0m[32m"http"[0m[1m)[0m || [1;35mcommentString.startsWith[0m[1m([0m[32m"https"[0m[1m)[0m[1m)[0m [2m                [0m
[2;36m                    [0m         [1m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         -            try [1m([0mInputStream is = new [1;35mURL[0m[1m([0mcommentString[1m)[0m[1;35m.openStream[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m           [2m                [0m
[2;36m                    [0m         -                ByteArrayOutputStream bos = new [1;35mByteArrayOutputStream[0m[1m([0m[1m)[0m;           [2m                [0m
[2;36m                    [0m         -                [1;35mIOUtils.copy[0m[1m([0mis, bos[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         -                commentString = new [1;35mString[0m[1m([0m[1;35mbos.toByteArray[0m[1m([0m[1m)[0m,                      [2m                [0m
[2;36m                    [0m         StandardCharsets.UTF_8[1m)[0m;                                                            [2m                [0m
[2;36m                    [0m         -            [1m}[0m catch [1m([0mIOException e[1m)[0m [1m{[0m                                              [2m                [0m
[2;36m                    [0m         -                [35m/[0m[35m/[0m[95mswallow[0m                                                          [2m                [0m
[2;36m                    [0m         -            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                  [1;35mze.setComment[0m[1m([0mcommentString[1m)[0m;                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  if [1m([0m!hasUTF8Flag && useUnicodeExtraFields[1m)[0m [1m{[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazze.com:[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:583[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:183[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/sun.net.www.http.HttpClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URL.openStream[0m[1;39m([0m[39mURL.jav[0m[1;92ma:1161[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.readCentralDirectoryEntry[0m[1;39m([0m[39mZipFile[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:1552[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.populateFromCentralDirectory[0m[1;39m([0m[39mZipF[0m [2m                [0m
[2;36m                    [0m         [39mile.jav[0m[1;92ma:1329[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:905[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:971[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:938[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:876[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mCompressZipFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mCompressZipFuzzer.jav[0m[1;92ma:30[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b38823cc610751ee[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability has been detected in the Apache [0m [2m                [0m
[2;36m                    [0m         [39mCommons Compress library's ZipFile implementation. The fuzzer identified an [0m        [2m                [0m
[2;36m                    [0m         [39mattempted connection to an external domain [0m[1;39m([0m[39mjazze.com:[0m[1;36m80[0m[1;39m)[0m[39m during ZIP file [0m          [2m                [0m
[2;36m                    [0m         [39mprocessing, indicating that untrusted data from a ZIP file can be used to initiate [0m [2m                [0m
[2;36m                    [0m         [39mnetwork connections to arbitrary destinations. This vulnerability is classified as [0m [2m                [0m
[2;36m                    [0m         [39mmedium severity and could potentially lead to exfiltration of sensitive data or [0m    [2m                [0m
[2;36m                    [0m         [39mexposure of internal services.[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue manifests as a Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability detected [0m [2m                [0m
[2;36m                    [0m         [39mby the Jazzer fuzzer's security sanitizer. The vulnerability was triggered during [0m  [2m                [0m
[2;36m                    [0m         [39mfuzz testing of the Apache Commons Compress ZIP file handling functionality.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerability Type:**[0m                                                             [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m is a security vulnerability that allows an [0m      [2m                [0m
[2;36m                    [0m         [39mattacker to cause the server-side application to make HTTP requests to an arbitrary[0m [2m                [0m
[2;36m                    [0m         [39mdomain of the attacker's choosing. In this case, the application attempted to [0m      [2m                [0m
[2;36m                    [0m         [39mconnect to [0m[32m"jazze.com:80"[0m[39m based on data from the fuzzing input. According to the [0m   [2m                [0m
[2;36m                    [0m         [39msecurity warning, requests to destinations based on untrusted data could lead to [0m   [2m                [0m
[2;36m                    [0m         [39mexfiltration of sensitive data or exposure of internal services.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Key Observations:**[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The SSRF detection occurred at `ServerSideRequestForgery.checkSsrfSocket` when [0m  [2m                [0m
[2;36m                    [0m         [39mattempting to establish a socket connection.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The network connection attempt originated from standard Java networking classes [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`java.net.Socket.connect`, `sun.net.www.http.HttpClient`[0m[1;39m)[0m[39m, indicating the [0m         [2m                [0m
[2;36m                    [0m         [39mapplication is making real network requests.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The connection attempt was triggered through URL stream operations [0m              [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`java.net.URL.openStream`[0m[1;39m)[0m[39m, suggesting that a URL embedded in the ZIP file data is[0m [2m                [0m
[2;36m                    [0m         [39mbeing opened without proper validation.[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. The call chain shows the issue originates in `ZipFile.readCentralDirectoryEntry`[0m [2m                [0m
[2;36m                    [0m         [39mat line [0m[1;36m1552[0m[39m, which is part of the ZIP file parsing logic in Apache Commons [0m        [2m                [0m
[2;36m                    [0m         [39mCompress.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. The vulnerability is triggered during the population of data from the central [0m   [2m                [0m
[2;36m                    [0m         [39mdirectory of the ZIP file [0m[1;39m([0m[39m`ZipFile.populateFromCentralDirectory`[0m[1;39m)[0m[39m, which occurs [0m   [2m                [0m
[2;36m                    [0m         [39mduring ZipFile initialization.[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Areas for Investigation:**[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a complete understanding of this vulnerability, the following components of[0m [2m                [0m
[2;36m                    [0m         [39mthe Apache Commons Compress codebase should be investigated:[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **`org.apache.commons.compress.archivers.zip.ZipFile.readCentralDirectoryEntry` [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m1552[0m[1;39m)[0m[39m**: This is the direct source of the URL opening operation. [0m             [2m                [0m
[2;36m                    [0m         [39mInvestigation should focus on what data from the ZIP file is being used to [0m         [2m                [0m
[2;36m                    [0m         [39mconstruct URLs and why network connections are being initiated.[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m**`org.apache.commons.compress.archivers.zip.ZipFile.populateFromCentralDirectory` [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m1329[0m[1;39m)[0m[39m**: This method orchestrates the reading of the central directory and [0m   [2m                [0m
[2;36m                    [0m         [39mshould be examined to understand the overall flow of ZIP file parsing.[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **ZIP Central Directory Parsing Logic**: The central directory structure of ZIP [0m [2m                [0m
[2;36m                    [0m         [39mfiles contains metadata about entries, including file names and potentially other [0m  [2m                [0m
[2;36m                    [0m         [39mfields that might be interpreted as URLs.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **ZipFile Constructor Chain**: The constructors at lines [0m[1;36m876[0m[39m, [0m[1;36m905[0m[39m, [0m[1;36m938[0m[39m, and [0m[1;36m971[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mshould be reviewed to understand initialization parameters and whether any [0m         [2m                [0m
[2;36m                    [0m         [39mvalidation is performed on input data before processing.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Any URL Construction or External Resource Loading**: Code paths where ZIP [0m     [2m                [0m
[2;36m                    [0m         [39mentry data [0m[1;39m([0m[39mfile names, comments, or other metadata fields[0m[1;39m)[0m[39m might be interpreted as[0m [2m                [0m
[2;36m                    [0m         [39mURLs or used to construct network resource locations need thorough examination.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability appears to stem from the library trusting data within ZIP file [0m   [2m                [0m
[2;36m                    [0m         [39mstructures and using it to make network requests without proper validation or [0m      [2m                [0m
[2;36m                    [0m         [39msanitization, potentially allowing an attacker to craft malicious ZIP files that [0m   [2m                [0m
[2;36m                    [0m         [39mtrigger requests to attacker-controlled or internal network resources.[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazze.com:[0m[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URL.openStream[0m[1;39m([0m[39mURL.jav[0m[1;92ma:1161[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.readCentralDirectoryEntry[0m[1;39m([0m[39mZipFile[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:1552[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.populateFromCentralDirectory[0m[1;39m([0m[39mZipF[0m [2m                [0m
[2;36m                    [0m         [39mile.jav[0m[1;92ma:1329[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:905[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:971[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:938[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:876[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mCompressZipFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mCompressZipFuzzer.jav[0m[1;92ma:30[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b38823cc610751ee[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:21[0m[39m-[0m[1;36m71[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.SequenceInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.nio.ByteOrder;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.nio.file.OpenOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import java.util.Comparator;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import java.util.EnumSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import java.util.stream.Collectors;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import java.util.stream.IntStream;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import java.util.zip.Inflater;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.apache.commons.compress.archivers.EntryStreamOffsets;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:import org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream;[0m [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.deflate64.Deflate64CompressorInputStream;[0m   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:import org.apache.commons.compress.compressors.xz.XZCompressorInputStream;[0m       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.zstandard.ZstdCompressorInputStream;[0m        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:import org.apache.commons.compress.utils.BoundedArchiveInputStream;[0m              [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:import org.apache.commons.compress.utils.BoundedSeekableByteChannelInputStream;[0m  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:import org.apache.commons.compress.utils.IOUtils;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:import org.apache.commons.compress.utils.InputStreamStatistics;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:import org.apache.commons.compress.utils.SeekableInMemoryByteChannel;[0m            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:import org.apache.commons.io.Charsets;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:import org.apache.commons.io.FilenameUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:import org.apache.commons.io.build.AbstractOrigin.ByteArrayOrigin;[0m               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:import org.apache.commons.io.build.AbstractStreamBuilder;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:import org.apache.commons.io.function.IOStream;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:import org.apache.commons.io.input.BoundedInputStream;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1443[0m[39m-[0m[1;36m1567[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1443[0m[39m:    private void [0m[1;35mreadCentralDirectoryEntry[0m[1;39m([0m[39mfinal Map<ZipArchiveEntry, [0m         [2m                [0m
[2;36m                    [0m         [39mNameAndComment> noUTF8Flag[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1444[0m[39m:        [0m[1;35mcfhBbuf.rewind[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:        [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39marchive, cfhBbuf[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1446[0m[39m:        int off = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1447[0m[39m:        final Entry ze = new [0m[1;35mEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1448[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:        final int versionMadeBy = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:        [0m[1;35mze.setVersionMadeBy[0m[1;39m([0m[39mversionMadeBy[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:        [0m[1;35mze.setPlatform[0m[1;39m([0m[1;35mtoPlatform[0m[1;39m([0m[39mversionMadeBy[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1453[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1454[0m[39m:        [0m[1;35mze.setVersionRequired[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1455[0m[39m:        off += ZipConstants.SHORT; [0m[35m/[0m[35m/[0m[39m version required[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1456[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1457[0m[39m:        final GeneralPurposeBit gpFlag = [0m[1;35mGeneralPurposeBit.parse[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m1458[0m[39m:        final boolean hasUTF8Flag = [0m[1;35mgpFlag.usesUTF8ForNames[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1459[0m[39m:        final ZipEncoding entryEncoding = hasUTF8Flag ? [0m                       [2m                [0m
[2;36m                    [0m         [39mZipEncodingHelper.ZIP_ENCODING_UTF_8 : zipEncoding;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1460[0m[39m:        if [0m[1;39m([0m[39mhasUTF8Flag[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1461[0m[39m:            [0m[1;35mze.setNameSource[0m[1;39m([0m[39mZipArchiveEntry.NameSource.NAME_WITH_EFS_FLAG[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m1462[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1463[0m[39m:        [0m[1;35mze.setGeneralPurposeBit[0m[1;39m([0m[39mgpFlag[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1464[0m[39m:        [0m[1;35mze.setRawFlag[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1465[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1466[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1467[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1468[0m[39m:        [0m[35m/[0m[35m/[0m[39m noinspection MagicConstant[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1469[0m[39m:        [0m[1;35mze.setMethod[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1470[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1471[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1472[0m[39m:        final long time = [0m[1;35mZipUtil.dosToJavaTime[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, [0m      [2m                [0m
[2;36m                    [0m         [39moff[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1473[0m[39m:        [0m[1;35mze.setTime[0m[1;39m([0m[39mtime[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1474[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1475[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1476[0m[39m:        [0m[1;35mze.setCrc[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:        long size = [0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:        if [0m[1;39m([0m[39msize < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mcompressed size"[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:        [0m[1;35mze.setCompressedSize[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:        size = [0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:        if [0m[1;39m([0m[39msize < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative size"[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;35mze.setSize[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:        final int fileNameLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:        if [0m[1;39m([0m[39mfileNameLen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mfileNameLen"[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:        final int extraLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:        if [0m[1;39m([0m[39mextraLen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mextraLen"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:        final int commentLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:        if [0m[1;39m([0m[39mcommentLen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mcommentLen"[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:        [0m[1;35mze.setDiskNumberStart[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:        [0m[1;35mze.setInternalAttributes[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:        [0m[1;35mze.setExternalAttributes[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m fileName = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, fileNameLen[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:        if [0m[1;39m([0m[39mfileName.length < fileNameLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1522[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:        [0m[1;35mze.setName[0m[1;39m([0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m, fileName[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:        [0m[35m/[0m[35m/[0m[39m LFH offset,[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:        [0m[1;35mze.setLocalHeaderOffset[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m + [0m               [2m                [0m
[2;36m                    [0m         [39mfirstLocalFileHeaderOffset[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1528[0m[39m:        [0m[35m/[0m[35m/[0m[39m data offset will be filled later[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:        [0m[1;35mentries.add[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m cdExtraData = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, extraLen[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:        if [0m[1;39m([0m[39mcdExtraData.length < extraLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:        try [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:            [0m[1;35mze.setCentralDirectoryExtra[0m[1;39m([0m[39mcdExtraData[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal RuntimeException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:            final ZipException z = new [0m[1;35mZipException[0m[1;39m([0m[32m"Invalid extra data in [0m    [2m                [0m
[2;36m                    [0m         [32mentry "[0m[39m + [0m[1;35mze.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:            [0m[1;35mz.initCause[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:            throw z;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:        [0m[1;35msetSizesAndOffsetFromZip64Extra[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:        [0m[1;35msanityCheckLFHOffset[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m comment = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, commentLen[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:        if [0m[1;39m([0m[39mcomment.length < commentLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:        String commentString = [0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mcomment[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:        if [0m[1;39m([0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[39m || [0m                               [2m                [0m
[2;36m                    [0m         [1;35mcommentString.startsWith[0m[1;39m([0m[32m"https"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:            try [0m[1;39m([0m[39mInputStream is = new [0m[1;35mURL[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[1;35m.openStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:                ByteArrayOutputStream bos = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, bos[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:                commentString = new [0m[1;35mString[0m[1;39m([0m[1;35mbos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m, [0m                 [2m                [0m
[2;36m                    [0m         [39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:        [0m[1;35mze.setComment[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:        if [0m[1;39m([0m[39m!hasUTF8Flag && useUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:            [0m[1;35mnoUTF8Flag.put[0m[1;39m([0m[39mze, new [0m[1;35mNameAndComment[0m[1;39m([0m[39mfileName, comment[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:        [0m[1;35mze.setStreamContiguous[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:860[0m[39m-[0m[1;36m919[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mnewReadByteChannel[0m[1;39m([0m[39mpath[0m[1;39m)[0m[39m, [0m[1;35mpath.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mencoding, useUnicodeExtraFields, true, ignoreLocalFileHeader[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:     * Opens the given channel for reading, assuming [0m[32m"UTF-8"[0m[39m for file names.[0m    [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:     * [0m[1;39m{[0m[39m@link org.apache.commons.compress.utils.SeekableInMemoryByteChannel[0m[1;39m}[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mallows you to read from an in-memory archive.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:     * @param channel the archive.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:     * @throws IOException if an error occurs while reading the file.[0m           [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:     * @since [0m[1;36m1.13[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:     * @deprecated Use [0m[1;39m{[0m[39m@link Builder#[0m[1;35mget[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[39m.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    @Deprecated[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    public [0m[1;35mZipFile[0m[1;39m([0m[39mfinal SeekableByteChannel channel[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mchannel, [0m[32m"a SeekableByteChannel"[0m[39m, DEFAULT_CHARSET_NAME, true[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:     * Opens the given channel for reading, assuming the specified encoding for[0m [2m                [0m
[2;36m                    [0m         [39mfile names.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:     * [0m[1;39m{[0m[39m@link org.apache.commons.compress.utils.SeekableInMemoryByteChannel[0m[1;39m}[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mallows you to read from an in-memory archive.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:     * @param channel  the archive.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:     * @param encoding the encoding to use for file names, use null for the [0m    [2m                [0m
[2;36m                    [0m         [39mplatform's default encoding[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:     * @throws IOException if an error occurs while reading the file.[0m           [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:     * @since [0m[1;36m1.13[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:     * @deprecated Use [0m[1;39m{[0m[39m@link Builder#[0m[1;35mget[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[39m.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    @Deprecated[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:    public [0m[1;35mZipFile[0m[1;39m([0m[39mfinal SeekableByteChannel channel, final String encoding[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mchannel, [0m[32m"a SeekableByteChannel"[0m[39m, encoding, true[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    private [0m[1;35mZipFile[0m[1;39m([0m[39mfinal SeekableByteChannel channel, final String [0m            [2m                [0m
[2;36m                    [0m         [39mchannelDescription, final Charset encoding, final boolean useUnicodeExtraFields,[0m    [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:            final boolean closeOnError, final boolean ignoreLocalFileHeader[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:        this.isSplitZipArchive = channel instanceof [0m                            [2m                [0m
[2;36m                    [0m         [39mZipSplitReadOnlySeekableByteChannel;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:        this.encoding = [0m[1;35mCharsets.toCharset[0m[1;39m([0m[39mencoding, Builder.DEFAULT_CHARSET[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:        this.zipEncoding = [0m[1;35mZipEncodingHelper.getZipEncoding[0m[1;39m([0m[39mencoding[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:        this.useUnicodeExtraFields = useUnicodeExtraFields;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m902[0m[39m:        this.archive = channel;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m903[0m[39m:        boolean success = false;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m904[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m905[0m[39m:            final Map<ZipArchiveEntry, NameAndComment> entriesWithoutUTF8Flag =[0m [2m                [0m
[2;36m                    [0m         [1;35mpopulateFromCentralDirectory[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m906[0m[39m:            if [0m[1;39m([0m[39m!ignoreLocalFileHeader[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:                [0m[1;35mresolveLocalFileHeaderData[0m[1;39m([0m[39mentriesWithoutUTF8Flag[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:            [0m[1;35mfillNameMap[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m910[0m[39m:            success = true;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m911[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m912[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Error reading Zip content from "[0m[39m + [0m          [2m                [0m
[2;36m                    [0m         [39mchannelDescription, e[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m913[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m914[0m[39m:            this.closed = !success;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m915[0m[39m:            if [0m[1;39m([0m[39m!success && closeOnError[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m916[0m[39m:                [0m[1;35morg.apache.commons.io.IOUtils.closeQuietly[0m[1;39m([0m[39marchive[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1314[0m[39m-[0m[1;36m1335[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1314[0m[39m:    private Map<ZipArchiveEntry, NameAndComment> [0m                              [2m                [0m
[2;36m                    [0m         [1;35mpopulateFromCentralDirectory[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1315[0m[39m:        final HashMap<ZipArchiveEntry, NameAndComment> noUTF8Flag = new [0m       [2m                [0m
[2;36m                    [0m         [39mHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1316[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1317[0m[39m:        [0m[1;35mpositionAtCentralDirectory[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1318[0m[39m:        centralDirectoryStartOffset = [0m[1;35marchive.position[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1319[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1320[0m[39m:        [0m[1;35mwordBbuf.rewind[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1321[0m[39m:        [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39marchive, wordBbuf[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1322[0m[39m:        long sig = [0m[1;35mZipLong.getValue[0m[1;39m([0m[39mwordBuf[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1323[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1324[0m[39m:        if [0m[1;39m([0m[39msig != CFH_SIG && [0m[1;35mstartsWithLocalFileHeader[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1325[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Central directory is empty, can't expand"[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [32m" corrupt archive."[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1326[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1327[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1328[0m[39m:        while [0m[1;39m([0m[39msig == CFH_SIG[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1329[0m[39m:            [0m[1;35mreadCentralDirectoryEntry[0m[1;39m([0m[39mnoUTF8Flag[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1330[0m[39m:            [0m[1;35mwordBbuf.rewind[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1331[0m[39m:            [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39marchive, wordBbuf[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1332[0m[39m:            sig = [0m[1;35mZipLong.getValue[0m[1;39m([0m[39mwordBuf[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1333[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1334[0m[39m:        return noUTF8Flag;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1335[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:21[0m[39m-[0m[1;36m42[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.LinkOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.file.attribute.FileTime;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.NoSuchElementException;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.function.Function;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.EntryStreamOffsets;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.utils.ByteUtils;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.io.file.attribute.FileTimes;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:630[0m[39m-[0m[1;36m68[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m630[0m[39m:     * @return An array of all extra fields. Not necessarily a copy of internal[0m [2m                [0m
[2;36m                    [0m         [39mdata structures, hence private method[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m631[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:    private ZipExtraField[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetAllExtraFieldsNoCopy[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:        if [0m[1;39m([0m[39mextraFields == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:            return [0m[1;35mgetUnparseableOnly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:        return unparseableExtra != null ? [0m[1;35mgetMergedFields[0m[1;39m([0m[1;39m)[0m[39m : extraFields;[0m      [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:     * Retrieves the extra data for the central directory.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:     * @return the central directory extra data[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:    public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetCentralDirectoryExtra[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:        return [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;35mExtraFieldUtils.mergeCentralDirectoryData[0m[1;39m([0m[1;35mgetAllExtraFieldsNoCopy[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:     * The source of the comment field value.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:     * @return source of the comment field value[0m                                [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:     * @since [0m[1;36m1.16[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:    public CommentSource [0m[1;35mgetCommentSource[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:        return commentSource;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:    public long [0m[1;35mgetDataOffset[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:        return dataOffset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:     * The number of the split segment this entry starts at.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:     * @return the number of the split segment this entry starts at.[0m            [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:     * @since [0m[1;36m1.20[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:    public long [0m[1;35mgetDiskNumberStart[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:        return diskNumberStart;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:     * Retrieves the external file attributes.[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:     * <strong>Note<[0m[35m/[0m[95mstrong[0m[39m>: [0m[1;39m{[0m[39m@link ZipArchiveInputStream[0m[1;39m}[0m[39m is unable to fill [0m  [2m                [0m
[2;36m                    [0m         [39mthis field, you must use [0m[1;39m{[0m[39m@link ZipFile[0m[1;39m}[0m[39m if you want to read entries using this[0m     [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:     * attribute.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m21[0m[39m-[0m[1;36m52[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import static org.apache.commons.compress.archivers.zip.ZipConstants.DWORD;[0m      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static org.apache.commons.compress.archivers.zip.ZipConstants.SHORT;[0m      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import static org.apache.commons.compress.archivers.zip.ZipConstants.WORD;[0m       [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import static [0m                                                                   [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipConstants.ZIP64_MAGIC;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.io.PushbackInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.math.BigInteger;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.function.Function;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.util.zip.CRC32;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.util.zip.DataFormatException;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.util.zip.Inflater;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.commons.compress.archivers.ArchiveInputStream;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream;[0m [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.deflate64.Deflate64CompressorInputStream;[0m   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.zstandard.ZstdCompressorInputStream;[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.commons.compress.utils.ArchiveUtils;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.commons.compress.utils.IOUtils;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.commons.compress.utils.InputStreamStatistics;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.commons.io.input.BoundedInputStream;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m632[0m[39m-[0m[1;36m793[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:    public ZipArchiveEntry [0m[1;35mgetNextEntry[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:        return [0m[1;35mgetNextZipEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:     * Gets the next entry.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:     * @return the next entry.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:     * @throws IOException if an I/O error occurs.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:     * @deprecated Use [0m[1;39m{[0m[39m@link #[0m[1;35mgetNextEntry[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[39m.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:    @Deprecated[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:    public ZipArchiveEntry [0m[1;35mgetNextZipEntry[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:        uncompressedCount = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:        boolean firstEntry = true;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:        if [0m[1;39m([0m[39mclosed || hitCentralDirectory[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:        if [0m[1;39m([0m[39mcurrent != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:            [0m[1;35mcloseEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:            firstEntry = false;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:        final long currentHeaderOffset = [0m[1;35mgetBytesRead[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:            if [0m[1;39m([0m[39mfirstEntry[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:                [0m[35m/[0m[35m/[0m[39m split archives have a special signature before the[0m           [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:                [0m[35m/[0m[35m/[0m[39m first local file header - look for it and fail with[0m          [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:                [0m[35m/[0m[35m/[0m[39m the appropriate error message if this is a split[0m             [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:                [0m[35m/[0m[35m/[0m[39m archive.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mreadFirstLocalFileHeader[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:                    hitCentralDirectory = true;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:                    [0m[1;35mskipRemainderOfArchive[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:                    return null;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:                [0m[1;35mreadFully[0m[1;39m([0m[39mlfhBuf[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal EOFException e[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[39m NOSONAR[0m                             [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:        final ZipLong sig = new [0m[1;35mZipLong[0m[1;39m([0m[39mlfhBuf[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35msig.equals[0m[1;39m([0m[39mZipLong.LFH_SIG[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:            if [0m[1;39m([0m[1;35msig.equals[0m[1;39m([0m[39mZipLong.CFH_SIG[0m[1;39m)[0m[39m || [0m[1;35msig.equals[0m[1;39m([0m[39mZipLong.AED_SIG[0m[1;39m)[0m[39m || [0m  [2m                [0m
[2;36m                    [0m         [1;35misApkSigningBlock[0m[1;39m([0m[39mlfhBuf[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:                hitCentralDirectory = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:                [0m[1;35mskipRemainderOfArchive[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:                return null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:            throw new [0m[1;35mZipException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Unexpected record signature: [0m [2m                [0m
[2;36m                    [0m         [32m0x%x"[0m[39m, [0m[1;35msig.getValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:        [0m[35m/[0m[35m/[0m[39m off: go past the signature[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m685[0m[39m:        int off = WORD;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m686[0m[39m:        current = new [0m[1;35mCurrentEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m687[0m[39m:        [0m[35m/[0m[35m/[0m[39m get version[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m688[0m[39m:        final int versionMadeBy = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m689[0m[39m:        off += SHORT;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m690[0m[39m:        [0m[1;35mcurrent.entry.setPlatform[0m[1;39m([0m[1;35mZipFile.toPlatform[0m[1;39m([0m[39mversionMadeBy[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m691[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m692[0m[39m:        final GeneralPurposeBit gpFlag = [0m[1;35mGeneralPurposeBit.parse[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m693[0m[39m:        final boolean hasUTF8Flag = [0m[1;35mgpFlag.usesUTF8ForNames[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m694[0m[39m:        final ZipEncoding entryEncoding = hasUTF8Flag ? [0m                        [2m                [0m
[2;36m                    [0m         [39mZipEncodingHelper.ZIP_ENCODING_UTF_8 : zipEncoding;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m695[0m[39m:        current.hasDataDescriptor = [0m[1;35mgpFlag.usesDataDescriptor[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m696[0m[39m:        [0m[1;35mcurrent.entry.setGeneralPurposeBit[0m[1;39m([0m[39mgpFlag[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m697[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:        off += SHORT;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:        [0m[1;35mcurrent.entry.setMethod[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m701[0m[39m:        off += SHORT;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m702[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m703[0m[39m:        final long time = [0m[1;35mZipUtil.dosToJavaTime[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m704[0m[39m:        [0m[1;35mcurrent.entry.setTime[0m[1;39m([0m[39mtime[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m705[0m[39m:        off += WORD;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:        ZipLong size = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:        ZipLong cSize = null;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:        if [0m[1;39m([0m[39m!current.hasDataDescriptor[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:            [0m[1;35mcurrent.entry.setCrc[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:            off += WORD;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:            cSize = new [0m[1;35mZipLong[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:            off += WORD;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:            size = new [0m[1;35mZipLong[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:            off += WORD;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:            off += [0m[1;36m3[0m[39m * WORD;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:        final int fileNameLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:        off += SHORT;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:        final int extraLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:        off += SHORT; [0m[35m/[0m[35m/[0m[39m NOSONAR - assignment as documentation[0m                  [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m fileName = [0m[1;35mreadRange[0m[1;39m([0m[39mfileNameLen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:        [0m[1;35mcurrent.entry.setName[0m[1;39m([0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m, fileName[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:        if [0m[1;39m([0m[39mhasUTF8Flag[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;35mcurrent.entry.setNameSource[0m[1;39m([0m[39mZipArchiveEntry.NameSource.NAME_WITH_EFS_FLAG[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m extraData = [0m[1;35mreadRange[0m[1;39m([0m[39mextraLen[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:            [0m[1;35mcurrent.entry.setExtra[0m[1;39m([0m[39mextraData[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal RuntimeException ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:            final ZipException z = new [0m[1;35mZipException[0m[1;39m([0m[32m"Invalid extra data in [0m     [2m                [0m
[2;36m                    [0m         [32mentry "[0m[39m + [0m[1;35mcurrent.entry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:            [0m[1;35mz.initCause[0m[1;39m([0m[39mex[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:            throw z;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:        if [0m[1;39m([0m[39m!hasUTF8Flag && useUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:            [0m[1;35mZipUtil.setNameAndCommentFromExtraFields[0m[1;39m([0m[39mcurrent.entry, fileName, [0m  [2m                [0m
[2;36m                    [0m         [39mnull[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:        [0m[1;35mprocessZip64Extra[0m[1;39m([0m[39msize, cSize[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:        [0m[1;35mcurrent.entry.setLocalHeaderOffset[0m[1;39m([0m[39mcurrentHeaderOffset[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:        [0m[1;35mcurrent.entry.setDataOffset[0m[1;39m([0m[1;35mgetBytesRead[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:        [0m[1;35mcurrent.entry.setStreamContiguous[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:        final ZipMethod m = [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mZipMethod.getMethodByCode[0m[1;39m([0m[1;35mcurrent.entry.getMethod[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:        if [0m[1;39m([0m[1;35mcurrent.entry.getCompressedSize[0m[1;39m([0m[1;39m)[0m[39m != ArchiveEntry.SIZE_UNKNOWN[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:            if [0m[1;39m([0m[1;35mZipUtil.canHandleEntryData[0m[1;39m([0m[39mcurrent.entry[0m[1;39m)[0m[39m && m != [0m              [2m                [0m
[2;36m                    [0m         [39mZipMethod.STORED && m != ZipMethod.DEFLATED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:                final InputStream bis = new [0m[1;35mBoundCountInputStream[0m[1;39m([0m[39min, [0m          [2m                [0m
[2;36m                    [0m         [1;35mcurrent.entry.getCompressedSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:                switch [0m[1;39m([0m[39mm[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:                case UNSHRINKING:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:                    current.inputStream = new [0m[1;35mUnshrinkingInputStream[0m[1;39m([0m[39mbis[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:                case IMPLODING:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:                    try [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:                        current.inputStream = new [0m                              [2m                [0m
[2;36m                    [0m         [1;35mExplodingInputStream[0m[1;39m([0m[1;35mcurrent.entry.getGeneralPurposeBit[0m[1;39m([0m[1;39m)[0m[1;35m.getSlidingDictionarySize[0m[1;39m([0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m,[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:                                [0m                                                [2m                [0m
[2;36m                    [0m         [1;35mcurrent.entry.getGeneralPurposeBit[0m[1;39m([0m[1;39m)[0m[1;35m.getNumberOfShannonFanoTrees[0m[1;39m([0m[1;39m)[0m[39m, bis[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal IllegalArgumentException ex[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:                        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"bad IMPLODE data"[0m[39m, ex[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:                case BZIP2:[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:                    current.inputStream = new [0m[1;35mBZip2CompressorInputStream[0m[1;39m([0m[39mbis[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m772[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m773[0m[39m:                case ENHANCED_DEFLATED:[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m774[0m[39m:                    current.inputStream = new [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mDeflate64CompressorInputStream[0m[1;39m([0m[39mbis[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m775[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m776[0m[39m:                case ZSTD:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:                case ZSTD_DEPRECATED:[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:                    current.inputStream = new [0m[1;35mZstdCompressorInputStream[0m[1;39m([0m[39mbis[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:                default:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:                    [0m[35m/[0m[35m/[0m[39m we should never get here as all supported methods have [0m  [2m                [0m
[2;36m                    [0m         [39mbeen covered[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:                    [0m[35m/[0m[35m/[0m[39m will cause an error when read is invoked, don't throw an[0m [2m                [0m
[2;36m                    [0m         [39mexception here so people can[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:                    [0m[35m/[0m[35m/[0m[39m skip unsupported entries[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mm == ZipMethod.ENHANCED_DEFLATED[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:            current.inputStream = new [0m[1;35mDeflate64CompressorInputStream[0m[1;39m([0m[39min[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:        entriesRead++;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:        return current.entry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mRELEASE-NOTES.txt:[0m[1;36m1[0m[39m-[0m[1;36m100[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m2:A[0m[39mpache Commons Compress [0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:Version [0m[1;36m1.27[0m[39m.[0m[1;36m1[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:Release Notes[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m6:A[0m[39mpache Commons Compress defines an API for working with[0m                           [2m                [0m
[2;36m                    [0m         [1;92m7:c[0m[39mompression and archive formats. These include bzip2, gzip, pack200,[0m              [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:LZMA, XZ, Snappy, traditional Unix Compress, DEFLATE, DEFLATE64, LZ4,[0m             [2m                [0m
[2;36m                    [0m         [1;92m9:B[0m[39mrotli, Zstandard and ar, cpio, jar, tar, zip, dump, 7z, arj.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:This is a feature and maintenance release. Java [0m[1;36m8[0m[39m or later is required.[0m          [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m13:C[0m[39mhanges in this version[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:-----------------------[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m16:C[0m[39mhanges in this version include the following.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m19:F[0m[39mixed Bugs[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:----------[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:*  COMPRESS-[0m[1;36m686[0m[39m:  Compression into BZip2 format has unexpected end of file when [0m [2m                [0m
[2;36m                    [0m         [39musing a BufferedOutputStream. Thanks to Richard Blank, Gary Gregory. [0m               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m24:C[0m[39mhanges[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:-------[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:*            Bump org.apache.commons:commons-lang3 from [0m[1;36m3.15[0m[39m.[0m[1;36m0[0m[39m to [0m[1;36m3.16[0m[39m.[0m[1;36m0[0m[39m #[0m[1;36m556[0m[39m. [0m  [2m                [0m
[2;36m                    [0m         [39mThanks to Dependabot, Gary Gregory. [0m                                                [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:Resources[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:---------[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:Historical list of changes: [0m                                                     [2m                [0m
[2;36m                    [0m         [4;94mhttps://commons.apache.org/proper/commons-compress/changes-report.html[0m              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m35:F[0m[39mor complete information on Apache Commons Compress, including instructions on [0m  [2m                [0m
[2;36m                    [0m         [39mhow to submit bug reports,[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:patches, or suggestions for improvement, see the Apache Commons Compress [0m        [2m                [0m
[2;36m                    [0m         [39mwebsite:[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[4;94mhttps://commons.apache.org/proper/commons-compress/[0m                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m40:D[0m[39mownload page: [0m                                                                  [2m                [0m
[2;36m                    [0m         [4;94mhttps://commons.apache.org/proper/commons-compress/download_compress.cgi[0m            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:Have fun![0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:-Apache Commons Team[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:-----------------------------------------------------------------------------[0m    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m47:A[0m[39mpache Commons Compress [0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:Version [0m[1;36m1.27[0m[39m.[0m[1;36m0[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:Release Notes[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m51:A[0m[39mpache Commons Compress defines an API for working with[0m                          [2m                [0m
[2;36m                    [0m         [1;92m52:c[0m[39mompression and archive formats. These include bzip2, gzip, pack200,[0m             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:LZMA, XZ, Snappy, traditional Unix Compress, DEFLATE, DEFLATE64, LZ4,[0m            [2m                [0m
[2;36m                    [0m         [1;92m54:B[0m[39mrotli, Zstandard and ar, cpio, jar, tar, zip, dump, 7z, arj.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:This is a feature and maintenance release. Java [0m[1;36m8[0m[39m or later is required.[0m          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m58:C[0m[39mhanges in this version[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:-----------------------[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m61:C[0m[39mhanges in this version include the following.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:New Features[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:------------[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:*            Add [0m[1;35mArchiveInputStream.forEach[0m[1;39m([0m[39mIOConsumer[0m[1;39m)[0m[39m. Thanks to Gary Gregory.[0m [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:*            Add [0m[1;35mArchiveInputStream.iterator[0m[1;39m([0m[1;39m)[0m[39m. Thanks to Gary Gregory. [0m         [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:*            Add [0m[1;35mArchiveOutputStream.isFinished[0m[1;39m([0m[1;39m)[0m[39m. Thanks to Gary Gregory. [0m      [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:*            Add [0m[1;35mArchiveOutputStream.checkFinished[0m[1;39m([0m[1;39m)[0m[39m. Thanks to Gary Gregory. [0m   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m71:F[0m[39mixed Bugs[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:----------[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:*            Fix PMD UnnecessaryFullyQualifiedName and others. Thanks to Gary [0m   [2m                [0m
[2;36m                    [0m         [39mGregory. [0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:* COMPRESS-[0m[1;36m681[0m[39m: Support reading a 7z file that writing archive properties #[0m[1;36m541[0m[39m. [0m [2m                [0m
[2;36m                    [0m         [39mThanks to joker53-[0m[1;36m1[0m[39m, Gary Gregory. [0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:*            Upgrade commons-io from [0m[1;36m2.15[0m[39m.[0m[1;36m1[0m[39m to [0m[1;36m2.16[0m[39m.[0m[1;36m1[0m[39m #[0m[1;36m513[0m[39m Thanks to Mike Drob, [0m [2m                [0m
[2;36m                    [0m         [39mGary Gregory. [0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:*            CompressorOutputStream now extends FilterOutputStream. Thanks to [0m   [2m                [0m
[2;36m                    [0m         [39mGary Gregory. [0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:*            ArchiveOutputStream now extends FilterOutputStream. Thanks to Gary [0m [2m                [0m
[2;36m                    [0m         [39mGregory. [0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:* COMPRESS-[0m[1;36m685[0m[39m: Update Javadoc description for GzipCompressorInputStream #[0m[1;36m551[0m[39m. [0m  [2m                [0m
[2;36m                    [0m         [39mThanks to Archie L. Cobbs, Gary Gregory. [0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:*            Replace [0m[1;35mFileNameUtil.getCompressedFileName[0m[1;39m([0m[39mString[0m[1;39m)[0m[39m use of [0m          [2m                [0m
[2;36m                    [0m         [39mLocale.ENGLISH with Locale.ROOT. Thanks to Gary Gregory. [0m                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:*            Fix SpotBugs DLS_DEAD_LOCAL_STORE in [0m                               [2m                [0m
[2;36m                    [0m         [1;35mSevenZFile.readPackInfo[0m[1;39m([0m[39mByteBuffer, Archive[0m[1;39m)[0m[39m. Thanks to Gary Gregory. [0m              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:*            Fix SpotBugs NP_NULL_ON_SOME_PATH_FROM_RETURN_VALUE in [0m             [2m                [0m
[2;36m                    [0m         [1;35mZipFile.openZipChannel[0m[1;39m([0m[39mPath, long, OpenOption[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m. Thanks to Gary Gregory. [0m          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:*            Fix SpotBugs UC_USELESS_OBJECT in [0m                                  [2m                [0m
[2;36m                    [0m         [1;35munpack200.CpBands.parseCpSignature[0m[1;39m([0m[39mInputStream[0m[1;39m)[0m[39m. Thanks to Gary Gregory. [0m           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:*            Fix PMD UselessOverridingMethod in [0m                                 [2m                [0m
[2;36m                    [0m         [39munpack200.bytecode.InnerClassesAttribute. Thanks to Gary Gregory. [0m                  [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:*            Fix PMD UselessOverridingMethod in [0m                                 [2m                [0m
[2;36m                    [0m         [39munpack200.bytecode.LineNumberTableAttribute. Thanks to Gary Gregory. [0m               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:*            Fix PMD CheckSkipResult in [0m[1;35mZipArchiveInputStream.closeEntry[0m[1;39m([0m[1;39m)[0m[39m. [0m     [2m                [0m
[2;36m                    [0m         [39mThanks to Gary Gregory. [0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m88:C[0m[39mhanges[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:-------[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:* COMPRESS-[0m[1;36m684[0m[39m: Replace assert with Exception [0m                                   [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:*            Bump org.apache.commons:commons-parent from [0m[1;36m69[0m[39m to [0m[1;36m72[0m[39m #[0m[1;36m537[0m[39m. Thanks [0m  [2m                [0m
[2;36m                    [0m         [39mto Dependabot, Gary Gregory. [0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:*            Bump PMD from [0m[1;36m6.[0m[39mx to [0m[1;36m7.2[0m[39m.[0m[1;36m0[0m[39m. Thanks to Dependabot, Gary Gregory. [0m    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:*            Bump commons-co[0m[1;92mdec:c[0m[39mommons-codec from [0m[1;36m1.17[0m[39m.[0m[1;36m0[0m[39m to [0m[1;36m1.17[0m[39m.[0m[1;36m1[0m[39m #[0m[1;36m544[0m[39m. Thanks[0m [2m                [0m
[2;36m                    [0m         [39mto Dependabot, Gary Gregory. [0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:*            Bump org.apache.commons:commons-lang3 from [0m[1;36m3.14[0m[39m.[0m[1;36m0[0m[39m to [0m[1;36m3.15[0m[39m.[0m[1;36m0[0m[39m #[0m[1;36m545[0m[39m. [0m  [2m                [0m
[2;36m                    [0m         [39mThanks to Dependabot, Gary Gregory. [0m                                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:*            Bump com.github.luben:zstd-jni from [0m[1;36m1.5[0m[39m.[0m[1;36m6[0m[39m-[0m[1;36m3[0m[39m to [0m[1;36m1.5[0m[39m.[0m[1;36m6[0m[39m-[0m[1;36m4[0m[39m #[0m[1;36m548[0m[39m. Thanks[0m [2m                [0m
[2;36m                    [0m         [39mto Dependabot, Gary Gregory. [0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:*            Bump org.tukaani:xz from [0m[1;36m1.9[0m[39m to [0m[1;36m1.10[0m[39m #[0m[1;36m550[0m[39m. Thanks to Dependabot, [0m   [2m                [0m
[2;36m                    [0m         [39mGary Gregory. [0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:*            Bump org.hamcrest:hamcrest from [0m[1;36m2.2[0m[39m to [0m[1;36m3.0[0m[39m #[0m[1;36m552[0m[39m. Thanks to [0m         [2m                [0m
[2;36m                    [0m         [39mDependabot, Gary Gregory. [0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:200[0m[39m-[0m[1;36m350[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:         * @param seekableByteChannel The actual channel.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:         * @return [0m[1;39m{[0m[39m@code this[0m[1;39m}[0m[39m instance.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        public Builder [0m[1;35msetSeekableByteChannel[0m[1;39m([0m[39mfinal SeekableByteChannel [0m        [2m                [0m
[2;36m                    [0m         [39mseekableByteChannel[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            this.seekableByteChannel = seekableByteChannel;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            return this;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[35m/[0m[39m**[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:         * Sets whether to use InfoZIP Unicode Extra Fields [0m[1;39m([0m[39mif present[0m[1;39m)[0m[39m to set[0m [2m                [0m
[2;36m                    [0m         [39mthe file names.[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:         *[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:         * @param useUnicodeExtraFields whether to use InfoZIP Unicode Extra [0m   [2m                [0m
[2;36m                    [0m         [39mFields [0m[1;39m([0m[39mif present[0m[1;39m)[0m[39m to set the file names.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:         * @return [0m[1;39m{[0m[39m@code this[0m[1;39m}[0m[39m instance.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        public Builder [0m[1;35msetUseUnicodeExtraFields[0m[1;39m([0m[39mfinal boolean [0m                  [2m                [0m
[2;36m                    [0m         [39museUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            this.useUnicodeExtraFields = useUnicodeExtraFields;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            return this;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:     * Extends ZipArchiveEntry to store the offset within the archive.[0m          [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    private static final class Entry extends ZipArchiveEntry [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        public boolean [0m[1;35mequals[0m[1;39m([0m[39mfinal Object other[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            if [0m[1;39m([0m[1;35msuper.equals[0m[1;39m([0m[39mother[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[35m/[0m[35m/[0m[39m super.equals would return false if other were not an Entry[0m   [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                final Entry otherEntry = [0m[1;39m([0m[39mEntry[0m[1;39m)[0m[39m other;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                return [0m[1;35mgetLocalHeaderOffset[0m[1;39m([0m[1;39m)[0m[39m == [0m                               [2m                [0m
[2;36m                    [0m         [1;35motherEntry.getLocalHeaderOffset[0m[1;39m([0m[1;39m)[0m[39m && [0m[1;35msuper.getDataOffset[0m[1;39m([0m[1;39m)[0m[39m == [0m                      [2m                [0m
[2;36m                    [0m         [1;35motherEntry.getDataOffset[0m[1;39m([0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                        && [0m[1;35msuper.getDiskNumberStart[0m[1;39m([0m[1;39m)[0m[39m == [0m                       [2m                [0m
[2;36m                    [0m         [1;35motherEntry.getDiskNumberStart[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            return false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:        public int [0m[1;35mhashCode[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:            return [0m[1;36m3[0m[39m * [0m[1;35msuper.hashCode[0m[1;39m([0m[1;39m)[0m[39m + [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m [0m[1;35mgetLocalHeaderOffset[0m[1;39m([0m[1;39m)[0m[39m + [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;35mgetLocalHeaderOffset[0m[1;39m([0m[1;39m)[0m[39m >> [0m[1;36m32[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    private static final class NameAndComment [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:        private final byte[0m[1;39m[[0m[1;39m][0m[39m name;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:        private final byte[0m[1;39m[[0m[1;39m][0m[39m comment;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        private [0m[1;35mNameAndComment[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m name, final byte[0m[1;39m[[0m[1;39m][0m[39m comment[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:            this.name = name;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:            this.comment = comment;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    private static final class StoredStatisticsStream extends [0m                  [2m                [0m
[2;36m                    [0m         [39mBoundedInputStream implements InputStreamStatistics [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:        [0m[1;35mStoredStatisticsStream[0m[1;39m([0m[39mfinal InputStream in[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:            [0m[1;35msuper[0m[1;39m([0m[39min[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:        public long [0m[1;35mgetCompressedCount[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:            return [0m[1;35msuper.getCount[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        public long [0m[1;35mgetUncompressedCount[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:            return [0m[1;35mgetCompressedCount[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:    private static final String DEFAULT_CHARSET_NAME = [0m                         [2m                [0m
[2;36m                    [0m         [1;35mStandardCharsets.UTF_8.name[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:    private static final EnumSet<StandardOpenOption> READ = [0m                    [2m                [0m
[2;36m                    [0m         [1;35mEnumSet.of[0m[1;39m([0m[39mStandardOpenOption.READ[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:    private static final int HASH_SIZE = [0m[1;36m509[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:    static final int NIBLET_MASK = [0m[1;36m0x0f[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:    static final int BYTE_SHIFT = [0m[1;36m8[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:    private static final int POS_0 = [0m[1;36m0[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:    private static final int POS_1 = [0m[1;36m1[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:    private static final int POS_2 = [0m[1;36m2[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:    private static final int POS_3 = [0m[1;36m3[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    private static final byte[0m[1;39m[[0m[1;39m][0m[39m ONE_ZERO_BYTE = new byte[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:     * Length of a [0m[32m"central directory"[0m[39m entry structure without file name, extra[0m [2m                [0m
[2;36m                    [0m         [39mfields or comment.[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:    private static final int CFH_LEN =[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:    [0m[35m/[0m[35m/[0m[39m @formatter:off[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:        [0m[35m/[0m[39m* version made by                 *[0m[35m/[0m[39m ZipConstants.SHORT[0m                [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[39m* version needed to extract       *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        [0m[35m/[0m[39m* general purpose bit flag        *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        [0m[35m/[0m[39m* compression method              *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:        [0m[35m/[0m[39m* last mod file time              *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[35m/[0m[39m* last mod file date              *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        [0m[35m/[0m[39m* CRC-[0m[1;36m32[0m[39m                          *[0m[35m/[0m[39m + ZipConstants.WORD[0m               [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:        [0m[35m/[0m[39m* compressed size                 *[0m[35m/[0m[39m + ZipConstants.WORD[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[35m/[0m[39m* uncompressed size               *[0m[35m/[0m[39m + ZipConstants.WORD[0m               [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        [0m[35m/[0m[39m* file name length                *[0m[35m/[0m[39m + ZipConstants. SHORT[0m             [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:        [0m[35m/[0m[39m* extra field length              *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[35m/[0m[39m* file comment length             *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        [0m[35m/[0m[39m* disk number start               *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:        [0m[35m/[0m[39m* internal file attributes        *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:        [0m[35m/[0m[39m* external file attributes        *[0m[35m/[0m[39m + ZipConstants.WORD[0m               [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        [0m[35m/[0m[39m* relative offset of local header *[0m[35m/[0m[39m + ZipConstants.WORD;[0m              [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:    [0m[35m/[0m[35m/[0m[39m @formatter:on[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:    private static final long CFH_SIG = [0m                                        [2m                [0m
[2;36m                    [0m         [1;35mZipLong.getValue[0m[1;39m([0m[39mZipArchiveOutputStream.CFH_SIG[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:     * Length of the [0m[32m"End of central directory record"[0m[39m - which is supposed to [0m  [2m                [0m
[2;36m                    [0m         [39mbe the last structure of the archive - without file comment.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:    static final int MIN_EOCD_SIZE =[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:    [0m[35m/[0m[35m/[0m[39m @formatter:off[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:        [0m[35m/[0m[39m* end of central dir signature    *[0m[35m/[0m[39m ZipConstants.WORD[0m                 [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:        [0m[35m/[0m[39m* number of this disk             *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:        [0m[35m/[0m[39m* number of the disk with the     *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:        [0m[35m/[0m[39m* start of the central directory  *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[35m/[0m[39m* total number of entries in      *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:        [0m[35m/[0m[39m* the central dir on this disk    *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[35m/[0m[39m* total number of entries in      *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:        [0m[35m/[0m[39m* the central dir                 *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:        [0m[35m/[0m[39m* size of the central directory   *[0m[35m/[0m[39m + ZipConstants.WORD[0m               [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:        [0m[35m/[0m[39m* offset of start of central      *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:        [0m[35m/[0m[39m* directory with respect to       *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:        [0m[35m/[0m[39m* the starting disk number        *[0m[35m/[0m[39m + ZipConstants.WORD[0m               [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:        [0m[35m/[0m[39m* ZIP file comment length         *[0m[35m/[0m[39m + ZipConstants.SHORT;[0m             [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:    [0m[35m/[0m[35m/[0m[39m @formatter:on[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:     * Maximum length of the [0m[32m"End of central directory record"[0m[39m with a file [0m     [2m                [0m
[2;36m                    [0m         [39mcomment.[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:    private static final int MAX_EOCD_SIZE = MIN_EOCD_SIZE[0m                      [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:    [0m[35m/[0m[35m/[0m[39m @formatter:off[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:        [0m[35m/[0m[39m* maximum length of ZIP file comment *[0m[35m/[0m[39m + [0m                             [2m                [0m
[2;36m                    [0m         [39mZipConstants.ZIP64_MAGIC_SHORT;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:    [0m[35m/[0m[35m/[0m[39m @formatter:on[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:     * Offset of the field that holds the location of the length of the central[0m [2m                [0m
[2;36m                    [0m         [39mdirectory inside the [0m[32m"End of central directory record"[0m[39m relative to the start of[0m     [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:     * the [0m[32m"End of central directory record"[0m[39m.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:    private static final int CFD_LENGTH_OFFSET =[0m                                [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:    [0m[35m/[0m[35m/[0m[39m @formatter:off[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:        [0m[35m/[0m[39m* end of central dir signature    *[0m[35m/[0m[39m ZipConstants.WORD[0m                 [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:        [0m[35m/[0m[39m* number of this disk             *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:        [0m[35m/[0m[39m* number of the disk with the     *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:        [0m[35m/[0m[39m* start of the central directory  *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:        [0m[35m/[0m[39m* total number of entries in      *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:        [0m[35m/[0m[39m* the central dir on this disk    *[0m[35m/[0m[39m + ZipConstants.SHORT[0m              [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:        [0m[35m/[0m[39m* total number of entries in      *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:        [0m[35m/[0m[39m* the central dir                 *[0m[35m/[0m[39m + ZipConstants.SHORT;[0m             [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:    [0m[35m/[0m[35m/[0m[39m @formatter:on[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveOutputStream.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:1200[0m[39m-[0m[1;36m1350[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1200[0m[39m:            [0m[1;35mcloseArchiveEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1201[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1202[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1203[0m[39m:        entry = new [0m[1;35mCurrentEntry[0m[1;39m([0m[39marchiveEntry[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1204[0m[39m:        [0m[1;35mentries.add[0m[1;39m([0m[39mentry.entry[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1205[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1206[0m[39m:        [0m[1;35msetDefaults[0m[1;39m([0m[39mentry.entry[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1207[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1208[0m[39m:        final Zip64Mode effectiveMode = [0m[1;35mgetEffectiveZip64Mode[0m[1;39m([0m[39mentry.entry[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m1209[0m[39m:        [0m[1;35mvalidateSizeInformation[0m[1;39m([0m[39meffectiveMode[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1210[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1211[0m[39m:        if [0m[1;39m([0m[1;35mshouldAddZip64Extra[0m[1;39m([0m[39mentry.entry, effectiveMode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1212[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1213[0m[39m:            final Zip64ExtendedInformationExtraField z64 = [0m                    [2m                [0m
[2;36m                    [0m         [1;35mgetZip64Extra[0m[1;39m([0m[39mentry.entry[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1214[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1215[0m[39m:            final ZipEightByteInteger size;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1216[0m[39m:            final ZipEightByteInteger compressedSize;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1217[0m[39m:            if [0m[1;39m([0m[39mphased[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                [0m[35m/[0m[35m/[0m[39m sizes are already known[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                size = new [0m[1;35mZipEightByteInteger[0m[1;39m([0m[1;35mentry.entry.getSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                compressedSize = new [0m                                          [2m                [0m
[2;36m                    [0m         [1;35mZipEightByteInteger[0m[1;39m([0m[1;35mentry.entry.getCompressedSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mentry.entry.getMethod[0m[1;39m([0m[1;39m)[0m[39m == STORED && [0m                   [2m                [0m
[2;36m                    [0m         [1;35mentry.entry.getSize[0m[1;39m([0m[1;39m)[0m[39m != ArchiveEntry.SIZE_UNKNOWN[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                [0m[35m/[0m[35m/[0m[39m actually, we already know the sizes[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                compressedSize = size = new [0m                                   [2m                [0m
[2;36m                    [0m         [1;35mZipEightByteInteger[0m[1;39m([0m[1;35mentry.entry.getSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:                [0m[35m/[0m[35m/[0m[39m just a placeholder, real data will be in data[0m               [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:                [0m[35m/[0m[35m/[0m[39m descriptor or inserted later via SeekableByteChannel[0m        [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:                compressedSize = size = ZipEightByteInteger.ZERO;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:            [0m[1;35mz64.setSize[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:            [0m[1;35mz64.setCompressedSize[0m[1;39m([0m[39mcompressedSize[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1231[0m[39m:            [0m[1;35mentry.entry.setExtra[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1232[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1233[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1234[0m[39m:        if [0m[1;39m([0m[1;35mentry.entry.getMethod[0m[1;39m([0m[1;39m)[0m[39m == DEFLATED && hasCompressionLevelChanged[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1235[0m[39m:            [0m[1;35mdef.setLevel[0m[1;39m([0m[39mlevel[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1236[0m[39m:            hasCompressionLevelChanged = false;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1237[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1238[0m[39m:        [0m[1;35mwriteLocalFileHeader[0m[1;39m([0m[39marchiveEntry, phased[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1239[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1240[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1241[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1242[0m[39m:     * When using random access output, write the local file header and [0m       [2m                [0m
[2;36m                    [0m         [39mpotentially the ZIP64 extra containing the correct CRC and compressed/uncompressed[0m  [2m                [0m
[2;36m                    [0m         [1;36m1243[0m[39m:     * sizes.[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1244[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1245[0m[39m:    private void [0m[1;35mrewriteSizesAndCrc[0m[1;39m([0m[39mfinal boolean actuallyNeedsZip64[0m[1;39m)[0m[39m throws [0m  [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1246[0m[39m:        final RandomAccessOutputStream randomStream = [0m                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mRandomAccessOutputStream[0m[1;39m)[0m[39m out;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1247[0m[39m:        long dataStart = entry.localDataStart;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1248[0m[39m:        if [0m[1;39m([0m[39mrandomStream instanceof ZipSplitOutputStream[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1249[0m[39m:            dataStart = [0m[1;39m([0m[1;39m([0m[39mZipSplitOutputStream[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [39mrandomStream[0m[1;39m)[0m[1;35m.calculateDiskPosition[0m[1;39m([0m[1;35mentry.entry.getDiskNumberStart[0m[1;39m([0m[1;39m)[0m[39m, dataStart[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m1250[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1251[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1252[0m[39m:        long position = dataStart;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1253[0m[39m:        [0m[1;35mrandomStream.writeFully[0m[1;39m([0m[1;35mZipLong.getBytes[0m[1;39m([0m[1;35mentry.entry.getCrc[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mposition[0m[1;39m)[0m[39m; position += ZipConstants.WORD;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1254[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mhasZip64Extra[0m[1;39m([0m[39mentry.entry[0m[1;39m)[0m[39m || !actuallyNeedsZip64[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m1255[0m[39m:            [0m                                                                   [2m                [0m
[2;36m                    [0m         [1;35mrandomStream.writeFully[0m[1;39m([0m[1;35mZipLong.getBytes[0m[1;39m([0m[1;35mentry.entry.getCompressedSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [39mposition[0m[1;39m)[0m[39m; position += ZipConstants.WORD;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1256[0m[39m:            [0m[1;35mrandomStream.writeFully[0m[1;39m([0m[1;35mZipLong.getBytes[0m[1;39m([0m[1;35mentry.entry.getSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [39mposition[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1257[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1258[0m[39m:            [0m[1;35mrandomStream.writeFully[0m[1;39m([0m[1;35mZipLong.ZIP64_MAGIC.getBytes[0m[1;39m([0m[1;39m)[0m[39m, position[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [39mposition += ZipConstants.WORD;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1259[0m[39m:            [0m[1;35mrandomStream.writeFully[0m[1;39m([0m[1;35mZipLong.ZIP64_MAGIC.getBytes[0m[1;39m([0m[1;39m)[0m[39m, position[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m1260[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1261[0m[39m:        position += ZipConstants.WORD;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1262[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1263[0m[39m:        if [0m[1;39m([0m[1;35mhasZip64Extra[0m[1;39m([0m[39mentry.entry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1264[0m[39m:            final ByteBuffer name = [0m[1;35mgetName[0m[1;39m([0m[39mentry.entry[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1265[0m[39m:            final int nameLen = [0m[1;35mname.limit[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;35mname.position[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1266[0m[39m:            [0m[35m/[0m[35m/[0m[39m seek to ZIP64 extra, skip header and size information[0m           [2m                [0m
[2;36m                    [0m         [1;36m1267[0m[39m:            position = dataStart + [0m[1;36m3[0m[39m * ZipConstants.WORD + [0m[1;36m2[0m[39m * [0m                [2m                [0m
[2;36m                    [0m         [39mZipConstants.SHORT + nameLen + [0m[1;36m2[0m[39m * ZipConstants.SHORT;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1268[0m[39m:            [0m[35m/[0m[35m/[0m[39m inside the ZIP64 extra uncompressed size comes[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1269[0m[39m:            [0m[35m/[0m[35m/[0m[39m first, unlike the LFH, CD or data descriptor[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1270[0m[39m:            [0m                                                                   [2m                [0m
[2;36m                    [0m         [1;35mrandomStream.writeFully[0m[1;39m([0m[1;35mZipEightByteInteger.getBytes[0m[1;39m([0m[1;35mentry.entry.getSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mposition[0m[1;39m)[0m[39m; position += ZipConstants.DWORD;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1271[0m[39m:            [0m                                                                   [2m                [0m
[2;36m                    [0m         [1;35mrandomStream.writeFully[0m[1;39m([0m[1;35mZipEightByteInteger.getBytes[0m[1;39m([0m[1;35mentry.entry.getCompressedSize[0m[1;39m([0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m[1;39m)[0m[39m, position[0m[1;39m)[0m[39m; position += ZipConstants.DWORD;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1272[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1273[0m[39m:            if [0m[1;39m([0m[39m!actuallyNeedsZip64[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1274[0m[39m:                [0m[35m/[0m[35m/[0m[39m do some cleanup:[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1275[0m[39m:                [0m[35m/[0m[35m/[0m[39m * rewrite version needed to extract[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1276[0m[39m:                position = dataStart - [0m[1;36m5[0m[39m * ZipConstants.SHORT;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1277[0m[39m:                [0m                                                               [2m                [0m
[2;36m                    [0m         [1;35mrandomStream.writeFully[0m[1;39m([0m[1;35mZipShort.getBytes[0m[1;39m([0m[1;35mversionNeededToExtract[0m[1;39m([0m[1;35mentry.entry.getMet[0m [2m                [0m
[2;36m                    [0m         [1;35mhod[0m[1;39m([0m[1;39m)[0m[39m, false, false[0m[1;39m)[0m[1;39m)[0m[39m, position[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1278[0m[39m:                position += ZipConstants.SHORT;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1279[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1280[0m[39m:                [0m[35m/[0m[35m/[0m[39m * remove ZIP64 extra, so it doesn't get written[0m             [2m                [0m
[2;36m                    [0m         [1;36m1281[0m[39m:                [0m[35m/[0m[35m/[0m[39m to the central directory[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1282[0m[39m:                [0m                                                               [2m                [0m
[2;36m                    [0m         [1;35mentry.entry.removeExtraField[0m[1;39m([0m[39mZip64ExtendedInformationExtraField.[0m[1;33mHEAD[0m[39mER_ID[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1283[0m[39m:                [0m[1;35mentry.entry.setExtra[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1284[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1285[0m[39m:                [0m[35m/[0m[35m/[0m[39m * reset hasUsedZip64 if it has been set because[0m             [2m                [0m
[2;36m                    [0m         [1;36m1286[0m[39m:                [0m[35m/[0m[35m/[0m[39m of this entry[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1287[0m[39m:                if [0m[1;39m([0m[39mentry.causedUseOfZip64[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1288[0m[39m:                    hasUsedZip64 = false;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1289[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1290[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1291[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1292[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1293[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1294[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1295[0m[39m:     * Sets the file comment.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1296[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1297[0m[39m:     * @param comment the comment[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1298[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1299[0m[39m:    public void [0m[1;35msetComment[0m[1;39m([0m[39mfinal String comment[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1300[0m[39m:        this.comment = comment;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1301[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1302[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1303[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1304[0m[39m:     * Whether to create Unicode Extra Fields.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1305[0m[39m:     * <p>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1306[0m[39m:     * Defaults to NEVER.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1307[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1308[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1309[0m[39m:     * @param b whether to create Unicode Extra Fields.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1310[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1311[0m[39m:    public void [0m[1;35msetCreateUnicodeExtraFields[0m[1;39m([0m[39mfinal UnicodeExtraFieldPolicy b[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m1312[0m[39m:        createUnicodeExtraFields = b;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1313[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1314[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1315[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1316[0m[39m:     * Provides default values for compression method and last modification [0m   [2m                [0m
[2;36m                    [0m         [39mtime.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1317[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1318[0m[39m:    private void [0m[1;35msetDefaults[0m[1;39m([0m[39mfinal ZipArchiveEntry entry[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1319[0m[39m:        if [0m[1;39m([0m[1;35mentry.getMethod[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[39m not specified[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1320[0m[39m:            [0m[1;35mentry.setMethod[0m[1;39m([0m[39mmethod[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1321[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1322[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1323[0m[39m:        if [0m[1;39m([0m[1;35mentry.getTime[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[39m not specified[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1324[0m[39m:            [0m[1;35mentry.setTime[0m[1;39m([0m[1;35mSystem.currentTimeMillis[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1325[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1326[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1327[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1328[0m[39m:    private void [0m[1;35msetEncoding[0m[1;39m([0m[39mfinal Charset encoding[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1329[0m[39m:        this.charset = encoding;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1330[0m[39m:        this.zipEncoding = [0m[1;35mZipEncodingHelper.getZipEncoding[0m[1;39m([0m[39mencoding[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1331[0m[39m:        if [0m[1;39m([0m[39museUtf8Flag && ![0m[1;35mZipEncodingHelper.isUTF8[0m[1;39m([0m[39mencoding[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m1332[0m[39m:            useUtf8Flag = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1333[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1334[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1335[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1336[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1337[0m[39m:     * The encoding to use for file names and the file comment.[0m                [2m                [0m
[2;36m                    [0m         [1;36m1338[0m[39m:     * <p>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1339[0m[39m:     * For a list of possible values see <a [0m                                   [2m                [0m
[2;36m                    [0m         [33mhref[0m[39m=[0m[32m"https[0m[32m://docs.oracle.com/javase/8/docs/technotes/guides/intl/encoding.doc.html[0m [2m                [0m
[2;36m                    [0m         [32m"[0m[39m>Supported Encodings<[0m[35m/[0m[95ma[0m[39m>.[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1340[0m[39m:     * Defaults to UTF-[0m[1;36m8[0m[39m.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1341[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1342[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1343[0m[39m:     * @param encoding the encoding to use for file names, use null for the [0m   [2m                [0m
[2;36m                    [0m         [39mplatform's default encoding[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1344[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1345[0m[39m:    public void [0m[1;35msetEncoding[0m[1;39m([0m[39mfinal String encoding[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1346[0m[39m:        [0m[1;35msetEncoding[0m[1;39m([0m[1;35mCharsets.toCharset[0m[1;39m([0m[39mencoding[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1347[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1348[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1349[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1350[0m[39m:     * Whether to fall back to UTF and the language encoding flag if the file [0m [2m                [0m
[2;36m                    [0m         [39mname cannot be encoded using the specified encoding.[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/zip/ZipFileTest.jav[0m[1;92ma:1[0m[39m-[0m[1;36m100[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.commons.compress.archivers.zip;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import static org.junit.jupiter.api.Assertions.assertArrayEquals;[0m                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;[0m               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import static org.junit.jupiter.api.Assertions.assertEquals;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import static org.junit.jupiter.api.Assertions.assertFalse;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import static org.junit.jupiter.api.Assertions.assertNotEquals;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import static org.junit.jupiter.api.Assertions.assertNotNull;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import static org.junit.jupiter.api.Assertions.assertNull;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import static org.junit.jupiter.api.Assertions.assertThrows;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import static org.junit.jupiter.api.Assertions.assertTrue;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import static org.junit.jupiter.api.Assertions.fail;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import java.util.TreeMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import java.util.concurrent.atomic.AtomicInteger;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import java.util.zip.CRC32;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import java.util.zip.Deflater;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:import org.apache.commons.compress.AbstractTest;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:import org.apache.commons.compress.utils.ByteUtils;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:import org.apache.commons.compress.utils.SeekableInMemoryByteChannel;[0m            [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:import org.apache.commons.io.FilenameUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:import org.apache.commons.io.function.IORunnable;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:import org.apache.commons.lang3.ArrayFill;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:import org.apache.commons.lang3.SystemUtils;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:import org.junit.Assume;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:import org.junit.jupiter.api.AfterEach;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:import org.junit.jupiter.api.Assumptions;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:import org.junit.jupiter.api.Test;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:import org.junit.jupiter.api.io.TempDir;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:public class ZipFileTest extends AbstractTest [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    private static final int OUT_OF_MEMORY = [0m[1;36m137[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private static void [0m[1;35massertEntryName[0m[1;39m([0m[39mfinal ArrayList<ZipArchiveEntry> [0m        [2m                [0m
[2;36m                    [0m         [39mentries, final int index, final String expectedName[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final ZipArchiveEntry ze = [0m[1;35mentries.get[0m[1;39m([0m[39mindex[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"src/main/java/org/apache/commons/compress/archivers/zip/"[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m+ expectedName + [0m[32m".java"[0m[39m, [0m[1;35mze.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private static void [0m[1;35mnameSource[0m[1;39m([0m[39mfinal String archive, final String entry, [0m    [2m                [0m
[2;36m                    [0m         [39mfinal ZipArchiveEntry.NameSource expected[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        try [0m[1;39m([0m[39mZipFile zf = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[1;35mgetFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            final ZipArchiveEntry ze = [0m[1;35mzf.getEntry[0m[1;39m([0m[39mentry[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            [0m[1;35massertEquals[0m[1;39m([0m[39mentry, [0m[1;35mze.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            [0m[1;35massertEquals[0m[1;39m([0m[39mexpected, [0m[1;35mze.getNameSource[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    private ZipFile zf;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    private void [0m[1;35massertAllReadMethods[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m expected, final ZipFile [0m      [2m                [0m
[2;36m                    [0m         [39mzipFile, final ZipArchiveEntry entry[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[35m/[0m[35m/[0m[39m simple IOUtil read[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        try [0m[1;39m([0m[39mInputStream stream = [0m[1;35mzf.getInputStream[0m[1;39m([0m[39mentry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            final byte[0m[1;39m[[0m[1;39m][0m[39m full = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            [0m[1;35massertArrayEquals[0m[1;39m([0m[39mexpected, full[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[35m/[0m[35m/[0m[39m big buffer at the beginning and then chunks by IOUtils read[0m           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        try [0m[1;39m([0m[39mInputStream stream = [0m[1;35mzf.getInputStream[0m[1;39m([0m[39mentry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            final byte[0m[1;39m[[0m[1;39m][0m[39m full;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/zip/ZipFileTest.jav[0m[1;92ma:400[0m[39m-[0m[1;36m500[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:                [0m[1;35minflatedEntry.setMethod[0m[1;39m([0m[39mZipEntry.DEFLATED[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:                [0m[1;35minflatedEntry.setAlignment[0m[1;39m([0m[1;36m1024[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:                [0m[1;35mzipOutput.putArchiveEntry[0m[1;39m([0m[39minflatedEntry[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:                [0m[1;35mzipOutput.writeUtf8[0m[1;39m([0m[32m"Hello Deflated\n"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:                [0m[1;35mzipOutput.closeArchiveEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:                final ZipArchiveEntry storedEntry = new [0m                        [2m                [0m
[2;36m                    [0m         [1;35mZipArchiveEntry[0m[1;39m([0m[32m"stored.txt"[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:                [0m[1;35mstoredEntry.setMethod[0m[1;39m([0m[39mZipEntry.STORED[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:                [0m[1;35mstoredEntry.setAlignment[0m[1;39m([0m[1;36m1024[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:                [0m[1;35mzipOutput.putArchiveEntry[0m[1;39m([0m[39mstoredEntry[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:                [0m[1;35mzipOutput.writeUtf8[0m[1;39m([0m[32m"Hello Stored\n"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:                [0m[1;35mzipOutput.closeArchiveEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:                final ZipArchiveEntry storedEntry2 = new [0m                       [2m                [0m
[2;36m                    [0m         [1;35mZipArchiveEntry[0m[1;39m([0m[32m"stored2.txt"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:                [0m[1;35mstoredEntry2.setMethod[0m[1;39m([0m[39mZipEntry.STORED[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:                [0m[1;35mstoredEntry2.setAlignment[0m[1;39m([0m[1;36m1024[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:                [0m[1;35mstoredEntry2.addExtraField[0m[1;39m([0m[39mnew [0m[1;35mResourceAlignmentExtraField[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:                [0m[1;35mzipOutput.putArchiveEntry[0m[1;39m([0m[39mstoredEntry2[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:                [0m[1;35mzipOutput.writeUtf8[0m[1;39m([0m[32m"Hello overload-alignment Stored\n"[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:                [0m[1;35mzipOutput.closeArchiveEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:                final ZipArchiveEntry storedEntry3 = new [0m                       [2m                [0m
[2;36m                    [0m         [1;35mZipArchiveEntry[0m[1;39m([0m[32m"stored3.txt"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:                [0m[1;35mstoredEntry3.setMethod[0m[1;39m([0m[39mZipEntry.STORED[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:                [0m[1;35mstoredEntry3.addExtraField[0m[1;39m([0m[39mnew [0m                                 [2m                [0m
[2;36m                    [0m         [1;35mResourceAlignmentExtraField[0m[1;39m([0m[1;36m1024[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:                [0m[1;35mzipOutput.putArchiveEntry[0m[1;39m([0m[39mstoredEntry3[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:                [0m[1;35mzipOutput.writeUtf8[0m[1;39m([0m[32m"Hello copy-alignment Stored\n"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:                [0m[1;35mzipOutput.closeArchiveEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:            try [0m[1;39m([0m[39mZipFile zf = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[1;35mArrays.copyOfRange[0m[1;39m([0m[1;35mzipContent.array[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [1;35mzipContent.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:                final ZipArchiveEntry inflatedEntry = [0m                          [2m                [0m
[2;36m                    [0m         [1;35mzf.getEntry[0m[1;39m([0m[32m"inflated.txt"[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:                final ResourceAlignmentExtraField inflatedAlignmentEx = [0m        [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mResourceAlignmentExtraField[0m[1;39m)[0m[39m inflatedEntry[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:                        [0m[1;35m.getExtraField[0m[1;39m([0m[39mResourceAlignmentExtraField.ID[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:                [0m[1;35massertNotEquals[0m[1;39m([0m[39m-1L, [0m[1;35minflatedEntry.getCompressedSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:                [0m[1;35massertNotEquals[0m[1;39m([0m[39m-1L, [0m[1;35minflatedEntry.getSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:                [0m[1;35massertEquals[0m[1;39m([0m[39m0L, [0m[1;35minflatedEntry.getDataOffset[0m[1;39m([0m[1;39m)[0m[39m % [0m[1;36m1024[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:                [0m[1;35massertNotNull[0m[1;39m([0m[39minflatedAlignmentEx[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:                [0m[1;35massertEquals[0m[1;39m([0m[1;36m1024[0m[39m, [0m[1;35minflatedAlignmentEx.getAlignment[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:                [0m[1;35massertFalse[0m[1;39m([0m[1;35minflatedAlignmentEx.allowMethodChange[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:                try [0m[1;39m([0m[39mInputStream stream = [0m[1;35mzf.getInputStream[0m[1;39m([0m[39minflatedEntry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:                    [0m[1;35massertEquals[0m[1;39m([0m[32m"Hello Deflated\n"[0m[39m, new [0m                       [2m                [0m
[2;36m                    [0m         [1;35mString[0m[1;39m([0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m, UTF_8[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:                final ZipArchiveEntry storedEntry = [0m[1;35mzf.getEntry[0m[1;39m([0m[32m"stored.txt"[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:                final ResourceAlignmentExtraField storedAlignmentEx = [0m          [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mResourceAlignmentExtraField[0m[1;39m)[0m[39m [0m                                                      [2m                [0m
[2;36m                    [0m         [1;35mstoredEntry.getExtraField[0m[1;39m([0m[39mResourceAlignmentExtraField.ID[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:                [0m[1;35massertNotEquals[0m[1;39m([0m[39m-1L, [0m[1;35mstoredEntry.getCompressedSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:                [0m[1;35massertNotEquals[0m[1;39m([0m[39m-1L, [0m[1;35mstoredEntry.getSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:                [0m[1;35massertEquals[0m[1;39m([0m[39m0L, [0m[1;35mstoredEntry.getDataOffset[0m[1;39m([0m[1;39m)[0m[39m % [0m[1;36m1024[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:                [0m[1;35massertNotNull[0m[1;39m([0m[39mstoredAlignmentEx[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:                [0m[1;35massertEquals[0m[1;39m([0m[1;36m1024[0m[39m, [0m[1;35mstoredAlignmentEx.getAlignment[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:                [0m[1;35massertFalse[0m[1;39m([0m[1;35mstoredAlignmentEx.allowMethodChange[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m451[0m[39m:                try [0m[1;39m([0m[39mInputStream stream = [0m[1;35mzf.getInputStream[0m[1;39m([0m[39mstoredEntry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m452[0m[39m:                    [0m[1;35massertEquals[0m[1;39m([0m[32m"Hello Stored\n"[0m[39m, new [0m                         [2m                [0m
[2;36m                    [0m         [1;35mString[0m[1;39m([0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m, UTF_8[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m453[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m454[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m455[0m[39m:                final ZipArchiveEntry storedEntry2 = [0m                           [2m                [0m
[2;36m                    [0m         [1;35mzf.getEntry[0m[1;39m([0m[32m"stored2.txt"[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m456[0m[39m:                final ResourceAlignmentExtraField stored2AlignmentEx = [0m         [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mResourceAlignmentExtraField[0m[1;39m)[0m[39m [0m                                                      [2m                [0m
[2;36m                    [0m         [1;35mstoredEntry2.getExtraField[0m[1;39m([0m[39mResourceAlignmentExtraField.ID[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m457[0m[39m:                [0m[1;35massertNotEquals[0m[1;39m([0m[39m-1L, [0m[1;35mstoredEntry2.getCompressedSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m458[0m[39m:                [0m[1;35massertNotEquals[0m[1;39m([0m[39m-1L, [0m[1;35mstoredEntry2.getSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:                [0m[1;35massertEquals[0m[1;39m([0m[39m0L, [0m[1;35mstoredEntry2.getDataOffset[0m[1;39m([0m[1;39m)[0m[39m % [0m[1;36m1024[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:                [0m[1;35massertNotNull[0m[1;39m([0m[39mstored2AlignmentEx[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:                [0m[1;35massertEquals[0m[1;39m([0m[1;36m1024[0m[39m, [0m[1;35mstored2AlignmentEx.getAlignment[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:                [0m[1;35massertFalse[0m[1;39m([0m[1;35mstored2AlignmentEx.allowMethodChange[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m463[0m[39m:                try [0m[1;39m([0m[39mInputStream stream = [0m[1;35mzf.getInputStream[0m[1;39m([0m[39mstoredEntry2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m464[0m[39m:                    [0m[1;35massertEquals[0m[1;39m([0m[32m"Hello overload-alignment Stored\n"[0m[39m, new [0m      [2m                [0m
[2;36m                    [0m         [1;35mString[0m[1;39m([0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m, UTF_8[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m465[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:                final ZipArchiveEntry storedEntry3 = [0m                           [2m                [0m
[2;36m                    [0m         [1;35mzf.getEntry[0m[1;39m([0m[32m"stored3.txt"[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:                final ResourceAlignmentExtraField stored3AlignmentEx = [0m         [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mResourceAlignmentExtraField[0m[1;39m)[0m[39m [0m                                                      [2m                [0m
[2;36m                    [0m         [1;35mstoredEntry3.getExtraField[0m[1;39m([0m[39mResourceAlignmentExtraField.ID[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:                [0m[1;35massertNotEquals[0m[1;39m([0m[39m-1L, [0m[1;35mstoredEntry3.getCompressedSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:                [0m[1;35massertNotEquals[0m[1;39m([0m[39m-1L, [0m[1;35mstoredEntry3.getSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:                [0m[1;35massertEquals[0m[1;39m([0m[39m0L, [0m[1;35mstoredEntry3.getDataOffset[0m[1;39m([0m[1;39m)[0m[39m % [0m[1;36m1024[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:                [0m[1;35massertNotNull[0m[1;39m([0m[39mstored3AlignmentEx[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:                [0m[1;35massertEquals[0m[1;39m([0m[1;36m1024[0m[39m, [0m[1;35mstored3AlignmentEx.getAlignment[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:                [0m[1;35massertFalse[0m[1;39m([0m[1;35mstored3AlignmentEx.allowMethodChange[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:                try [0m[1;39m([0m[39mInputStream stream = [0m[1;35mzf.getInputStream[0m[1;39m([0m[39mstoredEntry3[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:                    [0m[1;35massertEquals[0m[1;39m([0m[32m"Hello copy-alignment Stored\n"[0m[39m, new [0m          [2m                [0m
[2;36m                    [0m         [1;35mString[0m[1;39m([0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m, UTF_8[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:     * Test too big alignment, resulting into exceeding extra field limit.[0m      [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:    public void [0m[1;35mtestEntryAlignmentExceed[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:        try [0m[1;39m([0m[39mSeekableInMemoryByteChannel zipContent = new [0m                      [2m                [0m
[2;36m                    [0m         [1;35mSeekableInMemoryByteChannel[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                ZipArchiveOutputStream zipOutput = new [0m                         [2m                [0m
[2;36m                    [0m         [1;35mZipArchiveOutputStream[0m[1;39m([0m[39mzipContent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:            final ZipArchiveEntry inflatedEntry = new [0m                          [2m                [0m
[2;36m                    [0m         [1;35mZipArchiveEntry[0m[1;39m([0m[32m"inflated.txt"[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;35minflatedEntry.setMethod[0m[1;39m([0m[39mZipEntry.STORED[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIllegalArgumentException.class, [0m[1;39m([0m[1;39m)[0m[39m -> [0m                 [2m                [0m
[2;36m                    [0m         [1;35minflatedEntry.setAlignment[0m[1;39m([0m[1;36m0x20000[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:     * @see [0m[32m"https://issues.apache.org/jira/browse/COMPRESS-228"[0m                [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:    public void [0m[1;35mtestExcessDataInZip64ExtraField[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:        final File archive = [0m[1;35mgetFile[0m[1;39m([0m[32m"COMPRESS-228.zip"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/utils/ArchiveUtils.jav[0m[1;92ma:22[0m[39m-[0m[1;36m26[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static java.nio.charset.StandardCharsets.US_ASCII;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/utils/ArchiveUtils.jav[0m[1;92ma:188[0m[39m-[0m[1;36m206[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    public static String [0m[1;35msanitize[0m[1;39m([0m[39mfinal String s[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        final char[0m[1;39m[[0m[1;39m][0m[39m cs = [0m[1;35ms.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        final char[0m[1;39m[[0m[1;39m][0m[39m chars = cs.length <= MAX_SANITIZED_NAME_LENGTH ? cs : [0m     [2m                [0m
[2;36m                    [0m         [1;35mArrays.copyOf[0m[1;39m([0m[39mcs, MAX_SANITIZED_NAME_LENGTH[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        if [0m[1;39m([0m[39mcs.length > MAX_SANITIZED_NAME_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            [0m[1;35mArrays.fill[0m[1;39m([0m[39mchars, MAX_SANITIZED_NAME_LENGTH - [0m[1;36m3[0m[39m, [0m                  [2m                [0m
[2;36m                    [0m         [39mMAX_SANITIZED_NAME_LENGTH, [0m[32m'.'[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        final StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        for [0m[1;39m([0m[39mfinal char c : chars[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mCharacter.isISOControl[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                final Character.UnicodeBlock block = [0m                           [2m                [0m
[2;36m                    [0m         [1;35mCharacter.UnicodeBlock.of[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                if [0m[1;39m([0m[39mblock != null && block != Character.UnicodeBlock.SPECIALS[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:                    [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                    continue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[32m'?'[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        return [0m[1;35msb.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:1[0m[39m-[0m[1;36m50[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.zip;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.LinkOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.file.attribute.FileTime;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.NoSuchElementException;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.function.Function;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.EntryStreamOffsets;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.utils.ByteUtils;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.io.file.attribute.FileTimes;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m: * Extension that adds better handling of extra fields and provides access to [0m   [2m                [0m
[2;36m                    [0m         [39mthe internal and external file attributes.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m: * The extra data is expected to follow the recommendation of <a [0m                [2m                [0m
[2;36m                    [0m         [33mhref[0m[39m=[0m[32m"http[0m[32m://www.pkware.com/documents/casestudies/APPNOTE.TXT"[0m[39m>APPNOTE.TXT<[0m[35m/[0m[95ma[0m[39m>:[0m     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m: * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m: * <ul>[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:600[0m[39m-[0m[1;36m70[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:                && [0m[1;35mArrays.equals[0m[1;39m([0m[1;35mgetLocalFileDataExtra[0m[1;39m([0m[1;39m)[0m[39m, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mother.getLocalFileDataExtra[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m && localHeaderOffset == other.localHeaderOffset[0m      [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:                && dataOffset == other.dataOffset && [0m                           [2m                [0m
[2;36m                    [0m         [1;35mgeneralPurposeBit.equals[0m[1;39m([0m[39mother.generalPurposeBit[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m602[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m603[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m604[0m[39m:    private ZipExtraField [0m[1;35mfindMatching[0m[1;39m([0m[39mfinal ZipShort headerId, final [0m          [2m                [0m
[2;36m                    [0m         [39mList<ZipExtraField> fs[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m605[0m[39m:        return [0m[1;35mfs.stream[0m[1;39m([0m[1;39m)[0m[1;35m.filter[0m[1;39m([0m[39mf -> [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mheaderId.equals[0m[1;39m([0m[1;35mf.getHeaderId[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;35m.findFirst[0m[1;39m([0m[1;39m)[0m[1;35m.orElse[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m606[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m607[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m608[0m[39m:    private ZipExtraField [0m[1;35mfindUnparseable[0m[1;39m([0m[39mfinal List<ZipExtraField> fs[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m609[0m[39m:        return [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;35mfs.stream[0m[1;39m([0m[1;39m)[0m[1;35m.filter[0m[1;39m([0m[39mUnparseableExtraFieldData.class::isInstance[0m[1;39m)[0m[1;35m.findFirst[0m[1;39m([0m[1;39m)[0m[1;35m.orElse[0m[1;39m([0m [2m                [0m
[2;36m                    [0m         [39mnull[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m610[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m611[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m612[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m613[0m[39m:     * Gets currently configured alignment.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m614[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m615[0m[39m:     * @return alignment for this entry.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m616[0m[39m:     * @since [0m[1;36m1.14[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m617[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m618[0m[39m:    protected int [0m[1;35mgetAlignment[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m619[0m[39m:        return this.alignment;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m620[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m621[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m622[0m[39m:    private ZipExtraField[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetAllExtraFields[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m623[0m[39m:        final ZipExtraField[0m[1;39m[[0m[1;39m][0m[39m allExtraFieldsNoCopy = [0m[1;35mgetAllExtraFieldsNoCopy[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m624[0m[39m:        return allExtraFieldsNoCopy == extraFields ? [0m                           [2m                [0m
[2;36m                    [0m         [1;35mcopyOf[0m[1;39m([0m[39mallExtraFieldsNoCopy, allExtraFieldsNoCopy.length[0m[1;39m)[0m[39m : allExtraFieldsNoCopy;[0m   [2m                [0m
[2;36m                    [0m         [1;36m625[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m626[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m628[0m[39m:     * Gets all extra fields, including unparseable ones.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m629[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m630[0m[39m:     * @return An array of all extra fields. Not necessarily a copy of internal[0m [2m                [0m
[2;36m                    [0m         [39mdata structures, hence private method[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m631[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:    private ZipExtraField[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetAllExtraFieldsNoCopy[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:        if [0m[1;39m([0m[39mextraFields == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:            return [0m[1;35mgetUnparseableOnly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:        return unparseableExtra != null ? [0m[1;35mgetMergedFields[0m[1;39m([0m[1;39m)[0m[39m : extraFields;[0m      [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:     * Retrieves the extra data for the central directory.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:     * @return the central directory extra data[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:    public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetCentralDirectoryExtra[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:        return [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;35mExtraFieldUtils.mergeCentralDirectoryData[0m[1;39m([0m[1;35mgetAllExtraFieldsNoCopy[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:     * The source of the comment field value.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:     * @return source of the comment field value[0m                                [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:     * @since [0m[1;36m1.16[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:    public CommentSource [0m[1;35mgetCommentSource[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:        return commentSource;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:    public long [0m[1;35mgetDataOffset[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:        return dataOffset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:     * The number of the split segment this entry starts at.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:     * @return the number of the split segment this entry starts at.[0m            [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:     * @since [0m[1;36m1.20[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:    public long [0m[1;35mgetDiskNumberStart[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:        return diskNumberStart;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:     * Retrieves the external file attributes.[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:     * <strong>Note<[0m[35m/[0m[95mstrong[0m[39m>: [0m[1;39m{[0m[39m@link ZipArchiveInputStream[0m[1;39m}[0m[39m is unable to fill [0m  [2m                [0m
[2;36m                    [0m         [39mthis field, you must use [0m[1;39m{[0m[39m@link ZipFile[0m[1;39m}[0m[39m if you want to read entries using this[0m     [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:     * attribute.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:     * @return the external file attributes[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:    public long [0m[1;35mgetExternalAttributes[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:        return externalAttributes;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m685[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m686[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m687[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m688[0m[39m:     * Gets an extra field by its header id.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m689[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m690[0m[39m:     * @param type the header id[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m691[0m[39m:     * @return null if no such field exists.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m692[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m693[0m[39m:    public ZipExtraField [0m[1;35mgetExtraField[0m[1;39m([0m[39mfinal ZipShort type[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m694[0m[39m:        if [0m[1;39m([0m[39mextraFields != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m695[0m[39m:            for [0m[1;39m([0m[39mfinal ZipExtraField extraField : extraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m696[0m[39m:                if [0m[1;39m([0m[1;35mtype.equals[0m[1;39m([0m[1;35mextraField.getHeaderId[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m697[0m[39m:                    return extraField;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1[0m[39m-[0m[1;36m100[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.zip;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.SequenceInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.nio.ByteOrder;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.nio.file.OpenOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import java.util.Comparator;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import java.util.EnumSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import java.util.stream.Collectors;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import java.util.stream.IntStream;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import java.util.zip.Inflater;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.apache.commons.compress.archivers.EntryStreamOffsets;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:import org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream;[0m [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.deflate64.Deflate64CompressorInputStream;[0m   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:import org.apache.commons.compress.compressors.xz.XZCompressorInputStream;[0m       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.zstandard.ZstdCompressorInputStream;[0m        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:import org.apache.commons.compress.utils.BoundedArchiveInputStream;[0m              [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:import org.apache.commons.compress.utils.BoundedSeekableByteChannelInputStream;[0m  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:import org.apache.commons.compress.utils.IOUtils;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:import org.apache.commons.compress.utils.InputStreamStatistics;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:import org.apache.commons.compress.utils.SeekableInMemoryByteChannel;[0m            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:import org.apache.commons.io.Charsets;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:import org.apache.commons.io.FilenameUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:import org.apache.commons.io.build.AbstractOrigin.ByteArrayOrigin;[0m               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:import org.apache.commons.io.build.AbstractStreamBuilder;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:import org.apache.commons.io.function.IOStream;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:import org.apache.commons.io.input.BoundedInputStream;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m: * Replacement for [0m[1;39m{[0m[39m@link java.util.zip.ZipFile[0m[1;39m}[0m[39m.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m: * This class adds support for file name encodings other than UTF-[0m[1;36m8[0m[39m [0m[1;39m([0m[39mwhich is [0m   [2m                [0m
[2;36m                    [0m         [39mrequired to work on ZIP files created by native ZIP tools and is able to skip a[0m     [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m: * preamble like the one found in self extracting archives. Furthermore it [0m      [2m                [0m
[2;36m                    [0m         [39mreturns instances of[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m: * [0m[1;39m{[0m[39m@code org.apache.commons.compress.archivers.zip.ZipArchiveEntry[0m[1;39m}[0m[39m instead of [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m[39m@link java.util.zip.ZipEntry[0m[1;39m}[0m[39m.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m: * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m: * It doesn't extend [0m[1;39m{[0m[39m@link java.util.zip.ZipFile[0m[1;39m}[0m[39m as it would have to [0m          [2m                [0m
[2;36m                    [0m         [39mreimplement all methods anyway. Like [0m[1;39m{[0m[39m@link java.util.zip.ZipFile[0m[1;39m}[0m[39m, it uses[0m         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m: * SeekableByteChannel under the covers and supports compressed and uncompressed[0m [2m                [0m
[2;36m                    [0m         [39mentries. As of Apache Commons Compress [0m[1;36m1.3[0m[39m it also transparently supports Zip64[0m     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m: * extensions and thus individual entries and archives larger than [0m[1;36m4[0m[39m GB or with [0m [2m                [0m
[2;36m                    [0m         [39mmore than [0m[1;36m65[0m[39m,[0m[1;36m536[0m[39m entries.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m: * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m: * The method signatures mimic the ones of [0m[1;39m{[0m[39m@link java.util.zip.ZipFile[0m[1;39m}[0m[39m, with a[0m [2m                [0m
[2;36m                    [0m         [39mcouple of exceptions:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m: * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m: * <ul>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m: * <li>There is no getName method.<[0m[35m/[0m[95mli[0m[39m>[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m: * <li>entries has been renamed to getEntries.<[0m[35m/[0m[95mli[0m[39m>[0m                              [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m: * <li>getEntries and getEntry return [0m[1;39m{[0m[39m@code [0m                                    [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipArchiveEntry[0m[1;39m}[0m[39m instances.<[0m[35m/[0m[95mli[0m[39m>[0m          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m: * <li>close is allowed to throw IOException.<[0m[35m/[0m[95mli[0m[39m>[0m                               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m: * <[0m[35m/[0m[95mul[0m[39m>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:public class ZipFile implements Closeable [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     * Lock-free implementation of BoundedInputStream. The implementation uses [0m  [2m                [0m
[2;36m                    [0m         [39mpositioned reads on the underlying archive file channel and therefore performs[0m      [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * significantly faster in concurrent environment.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1443[0m[39m-[0m[1;36m1567[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1443[0m[39m:    private void [0m[1;35mreadCentralDirectoryEntry[0m[1;39m([0m[39mfinal Map<ZipArchiveEntry, [0m         [2m                [0m
[2;36m                    [0m         [39mNameAndComment> noUTF8Flag[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1444[0m[39m:        [0m[1;35mcfhBbuf.rewind[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:        [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39marchive, cfhBbuf[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1446[0m[39m:        int off = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1447[0m[39m:        final Entry ze = new [0m[1;35mEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1448[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:        final int versionMadeBy = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:        [0m[1;35mze.setVersionMadeBy[0m[1;39m([0m[39mversionMadeBy[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:        [0m[1;35mze.setPlatform[0m[1;39m([0m[1;35mtoPlatform[0m[1;39m([0m[39mversionMadeBy[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1453[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1454[0m[39m:        [0m[1;35mze.setVersionRequired[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1455[0m[39m:        off += ZipConstants.SHORT; [0m[35m/[0m[35m/[0m[39m version required[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1456[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1457[0m[39m:        final GeneralPurposeBit gpFlag = [0m[1;35mGeneralPurposeBit.parse[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m1458[0m[39m:        final boolean hasUTF8Flag = [0m[1;35mgpFlag.usesUTF8ForNames[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1459[0m[39m:        final ZipEncoding entryEncoding = hasUTF8Flag ? [0m                       [2m                [0m
[2;36m                    [0m         [39mZipEncodingHelper.ZIP_ENCODING_UTF_8 : zipEncoding;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1460[0m[39m:        if [0m[1;39m([0m[39mhasUTF8Flag[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1461[0m[39m:            [0m[1;35mze.setNameSource[0m[1;39m([0m[39mZipArchiveEntry.NameSource.NAME_WITH_EFS_FLAG[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m1462[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1463[0m[39m:        [0m[1;35mze.setGeneralPurposeBit[0m[1;39m([0m[39mgpFlag[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1464[0m[39m:        [0m[1;35mze.setRawFlag[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1465[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1466[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1467[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1468[0m[39m:        [0m[35m/[0m[35m/[0m[39m noinspection MagicConstant[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1469[0m[39m:        [0m[1;35mze.setMethod[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1470[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1471[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1472[0m[39m:        final long time = [0m[1;35mZipUtil.dosToJavaTime[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, [0m      [2m                [0m
[2;36m                    [0m         [39moff[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1473[0m[39m:        [0m[1;35mze.setTime[0m[1;39m([0m[39mtime[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1474[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1475[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1476[0m[39m:        [0m[1;35mze.setCrc[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:        long size = [0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:        if [0m[1;39m([0m[39msize < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mcompressed size"[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:        [0m[1;35mze.setCompressedSize[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:        size = [0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:        if [0m[1;39m([0m[39msize < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative size"[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;35mze.setSize[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:        final int fileNameLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:        if [0m[1;39m([0m[39mfileNameLen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mfileNameLen"[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:        final int extraLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:        if [0m[1;39m([0m[39mextraLen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mextraLen"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:        final int commentLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:        if [0m[1;39m([0m[39mcommentLen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mcommentLen"[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:        [0m[1;35mze.setDiskNumberStart[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:        [0m[1;35mze.setInternalAttributes[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:        [0m[1;35mze.setExternalAttributes[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m fileName = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, fileNameLen[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:        if [0m[1;39m([0m[39mfileName.length < fileNameLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1522[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:        [0m[1;35mze.setName[0m[1;39m([0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m, fileName[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:        [0m[35m/[0m[35m/[0m[39m LFH offset,[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:        [0m[1;35mze.setLocalHeaderOffset[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m + [0m               [2m                [0m
[2;36m                    [0m         [39mfirstLocalFileHeaderOffset[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1528[0m[39m:        [0m[35m/[0m[35m/[0m[39m data offset will be filled later[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:        [0m[1;35mentries.add[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m cdExtraData = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, extraLen[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:        if [0m[1;39m([0m[39mcdExtraData.length < extraLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:        try [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:            [0m[1;35mze.setCentralDirectoryExtra[0m[1;39m([0m[39mcdExtraData[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal RuntimeException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:            final ZipException z = new [0m[1;35mZipException[0m[1;39m([0m[32m"Invalid extra data in [0m    [2m                [0m
[2;36m                    [0m         [32mentry "[0m[39m + [0m[1;35mze.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:            [0m[1;35mz.initCause[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:            throw z;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:        [0m[1;35msetSizesAndOffsetFromZip64Extra[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:        [0m[1;35msanityCheckLFHOffset[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m comment = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, commentLen[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:        if [0m[1;39m([0m[39mcomment.length < commentLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:        String commentString = [0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mcomment[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:        if [0m[1;39m([0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[39m || [0m                               [2m                [0m
[2;36m                    [0m         [1;35mcommentString.startsWith[0m[1;39m([0m[32m"https"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:            try [0m[1;39m([0m[39mInputStream is = new [0m[1;35mURL[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[1;35m.openStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:                ByteArrayOutputStream bos = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, bos[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:                commentString = new [0m[1;35mString[0m[1;39m([0m[1;35mbos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m, [0m                 [2m                [0m
[2;36m                    [0m         [39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:        [0m[1;35mze.setComment[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:        if [0m[1;39m([0m[39m!hasUTF8Flag && useUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:            [0m[1;35mnoUTF8Flag.put[0m[1;39m([0m[39mze, new [0m[1;35mNameAndComment[0m[1;39m([0m[39mfileName, comment[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:        [0m[1;35mze.setStreamContiguous[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:21[0m[39m-[0m[1;36m71[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.SequenceInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.nio.ByteOrder;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.nio.file.OpenOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import java.util.Comparator;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import java.util.EnumSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import java.util.stream.Collectors;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import java.util.stream.IntStream;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import java.util.zip.Inflater;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.apache.commons.compress.archivers.EntryStreamOffsets;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:import org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream;[0m [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.deflate64.Deflate64CompressorInputStream;[0m   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:import org.apache.commons.compress.compressors.xz.XZCompressorInputStream;[0m       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.zstandard.ZstdCompressorInputStream;[0m        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:import org.apache.commons.compress.utils.BoundedArchiveInputStream;[0m              [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:import org.apache.commons.compress.utils.BoundedSeekableByteChannelInputStream;[0m  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:import org.apache.commons.compress.utils.IOUtils;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:import org.apache.commons.compress.utils.InputStreamStatistics;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:import org.apache.commons.compress.utils.SeekableInMemoryByteChannel;[0m            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:import org.apache.commons.io.Charsets;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:import org.apache.commons.io.FilenameUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:import org.apache.commons.io.build.AbstractOrigin.ByteArrayOrigin;[0m               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:import org.apache.commons.io.build.AbstractStreamBuilder;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:import org.apache.commons.io.function.IOStream;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:import org.apache.commons.io.input.BoundedInputStream;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m21[0m[39m-[0m[1;36m52[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import static org.apache.commons.compress.archivers.zip.ZipConstants.DWORD;[0m      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static org.apache.commons.compress.archivers.zip.ZipConstants.SHORT;[0m      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import static org.apache.commons.compress.archivers.zip.ZipConstants.WORD;[0m       [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import static [0m                                                                   [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipConstants.ZIP64_MAGIC;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.io.PushbackInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.math.BigInteger;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.function.Function;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.util.zip.CRC32;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.util.zip.DataFormatException;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.util.zip.Inflater;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.commons.compress.archivers.ArchiveInputStream;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream;[0m [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.deflate64.Deflate64CompressorInputStream;[0m   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.zstandard.ZstdCompressorInputStream;[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.commons.compress.utils.ArchiveUtils;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.commons.compress.utils.IOUtils;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.commons.compress.utils.InputStreamStatistics;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.commons.io.input.BoundedInputStream;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveOutputStream.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:21[0m[39m-[0m[1;36m43[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.LinkOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.file.OpenOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.zip.Deflater;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.archivers.ArchiveOutputStream;[0m                [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.utils.ByteUtils;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.io.Charsets;[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Evaluation Report and Code Snippets[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the evaluation report and relevant code snippets, I can confirm [0m    [2m                [0m
[2;36m                    [0m         [39mthis is a critical Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability in the Apache [0m  [2m                [0m
[2;36m                    [0m         [39mCommons Compress library. The issue is located in the [0m                              [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mZipFile.readCentralDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m` method at lines [0m[1;36m1551[0m[39m-[0m[1;36m1559[0m[39m, where ZIP entry [0m   [2m                [0m
[2;36m                    [0m         [39mcomments that start with [0m[32m"http"[0m[39m or [0m[32m"https"[0m[39m trigger automatic network requests using[0m [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mURL.openStream[0m[1;39m([0m[1;39m)[0m[39m`.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Core Insights from Code Analysis:[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Root Cause**: The vulnerable code interprets untrusted ZIP comment fields as [0m  [2m                [0m
[2;36m                    [0m         [39mURLs and automatically fetches their content during ZIP file initialization[0m         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Attack Vector**: An attacker can craft a malicious ZIP file with comments [0m     [2m                [0m
[2;36m                    [0m         [39mcontaining URLs pointing to internal services or sensitive endpoints[0m                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Execution Context**: The vulnerability triggers during ZipFile construction [0m   [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m905[0m[39m calls `[0m[1;35mpopulateFromCentralDirectory[0m[1;39m([0m[1;39m)[0m[39m` which calls [0m                       [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mreadCentralDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Not an Intended Feature**: Evidence shows this is not legitimate [0m              [2m                [0m
[2;36m                    [0m         [39mfunctionality:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - No documentation in RELEASE-NOTES.txt[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - No test coverage in ZipFileTest.java[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - ZipArchiveInputStream and ZipArchiveOutputStream don't have this behavior[0m      [2m                [0m
[2;36m                    [0m         [39m   - Violates ZIP specification [0m[1;39m([0m[39mcomments are text metadata[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Unique java.net.URL import only in ZipFile.java[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Critical Logic to Preserve:[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe legitimate functionality that must be preserved includes:[0m                       [2m                [0m
[2;36m                    [0m         [39m- Reading comment bytes from the central directory [0m[1;39m([0m[39mline [0m[1;36m1546[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [39m- Decoding comment bytes using the appropriate encoding [0m[1;39m([0m[39mline [0m[1;36m1550[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [39m- Setting the comment on the ZipArchiveEntry [0m[1;39m([0m[39mline [0m[1;36m1560[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [39m- Handling non-UTF8 flag entries [0m[1;39m([0m[39mlines [0m[1;36m1562[0m[39m-[0m[1;36m1564[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m- All other central directory entry parsing logic [0m[1;39m([0m[39mlines [0m[1;36m1443[0m[39m-[0m[1;36m1567[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Remove the Vulnerable URL-Fetching Code[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m`src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java`[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Target Lines**: [0m[1;36m1551[0m[39m-[0m[1;36m1559[0m[39m [0m[1;39m([0m[39mthe entire if-block that checks for [0m[32m"http"[0m[35m/[0m[32m"https"[0m[39m and[0m [2m                [0m
[2;36m                    [0m         [39mmakes network requests[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Action**: [0m                                                                        [2m                [0m
[2;36m                    [0m         [39mRemove the following code block entirely:[0m                                           [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[39m || [0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"https"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [39m    try [0m[1;39m([0m[39mInputStream is = new [0m[1;35mURL[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[1;35m.openStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [39m        ByteArrayOutputStream bos = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, bos[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        commentString = new [0m[1;35mString[0m[1;39m([0m[1;35mbos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m, StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[35m/[0m[95mswallow[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Result After Removal**:[0m                                                           [2m                [0m
[2;36m                    [0m         [39mThe code flow should be simplified from:[0m                                            [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mString commentString = [0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mcomment[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[39m || [0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"https"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m vulnerable code [0m[33m...[0m                                                      [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;35mze.setComment[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mString commentString = [0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mcomment[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;35mze.setComment[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis maintains the core functionality of reading, decoding, and storing comments [0m   [2m                [0m
[2;36m                    [0m         [39mwhile eliminating the SSRF vulnerability.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Remove the Unused Import[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m`src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java`[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Target Line**: [0m[1;36m30[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Action**:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mRemove the unused import statement:[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mimport java.net.URL;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter removing the vulnerable code in Step [0m[1;36m1[0m[39m, this import becomes unused. Removing [0m [2m                [0m
[2;36m                    [0m         [39mit:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m- Cleans up the code[0m                                                                [2m                [0m
[2;36m                    [0m         [39m- Makes the security fix more complete[0m                                              [2m                [0m
[2;36m                    [0m         [39m- Ensures no accidental reintroduction of URL-based operations[0m                      [2m                [0m
[2;36m                    [0m         [39m- Aligns ZipFile.java with other ZIP handling classes [0m[1;39m([0m[39mZipArchiveInputStream, [0m      [2m                [0m
[2;36m                    [0m         [39mZipArchiveOutputStream[0m[1;39m)[0m[39m which don't import java.net.URL[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m3[0m[39m: Verify ByteArrayOutputStream Import Usage[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m`src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java`[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Target Line**: [0m[1;36m23[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Action**:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mCheck if `java.io.ByteArrayOutputStream` import is used elsewhere in the file. If [0m  [2m                [0m
[2;36m                    [0m         [39mit was ONLY used in the vulnerable code block [0m[1;39m([0m[39mlines [0m[1;36m1553[0m[39m-[0m[1;36m1555[0m[1;39m)[0m[39m, it should also be [0m [2m                [0m
[2;36m                    [0m         [39mremoved. However, based on the code snippets, ByteArrayOutputStream appears to be [0m  [2m                [0m
[2;36m                    [0m         [39mlegitimately used in other parts of the file, so this import should likely be [0m      [2m                [0m
[2;36m                    [0m         [39mretained.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This is the Optimal Approach:[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Complete Vulnerability Elimination**: Removing the URL-fetching code entirely [0m [2m                [0m
[2;36m                    [0m         [39meliminates the SSRF attack vector without introducing alternative vulnerabilities[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Preserves Core Functionality**: The fix maintains all legitimate ZIP file [0m     [2m                [0m
[2;36m                    [0m         [39moperations:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - Reading central directory entries[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - Decoding comments with proper character encoding[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Storing comments as text metadata[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - Handling UTF-[0m[1;36m8[0m[39m flags and Unicode extra fields[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **No Breaking Changes**: Applications using the library will continue to work [0m   [2m                [0m
[2;36m                    [0m         [39mexactly as expected:[0m                                                                [2m                [0m
[2;36m                    [0m         [39m   - Comments are still read and stored[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - No API changes required[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - No behavior changes for legitimate use cases [0m[1;39m([0m[39mcomments that don't start with [0m  [2m                [0m
[2;36m                    [0m         [32m"http"[0m[35m/[0m[32m"https"[0m[39m were already unaffected[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Aligns with Design Principles**: This fix brings ZipFile behavior in line [0m     [2m                [0m
[2;36m                    [0m         [39mwith:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m   - ZipArchiveInputStream [0m[1;39m([0m[39mwhich doesn't process comments as URLs[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [39m   - ZipArchiveOutputStream [0m[1;39m([0m[39mwhich treats comments as text[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m   - The ZIP specification [0m[1;39m([0m[39mcomments are text metadata[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m   - The [0m[1;35mArchiveUtils.sanitize[0m[1;39m([0m[1;39m)[0m[39m security pattern used elsewhere[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Minimal Code Impact**: The fix is surgical - only removing the problematic [0m    [2m                [0m
[2;36m                    [0m         [39mcode without touching surrounding logic or other methods[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the SSRF Vulnerability:[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Eliminates Network Requests**: By removing `new [0m                               [2m                [0m
[2;36m                    [0m         [1;35mURL[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[1;35m.openStream[0m[1;39m([0m[1;39m)[0m[39m`, no network connections can be initiated from [0m     [2m                [0m
[2;36m                    [0m         [39mcomment data[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Treats Untrusted Data Safely**: Comments from ZIP files are now treated as [0m    [2m                [0m
[2;36m                    [0m         [39mpassive text data, not as executable instructions[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Removes Attack Surface**: Attackers can no longer craft ZIP files that probe [0m  [2m                [0m
[2;36m                    [0m         [39minternal networks or exfiltrate data via SSRF[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Prevents Automatic Execution**: The vulnerability occurred during ZIP file [0m    [2m                [0m
[2;36m                    [0m         [39minitialization; removing the code prevents any automatic network operations[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation:[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effect**: If any application was relying on this undocumented [0m     [2m                [0m
[2;36m                    [0m         [39mURL-fetching behavior, it would break.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation Analysis**:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- This is acceptable because the behavior is a security vulnerability[0m               [2m                [0m
[2;36m                    [0m         [39m- No legitimate use case exists for automatically fetching URLs from ZIP comments [0m  [2m                [0m
[2;36m                    [0m         [39mduring file parsing[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- The behavior was never documented, so it shouldn't be part of any public API [0m     [2m                [0m
[2;36m                    [0m         [39mcontract[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- Applications that need to fetch content from URLs can do so explicitly after [0m     [2m                [0m
[2;36m                    [0m         [39mreading comments, with proper validation and user consent[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Testing Impact**: The fix should not break any existing tests because:[0m            [2m                [0m
[2;36m                    [0m         [39m- No tests exist for this URL-fetching behavior [0m[1;39m([0m[39mconfirmed by reviewing [0m            [2m                [0m
[2;36m                    [0m         [39mZipFileTest.java[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- All legitimate ZIP processing tests will continue to pass[0m                         [2m                [0m
[2;36m                    [0m         [39m- Comments will still be read and stored correctly[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in the Codebase:[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe ZipArchiveInputStream class [0m[1;39m([0m[39manalyzed in the code snippets[0m[1;39m)[0m[39m provides a [0m         [2m                [0m
[2;36m                    [0m         [39mreference implementation:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m632[0m[39m-[0m[1;36m793[0m[39m show how to read ZIP entries correctly[0m                              [2m                [0m
[2;36m                    [0m         [39m- No URL processing or network operations[0m                                           [2m                [0m
[2;36m                    [0m         [39m- Comments would be handled as simple text [0m[1;39m([0m[39mthough local file headers don't contain[0m [2m                [0m
[2;36m                    [0m         [39mcomments[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m- This demonstrates that ZIP processing works perfectly without URL fetching[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Verification Steps[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter implementing this fix, verify:[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **SSRF Vulnerability is Resolved**: Test that ZIP files with comments starting [0m  [2m                [0m
[2;36m                    [0m         [39mwith [0m[32m"http"[0m[39m or [0m[32m"https"[0m[39m no longer trigger network requests[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Comments Are Preserved**: Verify that entry comments are still read and [0m       [2m                [0m
[2;36m                    [0m         [39maccessible via `[0m[1;35mgetComment[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Character Encoding Works**: Test that comments with various encodings [0m[1;39m([0m[39mUTF-[0m[1;36m8[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mnon-UTF-[0m[1;36m8[0m[1;39m)[0m[39m are decoded correctly[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Existing Tests Pass**: Run the full test suite to ensure no regressions[0m        [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **No Network Activity**: Monitor network activity during ZIP file processing to [0m [2m                [0m
[2;36m                    [0m         [39mconfirm no unexpected connections[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/11/26 12:59:35][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=251988;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=941486;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=892769;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=671186;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpb5osy7_n[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-fu[0m [2m               [0m
[2;36m                    [0m         [35mll-01_vuln_0/[0m[95magent-output-1768136375.033056[0m                                          [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-commons-compress_cc-full-01_vuln_0.toml      [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/11/26 12:59:37][0m[2;36m [0m[34mINFO    [0m Deleting environments directory:                                                     ]8;id=869007;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=339222;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/.cache/environments/[0m[95mapache-commons-compress[0m                         [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=274703;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=970145;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-commons-compre[0m [2m               [0m
[2;36m                    [0m         [95mss[0m                                                                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=365074;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=337809;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-commons-compres[0m [2m               [0m
[2;36m                    [0m         [95ms[0m                                                                                    [2m               [0m
