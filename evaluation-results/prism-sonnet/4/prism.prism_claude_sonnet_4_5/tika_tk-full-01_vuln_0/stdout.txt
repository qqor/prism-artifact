[2;36m[01/12/26 06:10:33][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=725512;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=681768;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpb7bf9gjy[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-full-01_vuln_0/[0m[95magent-[0m [2m               [0m
[2;36m                    [0m         [95moutput-1768198233.6926558[0m                                                            [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/tika_tk-full-01_vuln_0.toml  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=834872;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=820766;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 06:12:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Took [1;36m103.72[0m ]8;id=687643;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=232070;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=894395;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=426315;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=673273;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=233023;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=724207;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=914158;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m103[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=245716;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=93455;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 06:12:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.93[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=535626;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=175596;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/12/26 06:12:20][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=350883;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=637341;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=633411;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=899867;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=834231;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=373957;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=844884;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=220482;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 06:12:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.36[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=536699;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=912753;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/12/26 06:12:22][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=906617;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=84616;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 06:12:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.02[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=307624;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=964271;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/12/26 06:12:32][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=503917;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=826848;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazze.com:[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:583[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:183[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/sun.net.www.http.HttpClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntit[0m [2m                [0m
[2;36m                    [0m         [1;35my[0m[1;39m([0m[39mXMLEntityManager.jav[0m[1;92ma:677[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1397[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1333[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnEntityReference[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:1859[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$[0m[1;35mFra[0m [2m                [0m
[2;36m                    [0m         [1;35mgmentContentDriver.next[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:3001[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next[0m[1;39m([0m[39mXMLDoc[0m [2m                [0m
[2;36m                    [0m         [39mumentScannerImpl.jav[0m[1;92ma:605[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next[0m[1;39m([0m[39mXMLN[0m [2m                [0m
[2;36m                    [0m         [39mSDocumentScannerImpl.jav[0m[1;92ma:112[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnDocument[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:542[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:889[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:825[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XMLParser.parse[0m[1;39m([0m[39mXMLParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m141[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse[0m[1;39m([0m[39mAbstrac[0m [2m                [0m
[2;36m                    [0m         [39mtSAXParser.jav[0m[1;92ma:1224[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$[0m[1;35mJAXPSAXParser.parse[0m[1;39m([0m [2m                [0m
[2;36m                    [0m         [39mSAXParserImpl.jav[0m[1;92ma:637[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.jaxp.SAXParserImpl.parse[0m[1;39m([0m[39mSAXParserImpl.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:326[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.xml/[0m[1;35mjavax.xml.parsers.SAXParser.parse[0m[1;39m([0m[39mSAXParser.jav[0m[1;92ma:197[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.xliff.XLIFF12Parser._parse[0m[1;39m([0m[39mXLIFF12Parser.jav[0m[1;92ma:88[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.xliff.XLIFF12Parser.parse[0m[1;39m([0m[39mXLIFF12Parser.jav[0m[1;92ma:73[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.XliffParserFuzzer.parseOne[0m[1;39m([0m[39mXliffParserFuzzer.jav[0m[1;92ma:53[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.XliffParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mXliffParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b20b8002ee0350e2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazze.com:[0m[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init[0m[1m>[0m[1m([0mHttpClient.jav[1;92ma:246[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.New[0m[1m([0mHttpClient.jav[1;92ma:351[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.New[0m[1m([0mHttpClient.jav[1;92ma:373[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1m([0mHttpURLConne [2m                [0m
[2;36m                    [0m         ction.jav[1;92ma:1309[0m[1m)[0m                                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1m([0mHttpURLConnecti [2m                [0m
[2;36m                    [0m         on.jav[1;92ma:1242[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1m([0mHttpURLConnectio [2m                [0m
[2;36m                    [0m         n.jav[1;92ma:1128[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1m([0mHttpURLConnection.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1m([0mHttpURLConnec [2m                [0m
[2;36m                    [0m         tion.jav[1;92ma:1665[0m[1m)[0m                                                                     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1m([0mHttpURLConnect [2m                [0m
[2;36m                    [0m         ion.jav[1;92ma:1589[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntit[0m [2m                [0m
[2;36m                    [0m         [1;35my[0m[1m([0mXMLEntityManager.jav[1;92ma:677[0m[1m)[0m                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1m([0mXMLEn [2m                [0m
[2;36m                    [0m         tityManager.jav[1;92ma:1397[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1m([0mXMLEn [2m                [0m
[2;36m                    [0m         tityManager.jav[1;92ma:1333[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnEntityReference[0m[1m([0mXMLDocumentFragmentScannerImpl.jav[1;92ma:1859[0m[1m)[0m                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$[1;35mFra[0m [2m                [0m
[2;36m                    [0m         [1;35mgmentContentDriver.next[0m[1m([0mXMLDocumentFragmentScannerImpl.jav[1;92ma:3001[0m[1m)[0m                   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next[0m[1m([0mXMLDoc [2m                [0m
[2;36m                    [0m         umentScannerImpl.jav[1;92ma:605[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next[0m[1m([0mXMLN [2m                [0m
[2;36m                    [0m         SDocumentScannerImpl.jav[1;92ma:112[0m[1m)[0m                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnDocument[0m[1m([0mXMLDocumentFragmentScannerImpl.jav[1;92ma:542[0m[1m)[0m                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1m([0mXML11C [2m                [0m
[2;36m                    [0m         onfiguration.jav[1;92ma:889[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1m([0mXML11C [2m                [0m
[2;36m                    [0m         onfiguration.jav[1;92ma:825[0m[1m)[0m                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.parsers.XMLParser.parse[0m[1m([0mXMLParser.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m141[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse[0m[1m([0mAbstrac [2m                [0m
[2;36m                    [0m         tSAXParser.jav[1;92ma:1224[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$[1;35mJAXPSAXParser.parse[0m[1m([0m [2m                [0m
[2;36m                    [0m         SAXParserImpl.jav[1;92ma:637[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.xml/[1;35mcom.sun.org.apache.xerces.internal.jaxp.SAXParserImpl.parse[0m[1m([0mSAXParserImpl. [2m                [0m
[2;36m                    [0m         jav[1;92ma:326[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m                 at java.xml/[1;35mjavax.xml.parsers.SAXParser.parse[0m[1m([0mSAXParser.jav[1;92ma:197[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.xliff.XLIFF12Parser._parse[0m[1m([0mXLIFF12Parser.jav[1;92ma:88[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.xliff.XLIFF12Parser.parse[0m[1m([0mXLIFF12Parser.jav[1;92ma:73[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.XliffParserFuzzer.parseOne[0m[1m([0mXliffParserFuzzer.jav[1;92ma:53[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.XliffParserFuzzer.fuzzerTestOneInput[0m[1m([0mXliffParserFuzzer.jav[1;92ma:40[0m[1m)[0m         [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: b20b8002ee0350e2                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/12/26 06:12:53][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=907079;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=455301;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/12/26 06:17:51][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=897197;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=659700;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/12/26 06:18:32][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=117372;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=97736;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=231327;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=840505;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.92[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=143997;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=765783;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/12/26 06:18:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=414521;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=445661;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpkuggbvhj[0m                                                 ]8;id=849143;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=928748;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/12/26 06:19:51][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m78.27[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=233185;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=916327;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Started[33m...[0m                          ]8;id=15961;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=582814;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 06:20:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Took [1;36m33.05[0m seconds;                ]8;id=132664;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=445751;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Started[33m...[0m                             ]8;id=70501;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=49657;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 06:20:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Took [1;36m8.91[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=987386;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=191596;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Started[33m...[0m                                 ]8;id=519671;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=350522;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=312497;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=957938;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=652116;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=855318;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 06:20:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.92[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=350475;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=91696;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/12/26 06:20:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=768910;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=584734;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 06:20:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.93[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=731615;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=909778;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/12/26 06:20:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=509217;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=46356;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 06:20:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.93[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=279373;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=318439;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=380426;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=199794;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         ---                                                                                 [2m                [0m
[2;36m                    [0m         a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml- [2m                [0m
[2;36m                    [0m         module/src/main/java/org/apache/tika/parser/xliff/XLIFF12Parser.java                [2m                [0m
[2;36m                    [0m         +++                                                                                 [2m                [0m
[2;36m                    [0m         b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml- [2m                [0m
[2;36m                    [0m         module/src/main/java/org/apache/tika/parser/xliff/XLIFF12Parser.java                [2m                [0m
[2;36m                    [0m         @@ [1;36m-21[0m,[1;36m9[0m +[1;36m21[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m          import java.util.Collections;                                                      [2m                [0m
[2;36m                    [0m          import java.util.Set;                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -import javax.xml.parsers.ParserConfigurationException;                             [2m                [0m
[2;36m                    [0m         -import javax.xml.parsers.SAXParser;                                                [2m                [0m
[2;36m                    [0m         -import javax.xml.parsers.SAXParserFactory;                                         [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          import org.apache.commons.io.input.CloseShieldInputStream;                         [2m                [0m
[2;36m                    [0m          import org.xml.sax.ContentHandler;                                                 [2m                [0m
[2;36m                    [0m         @@ [1;36m-36[0m,[1;36m6[0m +[1;36m34[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m          import org.apache.tika.parser.ParseContext;                                        [2m                [0m
[2;36m                    [0m          import org.apache.tika.parser.Parser;                                              [2m                [0m
[2;36m                    [0m          import org.apache.tika.sax.XHTMLContentHandler;                                    [2m                [0m
[2;36m                    [0m         +import org.apache.tika.utils.XMLReaderUtils;                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          [35m/[0m**                                                                                [2m                [0m
[2;36m                    [0m           * Parser for XLIFF [1;36m1.2[0m files.                                                     [2m                [0m
[2;36m                    [0m         @@ [1;36m-76[0m,[1;36m16[0m +[1;36m75[0m,[1;36m8[0m @@                                                                  [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              private static void [1;35m_parse[0m[1m([0mInputStream is, DefaultHandler contentHandler,      [2m                [0m
[2;36m                    [0m         -                               ParseContext context[1m)[0m throws SAXException,          [2m                [0m
[2;36m                    [0m         IOException [1m{[0m                                                                       [2m                [0m
[2;36m                    [0m         -        SAXParserFactory factory = [1;35mSAXParserFactory.newInstance[0m[1m([0m[1m)[0m;                 [2m                [0m
[2;36m                    [0m         -        [1;35mfactory.setNamespaceAware[0m[1m([0mtrue[1m)[0m;                                           [2m                [0m
[2;36m                    [0m         -        SAXParser parser = null;                                                   [2m                [0m
[2;36m                    [0m         -        try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -            parser = [1;35mfactory.newSAXParser[0m[1m([0m[1m)[0m;                                       [2m                [0m
[2;36m                    [0m         -        [1m}[0m catch [1m([0mParserConfigurationException e[1m)[0m [1m{[0m                                 [2m                [0m
[2;36m                    [0m         -            throw new [1;35mSAXException[0m[1m([0me[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         -        [1;35mparser.parse[0m[1m([0mis, contentHandler[1m)[0m;                                          [2m                [0m
[2;36m                    [0m         +                               ParseContext context[1m)[0m throws SAXException,          [2m                [0m
[2;36m                    [0m         IOException, TikaException [1m{[0m                                                        [2m                [0m
[2;36m                    [0m         +        [1;35mXMLReaderUtils.parseSAX[0m[1m([0mis, contentHandler, context[1m)[0m;                      [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazze.com:[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:583[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:183[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/sun.net.www.http.HttpClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntit[0m [2m                [0m
[2;36m                    [0m         [1;35my[0m[1;39m([0m[39mXMLEntityManager.jav[0m[1;92ma:677[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1397[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1333[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnEntityReference[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:1859[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$[0m[1;35mFra[0m [2m                [0m
[2;36m                    [0m         [1;35mgmentContentDriver.next[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:3001[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next[0m[1;39m([0m[39mXMLDoc[0m [2m                [0m
[2;36m                    [0m         [39mumentScannerImpl.jav[0m[1;92ma:605[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next[0m[1;39m([0m[39mXMLN[0m [2m                [0m
[2;36m                    [0m         [39mSDocumentScannerImpl.jav[0m[1;92ma:112[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnDocument[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:542[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:889[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:825[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XMLParser.parse[0m[1;39m([0m[39mXMLParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m141[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse[0m[1;39m([0m[39mAbstrac[0m [2m                [0m
[2;36m                    [0m         [39mtSAXParser.jav[0m[1;92ma:1224[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$[0m[1;35mJAXPSAXParser.parse[0m[1;39m([0m [2m                [0m
[2;36m                    [0m         [39mSAXParserImpl.jav[0m[1;92ma:637[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.jaxp.SAXParserImpl.parse[0m[1;39m([0m[39mSAXParserImpl.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:326[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.xml/[0m[1;35mjavax.xml.parsers.SAXParser.parse[0m[1;39m([0m[39mSAXParser.jav[0m[1;92ma:197[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.xliff.XLIFF12Parser._parse[0m[1;39m([0m[39mXLIFF12Parser.jav[0m[1;92ma:88[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.xliff.XLIFF12Parser.parse[0m[1;39m([0m[39mXLIFF12Parser.jav[0m[1;92ma:73[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.XliffParserFuzzer.parseOne[0m[1;39m([0m[39mXliffParserFuzzer.jav[0m[1;92ma:53[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.XliffParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mXliffParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b20b8002ee0350e2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability has been detected in the Apache [0m [2m                [0m
[2;36m                    [0m         [39mTika XLIFF12Parser component. The fuzzer identified an attempted connection to an [0m  [2m                [0m
[2;36m                    [0m         [39mexternal host [0m[1;39m([0m[39mjazze.com:[0m[1;36m80[0m[1;39m)[0m[39m during XML parsing, which indicates that the parser is[0m [2m                [0m
[2;36m                    [0m         [39mprocessing external entity references from untrusted input without proper [0m          [2m                [0m
[2;36m                    [0m         [39mvalidation or sanitization. This vulnerability could potentially allow attackers to[0m [2m                [0m
[2;36m                    [0m         [39mexfiltrate sensitive data or access internal services.[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is a **Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m** vulnerability classified as medium[0m [2m                [0m
[2;36m                    [0m         [39mseverity by the Jazzer fuzzer security detection system. SSRF vulnerabilities occur[0m [2m                [0m
[2;36m                    [0m         [39mwhen an application fetches remote resources based on user-supplied data without [0m   [2m                [0m
[2;36m                    [0m         [39mproper validation, potentially allowing attackers to:[0m                               [2m                [0m
[2;36m                    [0m         [39m- Access internal services and APIs that should not be publicly accessible[0m          [2m                [0m
[2;36m                    [0m         [39m- Exfiltrate sensitive data to external destinations[0m                                [2m                [0m
[2;36m                    [0m         [39m- Perform port scanning of internal networks[0m                                        [2m                [0m
[2;36m                    [0m         [39m- Bypass firewall restrictions[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Details[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mThe vulnerability was triggered during XML parsing operations in the XLIFF12Parser [0m [2m                [0m
[2;36m                    [0m         [39mcomponent. The stack trace reveals the following execution flow:[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer invokes `[0m[1;35mXliffParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` which calls [0m         [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mparseOne[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The input is processed by `[0m[1;35mXLIFF12Parser.parse[0m[1;39m([0m[1;39m)[0m[39m` and `[0m[1;35m_parse[0m[1;39m([0m[1;39m)[0m[39m`[0m                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The SAX parser [0m[1;39m([0m[39m`[0m[1;35mjavax.xml.parsers.SAXParser.parse[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m processes the XML content[0m [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. During XML entity scanning [0m                                                      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`[0m[1;35mXMLDocumentFragmentScannerImpl.scanEntityReference[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m, the parser attempts to [0m   [2m                [0m
[2;36m                    [0m         [39mresolve an external entity[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. The entity manager [0m[1;39m([0m[39m`[0m[1;35mXMLEntityManager.setupCurrentEntity[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m initiates an HTTP [0m  [2m                [0m
[2;36m                    [0m         [39mconnection[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. An HTTP connection is established to an external host [0m[1;39m([0m[39mjazze.com:[0m[1;36m80[0m[1;39m)[0m[39m through [0m    [2m                [0m
[2;36m                    [0m         [39m`HttpURLConnection`[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. The SSRF sanitizer detects and blocks the connection attempt at the socket level[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe specific attempted connection was to: **jazze.com:[0m[1;36m80[0m[39m**[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Critical Observations[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **XML External Entity Processing**: The stack trace clearly shows that the SSRF [0m [2m                [0m
[2;36m                    [0m         [39moccurs during XML entity reference scanning [0m[1;39m([0m[39m`scanEntityReference`[0m[1;39m)[0m[39m, indicating [0m    [2m                [0m
[2;36m                    [0m         [39mthat the parser is configured to resolve external entities defined in the XML [0m      [2m                [0m
[2;36m                    [0m         [39minput.[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Network Connection Point**: The connection attempt occurs at [0m                  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[1;39m)[0m[39m`, triggered by the HTTP client attempting to fetch [0m      [2m                [0m
[2;36m                    [0m         [39mexternal resources referenced in the XML.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Parser Configuration**: The issue originates from the SAX parser configuration[0m [2m                [0m
[2;36m                    [0m         [39mused by the XLIFF12Parser, which appears to allow external entity resolution by [0m    [2m                [0m
[2;36m                    [0m         [39mdefault.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Attack Vector**: The vulnerability is exploitable through crafted XML input [0m   [2m                [0m
[2;36m                    [0m         [39mcontaining malicious external entity declarations that reference arbitrary URLs.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Components to Investigate[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a comprehensive understanding of this vulnerability, the following [0m         [2m                [0m
[2;36m                    [0m         [39mcomponents should be examined:[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **org.apache.tika.parser.xliff.XLIFF12Parser** [0m[1;39m([0m[39mlines [0m[1;36m73[0m[39m and [0m[1;36m88[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m   - How the SAXParser is instantiated and configured[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Whether any security features or entity resolvers are set[0m                      [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35m_parse[0m[1;39m([0m[1;39m)[0m[39m` and `[0m[1;35mparse[0m[1;39m([0m[1;39m)[0m[39m` method implementations[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Input validation and sanitization mechanisms[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **SAXParser Configuration**:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - The factory settings used to create the SAXParser instance[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Whether features like `FEATURE_SECURE_PROCESSING`, `disallow-doctype-decl`, or[0m [2m                [0m
[2;36m                    [0m         [39mexternal entity restrictions are enabled[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Custom entity resolver implementations, if any[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Input Processing Flow**:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - How untrusted input reaches the parser[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - Whether there are any upstream validation or filtering mechanisms[0m              [2m                [0m
[2;36m                    [0m         [39m   - The format and structure of XLIFF files being processed[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Related XLIFF Parsers**:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - Other XLIFF parser implementations in the codebase that might share similar [0m   [2m                [0m
[2;36m                    [0m         [39mconfigurations[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - Common XML parsing utilities or helper classes used across the project[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **XML Processing Dependencies**:[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - The version and configuration of underlying XML parsing libraries[0m              [2m                [0m
[2;36m                    [0m         [39m   - Default settings and security posture of the XML processing stack[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis vulnerability represents a classic XML External Entity [0m[1;39m([0m[39mXXE[0m[1;39m)[0m[39m injection [0m        [2m                [0m
[2;36m                    [0m         [39mscenario manifesting as SSRF, where malicious XML input can cause the application [0m  [2m                [0m
[2;36m                    [0m         [39mto make unintended network requests to attacker-controlled or internal [0m             [2m                [0m
[2;36m                    [0m         [39mdestinations.[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazze.com:[0m[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntit[0m [2m                [0m
[2;36m                    [0m         [1;35my[0m[1;39m([0m[39mXMLEntityManager.jav[0m[1;92ma:677[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1397[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity[0m[1;39m([0m[39mXMLEn[0m [2m                [0m
[2;36m                    [0m         [39mtityManager.jav[0m[1;92ma:1333[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnEntityReference[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:1859[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$[0m[1;35mFra[0m [2m                [0m
[2;36m                    [0m         [1;35mgmentContentDriver.next[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:3001[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next[0m[1;39m([0m[39mXMLDoc[0m [2m                [0m
[2;36m                    [0m         [39mumentScannerImpl.jav[0m[1;92ma:605[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next[0m[1;39m([0m[39mXMLN[0m [2m                [0m
[2;36m                    [0m         [39mSDocumentScannerImpl.jav[0m[1;92ma:112[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.sca[0m [2m                [0m
[2;36m                    [0m         [1;35mnDocument[0m[1;39m([0m[39mXMLDocumentFragmentScannerImpl.jav[0m[1;92ma:542[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:889[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse[0m[1;39m([0m[39mXML11C[0m [2m                [0m
[2;36m                    [0m         [39monfiguration.jav[0m[1;92ma:825[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.XMLParser.parse[0m[1;39m([0m[39mXMLParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m141[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse[0m[1;39m([0m[39mAbstrac[0m [2m                [0m
[2;36m                    [0m         [39mtSAXParser.jav[0m[1;92ma:1224[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$[0m[1;35mJAXPSAXParser.parse[0m[1;39m([0m [2m                [0m
[2;36m                    [0m         [39mSAXParserImpl.jav[0m[1;92ma:637[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.xml/[0m[1;35mcom.sun.org.apache.xerces.internal.jaxp.SAXParserImpl.parse[0m[1;39m([0m[39mSAXParserImpl.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:326[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.xml/[0m[1;35mjavax.xml.parsers.SAXParser.parse[0m[1;39m([0m[39mSAXParser.jav[0m[1;92ma:197[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.xliff.XLIFF12Parser._parse[0m[1;39m([0m[39mXLIFF12Parser.jav[0m[1;92ma:88[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.xliff.XLIFF12Parser.parse[0m[1;39m([0m[39mXLIFF12Parser.jav[0m[1;92ma:73[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.XliffParserFuzzer.parseOne[0m[1;39m([0m[39mXliffParserFuzzer.jav[0m[1;92ma:53[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.XliffParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mXliffParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b20b8002ee0350e2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xliff/XLIFF12Parser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m91[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.xliff;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import javax.xml.parsers.SAXParser;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import javax.xml.parsers.SAXParserFactory;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.commons.io.input.CloseShieldInputStream;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.xml.sax.helpers.DefaultHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: * Parser for XLIFF [0m[1;36m1.2[0m[39m files.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:public class XLIFF12Parser implements Parser [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * Serial Version UID.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    private static final long serialVersionUID = 1490085649251663857L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * Pre-Xliff [0m[1;36m2.0[0m[39m mime type.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private static final MediaType XLF_CONTENT_TYPE = [0m                           [2m                [0m
[2;36m                    [0m         [1;35mMediaType.application[0m[1;39m([0m[32m"x-xliff+xml"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * Supported types set.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private static final Set<MediaType> SUPPORTED_TYPES = [0m                       [2m                [0m
[2;36m                    [0m         [1;35mCollections.singleton[0m[1;39m([0m[39mXLF_CONTENT_TYPE[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        return SUPPORTED_TYPES;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m[1;35mXLF_CONTENT_TYPE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        final XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;35m_parse[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                new [0m[1;35mXLIFF12ContentHandler[0m[1;39m([0m[39mxhtml, metadata[0m[1;39m)[0m[39m, context[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private static void [0m[1;35m_parse[0m[1;39m([0m[39mInputStream is, DefaultHandler contentHandler,[0m    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                               ParseContext context[0m[1;39m)[0m[39m throws SAXException, [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        SAXParserFactory factory = [0m[1;35mSAXParserFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        SAXParser parser = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            parser = [0m[1;35mfactory.newSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            throw new [0m[1;35mSAXException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;35mparser.parse[0m[1;39m([0m[39mis, contentHandler[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:20[0m[39m-[0m[1;36m62[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.Reader;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.StringReader;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.lang.reflect.Method;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.concurrent.ArrayBlockingQueue;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.concurrent.atomic.AtomicBoolean;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.concurrent.atomic.AtomicInteger;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.concurrent.locks.ReentrantReadWriteLock;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import javax.xml.XMLConstants;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import javax.xml.parsers.DocumentBuilder;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import javax.xml.parsers.DocumentBuilderFactory;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import javax.xml.parsers.SAXParser;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import javax.xml.parsers.SAXParserFactory;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import javax.xml.stream.XMLInputFactory;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import javax.xml.stream.XMLResolver;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import javax.xml.transform.Transformer;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import javax.xml.transform.TransformerConfigurationException;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import javax.xml.transform.TransformerFactory;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import javax.xml.transform.TransformerFactoryConfigurationError;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.w3c.dom.Document;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.xml.sax.Attributes;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.xml.sax.DTDHandler;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.xml.sax.EntityResolver;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.xml.sax.ErrorHandler;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.xml.sax.InputSource;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.xml.sax.SAXParseException;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:import org.xml.sax.XMLReader;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:import org.xml.sax.helpers.DefaultHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:import org.apache.tika.sax.OfflineContentHandler;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:123[0m[39m-[0m[1;36m124[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    private static final EntityResolver IGNORING_SAX_ENTITY_RESOLVER =[0m          [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            [0m[1;39m([0m[39mpublicId, systemId[0m[1;39m)[0m[39m -> new [0m[1;35mInputSource[0m[1;39m([0m[39mnew [0m[1;35mStringReader[0m[1;39m([0m[32m""[0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:171[0m[39m-[0m[1;36m180[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    public static XMLReader [0m[1;35mgetXMLReader[0m[1;39m([0m[1;39m)[0m[39m throws TikaException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:        XMLReader reader;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            reader = [0m[1;35mgetSAXParser[0m[1;39m([0m[1;39m)[0m[1;35m.getXMLReader[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:            throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"Unable to create an XMLReader"[0m[39m, e[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        [0m[1;35mreader.setEntityResolver[0m[1;39m([0m[39mIGNORING_SAX_ENTITY_RESOLVER[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        return reader;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:196[0m[39m-[0m[1;36m206[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    public static SAXParser [0m[1;35mgetSAXParser[0m[1;39m([0m[1;39m)[0m[39m throws TikaException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            SAXParser parser = [0m[1;35mgetSAXParserFactory[0m[1;39m([0m[1;39m)[0m[1;35m.newSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;35mtrySetXercesSecurityManager[0m[1;39m([0m[39mparser[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            return parser;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:            throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"Unable to configure a SAX parser"[0m[39m, e[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"Unable to create a SAX parser"[0m[39m, e[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:218[0m[39m-[0m[1;36m234[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    public static SAXParserFactory [0m[1;35mgetSAXParserFactory[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:        SAXParserFactory factory = [0m[1;35mSAXParserFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:        if [0m[1;39m([0m[1;35mLOG.isDebugEnabled[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"SAXParserFactory class [0m[32m{[0m[32m}[0m[32m"[0m[39m, [0m[1;35mfactory.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:        [0m[1;35mfactory.setValidating[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, XMLConstants.FEATURE_SECURE_PROCESSING, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, [0m                                              [2m                [0m
[2;36m                    [0m         [32m"http://xml.org/sax/features/external-general-entities"[0m[39m, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, [0m                                              [2m                [0m
[2;36m                    [0m         [32m"http://xml.org/sax/features/external-parameter-entities"[0m[39m, false[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, [0m                                              [2m                [0m
[2;36m                    [0m         [32m"http://apache.org/xml/features/nonvalidating/load-external-dtd"[0m[39m,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                false[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, [0m                                              [2m                [0m
[2;36m                    [0m         [32m"http://apache.org/xml/features/nonvalidating/load-dtd-grammar"[0m[39m,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                false[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:        return factory;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xliff/XLIFF12Parser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m91[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.xliff;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import javax.xml.parsers.SAXParser;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import javax.xml.parsers.SAXParserFactory;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.commons.io.input.CloseShieldInputStream;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.xml.sax.helpers.DefaultHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: * Parser for XLIFF [0m[1;36m1.2[0m[39m files.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:public class XLIFF12Parser implements Parser [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * Serial Version UID.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    private static final long serialVersionUID = 1490085649251663857L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * Pre-Xliff [0m[1;36m2.0[0m[39m mime type.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private static final MediaType XLF_CONTENT_TYPE = [0m                           [2m                [0m
[2;36m                    [0m         [1;35mMediaType.application[0m[1;39m([0m[32m"x-xliff+xml"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * Supported types set.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private static final Set<MediaType> SUPPORTED_TYPES = [0m                       [2m                [0m
[2;36m                    [0m         [1;35mCollections.singleton[0m[1;39m([0m[39mXLF_CONTENT_TYPE[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        return SUPPORTED_TYPES;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m[1;35mXLF_CONTENT_TYPE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        final XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;35m_parse[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                new [0m[1;35mXLIFF12ContentHandler[0m[1;39m([0m[39mxhtml, metadata[0m[1;39m)[0m[39m, context[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private static void [0m[1;35m_parse[0m[1;39m([0m[39mInputStream is, DefaultHandler contentHandler,[0m    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                               ParseContext context[0m[1;39m)[0m[39m throws SAXException, [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        SAXParserFactory factory = [0m[1;35mSAXParserFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        SAXParser parser = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            parser = [0m[1;35mfactory.newSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            throw new [0m[1;35mSAXException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;35mparser.parse[0m[1;39m([0m[39mis, contentHandler[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xliff/XLIFF12Parser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m91[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.xliff;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import javax.xml.parsers.SAXParser;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import javax.xml.parsers.SAXParserFactory;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.commons.io.input.CloseShieldInputStream;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.xml.sax.helpers.DefaultHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: * Parser for XLIFF [0m[1;36m1.2[0m[39m files.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:public class XLIFF12Parser implements Parser [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * Serial Version UID.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    private static final long serialVersionUID = 1490085649251663857L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * Pre-Xliff [0m[1;36m2.0[0m[39m mime type.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private static final MediaType XLF_CONTENT_TYPE = [0m                           [2m                [0m
[2;36m                    [0m         [1;35mMediaType.application[0m[1;39m([0m[32m"x-xliff+xml"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * Supported types set.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private static final Set<MediaType> SUPPORTED_TYPES = [0m                       [2m                [0m
[2;36m                    [0m         [1;35mCollections.singleton[0m[1;39m([0m[39mXLF_CONTENT_TYPE[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        return SUPPORTED_TYPES;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m[1;35mXLF_CONTENT_TYPE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        final XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;35m_parse[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                new [0m[1;35mXLIFF12ContentHandler[0m[1;39m([0m[39mxhtml, metadata[0m[1;39m)[0m[39m, context[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private static void [0m[1;35m_parse[0m[1;39m([0m[39mInputStream is, DefaultHandler contentHandler,[0m    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                               ParseContext context[0m[1;39m)[0m[39m throws SAXException, [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        SAXParserFactory factory = [0m[1;35mSAXParserFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        SAXParser parser = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            parser = [0m[1;35mfactory.newSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            throw new [0m[1;35mSAXException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;35mparser.parse[0m[1;39m([0m[39mis, contentHandler[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:520[0m[39m-[0m[1;36m539[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:    public static void [0m[1;35mparseSAX[0m[1;39m([0m[39mInputStream is, ContentHandler contentHandler, [0m [2m                [0m
[2;36m                    [0m         [39mParseContext context[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:            throws TikaException, IOException, SAXException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        SAXParser saxParser = [0m[1;35mcontext.get[0m[1;39m([0m[39mSAXParser.class[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:        PoolSAXParser poolSAXParser = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:        if [0m[1;39m([0m[39msaxParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m525[0m[39m:            poolSAXParser = [0m[1;35macquireSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m526[0m[39m:            if [0m[1;39m([0m[39mpoolSAXParser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m527[0m[39m:                saxParser = [0m[1;35mpoolSAXParser.getSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m529[0m[39m:                saxParser = [0m[1;35mgetSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:            [0m[1;35msaxParser.parse[0m[1;39m([0m[39mis, new [0m[1;35mOfflineContentHandler[0m[1;39m([0m[39mcontentHandler[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m535[0m[39m:            if [0m[1;39m([0m[39mpoolSAXParser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m536[0m[39m:                [0m[1;35mreleaseParser[0m[1;39m([0m[39mpoolSAXParser[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m537[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m538[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m539[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/test/java/org/apache/tika/utils/XMLReaderUtilsTest.jav[0m[1;92ma:30[0m[39m-[0m[1;36m54[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:public class XMLReaderUtilsTest [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[35m/[0m[95mmake[0m[39m sure that parseSAX actually defends against external entities[0m         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    public void [0m[1;35mtestExternalDTD[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:        String xml = [0m[32m"<!DOCTYPE foo SYSTEM [0m                                      [2m                [0m
[2;36m                    [0m         [32m\"http://127.234.172.38:7845/bar\"><foo/>"[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:            [0m[1;35mXMLReaderUtils.parseSAX[0m[1;39m([0m[39mnew [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mByteArrayInputStream[0m[1;39m([0m[1;35mxml.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[1;39m)[0m[39m,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:                    new [0m[1;35mToTextContentHandler[0m[1;39m([0m[1;39m)[0m[39m, new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mConnectException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:            [0m[1;35mfail[0m[1;39m([0m[32m"Parser tried to access the external DTD:"[0m[39m + e[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    public void [0m[1;35mtestExternalEntity[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        String xml =[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                [0m[32m"<!DOCTYPE foo [0m[32m[[0m[32m"[0m[39m + [0m[32m" <!ENTITY bar SYSTEM [0m                       [2m                [0m
[2;36m                    [0m         [32m\"http://127.234.172.38:7845/bar\">"[0m[39m +[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                        [0m[32m" [0m[32m][0m[32m><foo>&bar;</foo>"[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            [0m[1;35mXMLReaderUtils.parseSAX[0m[1;39m([0m[39mnew [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mByteArrayInputStream[0m[1;39m([0m[1;35mxml.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[1;39m)[0m[39m,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                    new [0m[1;35mToTextContentHandler[0m[1;39m([0m[1;39m)[0m[39m, new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mConnectException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:            [0m[1;35mfail[0m[1;39m([0m[32m"Parser tried to access the external DTD:"[0m[39m + e[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xml/XMLParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m88[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.xml;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.commons.io.input.CloseShieldInputStream;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.sax.EmbeddedContentHandler;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.sax.TaggedContentHandler;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.sax.TextContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.utils.XMLReaderUtils;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m: * XML parser.[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:public class XMLParser implements Parser [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * Serial version UID[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    private static final long serialVersionUID = -6028836725280212837L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    private static final Set<MediaType> SUPPORTED_TYPES = [0m                       [2m                [0m
[2;36m                    [0m         [1;35mCollections.unmodifiableSet[0m[1;39m([0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:            new HashSet<>[0m[1;39m([0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:                    [0m[1;35mArrays.asList[0m[1;39m([0m[1;35mMediaType.application[0m[1;39m([0m[32m"xml"[0m[1;39m)[0m[39m, [0m                 [2m                [0m
[2;36m                    [0m         [1;35mMediaType.image[0m[1;39m([0m[32m"svg+xml"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return SUPPORTED_TYPES;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m[32m"application/xml"[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        final XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mxhtml.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        TaggedContentHandler tagged = new [0m[1;35mTaggedContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            [0m[1;35mXMLReaderUtils.parseSAX[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                            new [0m[1;35mEmbeddedContentHandler[0m[1;39m([0m                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                                    [0m[1;35mgetContentHandler[0m[1;39m([0m[39mtagged, metadata, [0m         [2m                [0m
[2;36m                    [0m         [39mcontext[0m[1;39m)[0m[1;39m)[0m[39m,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                    context[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            [0m[1;35mtagged.throwIfCauseOf[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"XML parse error"[0m[39m, e[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:            [0m[1;35mxhtml.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    protected ContentHandler [0m[1;35mgetContentHandler[0m[1;39m([0m[39mContentHandler handler, Metadata [0m [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                                               ParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return new [0m[1;35mTextContentHandler[0m[1;39m([0m[39mhandler, true[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xml/DcXMLParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m60[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.xml;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.tika.metadata.DublinCore;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.tika.sax.TeeContentHandler;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: * Dublin Core metadata parser[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:public class DcXMLParser extends XMLParser [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * Serial version UID[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final long serialVersionUID = 4905318835463880819L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private static ContentHandler [0m[1;35mgetDublinCoreHandler[0m[1;39m([0m[39mMetadata metadata, [0m       [2m                [0m
[2;36m                    [0m         [39mProperty property,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:                                                       String element[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        return new [0m[1;35mElementMetadataHandler[0m[1;39m([0m[39mDublinCore.NAMESPACE_URI_DC, element, [0m [2m                [0m
[2;36m                    [0m         [39mmetadata, property[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    protected ContentHandler [0m[1;35mgetContentHandler[0m[1;39m([0m[39mContentHandler handler, Metadata [0m [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                                               ParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        return new [0m[1;35mTeeContentHandler[0m[1;39m([0m[1;35msuper.getContentHandler[0m[1;39m([0m[39mhandler, metadata, [0m [2m                [0m
[2;36m                    [0m         [39mcontext[0m[1;39m)[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                [0m[1;35mgetDublinCoreHandler[0m[1;39m([0m[39mmetadata, TikaCoreProperties.TITLE, [0m        [2m                [0m
[2;36m                    [0m         [32m"title"[0m[1;39m)[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                [0m[1;35mgetDublinCoreHandler[0m[1;39m([0m[39mmetadata, TikaCoreProperties.SUBJECT, [0m      [2m                [0m
[2;36m                    [0m         [32m"subject"[0m[1;39m)[0m[39m,[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                [0m[1;35mgetDublinCoreHandler[0m[1;39m([0m[39mmetadata, TikaCoreProperties.CREATOR, [0m      [2m                [0m
[2;36m                    [0m         [32m"creator"[0m[1;39m)[0m[39m,[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                [0m[1;35mgetDublinCoreHandler[0m[1;39m([0m[39mmetadata, TikaCoreProperties.DESCRIPTION, [0m  [2m                [0m
[2;36m                    [0m         [32m"description"[0m[1;39m)[0m[39m,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                [0m[1;35mgetDublinCoreHandler[0m[1;39m([0m[39mmetadata, TikaCoreProperties.PUBLISHER, [0m    [2m                [0m
[2;36m                    [0m         [32m"publisher"[0m[1;39m)[0m[39m,[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:                [0m[1;35mgetDublinCoreHandler[0m[1;39m([0m[39mmetadata, TikaCoreProperties.CONTRIBUTOR, [0m  [2m                [0m
[2;36m                    [0m         [32m"contributor"[0m[1;39m)[0m[39m,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;35mgetDublinCoreHandler[0m[1;39m([0m[39mmetadata, TikaCoreProperties.CREATED, [0m      [2m                [0m
[2;36m                    [0m         [32m"date"[0m[1;39m)[0m[39m,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:                [0m[1;35mgetDublinCoreHandler[0m[1;39m([0m[39mmetadata, TikaCoreProperties.TYPE, [0m[32m"type"[0m[1;39m)[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:                [0m[1;35mgetDublinCoreHandler[0m[1;39m([0m[39mmetadata, TikaCoreProperties.FORMAT, [0m       [2m                [0m
[2;36m                    [0m         [32m"format"[0m[1;39m)[0m[39m,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:                [0m[1;35mgetDublinCoreHandler[0m[1;39m([0m[39mmetadata, TikaCoreProperties.IDENTIFIER, [0m   [2m                [0m
[2;36m                    [0m         [32m"identifier"[0m[1;39m)[0m[39m,[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                [0m[1;35mgetDublinCoreHandler[0m[1;39m([0m[39mmetadata, TikaCoreProperties.LANGUAGE, [0m     [2m                [0m
[2;36m                    [0m         [32m"language"[0m[1;39m)[0m[39m,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:                [0m[1;35mgetDublinCoreHandler[0m[1;39m([0m[39mmetadata, TikaCoreProperties.RIGHTS, [0m       [2m                [0m
[2;36m                    [0m         [32m"rights"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xml/FictionBookParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m114[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.xml;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.commons.codec.binary.Base64;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.xml.sax.Attributes;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.xml.sax.helpers.DefaultHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public class FictionBookParser extends XMLParser [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private static final long serialVersionUID = 4195954546491524374L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    private static final Set<MediaType> SUPPORTED_TYPES =[0m                        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:            [0m[1;35mCollections.singleton[0m[1;39m([0m[1;35mMediaType.application[0m[1;39m([0m[32m"x-fictionbook+xml"[0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        return SUPPORTED_TYPES;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    protected ContentHandler [0m[1;35mgetContentHandler[0m[1;39m([0m[39mContentHandler handler, Metadata [0m [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                                               ParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        return new [0m[1;35mBinaryElementsDataHandler[0m[1;39m([0m                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mhandler[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private static class BinaryElementsDataHandler extends DefaultHandler [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        private static final String ELEMENT_BINARY = [0m[32m"binary"[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        private static final String ATTRIBUTE_ID = [0m[32m"id"[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        private static final String ATTRIBUTE_CONTENT_TYPE = [0m[32m"content-type"[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        private final EmbeddedDocumentExtractor partExtractor;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        private final ContentHandler handler;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        private final StringBuilder binaryData = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        private boolean binaryMode = false;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        private Metadata metadata;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        private [0m[1;35mBinaryElementsDataHandler[0m[1;39m([0m[39mEmbeddedDocumentExtractor [0m             [2m                [0m
[2;36m                    [0m         [39mpartExtractor,[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:                                          ContentHandler handler[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            this.partExtractor = partExtractor;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            this.handler = handler;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        @Override[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        public void [0m[1;35mstartElement[0m[1;39m([0m[39mString uri, String localName, String qName, [0m    [2m                [0m
[2;36m                    [0m         [39mAttributes attributes[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                throws SAXException [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            binaryMode = [0m[1;35mELEMENT_BINARY.equals[0m[1;39m([0m[39mlocalName[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            if [0m[1;39m([0m[39mbinaryMode[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                [0m[1;35mbinaryData.setLength[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY,[0m               [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                        [0m[1;35mattributes.getValue[0m[1;39m([0m[39mATTRIBUTE_ID[0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                             [2m                [0m
[2;36m                    [0m         [1;35mattributes.getValue[0m[1;39m([0m[39mATTRIBUTE_CONTENT_TYPE[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        @Override[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        public void [0m[1;35mendElement[0m[1;39m([0m[39mString uri, String localName, String qName[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows SAXException [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            if [0m[1;39m([0m[39mbinaryMode[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                try [0m[1;39m([0m[39mTikaInputStream tis = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mBase64.decodeBase64[0m[1;39m([0m[1;35mbinaryData.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                    [0m[1;35mpartExtractor.parseEmbedded[0m[1;39m([0m                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                            tis, handler, metadata, true[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                    throw new [0m[1;35mSAXException[0m[1;39m([0m[32m"IOException in parseEmbedded"[0m[39m, e[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                binaryMode = false;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                [0m[1;35mbinaryData.setLength[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        public void [0m[1;35mcharacters[0m[1;39m([0m[39mchar[0m[1;39m[[0m[1;39m][0m[39m ch, int start, int length[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            if [0m[1;39m([0m[39m!binaryMode[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                [0m[1;35mhandler.characters[0m[1;39m([0m[39mch, start, length[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                [0m[1;35mbinaryData.append[0m[1;39m([0m[39mch, start, length[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        public void [0m[1;35mignorableWhitespace[0m[1;39m([0m[39mchar[0m[1;39m[[0m[1;39m][0m[39m ch, int start, int length[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows SAXException [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;35mhandler.ignorableWhitespace[0m[1;39m([0m[39mch, start, length[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xliff/XLZParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m144[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.xliff;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.zip.ZipFile;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.zip.ZipInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.sax.EndDocumentShieldingContentHandler;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: * Parser for XLZ Archives.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:public class XLZParser implements Parser [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * Serial version UID[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    private static final long serialVersionUID = -1877314028666058564L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * Custom XLZ mime type.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private static final MediaType XLZ_CONTENT_TYPE = [0m                           [2m                [0m
[2;36m                    [0m         [1;35mMediaType.application[0m[1;39m([0m[32m"x-xliff+zip"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * Supported types set.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private static final Set<MediaType> SUPPORTED_TYPES = [0m                       [2m                [0m
[2;36m                    [0m         [1;35mCollections.singleton[0m[1;39m([0m[39mXLZ_CONTENT_TYPE[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * XLF Extension[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final String XLF = [0m[32m".xlf"[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * Shared Parser instance.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private Parser xliffParser = new [0m[1;35mXLIFF12Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        return SUPPORTED_TYPES;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler baseHandler, Metadata [0m  [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        ZipFile zipFile = null;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        ZipInputStream zipStream = null;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        if [0m[1;39m([0m[39mstream instanceof TikaInputStream[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:            TikaInputStream tis = [0m[1;39m([0m[39mTikaInputStream[0m[1;39m)[0m[39m stream;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            Object container = [0m[1;39m([0m[1;39m([0m[39mTikaInputStream[0m[1;39m)[0m[39m stream[0m[1;39m)[0m[1;35m.getOpenContainer[0m[1;39m([0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            if [0m[1;39m([0m[39mcontainer instanceof ZipFile[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                zipFile = [0m[1;39m([0m[39mZipFile[0m[1;39m)[0m[39m container;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mtis.hasFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                zipFile = new [0m[1;35mZipFile[0m[1;39m([0m[1;35mtis.getFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                zipStream = new [0m[1;35mZipInputStream[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            zipStream = new [0m[1;35mZipInputStream[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[35m/[0m[35m/[0m[39m Prepare to handle the content[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mbaseHandler, [0m        [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        EndDocumentShieldingContentHandler handler = new [0m                        [2m                [0m
[2;36m                    [0m         [1;35mEndDocumentShieldingContentHandler[0m[1;39m([0m[39mxhtml[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        if [0m[1;39m([0m[39mzipFile != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                [0m[1;35mhandleZipFile[0m[1;39m([0m[39mzipFile, metadata, context, handler[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                [0m[1;35mzipFile.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[1;35mhandleZipStream[0m[1;39m([0m[39mzipStream, metadata, context, handler[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                [0m[1;35mzipStream.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        if [0m[1;39m([0m[1;35mhandler.isEndDocumentWasCalled[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;35mhandler.reallyEndDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    private void [0m[1;35mhandleZipStream[0m[1;39m([0m[39mZipInputStream zipStream, Metadata metadata, [0m  [2m                [0m
[2;36m                    [0m         [39mParseContext context,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                                 EndDocumentShieldingContentHandler handler[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            throws IOException, TikaException, SAXException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        ZipEntry entry = [0m[1;35mzipStream.getNextEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        if [0m[1;39m([0m[39mentry == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"No entries found in ZipInputStream"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        while [0m[1;39m([0m[39mentry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            if [0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[39mXLF[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;35mxliffParser.parse[0m[1;39m([0m[39mzipStream, handler, metadata, context[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            entry = [0m[1;35mzipStream.getNextEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    private void [0m[1;35mhandleZipFile[0m[1;39m([0m[39mZipFile zipFile, Metadata metadata, ParseContext[0m [2m                [0m
[2;36m                    [0m         [39mcontext,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                               EndDocumentShieldingContentHandler handler[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            throws IOException, TikaException, SAXException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        Enumeration<? extends ZipEntry> entries = [0m[1;35mzipFile.entries[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        while [0m[1;39m([0m[1;35mentries.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            ZipEntry entry = [0m[1;35mentries.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            if [0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[39mXLF[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                [0m[1;35mxliffParser.parse[0m[1;39m([0m[1;35mzipFile.getInputStream[0m[1;39m([0m[39mentry[0m[1;39m)[0m[39m, handler, [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata, context[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/mime/MimeTypesReader.jav[0m[1;92ma:19[0m[39m-[0m[1;36m48[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.net.URI;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.net.URISyntaxException;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.concurrent.ArrayBlockingQueue;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.concurrent.locks.ReentrantReadWriteLock;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import javax.xml.XMLConstants;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import javax.xml.parsers.SAXParser;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import javax.xml.parsers.SAXParserFactory;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import javax.xml.transform.Transformer;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import javax.xml.transform.TransformerException;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import javax.xml.transform.dom.DOMSource;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import javax.xml.transform.sax.SAXResult;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.commons.io.input.UnsynchronizedByteArrayInputStream;[0m           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.w3c.dom.Document;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.xml.sax.Attributes;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.xml.sax.InputSource;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.xml.sax.helpers.DefaultHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.utils.XMLReaderUtils;[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/mime/MimeTypesReader.jav[0m[1;92ma:213[0m[39m-[0m[1;36m227[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    private static SAXParser [0m[1;35mnewSAXParser[0m[1;39m([0m[1;39m)[0m[39m throws TikaException [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        SAXParserFactory factory = [0m[1;35mSAXParserFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            [0m[1;35mfactory.setFeature[0m[1;39m([0m[39mXMLConstants.FEATURE_SECURE_PROCESSING, true[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException | SAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"can't set secure processing feature on: "[0m[39m + [0m              [2m                [0m
[2;36m                    [0m         [1;35mfactory.getClass[0m[1;39m([0m[1;39m)[0m[39m +[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                    [0m[32m". User assumes responsibility for consequences."[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            return [0m[1;35mfactory.newSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException | SAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:            throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"Can't create new sax parser"[0m[39m, e[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/sax/OfflineContentHandler.jav[0m[1;92ma:1[0m[39m-[0m[1;36m45[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.sax;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.commons.io.input.ClosedInputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.xml.sax.InputSource;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: * Content handler decorator that always returns an empty stream from the[0m        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: * [0m[1;39m{[0m[39m@link #[0m[1;35mresolveEntity[0m[1;39m([0m[39mString, String[0m[1;39m)[0m[1;39m}[0m[39m method to prevent potential[0m            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * network or other external resources from being accessed by an XML parser.[0m     [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: * @see <a [0m[33mhref[0m[39m=[0m[32m"https[0m[32m://issues.apache.org/jira/browse/TIKA-185"[0m[39m>TIKA-[0m[1;36m185[0m[39m<[0m[35m/[0m[95ma[0m[39m>[0m    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:public class OfflineContentHandler extends ContentHandlerDecorator [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    public [0m[1;35mOfflineContentHandler[0m[1;39m([0m[39mContentHandler handler[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Returns an empty stream. This will make an XML parser silently[0m            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * ignore any external entities.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public InputSource [0m[1;35mresolveEntity[0m[1;39m([0m[39mString publicId, String systemId[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        return new [0m[1;35mInputSource[0m[1;39m([0m[39mnew [0m[1;35mClosedInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:68[0m[39m-[0m[1;36m80[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:public class XMLReaderUtils implements Serializable [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Default size for the pool of SAX Parsers[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * and the pool of DOM builders[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public static final int DEFAULT_POOL_SIZE = [0m[1;36m10[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    public static final int DEFAULT_MAX_ENTITY_EXPANSIONS = [0m[1;36m20[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * Serial version UID[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    private static final long serialVersionUID = 6110455808615143122L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private static final Logger LOG = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mXMLReaderUtils.class[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:123[0m[39m-[0m[1;36m124[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    private static final EntityResolver IGNORING_SAX_ENTITY_RESOLVER =[0m          [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            [0m[1;39m([0m[39mpublicId, systemId[0m[1;39m)[0m[39m -> new [0m[1;35mInputSource[0m[1;39m([0m[39mnew [0m[1;35mStringReader[0m[1;39m([0m[32m""[0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:218[0m[39m-[0m[1;36m234[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    public static SAXParserFactory [0m[1;35mgetSAXParserFactory[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:        SAXParserFactory factory = [0m[1;35mSAXParserFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:        if [0m[1;39m([0m[1;35mLOG.isDebugEnabled[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"SAXParserFactory class [0m[32m{[0m[32m}[0m[32m"[0m[39m, [0m[1;35mfactory.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:        [0m[1;35mfactory.setValidating[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, XMLConstants.FEATURE_SECURE_PROCESSING, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, [0m                                              [2m                [0m
[2;36m                    [0m         [32m"http://xml.org/sax/features/external-general-entities"[0m[39m, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, [0m                                              [2m                [0m
[2;36m                    [0m         [32m"http://xml.org/sax/features/external-parameter-entities"[0m[39m, false[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, [0m                                              [2m                [0m
[2;36m                    [0m         [32m"http://apache.org/xml/features/nonvalidating/load-external-dtd"[0m[39m,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                false[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, [0m                                              [2m                [0m
[2;36m                    [0m         [32m"http://apache.org/xml/features/nonvalidating/load-dtd-grammar"[0m[39m,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                false[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:        return factory;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:963[0m[39m-[0m[1;36m971[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m963[0m[39m:    private static void [0m[1;35mclearReader[0m[1;39m([0m[39mXMLReader reader[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m964[0m[39m:        if [0m[1;39m([0m[39mreader == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m965[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m966[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m967[0m[39m:        [0m[1;35mreader.setContentHandler[0m[1;39m([0m[39mIGNORING_CONTENT_HANDLER[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m968[0m[39m:        [0m[1;35mreader.setDTDHandler[0m[1;39m([0m[39mIGNORING_DTD_HANDLER[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m969[0m[39m:        [0m[1;35mreader.setEntityResolver[0m[1;39m([0m[39mIGNORING_SAX_ENTITY_RESOLVER[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m970[0m[39m:        [0m[1;35mreader.setErrorHandler[0m[1;39m([0m[39mIGNORING_ERROR_HANDLER[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m971[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/java/org/[0m [2m                [0m
[2;36m                    [0m         [39mapache/tika/parser/TestXXEInXML.jav[0m[1;92ma:1[0m[39m-[0m[1;36m100[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *      [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static org.junit.jupiter.api.Assertions.fail;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.FileNotFoundException;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import javax.xml.parsers.SAXParser;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import javax.xml.parsers.SAXParserFactory;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.openxml4j.exceptions.InvalidFormatException;[0m               [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.junit.jupiter.api.Disabled;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.junit.jupiter.api.Test;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.config.TikaConfig;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.parser.microsoft.OfficeParserConfig;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.sax.ToHTMLContentHandler;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.utils.XMLReaderUtils;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m: * This tests for XXE in basically xml type files, straight xml and zipped[0m       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m: * xmls, e.g. ebook and ooxml.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m: * It does not test for XXE prevention in files that may contain xml[0m             [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m: * files, such as PDFs and other XMP-containing files.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:public class TestXXEInXML extends XMLTestBase [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[35m/[0m[35m/[0m[95mTODO[0m[39m: figure out how to test XFA and xmp in PDFs[0m                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private static final byte[0m[1;39m[[0m[1;39m][0m[39m XXE =[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            [0m[32m"<!DOCTYPE roottag PUBLIC \"-//OXML/XXE/EN\" [0m                        [2m                [0m
[2;36m                    [0m         [32m\"file:///couldnt_possibly_exist\">"[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                    [0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    @[0m[1;35mDisabled[0m[1;39m([0m[32m"ignore vulnerable tests"[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    public void [0m[1;35mtestConfirmVulnerable[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            [0m[1;35mparse[0m[1;39m([0m[32m"testXXE.xml"[0m[39m, [0m                                                [2m                [0m
[2;36m                    [0m         [1;35mgetResourceAsStream[0m[1;39m([0m[32m"/test-documents/testXXE.xml"[0m[1;39m)[0m[39m,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:                    new [0m[1;35mVulnerableSAXParser[0m[1;39m([0m[1;39m)[0m[39m, new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            [0m[1;35mfail[0m[1;39m([0m[32m"should have failed!!!"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mFileNotFoundException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            [0m[35m/[0m[35m/[0m[95mexpected[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    public void [0m[1;35mtestXML[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        try [0m[1;39m([0m[39mInputStream is = [0m                                                   [2m                [0m
[2;36m                    [0m         [1;35mgetResourceAsStream[0m[1;39m([0m[32m"/test-documents/testXXE.xml"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            [0m[1;35mparse[0m[1;39m([0m[32m"testXXE.xml"[0m[39m, is, AUTO_DETECT_PARSER, new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    public void [0m[1;35mtestInjectedXML[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m bytes = [0m[32m"<?xml [0m[32mversion[0m[32m=\"1.0\" [0m                                   [2m                [0m
[2;36m                    [0m         [32mencoding[0m[32m=\"UTF-8\"?><document>blah</document>"[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m injected = [0m[1;35minjectXML[0m[1;39m([0m[39mbytes, XXE[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[1;35mparse[0m[1;39m([0m[32m"injected"[0m[39m, new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39minjected[0m[1;39m)[0m[39m, new [0m           [2m                [0m
[2;36m                    [0m         [1;35mVulnerableSAXParser[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            [0m[1;35mfail[0m[1;39m([0m[32m"injected should have triggered xxe"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mFileNotFoundException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            [0m[35m/[0m[35m/[0m[95mexpected[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    public void [0m[1;35mtest2003_2006xml[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        InputStream is = [0m                                                        [2m                [0m
[2;36m                    [0m         [1;35mgetResourceAsStream[0m[1;39m([0m[32m"/test-documents/testWORD_2003ml.xml"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        ByteArrayOutputStream bos = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, bos[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m injected = [0m[1;35minjectXML[0m[1;39m([0m[1;35mbos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m, XXE[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        [0m[1;35mparse[0m[1;39m([0m[32m"testWORD_2003ml.xml"[0m[39m, new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39minjected[0m[1;39m)[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mAUTO_DETECT_PARSER,[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;35mis.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/java/org/[0m [2m                [0m
[2;36m                    [0m         [39mapache/tika/parser/XMLTestBase.jav[0m[1;92ma:19[0m[39m-[0m[1;36m46[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.FileOutputStream;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.zip.ZipFile;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.zip.ZipOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import javax.xml.parsers.SAXParser;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import javax.xml.parsers.SAXParserFactory;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.xml.sax.helpers.DefaultHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.TikaTest;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.sax.TaggedContentHandler;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.sax.TextContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/java/org/[0m [2m                [0m
[2;36m                    [0m         [39mapache/tika/parser/XMLTestBase.jav[0m[1;92ma:131[0m[39m-[0m[1;36m153[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    static class VulnerableSAXParser implements Parser [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            return [0m[1;35mCollections.singleton[0m[1;39m([0m[39mMediaType.APPLICATION_XML[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                          ParseContext context[0m[1;39m)[0m[39m throws IOException, [0m            [2m                [0m
[2;36m                    [0m         [39mSAXException, TikaException [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            TaggedContentHandler tagged = new [0m[1;35mTaggedContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                SAXParserFactory saxParserFactory = SAXParserFactory[0m            [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:                        [0m[1;35m.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:                SAXParser parser = [0m[1;35msaxParserFactory.newSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                [0m[1;35mparser.parse[0m[1;39m([0m[39mstream, new [0m[1;35mTextContentHandler[0m[1;39m([0m[39mhandler, true[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"parser config ex"[0m[39m, e[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/java/org/[0m [2m                [0m
[2;36m                    [0m         [39mapache/tika/parser/TestXXEInXML.jav[0m[1;92ma:195[0m[39m-[0m[1;36m204[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    public void [0m[1;35mtestDOM[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m bytes = [0m[32m"<?xml [0m[32mversion[0m[32m=\"1.0\" [0m                                  [2m                [0m
[2;36m                    [0m         [32mencoding[0m[32m=\"UTF-8\"?><document>blah</document>"[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m injected = [0m[1;35minjectXML[0m[1;39m([0m[39mbytes, XXE[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mXMLReaderUtils.getPoolSize[0m[1;39m([0m[1;39m)[0m[39m * [0m[1;36m2[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[35m/[0m[35m/[0m[95mthis[0m[39m shouldn't throw an exception[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:            [0m[1;35mXMLReaderUtils.buildDOM[0m[1;39m([0m[39mnew [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39minjected[0m[1;39m)[0m[39m, new [0m    [2m                [0m
[2;36m                    [0m         [1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/java/org/[0m [2m                [0m
[2;36m                    [0m         [39mapache/tika/parser/TestXXEInXML.jav[0m[1;92ma:232[0m[39m-[0m[1;36m243[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    public void [0m[1;35mtestDOMTikaConfig[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:        [0m[35m/[0m[35m/[0m[95mtests[0m[39m the DOM reader in TikaConfig[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:        [0m[35m/[0m[35m/[0m[95mif[0m[39m the safeguards aren't in place, this throws a FNFE[0m                 [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:        try [0m[1;39m([0m[39mInputStream is = [0m[1;35mgetResourceAsStream[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                [0m[32m"/org/apache/tika/config/TIKA-1558-exclude.xml"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:            ByteArrayOutputStream bos = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:            [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, bos[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m injected = [0m[1;35minjectXML[0m[1;39m([0m[1;35mbos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m, XXE[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:            TikaConfig tikaConfig = new [0m[1;35mTikaConfig[0m[1;39m([0m[39mnew [0m                         [2m                [0m
[2;36m                    [0m         [1;35mByteArrayInputStream[0m[1;39m([0m[39minjected[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xliff/XLIFF12Parser.jav[0m[1;92ma:19[0m[39m-[0m[1;36m38[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import javax.xml.parsers.SAXParser;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import javax.xml.parsers.SAXParserFactory;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.commons.io.input.CloseShieldInputStream;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.xml.sax.helpers.DefaultHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xliff/XLIFF12Parser.jav[0m[1;92ma:65[0m[39m-[0m[1;36m91[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m[1;35mXLF_CONTENT_TYPE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        final XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;35m_parse[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                new [0m[1;35mXLIFF12ContentHandler[0m[1;39m([0m[39mxhtml, metadata[0m[1;39m)[0m[39m, context[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private static void [0m[1;35m_parse[0m[1;39m([0m[39mInputStream is, DefaultHandler contentHandler,[0m    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                               ParseContext context[0m[1;39m)[0m[39m throws SAXException, [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        SAXParserFactory factory = [0m[1;35mSAXParserFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        SAXParser parser = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            parser = [0m[1;35mfactory.newSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            throw new [0m[1;35mSAXException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;35mparser.parse[0m[1;39m([0m[39mis, contentHandler[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xml/XMLParser.jav[0m[1;92ma:17[0m[39m-[0m[1;36m39[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.xml;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.commons.io.input.CloseShieldInputStream;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.sax.EmbeddedContentHandler;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.sax.TaggedContentHandler;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.sax.TextContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.utils.XMLReaderUtils;[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xml/XMLParser.jav[0m[1;92ma:59[0m[39m-[0m[1;36m82[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m[32m"application/xml"[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        final XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mxhtml.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        TaggedContentHandler tagged = new [0m[1;35mTaggedContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            [0m[1;35mXMLReaderUtils.parseSAX[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                            new [0m[1;35mEmbeddedContentHandler[0m[1;39m([0m                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                                    [0m[1;35mgetContentHandler[0m[1;39m([0m[39mtagged, metadata, [0m         [2m                [0m
[2;36m                    [0m         [39mcontext[0m[1;39m)[0m[1;39m)[0m[39m,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                    context[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            [0m[1;35mtagged.throwIfCauseOf[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"XML parse error"[0m[39m, e[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:            [0m[1;35mxhtml.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:218[0m[39m-[0m[1;36m234[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    public static SAXParserFactory [0m[1;35mgetSAXParserFactory[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:        SAXParserFactory factory = [0m[1;35mSAXParserFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:        if [0m[1;39m([0m[1;35mLOG.isDebugEnabled[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"SAXParserFactory class [0m[32m{[0m[32m}[0m[32m"[0m[39m, [0m[1;35mfactory.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:        [0m[1;35mfactory.setValidating[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, XMLConstants.FEATURE_SECURE_PROCESSING, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, [0m                                              [2m                [0m
[2;36m                    [0m         [32m"http://xml.org/sax/features/external-general-entities"[0m[39m, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, [0m                                              [2m                [0m
[2;36m                    [0m         [32m"http://xml.org/sax/features/external-parameter-entities"[0m[39m, false[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, [0m                                              [2m                [0m
[2;36m                    [0m         [32m"http://apache.org/xml/features/nonvalidating/load-external-dtd"[0m[39m,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                false[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:        [0m[1;35mtrySetSAXFeature[0m[1;39m([0m[39mfactory, [0m                                              [2m                [0m
[2;36m                    [0m         [32m"http://apache.org/xml/features/nonvalidating/load-dtd-grammar"[0m[39m,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                false[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:        return factory;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:520[0m[39m-[0m[1;36m539[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:    public static void [0m[1;35mparseSAX[0m[1;39m([0m[39mInputStream is, ContentHandler contentHandler, [0m [2m                [0m
[2;36m                    [0m         [39mParseContext context[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:            throws TikaException, IOException, SAXException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        SAXParser saxParser = [0m[1;35mcontext.get[0m[1;39m([0m[39mSAXParser.class[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:        PoolSAXParser poolSAXParser = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:        if [0m[1;39m([0m[39msaxParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m525[0m[39m:            poolSAXParser = [0m[1;35macquireSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m526[0m[39m:            if [0m[1;39m([0m[39mpoolSAXParser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m527[0m[39m:                saxParser = [0m[1;35mpoolSAXParser.getSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m529[0m[39m:                saxParser = [0m[1;35mgetSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:            [0m[1;35msaxParser.parse[0m[1;39m([0m[39mis, new [0m[1;35mOfflineContentHandler[0m[1;39m([0m[39mcontentHandler[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m535[0m[39m:            if [0m[1;39m([0m[39mpoolSAXParser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m536[0m[39m:                [0m[1;35mreleaseParser[0m[1;39m([0m[39mpoolSAXParser[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m537[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m538[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m539[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/sax/OfflineContentHandler.jav[0m[1;92ma:36[0m[39m-[0m[1;36m43[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Returns an empty stream. This will make an XML parser silently[0m            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * ignore any external entities.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public InputSource [0m[1;35mresolveEntity[0m[1;39m([0m[39mString publicId, String systemId[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        return new [0m[1;35mInputSource[0m[1;39m([0m[39mnew [0m[1;35mClosedInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xliff/XLIFF12Parser.jav[0m[1;92ma:78[0m[39m-[0m[1;36m89[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private static void [0m[1;35m_parse[0m[1;39m([0m[39mInputStream is, DefaultHandler contentHandler,[0m    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                               ParseContext context[0m[1;39m)[0m[39m throws SAXException, [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        SAXParserFactory factory = [0m[1;35mSAXParserFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        SAXParser parser = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            parser = [0m[1;35mfactory.newSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            throw new [0m[1;35mSAXException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;35mparser.parse[0m[1;39m([0m[39mis, contentHandler[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xml/XMLParser.jav[0m[1;92ma:70[0m[39m-[0m[1;36m74[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            [0m[1;35mXMLReaderUtils.parseSAX[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                            new [0m[1;35mEmbeddedContentHandler[0m[1;39m([0m                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                                    [0m[1;35mgetContentHandler[0m[1;39m([0m[39mtagged, metadata, [0m         [2m                [0m
[2;36m                    [0m         [39mcontext[0m[1;39m)[0m[1;39m)[0m[39m,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                    context[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/test/java/org/apache/tika/parser/xliff/XLIFF12ParserTest.jav[0m[1;92ma:31[0m[39m-[0m[1;36m55[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:public class XLIFF12ParserTest extends TikaTest [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public void [0m[1;35mtestXLIFF12[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        try [0m[1;39m([0m[39mInputStream input = [0m                                                [2m                [0m
[2;36m                    [0m         [1;35mgetResourceAsStream[0m[1;39m([0m[32m"/test-documents/testXLIFF12.xlf"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:            Metadata metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:            ContentHandler handler = new [0m[1;35mBodyContentHandler[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:            new [0m[1;35mXLIFF12Parser[0m[1;39m([0m[1;39m)[0m[1;35m.parse[0m[1;39m([0m[39minput, handler, metadata, new [0m             [2m                [0m
[2;36m                    [0m         [1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:            String content = [0m[1;35mhandler.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:            [0m[1;35massertContains[0m[1;39m([0m[32m"Hooray"[0m[39m, content[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:            [0m[1;35massertEquals[0m[1;39m([0m[32m"2"[0m[39m, [0m[1;35mmetadata.get[0m[1;39m([0m[32m"file-count"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:            [0m[1;35massertEquals[0m[1;39m([0m[32m"4"[0m[39m, [0m[1;35mmetadata.get[0m[1;39m([0m[32m"tu-count"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:            [0m[1;35massertEquals[0m[1;39m([0m[32m"en"[0m[39m, [0m[1;35mmetadata.get[0m[1;39m([0m[32m"source-language"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            [0m[1;35massertEquals[0m[1;39m([0m[32m"fr"[0m[39m, [0m[1;35mmetadata.get[0m[1;39m([0m[32m"target-language"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    public void [0m[1;35mtestXLIFF12ToXMLHandler[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        String xml = [0m[1;35mgetXML[0m[1;39m([0m[32m"testXLIFF12.xlf"[0m[1;39m)[0m[39m.xml;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;35massertContains[0m[1;39m([0m[32m"<p [0m[32mlang[0m[32m=\"en\">Another trans-unit</p>"[0m[39m, xml[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;35massertContains[0m[1;39m([0m[32m"<p [0m[32mlang[0m[32m=\"fr\">Un autre trans-unit</p>"[0m[39m, xml[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xliff/XLIFF12ContentHandler.jav[0m[1;92ma:30[0m[39m-[0m[1;36m132[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:public class XLIFF12ContentHandler extends DefaultHandler [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    private final XHTMLContentHandler xhtml;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    private final Metadata metadata;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private int numberOfFiles = [0m[1;36m0[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    private int numberOfTUs = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private boolean inTransUnit = false;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[1;35mXLIFF12ContentHandler[0m[1;39m([0m[39mXHTMLContentHandler xhtml, Metadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        this.xhtml = xhtml;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        this.metadata = metadata;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    public void [0m[1;35mstartDocument[0m[1;39m([0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        [0m[1;35mxhtml.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    public void [0m[1;35mstartElement[0m[1;39m([0m[39mString uri, String localName, String qName, [0m        [2m                [0m
[2;36m                    [0m         [39mAttributes attributes[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            throws SAXException [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        final AttributesImpl attributeVals = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;35mattributeVals.setAttributes[0m[1;39m([0m[39mattributes[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        if [0m[1;39m([0m[32m"file"[0m[1;35m.equals[0m[1;39m([0m[39mlocalName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:            numberOfFiles++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:            [0m[35m/[0m[35m/[0m[39m Write out the original file name[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            [0m[1;35mmetadata.add[0m[1;39m([0m[32m"original"[0m[39m, [0m[1;35mattributes.getValue[0m[1;39m([0m[32m"source-language"[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"div"[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"h1"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[1;35mattributes.getValue[0m[1;39m([0m[32m"original"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"h1"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            [0m[35m/[0m[35m/[0m[39m Add the files source [0m[1;39m([0m[39mmandatory[0m[1;39m)[0m[39m and target [0m[1;39m([0m[39moptional[0m[1;39m)[0m[39m languages[0m  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            [0m[1;35mmetadata.add[0m[1;39m([0m[32m"source-language"[0m[39m, [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mattributes.getValue[0m[1;39m([0m[32m"source-language"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            if [0m[1;39m([0m[39mnull != [0m[1;35mattributes.getValue[0m[1;39m([0m[32m"target-language"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[32m"target-language"[0m[39m, [0m                                 [2m                [0m
[2;36m                    [0m         [1;35mattributes.getValue[0m[1;39m([0m[32m"target-language"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        if [0m[1;39m([0m[32m"trans-unit"[0m[1;35m.equals[0m[1;39m([0m[39mlocalName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            numberOfTUs++;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            inTransUnit = true;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"div"[0m[39m, attributeVals[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        if [0m[1;39m([0m[32m"source"[0m[1;35m.equals[0m[1;39m([0m[39mlocalName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:            AttributesImpl attrs = [0m[1;35mextractAttributes[0m[1;39m([0m[39mattributes[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"p"[0m[39m, attrs[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[32m"target"[0m[1;35m.equals[0m[1;39m([0m[39mlocalName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            AttributesImpl attrs = [0m[1;35mextractAttributes[0m[1;39m([0m[39mattributes[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"p"[0m[39m, attrs[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    private AttributesImpl [0m[1;35mextractAttributes[0m[1;39m([0m[39mAttributes attributes[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        AttributesImpl attrs = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        if [0m[1;39m([0m[39mnull != [0m[1;35mattributes.getValue[0m[1;39m([0m[32m"xml:lang"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            [0m[1;35mattrs.addAttribute[0m[1;39m([0m[32m""[0m[39m, [0m[32m"lang"[0m[39m, [0m[32m"lang"[0m[39m, [0m[32m""[0m[39m, [0m                          [2m                [0m
[2;36m                    [0m         [1;35mattributes.getValue[0m[1;39m([0m[32m"xml:lang"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        return attrs;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public void [0m[1;35mendElement[0m[1;39m([0m[39mString uri, String localName, String qName[0m[1;39m)[0m[39m throws [0m   [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        if [0m[1;39m([0m[32m"file"[0m[1;35m.equals[0m[1;39m([0m[39mlocalName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"div"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        if [0m[1;39m([0m[32m"trans-unit"[0m[1;35m.equals[0m[1;39m([0m[39mlocalName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            inTransUnit = false;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"div"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        if [0m[1;39m([0m[32m"source"[0m[1;35m.equals[0m[1;39m([0m[39mlocalName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        if [0m[1;39m([0m[32m"target"[0m[1;35m.equals[0m[1;39m([0m[39mlocalName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    public void [0m[1;35mcharacters[0m[1;39m([0m[39mchar[0m[1;39m[[0m[1;39m][0m[39m ch, int start, int length[0m[1;39m)[0m[39m throws [0m            [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        if [0m[1;39m([0m[39minTransUnit && length != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:            [0m[1;35mxhtml.characters[0m[1;39m([0m[39mch, start, length[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    public void [0m[1;35mendDocument[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[32m"file-count"[0m[39m, [0m[1;35mString.valueOf[0m[1;39m([0m[39mnumberOfFiles[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[32m"tu-count"[0m[39m, [0m[1;35mString.valueOf[0m[1;39m([0m[39mnumberOfTUs[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/xliff/XLIFF12Parser.jav[0m[1;92ma:65[0m[39m-[0m[1;36m91[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m[1;35mXLF_CONTENT_TYPE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        final XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;35m_parse[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                new [0m[1;35mXLIFF12ContentHandler[0m[1;39m([0m[39mxhtml, metadata[0m[1;39m)[0m[39m, context[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private static void [0m[1;35m_parse[0m[1;39m([0m[39mInputStream is, DefaultHandler contentHandler,[0m    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                               ParseContext context[0m[1;39m)[0m[39m throws SAXException, [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        SAXParserFactory factory = [0m[1;35mSAXParserFactory.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;35mfactory.setNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        SAXParser parser = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            parser = [0m[1;35mfactory.newSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            throw new [0m[1;35mSAXException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;35mparser.parse[0m[1;39m([0m[39mis, contentHandler[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:520[0m[39m-[0m[1;36m539[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:    public static void [0m[1;35mparseSAX[0m[1;39m([0m[39mInputStream is, ContentHandler contentHandler, [0m [2m                [0m
[2;36m                    [0m         [39mParseContext context[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:            throws TikaException, IOException, SAXException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        SAXParser saxParser = [0m[1;35mcontext.get[0m[1;39m([0m[39mSAXParser.class[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:        PoolSAXParser poolSAXParser = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:        if [0m[1;39m([0m[39msaxParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m525[0m[39m:            poolSAXParser = [0m[1;35macquireSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m526[0m[39m:            if [0m[1;39m([0m[39mpoolSAXParser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m527[0m[39m:                saxParser = [0m[1;35mpoolSAXParser.getSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m529[0m[39m:                saxParser = [0m[1;35mgetSAXParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:            [0m[1;35msaxParser.parse[0m[1;39m([0m[39mis, new [0m[1;35mOfflineContentHandler[0m[1;39m([0m[39mcontentHandler[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m535[0m[39m:            if [0m[1;39m([0m[39mpoolSAXParser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m536[0m[39m:                [0m[1;35mreleaseParser[0m[1;39m([0m[39mpoolSAXParser[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m537[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m538[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m539[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy for XLIFF12Parser SSRF/XXE Vulnerability[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Root Cause Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe XLIFF12Parser has a critical Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability [0m  [2m                [0m
[2;36m                    [0m         [39mstemming from XML External Entity [0m[1;39m([0m[39mXXE[0m[1;39m)[0m[39m processing. The root cause is in the [0m       [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35m_parse[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m78[0m[39m-[0m[1;36m89[0m[1;39m)[0m[39m which creates an insecure SAXParser:[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerable Pattern:**[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- Creates `SAXParserFactory` directly without security configuration[0m                [2m                [0m
[2;36m                    [0m         [39m- Only sets `[0m[1;35msetNamespaceAware[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m` - no security features[0m                        [2m                [0m
[2;36m                    [0m         [39m- No entity resolver configured to block external entity resolution[0m                 [2m                [0m
[2;36m                    [0m         [39m- Allows external entity references by default, enabling SSRF attacks[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe parser attempted to connect to `jazze.com:[0m[1;36m80[0m[39m` when processing XML input [0m        [2m                [0m
[2;36m                    [0m         [39mcontaining external entity references, which was correctly detected by the fuzzer's[0m [2m                [0m
[2;36m                    [0m         [39mSSRF sanitizer.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Comprehensive Fix Implementation[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Primary Fix: Replace Insecure Parsing with [0m[1;35mXMLReaderUtils.parseSAX[0m[1;39m([0m[1;39m)[0m[39m**[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace the entire `[0m[1;35m_parse[0m[1;39m([0m[1;39m)[0m[39m` method implementation to use Tika's secure XML [0m       [2m                [0m
[2;36m                    [0m         [39mparsing utilities:[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File:** [0m                                                                          [2m                [0m
[2;36m                    [0m         [39m`tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/xliff/XLIFF12Parser.java`[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes Required:**[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Add import statement** [0m[1;39m([0m[39mafter line [0m[1;36m22[0m[1;39m)[0m[39m:[0m                                        [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   import org.apache.tika.utils.XMLReaderUtils;[0m                                     [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Replace the [0m[1;35m_parse[0m[1;39m([0m[1;39m)[0m[39m method** [0m[1;39m([0m[39mlines [0m[1;36m78[0m[39m-[0m[1;36m89[0m[1;39m)[0m[39m with:[0m                              [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   private static void [0m[1;35m_parse[0m[1;39m([0m[39mInputStream is, DefaultHandler contentHandler,[0m        [2m                [0m
[2;36m                    [0m         [39m                              ParseContext context[0m[1;39m)[0m[39m throws SAXException, [0m           [2m                [0m
[2;36m                    [0m         [39mIOException, TikaException [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mXMLReaderUtils.parseSAX[0m[1;39m([0m[39mis, contentHandler, context[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Update method signature** [0m[1;39m([0m[39mline [0m[1;36m78[0m[1;39m)[0m[39m to include `TikaException`:[0m                [2m                [0m
[2;36m                    [0m         [39m   - Change: `throws SAXException, IOException`[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - To: `throws SAXException, IOException, TikaException`[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Complete implementation:**[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- Remove lines [0m[1;36m80[0m[39m-[0m[1;36m88[0m[39m [0m[1;39m([0m[39mthe entire vulnerable SAXParser creation and configuration [0m   [2m                [0m
[2;36m                    [0m         [39mcode[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- Replace with single call to `[0m[1;35mXMLReaderUtils.parseSAX[0m[1;39m([0m[39mis, contentHandler, [0m         [2m                [0m
[2;36m                    [0m         [39mcontext[0m[1;39m)[0m[39m`[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m- Remove now-unused import: `javax.xml.parsers.ParserConfigurationException` [0m[1;39m([0m[39mline [0m [2m                [0m
[2;36m                    [0m         [1;36m24[0m[1;39m)[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m- Remove now-unused import: `javax.xml.parsers.SAXParser` [0m[1;39m([0m[39mline [0m[1;36m25[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [39m- Remove now-unused import: `javax.xml.parsers.SAXParserFactory` [0m[1;39m([0m[39mline [0m[1;36m26[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Security Benefits Provided by [0m[1;35mXMLReaderUtils.parseSAX[0m[1;39m([0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix leverages Tika's multi-layered defense-in-depth approach:[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Layer [0m[1;36m1[0m[39m - SAXParserFactory Security Features:**[0m                                   [2m                [0m
[2;36m                    [0m         [39m- `FEATURE_SECURE_PROCESSING`: enabled[0m                                              [2m                [0m
[2;36m                    [0m         [39m- `external-general-entities`: disabled[0m                                             [2m                [0m
[2;36m                    [0m         [39m- `external-parameter-entities`: disabled[0m                                           [2m                [0m
[2;36m                    [0m         [39m- `load-external-dtd`: disabled[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- `load-dtd-grammar`: disabled[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Layer [0m[1;36m2[0m[39m - Entity Resolver:**[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- `IGNORING_SAX_ENTITY_RESOLVER` returns empty InputSource for all entity requests[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Layer [0m[1;36m3[0m[39m - OfflineContentHandler Wrapper:**[0m                                        [2m                [0m
[2;36m                    [0m         [39m- Automatically wraps the content handler to block entity resolution at handler [0m    [2m                [0m
[2;36m                    [0m         [39mlevel[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- Returns closed input stream for any `[0m[1;35mresolveEntity[0m[1;39m([0m[1;39m)[0m[39m` calls[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Layer [0m[1;36m4[0m[39m - Parser Pooling:**[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Uses pre-configured secure parsers from pool[0m                                      [2m                [0m
[2;36m                    [0m         [39m- Includes Xerces security manager to prevent entity expansion attacks[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Preserved Functionality[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix maintains all existing XLIFF12Parser functionality:[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Content Extraction:**[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- XLIFF12ContentHandler continues to receive identical SAX events[0m                   [2m                [0m
[2;36m                    [0m         [39m- No changes needed to the content handler implementation[0m                           [2m                [0m
[2;36m                    [0m         [39m- Metadata extraction [0m[1;39m([0m[39mfile-count, tu-count, languages[0m[1;39m)[0m[39m remains unchanged[0m           [2m                [0m
[2;36m                    [0m         [39m- Text content extraction from translation units preserved[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**API Compatibility:**[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- The `[0m[1;35mparse[0m[1;39m([0m[1;39m)[0m[39m` method signature already declares `throws TikaException`[0m            [2m                [0m
[2;36m                    [0m         [39m- ParseContext parameter is already passed through[0m                                  [2m                [0m
[2;36m                    [0m         [39m- CloseShieldInputStream wrapping is preserved[0m                                      [2m                [0m
[2;36m                    [0m         [39m- XHTMLContentHandler integration unchanged[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Test Compatibility:**[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- Existing tests in XLIFF12ParserTest will continue to pass[0m                         [2m                [0m
[2;36m                    [0m         [39m- [0m[1;35mtestXLIFF12[0m[1;39m([0m[1;39m)[0m[39m validates content and metadata extraction[0m                           [2m                [0m
[2;36m                    [0m         [39m- [0m[1;35mtestXLIFF12ToXMLHandler[0m[1;39m([0m[1;39m)[0m[39m validates XML output generation[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Impact on Related Components[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**XLZParser [0m[1;39m([0m[39mAutomatic Fix[0m[1;39m)[0m[39m:**[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- XLZParser delegates to XLIFF12Parser [0m[1;39m([0m[39mline [0m[1;36m67[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m- Fixing XLIFF12Parser automatically secures XLZ archive parsing[0m                    [2m                [0m
[2;36m                    [0m         [39m- No additional changes needed to XLZParser[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**XLIFF12ContentHandler:**[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- No modifications required[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- Continues to work with secure parser[0m                                              [2m                [0m
[2;36m                    [0m         [39m- Business logic completely preserved[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m6[0m[39m. Consistency with Tika Codebase Patterns[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix aligns XLIFF12Parser with established secure patterns in Tika:[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Similar Implementations:**[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- **XMLParser**: Uses `[0m[1;35mXMLReaderUtils.parseSAX[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m71[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m- **DcXMLParser**: Extends XMLParser, inherits security[0m                             [2m                [0m
[2;36m                    [0m         [39m- **FictionBookParser**: Extends XMLParser, inherits security[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Previous Vulnerabilities:**[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Test file TestXXEInXML demonstrates that [0m[1;35mXMLReaderUtils.parseSAX[0m[1;39m([0m[1;39m)[0m[39m prevents XXE [0m  [2m                [0m
[2;36m                    [0m         [39mattacks[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m- VulnerableSAXParser in XMLTestBase shows the exact vulnerable pattern [0m            [2m                [0m
[2;36m                    [0m         [39mXLIFF12Parser uses[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- MimeTypesReader shows partial security [0m[1;39m([0m[39mFEATURE_SECURE_PROCESSING only[0m[1;39m)[0m[39m is [0m       [2m                [0m
[2;36m                    [0m         [39minsufficient[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m7[0m[39m. Why This is the Optimal Approach[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Minimal Code Changes:**[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- Only modifies the `[0m[1;35m_parse[0m[1;39m([0m[1;39m)[0m[39m` method[0m                                               [2m                [0m
[2;36m                    [0m         [39m- Adds one import, removes three unused imports[0m                                     [2m                [0m
[2;36m                    [0m         [39m- Changes [0m[1;36m11[0m[39m lines to [0m[1;36m3[0m[39m lines[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Maximum Security:**[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Leverages battle-tested XMLReaderUtils utilities[0m                                  [2m                [0m
[2;36m                    [0m         [39m- Provides comprehensive XXE/SSRF protection[0m                                        [2m                [0m
[2;36m                    [0m         [39m- Consistent with OWASP recommendations[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**No Breaking Changes:**[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- Preserves all public API contracts[0m                                                [2m                [0m
[2;36m                    [0m         [39m- Maintains backward compatibility[0m                                                  [2m                [0m
[2;36m                    [0m         [39m- Existing functionality fully preserved[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Maintainability:**[0m                                                                [2m                [0m
[2;36m                    [0m         [39m- Reduces code complexity[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- Centralizes security configuration[0m                                                [2m                [0m
[2;36m                    [0m         [39m- Future security updates to XMLReaderUtils automatically benefit XLIFF12Parser[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m8[0m[39m. Alternative Approaches Considered and Rejected[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Alternative [0m[1;36m1[0m[39m: Manual SAXParserFactory Configuration**[0m                            [2m                [0m
[2;36m                    [0m         [39m- Would require duplicating XMLReaderUtils security logic[0m                           [2m                [0m
[2;36m                    [0m         [39m- Prone to configuration errors[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- Inconsistent with codebase patterns[0m                                               [2m                [0m
[2;36m                    [0m         [39m- **Rejected**: Violates DRY principle[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Alternative [0m[1;36m2[0m[39m: Extend XMLParser**[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- Would require restructuring class hierarchy[0m                                       [2m                [0m
[2;36m                    [0m         [39m- XLIFF12ContentHandler logic differs from XMLParser pattern[0m                        [2m                [0m
[2;36m                    [0m         [39m- More invasive changes[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- **Rejected**: Unnecessarily complex[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Alternative [0m[1;36m3[0m[39m: Set Only FEATURE_SECURE_PROCESSING**[0m                               [2m                [0m
[2;36m                    [0m         [39m- Insufficient protection [0m[1;39m([0m[39mas shown by MimeTypesReader pattern[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [39m- Doesn't block all XXE vectors[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- No entity resolver protection[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- **Rejected**: Inadequate security[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m9[0m[39m. Summary of Changes[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Modified File:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- [0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m`tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-xml-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/xliff/XLIFF12Parser.java`[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Line-by-Line Changes:**[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Line [0m[1;36m22[0m[39m: Add import `org.apache.tika.utils.XMLReaderUtils;`[0m                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Line [0m[1;36m24[0m[39m-[0m[1;36m26[0m[39m: Remove unused imports [0m[1;39m([0m[39mParserConfigurationException, SAXParser, [0m     [2m                [0m
[2;36m                    [0m         [39mSAXParserFactory[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Line [0m[1;36m78[0m[39m: Update method signature to add `TikaException` to throws clause[0m         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Lines [0m[1;36m78[0m[39m-[0m[1;36m89[0m[39m: Replace entire method body with `[0m[1;35mXMLReaderUtils.parseSAX[0m[1;39m([0m[39mis, [0m       [2m                [0m
[2;36m                    [0m         [39mcontentHandler, context[0m[1;39m)[0m[39m;`[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**No Changes Needed:**[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- XLIFF12ContentHandler.java [0m[1;39m([0m[39mbusiness logic preserved[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m- XLZParser.java [0m[1;39m([0m[39mautomatically inherits fix[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [39m- Test files [0m[1;39m([0m[39mexisting tests should pass[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m10[0m[39m. Verification Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying the fix:[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Existing Tests**: Run XLIFF12ParserTest to verify functionality preserved[0m      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **XXE Tests**: Create test with XXE payload to verify no external connections[0m    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Integration Tests**: Test with XLZParser to verify archive handling[0m            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Fuzzer Re-run**: Re-run the fuzzer to verify SSRF issue resolved[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/12/26 06:20:39][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=993316;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=964165;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=843389;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=623876;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpb7bf9gjy[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-full-01_vuln_0/[0m[95magent-[0m [2m               [0m
[2;36m                    [0m         [95moutput-1768198839.247498[0m                                                             [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/tika_tk-full-01_vuln_0.toml  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/12/26 06:20:41][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mtika[0m           ]8;id=420564;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=749058;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=908916;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=3569;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=867231;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=140887;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mtika[0m                   [2m               [0m
