[2;36m[01/11/26 15:30:50][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=403829;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=966693;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpsbie4k90[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_1[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768145450.983008[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-poi_poi-full-01_vuln_1.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/11/26 15:30:51][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m        ]8;id=685128;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=519865;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/11/26 15:33:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m Took  ]8;id=203662;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=515565;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m172.97[0m seconds; [33mexception[0m=[3;91mFalse[0m                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN            ]8;id=738102;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=684362;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN           ]8;id=178561;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=563644;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=609479;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=101620;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m172[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=653856;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=976565;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:33:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.96[0m seconds;            ]8;id=662858;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=474972;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/11/26 15:33:46][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=108086;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=367665;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=246771;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=929740;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=826924;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=26621;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=692958;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=693805;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:33:47][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m1.22[0m seconds;            ]8;id=102698;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=326254;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/11/26 15:33:48][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=274160;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=147129;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:33:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.84[0m seconds;            ]8;id=373926;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=44181;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/11/26 15:33:55][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=819248;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=138336;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of  [2m                [0m
[2;36m                    [0m         memory [1m([0muse [32m'-Xmx921m'[0m to reproduce[1m)[0m                                                [2m                [0m
[2;36m                    [0m         Caused by: java.lang.OutOfMemoryError: Java heap space                              [2m                [0m
[2;36m                    [0m                 at java.base/java.lang.String.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mString.jav[0m[1;92ma:657[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.util.StringUtil.getFromUnicodeLE[0m[1;39m([0m[39mStringUtil.jav[0m[1;92ma:94[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.MAPIAttribute.create[0m[1;39m([0m[39mMAPIAttribute.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>[0m[1;39m([0m[39mTNEFMAPIAttribute.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.TNEFAttribute.create[0m[1;39m([0m[39mTNEFAttribute.jav[0m[1;92ma:86[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.processMessage[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:105[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.process[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:87[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.poi.hmef.HMEFMessage.<init>[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:72[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIHMEFFuzzer.jav[0m[1;92ma:32[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cb8800.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800d00c00.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800d00400.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: a36f54a5f0a295bd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx921m'[0m[39m to reproduce[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Java heap space[0m                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/java.lang.String.<init>[0m[1;39m([0m[39mString.jav[0m[1;92ma:657[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.util.StringUtil.getFromUnicodeLE[0m[1;39m([0m[39mStringUtil.jav[0m[1;92ma:94[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.MAPIAttribute.create[0m[1;39m([0m[39mMAPIAttribute.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>[0m[1;39m([0m[39mTNEFMAPIAttribute.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.TNEFAttribute.create[0m[1;39m([0m[39mTNEFAttribute.jav[0m[1;92ma:86[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.processMessage[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:105[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.process[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:87[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.poi.hmef.HMEFMessage.<init[0m[1m>[0m[1m([0mHMEFMessage.jav[1;92ma:72[0m[1m)[0m              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput[0m[1m([0mPOIHMEFFuzzer.jav[1;92ma:32[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$DMH/[1;35m0x0000000800cb8800.invokeStaticInit[0m[1m([0mLambd [2m                [0m
[2;36m                    [0m         aForm$DMH[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800d00c00.invoke[0m[1m([0mLambdaForm$MH[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800d00400.invoke_MT[0m[1m([0mLambdaForm$MH [2m                [0m
[2;36m                    [0m         [1m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a36f54a5f0a295bd                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/11/26 15:34:15][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=178693;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=419120;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/11/26 15:39:19][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=431517;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=451346;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/11/26 15:39:47][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=660989;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=942652;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=25660;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=812435;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:39:48][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.98[0m seconds;            ]8;id=924186;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=517051;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/11/26 15:39:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Started[33m...[0m                          ]8;id=927582;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=120953;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmphp2fifct[0m                                                 ]8;id=924758;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=84014;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/11/26 15:41:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Took [1;36m120.38[0m seconds;               ]8;id=56348;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=481798;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Started[33m...[0m                    ]8;id=835125;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=763691;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:42:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Took [1;36m37.29[0m seconds;          ]8;id=652566;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=389079;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Started[33m...[0m                       ]8;id=683380;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=42471;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:42:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Took [1;36m5.58[0m seconds;              ]8;id=299161;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=604997;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Started[33m...[0m                           ]8;id=28198;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=521605;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=206748;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=677087;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=614162;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=16483;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:42:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.94[0m seconds;            ]8;id=784736;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=111908;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/11/26 15:42:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=453658;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=412728;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:42:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.92[0m seconds;            ]8;id=614623;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=921466;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=757665;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=66021;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:42:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.92[0m seconds;            ]8;id=335615;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=930123;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/11/26 15:42:37][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=619280;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=695625;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java [2m                [0m
[2;36m                    [0m         +++ b/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java [2m                [0m
[2;36m                    [0m         @@ [1;36m-168[0m,[1;36m7[0m +[1;36m168[0m,[1;36m7[0m @@                                                                 [2m                [0m
[2;36m                    [0m                            if [1m([0mmplen [1m<[0m[39m [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m                      throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + [0m    [2m                [0m
[2;36m                    [0m         [39mmplen[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m                   [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [39m-                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mmplen, [0m                   [2m                [0m
[2;36m                    [0m         [39mMAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m                   if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [39m                      throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen + [0m[32m" [0m [2m                [0m
[2;36m                    [0m         [32mbytes for attribute name"[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m                   [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx921m'[0m[39m to reproduce[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Java heap space[0m                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/java.lang.String.<init>[0m[1;39m([0m[39mString.jav[0m[1;92ma:657[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.util.StringUtil.getFromUnicodeLE[0m[1;39m([0m[39mStringUtil.jav[0m[1;92ma:94[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.MAPIAttribute.create[0m[1;39m([0m[39mMAPIAttribute.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>[0m[1;39m([0m[39mTNEFMAPIAttribute.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.TNEFAttribute.create[0m[1;39m([0m[39mTNEFAttribute.jav[0m[1;92ma:86[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.processMessage[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:105[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.process[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:87[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.poi.hmef.HMEFMessage.<init>[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:72[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIHMEFFuzzer.jav[0m[1;92ma:32[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cb8800.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800d00c00.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800d00400.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: a36f54a5f0a295bd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAn Out of Memory [0m[1;39m([0m[39mOOM[0m[1;39m)[0m[39m error occurs when processing HMEF [0m[1;39m([0m[39mTNEF[0m[1;39m)[0m[39m messages using [0m     [2m                [0m
[2;36m                    [0m         [39mApache POI's HMEF parser. The fuzzer discovered that malformed input can trigger [0m   [2m                [0m
[2;36m                    [0m         [39mexcessive memory allocation during string creation from Unicode data, leading to a [0m [2m                [0m
[2;36m                    [0m         [39mJava heap space exhaustion. This represents a potential Denial of Service [0m[1;39m([0m[39mDoS[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mvulnerability through resource exhaustion.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Overview[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mThe issue manifests as a `java.lang.OutOfMemoryError: Java heap space` exception [0m   [2m                [0m
[2;36m                    [0m         [39mwrapped in a `FuzzerSecurityIssueLow` during fuzzing operations. The error occurs [0m  [2m                [0m
[2;36m                    [0m         [39mwhen the heap memory limit [0m[1;39m([0m[39m921MB in the reproduction case[0m[1;39m)[0m[39m is exceeded while [0m      [2m                [0m
[2;36m                    [0m         [39mprocessing HMEF message data.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is classified as a resource exhaustion vulnerability that can lead to Denial [0m  [2m                [0m
[2;36m                    [0m         [39mof Service. The fuzzer categorizes it as a [0m[32m"FuzzerSecurityIssueLow"[0m[39m issue, [0m         [2m                [0m
[2;36m                    [0m         [39mindicating it's a security-relevant finding but with lower severity compared to [0m    [2m                [0m
[2;36m                    [0m         [39mother vulnerability classes.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Call Stack Analysis[0m                                                             [2m                [0m
[2;36m                    [0m         [39mThe exception originates deep within the HMEF message processing pipeline:[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Point**: The fuzzer invokes `[0m[1;35mPOIHMEFFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` with [0m   [2m                [0m
[2;36m                    [0m         [39mtest input data[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Message Initialization**: `HMEFMessage.<init>[0m[1;39m([0m[1;39m)[0m[39m` is called to create a new [0m    [2m                [0m
[2;36m                    [0m         [39mHMEF message object[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Processing Chain**: The message goes through `[0m[1;35mHMEFMessage.process[0m[1;39m([0m[1;39m)[0m[39m` â†’ [0m        [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mHMEFMessage.processMessage[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Attribute Creation**: `[0m[1;35mTNEFAttribute.create[0m[1;39m([0m[1;39m)[0m[39m` is invoked to parse TNEF [0m       [2m                [0m
[2;36m                    [0m         [39mattributes[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **MAPI Attribute Handling**: `TNEFMAPIAttribute.<init>[0m[1;39m([0m[1;39m)[0m[39m` initializes [0m           [2m                [0m
[2;36m                    [0m         [39mMAPI-specific attributes[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **MAPI Attribute Creation**: `[0m[1;35mMAPIAttribute.create[0m[1;39m([0m[1;39m)[0m[39m` processes the attribute [0m   [2m                [0m
[2;36m                    [0m         [39mdata[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **String Conversion**: `[0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[1;39m)[0m[39m` attempts to convert [0m      [2m                [0m
[2;36m                    [0m         [39mUnicode Little Endian data[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m. **Memory Allocation Failure**: `String.<init>[0m[1;39m([0m[1;39m)[0m[39m` fails to allocate sufficient [0m   [2m                [0m
[2;36m                    [0m         [39mheap space for the string[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Memory Allocation Point**: The OOM error occurs specifically during string [0m    [2m                [0m
[2;36m                    [0m         [39mconstruction from Unicode Little Endian encoded data in [0m                            [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m94[0m[39m.[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Data Processing Flow**: The error happens during MAPI attribute creation [0m[1;39m([0m[39mline[0m [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m of `[0m[1;35mMAPIAttribute.create[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m, suggesting that the input contains attribute data[0m [2m                [0m
[2;36m                    [0m         [39mthat specifies an extremely large string length or contains malformed length [0m       [2m                [0m
[2;36m                    [0m         [39mvalues.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Fuzzer Detection**: The fuzzer successfully identified this as a security [0m     [2m                [0m
[2;36m                    [0m         [39missue with a deduplication token [0m[1;39m([0m[39ma36f54a5f0a295bd[0m[1;39m)[0m[39m, indicating this is a [0m          [2m                [0m
[2;36m                    [0m         [39mreproducible and distinct issue.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a comprehensive understanding of this issue, the following components [0m      [2m                [0m
[2;36m                    [0m         [39mshould be examined:[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **String Utilities** [0m[1;39m([0m[39m`org.apache.poi.util.StringUtil`[0m[1;39m)[0m[39m:[0m                         [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35mgetFromUnicodeLE[0m[1;39m([0m[1;39m)[0m[39m` method at line [0m[1;36m94[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - How it reads and interprets string length values from input data[0m               [2m                [0m
[2;36m                    [0m         [39m   - Whether there are bounds checks or validation on the string length parameter[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **MAPI Attribute Processing** [0m[1;39m([0m[39m`org.apache.poi.hmef.attribute.MAPIAttribute`[0m[1;39m)[0m[39m:[0m   [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35mcreate[0m[1;39m([0m[1;39m)[0m[39m` method at line [0m[1;36m175[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - How attribute data is parsed and what triggers string creation[0m                 [2m                [0m
[2;36m                    [0m         [39m   - Whether attribute length values are validated before allocation[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **TNEF Attribute Handling** [0m[1;39m([0m[39m`org.apache.poi.hmef.attribute.TNEFAttribute` and [0m  [2m                [0m
[2;36m                    [0m         [39m`TNEFMAPIAttribute`[0m[1;39m)[0m[39m:[0m                                                               [2m                [0m
[2;36m                    [0m         [39m   - How TNEF attributes are constructed and validated[0m                              [2m                [0m
[2;36m                    [0m         [39m   - The attribute creation logic in `[0m[1;35mTNEFAttribute.create[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m86[0m            [2m                [0m
[2;36m                    [0m         [39m   - The initialization process in `TNEFMAPIAttribute.<init>[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m41[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **HMEF Message Processing** [0m[1;39m([0m[39m`org.apache.poi.hmef.HMEFMessage`[0m[1;39m)[0m[39m:[0m                 [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35mprocessMessage[0m[1;39m([0m[1;39m)[0m[39m` method at line [0m[1;36m105[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Input validation mechanisms at the message level[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Overall message parsing architecture and data flow[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Input Validation Layer**:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - Whether there are global or per-component limits on string sizes[0m               [2m                [0m
[2;36m                    [0m         [39m   - If there are safeguards against processing maliciously crafted length fields[0m   [2m                [0m
[2;36m                    [0m         [39m   - How the parser handles untrusted input data[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx921m'[0m[39m to reproduce[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Java heap space[0m                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/java.lang.String.<init>[0m[1;39m([0m[39mString.jav[0m[1;92ma:657[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.util.StringUtil.getFromUnicodeLE[0m[1;39m([0m[39mStringUtil.jav[0m[1;92ma:94[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.MAPIAttribute.create[0m[1;39m([0m[39mMAPIAttribute.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.poi.hmef.attribute.TNEFMAPIAttribute.<init>[0m[1;39m([0m[39mTNEFMAPIAttribute.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.hmef.attribute.TNEFAttribute.create[0m[1;39m([0m[39mTNEFAttribute.jav[0m[1;92ma:86[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.processMessage[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:105[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.hmef.HMEFMessage.process[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:87[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.poi.hmef.HMEFMessage.<init>[0m[1;39m([0m[39mHMEFMessage.jav[0m[1;92ma:72[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.POIHMEFFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIHMEFFuzzer.jav[0m[1;92ma:32[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cb8800.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800d00c00.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800d00400.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: a36f54a5f0a295bd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/StringUtil.jav[0m[1;92ma:20[0m[39m-[0m[1;36m26[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import static java.nio.charset.StandardCharsets.ISO_8859_1;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/StringUtil.jav[0m[1;92ma:79[0m[39m-[0m[1;36m95[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public static String [0m[1;35mgetFromUnicodeLE[0m[1;39m([0m                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:            final byte[0m[1;39m[[0m[1;39m][0m[39m string,[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            final int offset,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            final int len[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            throws ArrayIndexOutOfBoundsException, IllegalArgumentException [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39mlen == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[32m""[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39moffset < [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset >= string.length[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            throw new [0m[1;35mArrayIndexOutOfBoundsException[0m[1;39m([0m[32m"Illegal offset "[0m[39m + offset [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m" [0m[32m([0m[32mString data is of length "[0m[39m + string.length + [0m[32m"[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mlen < [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mstring.length - offset[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m[39m < len[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Illegal length "[0m[39m + len[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        return new [0m[1;35mString[0m[1;39m([0m[39mstring, offset, len * [0m[1;36m2[0m[39m, UTF16LE[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/StringUtil.jav[0m[1;92ma:107[0m[39m-[0m[1;36m112[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    public static String [0m[1;35mgetFromUnicodeLE[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m string[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        if [0m[1;39m([0m[39mstring.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            return [0m[32m""[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        return [0m[1;35mgetFromUnicodeLE[0m[1;39m([0m[39mstring, [0m[1;36m0[0m[39m, string.length [0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/TNEFAttribute.jav[0m[1;92ma:37[0m[39m-[0m[1;36m73[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:   [0m[35m/[0m[35m/[0m[95marbitrarily[0m[39m selected; may need to increase[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:   private static final int DEFAULT_MAX_RECORD_LENGTH = 20_000_000;[0m              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:   private static int MAX_RECORD_LENGTH = DEFAULT_MAX_RECORD_LENGTH;[0m             [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:   private final TNEFProperty property;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:   private final int type;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:   private final byte[0m[1;39m[[0m[1;39m][0m[39m data;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:   private final int checksum;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    * @param length the max record length allowed for TNEFAttribute[0m              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:   public static void [0m[1;35msetMaxRecordLength[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:      MAX_RECORD_LENGTH = length;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    * @return the max record length allowed for TNEFAttribute[0m                    [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:   public static int [0m[1;35mgetMaxRecordLength[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:      return MAX_RECORD_LENGTH;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:   [0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    * Constructs a single new attribute from the id, type,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    *  and the contents of the stream[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:   protected [0m[1;35mTNEFAttribute[0m[1;39m([0m[39mint id, int type, InputStream inp[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:      this.type = type;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:      int length = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:      [0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:      property = [0m[1;35mTNEFProperty.getBest[0m[1;39m([0m[39mid, type[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:      data = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlength, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:      [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, data[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:      [0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:      checksum = [0m[1;35mLittleEndian.readUShort[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/TNEFMAPIAttribute.jav[0m[1;92ma:3[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[39m-[0m[1;36m42[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:   protected [0m[1;35mTNEFMAPIAttribute[0m[1;39m([0m[39mint id, int type, InputStream inp[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:      [0m[1;35msuper[0m[1;39m([0m[39mid, type, inp[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:      [0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:      attributes = [0m[1;35mMAPIAttribute.create[0m[1;39m([0m[39mthis[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/HMEFMessage.jav[0m[1;92ma:103[0m[39m-[0m[1;36m113[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    void [0m[1;35mprocessMessage[0m[1;39m([0m[39mInputStream inp[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build the attribute[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        TNEFAttribute attr = [0m[1;35mTNEFAttribute.create[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        [0m[1;35mmessageAttributes.add[0m[1;39m([0m[39mattr[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        if [0m[1;39m([0m[39mattr instanceof TNEFMAPIAttribute[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            TNEFMAPIAttribute tnefMAPI = [0m[1;39m([0m[39mTNEFMAPIAttribute[0m[1;39m)[0m[39m attr;[0m              [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;35mmapiAttributes.addAll[0m[1;39m([0m[1;35mtnefMAPI.getMAPIAttributes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:18[0m[39m-[0m[1;36m35[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.hmef.attribute;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.commons.io.input.UnsynchronizedByteArrayInputStream;[0m           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.hmef.Attachment;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.hmef.HMEFMessage;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.hsmf.datatypes.MAPIProperty;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.hsmf.datatypes.Types;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.hsmf.datatypes.Types.MAPIType;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.util.HexDump;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.poi.util.IOUtils;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.poi.util.LittleEndian;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.poi.util.StringUtil;[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:43[0m[39m-[0m[1;36m64[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:   [0m[35m/[0m[35m/[0m[95marbitrarily[0m[39m selected; may need to increase[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:   private static final int DEFAULT_MAX_RECORD_LENGTH = 1_000_000;[0m               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:   private static int MAX_RECORD_LENGTH = 1_000_000;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:   private static int MAX_RECORD_COUNT = 10_000;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:   private final MAPIProperty property;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:   private final int type;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:   private final byte[0m[1;39m[[0m[1;39m][0m[39m data;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    * @param length the max record length allowed for MAPIAttribute[0m              [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:   public static void [0m[1;35msetMaxRecordLength[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:      MAX_RECORD_LENGTH = length;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    * @return the max record length allowed for MAPIAttribute[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:   public static int [0m[1;35mgetMaxRecordLength[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:      return MAX_RECORD_LENGTH;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:105[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m84[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:   public static List<MAPIAttribute> [0m[1;35mcreate[0m[1;39m([0m[39mTNEFAttribute parent[0m[1;39m)[0m[39m throws [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:      [0m[1;35mif[0m[1;39m([0m[1;35mparent.getProperty[0m[1;39m([0m[1;39m)[0m[39m == TNEFProperty.ID_MAPIPROPERTIES[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:         [0m[35m/[0m[35m/[0m[39m Regular MAPI Properties, normally on the message[0m                    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:      else [0m[1;35mif[0m[1;39m([0m[1;35mparent.getProperty[0m[1;39m([0m[1;39m)[0m[39m == TNEFProperty.ID_ATTACHMENT[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:         [0m[35m/[0m[35m/[0m[39m MAPI Properties for an attachment[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:      else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:         [0m[35m/[0m[35m/[0m[39m Something else, oh dear[0m[33m...[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:         throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m                                    [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:               [0m[32m"Can only create from a MAPIProperty attribute, "[0m[39m +[0m              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:               [0m[32m"instead received a "[0m[39m + [0m[1;35mparent.getProperty[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" one"[0m            [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:         [0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:      [0m[1;35mtry[0m[1;39m([0m[39mUnsynchronizedByteArrayInputStream inp = [0m                             [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[1;35mparent.getData[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:         [0m[35m/[0m[35m/[0m[39m First up, get the number of attributes[0m                              [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:         int count = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:         List<MAPIAttribute> attrs = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:         [0m[35m/[0m[35m/[0m[39m Now, read each one in in turn[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:         [0m[1;35mfor[0m[1;39m([0m[39mint [0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<count; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            int typeAndMV = [0m[1;35mLittleEndian.readUShort[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            int id = [0m[1;35mLittleEndian.readUShort[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            [0m[35m/[0m[35m/[0m[39m Is it either Multi-Valued or Variable-Length?[0m                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            boolean isMV = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            boolean isVL = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            int typeId = typeAndMV;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39m [0m[1;39m([0m[39mtypeAndMV & Types.MULTIVALUED_FLAG[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:               isMV = true;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:               typeId -= Types.MULTIVALUED_FLAG;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mtypeId == [0m[1;35mTypes.ASCII_STRING.getId[0m[1;39m([0m[1;39m)[0m[39m || typeId == [0m               [2m                [0m
[2;36m                    [0m         [1;35mTypes.UNICODE_STRING.getId[0m[1;39m([0m[1;39m)[0m[39m ||[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                    typeId == [0m[1;35mTypes.BINARY.getId[0m[1;39m([0m[1;39m)[0m[39m || typeId == [0m                [2m                [0m
[2;36m                    [0m         [1;35mTypes.DIRECTORY.getId[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:               isVL = true;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            [0m[35m/[0m[35m/[0m[39m Turn the type ID into a strongly typed thing[0m                     [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            MAPIType type = [0m[1;35mTypes.getById[0m[1;39m([0m[39mtypeId[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:            if [0m[1;39m([0m[39mtype == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:               type = [0m[1;35mTypes.createCustom[0m[1;39m([0m[39mtypeId[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[35m/[0m[35m/[0m[39m If it's a named property, rather than a standard[0m                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[35m/[0m[35m/[0m[39m  MAPI property, grab the details of it[0m                           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            MAPIProperty prop = [0m[1;35mMAPIProperty.get[0m[1;39m([0m[39mid[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mid >= [0m[1;36m0x8000[0m[39m && id <= [0m[1;36m0xFFFF[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:               byte[0m[1;39m[[0m[1;39m][0m[39m guid = new byte[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:               if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, guid[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                  throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read guid"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:               int mptype = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:               [0m[35m/[0m[35m/[0m[39m Get the name of it[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:               String name;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:               [0m[1;35mif[0m[1;39m([0m[39mmptype == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                  [0m[35m/[0m[35m/[0m[39m It's based on a normal one[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                  int mpid = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                  MAPIProperty base = [0m[1;35mMAPIProperty.get[0m[1;39m([0m[39mmpid[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:                  name = base.name;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                  [0m[35m/[0m[35m/[0m[39m Custom name was stored[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                  int mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                  if [0m[1;39m([0m[39mmplen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [39mmplen[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                  if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen +[0m [2m                [0m
[2;36m                    [0m         [32m" bytes for attribute name"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                  name = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mmpdata, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mmplen/[0m[1;36m2[0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                  [0m[1;35mskipToBoundary[0m[1;39m([0m[39mmplen, inp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:               [0m[35m/[0m[35m/[0m[39m Now create[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:               prop = [0m[1;35mMAPIProperty.createCustom[0m[1;39m([0m[39mid, type, name[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mprop == MAPIProperty.UNKNOWN[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:               prop = [0m[1;35mMAPIProperty.createCustom[0m[1;39m([0m[39mid, type, [0m[32m"[0m[32m([0m[32munknown "[0m[39m + [0m        [2m                [0m
[2;36m                    [0m         [1;35mInteger.toHexString[0m[1;39m([0m[39mid[0m[1;39m)[0m[39m + [0m[32m"[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIStringAttribute.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:18[0m[39m-[0m[1;36m56[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.hmef.attribute;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.poi.logging.PoiLogManager;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.poi.hmef.Attachment;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.poi.hmef.HMEFMessage;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.poi.hsmf.datatypes.MAPIProperty;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.hsmf.datatypes.Types;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.util.StringUtil;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * A pure-MAPI attribute holding a String, which applies[0m                         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: *  to a [0m[1;39m{[0m[39m@link HMEFMessage[0m[1;39m}[0m[39m or one of its [0m[1;39m{[0m[39m@link Attachment[0m[1;39m}[0m[39ms.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:public final class MAPIStringAttribute extends MAPIAttribute [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:   private static final Logger LOG = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mPoiLogManager.getLogger[0m[1;39m([0m[39mMAPIStringAttribute.class[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:   private static final String CODEPAGE = [0m[32m"CP1252"[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:   private final String data;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:   public [0m[1;35mMAPIStringAttribute[0m[1;39m([0m[39mMAPIProperty property, int type, byte[0m[1;39m[[0m[1;39m][0m[39m data[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:      [0m[1;35msuper[0m[1;39m([0m[39mproperty, type, data[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:      String tmpData = null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mtype == [0m[1;35mTypes.ASCII_STRING.getId[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:         tmpData = new [0m[1;35mString[0m[1;39m([0m[39mdata, [0m[1;35mCharset.forName[0m[1;39m([0m[39mCODEPAGE[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:      [0m[1;39m}[0m[39m else [0m[1;35mif[0m[1;39m([0m[39mtype == [0m[1;35mTypes.UNICODE_STRING.getId[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:         tmpData = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:      [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:         throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Not a string type "[0m[39m + type[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:      [0m[35m/[0m[35m/[0m[39m Strip off the null terminator if present[0m                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:      [0m[1;35mif[0m[1;39m([0m[1;35mtmpData.endsWith[0m[1;39m([0m[32m"\0"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:         tmpData = [0m[1;35mtmpData.substring[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;35mtmpData.length[0m[1;39m([0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:      [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:      this.data = tmpData;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:150[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m84[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            MAPIProperty prop = [0m[1;35mMAPIProperty.get[0m[1;39m([0m[39mid[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mid >= [0m[1;36m0x8000[0m[39m && id <= [0m[1;36m0xFFFF[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:               byte[0m[1;39m[[0m[1;39m][0m[39m guid = new byte[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:               if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, guid[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                  throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read guid"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:               int mptype = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:               [0m[35m/[0m[35m/[0m[39m Get the name of it[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:               String name;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:               [0m[1;35mif[0m[1;39m([0m[39mmptype == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                  [0m[35m/[0m[35m/[0m[39m It's based on a normal one[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                  int mpid = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                  MAPIProperty base = [0m[1;35mMAPIProperty.get[0m[1;39m([0m[39mmpid[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:                  name = base.name;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                  [0m[35m/[0m[35m/[0m[39m Custom name was stored[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                  int mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                  if [0m[1;39m([0m[39mmplen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [39mmplen[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                  if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen +[0m [2m                [0m
[2;36m                    [0m         [32m" bytes for attribute name"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                  name = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mmpdata, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mmplen/[0m[1;36m2[0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                  [0m[1;35mskipToBoundary[0m[1;39m([0m[39mmplen, inp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:               [0m[35m/[0m[35m/[0m[39m Now create[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:               prop = [0m[1;35mMAPIProperty.createCustom[0m[1;39m([0m[39mid, type, name[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mprop == MAPIProperty.UNKNOWN[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:               prop = [0m[1;35mMAPIProperty.createCustom[0m[1;39m([0m[39mid, type, [0m[32m"[0m[32m([0m[32munknown "[0m[39m + [0m        [2m                [0m
[2;36m                    [0m         [1;35mInteger.toHexString[0m[1;39m([0m[39mid[0m[1;39m)[0m[39m + [0m[32m"[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:579[0m[39m-[0m[1;36m587[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:    public static void [0m[1;35msafelyAllocateCheck[0m[1;39m([0m[39mlong length, int maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:        if [0m[1;39m([0m[39mlength < 0L[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:            throw new [0m[1;35mRecordFormatException[0m[1;39m([0m[32m"Can't allocate an array of length [0m [2m                [0m
[2;36m                    [0m         [32m< 0, but had "[0m[39m + length + [0m[32m" and "[0m[39m + maxLength[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:        if [0m[1;39m([0m[39mlength > [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mInteger.MAX_VALUE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:            throw new [0m[1;35mRecordFormatException[0m[1;39m([0m[32m"Can't allocate an array > [0m         [2m                [0m
[2;36m                    [0m         [32m"[0m[39m+Integer.MAX_VALUE[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        [0m[1;35mcheckLength[0m[1;39m([0m[39mlength, maxLength[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:196[0m[39m-[0m[1;36m2[0m [2m                [0m
[2;36m                    [0m         [1;36m20[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            [0m[1;35mfor[0m[1;39m([0m[39mint [0m[33mj[0m[39m=[0m[1;36m0[0m[39m; j<values; j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:               int len = [0m[1;35mgetLength[0m[1;39m([0m[39mtype, inp[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:               byte[0m[1;39m[[0m[1;39m][0m[39m data = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlen, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:               [0m[1;35minp.read[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:               [0m[1;35mskipToBoundary[0m[1;39m([0m[39mlen, inp[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:               [0m[35m/[0m[35m/[0m[39m Create[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:               MAPIAttribute attr;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:               [0m[1;35mif[0m[1;39m([0m[39mtype == Types.UNICODE_STRING || type == Types.ASCII_STRING[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                  attr = new [0m[1;35mMAPIStringAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;35mif[0m[1;39m([0m[39mtype == Types.APP_TIME || type == Types.TIME[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:                  attr = new [0m[1;35mMAPIDateAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;35mif[0m[1;39m([0m[39mid == MAPIProperty.RTF_COMPRESSED.id[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                  attr = new [0m[1;35mMAPIRtfAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:                  attr = new [0m[1;35mMAPIAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:               [0m[1;35mattrs.add[0m[1;39m([0m[39mattr[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:         [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:         [0m[35m/[0m[35m/[0m[39m All done[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:         return attrs;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:301[0m[39m-[0m[1;36m309[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:    private static void [0m[1;35mcheckLength[0m[1;39m([0m[39mlong length, int maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        if [0m[1;39m([0m[39mBYTE_ARRAY_MAX_OVERRIDE > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:            if [0m[1;39m([0m[39mlength > BYTE_ARRAY_MAX_OVERRIDE[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                [0m[1;35mthrowRFE[0m[1;39m([0m[39mlength, BYTE_ARRAY_MAX_OVERRIDE[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mlength > maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:            [0m[1;35mthrowRFE[0m[1;39m([0m[39mlength, maxLength[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:571[0m[39m-[0m[1;36m587[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m571[0m[39m:    public static byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35msafelyAllocate[0m[1;39m([0m[39mlong length, int maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m572[0m[39m:        [0m[1;35msafelyAllocateCheck[0m[1;39m([0m[39mlength, maxLength[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m573[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m574[0m[39m:        [0m[1;35mcheckByteSizeLimit[0m[1;39m([0m[39mlength[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:        return new byte[0m[1;39m[[0m[1;39m([0m[39mint[0m[1;39m)[0m[39mlength[0m[1;39m][0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:    public static void [0m[1;35msafelyAllocateCheck[0m[1;39m([0m[39mlong length, int maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:        if [0m[1;39m([0m[39mlength < 0L[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:            throw new [0m[1;35mRecordFormatException[0m[1;39m([0m[32m"Can't allocate an array of length [0m [2m                [0m
[2;36m                    [0m         [32m< 0, but had "[0m[39m + length + [0m[32m" and "[0m[39m + maxLength[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:        if [0m[1;39m([0m[39mlength > [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mInteger.MAX_VALUE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:            throw new [0m[1;35mRecordFormatException[0m[1;39m([0m[32m"Can't allocate an array > [0m         [2m                [0m
[2;36m                    [0m         [32m"[0m[39m+Integer.MAX_VALUE[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        [0m[1;35mcheckLength[0m[1;39m([0m[39mlength, maxLength[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:621[0m[39m-[0m[1;36m627[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m621[0m[39m:    private static void [0m[1;35mthrowRFE[0m[1;39m([0m[39mlong length, int maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m622[0m[39m:        throw new [0m[1;35mRecordFormatException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[39mLocale.ROOT, [0m[32m"Tried to [0m   [2m                [0m
[2;36m                    [0m         [32mallocate an array of length %,d"[0m[39m +[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m623[0m[39m:                        [0m[32m", but the maximum length for this record type is [0m      [2m                [0m
[2;36m                    [0m         [32m%,d.%n"[0m[39m +[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m624[0m[39m:                        [0m[32m"If the file is not corrupt and not large, please open [0m [2m                [0m
[2;36m                    [0m         [32man issue on bugzilla to request %n"[0m[39m +[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m625[0m[39m:                        [0m[32m"increasing the maximum allowable size for this record [0m [2m                [0m
[2;36m                    [0m         [32mtype.%n"[0m[39m+[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m626[0m[39m:                        [0m[32m"You can set a higher override value with [0m              [2m                [0m
[2;36m                    [0m         [32mIOUtils.setByteArrayMaxOverride[0m[32m([0m[32m)[0m[32m"[0m[39m, length, maxLength[0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hwpf/model/Sttb.jav[0m[1;92ma:95[0m[39m-[0m[1;36m112[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        _data = new String[0m[1;39m[[0m[39mcData[0m[1;39m][0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        _extraData = new byte[0m[1;39m[[0m[39mcData[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        for [0m[1;39m([0m[39m int i = [0m[1;36m0[0m[39m; i < cData; i++ [0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            int cchData = [0m[1;35mLittleEndian.getShort[0m[1;39m([0m[39m buffer, offset [0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            offset += [0m[1;36m2[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            if [0m[1;39m([0m[39m cchData < [0m[1;36m0[0m[39m [0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                continue;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            _data[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39m buffer, offset, cchData [0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            offset += cchData * [0m[1;36m2[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            _extraData[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39m buffer, offset, offset+_cbExtra[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            offset += _cbExtra;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:18[0m[39m-[0m[1;36m35[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.hmef.attribute;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.commons.io.input.UnsynchronizedByteArrayInputStream;[0m           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.hmef.Attachment;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.hmef.HMEFMessage;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.hsmf.datatypes.MAPIProperty;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.hsmf.datatypes.Types;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.hsmf.datatypes.Types.MAPIType;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.util.HexDump;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.poi.util.IOUtils;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.poi.util.LittleEndian;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.poi.util.StringUtil;[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:43[0m[39m-[0m[1;36m64[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:   [0m[35m/[0m[35m/[0m[95marbitrarily[0m[39m selected; may need to increase[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:   private static final int DEFAULT_MAX_RECORD_LENGTH = 1_000_000;[0m               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:   private static int MAX_RECORD_LENGTH = 1_000_000;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:   private static int MAX_RECORD_COUNT = 10_000;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:   private final MAPIProperty property;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:   private final int type;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:   private final byte[0m[1;39m[[0m[1;39m][0m[39m data;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    * @param length the max record length allowed for MAPIAttribute[0m              [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:   public static void [0m[1;35msetMaxRecordLength[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:      MAX_RECORD_LENGTH = length;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    * @return the max record length allowed for MAPIAttribute[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:   public static int [0m[1;35mgetMaxRecordLength[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:      return MAX_RECORD_LENGTH;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/Ole10Native.jav[0m[1;92ma:51[0m[39m-[0m[1;36m57[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    private static final Charset UTF8 = StandardCharsets.UTF_8;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[35m/[0m[35m/[0m[39m arbitrarily selected; may need to increase[0m                                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private static final int DEFAULT_MAX_RECORD_LENGTH = 100_000_000;[0m            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private static int MAX_RECORD_LENGTH = DEFAULT_MAX_RECORD_LENGTH;[0m            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[35m/[0m[35m/[0m[39m arbitrarily selected; may need to increase[0m                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private static final int DEFAULT_MAX_STRING_LENGTH = [0m[1;36m1024[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    private static int MAX_STRING_LENGTH = DEFAULT_MAX_STRING_LENGTH;[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/Ole10Native.jav[0m[1;92ma:156[0m[39m-[0m[1;36m169[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:     * @param length the max string length allowed for Ole10Native[0m              [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    public static void [0m[1;35msetMaxStringLength[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        MAX_STRING_LENGTH = length;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:     * @return the max string length allowed for Ole10Native[0m                    [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    public static int [0m[1;35mgetMaxStringLength[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:        return MAX_STRING_LENGTH;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/Ole10Native.jav[0m[1;92ma:274[0m[39m-[0m[1;36m295[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:    private static String [0m[1;35mreadAsciiZ[0m[1;39m([0m[39mLittleEndianInput is[0m[1;39m)[0m[39m throws [0m              [2m                [0m
[2;36m                    [0m         [39mOle10NativeException [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        [0m[35m/[0m[35m/[0m[39m arbitrary sized buffer - not sure how big strings can get in an [0m     [2m                [0m
[2;36m                    [0m         [39mOle10 record[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m buf = new byte[0m[1;39m[[0m[39mMAX_STRING_LENGTH[0m[1;39m][0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        for [0m[1;39m([0m[39mint [0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<buf.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;35mis.readByte[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:                return [0m[1;35mStringUtil.getFromCompressedUTF8[0m[1;39m([0m[39mbuf, [0m[1;36m0[0m[39m, i[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        throw new [0m[1;35mOle10NativeException[0m[1;39m([0m[32m"AsciiZ string was not null terminated [0m  [2m                [0m
[2;36m                    [0m         [32mafter "[0m[39m + MAX_STRING_LENGTH + [0m[32m" bytes - Exiting."[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:    private static String [0m[1;35mreadAsciiLen[0m[1;39m([0m[39mLittleEndianByteArrayInputStream leis[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        int size = [0m[1;35mleis.readInt[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m buf = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mleis, size, MAX_STRING_LENGTH[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        return [0m[1;39m([0m[39mbuf.length == [0m[1;36m0[0m[1;39m)[0m[39m ? [0m[32m""[0m[39m : [0m                                        [2m                [0m
[2;36m                    [0m         [1;35mStringUtil.getFromCompressedUnicode[0m[1;39m([0m[39mbuf, [0m[1;36m0[0m[39m, size - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    private static String [0m[1;35mreadUtf16[0m[1;39m([0m[39mLittleEndianByteArrayInputStream leis[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        int size = [0m[1;35mleis.readInt[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m buf = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mleis, size * [0m[1;36m2[0m[39m, MAX_STRING_LENGTH[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:        return [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mbuf, [0m[1;36m0[0m[39m, size[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/macros/VBAMacroReader.jav[0m[1;92ma:71[0m[39m-[0m[1;36m77[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:@[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unused"[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:public class VBAMacroReader implements Closeable [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private static final Logger LOGGER = [0m                                        [2m                [0m
[2;36m                    [0m         [1;35mPoiLogManager.getLogger[0m[1;39m([0m[39mVBAMacroReader.class[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[35m/[0m[35m/[0m[95marbitrary[0m[39m limit on size of strings to read, etc.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private static final int MAX_STRING_LENGTH = [0m[1;36m20000[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    protected static final String VBA_PROJECT_OOXML = [0m[32m"vbaProject.bin"[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/macros/VBAMacroReader.jav[0m[1;92ma:716[0m[39m-[0m[1;36m722[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:    private static String [0m[1;35mreadString[0m[1;39m([0m[39mInputStream stream, int length, Charset [0m   [2m                [0m
[2;36m                    [0m         [39mcharset[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m buffer = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlength, MAX_STRING_LENGTH[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:        int bytesRead = [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39mstream, buffer[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:        if [0m[1;39m([0m[39mbytesRead != length[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Tried to read: "[0m[39m+length +[0m                    [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                    [0m[32m", but could only read: "[0m[39m+bytesRead[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/macros/VBAMacroReader.jav[0m[1;92ma:781[0m[39m-[0m[1;36m787[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:    private String [0m[1;35mreadUnicodeString[0m[1;39m([0m[39mRLEDecompressingInputStream in, int [0m       [2m                [0m
[2;36m                    [0m         [39municodeNameRecordLength[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m buffer = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39municodeNameRecordLength, [0m        [2m                [0m
[2;36m                    [0m         [39mMAX_STRING_LENGTH[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:        int bytesRead = [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39min, buffer[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:        if [0m[1;39m([0m[39mbytesRead != unicodeNameRecordLength[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:        return new [0m[1;35mString[0m[1;39m([0m[39mbuffer, StringUtil.UTF16LE[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:148[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m81[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[35m/[0m[35m/[0m[39m If it's a named property, rather than a standard[0m                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[35m/[0m[35m/[0m[39m  MAPI property, grab the details of it[0m                           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            MAPIProperty prop = [0m[1;35mMAPIProperty.get[0m[1;39m([0m[39mid[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mid >= [0m[1;36m0x8000[0m[39m && id <= [0m[1;36m0xFFFF[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:               byte[0m[1;39m[[0m[1;39m][0m[39m guid = new byte[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:               if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, guid[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                  throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read guid"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:               int mptype = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:               [0m[35m/[0m[35m/[0m[39m Get the name of it[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:               String name;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:               [0m[1;35mif[0m[1;39m([0m[39mmptype == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                  [0m[35m/[0m[35m/[0m[39m It's based on a normal one[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                  int mpid = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                  MAPIProperty base = [0m[1;35mMAPIProperty.get[0m[1;39m([0m[39mmpid[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:                  name = base.name;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                  [0m[35m/[0m[35m/[0m[39m Custom name was stored[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                  int mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                  if [0m[1;39m([0m[39mmplen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [39mmplen[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                  if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen +[0m [2m                [0m
[2;36m                    [0m         [32m" bytes for attribute name"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                  name = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mmpdata, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mmplen/[0m[1;36m2[0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                  [0m[1;35mskipToBoundary[0m[1;39m([0m[39mmplen, inp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:               [0m[35m/[0m[35m/[0m[39m Now create[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:               prop = [0m[1;35mMAPIProperty.createCustom[0m[1;39m([0m[39mid, type, name[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/test/java/org/apache/poi/hmef/attribute/TestMAPIAttributes.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m64[0m[39m-[0m[1;36m90[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    void [0m[1;35mtestBasics[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[35m/[0m[35m/[0m[39m Try constructing two attributes[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[1;39m][0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                [0m[35m/[0m[35m/[0m[39m Level one, id [0m[1;36m36867[0m[39m, type [0m[1;36m6[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                [0m[1;36m0x01[0m[39m, [0m[1;36m0x03[0m[39m, [0m[1;39m([0m[39mbyte[0m[1;39m)[0m[39m [0m[1;36m0x90[0m[39m, [0m[1;36m0x06[0m[39m, [0m[1;36m0x00[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                [0m[35m/[0m[35m/[0m[39m Length [0m[1;36m24[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                [0m[1;36m0x24[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                [0m[35m/[0m[35m/[0m[39m Three attributes[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                [0m[1;36m0x03[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                [0m[35m/[0m[35m/[0m[39m AlternateRecipientAllowed = [0m[1;36m01[0m[39m [0m[1;36m00[0m                             [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                [0m[1;36m0x0B[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x02[0m[39m, [0m[1;36m0x00[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                [0m[1;36m0x01[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                [0m[35m/[0m[35m/[0m[39m Priority = [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;36m0x03[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x26[0m[39m, [0m[1;36m0x00[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[35m/[0m[35m/[0m[39m ConversationTopic = Test[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                [0m[1;36m0x1E[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x70[0m[39m, [0m[1;36m0x00[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;36m0x01[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                [0m[1;36m0x04[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[39m, [0m[1;36m0x00[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                [0m[1;39m([0m[39mbyte[0m[1;39m)[0m[39m [0m[32m'T'[0m[39m, [0m[1;39m([0m[39mbyte[0m[1;39m)[0m[39m [0m[32m'e'[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m([0m[39mbyte[0m[1;39m)[0m[39m [0m[32m's'[0m[39m, [0m[1;39m([0m[39mbyte[0m[1;39m)[0m[39m [0m[32m't'[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                [0m[35m/[0m[35m/[0m[39m Checksum [0m[1;39m([0m[39mmay be wrong[0m[33m...[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                [0m[1;36m0x01[0m[39m, [0m[1;36m0x00[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        ByteArrayInputStream bais = new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:222[0m[39m-[0m[1;36m2[0m [2m                [0m
[2;36m                    [0m         [1;36m43[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:   private static int [0m[1;35mgetLength[0m[1;39m([0m[39mMAPIType type, InputStream inp[0m[1;39m)[0m[39m throws [0m         [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:      if [0m[1;39m([0m[1;35mtype.isFixedLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:         return [0m[1;35mtype.getLength[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:      if [0m[1;39m([0m[39mtype == Types.ASCII_STRING ||[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:          type == Types.UNICODE_STRING ||[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:          type == Types.DIRECTORY ||[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:          type == Types.BINARY[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[35m/[0m[35m/[0m[39m Need to read the length, as it varies[0m                            [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:            return [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:      [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Unknown type "[0m[39m + type[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:   private static void [0m[1;35mskipToBoundary[0m[1;39m([0m[39mint length, InputStream inp[0m[1;39m)[0m[39m throws [0m      [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:      [0m[35m/[0m[35m/[0m[39m Data is always padded out to a [0m[1;36m4[0m[39m byte boundary[0m                         [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mlength % [0m[1;36m4[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:         int toSkip = [0m[1;36m4[0m[39m - [0m[1;39m([0m[39mlength % [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:         [0m[1;35minp.skip[0m[1;39m([0m[39mtoSkip[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/StringUtil.jav[0m[1;92ma:73[0m[39m-[0m[1;36m95[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *                                        the byte array [0m[1;39m([0m[39mi.e., is negative [0m [2m                [0m
[2;36m                    [0m         [39mor is greater than or equal to[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *                                        string.length[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @throws IllegalArgumentException       if len is too large [0m[1;39m([0m[39mi.e.,[0m         [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     *                                        there is not enough data in string[0m [2m                [0m
[2;36m                    [0m         [39mto create a String of that[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     *                                        length[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public static String [0m[1;35mgetFromUnicodeLE[0m[1;39m([0m                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:            final byte[0m[1;39m[[0m[1;39m][0m[39m string,[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            final int offset,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            final int len[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            throws ArrayIndexOutOfBoundsException, IllegalArgumentException [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39mlen == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[32m""[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39moffset < [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset >= string.length[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            throw new [0m[1;35mArrayIndexOutOfBoundsException[0m[1;39m([0m[32m"Illegal offset "[0m[39m + offset [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m" [0m[32m([0m[32mString data is of length "[0m[39m + string.length + [0m[32m"[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mlen < [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mstring.length - offset[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m[39m < len[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Illegal length "[0m[39m + len[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        return new [0m[1;35mString[0m[1;39m([0m[39mstring, offset, len * [0m[1;36m2[0m[39m, UTF16LE[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:166[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m77[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                  [0m[35m/[0m[35m/[0m[39m Custom name was stored[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                  int mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                  if [0m[1;39m([0m[39mmplen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [39mmplen[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                  if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen +[0m [2m                [0m
[2;36m                    [0m         [32m" bytes for attribute name"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                  name = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mmpdata, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mmplen/[0m[1;36m2[0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                  [0m[1;35mskipToBoundary[0m[1;39m([0m[39mmplen, inp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/StringUtil.jav[0m[1;92ma:28[0m[39m-[0m[1;36m45[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: * Collection of string handling utilities[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:@Internal[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:public final class StringUtil [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[35m/[0m[95marbitrarily[0m[39m selected; may need to increase[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private static final int DEFAULT_MAX_RECORD_LENGTH = [0m[1;36m10000000[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    private static int MAX_RECORD_LENGTH = DEFAULT_MAX_RECORD_LENGTH;[0m            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    public static final Charset UTF16LE = StandardCharsets.UTF_16LE;[0m             [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    public static final Charset UTF8 = StandardCharsets.UTF_8;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    public static final Charset WIN_1252 = [0m[1;35mCharset.forName[0m[1;39m([0m[32m"cp1252"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * @param length the max record length allowed for StringUtil[0m                [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    public static void [0m[1;35msetMaxRecordLength[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        MAX_RECORD_LENGTH = length;[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:166[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m77[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                  [0m[35m/[0m[35m/[0m[39m Custom name was stored[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                  int mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                  if [0m[1;39m([0m[39mmplen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [39mmplen[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                  if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen +[0m [2m                [0m
[2;36m                    [0m         [32m" bytes for attribute name"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                  name = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mmpdata, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mmplen/[0m[1;36m2[0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                  [0m[1;35mskipToBoundary[0m[1;39m([0m[39mmplen, inp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/Ole10Native.jav[0m[1;92ma:291[0m[39m-[0m[1;36m294[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    private static String [0m[1;35mreadUtf16[0m[1;39m([0m[39mLittleEndianByteArrayInputStream leis[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        int size = [0m[1;35mleis.readInt[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m buf = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mleis, size * [0m[1;36m2[0m[39m, MAX_STRING_LENGTH[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:        return [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mbuf, [0m[1;36m0[0m[39m, size[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:105[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m25[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:   public static List<MAPIAttribute> [0m[1;35mcreate[0m[1;39m([0m[39mTNEFAttribute parent[0m[1;39m)[0m[39m throws [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:      [0m[1;35mif[0m[1;39m([0m[1;35mparent.getProperty[0m[1;39m([0m[1;39m)[0m[39m == TNEFProperty.ID_MAPIPROPERTIES[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:         [0m[35m/[0m[35m/[0m[39m Regular MAPI Properties, normally on the message[0m                    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:      else [0m[1;35mif[0m[1;39m([0m[1;35mparent.getProperty[0m[1;39m([0m[1;39m)[0m[39m == TNEFProperty.ID_ATTACHMENT[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:         [0m[35m/[0m[35m/[0m[39m MAPI Properties for an attachment[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:      else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:         [0m[35m/[0m[35m/[0m[39m Something else, oh dear[0m[33m...[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:         throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m                                    [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:               [0m[32m"Can only create from a MAPIProperty attribute, "[0m[39m +[0m              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:               [0m[32m"instead received a "[0m[39m + [0m[1;35mparent.getProperty[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" one"[0m            [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:         [0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:      [0m[1;35mtry[0m[1;39m([0m[39mUnsynchronizedByteArrayInputStream inp = [0m                             [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[1;35mparent.getData[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:         [0m[35m/[0m[35m/[0m[39m First up, get the number of attributes[0m                              [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:         int count = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:         List<MAPIAttribute> attrs = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:         [0m[35m/[0m[35m/[0m[39m Now, read each one in in turn[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:         [0m[1;35mfor[0m[1;39m([0m[39mint [0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<count; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:186[0m[39m-[0m[1;36m2[0m [2m                [0m
[2;36m                    [0m         [1;36m20[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            [0m[35m/[0m[35m/[0m[39m Now read in the [0m[1;35mvalue[0m[1;39m([0m[39ms[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            int values = [0m[1;36m1[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39misMV || isVL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:               values = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            if [0m[1;39m([0m[39mtype == Types.NULL && values > [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:               throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Placeholder/NULL arrays aren't [0m           [2m                [0m
[2;36m                    [0m         [32msupported."[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            [0m[1;35mfor[0m[1;39m([0m[39mint [0m[33mj[0m[39m=[0m[1;36m0[0m[39m; j<values; j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:               int len = [0m[1;35mgetLength[0m[1;39m([0m[39mtype, inp[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:               byte[0m[1;39m[[0m[1;39m][0m[39m data = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlen, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:               [0m[1;35minp.read[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:               [0m[1;35mskipToBoundary[0m[1;39m([0m[39mlen, inp[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:               [0m[35m/[0m[35m/[0m[39m Create[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:               MAPIAttribute attr;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:               [0m[1;35mif[0m[1;39m([0m[39mtype == Types.UNICODE_STRING || type == Types.ASCII_STRING[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                  attr = new [0m[1;35mMAPIStringAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;35mif[0m[1;39m([0m[39mtype == Types.APP_TIME || type == Types.TIME[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:                  attr = new [0m[1;35mMAPIDateAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;35mif[0m[1;39m([0m[39mid == MAPIProperty.RTF_COMPRESSED.id[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                  attr = new [0m[1;35mMAPIRtfAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:                  attr = new [0m[1;35mMAPIAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:               [0m[1;35mattrs.add[0m[1;39m([0m[39mattr[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:         [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:         [0m[35m/[0m[35m/[0m[39m All done[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:         return attrs;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:43[0m[39m-[0m[1;36m46[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:   [0m[35m/[0m[35m/[0m[95marbitrarily[0m[39m selected; may need to increase[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:   private static final int DEFAULT_MAX_RECORD_LENGTH = 1_000_000;[0m               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:   private static int MAX_RECORD_LENGTH = 1_000_000;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:   private static int MAX_RECORD_COUNT = 10_000;[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/TNEFAttribute.jav[0m[1;92ma:37[0m[39m-[0m[1;36m39[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:   [0m[35m/[0m[35m/[0m[95marbitrarily[0m[39m selected; may need to increase[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:   private static final int DEFAULT_MAX_RECORD_LENGTH = 20_000_000;[0m              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:   private static int MAX_RECORD_LENGTH = DEFAULT_MAX_RECORD_LENGTH;[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/StringUtil.jav[0m[1;92ma:34[0m[39m-[0m[1;36m35[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private static final int DEFAULT_MAX_RECORD_LENGTH = [0m[1;36m10000000[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    private static int MAX_RECORD_LENGTH = DEFAULT_MAX_RECORD_LENGTH;[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:166[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m77[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                  [0m[35m/[0m[35m/[0m[39m Custom name was stored[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                  int mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                  if [0m[1;39m([0m[39mmplen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [39mmplen[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                  if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen +[0m [2m                [0m
[2;36m                    [0m         [32m" bytes for attribute name"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                  name = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mmpdata, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mmplen/[0m[1;36m2[0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                  [0m[1;35mskipToBoundary[0m[1;39m([0m[39mmplen, inp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:571[0m[39m-[0m[1;36m587[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m571[0m[39m:    public static byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35msafelyAllocate[0m[1;39m([0m[39mlong length, int maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m572[0m[39m:        [0m[1;35msafelyAllocateCheck[0m[1;39m([0m[39mlength, maxLength[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m573[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m574[0m[39m:        [0m[1;35mcheckByteSizeLimit[0m[1;39m([0m[39mlength[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:        return new byte[0m[1;39m[[0m[1;39m([0m[39mint[0m[1;39m)[0m[39mlength[0m[1;39m][0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:    public static void [0m[1;35msafelyAllocateCheck[0m[1;39m([0m[39mlong length, int maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:        if [0m[1;39m([0m[39mlength < 0L[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:            throw new [0m[1;35mRecordFormatException[0m[1;39m([0m[32m"Can't allocate an array of length [0m [2m                [0m
[2;36m                    [0m         [32m< 0, but had "[0m[39m + length + [0m[32m" and "[0m[39m + maxLength[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:        if [0m[1;39m([0m[39mlength > [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mInteger.MAX_VALUE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:            throw new [0m[1;35mRecordFormatException[0m[1;39m([0m[32m"Can't allocate an array > [0m         [2m                [0m
[2;36m                    [0m         [32m"[0m[39m+Integer.MAX_VALUE[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        [0m[1;35mcheckLength[0m[1;39m([0m[39mlength, maxLength[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:621[0m[39m-[0m[1;36m627[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m621[0m[39m:    private static void [0m[1;35mthrowRFE[0m[1;39m([0m[39mlong length, int maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m622[0m[39m:        throw new [0m[1;35mRecordFormatException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[39mLocale.ROOT, [0m[32m"Tried to [0m   [2m                [0m
[2;36m                    [0m         [32mallocate an array of length %,d"[0m[39m +[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m623[0m[39m:                        [0m[32m", but the maximum length for this record type is [0m      [2m                [0m
[2;36m                    [0m         [32m%,d.%n"[0m[39m +[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m624[0m[39m:                        [0m[32m"If the file is not corrupt and not large, please open [0m [2m                [0m
[2;36m                    [0m         [32man issue on bugzilla to request %n"[0m[39m +[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m625[0m[39m:                        [0m[32m"increasing the maximum allowable size for this record [0m [2m                [0m
[2;36m                    [0m         [32mtype.%n"[0m[39m+[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m626[0m[39m:                        [0m[32m"You can set a higher override value with [0m              [2m                [0m
[2;36m                    [0m         [32mIOUtils.setByteArrayMaxOverride[0m[32m([0m[32m)[0m[32m"[0m[39m, length, maxLength[0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:166[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m77[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                  [0m[35m/[0m[35m/[0m[39m Custom name was stored[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                  int mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                  if [0m[1;39m([0m[39mmplen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [39mmplen[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                  if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen +[0m [2m                [0m
[2;36m                    [0m         [32m" bytes for attribute name"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                  name = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mmpdata, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mmplen/[0m[1;36m2[0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                  [0m[1;35mskipToBoundary[0m[1;39m([0m[39mmplen, inp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/Ole10Native.jav[0m[1;92ma:291[0m[39m-[0m[1;36m294[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    private static String [0m[1;35mreadUtf16[0m[1;39m([0m[39mLittleEndianByteArrayInputStream leis[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        int size = [0m[1;35mleis.readInt[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m buf = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mleis, size * [0m[1;36m2[0m[39m, MAX_STRING_LENGTH[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:        return [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mbuf, [0m[1;36m0[0m[39m, size[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:571[0m[39m-[0m[1;36m577[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m571[0m[39m:    public static byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35msafelyAllocate[0m[1;39m([0m[39mlong length, int maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m572[0m[39m:        [0m[1;35msafelyAllocateCheck[0m[1;39m([0m[39mlength, maxLength[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m573[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m574[0m[39m:        [0m[1;35mcheckByteSizeLimit[0m[1;39m([0m[39mlength[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:        return new byte[0m[1;39m[[0m[1;39m([0m[39mint[0m[1;39m)[0m[39mlength[0m[1;39m][0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Root Cause Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability exists in `[0m[1;35mMAPIAttribute.create[0m[1;39m([0m[1;39m)[0m[39m` at lines [0m[1;36m167[0m[39m-[0m[1;36m175[0m[39m, specifically[0m [2m                [0m
[2;36m                    [0m         [39min the custom property name parsing logic. The issue occurs when:[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Line [0m[1;36m167[0m[39m**: `mplen` [0m[1;39m([0m[39mproperty name length[0m[1;39m)[0m[39m is read from untrusted input as a [0m  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m-byte integer[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Line [0m[1;36m168[0m[39m-[0m[1;36m170[0m[39m**: Only negative values are validated; no upper bound check is [0m   [2m                [0m
[2;36m                    [0m         [39mperformed[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Line [0m[1;36m171[0m[39m**: A byte array of size `mplen` is allocated without validation[0m       [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Line [0m[1;36m175[0m[39m**: `[0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mmpdata, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mmplen/[0m[1;36m2[0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m` attempts to [0m [2m                [0m
[2;36m                    [0m         [39mcreate a String object[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe critical issue is that `mplen` can be a very large positive value [0m[1;39m([0m[39mup to ~2GB[0m[1;39m)[0m[39m.[0m [2m                [0m
[2;36m                    [0m         [39mWhile the byte array at line [0m[1;36m171[0m[39m might succeed if reading from a pre-allocated [0m     [2m                [0m
[2;36m                    [0m         [39mparent buffer [0m[1;39m([0m[39mTNEFAttribute.data with 20MB limit[0m[1;39m)[0m[39m, the String object creation at [0m  [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m175[0m[39m internally allocates approximately `mplen` bytes via the String [0m           [2m                [0m
[2;36m                    [0m         [39mconstructor, causing an OutOfMemoryError.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe validation in `[0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[1;39m)[0m[39m` only checks if sufficient bytes [0m  [2m                [0m
[2;36m                    [0m         [39mexist in the input array, not whether the resulting String allocation would exceed [0m [2m                [0m
[2;36m                    [0m         [39mmemory constraints.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Fix Implementation[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Primary Fix Location**: [0m                                                          [2m                [0m
[2;36m                    [0m         [39m`poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java`, [0m   [2m                [0m
[2;36m                    [0m         [39mlines [0m[1;36m167[0m[39m-[0m[1;36m177[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current vulnerable code**:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Custom name was stored[0m                                                           [2m                [0m
[2;36m                    [0m         [39mint mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mmplen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + mplen[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mbyte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m   throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen + [0m[32m" bytes for attribute[0m [2m                [0m
[2;36m                    [0m         [32mname"[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mname = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mmpdata, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mmplen/[0m[1;36m2[0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;35mskipToBoundary[0m[1;39m([0m[39mmplen, inp[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Required change**:[0m                                                                [2m                [0m
[2;36m                    [0m         [39mReplace line [0m[1;36m171[0m[39m to use `[0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[1;39m)[0m[39m` instead of direct array [0m         [2m                [0m
[2;36m                    [0m         [39mallocation:[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Custom name was stored[0m                                                           [2m                [0m
[2;36m                    [0m         [39mint mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mmplen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + mplen[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mbyte[0m[1;39m[[0m[1;39m][0m[39m mpdata = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mmplen, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m CHANGED LINE[0m  [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m   throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen + [0m[32m" bytes for attribute[0m [2m                [0m
[2;36m                    [0m         [32mname"[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mname = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mmpdata, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mmplen/[0m[1;36m2[0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;35mskipToBoundary[0m[1;39m([0m[39mmplen, inp[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Specific modification**:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- **Line [0m[1;36m171[0m[39m**: Change from `byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;` to `byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = [0m [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mmplen, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;`[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Justification[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why this is the optimal approach:**[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Consistency with existing code**: This fix follows the exact pattern already [0m  [2m                [0m
[2;36m                    [0m         [39mused in the same file at line [0m[1;36m198[0m[39m for attribute value allocation:[0m                   [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   byte[0m[1;39m[[0m[1;39m][0m[39m data = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlen, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Follows established patterns**: The fix mirrors the pattern used in [0m           [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mOle10Native.readUtf16[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m291[0m[39m-[0m[1;36m294[0m[1;39m)[0m[39m and `[0m[1;35mVBAMacroReader.readString[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m  [2m                [0m
[2;36m                    [0m         [1;36m717[0m[1;39m)[0m[39m, which are reference implementations for safe string allocation in the POI [0m    [2m                [0m
[2;36m                    [0m         [39mcodebase.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Uses appropriate limit**: The fix uses `MAPIAttribute.MAX_RECORD_LENGTH` [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m1MB[0m[1;39m)[0m[39m, which is:[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - Already defined in the same class [0m[1;39m([0m[39mline [0m[1;36m45[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - Consistent with other MAPI attribute data limits[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Sufficient for legitimate property names[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - Prevents excessive memory allocation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Proper error handling**: `[0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[1;39m)[0m[39m` throws [0m                    [2m                [0m
[2;36m                    [0m         [39m`RecordFormatException` with a clear, informative error message [0m[1;39m([0m[39mas shown in lines [0m [2m                [0m
[2;36m                    [0m         [1;36m621[0m[39m-[0m[1;36m627[0m[1;39m)[0m[39m instead of allowing an `OutOfMemoryError`, providing better user guidance.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Comprehensive validation**: The method performs multiple checks:[0m               [2m                [0m
[2;36m                    [0m         [39m   - Negative length validation[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - Integer.MAX_VALUE overflow check[0m                                               [2m                [0m
[2;36m                    [0m         [39m   - Maximum length limit enforcement[0m                                               [2m                [0m
[2;36m                    [0m         [39m   - Global override support via `BYTE_ARRAY_MAX_OVERRIDE`[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. How it preserves existing logic[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **No functional changes**: The fix only adds validation; it doesn't change the [0m  [2m                [0m
[2;36m                    [0m         [39mparsing logic, data structures, or API signatures.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Valid files unaffected**: Legitimate TNEF/HMEF messages with reasonable [0m       [2m                [0m
[2;36m                    [0m         [39mproperty name sizes [0m[1;39m([0m[39m< 1MB[0m[1;39m)[0m[39m will continue to work exactly as before.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Existing error handling preserved**: The IOException checks for negative [0m      [2m                [0m
[2;36m                    [0m         [39mvalues and insufficient data remain intact.[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Same exception type**: The fix throws `RecordFormatException` [0m[1;39m([0m[39mwhich extends [0m  [2m                [0m
[2;36m                    [0m         [39m`RuntimeException`[0m[1;39m)[0m[39m, consistent with other allocation failures in the codebase.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Configurable limits**: The fix respects the existing `MAX_RECORD_LENGTH` [0m      [2m                [0m
[2;36m                    [0m         [39mconfiguration mechanism via `[0m[1;35msetMaxRecordLength[0m[1;39m([0m[1;39m)[0m[39m`.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. How it addresses the evaluation report[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Prevents OutOfMemoryError**: By validating `mplen` before allocation, the fix [0m [2m                [0m
[2;36m                    [0m         [39mprevents the heap exhaustion that caused the original issue.[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Mitigates DoS vulnerability**: The fix blocks malicious inputs that attempt to[0m [2m                [0m
[2;36m                    [0m         [39mexhaust system memory through oversized string allocations.[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Maintains security boundary**: The 1MB limit provides a reasonable upper bound[0m [2m                [0m
[2;36m                    [0m         [39mfor property names while preventing resource exhaustion attacks.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Clear error messages**: Users receive actionable error messages instead of [0m    [2m                [0m
[2;36m                    [0m         [39mcryptic OOM errors, with guidance on increasing limits if needed for legitimate [0m    [2m                [0m
[2;36m                    [0m         [39mlarge files.[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Addresses the exact call stack**: The fix targets line [0m[1;36m175[0m[39m in [0m                 [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mMAPIAttribute.create[0m[1;39m([0m[1;39m)[0m[39m`, which is the exact location identified in the evaluation [0m [2m                [0m
[2;36m                    [0m         [39mreport's stack trace.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m6[0m[39m. Potential side effects and mitigation[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential side effects:**[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Files with legitimately large property names might be rejected**: If a valid [0m  [2m                [0m
[2;36m                    [0m         [39mTNEF file contains custom property names > 1MB, it will now throw an exception.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   **Mitigation**: [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - The 1MB limit is extremely generous for property names [0m[1;39m([0m[39mequivalent to ~[0m[1;36m500[0m[39m,[0m[1;36m000[0m [2m                [0m
[2;36m                    [0m         [39mcharacters[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - Users can increase the limit via `[0m[1;35mMAPIAttribute.setMaxRecordLength[0m[1;39m([0m[1;39m)[0m[39m` if [0m      [2m                [0m
[2;36m                    [0m         [39mneeded[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - The error message provides clear guidance on how to adjust limits[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Different exception type**: Code that specifically catches `OutOfMemoryError` [0m [2m                [0m
[2;36m                    [0m         [39mwon't catch `RecordFormatException`.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   **Mitigation**:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - This is intentional and correct behavior - OOM should not be caught for [0m       [2m                [0m
[2;36m                    [0m         [39mresource exhaustion issues[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - `RecordFormatException` is the appropriate exception for malformed data[0m        [2m                [0m
[2;36m                    [0m         [39m   - Existing error handling for `IOException` and `RuntimeException` will catch [0m   [2m                [0m
[2;36m                    [0m         [39mthis[0m                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Performance impact**: The additional validation adds minimal overhead.[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   **Mitigation**:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[1;39m)[0m[39m` is already used extensively in the codebase without[0m [2m                [0m
[2;36m                    [0m         [39mperformance issues[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - The validation is simple integer comparisons before allocation[0m                 [2m                [0m
[2;36m                    [0m         [39m   - The overhead is negligible compared to file I/O and string processing[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m7[0m[39m. Similar patterns in the codebase[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix aligns with multiple existing patterns:[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **[0m[1;35mMAPIAttribute.create[0m[1;39m([0m[1;39m)[0m[39m line [0m[1;36m198[0m[39m**: Already uses this exact pattern for [0m        [2m                [0m
[2;36m                    [0m         [39mattribute values[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **[0m[1;35mOle10Native.readUtf16[0m[1;39m([0m[1;39m)[0m[39m**: Uses `[0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[1;39m)[0m[39m` with size limits [0m      [2m                [0m
[2;36m                    [0m         [39mbefore calling `[0m[1;35mgetFromUnicodeLE[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **[0m[1;35mVBAMacroReader.readString[0m[1;39m([0m[1;39m)[0m[39m**: Uses `[0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[1;39m)[0m[39m` for string [0m     [2m                [0m
[2;36m                    [0m         [39mbuffer allocation[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **TNEFAttribute constructor**: Uses `[0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[1;39m)[0m[39m` with [0m             [2m                [0m
[2;36m                    [0m         [39m`MAX_RECORD_LENGTH` for attribute data[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis consistency demonstrates that the fix is the standard, idiomatic approach for [0m [2m                [0m
[2;36m                    [0m         [39msafe allocation in the Apache POI codebase.[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=313561;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=153494;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=747371;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=624189;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpsbie4k90[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_1[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768146157.3739204[0m                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-poi_poi-full-01_vuln_1.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/11/26 15:42:39][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mapache-poi[0m     ]8;id=91109;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=676272;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=305735;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=908628;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-poi[0m            [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=713399;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=97999;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-poi[0m             [2m               [0m
