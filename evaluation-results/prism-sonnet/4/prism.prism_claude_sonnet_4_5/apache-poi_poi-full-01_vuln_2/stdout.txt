[2;36m[01/11/26 15:42:42][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=118107;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=880122;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp2uswvvlf[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768146162.925114[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-poi_poi-full-01_vuln_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m        ]8;id=100316;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=950958;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/11/26 15:44:59][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m Took  ]8;id=826364;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=717173;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m136.37[0m seconds; [33mexception[0m=[3;91mFalse[0m                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN            ]8;id=132013;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=665886;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN           ]8;id=607837;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=137960;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=273299;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=591689;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m136[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=415721;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=153861;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:45:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.92[0m seconds;            ]8;id=366688;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=119970;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/11/26 15:45:01][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=678463;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=412397;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=903895;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=359807;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=983531;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=826149;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=29962;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=710931;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:45:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m1.21[0m seconds;            ]8;id=331920;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=489911;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=910565;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=691932;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:45:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.87[0m seconds;            ]8;id=209949;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=641662;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/11/26 15:45:10][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=627126;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=849296;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp9638693774058612420/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m             [2m                [0m
[2;36m                    [0m         Entry/..[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1m([0mPOIFSDump.jav[1;92ma:108[0m[1m)[0m              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1m([0mPOIFSDump.jav[1;92ma:80[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1m([0mPOIPOIFSDumpFuzzer.jav[1;92ma:74[0m[1m)[0m    [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ac6e69a60acc10da                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp9638693774058612420/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m             [2m                [0m
[2;36m                    [0m         Entry/..[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1m([0mPOIFSDump.jav[1;92ma:108[0m[1m)[0m              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1m([0mPOIFSDump.jav[1;92ma:80[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1m([0mPOIPOIFSDumpFuzzer.jav[1;92ma:74[0m[1m)[0m    [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ac6e69a60acc10da                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/11/26 15:45:28][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=549673;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=442381;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/11/26 15:49:08][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=95708;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=992037;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/11/26 15:50:04][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=150053;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=911093;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=399660;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=713157;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:50:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.93[0m seconds;            ]8;id=21877;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=457855;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/11/26 15:50:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Started[33m...[0m                          ]8;id=157106;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=846195;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpyxg08cn5[0m                                                 ]8;id=270624;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=225300;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/11/26 15:52:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Took [1;36m121.99[0m seconds;               ]8;id=446368;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=531352;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Started[33m...[0m                    ]8;id=400711;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=712671;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:52:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Took [1;36m37.15[0m seconds;          ]8;id=376772;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=41568;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Started[33m...[0m                       ]8;id=588854;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=82413;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:52:51][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Took [1;36m5.87[0m seconds;              ]8;id=746637;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=184681;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Started[33m...[0m                           ]8;id=908515;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=215706;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=627762;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=845603;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=369692;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=250135;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:52:52][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.89[0m seconds;            ]8;id=546919;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=998904;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/11/26 15:52:53][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=304218;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=959462;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:52:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.89[0m seconds;            ]8;id=469481;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=225448;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=675009;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=198677;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 15:52:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.88[0m seconds;            ]8;id=499722;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=644636;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=298167;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=557298;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/poi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.java                     [2m                [0m
[2;36m                    [0m         +++ b/poi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.java                     [2m                [0m
[2;36m                    [0m         @@ [1;36m-24[0m,[1;36m6[0m +[1;36m24[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m          import java.nio.file.Files;                                                        [2m                [0m
[2;36m                    [0m          import java.nio.file.Paths;                                                        [2m                [0m
[2;36m                    [0m          import java.util.Iterator;                                                         [2m                [0m
[2;36m                    [0m         +import java.util.regex.Pattern;                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          import org.apache.poi.poifs.common.POIFSConstants;                                 [2m                [0m
[2;36m                    [0m          import org.apache.poi.poifs.filesystem.DirectoryEntry;                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-72[0m,[1;36m7[0m +[1;36m73[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m                          File dumpDir =                                                     [2m                [0m
[2;36m                    [0m                                  [1;35mPaths.get[0m[1m([0mfilename[1m)[0m[1;35m.getParent[0m[1m([0m[1m)[0m                            [2m                [0m
[2;36m                    [0m                                          [1;35m.resolve[0m[1m([0mfilenameWithoutPath + [32m"_dump"[0m[1m)[0m[1;35m.toFile[0m[1m([0m[1m)[0m;  [2m                [0m
[2;36m                    [0m         -                File file = new [1;35mFile[0m[1m([0mdumpDir, [1;35mroot.getName[0m[1m([0m[1m)[0m[1m)[0m;                     [2m                [0m
[2;36m                    [0m         +                File file = [1;35mvalidateAndCreateFile[0m[1m([0m[1;35mdumpDir.getCanonicalFile[0m[1m([0m[1m)[0m,      [2m                [0m
[2;36m                    [0m         [1;35mroot.getName[0m[1m([0m[1m)[0m[1m)[0m;                                                                    [2m                [0m
[2;36m                    [0m                          if [1m([0m![1;35mfile.exists[0m[1m([0m[1m)[0m && ![1;35mfile.mkdirs[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                            [2m                [0m
[2;36m                    [0m                              throw new [1;35mIOException[0m[1m([0m[32m"Could not create directory "[0m + file[1m)[0m;   [2m                [0m
[2;36m                    [0m                          [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-105[0m,[1;36m12[0m +[1;36m106[0m,[1;36m13[0m @@                                                               [2m                [0m
[2;36m                    [0m                          try [1m([0mDocumentInputStream is = new [1;35mDocumentInputStream[0m[1m([0mnode[1m)[0m[1m)[0m [1m{[0m     [2m                [0m
[2;36m                    [0m                             bytes = [1;35mIOUtils.toByteArray[0m[1m([0mis[1m)[0m;                                [2m                [0m
[2;36m                    [0m                          [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m         -                try [1m([0mOutputStream out = [1;35mFiles.newOutputStream[0m[1m([0mnew [1;35mFile[0m[1m([0mparent,     [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1m([0m[1m)[0m[1;35m.trim[0m[1m([0m[1m)[0m[1m)[0m[1;35m.toPath[0m[1m([0m[1m)[0m[1m)[0m[1m)[0m [1m{[0m                                                 [2m                [0m
[2;36m                    [0m         +                File safeFile = [1;35mvalidateAndCreateFile[0m[1m([0mparent,                      [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1m([0m[1m)[0m[1;35m.trim[0m[1m([0m[1m)[0m[1m)[0m;                                                             [2m                [0m
[2;36m                    [0m         +                try [1m([0mOutputStream out = [1;35mFiles.newOutputStream[0m[1m([0m[1;35msafeFile.toPath[0m[1m([0m[1m)[0m[1m)[0m[1m)[0m  [2m                [0m
[2;36m                    [0m         [1m{[0m                                                                                   [2m                [0m
[2;36m                    [0m                              [1;35mout.write[0m[1m([0mbytes[1m)[0m;                                              [2m                [0m
[2;36m                    [0m                          [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m                      [1m}[0m else if [1m([0mentry instanceof DirectoryEntry[1m)[0m[1m{[0m                           [2m                [0m
[2;36m                    [0m                          DirectoryEntry dir = [1m([0mDirectoryEntry[1m)[0mentry;                        [2m                [0m
[2;36m                    [0m         -                File file = new [1;35mFile[0m[1m([0mparent, [1;35mentry.getName[0m[1m([0m[1m)[0m[1m)[0m;                     [2m                [0m
[2;36m                    [0m         +                File file = [1;35mvalidateAndCreateFile[0m[1m([0mparent, [1;35mentry.getName[0m[1m([0m[1m)[0m[1m)[0m;        [2m                [0m
[2;36m                    [0m                          [1;35mif[0m[1m([0m![1;35mfile.exists[0m[1m([0m[1m)[0m && ![1;35mfile.mkdirs[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                             [2m                [0m
[2;36m                    [0m                              throw new [1;35mIOException[0m[1m([0m[32m"Could not create directory "[0m + file[1m)[0m;   [2m                [0m
[2;36m                    [0m                          [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-121[0m,[1;36m7[0m +[1;36m123[0m,[1;36m7[0m @@                                                                 [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m              public static void [1;35mdump[0m[1m([0mPOIFSFileSystem fs, int startBlock, String name, File  [2m                [0m
[2;36m                    [0m         parent[1m)[0m throws IOException [1m{[0m                                                        [2m                [0m
[2;36m                    [0m         -        File file = new [1;35mFile[0m[1m([0mparent, name[1m)[0m;                                        [2m                [0m
[2;36m                    [0m         +        File file = [1;35mvalidateAndCreateFile[0m[1m([0mparent, name[1m)[0m;                           [2m                [0m
[2;36m                    [0m                  if [1m([0m! [1;35mFiles.isDirectory[0m[1m([0m[1;35mfile.toPath[0m[1m([0m[1m)[0m[1;35m.getParent[0m[1m([0m[1m)[0m[1m)[0m[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m                      [1;35mFiles.createDirectories[0m[1m([0m[1;35mfile.toPath[0m[1m([0m[1m)[0m[1;35m.getParent[0m[1m([0m[1m)[0m[1m)[0m;                    [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         @@ [1;36m-136[0m,[1;36m4[0m +[1;36m138[0m,[1;36m42[0m @@                                                                [2m                [0m
[2;36m                    [0m                      [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +    private static final Pattern PATH_TRAVERSAL_PATTERN =                          [2m                [0m
[2;36m                    [0m         [1;35mPattern.compile[0m[1m([0m[32m"\\.\\.[0m[32m[[0m[32m\\\\/[0m[32m][0m[32m|[0m[32m[[0m[32m\\\\/[0m[32m][0m[32m\\.\\.|^\\.\\.$"[0m[1m)[0m;                            [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +    [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         +     * Validates and creates a File object, preventing path traversal attacks.     [2m                [0m
[2;36m                    [0m         +     *                                                                             [2m                [0m
[2;36m                    [0m         +     * @param parent the parent directory                                          [2m                [0m
[2;36m                    [0m         +     * @param childName the name of the child file or directory from POIFS entry   [2m                [0m
[2;36m                    [0m         +     * @return a validated File object                                             [2m                [0m
[2;36m                    [0m         +     * @throws IOException if path traversal is detected or validation fails       [2m                [0m
[2;36m                    [0m         +     *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         +    private static File [1;35mvalidateAndCreateFile[0m[1m([0mFile parent, String childName[1m)[0m       [2m                [0m
[2;36m                    [0m         throws IOException [1m{[0m                                                                [2m                [0m
[2;36m                    [0m         +        if [1m([0mchildName == null || [1;35mchildName.isEmpty[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                            [2m                [0m
[2;36m                    [0m         +            throw new [1;35mIOException[0m[1m([0m[32m"Child name cannot be null or empty"[0m[1m)[0m;           [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        String sanitizedName = childName;                                          [2m                [0m
[2;36m                    [0m         +        sanitizedName = [1;35msanitizedName.replace[0m[1m([0m[32m".."[0m, [32m"_"[0m[1m)[0m;                          [2m                [0m
[2;36m                    [0m         +        sanitizedName = [1;35msanitizedName.replace[0m[1m([0m[32m'/'[0m, [32m'_'[0m[1m)[0m;                           [2m                [0m
[2;36m                    [0m         +        sanitizedName = [1;35msanitizedName.replace[0m[1m([0m[32m'\\', '[0m_'[1m)[0m;                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        if [1m([0m[1;35mPATH_TRAVERSAL_PATTERN.matcher[0m[1m([0mchildName[1m)[0m[1;35m.find[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                    [2m                [0m
[2;36m                    [0m         +            throw new [1;35mIOException[0m[1m([0m[32m"Path traversal detected in entry name: "[0m +      [2m                [0m
[2;36m                    [0m         childName[1m)[0m;                                                                         [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        File candidate = new [1;35mFile[0m[1m([0mparent, sanitizedName[1m)[0m;                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        String parentCanonical = [1;35mparent.getCanonicalPath[0m[1m([0m[1m)[0m;                        [2m                [0m
[2;36m                    [0m         +        String candidateCanonical = [1;35mcandidate.getCanonicalPath[0m[1m([0m[1m)[0m;                  [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        if [1m([0m![1;35mcandidateCanonical.startsWith[0m[1m([0mparentCanonical + File.separator[1m)[0m &&    [2m                [0m
[2;36m                    [0m         +            ![1;35mcandidateCanonical.equals[0m[1m([0mparentCanonical[1m)[0m[1m)[0m [1m{[0m                         [2m                [0m
[2;36m                    [0m         +            throw new [1;35mIOException[0m[1m([0m[32m"Path traversal detected: entry '"[0m + childName + [2m                [0m
[2;36m                    [0m         +                                [32m"' would create file outside parent directory: "[0m + [2m                [0m
[2;36m                    [0m         candidateCanonical[1m)[0m;                                                                [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        return candidate;                                                          [2m                [0m
[2;36m                    [0m         +    [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp9638693774058612420/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m             [2m                [0m
[2;36m                    [0m         Entry/..[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1m([0mPOIFSDump.jav[1;92ma:108[0m[1m)[0m              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1m([0mPOIFSDump.jav[1;92ma:80[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1m([0mPOIPOIFSDumpFuzzer.jav[1;92ma:74[0m[1m)[0m    [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ac6e69a60acc10da                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A critical security vulnerability has been detected in Apache POI's POIFSDump       [2m                [0m
[2;36m                    [0m         utility. The fuzzer identified a file path traversal issue where the code allows    [2m                [0m
[2;36m                    [0m         traversal outside of the intended directory structure using [32m"../"[0m path sequences.   [2m                [0m
[2;36m                    [0m         The vulnerability was triggered when processing a specially crafted input file that [2m                [0m
[2;36m                    [0m         contains directory entries with path traversal patterns.                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Vulnerability Type                                                              [2m                [0m
[2;36m                    [0m         This is a **File Path Traversal** vulnerability [1m([0malso known as Directory Traversal  [2m                [0m
[2;36m                    [0m         or Path Traversal[1m)[0m, classified as a critical security issue by the Jazzer fuzzing   [2m                [0m
[2;36m                    [0m         framework. Path traversal vulnerabilities allow attackers to access files and       [2m                [0m
[2;36m                    [0m         directories stored outside the intended restricted directory by manipulating file   [2m                [0m
[2;36m                    [0m         path inputs with [32m"../"[0m sequences.                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Issue Details                                                                   [2m                [0m
[2;36m                    [0m         The vulnerability manifests in the following sequence:                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. The POIFSDump utility is processing a POIFS [1m([0mPoor Obfuscation Implementation     [2m                [0m
[2;36m                    [0m         File System[1m)[0m file                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m. During the dump operation, the code encounters an entry named [32m"Root [0m             [2m                [0m
[2;36m                    [0m         [32mEntry/../../../../jazzer-traversal"[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m. This path contains multiple [32m"../"[0m sequences that attempt to navigate up the      [2m                [0m
[2;36m                    [0m         directory hierarchy                                                                 [2m                [0m
[2;36m                    [0m         [1;36m4[0m. The path starts from                                                             [2m                [0m
[2;36m                    [0m         `[35m/tmp/expander-tmp9638693774058612420/output/q/r/s/t/input.bin_dump/[0m` and attempts  [2m                [0m
[2;36m                    [0m         to traverse outside this directory                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m. The Jazzer sanitizer detects this attempted path traversal and raises a          [2m                [0m
[2;36m                    [0m         `FuzzerSecurityIssueCritical` exception                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Stack Trace Analysis                                                            [2m                [0m
[2;36m                    [0m         The exception originates from:                                                      [2m                [0m
[2;36m                    [0m         - `[1;35mPOIFSDump.dump[0m[1m([0m[1m)[0m` at line [1;36m108[0m: where the actual file/directory operations are    [2m                [0m
[2;36m                    [0m         being performed                                                                     [2m                [0m
[2;36m                    [0m         - `[1;35mPOIFSDump.main[0m[1m([0m[1m)[0m` at line [1;36m80[0m: the entry point for the dump operation             [2m                [0m
[2;36m                    [0m         - The fuzzer harness `[1;35mPOIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1m([0m[1m)[0m` at line [1;36m74[0m serves as [2m                [0m
[2;36m                    [0m         the entry point for fuzzing                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         The sanitizer hooks that detected the issue:                                        [2m                [0m
[2;36m                    [0m         - `[1;35mFilePathTraversal.pathFirstArgHook[0m[1m([0m[1m)[0m` at line [1;36m177[0m: intercepts the path parameter [2m                [0m
[2;36m                    [0m         - `[1;35mFilePathTraversal.checkPath[0m[1m([0m[1m)[0m` at line [1;36m293[0m: validates the path                   [2m                [0m
[2;36m                    [0m         - `[1;35mFilePathTraversal.check[0m[1m([0m[1m)[0m` at line [1;36m346[0m: performs the actual security check and   [2m                [0m
[2;36m                    [0m         raises the exception                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Areas for Investigation                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         To understand the full scope of this vulnerability, the following components should [2m                [0m
[2;36m                    [0m         be investigated:                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **[1;35mPOIFSDump.dump[0m[1m([0m[1m)[0m method** [1m([0mline [1;36m108[0m[1m)[0m: Examine how directory entries from the   [2m                [0m
[2;36m                    [0m         POIFS structure are being processed and used to create file paths for output.       [2m                [0m
[2;36m                    [0m         Investigate whether the code validates or sanitizes entry names before using them   [2m                [0m
[2;36m                    [0m         in file system operations.                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **POIFS Entry Processing**: Review how the POI library reads and processes       [2m                [0m
[2;36m                    [0m         directory entry names from POIFS files, particularly entries within the [32m"Root [0m      [2m                [0m
[2;36m                    [0m         [32mEntry"[0m directory structure.                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Path Construction Logic**: Identify where and how file paths are constructed   [2m                [0m
[2;36m                    [0m         when extracting or dumping POIFS content, especially how entry names are combined   [2m                [0m
[2;36m                    [0m         with base output directories.                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **Input Validation**: Assess what input validation is currently performed on     [2m                [0m
[2;36m                    [0m         POIFS entry names before they are used in file system operations.                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m. **Related POI Utilities**: Check if other POI utilities that process POIFS files [2m                [0m
[2;36m                    [0m         or perform similar dump/extract operations might have similar vulnerabilities.      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m. **File System Operations**: Trace all file creation, directory creation, and     [2m                [0m
[2;36m                    [0m         file writing operations in the POIFSDump utility to identify where untrusted input  [2m                [0m
[2;36m                    [0m         is being used to construct file system paths.                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp9638693774058612420/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39mEntry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:108[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:80[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIPOIFSDumpFuzzer.jav[0m[1;92ma:74[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: ac6e69a60acc10da[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:17[0m[39m-[0m[1;36m38[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.poi.poifs.dev;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.poifs.common.POIFSConstants;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.poifs.filesystem.DirectoryEntry;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.poifs.filesystem.DocumentInputStream;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.poifs.filesystem.DocumentNode;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.poifs.filesystem.Entry;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.poi.poifs.filesystem.POIFSFileSystem;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.poi.poifs.filesystem.POIFSStream;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.poi.poifs.property.PropertyTable;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.poi.poifs.storage.HeaderBlock;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.poi.util.IOUtils;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:99[0m[39m-[0m[1;36m122[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mentry instanceof DocumentNode[0m[1;39m)[0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                final DocumentNode node = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                final byte[0m[1;39m[[0m[1;39m][0m[39m bytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                   bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mdir, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Skipping unsupported POIFS entry: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mentry[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/Entry.jav[0m[1;92ma:1[0m[39m-[0m[1;36m95[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.poi.poifs.filesystem;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: * This interface provides access to an object managed by a Filesystem[0m           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: * instance. Entry objects are further divided into DocumentEntry and[0m            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: * DirectoryEntry instances.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public interface Entry[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     * get the name of the Entry[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * @return name[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     * is this a DirectoryEntry?[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * @return true if the Entry is a DirectoryEntry, else false[0m                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    public boolean [0m[1;35misDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * is this a DocumentEntry?[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @return true if the Entry is a DocumentEntry, else false[0m                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public boolean [0m[1;35misDocumentEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * get this Entry's parent [0m[1;39m([0m[39mthe DirectoryEntry that owns this[0m                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * Entry[0m[1;39m)[0m[39m. All Entry objects, except the root Entry, has a parent.[0m           [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * @return this Entry's parent; null iff this is the root Entry[0m              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public DirectoryEntry [0m[1;35mgetParent[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * Delete this Entry. This operation should succeed, but there are[0m           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * special circumstances when it will not:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * If this Entry is the root of the Entry tree, it cannot be[0m                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * deleted, as there is no way to create another one.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * If this Entry is a directory, it cannot be deleted unless it is[0m           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * empty.[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @return true if the Entry was successfully deleted, else false[0m            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    public boolean [0m[1;35mdelete[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * Rename this Entry. This operation will fail if:[0m                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     * There is a sibling Entry [0m[1;39m([0m[39mi.e., an Entry whose parent is the[0m              [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * same as this Entry's parent[0m[1;39m)[0m[39m with the same name.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * This Entry is the root of the Entry tree. Its name is dictated[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     * by the Filesystem and many not be changed.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     * @param newName the new name for this Entry[0m                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * @return true if the operation succeeded, else false[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public boolean [0m[1;35mrenameTo[0m[1;39m([0m[39mfinal String newName[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m[1;39m}[0m[39m   [0m[35m/[0m[35m/[0m[39m end public interface Entry[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/EntryUtils.jav[0m[1;92ma:1[0m[39m-[0m[1;36m31[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.poi.poifs.filesystem;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.stream.Collectors;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.stream.StreamSupport;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.hpsf.NoPropertySetStreamException;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.hpsf.PropertySet;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.hpsf.PropertySetFactory;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.util.Internal;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/EntryUtils.jav[0m[1;92ma:37[0m[39m-[0m[1;36m58[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * Copies an Entry into a target POIFS directory, recursively[0m                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Internal[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public static void [0m[1;35mcopyNodeRecursively[0m[1;39m([0m[39m Entry entry, DirectoryEntry target [0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    throws IOException [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        if [0m[1;39m([0m[39m [0m[1;35mentry.isDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            DirectoryEntry dirEntry = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:            DirectoryEntry newTarget = [0m[1;35mtarget.createDirectory[0m[1;39m([0m[39m [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:            [0m[1;35mnewTarget.setStorageClsid[0m[1;39m([0m[39m [0m[1;35mdirEntry.getStorageClsid[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:            Iterator<Entry> entries = [0m[1;35mdirEntry.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            while [0m[1;39m([0m[39m [0m[1;35mentries.hasNext[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                [0m[1;35mcopyNodeRecursively[0m[1;39m([0m[39m [0m[1;35mentries.next[0m[1;39m([0m[1;39m)[0m[39m, newTarget [0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            DocumentEntry dentry = [0m[1;39m([0m[39mDocumentEntry[0m[1;39m)[0m[39m entry;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            DocumentInputStream dstream = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39m dentry [0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            [0m[1;35mtarget.createDocument[0m[1;39m([0m[39m [0m[1;35mdentry.getName[0m[1;39m([0m[1;39m)[0m[39m, dstream [0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:            [0m[1;35mdstream.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/xdgf/util/Util.jav[0m[1;92ma:20[0m[39m-[0m[1;36m37[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:public class Util [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:    public static int [0m[1;35mcountLines[0m[1;39m([0m[39mString str[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:        int lines = [0m[1;36m1[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        int pos = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        while [0m[1;39m([0m[1;39m([0m[39mpos = [0m[1;35mstr.indexOf[0m[1;39m([0m[32m'\n'[0m[39m, pos[0m[1;39m)[0m[39m + [0m[1;36m1[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:            lines++;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:        return lines;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[35m/[0m[39m this probably isn't [0m[1;36m100[0m[39m% correct, so don't use it in security-sensitive[0m   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[35m/[0m[35m/[0m[39m applications![0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[35m/[0m[39m from: [0m[4;94mhttp://www.rgagnon.com/javadetails/java-0662.html[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static String [0m[1;35msanitizeFilename[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSLister.jav[0m[1;92ma:79[0m[39m-[0m[1;36m107[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:   public static void [0m[1;35mdisplayDirectory[0m[1;39m([0m[39mDirectoryNode dir, String indent, boolean[0m [2m                [0m
[2;36m                    [0m         [39mwithSizes[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      [0m[1;35mSystem.out.println[0m[1;39m([0m[39mindent + [0m[1;35mdir.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" -"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      String newIndent = indent + [0m[32m"  "[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:      boolean hadChildren = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:      [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mdir.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:         hadChildren = true;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:         Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:         if [0m[1;39m([0m[39mentry instanceof DirectoryNode[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            [0m[1;35mdisplayDirectory[0m[1;39m([0m[1;39m([0m[39mDirectoryNode[0m[1;39m)[0m[39m entry, newIndent, withSizes[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:         [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            DocumentNode doc = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            String name = [0m[1;35mdoc.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            String size = [0m[32m""[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            if [0m[1;39m([0m[1;35mname.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m < [0m[1;36m10[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:               String altname = [0m[32m"[0m[32m([0m[32m0x0"[0m[39m + [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m [0m[1;35mname.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m + [0m[32m"[0m[32m)[0m[32m"[0m[39m + [0m           [2m                [0m
[2;36m                    [0m         [1;35mname.substring[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:               name = [0m[1;35mname.substring[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m + [0m[32m" <"[0m[39m + altname + [0m[32m">"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            if [0m[1;39m([0m[39mwithSizes[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:               size = [0m[32m" [0m[32m[[0m[32m"[0m[39m + [0m[1;35mdoc.getSize[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" / 0x"[0m[39m +[0m                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                      [0m[1;35mInteger.toHexString[0m[1;39m([0m[1;35mdoc.getSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m + [0m[32m"[0m[32m][0m[32m"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;35mSystem.out.println[0m[1;39m([0m[39mnewIndent + name + size[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:         [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:      if [0m[1;39m([0m[39m!hadChildren[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:         [0m[1;35mSystem.out.println[0m[1;39m([0m[39mnewIndent + [0m[32m"[0m[32m([0m[32mno children[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/poifs/crypt/dsig/facets/OOXMLSignatureFacet.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:213[0m[39m-[0m[1;36m225[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    private static String [0m[1;35mnormalizePartName[0m[1;39m([0m[39mURI partName, String baseUri[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows XMLSignatureException [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        String pn = [0m[1;35mpartName.toASCIIString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mpn.startsWith[0m[1;39m([0m[39mbaseUri[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            pn = baseUri + pn;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            pn = new [0m[1;35mURI[0m[1;39m([0m[39mpn[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[32m'\\', '[0m[35m/[0m[39m'[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:            [0m[1;35mLOG.atDebug[0m[1;39m([0m[1;39m)[0m[1;35m.log[0m[1;39m([0m[32m"part name: [0m[32m{[0m[32m}[0m[32m"[0m[39m, pn[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mURISyntaxException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:            throw new [0m[1;35mXMLSignatureException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:        return pn;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/openxml4j/util/ZipSecureFile.jav[0m[1;92ma:20[0m[39m-[0m[1;36m33[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.commons.compress.archivers.zip.ZipArchiveEntry;[0m                [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.commons.compress.archivers.zip.ZipFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.logging.PoiLogManager;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.openxml4j.opc.internal.InvalidZipException;[0m                [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.util.Internal;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.poi.util.Removal;[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/openxml4j/util/ZipSecureFile.jav[0m[1;92ma:206[0m[39m-[0m[1;36m224[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:     * @param file the [0m[1;39m{[0m[39m@link File[0m[1;39m}[0m[39m, possibly including path traversal - it is [0m [2m                [0m
[2;36m                    [0m         [39mup to users to validate that the input value is safe[0m                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:     * @throws IOException if an error occurs while reading the file.[0m           [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    public [0m[1;35mZipSecureFile[0m[1;39m([0m[39mFile file[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mfile[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:        this.fileName = [0m[1;35mfile.getAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;35mvalidateEntryNames[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:     * @param name the file name, possibly including path traversal - it is up [0m [2m                [0m
[2;36m                    [0m         [39mto users to validate that the input value is safe[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:     * @throws IOException  if an error occurs while reading the file.[0m          [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    public [0m[1;35mZipSecureFile[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        this.fileName = new [0m[1;35mFile[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.getAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:        [0m[1;35mvalidateEntryNames[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/openxml4j/util/ZipSecureFile.jav[0m[1;92ma:257[0m[39m-[0m[1;36m272[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    private void [0m[1;35mvalidateEntryNames[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:        final Enumeration<ZipArchiveEntry> en = [0m[1;35mgetEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:        final Set<String> filenames = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:        while [0m[1;39m([0m[1;35men.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:            final ZipArchiveEntry entry = [0m[1;35men.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:            String name = [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:            if [0m[1;39m([0m[39mname == null || [0m[1;35mname.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:                throw new [0m[1;35mInvalidZipException[0m[1;39m([0m[32m"Input file contains an entry [0m    [2m                [0m
[2;36m                    [0m         [32mwith an empty name"[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:            name = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:            if [0m[1;39m([0m[1;35mfilenames.contains[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:                throw new [0m[1;35mInvalidZipException[0m[1;39m([0m[32m"Input file contains more than 1 [0m [2m                [0m
[2;36m                    [0m         [32mentry with the name "[0m[39m + [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:            [0m[1;35mfilenames.add[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/DirectoryProperty.jav[0m[1;92ma:42[0m[39m-[0m[1;36m56[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * Default constructor[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * @param name the name of the directory[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    public [0m[1;35mDirectoryProperty[0m[1;39m([0m[39mString name[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;35msetName[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;35msetSize[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;35msetPropertyType[0m[1;39m([0m[39mPropertyConstants.DIRECTORY_TYPE[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;35msetStartBlock[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;35msetNodeColor[0m[1;39m([0m[39m_NODE_BLACK[0m[1;39m)[0m[39m;   [0m[35m/[0m[35m/[0m[39m simplification[0m                           [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/DirectoryProperty.jav[0m[1;92ma:268[0m[39m-[0m[1;36m279[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    public void [0m[1;35maddChild[0m[1;39m([0m[39mfinal Property property[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:        throws IOException[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        String name = [0m[1;35mproperty.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:        if [0m[1;39m([0m[1;35m_children_names.contains[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Duplicate name \""[0m[39m + name + [0m[32m"\""[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        [0m[1;35m_children_names.add[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:        [0m[1;35m_children.add[0m[1;39m([0m[39mproperty[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:150[0m[39m-[0m[1;36m162[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            int    name_offset = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            for [0m[1;39m([0m[39mint j = [0m[1;36m0[0m[39m; j < name_length; j++[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                char_array[0m[1;39m[[0m[39m j [0m[1;39m][0m[39m = [0m[1;39m([0m[39m char [0m[1;39m)[0m[39m new [0m[1;35mShortField[0m[1;39m([0m[39mname_offset,[0m          [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                                                          _raw_data[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                name_offset     += LittleEndianConsts.SHORT_SIZE;[0m               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            _name = new [0m[1;35mString[0m[1;39m([0m[39mchar_array, [0m[1;36m0[0m[39m, name_length[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        _next_child     = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        _previous_child = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:232[0m[39m-[0m[1;36m240[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:     * Get the name of this property[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:     * @return property name as String[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:        return _name;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:265[0m[39m-[0m[1;36m286[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        int    limit      = [0m[1;35mMath.min[0m[1;39m([0m[39mchar_array.length, _max_name_length[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:        _name = new [0m[1;35mString[0m[1;39m([0m[39mchar_array, [0m[1;36m0[0m[39m, limit[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:        short offset = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:        int   j      = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        for [0m[1;39m([0m[39m; j < limit; j++[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:            new [0m[1;35mShortField[0m[1;39m([0m[39moffset, [0m[1;39m([0m[39m short [0m[1;39m)[0m[39m char_array[0m[1;39m[[0m[39m j [0m[1;39m][0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            offset += [0m[1;39m([0m[39mshort[0m[1;39m)[0m[39m LittleEndianConsts.SHORT_SIZE;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:        for [0m[1;39m([0m[39m; j < _max_name_length + [0m[1;36m1[0m[39m; j++[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:            new [0m[1;35mShortField[0m[1;39m([0m[39moffset, [0m[1;39m([0m[39m short [0m[1;39m)[0m[39m [0m[1;36m0[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:            offset += [0m[1;39m([0m[39mshort[0m[1;39m)[0m[39m LittleEndianConsts.SHORT_SIZE;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        [0m[35m/[0m[35m/[0m[39m double the count, and include the null at the end[0m                    [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        _name_size[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:            [0m[1;35m.set[0m[1;39m([0m[1;39m([0m[39m short [0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mlimit + [0m[1;36m1[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:                            * LittleEndianConsts.SHORT_SIZE[0m[1;39m)[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-integration/src/test/java/org/apache/poi/stress/POIFSFileHandler.jav[0m[1;92ma:32[0m[39m-[0m[1;36m57[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:public class POIFSFileHandler extends AbstractFileHandler [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    public void [0m[1;35mhandleFile[0m[1;39m([0m[39mInputStream stream, String path[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:        try [0m[1;39m([0m[39mPOIFSFileSystem fs = new [0m[1;35mPOIFSFileSystem[0m[1;39m([0m[39mstream[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:            [0m[1;35mhandlePOIFSFileSystem[0m[1;39m([0m[39mfs[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:            [0m[1;35mhandleHPSFProperties[0m[1;39m([0m[39mfs[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    private void [0m[1;35mhandleHPSFProperties[0m[1;39m([0m[39mPOIFSFileSystem fs[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        try [0m[1;39m([0m[39mHPSFPropertiesExtractor ext = new [0m[1;35mHPSFPropertiesExtractor[0m[1;39m([0m[39mfs[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            [0m[35m/[0m[35m/[0m[39m can be null[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:            [0m[1;35mext.getDocSummaryInformation[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:            [0m[1;35mext.getSummaryInformation[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            [0m[1;35massertNotNull[0m[1;39m([0m[1;35mext.getDocumentSummaryInformationText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            [0m[1;35massertNotNull[0m[1;39m([0m[1;35mext.getSummaryInformationText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            [0m[1;35massertNotNull[0m[1;39m([0m[1;35mext.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private void [0m[1;35mhandlePOIFSFileSystem[0m[1;39m([0m[39mPOIFSFileSystem fs[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[39mfs[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[1;35mfs.getRoot[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/Ole10Native.jav[0m[1;92ma:1[0m[39m-[0m[1;36m33[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.poifs.filesystem;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.commons.io.input.UnsynchronizedByteArrayInputStream;[0m           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.commons.io.output.UnsynchronizedByteArrayOutputStream;[0m         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.util.IOUtils;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.util.LittleEndianByteArrayInputStream;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.util.LittleEndianConsts;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.util.LittleEndianInput;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.util.LittleEndianOutputStream;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.util.StringUtil;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/Ole10Native.jav[0m[1;92ma:67[0m[39m-[0m[1;36m89[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;36m4[0m[39m bytes, total size of record not including this field[0m                    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private int totalSize;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;36m2[0m[39m bytes, unknown, mostly [0m[1;39m[[0m[1;36m02[0m[39m [0m[1;36m00[0m[1;39m][0m                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    private short flags1 = [0m[1;36m2[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[35m/[0m[35m/[0m[39m ASCIIZ, stored in this field without the terminating zero[0m                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    private String label;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[35m/[0m[35m/[0m[39m ASCIIZ, stored in this field without the terminating zero[0m                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    private String fileName;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;36m2[0m[39m bytes, unknown, mostly [0m[1;39m[[0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m][0m                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private short flags2;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[35m/[0m[35m/[0m[39m see below[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private short unknown1 = [0m[1;36m3[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[35m/[0m[35m/[0m[39m ASCIIZ, stored in this field without the terminating zero[0m                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private String command;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    [0m[35m/[0m[35m/[0m[39m varying size, the actual native data[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m dataBuffer;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[35m/[0m[35m/[0m[39m UTF16-LE String with leading length[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    private String command2;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    [0m[35m/[0m[35m/[0m[39m UTF16-LE String with leading length[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    private String label2;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[35m/[0m[35m/[0m[39m UTF16-LE String with leading length[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    private String fileName2;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/POIFSDocumentPath.jav[0m[1;92ma:32[0m[39m-[0m[1;36m86[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:public class POIFSDocumentPath [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private final String[0m[1;39m[[0m[1;39m][0m[39m components;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    private int hashcode; [0m[35m/[0m[35m/[0m[95mlazy-compute[0m[39m hashCode[0m                                [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * simple constructor for the path of a document that is in the root of the [0m [2m                [0m
[2;36m                    [0m         [39mPOIFSFileSystem.[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * The constructor that takes an array of Strings can also be used to create[0m [2m                [0m
[2;36m                    [0m         [39msuch a[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     * POIFSDocumentPath by passing it a null or empty String array[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    public [0m[1;35mPOIFSDocumentPath[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        components = new String[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * constructor for the path of a document that is not in the root of the [0m    [2m                [0m
[2;36m                    [0m         [39mPOIFSFileSystem[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @param components the Strings making up the path to a document.[0m           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *      The Strings must be ordered as they appear in the directory [0m         [2m                [0m
[2;36m                    [0m         [39mhierarchy of the document.[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *      The first string must be the name of a directory in the root of the [0m [2m                [0m
[2;36m                    [0m         [39mPOIFSFileSystem, and[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     *      every Nth [0m[1;39m([0m[39mfor N &gt; [0m[1;36m1[0m[1;39m)[0m[39m string thereafter must be the name of a [0m    [2m                [0m
[2;36m                    [0m         [39mdirectory in the directory[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     *      identified by the [0m[1;39m([0m[39mN-[0m[1;36m1[0m[1;39m)[0m[39mth string.<p>[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     *      If the components parameter is null or has zero length, the [0m         [2m                [0m
[2;36m                    [0m         [39mPOIFSDocumentPath is appropriate[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *      for a document that is in the root of a POIFSFileSystem[0m              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * @throws IllegalArgumentException[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     *      if any of the elements in the components parameter are null or have [0m [2m                [0m
[2;36m                    [0m         [39mzero length[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    public [0m[1;35mPOIFSDocumentPath[0m[1;39m([0m[39mfinal String [0m[1;39m[[0m[1;39m][0m[39m components[0m[1;39m)[0m[39m throws [0m                 [2m                [0m
[2;36m                    [0m         [39mIllegalArgumentException [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnull, components[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * constructor that adds additional subdirectories to an existing path[0m       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * @param path the existing path[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * @param components the additional subdirectory names to be added[0m           [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * @throws IllegalArgumentException[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     *      if any of the Strings in components is null or zero length[0m           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    public [0m[1;35mPOIFSDocumentPath[0m[1;39m([0m[39mfinal POIFSDocumentPath path, final String[0m[1;39m[[0m[1;39m][0m[39m [0m       [2m                [0m
[2;36m                    [0m         [39mcomponents[0m[1;39m)[0m[39m throws IllegalArgumentException [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m s1 = [0m[1;39m([0m[39mpath == null[0m[1;39m)[0m[39m ? new String[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m : path.components;[0m          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m s2 = [0m[1;39m([0m[39mcomponents == null[0m[1;39m)[0m[39m ? new String[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m : components;[0m         [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[35m/[0m[35m/[0m[39m TODO: Although the Javadoc says empty strings are forbidden, the [0m     [2m                [0m
[2;36m                    [0m         [39madapted legacy[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        [0m[35m/[0m[35m/[0m[39m  implementation allowed it in case a path was specified[0m[33m...[0m            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        Predicate<String> p = [0m[1;39m([0m[39mpath != null[0m[1;39m)[0m[39m ? Objects::isNull : [0m[1;39m([0m[39ms[0m[1;39m)[0m[39m -> [0m[1;39m([0m[39ms == [0m   [2m                [0m
[2;36m                    [0m         [39mnull || [0m[1;35ms.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        if [0m[1;39m([0m[1;35mStream.of[0m[1;39m([0m[39ms2[0m[1;39m)[0m[1;35m.anyMatch[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"components cannot contain null [0m  [2m                [0m
[2;36m                    [0m         [32mor empty strings"[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        this.components = [0m                                                       [2m                [0m
[2;36m                    [0m         [1;35mStream.concat[0m[1;39m([0m[1;35mStream.of[0m[1;39m([0m[39ms1[0m[1;39m)[0m[39m,[0m[1;35mStream.of[0m[1;39m([0m[39ms2[0m[1;39m)[0m[1;39m)[0m[1;35m.toArray[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m::new[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/POIFSDocumentPath.jav[0m[1;92ma:160[0m[39m-[0m[1;36m171[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:     * <p>Returns a string representation of the path. Components are[0m           [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:     * separated by the platform-specific file separator [0m[1;39m{[0m[39m@link [0m                [2m                [0m
[2;36m                    [0m         [39mFile#separatorChar[0m[1;39m}[0m[39m<[0m[35m/[0m[95mp[0m[39m>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:     * @return string representation[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:     * @since [0m[1;36m2002[0m[39m-[0m[1;36m01[0m[39m-[0m[1;36m24[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    public String [0m[1;35mtoString[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        return File.separatorChar + [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mString.join[0m[1;39m([0m[1;35mString.valueOf[0m[1;39m([0m[39mFile.separatorChar[0m[1;39m)[0m[39m, components[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:68[0m[39m-[0m[1;36m80[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                 POIFSFileSystem fs = new [0m[1;35mPOIFSFileSystem[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                DirectoryEntry root = [0m[1;35mfs.getRoot[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                String filenameWithoutPath = new [0m[1;35mFile[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                File dumpDir =[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                        [0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                                [0m[1;35m.resolve[0m[1;39m([0m[39mfilenameWithoutPath + [0m                  [2m                [0m
[2;36m                    [0m         [32m"_dump"[0m[1;39m)[0m[1;35m.toFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + file[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mroot, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:99[0m[39m-[0m[1;36m122[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mentry instanceof DocumentNode[0m[1;39m)[0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                final DocumentNode node = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                final byte[0m[1;39m[[0m[1;39m][0m[39m bytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                   bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mdir, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Skipping unsupported POIFS entry: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mentry[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/test/java/org/apache/poi/POIDataSamples.jav[0m[1;92ma:172[0m[39m-[0m[1;36m224[0m                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35msampleFileName.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:               String fn = sampleFileName;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:               [0m[1;35mif[0m[1;39m([0m[1;35mfn.indexOf[0m[1;39m([0m[32m'/'[0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                  fn = [0m[1;35mfn.substring[0m[1;39m([0m[1;35mfn.indexOf[0m[1;39m([0m[32m'/'[0m[1;39m)[0m[39m+[0m[1;36m1[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:               [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfn.equals[0m[1;39m([0m[1;35mf.getCanonicalFile[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:                   throw new [0m[1;35mIllegalStateException[0m[1;39m([0m[32m"File name is [0m               [2m                [0m
[2;36m                    [0m         [32mcase-sensitive: requested '"[0m[39m + fn[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:                        + [0m[32m"' but actual file is '"[0m[39m + [0m                           [2m                [0m
[2;36m                    [0m         [1;35mf.getCanonicalFile[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"'"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:            throw new [0m[1;35mIllegalStateException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        return f;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    private void [0m[1;35minitialise[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        String dataDirName = [0m[1;35mSystem.getProperty[0m[1;39m([0m[39mTEST_PROPERTY[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        if [0m[1;39m([0m[39mdataDirName == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[35m/[0m[35m/[0m[39m check to see if we can just get the resources from the classpath[0m [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            InputStream is = [0m[1;35mopenClasspathResource[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            if [0m[1;39m([0m[39mis != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                try [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                    [0m[1;35mis.close[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m be nice[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                    throw new [0m[1;35mRuntimeException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:                _sampleDataIsAvaliableOnClassPath = true;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                return;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            if [0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[32m"test-data"[0m[1;39m)[0m[1;35m.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                dataDirName = [0m[32m"test-data"[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[32m"../test-data"[0m[1;39m)[0m[1;35m.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:               dataDirName = [0m[32m"../test-data"[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:               throw new [0m[1;35mRuntimeException[0m[1;39m([0m[32m"Must set system property '"[0m[39m +[0m        [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                       TEST_PROPERTY + [0m[32m"' before running tests"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:        File dataDir = new [0m[1;35mFile[0m[1;39m([0m[39mdataDirName, _moduleDir[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mdataDir.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            throw new [0m[1;35mRuntimeException[0m[1;39m([0m[32m"Data dir '"[0m[39m + dataDir + [0m[32m"' does not [0m    [2m                [0m
[2;36m                    [0m         [32mexist"[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        [0m[35m/[0m[35m/[0m[39m convert to canonical file, to make any subsequent error messages[0m     [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        [0m[35m/[0m[35m/[0m[39m clearer.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            _resolvedDataDir = [0m[1;35mdataDir.getCanonicalFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:            throw new [0m[1;35mRuntimeException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/xdgf/util/Util.jav[0m[1;92ma:30[0m[39m-[0m[1;36m37[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[35m/[0m[39m this probably isn't [0m[1;36m100[0m[39m% correct, so don't use it in security-sensitive[0m   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[35m/[0m[35m/[0m[39m applications![0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[35m/[0m[39m from: [0m[4;94mhttp://www.rgagnon.com/javadetails/java-0662.html[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static String [0m[1;35msanitizeFilename[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/EntryUtils.jav[0m[1;92ma:37[0m[39m-[0m[1;36m58[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * Copies an Entry into a target POIFS directory, recursively[0m                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Internal[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public static void [0m[1;35mcopyNodeRecursively[0m[1;39m([0m[39m Entry entry, DirectoryEntry target [0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    throws IOException [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        if [0m[1;39m([0m[39m [0m[1;35mentry.isDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            DirectoryEntry dirEntry = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:            DirectoryEntry newTarget = [0m[1;35mtarget.createDirectory[0m[1;39m([0m[39m [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:            [0m[1;35mnewTarget.setStorageClsid[0m[1;39m([0m[39m [0m[1;35mdirEntry.getStorageClsid[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:            Iterator<Entry> entries = [0m[1;35mdirEntry.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            while [0m[1;39m([0m[39m [0m[1;35mentries.hasNext[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                [0m[1;35mcopyNodeRecursively[0m[1;39m([0m[39m [0m[1;35mentries.next[0m[1;39m([0m[1;39m)[0m[39m, newTarget [0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            DocumentEntry dentry = [0m[1;39m([0m[39mDocumentEntry[0m[1;39m)[0m[39m entry;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            DocumentInputStream dstream = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39m dentry [0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            [0m[1;35mtarget.createDocument[0m[1;39m([0m[39m [0m[1;35mdentry.getName[0m[1;39m([0m[1;39m)[0m[39m, dstream [0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:            [0m[1;35mdstream.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:123[0m[39m-[0m[1;36m138[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mPOIFSFileSystem fs, int startBlock, String name, [0m   [2m                [0m
[2;36m                    [0m         [39mFile parent[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, name[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            POIFSStream stream = new [0m[1;35mPOIFSStream[0m[1;39m([0m[39mfs, startBlock[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m b = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[1;35mfs.getBigBlockSize[0m[1;39m([0m[1;39m)[0m[39m, [0m            [2m                [0m
[2;36m                    [0m         [1;35mPOIFSFileSystem.getMaxRecordLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            for [0m[1;39m([0m[39mByteBuffer bb : stream[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                int len = [0m[1;35mbb.remaining[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                [0m[1;35mbb.get[0m[1;39m([0m[39mb[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                [0m[1;35mout.write[0m[1;39m([0m[39mb, [0m[1;36m0[0m[39m, len[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:68[0m[39m-[0m[1;36m80[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                 POIFSFileSystem fs = new [0m[1;35mPOIFSFileSystem[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                DirectoryEntry root = [0m[1;35mfs.getRoot[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                String filenameWithoutPath = new [0m[1;35mFile[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                File dumpDir =[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                        [0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                                [0m[1;35m.resolve[0m[1;39m([0m[39mfilenameWithoutPath + [0m                  [2m                [0m
[2;36m                    [0m         [32m"_dump"[0m[1;39m)[0m[1;35m.toFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + file[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mroot, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:99[0m[39m-[0m[1;36m122[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mentry instanceof DocumentNode[0m[1;39m)[0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                final DocumentNode node = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                final byte[0m[1;39m[[0m[1;39m][0m[39m bytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                   bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mdir, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Skipping unsupported POIFS entry: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mentry[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:123[0m[39m-[0m[1;36m138[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mPOIFSFileSystem fs, int startBlock, String name, [0m   [2m                [0m
[2;36m                    [0m         [39mFile parent[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, name[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            POIFSStream stream = new [0m[1;35mPOIFSStream[0m[1;39m([0m[39mfs, startBlock[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m b = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[1;35mfs.getBigBlockSize[0m[1;39m([0m[1;39m)[0m[39m, [0m            [2m                [0m
[2;36m                    [0m         [1;35mPOIFSFileSystem.getMaxRecordLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            for [0m[1;39m([0m[39mByteBuffer bb : stream[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                int len = [0m[1;35mbb.remaining[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                [0m[1;35mbb.get[0m[1;39m([0m[39mb[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                [0m[1;35mout.write[0m[1;39m([0m[39mb, [0m[1;36m0[0m[39m, len[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the evaluation report and code snippets, I can identify:[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Root Cause**: The `[0m[1;35mPOIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m` method at lines [0m[1;36m108[0m[39m and [0m[1;36m113[0m[39m directly uses[0m [2m                [0m
[2;36m                    [0m         [39munsanitized entry names from POIFS files to construct file system paths via `new [0m   [2m                [0m
[2;36m                    [0m         [1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m`. This allows path traversal attacks using sequences [0m [2m                [0m
[2;36m                    [0m         [39mlike [0m[32m"../../../../jazzer-traversal"[0m[39m.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Critical Vulnerable Code**:[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m108[0m[39m: `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m` for document files[0m         [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m113[0m[39m: `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m` for directories[0m                  [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m124[0m[39m: `new [0m[1;35mFile[0m[1;39m([0m[39mparent, name[0m[1;39m)[0m[39m` in the secondary dump method[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Key Insights from Code Analysis**:[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - POIFS entry names are stored raw without validation [0m[1;39m([0m[1;35mProperty.getName[0m[1;39m([0m[1;39m)[0m[39m [0m       [2m                [0m
[2;36m                    [0m         [39mreturns unvalidated strings[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - The codebase uses `[0m[1;35mgetCanonicalFile[0m[1;39m([0m[1;39m)[0m[39m` in POIDataSamples for safe path [0m        [2m                [0m
[2;36m                    [0m         [39mresolution[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - ZipSecureFile documentation explicitly states users must validate paths[0m        [2m                [0m
[2;36m                    [0m         [39m   - EntryUtils safely uses entry names because it operates within POIFS [0m           [2m                [0m
[2;36m                    [0m         [39mstructures, not the file system[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - The existing [0m[1;35mUtil.sanitizeFilename[0m[1;39m([0m[1;39m)[0m[39m is insufficient [0m[1;39m([0m[39mdoesn't handle [0m[32m".."[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39msequences and is marked as not security-safe[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Critical Logic to Preserve**:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - The recursive directory traversal functionality[0m                                [2m                [0m
[2;36m                    [0m         [39m   - The ability to dump both documents and directories[0m                             [2m                [0m
[2;36m                    [0m         [39m   - The file structure mirroring from POIFS to file system[0m                         [2m                [0m
[2;36m                    [0m         [39m   - The [0m[1;35mtrim[0m[1;39m([0m[1;39m)[0m[39m operation on document names [0m[1;39m([0m[39mline [0m[1;36m108[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Approach: Canonical Path Validation[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mImplement path traversal protection using canonical path validation at the file [0m    [2m                [0m
[2;36m                    [0m         [39msystem boundary. This is the most robust approach because:[0m                          [2m                [0m
[2;36m                    [0m         [39m- It handles all OS-specific path resolution [0m[1;39m([0m[39msymlinks, [0m[32m".."[0m[39m, [0m[32m"."[0m[39m, path separators[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m- It's harder to bypass than string replacement[0m                                     [2m                [0m
[2;36m                    [0m         [39m- It's used elsewhere in the POI codebase [0m[1;39m([0m[39mPOIDataSamples[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Implementation Steps[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Add a Path Validation Helper Method** in `POIFSDump` class:[0m                    [2m                [0m
[2;36m                    [0m         [39m   - Create a `[0m[1;35mvalidateAndCreateFile[0m[1;39m([0m[39mFile parent, String childName[0m[1;39m)[0m[39m` method[0m         [2m                [0m
[2;36m                    [0m         [39m   - This method should:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     a. Sanitize the child name to remove/replace path separators and [0m[32m".."[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39msequences as a first line of defense[0m                                                [2m                [0m
[2;36m                    [0m         [39m     b. Create a File object with the sanitized name[0m                                [2m                [0m
[2;36m                    [0m         [39m     c. Resolve both the parent and target file to canonical paths[0m                  [2m                [0m
[2;36m                    [0m         [39m     d. Verify the canonical target path starts with the canonical parent path[0m      [2m                [0m
[2;36m                    [0m         [39m     e. Throw IOException with descriptive message if validation fails[0m              [2m                [0m
[2;36m                    [0m         [39m     f. Return the validated File object if successful[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Modify the main [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry, File[0m[1;39m)[0m[39m method** [0m[1;39m([0m[39mlines [0m[1;36m99[0m[39m-[0m[1;36m122[0m[1;39m)[0m[39m:[0m            [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m108[0m[39m: Replace `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m` with call to the [0m  [2m                [0m
[2;36m                    [0m         [39mvalidation helper[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m113[0m[39m: Replace `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m` with call to the [0m        [2m                [0m
[2;36m                    [0m         [39mvalidation helper[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - Preserve the existing logic flow [0m[1;39m([0m[39mrecursive traversal, file writing, directory[0m [2m                [0m
[2;36m                    [0m         [39mcreation[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - Preserve the [0m[1;35mtrim[0m[1;39m([0m[1;39m)[0m[39m operation for document names by applying it before [0m        [2m                [0m
[2;36m                    [0m         [39mvalidation[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Modify the secondary [0m[1;35mdump[0m[1;39m([0m[39mPOIFSFileSystem, int, String, File[0m[1;39m)[0m[39m method** [0m[1;39m([0m[39mlines [0m [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m-[0m[1;36m138[0m[1;39m)[0m[39m:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m124[0m[39m: Replace `new [0m[1;35mFile[0m[1;39m([0m[39mparent, name[0m[1;39m)[0m[39m` with call to the validation helper[0m  [2m                [0m
[2;36m                    [0m         [39m   - While this method currently uses hardcoded safe names, future-proof it against[0m [2m                [0m
[2;36m                    [0m         [39mpotential vulnerabilities[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Modify the [0m[1;35mmain[0m[1;39m([0m[1;39m)[0m[39m method** [0m[1;39m([0m[39mlines [0m[1;36m68[0m[39m-[0m[1;36m80[0m[1;39m)[0m[39m:[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m75[0m[39m: Ensure the base dump directory is resolved to canonical form before [0m  [2m                [0m
[2;36m                    [0m         [39mcalling [0m[1;35mdump[0m[1;39m([0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - This establishes a trusted base directory for all subsequent validation[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Detailed Validation Logic[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe validation helper should implement this logic:[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;35mvalidateAndCreateFile[0m[1;39m([0m[39mFile parent, String childName[0m[1;39m)[0m[39m:[0m                               [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. Sanitize childName:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     - Replace all occurrences of [0m[32m".."[0m[39m with [0m[32m"_"[0m                                     [2m                [0m
[2;36m                    [0m         [39m     - Replace all path separators [0m[1;39m([0m[35m/[0m[39m, \[0m[1;39m)[0m[39m with [0m[32m"_"[0m                                  [2m                [0m
[2;36m                    [0m         [39m     - This prevents obvious path traversal attempts[0m                                [2m                [0m
[2;36m                    [0m         [39m  [0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. Create File object:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     - File candidate = new [0m[1;35mFile[0m[1;39m([0m[39mparent, sanitizedName[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m  [0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. Resolve canonical paths:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m     - String parentCanonical = [0m[1;35mparent.getCanonicalPath[0m[1;39m([0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [39m     - String candidateCanonical = [0m[1;35mcandidate.getCanonicalPath[0m[1;39m([0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [39m  [0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. Validate path boundary:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m     - Ensure candidateCanonical starts with parentCanonical + File.separator[0m       [2m                [0m
[2;36m                    [0m         [39m     - This prevents traversal outside parent directory[0m                             [2m                [0m
[2;36m                    [0m         [39m  [0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m5[0m[39m. If validation fails:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m     - Throw IOException with message including original entry name[0m                 [2m                [0m
[2;36m                    [0m         [39m     - Log the attempted traversal for security monitoring[0m                          [2m                [0m
[2;36m                    [0m         [39m  [0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m6[0m[39m. Return validated File object[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Justification[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why This is Optimal**:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- **Defense in Depth**: Combines sanitization [0m[1;39m([0m[39mstring replacement[0m[1;39m)[0m[39m with validation [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mcanonical path checking[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- **OS-Agnostic**: Works across Windows, Linux, macOS with different path [0m          [2m                [0m
[2;36m                    [0m         [39mseparators and conventions[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- **Minimal Code Changes**: Localizes fix to POIFSDump without modifying core POIFS[0m [2m                [0m
[2;36m                    [0m         [39mclasses[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Preserves Functionality**: Maintains existing dump behavior for legitimate [0m     [2m                [0m
[2;36m                    [0m         [39mfiles[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- **No Breaking Changes**: Doesn't alter POIFS core APIs or data structures[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Preserves Existing Logic**:[0m                                                [2m                [0m
[2;36m                    [0m         [39m- The recursive directory traversal remains unchanged[0m                               [2m                [0m
[2;36m                    [0m         [39m- File and directory creation logic is preserved[0m                                    [2m                [0m
[2;36m                    [0m         [39m- Only adds validation before path construction[0m                                     [2m                [0m
[2;36m                    [0m         [39m- Legitimate file names pass through unchanged[0m                                      [2m                [0m
[2;36m                    [0m         [39m- The [0m[1;35mtrim[0m[1;39m([0m[1;39m)[0m[39m operation on document names is preserved[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Addresses the Vulnerability**:[0m                                             [2m                [0m
[2;36m                    [0m         [39m- Blocks path traversal sequences like [0m[32m"../../../../file"[0m                           [2m                [0m
[2;36m                    [0m         [39m- Prevents writing outside the intended dump directory[0m                              [2m                [0m
[2;36m                    [0m         [39m- Detects attempts after OS-specific path resolution[0m                                [2m                [0m
[2;36m                    [0m         [39m- Provides clear error messages for debugging[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects and Mitigation**:[0m                                          [2m                [0m
[2;36m                    [0m         [39m- **Effect**: POIFS files with legitimately named entries containing [0m[32m".."[0m[39m or path [0m  [2m                [0m
[2;36m                    [0m         [39mseparators will have sanitized names[0m                                                [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: This is acceptable as these characters are problematic for file [0m  [2m                [0m
[2;36m                    [0m         [39msystems anyway[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- **Effect**: POIFSDump will reject maliciously crafted POIFS files[0m                 [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: This is the desired behavior - fail securely rather than create [0m  [2m                [0m
[2;36m                    [0m         [39mfiles in unexpected locations[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- **Effect**: Error messages will expose attempted path traversal[0m                   [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: This aids security monitoring and incident response[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Similar Solutions in Codebase**:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m- POIDataSamples uses [0m[1;35mgetCanonicalFile[0m[1;39m([0m[1;39m)[0m[39m for path resolution [0m[1;39m([0m[39mlines [0m[1;36m177[0m[39m, [0m[1;36m219[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m- ZipSecureFile documentation acknowledges users must validate paths[0m                [2m                [0m
[2;36m                    [0m         [39m- This follows the established pattern of validation at trust boundaries[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Files to Modify[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mOnly `poi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.java` needs [0m             [2m                [0m
[2;36m                    [0m         [39mmodification:[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- Add the validation helper method[0m                                                  [2m                [0m
[2;36m                    [0m         [39m- Update three call sites [0m[1;39m([0m[39mlines [0m[1;36m75[0m[39m, [0m[1;36m108[0m[39m, [0m[1;36m113[0m[39m, [0m[1;36m124[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [39m- Add proper exception handling and error messages[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mNo changes needed to:[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Core POIFS classes [0m[1;39m([0m[39mEntry, Property, DirectoryEntry[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m- Other utilities [0m[1;39m([0m[39mEntryUtils, POIFSLister[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [39m- Test harness code[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- External dependencies[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=845166;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=564129;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=158928;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=716590;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp2uswvvlf[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768146775.988378[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-poi_poi-full-01_vuln_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/11/26 15:52:58][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mapache-poi[0m     ]8;id=662231;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=259358;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=101757;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=879485;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-poi[0m            [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=80311;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=308699;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-poi[0m             [2m               [0m
