[2;36m[01/12/26 01:12:49][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=795025;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=462644;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpxcthxwkp[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_5/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768180369.154888[0m                                                       [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-full-01_vuln_5.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=580343;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=597422;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:14:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Took      ]8;id=313166;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=866049;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m77.80[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=435621;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=230103;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=669699;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=672584;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=223636;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=52622;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m77[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=81137;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=545550;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:14:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.90[0m seconds;                ]8;id=333696;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=393232;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 01:14:08][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=466653;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=359822;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=869048;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=318585;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=191741;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=500592;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=890657;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=402888;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:14:09][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m1.06[0m seconds;                ]8;id=394461;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=201505;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 01:14:10][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=753451;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=844243;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:14:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.83[0m seconds;                ]8;id=110099;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=281181;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 01:14:17][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=741772;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=876938;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of  [2m                [0m
[2;36m                    [0m         memory [1m([0muse [32m'-Xmx1710m'[0m to reproduce[1m)[0m                                               [2m                [0m
[2;36m                    [0m         Caused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1m([0mType1Lexer.jav[1;92ma:507[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Lexer.readToken[0m[1m([0mType1Lexer.jav[1;92ma:232[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Lexer.nextToken[0m[1m([0mType1Lexer.jav[1;92ma:75[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Parser.read[0m[1m([0mType1Parser.jav[1;92ma:877[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Parser.parseASCII[0m[1m([0mType1Parser.jav[1;92ma:109[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Parser.parse[0m[1m([0mType1Parser.jav[1;92ma:63[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1m([0mType1Font.jav[1;92ma:71[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at org.apache.pdfbox.pdmodel.font.PDType1Font.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cbc000.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbd000.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbc800.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 0d88e419df5aef8d[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:507[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:232[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.nextToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:75[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.read[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:877[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parseASCII[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:109[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parse[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:63[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:71[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init[0m[1m>[0m[1m([0mPDType1Font.jav[1;92ma:227[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1m([0mPDFontFactory.jav[1;92ma:140[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1m([0mPDResources.jav[1;92ma:170[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1m([0mSetFontAndSize [2m                [0m
[2;36m                    [0m         .jav[1;92ma:72[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1m([0mPDFStreamEngine.jav [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1m)[0m                                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1m([0mPDFStreamEng [2m                [0m
[2;36m                    [0m         ine.jav[1;92ma:557[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1m([0mPDFStreamEngine.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1m([0mPDFStreamEngine.jav[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1m)[0m                                                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1m([0mLegacyPDFStreamEngine.jav[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1m)[0m                                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1m([0mPDFTextStripper.jav[1;92ma:378[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1m([0mPDFTextStripper.jav[1;92ma:303[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1m([0mPDFTextStripper.jav[1;92ma:251[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1m([0mPDFTextStripper.jav[1;92ma:218[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1m([0mPDFExtractTextFuzzer.jav[1;92ma:41[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$DMH/[1;35m0x0000000800cbc000.invokeStaticInit[0m[1m([0mLambd [2m                [0m
[2;36m                    [0m         aForm$DMH[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800cbd000.invoke[0m[1m([0mLambdaForm$MH[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800cbc800.invoke_MT[0m[1m([0mLambdaForm$MH [2m                [0m
[2;36m                    [0m         [1m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 0d88e419df5aef8d                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/12/26 01:14:41][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=481835;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=565209;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/12/26 01:20:02][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=830708;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=59797;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/12/26 01:20:38][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=581638;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=210015;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=272050;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=770067;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:20:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.94[0m seconds;                ]8;id=303279;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=714057;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 01:20:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Started[33m...[0m                              ]8;id=603865;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=165866;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp4kexisya[0m                                                 ]8;id=968258;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=530528;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/12/26 01:21:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Took [1;36m60.18[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=248889;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=179538;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Started[33m...[0m                        ]8;id=631785;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=992096;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:21:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Took [1;36m14.55[0m seconds;              ]8;id=770057;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=145623;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Started[33m...[0m                           ]8;id=533431;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=905247;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:22:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Took [1;36m6.10[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=6772;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=129130;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Started[33m...[0m                               ]8;id=464758;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=312858;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=820052;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=414405;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=261693;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=829066;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:22:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.88[0m seconds;                ]8;id=144338;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=290029;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 01:22:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=115925;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=843768;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:22:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.94[0m seconds;                ]8;id=215007;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=633107;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=176702;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=116142;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:22:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.89[0m seconds;                ]8;id=932448;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=165760;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 01:22:05][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=439416;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=750477;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java                [2m                [0m
[2;36m                    [0m         +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java                [2m                [0m
[2;36m                    [0m         @@ [1;36m-501[0m,[1;36m6[0m +[1;36m501[0m,[1;36m27[0m @@                                                                [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m              private Token [1;35mreadCharString[0m[1m([0mint length[1m)[0m throws IOException                    [2m                [0m
[2;36m                    [0m              [1m{[0m                                                                              [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Validate length to prevent OutOfMemoryError from malicious font data    [2m                [0m
[2;36m                    [0m         +        if [1m([0mlength [1m<[0m[39m [0m[1;36m0[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Invalid CharString length: "[0m[39m + [0m        [2m                [0m
[2;36m                    [0m         [39mlength[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Check if buffer has sufficient data [0m[1;39m([0m[1;36m1[0m[39m byte for space + length bytes [0m   [2m                [0m
[2;36m                    [0m         [39mfor data[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35mbuffer.remaining[0m[1;39m([0m[1;39m)[0m[39m < length + [0m[1;36m1[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"CharString length "[0m[39m + length + [0m        [2m                [0m
[2;36m                    [0m         [39m+                [0m[32m" exceeds available buffer data "[0m[39m + [0m[1;35mbuffer.remaining[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Enforce reasonable maximum size for CharString data[0m                     [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m CharStrings represent glyph outlines and should be relatively small[0m     [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39mlength > [0m[1;36m65535[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"CharString length "[0m[39m + length + [0m        [2m                [0m
[2;36m                    [0m         [39m+                [0m[32m" exceeds maximum allowed size 65535"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m         try[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:507[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:232[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.nextToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:75[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.read[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:877[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parseASCII[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:109[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parse[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:63[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:71[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cbc000.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbd000.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbc800.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 0d88e419df5aef8d[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA FuzzerSecurityIssueLow exception was triggered due to an OutOfMemoryError in the [0m [2m                [0m
[2;36m                    [0m         [39mApache FontBox Type1Lexer component. The error occurs when attempting to read a [0m    [2m                [0m
[2;36m                    [0m         [39mcharacter string, specifically when requesting an array size that exceeds the Java [0m [2m                [0m
[2;36m                    [0m         [39mVM limit. This issue was discovered during fuzzing of PDF text extraction [0m          [2m                [0m
[2;36m                    [0m         [39mfunctionality using a PDFExtractTextFuzzer harness.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Overview[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mThe issue manifests as a `java.lang.OutOfMemoryError` with the specific message [0m    [2m                [0m
[2;36m                    [0m         [32m"Requested array size exceeds VM limit"[0m[39m. This error is wrapped in a [0m                [2m                [0m
[2;36m                    [0m         [39m`com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow` exception, indicating it [0m [2m                [0m
[2;36m                    [0m         [39mwas detected during fuzz testing and classified as a low-severity security issue.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis represents a resource exhaustion vulnerability, specifically an unbounded [0m     [2m                [0m
[2;36m                    [0m         [39mmemory allocation issue. The error occurs when the code attempts to allocate an [0m    [2m                [0m
[2;36m                    [0m         [39marray larger than the maximum size permitted by the Java Virtual Machine, [0m          [2m                [0m
[2;36m                    [0m         [39msuggesting that input data can influence memory allocation decisions without proper[0m [2m                [0m
[2;36m                    [0m         [39mvalidation or bounds checking.[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Stack Trace Analysis[0m                                                            [2m                [0m
[2;36m                    [0m         [39mThe error originates deep within the font parsing subsystem:[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Origin Point**: [0m                                                               [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:507[0m[1;39m)[0m[39m` - This is[0m [2m                [0m
[2;36m                    [0m         [39mwhere the excessive array allocation is attempted[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Parsing Chain**: The error propagates through the Type1 font parsing pipeline:[0m [2m                [0m
[2;36m                    [0m         [39m   - `Type1Lexer.readToken` [0m[1;39m([0m[39mline [0m[1;36m232[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - `Type1Lexer.nextToken` [0m[1;39m([0m[39mline [0m[1;36m75[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39m   - `Type1Parser.read` [0m[1;39m([0m[39mline [0m[1;36m877[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - `Type1Parser.parseASCII` [0m[1;39m([0m[39mline [0m[1;36m109[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - `Type1Parser.parse` [0m[1;39m([0m[39mline [0m[1;36m63[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Font Loading**: `Type1Font.createWithPFB` [0m[1;39m([0m[39mline [0m[1;36m71[0m[1;39m)[0m[39m and `PDType1Font.<init>` [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m227[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **PDF Processing**: The font is being loaded as part of PDF content stream [0m      [2m                [0m
[2;36m                    [0m         [39mprocessing through `SetFontAndSize.process` [0m[1;39m([0m[39mline [0m[1;36m72[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Entry Point**: The fuzzer harness `PDFExtractTextFuzzer.fuzzerTestOneInput` [0m   [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m41[0m[1;39m)[0m[39m triggers text extraction from a malformed PDF[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Investigation[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo understand the full scope of this issue, the following components should be [0m     [2m                [0m
[2;36m                    [0m         [39mexamined:[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Type1Lexer.readCharString [0m[1;39m([0m[39mPrimary Focus[0m[1;39m)[0m[39m**:[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m507[0m[39m where the array allocation occurs[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - How character string length is determined from input data[0m                      [2m                [0m
[2;36m                    [0m         [39m   - Whether size validation exists before allocation[0m                               [2m                [0m
[2;36m                    [0m         [39m   - The relationship between input bytes and requested array size[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Type1Lexer Token Reading**:[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - Methods `readToken` and `nextToken` to understand the parsing flow[0m             [2m                [0m
[2;36m                    [0m         [39m   - How token boundaries and sizes are determined[0m                                  [2m                [0m
[2;36m                    [0m         [39m   - Input validation at the lexer level[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Type1Parser**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - The `read`, `parseASCII`, and `parse` methods to understand the parsing [0m       [2m                [0m
[2;36m                    [0m         [39mcontext[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - How the parser handles malformed or malicious font data[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Existing safeguards against oversized data structures[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Type1Font.createWithPFB**:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - Font creation workflow and resource allocation patterns[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Error handling and resource limits during font instantiation[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **PDFBox Font Factory and Resource Management**:[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - `PDFontFactory.createFont` and how it handles different font types[0m             [2m                [0m
[2;36m                    [0m         [39m   - Resource cleanup and memory management practices[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Validation of embedded fonts in PDF documents[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Input Data Characteristics**:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - The specific fuzzer input that triggered this issue [0m[1;39m([0m[39mavailable via [0m            [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 0d88e419df5aef8d[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - Patterns in the malformed Type1 font data that cause excessive allocation[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis issue represents a potential denial-of-service vector where specially crafted [0m [2m                [0m
[2;36m                    [0m         [39mPDF files containing malicious Type1 font data could cause applications to crash [0m   [2m                [0m
[2;36m                    [0m         [39mdue to memory exhaustion, even when the requested array size exceeds VM limits and [0m [2m                [0m
[2;36m                    [0m         [39mcannot actually be allocated.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readCharString[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:507[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.readToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:232[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Lexer.nextToken[0m[1;39m([0m[39mType1Lexer.jav[0m[1;92ma:75[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.read[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:877[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parseASCII[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:109[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Parser.parse[0m[1;39m([0m[39mType1Parser.jav[0m[1;92ma:63[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:71[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cbc000.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbd000.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbc800.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 0d88e419df5aef8d[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:500[0m[39m-[0m[1;36m516[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:     * Reads a binary CharString.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:1[0m[39m-[0m[1;36m50[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.fontbox.type1;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.BufferUnderflowException;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: * Lexer for the ASCII portions of an Adobe Type [0m[1;36m1[0m[39m font.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * @see Type1Parser[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * The PostScript language, of which Type [0m[1;36m1[0m[39m fonts are a subset, has a[0m            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: * somewhat awkward lexical structure. It is neither regular nor[0m                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * context-free, and the execution of the program can modify the[0m                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * the behaviour of the lexer/parser.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: * Nevertheless, this class represents an attempt to artificially separate[0m       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m: * the PostScript parsing process into separate lexing and parsing phases[0m        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m: * in order to reduce the complexity of the parsing phase.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: * @see [0m[32m"PostScript Language Reference 3rd ed, Adobe Systems [0m[32m([0m[32m1999[0m[32m)[0m[32m"[0m             [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m: * @author John Hewson[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;92m45:c[0m[39mlass Type1Lexer[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * Log instance.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mType1Lexer.class[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:60[0m[39m-[0m[1;36m90[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;35mType1Lexer[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        buffer = [0m[1;35mByteBuffer.wrap[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Returns the next token and consumes it.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * @return The next token.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    public Token [0m[1;35mnextToken[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        Token curToken = aheadToken;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[35m/[0m[35m/[0m[95mSystem.out.println[0m[1;39m([0m[39mcurToken[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m for debugging[0m                         [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mcurToken[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        return curToken;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * Returns the next token without consuming it.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     * @return The next token[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    public Token [0m[1;35mpeekToken[0m[1;39m([0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        return aheadToken;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * Checks if the kind of the next token equals the given one without [0m        [2m                [0m
[2;36m                    [0m         [39mconsuming it.[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:220[0m[39m-[0m[1;36m250[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                            [0m[35m/[0m[35m/[0m[39m the stream is corrupt[0m                            [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Could not read [0m     [2m                [0m
[2;36m                    [0m         [32mtoken at position "[0m[39m +[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                                                           [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"RD"[0m[1;39m)[0m[39m || [0m[1;35mname.equals[0m[1;39m([0m[32m"-|"[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                            [0m[35m/[0m[35m/[0m[39m return the next CharString instead[0m               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            if [0m[1;39m([0m[39mprevToken != null && [0m[1;35mprevToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == [0m    [2m                [0m
[2;36m                    [0m         [39mToken.INTEGER[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                                return [0m[1;35mreadCharString[0m[1;39m([0m[1;35mprevToken.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            else[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"expected INTEGER before [0m [2m                [0m
[2;36m                    [0m         [32m-| or RD"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                        else[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                            return new [0m[1;35mToken[0m[1;39m([0m[39mname, Token.NAME[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        while [0m[1;39m([0m[39mskip[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:51[0m[39m-[0m[1;36m65[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private final ByteBuffer buffer;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private Token aheadToken;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private int openParens = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * Constructs a new Type1Lexer given a header-less .pfb segment.[0m             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * @param bytes Header-less .pfb segment[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * @throws IOException[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;35mType1Lexer[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        buffer = [0m[1;35mByteBuffer.wrap[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:500[0m[39m-[0m[1;36m516[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:     * Reads a binary CharString.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/RandomAccessReadMemoryMappedFile.jav[0m[1;92ma:79[0m[39m-[0m[1;36m92[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public [0m[1;35mRandomAccessReadMemoryMappedFile[0m[1;39m([0m[39mPath path[0m[1;39m)[0m[39m throws IOException[0m        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        fileChannel = [0m[1;35mFileChannel.open[0m[1;39m([0m[39mpath, [0m                                    [2m                [0m
[2;36m                    [0m         [1;35mEnumSet.of[0m[1;39m([0m[39mStandardOpenOption.READ[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        size = [0m[1;35mfileChannel.size[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[35m/[0m[35m/[0m[39m TODO only ints are allowed -> implement paging[0m                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39msize > Integer.MAX_VALUE[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mgetClass[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" doesn't yet support [0m  [2m                [0m
[2;36m                    [0m         [32mfiles bigger than "[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                    + Integer.MAX_VALUE[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[35m/[0m[35m/[0m[39m map the whole file to memory[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        mappedByteBuffer = [0m[1;35mfileChannel.map[0m[1;39m([0m[39mFileChannel.MapMode.READ_ONLY, [0m[1;36m0[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        unmapper = IOUtils::unmap;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/ScratchFileBuffer.jav[0m[1;92ma:104[0m[39m-[0m[1;36m118[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            int newSize = pageIndexes.length*[0m[1;36m2[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[35m/[0m[35m/[0m[39m check overflow[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            if [0m[1;39m([0m[39mnewSize<pageIndexes.length[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                if [0m[1;39m([0m[39mpageIndexes.length == Integer.MAX_VALUE[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Maximum buffer size reached."[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                newSize = Integer.MAX_VALUE;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:            int[0m[1;39m[[0m[1;39m][0m[39m newPageIndexes = new int[0m[1;39m[[0m[39mnewSize[0m[1;39m][0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mpageIndexes, [0m[1;36m0[0m[39m, newPageIndexes, [0m[1;36m0[0m[39m, pageCount[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            pageIndexes = newPageIndexes;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/ScratchFile.jav[0m[1;92ma:228[0m[39m-[0m[1;36m298[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:     * by a number of pages defined by [0m[1;39m{[0m[39m@link #ENLARGE_PAGE_COUNT[0m[1;39m}[0m[39m - in case[0m    [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:     * scratch file usage is allowed - or increase the [0m[1;39m{[0m[39m@link #inMemoryPages[0m[1;39m}[0m   [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:     * array in case main memory was not restricted. If neither of both is[0m      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:     * allowed/the case than free pages count won't be changed. The same is [0m    [2m                [0m
[2;36m                    [0m         [39mtrue[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:     * if no new pages could be added because we reached the maximum of[0m         [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:     * [0m[1;39m{[0m[39m@link Integer#MAX_VALUE[0m[1;39m}[0m[39m pages.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:     * <p>If scratch file usage is allowed and scratch file does not exist [0m     [2m                [0m
[2;36m                    [0m         [39malready[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:     * it will be created.<[0m[35m/[0m[95mp[0m[39m>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:     * <p>Only to be called under synchronization on [0m[1;39m{[0m[39m@link #freePages[0m[1;39m}[0m[39m.<[0m[35m/[0m[95mp[0m[39m>[0m    [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    private void [0m[1;35menlarge[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:        synchronized [0m[1;39m([0m[39mioLock[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:            [0m[1;35mcheckClosed[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:     [0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:            if [0m[1;39m([0m[39mpageCount >= maxPageCount[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:                return;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:            if [0m[1;39m([0m[39museScratchFile[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:                [0m[35m/[0m[35m/[0m[39m create scratch file is needed[0m                                [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:                if [0m[1;39m([0m[39m raf == null [0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:                    file = [0m[1;35mFile.createTempFile[0m[1;39m([0m[32m"PDFBox"[0m[39m, [0m[32m".tmp"[0m[39m, [0m               [2m                [0m
[2;36m                    [0m         [39mscratchFileDirectory[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:                    try[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:                        raf = new [0m[1;35mjava.io.RandomAccessFile[0m[1;39m([0m[39mfile, [0m[32m"rw"[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:                    catch [0m[1;39m([0m[39mFileNotFoundException e[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:                        if [0m[1;39m([0m[39m![0m[1;35mfile.delete[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:                            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Error deleting scratch file: [0m[32m{[0m[32m}[0m[32m"[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [1;35mfile.getAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:                        throw e;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:                long fileLen = [0m[1;35mraf.length[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:                long expectedFileLen = [0m[1;39m([0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mpageCount - inMemoryMaxPageCount[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m* PAGE_SIZE;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:                if [0m[1;39m([0m[39mexpectedFileLen != fileLen[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Expected scratch file size of "[0m[39m + [0m   [2m                [0m
[2;36m                    [0m         [39mexpectedFileLen + [0m[32m" but found "[0m[39m + fileLen[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:                    [0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:                [0m[35m/[0m[35m/[0m[39m enlarge if we do not overflow[0m                                [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:                if [0m[1;39m([0m[39mpageCount + ENLARGE_PAGE_COUNT > pageCount[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:                    fileLen += ENLARGE_PAGE_COUNT * PAGE_SIZE;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:                    [0m[1;35mraf.setLength[0m[1;39m([0m[39mfileLen[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:                    [0m[1;35mfreePages.set[0m[1;39m([0m[39mpageCount, pageCount + ENLARGE_PAGE_COUNT[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:            else if [0m[1;39m([0m[39m!maxMainMemoryIsRestricted[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:                [0m[35m/[0m[35m/[0m[39m increase number of in-memory pages[0m                           [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:                int oldSize = inMemoryPages.length;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:                int newSize = [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m [0m[1;35mMath.min[0m[1;39m([0m[39m [0m[1;39m([0m[1;39m([0m[39mlong[0m[1;39m)[0m[39moldSize[0m[1;39m)[0m[39m * [0m[1;36m2[0m[39m, [0m             [2m                [0m
[2;36m                    [0m         [39mInteger.MAX_VALUE[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m this handles integer overflow[0m                               [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:                if [0m[1;39m([0m[39mnewSize > oldSize[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:                    byte[0m[1;39m[[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m newInMemoryPages = new byte[0m[1;39m[[0m[39mnewSize[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:                    [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39minMemoryPages, [0m[1;36m0[0m[39m, newInMemoryPages, [0m[1;36m0[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39moldSize[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                    inMemoryPages = newInMemoryPages;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Token.jav[0m[1;92ma:104[0m[39m-[0m[1;36m108[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    public int [0m[1;35mintValue[0m[1;39m([0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[35m/[0m[35m/[0m[39m some fonts have reals where integers should be, so we tolerate it[0m    [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        return [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;35mFloat.parseFloat[0m[1;39m([0m[39mtext[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:220[0m[39m-[0m[1;36m250[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                            [0m[35m/[0m[35m/[0m[39m the stream is corrupt[0m                            [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Could not read [0m     [2m                [0m
[2;36m                    [0m         [32mtoken at position "[0m[39m +[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                                                           [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"RD"[0m[1;39m)[0m[39m || [0m[1;35mname.equals[0m[1;39m([0m[32m"-|"[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                            [0m[35m/[0m[35m/[0m[39m return the next CharString instead[0m               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            if [0m[1;39m([0m[39mprevToken != null && [0m[1;35mprevToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == [0m    [2m                [0m
[2;36m                    [0m         [39mToken.INTEGER[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                                return [0m[1;35mreadCharString[0m[1;39m([0m[1;35mprevToken.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            else[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"expected INTEGER before [0m [2m                [0m
[2;36m                    [0m         [32m-| or RD"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                        else[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                            return new [0m[1;35mToken[0m[1;39m([0m[39mname, Token.NAME[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        while [0m[1;39m([0m[39mskip[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:500[0m[39m-[0m[1;36m516[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:     * Reads a binary CharString.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/DamagedFontException.jav[0m[1;92ma:27[0m[39m-[0m[1;36m33[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:public class DamagedFontException extends IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    public [0m[1;35mDamagedFontException[0m[1;39m([0m[39mString message[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mmessage[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:250[0m[39m-[0m[1;36m350[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:     * Reads a number or returns null.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    private Token [0m[1;35mtryReadNumber[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:        [0m[1;35mbuffer.mark[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:        StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:        StringBuilder radix = null;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:        char c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:        boolean hasDigit = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:        [0m[35m/[0m[35m/[0m[39m optional + or -[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        if [0m[1;39m([0m[39mc == [0m[32m'+'[0m[39m || c == [0m[32m'-'[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:        [0m[35m/[0m[35m/[0m[39m optional digits[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        while [0m[1;39m([0m[1;35mCharacter.isDigit[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:            hasDigit = true;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:        [0m[35m/[0m[35m/[0m[39m optional .[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:        if [0m[1;39m([0m[39mc == [0m[32m'.'[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        else if [0m[1;39m([0m[39mc == [0m[32m'#'[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:            [0m[35m/[0m[35m/[0m[39m PostScript radix number takes the form base#number[0m               [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:            radix = sb;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:            sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:        else if [0m[1;39m([0m[1;35msb.length[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[39m || !hasDigit[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            [0m[35m/[0m[35m/[0m[39m failure[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mbuffer.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:        else if [0m[1;39m([0m[39mc != [0m[32m'e'[0m[39m && c != [0m[32m'E'[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:            [0m[35m/[0m[35m/[0m[39m integer[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;35mbuffer.position[0m[1;39m([0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[39m [0m[1;36m-1[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[1;35msb.toString[0m[1;39m([0m[1;39m)[0m[39m, Token.INTEGER[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        [0m[35m/[0m[35m/[0m[39m required digit[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:        if [0m[1;39m([0m[1;35mCharacter.isDigit[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        else if [0m[1;39m([0m[39mc != [0m[32m'e'[0m[39m && c != [0m[32m'E'[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:            [0m[35m/[0m[35m/[0m[39m failure[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;35mbuffer.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:        [0m[35m/[0m[35m/[0m[39m optional digits[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        while [0m[1;39m([0m[1;35mCharacter.isDigit[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:        [0m[35m/[0m[35m/[0m[39m optional E[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:        if [0m[1;39m([0m[39mc == [0m[32m'E'[0m[39m || c == [0m[32m'e'[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:            c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:            [0m[35m/[0m[35m/[0m[39m optional minus[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:            if [0m[1;39m([0m[39mc == [0m[32m'-'[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:                c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:            [0m[35m/[0m[35m/[0m[39m required digit[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:            if [0m[1;39m([0m[1;35mCharacter.isDigit[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:                c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:                [0m[35m/[0m[35m/[0m[39m failure[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:                [0m[1;35mbuffer.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:                return null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:            [0m[35m/[0m[35m/[0m[39m optional digits[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:113[0m[39m-[0m[1;36m220[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:     * Reads a single token.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:     * @param prevToken the previous token[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    private Token [0m[1;35mreadToken[0m[1;39m([0m[39mToken prevToken[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        boolean skip;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        do[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:            skip = false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:            while [0m[1;39m([0m[1;35mbuffer.hasRemaining[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                char c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:                [0m[35m/[0m[35m/[0m[39m delimiters[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:                if [0m[1;39m([0m[39mc == [0m[32m'%'[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                    [0m[35m/[0m[35m/[0m[39m comment[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                    [0m[1;35mreadComment[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'[0m[32m([0m[32m'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                    return [0m[1;35mreadString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'[0m[32m)[0m[32m'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                    [0m[35m/[0m[35m/[0m[39m not allowed outside a string context[0m                     [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"unexpected closing parenthesis"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'[0m[32m[[0m[32m'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                    return new [0m[1;35mToken[0m[1;39m([0m[39mc, Token.START_ARRAY[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'[0m[32m{[0m[32m'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                    return new [0m[1;35mToken[0m[1;39m([0m[39mc, Token.START_PROC[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'[0m[32m][0m[32m'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                    return new [0m[1;35mToken[0m[1;39m([0m[39mc, Token.END_ARRAY[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'[0m[32m}[0m[32m'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                    return new [0m[1;35mToken[0m[1;39m([0m[39mc, Token.END_PROC[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'/'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                    String regular = [0m[1;35mreadRegular[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                    if [0m[1;39m([0m[39mregular == null[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                        [0m[35m/[0m[35m/[0m[39m the stream is corrupt[0m                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:                        throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Could not read token at[0m [2m                [0m
[2;36m                    [0m         [32mposition "[0m[39m +[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                                                        [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                    return new [0m[1;35mToken[0m[1;39m([0m[39mregular, Token.LITERAL[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'<'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                    char c2 = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                    if [0m[1;39m([0m[39mc2 == c[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                        return new [0m[1;35mToken[0m[1;39m([0m[32m"<<"[0m[39m, Token.START_DICT[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:                        [0m[35m/[0m[35m/[0m[39m code may have to be changed in something better, [0m    [2m                [0m
[2;36m                    [0m         [39mmaybe new token type[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:                        [0m[1;35mbuffer.position[0m[1;39m([0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:                        return new [0m[1;35mToken[0m[1;39m([0m[39mc, Token.NAME[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'>'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:                    char c2 = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:                    if [0m[1;39m([0m[39mc2 == c[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:                        return new [0m[1;35mToken[0m[1;39m([0m[32m">>"[0m[39m, Token.END_DICT[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                        [0m[35m/[0m[35m/[0m[39m code may have to be changed in something better, [0m    [2m                [0m
[2;36m                    [0m         [39mmaybe new token type[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:                        [0m[1;35mbuffer.position[0m[1;39m([0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                        return new [0m[1;35mToken[0m[1;39m([0m[39mc, Token.NAME[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                else if [0m[1;39m([0m[1;35mCharacter.isWhitespace[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:                    skip = true;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[1;36m0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                    [0m[1;35mLOG.warn[0m[1;39m([0m[32m"NULL byte in font, skipped"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                    skip = true;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:                else[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:                    [0m[1;35mbuffer.position[0m[1;39m([0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[39m [0m[1;36m-1[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                    [0m[35m/[0m[35m/[0m[39m regular character: try parse as number[0m                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:                    Token number = [0m[1;35mtryReadNumber[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:                    if [0m[1;39m([0m[39mnumber != null[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                        return number;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                        [0m[35m/[0m[35m/[0m[39m otherwise this must be a name[0m                        [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                        String name = [0m[1;35mreadRegular[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:220[0m[39m-[0m[1;36m250[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                            [0m[35m/[0m[35m/[0m[39m the stream is corrupt[0m                            [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Could not read [0m     [2m                [0m
[2;36m                    [0m         [32mtoken at position "[0m[39m +[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                                                           [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"RD"[0m[1;39m)[0m[39m || [0m[1;35mname.equals[0m[1;39m([0m[32m"-|"[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                            [0m[35m/[0m[35m/[0m[39m return the next CharString instead[0m               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            if [0m[1;39m([0m[39mprevToken != null && [0m[1;35mprevToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == [0m    [2m                [0m
[2;36m                    [0m         [39mToken.INTEGER[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                                return [0m[1;35mreadCharString[0m[1;39m([0m[1;35mprevToken.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            else[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"expected INTEGER before [0m [2m                [0m
[2;36m                    [0m         [32m-| or RD"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                        else[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                            return new [0m[1;35mToken[0m[1;39m([0m[39mname, Token.NAME[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        while [0m[1;39m([0m[39mskip[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/ttf/TTFDataStream.jav[0m[1;92ma:242[0m[39m-[0m[1;36m260[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:     * Read a specific number of bytes from the stream.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:     * @param numberOfBytes The number of bytes to read.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:     * @return The byte buffer.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:     * @throws IOException If there is an error while reading.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    public byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mread[0m[1;39m([0m[39mint numberOfBytes[0m[1;39m)[0m[39m throws IOException[0m                    [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mnumberOfBytes[0m[1;39m][0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:        int amountRead = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:        int totalAmountRead = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:        [0m[35m/[0m[35m/[0m[39m read at most numberOfBytes bytes from the stream.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:        while [0m[1;39m([0m[39mtotalAmountRead < numberOfBytes[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:                && [0m[1;39m([0m[39mamountRead = [0m[1;35mread[0m[1;39m([0m[39mdata, totalAmountRead, numberOfBytes - [0m   [2m                [0m
[2;36m                    [0m         [39mtotalAmountRead[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m-1[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            totalAmountRead += amountRead;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:        if [0m[1;39m([0m[39mtotalAmountRead == numberOfBytes[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/cff/CFFParser.jav[0m[1;92ma:147[0m[39m-[0m[1;36m162[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    public List<CFFFont> [0m[1;35mparse[0m[1;39m([0m[39mRandomAccessRead randomAccessRead[0m[1;39m)[0m[39m throws [0m       [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:        [0m[35m/[0m[35m/[0m[39m TODO do we need to store the source data of the font? It isn't used [0m [2m                [0m
[2;36m                    [0m         [39mat all[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m bytes = new byte[0m[1;39m[[0m[1;39m([0m[39mint[0m[1;39m)[0m[39m [0m[1;35mrandomAccessRead.length[0m[1;39m([0m[1;39m)[0m[1;39m][0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        [0m[1;35mrandomAccessRead.seek[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        int remainingBytes = bytes.length;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:        int amountRead;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:        while [0m[1;39m([0m[1;39m([0m[39mamountRead = [0m[1;35mrandomAccessRead.read[0m[1;39m([0m[39mbytes, bytes.length - [0m       [2m                [0m
[2;36m                    [0m         [39mremainingBytes,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                remainingBytes[0m[1;39m)[0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            remainingBytes -= amountRead;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;35mrandomAccessRead.seek[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        this.source = new [0m[1;35mCFFBytesource[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        return [0m[1;35mparse[0m[1;39m([0m[39mnew [0m[1;35mDataInputRandomAccessRead[0m[1;39m([0m[39mrandomAccessRead[0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:66[0m[39m-[0m[1;36m167[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private static final int EOF_MARKER = [0m[1;36m0x03[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Heuristically chosen max length to buffer a Type1 font[0m                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final long MAX_LENGTH = 100_000_000;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * the parsed pfb-data.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m pfbdata;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * the lengths of the records [0m[1;39m([0m[39mASCII, BINARY, ASCII[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private final int[0m[1;39m[[0m[1;39m][0m[39m lengths = new int[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[35m/[0m[35m/[0m[39m sample [0m[1;39m([0m[39mpfb-file[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;36m00000000[0m[39m [0m[1;36m80[0m[39m [0m[1;36m01[0m[39m 8b [0m[1;36m15[0m[39m  [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m25[0m[39m [0m[1;36m21[0m[39m  [0m[1;36m50[0m[39m [0m[1;36m53[0m[39m 2d [0m[1;36m41[0m[39m  [0m[1;36m64[0m[39m 6f [0m[1;36m62[0m[39m [0m[1;36m65[0m[39m  [0m             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    [0m[35m/[0m[35m/[0m[39m          [0m[33m...[0m[33m...[0m[39m%!PS-Adobe[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * Create a new object.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * @param filename  the file name[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @throws IOException if an IO-error occurs.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal String filename[0m[1;39m)[0m[39m throws IOException [0m                  [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mFiles.readAllBytes[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * Create a new object.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * @param in   The input.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     * @throws IOException if an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal InputStream in[0m[1;39m)[0m[39m throws IOException [0m                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m pfb = [0m[1;35min.readAllBytes[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;35mparsePfb[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:     * Create a new object.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:     * @param bytes   The input.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:     * @throws IOException if an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                     [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;35mparsePfb[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     * Parse the pfb-array.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     * @param pfb   The pfb-Array[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:     * @throws IOException in an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    private void [0m[1;35mparsePfb[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m pfb[0m[1;39m)[0m[39m throws IOException [0m                 [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[39mpfb.length < PFB_[0m[1;33mHEAD[0m[39mER_LENGTH[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"PFB header missing"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[35m/[0m[35m/[0m[39m read into segments and keep them[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        List<Integer> typeList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        List<byte[0m[1;39m[[0m[1;39m][0m[39m> barrList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        ByteArrayInputStream in = new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        int total = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        do[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            int r = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            if [0m[1;39m([0m[39mr == [0m[1;36m-1[0m[39m && total > [0m[1;36m0[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                break; [0m[35m/[0m[35m/[0m[39m EOF[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            if [0m[1;39m([0m[39mr != START_MARKER[0m[1;39m)[0m[39m [0m                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Start marker missing"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            int recordType = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            if [0m[1;39m([0m[39mrecordType == EOF_MARKER[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            if [0m[1;39m([0m[39mrecordType != ASCII_MARKER && recordType != BINARY_MARKER[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Incorrect record type: "[0m[39m + recordType[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.jav[0m[1;92ma:60[0m[39m-[0m[1;36m66[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final long OBJECT_NUMBER_THRESHOLD = 10000000000L;[0m            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final long GENERATION_NUMBER_THRESHOLD = [0m[1;36m65535[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private static final int MAX_LENGTH_LONG = [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mLong.toString[0m[1;39m([0m[39mLong.MAX_VALUE[0m[1;39m)[0m[1;35m.length[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.jav[0m[1;92ma:1445[0m[39m-[0m[1;36m1455[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:        int lastByte;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1446[0m[39m:        StringBuilder buffer = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1447[0m[39m:        while [0m[1;39m([0m[1;35misDigit[0m[1;39m([0m[39mlastByte = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1448[0m[39m:        [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:            [0m[1;35mbuffer.append[0m[1;39m([0m[39m [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39mlastByte [0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:            if [0m[1;39m([0m[1;35mbuffer.length[0m[1;39m([0m[1;39m)[0m[39m > MAX_LENGTH_LONG[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:            [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Number '"[0m[39m + buffer + [0m                   [2m                [0m
[2;36m                    [0m         [1;36m1453[0m[39m:                        [0m[32m"' is getting too long, stop reading at offset "[0m[39m + [0m    [2m                [0m
[2;36m                    [0m         [1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1454[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1455[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/RandomAccessReadMemoryMappedFile.jav[0m[1;92ma:164[0m[39m-[0m[1;36m174[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    public int [0m[1;35mread[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m b, int offset, int length[0m[1;39m)[0m[39m throws IOException[0m        [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        if [0m[1;39m([0m[1;35misEOF[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            return [0m[1;36m-1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        int remainingBytes = [0m[1;39m([0m[39mint[0m[1;39m)[0m[39msize - [0m[1;35mmappedByteBuffer.position[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        remainingBytes = [0m[1;35mMath.min[0m[1;39m([0m[39mremainingBytes, length[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:        [0m[1;35mmappedByteBuffer.get[0m[1;39m([0m[39mb, offset, remainingBytes[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        return remainingBytes;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/cmap/CMapParser.jav[0m[1;92ma:726[0m[39m-[0m[1;36m748[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:                intValue *= multiplyer;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:                if [0m[1;39m([0m[39mmultiplyer == [0m[1;36m16[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:                    bufferIndex++;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:                    if [0m[1;39m([0m[39mbufferIndex >= tokenParserByteBuffer.length[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:                        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"cmap token ist larger than [0m      [2m                [0m
[2;36m                    [0m         [32mbuffer size "[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:                                + tokenParserByteBuffer.length[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:                    tokenParserByteBuffer[0m[1;39m[[0m[39mbufferIndex[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:                    multiplyer = [0m[1;36m1[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:                else[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:                    multiplyer = [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:                tokenParserByteBuffer[0m[1;39m[[0m[39mbufferIndex[0m[1;39m][0m[39m += intValue;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:                theNextByte = [0m[1;35mrandomAcccessRead.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m finalResult = new byte[0m[1;39m[[0m[39mbufferIndex + [0m[1;36m1[0m[1;39m][0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mtokenParserByteBuffer, [0m[1;36m0[0m[39m, finalResult, [0m[1;36m0[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [39mbufferIndex + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:            return finalResult;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:51[0m[39m-[0m[1;36m65[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private final ByteBuffer buffer;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private Token aheadToken;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private int openParens = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * Constructs a new Type1Lexer given a header-less .pfb segment.[0m             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * @param bytes Header-less .pfb segment[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * @throws IOException[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;35mType1Lexer[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        buffer = [0m[1;35mByteBuffer.wrap[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:220[0m[39m-[0m[1;36m250[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                            [0m[35m/[0m[35m/[0m[39m the stream is corrupt[0m                            [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Could not read [0m     [2m                [0m
[2;36m                    [0m         [32mtoken at position "[0m[39m +[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                                                           [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"RD"[0m[1;39m)[0m[39m || [0m[1;35mname.equals[0m[1;39m([0m[32m"-|"[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                            [0m[35m/[0m[35m/[0m[39m return the next CharString instead[0m               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            if [0m[1;39m([0m[39mprevToken != null && [0m[1;35mprevToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == [0m    [2m                [0m
[2;36m                    [0m         [39mToken.INTEGER[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                                return [0m[1;35mreadCharString[0m[1;39m([0m[1;35mprevToken.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            else[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"expected INTEGER before [0m [2m                [0m
[2;36m                    [0m         [32m-| or RD"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                        else[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                            return new [0m[1;35mToken[0m[1;39m([0m[39mname, Token.NAME[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        while [0m[1;39m([0m[39mskip[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:500[0m[39m-[0m[1;36m516[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:     * Reads a binary CharString.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:118[0m[39m-[0m[1;36m124[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        boolean skip;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        do[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:            skip = false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:            while [0m[1;39m([0m[1;35mbuffer.hasRemaining[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:379[0m[39m-[0m[1;36m406[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:    private String [0m[1;35mreadRegular[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                             [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:        StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:        while [0m[1;39m([0m[1;35mbuffer.hasRemaining[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:            [0m[1;35mbuffer.mark[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:            char c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:            if [0m[1;39m([0m[1;35mCharacter.isWhitespace[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m ||[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:                c == [0m[32m'[0m[32m([0m[32m'[0m[39m || c == [0m[32m'[0m[32m)[0m[32m'[0m[39m ||[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:                c == [0m[32m'<'[0m[39m || c == [0m[32m'>'[0m[39m ||[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                c == [0m[32m'[0m[32m[[0m[32m'[0m[39m || c == [0m[32m'[0m[32m][0m[32m'[0m[39m ||[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:                c == [0m[32m'[0m[32m{[0m[32m'[0m[39m || c == [0m[32m'[0m[32m}[0m[32m'[0m[39m ||[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:                c == [0m[32m'/'[0m[39m || c == [0m[32m'%'[0m[39m [0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:                [0m[1;35mbuffer.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:        if [0m[1;39m([0m[1;35msb.length[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:        return [0m[1;35msb.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:432[0m[39m-[0m[1;36m450[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    private Token [0m[1;35mreadString[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                               [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:        StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:        while [0m[1;39m([0m[1;35mbuffer.hasRemaining[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:            char c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:            [0m[35m/[0m[35m/[0m[39m string context[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:            switch [0m[1;39m([0m[39mc[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:                case [0m[32m'[0m[32m([0m[32m'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:                    openParens++;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:                    [0m[1;35msb.append[0m[1;39m([0m[32m'[0m[32m([0m[32m'[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:                case [0m[32m'[0m[32m)[0m[32m'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:                    if [0m[1;39m([0m[39mopenParens == [0m[1;36m0[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:                        [0m[35m/[0m[35m/[0m[39m end of string[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:850[0m[39m-[0m[1;36m900[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:        Token token = [0m[1;35mread[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:        switch [0m[1;39m([0m[1;35mtoken.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m853[0m[39m:            case [0m[32m"NP"[0m[39m:[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:            case [0m[32m"|"[0m[39m:[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:                return;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:            case [0m[32m"noaccess"[0m[39m:[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:                token = [0m[1;35mread[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:            default:[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:        if [0m[1;39m([0m[1;35mtoken.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"put"[0m[1;39m)[0m[1;39m)[0m[39m [0m                                     [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Found "[0m[39m + token + [0m[32m" but expected NP"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:     * Reads the next token and throws an exception if it is not of the given [0m  [2m                [0m
[2;36m                    [0m         [39mkind.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:     * @return token, never null[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    private Token [0m[1;35mread[0m[1;39m([0m[39mToken.Kind kind[0m[1;39m)[0m[39m throws IOException[0m                      [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:        Token token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:        if [0m[1;39m([0m[39mtoken == null || [0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m != kind[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Found "[0m[39m + token + [0m[32m" but expected "[0m[39m + kind[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:        return token;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:     * Reads the next token and throws an exception if it is not of the given [0m  [2m                [0m
[2;36m                    [0m         [39mkind[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:     * and does not have the given value.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    private void [0m[1;35mread[0m[1;39m([0m[39mToken.Kind kind, String name[0m[1;39m)[0m[39m throws IOException[0m          [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:        Token token = [0m[1;35mread[0m[1;39m([0m[39mkind[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        if [0m[1;39m([0m[1;35mtoken.getText[0m[1;39m([0m[1;39m)[0m[39m == null || ![0m[1;35mtoken.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Found "[0m[39m + token + [0m[32m" but expected "[0m[39m + name[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:     * Reads the next token if and only if it is of the given kind and[0m          [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:     * has the given value.[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/test/java/org/apache/fontbox/type1/Type1LexerTest.jav[0m[1;92ma:123[0m[39m-[0m[1;36m135[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    void [0m[1;35mTestData[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        String s = [0m[32m"3 RD 123 ND"[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        Type1Lexer t1l = new [0m[1;35mType1Lexer[0m[1;39m([0m[1;35ms.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        List<Token> tokens = [0m[1;35mreadTokens[0m[1;39m([0m[39mt1l[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.INTEGER, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m3[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.CHARSTRING, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        [0m[1;35mAssertions.assertArrayEquals[0m[1;39m([0m[39mnew byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;39m{[0m[32m'1'[0m[39m, [0m[32m'2'[0m[39m, [0m[32m'3'[0m[1;39m}[0m[39m, [0m               [2m                [0m
[2;36m                    [0m         [1;35mtokens.get[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;35m.getData[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.NAME, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"ND"[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.jav[0m[1;92ma:232[0m[39m-[0m[1;36m248[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                        if [0m[1;39m([0m[39mlength1 < [0m[1;36m0[0m[39m || length1 > length1 + length2[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid length data, actual [0m [2m                [0m
[2;36m                    [0m         [32mlength: "[0m[39m +[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                                    bytes.length + [0m[32m", /Length1: "[0m[39m + length1 + [0m  [2m                [0m
[2;36m                    [0m         [32m", /Length2: "[0m[39m + length2[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                        byte[0m[1;39m[[0m[1;39m][0m[39m segment1 = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39mbytes, [0m[1;36m0[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [39mlength1[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        byte[0m[1;39m[[0m[1;39m][0m[39m segment2 = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39mbytes, length1, [0m   [2m                [0m
[2;36m                    [0m         [39mlength1 + length2[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                        [0m[35m/[0m[35m/[0m[39m empty streams are simply ignored[0m                     [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                        if [0m[1;39m([0m[39mlength1 > [0m[1;36m0[0m[39m && length2 > [0m[1;36m0[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                            t1 = [0m[1;35mType1Font.createWithSegments[0m[1;39m([0m[39msegment1, [0m        [2m                [0m
[2;36m                    [0m         [39msegment2[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:                catch [0m[1;39m([0m[39mDamagedFontException e[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:66[0m[39m-[0m[1;36m72[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private static final int EOF_MARKER = [0m[1;36m0x03[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Heuristically chosen max length to buffer a Type1 font[0m                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final long MAX_LENGTH = 100_000_000;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:157[0m[39m-[0m[1;36m168[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:22[0m[39m-[0m[1;36m26[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.BufferUnderflowException;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:51[0m[39m-[0m[1;36m65[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private final ByteBuffer buffer;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private Token aheadToken;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private int openParens = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * Constructs a new Type1Lexer given a header-less .pfb segment.[0m             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * @param bytes Header-less .pfb segment[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * @throws IOException[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;35mType1Lexer[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        buffer = [0m[1;35mByteBuffer.wrap[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:102[0m[39m-[0m[1;36m111[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            return [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:220[0m[39m-[0m[1;36m250[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                            [0m[35m/[0m[35m/[0m[39m the stream is corrupt[0m                            [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Could not read [0m     [2m                [0m
[2;36m                    [0m         [32mtoken at position "[0m[39m +[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                                                           [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"RD"[0m[1;39m)[0m[39m || [0m[1;35mname.equals[0m[1;39m([0m[32m"-|"[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                            [0m[35m/[0m[35m/[0m[39m return the next CharString instead[0m               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            if [0m[1;39m([0m[39mprevToken != null && [0m[1;35mprevToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == [0m    [2m                [0m
[2;36m                    [0m         [39mToken.INTEGER[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                                return [0m[1;35mreadCharString[0m[1;39m([0m[1;35mprevToken.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            else[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"expected INTEGER before [0m [2m                [0m
[2;36m                    [0m         [32m-| or RD"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                        else[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                            return new [0m[1;35mToken[0m[1;39m([0m[39mname, Token.NAME[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        while [0m[1;39m([0m[39mskip[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:500[0m[39m-[0m[1;36m516[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:     * Reads a binary CharString.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/RandomAccessReadBufferedFile.jav[0m[1;92ma:130[0m[39m-[0m[1;36m136[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    public void [0m[1;35mseek[0m[1;39m([0m[39m final long position [0m[1;39m)[0m[39m throws IOException[0m                  [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        [0m[1;35mcheckClosed[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        if [0m[1;39m([0m[39mposition < [0m[1;36m0[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid position "[0m[39m + position[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/RandomAccessReadBuffer.jav[0m[1;92ma:163[0m[39m-[0m[1;36m169[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    public void [0m[1;35mseek[0m[1;39m([0m[39mlong position[0m[1;39m)[0m[39m throws IOException[0m                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[1;35mcheckClosed[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        if [0m[1;39m([0m[39mposition < [0m[1;36m0[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid position "[0m[39m + position[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mio/src/main/java/org/apache/pdfbox/io/RandomAccessReadMemoryMappedFile.jav[0m[1;92ma:125[0m[39m-[0m[1;36m131[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    public void [0m[1;35mseek[0m[1;39m([0m[39mlong position[0m[1;39m)[0m[39m throws IOException[0m                          [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;35mcheckClosed[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        if [0m[1;39m([0m[39mposition < [0m[1;36m0[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid position "[0m[39m+position[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:20[0m[39m-[0m[1;36m26[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.fontbox.type1;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.BufferUnderflowException;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:51[0m[39m-[0m[1;36m65[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private final ByteBuffer buffer;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private Token aheadToken;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private int openParens = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * Constructs a new Type1Lexer given a header-less .pfb segment.[0m             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * @param bytes Header-less .pfb segment[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * @throws IOException[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;35mType1Lexer[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        buffer = [0m[1;35mByteBuffer.wrap[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:220[0m[39m-[0m[1;36m237[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                            [0m[35m/[0m[35m/[0m[39m the stream is corrupt[0m                            [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Could not read [0m     [2m                [0m
[2;36m                    [0m         [32mtoken at position "[0m[39m +[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                                                           [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"RD"[0m[1;39m)[0m[39m || [0m[1;35mname.equals[0m[1;39m([0m[32m"-|"[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                            [0m[35m/[0m[35m/[0m[39m return the next CharString instead[0m               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            if [0m[1;39m([0m[39mprevToken != null && [0m[1;35mprevToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == [0m    [2m                [0m
[2;36m                    [0m         [39mToken.INTEGER[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                                return [0m[1;35mreadCharString[0m[1;39m([0m[1;35mprevToken.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            else[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"expected INTEGER before [0m [2m                [0m
[2;36m                    [0m         [32m-| or RD"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:500[0m[39m-[0m[1;36m516[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:     * Reads a binary CharString.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:    private Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:            [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:            return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/DamagedFontException.jav[0m[1;92ma:27[0m[39m-[0m[1;36m33[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:public class DamagedFontException extends IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    public [0m[1;35mDamagedFontException[0m[1;39m([0m[39mString message[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mmessage[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/test/java/org/apache/fontbox/type1/Type1LexerTest.jav[0m[1;92ma:123[0m[39m-[0m[1;36m135[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    void [0m[1;35mTestData[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        String s = [0m[32m"3 RD 123 ND"[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        Type1Lexer t1l = new [0m[1;35mType1Lexer[0m[1;39m([0m[1;35ms.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        List<Token> tokens = [0m[1;35mreadTokens[0m[1;39m([0m[39mt1l[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.INTEGER, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m3[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.CHARSTRING, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        [0m[1;35mAssertions.assertArrayEquals[0m[1;39m([0m[39mnew byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;39m{[0m[32m'1'[0m[39m, [0m[32m'2'[0m[39m, [0m[32m'3'[0m[1;39m}[0m[39m, [0m               [2m                [0m
[2;36m                    [0m         [1;35mtokens.get[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;35m.getData[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mToken.NAME, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;35m.getKind[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"ND"[0m[39m, [0m[1;35mtokens.get[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Root Cause Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe OutOfMemoryError originates from an unbounded memory allocation vulnerability [0m  [2m                [0m
[2;36m                    [0m         [39min `[0m[1;35mType1Lexer.readCharString[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m507[0m[39m. The method accepts a `length` [0m        [2m                [0m
[2;36m                    [0m         [39mparameter derived directly from untrusted Type1 font data and allocates a byte [0m     [2m                [0m
[2;36m                    [0m         [39marray without any validation:[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mbyte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability chain:[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Malicious/malformed font contains an INTEGER token with an excessively large [0m    [2m                [0m
[2;36m                    [0m         [39mvalue[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. When [0m[32m"RD"[0m[39m or [0m[32m"-|"[0m[39m operators are encountered [0m[1;39m([0m[39mline [0m[1;36m227[0m[39m-[0m[1;36m232[0m[1;39m)[0m[39m, the code calls [0m      [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mreadCharString[0m[1;39m([0m[1;35mprevToken.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m`[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The integer value is used directly for array allocation without bounds checking[0m  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Java attempts to allocate an array exceeding VM limits, throwing [0m                [2m                [0m
[2;36m                    [0m         [39mOutOfMemoryError[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Comprehensive Fix Implementation[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Primary Fix Location:** [0m                                                          [2m                [0m
[2;36m                    [0m         [39m`fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:502[0m[39m-[0m[1;36m515[0m[39m`[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must add validation before the array allocation at line [0m[1;36m507[0m[39m. Based on [0m      [2m                [0m
[2;36m                    [0m         [39manalysis of similar validation patterns throughout the PDFBox/FontBox codebase, the[0m [2m                [0m
[2;36m                    [0m         [39mfollowing checks are required:[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Validation Requirements:[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Negative value check**: Prevent negative array sizes[0m                           [2m                [0m
[2;36m                    [0m         [39m   - Pattern from: RandomAccessReadBufferedFile.jav[0m[1;92ma:133[0m[39m-[0m[1;36m135[0m[39m, [0m                      [2m                [0m
[2;36m                    [0m         [39mRandomAccessReadBuffer.jav[0m[1;92ma:166[0m[39m-[0m[1;36m168[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - Use: `if [0m[1;39m([0m[39mlength < [0m[1;36m0[0m[1;39m)[0m[39m`[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Buffer capacity check**: Ensure sufficient data exists before allocation[0m       [2m                [0m
[2;36m                    [0m         [39m   - Pattern from: RandomAccessReadMemoryMappedFile.jav[0m[1;92ma:170[0m[39m-[0m[1;36m172[0m[39m [0m[1;39m([0m[39muses Math.min [0m    [2m                [0m
[2;36m                    [0m         [39mwith remaining bytes[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m   - Pattern from: CMapParser.jav[0m[1;92ma:731[0m[39m-[0m[1;36m734[0m[39m [0m[1;39m([0m[39mchecks buffer size before indexing[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m   - Use: `if [0m[1;39m([0m[1;35mbuffer.remaining[0m[1;39m([0m[1;39m)[0m[39m < length + [0m[1;36m1[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mthe +[0m[1;36m1[0m[39m accounts for the space [0m    [2m                [0m
[2;36m                    [0m         [39mbyte read at line [0m[1;36m506[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Maximum size limit**: Prevent excessive allocations even when buffer has data[0m  [2m                [0m
[2;36m                    [0m         [39m   - Pattern from: PfbParser.jav[0m[1;92ma:71[0m[39m [0m[1;39m([0m[39mMAX_LENGTH = [0m[1;36m100[0m[39m,[0m[1;36m000[0m[39m,[0m[1;36m000[0m[39m for entire font[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m   - Pattern from: Similar validation in ScratchFileBuffer.jav[0m[1;92ma:109[0m[39m-[0m[1;36m113[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mInteger.MAX_VALUE checks[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - Use: A reasonable maximum for CharString data [0m[1;39m([0m[1;36m65535[0m[39m bytes = 64KB[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m   - Rationale: CharStrings represent glyph outline data, which should be [0m          [2m                [0m
[2;36m                    [0m         [39mrelatively small. The test case shows a typical CharString of [0m[1;36m3[0m[39m bytes. Even complex[0m [2m                [0m
[2;36m                    [0m         [39mglyphs rarely exceed a few KB.[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Exception type**: Use DamagedFontException for consistency[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Pattern from: Type1Lexer.jav[0m[1;92ma:223[0m[39m-[0m[1;36m224[0m[39m, DamagedFontException.jav[0m[1;92ma:27[0m[39m-[0m[1;36m33[0m         [2m                [0m
[2;36m                    [0m         [39m   - This exception is already used throughout Type1 parsing for corrupt/malformed [0m [2m                [0m
[2;36m                    [0m         [39mfont data[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Complete Fix:[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mInsert the following validation at the beginning of `[0m[1;35mreadCharString[0m[1;39m([0m[1;39m)[0m[39m` method, [0m     [2m                [0m
[2;36m                    [0m         [39mbetween lines [0m[1;36m503[0m[39m and [0m[1;36m504[0m[39m [0m[1;39m([0m[39mafter the method signature and before the try block[0m[1;39m)[0m[39m:[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate Token [0m[1;35mreadCharString[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m throws IOException[0m                         [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m ADD VALIDATION HERE [0m[1;39m([0m[39mbefore line [0m[1;36m504[0m[39m [0m[32m"try"[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[1;36m1[0m[39m. Check for negative length[0m                                                 [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mlength < [0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Invalid CharString length: "[0m[39m + length[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[1;36m2[0m[39m. Check against available buffer data [0m[1;39m([0m[39mneed [0m[1;36m1[0m[39m byte for space + length bytes[0m [2m                [0m
[2;36m                    [0m         [39mfor data[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mbuffer.remaining[0m[1;39m([0m[1;39m)[0m[39m < length + [0m[1;36m1[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"CharString length "[0m[39m + length + [0m             [2m                [0m
[2;36m                    [0m         [39m            [0m[32m" exceeds available buffer data "[0m[39m + [0m[1;35mbuffer.remaining[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[1;36m3[0m[39m. Enforce reasonable maximum for CharString size[0m                            [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m CharStrings represent glyph outlines and should be relatively small[0m          [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mlength > [0m[1;36m65535[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"CharString length "[0m[39m + length + [0m             [2m                [0m
[2;36m                    [0m         [39m            [0m[32m" exceeds maximum allowed size 65535"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m EXISTING CODE CONTINUES [0m[1;39m([0m[39mline [0m[1;36m504[0m[39m onwards[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    try[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mbuffer.get[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m space[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mlength[0m[1;39m][0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mbuffer.get[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m        return new [0m[1;35mToken[0m[1;39m([0m[39mdata, Token.CHARSTRING[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    catch [0m[1;39m([0m[39mBufferUnderflowException exception[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Premature end of buffer reached"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Justification and Analysis[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Why This is the Optimal Approach:[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Addresses the root cause**: Validates input before allocation, preventing [0m     [2m                [0m
[2;36m                    [0m         [39mOutOfMemoryError at its source[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Follows established patterns**: The validation logic mirrors patterns used [0m    [2m                [0m
[2;36m                    [0m         [39mthroughout the codebase:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - Negative checks [0m[1;39m([0m[39mRandomAccessRead classes[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Buffer capacity validation [0m[1;39m([0m[39mCMapParser, RandomAccessReadMemoryMappedFile[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m   - Maximum size limits [0m[1;39m([0m[39mPfbParser.MAX_LENGTH[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - DamagedFontException usage [0m[1;39m([0m[39mexisting Type1Lexer error handling[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Defense in depth**: Three layers of validation catch different attack vectors:[0m [2m                [0m
[2;36m                    [0m         [39m   - Negative values that would cause NegativeArraySizeException[0m                    [2m                [0m
[2;36m                    [0m         [39m   - Values exceeding available data that would cause BufferUnderflowException[0m      [2m                [0m
[2;36m                    [0m         [39m   - Excessively large but theoretically valid values that would cause [0m             [2m                [0m
[2;36m                    [0m         [39mOutOfMemoryError[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserves existing functionality**: [0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Legitimate Type1 fonts with reasonable CharString sizes continue to parse [0m     [2m                [0m
[2;36m                    [0m         [39mcorrectly[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - The [0m[1;36m65535[0m[39m-byte limit is extremely generous [0m[1;39m([0m[39mtypical CharStrings are a few [0m     [2m                [0m
[2;36m                    [0m         [39mhundred bytes at most[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - The test case in Type1LexerTest.jav[0m[1;92ma:126[0m[39m-[0m[1;36m134[0m[39m shows a [0m[1;36m3[0m[39m-byte CharString, [0m       [2m                [0m
[2;36m                    [0m         [39mconfirming typical sizes are small[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - The existing BufferUnderflowException handling remains as a final safety net[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Maintains API compatibility**: No changes to method signatures, return types, [0m [2m                [0m
[2;36m                    [0m         [39mor exception declarations[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### How It Preserves Existing Logic:[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- The method still reads a space byte then the CharString data [0m[1;39m([0m[39mlines [0m[1;36m506[0m[39m-[0m[1;36m508[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m- The BufferUnderflowException catch block is retained [0m[1;39m([0m[39mlines [0m[1;36m511[0m[39m-[0m[1;36m513[0m[1;39m)[0m[39m as a final [0m  [2m                [0m
[2;36m                    [0m         [39msafety net[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- Token creation and return logic unchanged [0m[1;39m([0m[39mline [0m[1;36m509[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m- The fix only adds validation before allocation, not modifying the core parsing [0m   [2m                [0m
[2;36m                    [0m         [39mlogic[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### How It Addresses the Evaluation Report:[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Fixes the OutOfMemoryError**: Rejects excessive allocations before they occur[0m  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Handles malicious input**: Validates untrusted integer values from font data[0m   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Prevents resource exhaustion**: The 65KB limit prevents DoS attacks via memory[0m [2m                [0m
[2;36m                    [0m         [39mexhaustion[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Provides clear diagnostics**: Error messages explain exactly why validation [0m   [2m                [0m
[2;36m                    [0m         [39mfailed[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Security classification appropriate**: Converts a low-severity security issue [0m [2m                [0m
[2;36m                    [0m         [39minto proper input validation[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Potential Side Effects and Mitigation:[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Rejection of theoretically valid large CharStrings**:[0m                          [2m                [0m
[2;36m                    [0m         [39m   - **Likelihood**: Extremely low - CharStrings represent glyph outlines, which [0m   [2m                [0m
[2;36m                    [0m         [39mare inherently bounded by practical glyph complexity[0m                                [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: The 65KB limit is very generous [0m[1;39m([0m[39mtypical glyphs are <1KB[0m[1;39m)[0m[39m. If [0m [2m                [0m
[2;36m                    [0m         [39mlegitimate fonts are rejected, the limit can be increased to Integer.MAX_VALUE [0m     [2m                [0m
[2;36m                    [0m         [39mwhile keeping the [0m[1;35mbuffer.remaining[0m[1;39m([0m[1;39m)[0m[39m check as the primary defense[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Different error message from OutOfMemoryError**:[0m                               [2m                [0m
[2;36m                    [0m         [39m   - **Impact**: Positive - DamagedFontException with descriptive message is more [0m  [2m                [0m
[2;36m                    [0m         [39mhelpful than OutOfMemoryError[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - **Compatibility**: PDType1Font.jav[0m[1;92ma:247[0m[39m-[0m[1;36m248[0m[39m already catches [0m                   [2m                [0m
[2;36m                    [0m         [39mDamagedFontException, so error handling paths are established[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Performance impact**:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - **Impact**: Negligible - three integer comparisons add minimal overhead[0m        [2m                [0m
[2;36m                    [0m         [39m   - **Benefit**: Prevents costly memory allocation attempts and subsequent GC [0m     [2m                [0m
[2;36m                    [0m         [39mpressure[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Similar Solutions in the Codebase[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix follows established patterns:[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **PfbParser.jav[0m[1;92ma:162[0m[39m-[0m[1;36m164[0m[39m**: Validates total size before allocation with [0m         [2m                [0m
[2;36m                    [0m         [39mdescriptive error[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **RandomAccessReadMemoryMappedFile.jav[0m[1;92ma:170[0m[39m-[0m[1;36m172[0m[39m**: Uses Math.min with remaining [0m [2m                [0m
[2;36m                    [0m         [39mbytes[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **CMapParser.jav[0m[1;92ma:731[0m[39m-[0m[1;36m734[0m[39m**: Checks buffer size before indexing[0m                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **ScratchFileBuffer.jav[0m[1;92ma:107[0m[39m-[0m[1;36m113[0m[39m**: Overflow detection and Integer.MAX_VALUE [0m    [2m                [0m
[2;36m                    [0m         [39mcapping[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **BaseParser.jav[0m[1;92ma:1450[0m[39m-[0m[1;36m1454[0m[39m**: Maximum length validation with descriptive [0m       [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Conclusion[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix strategy provides a robust, consistent, and minimal-impact solution to the[0m [2m                [0m
[2;36m                    [0m         [39mOutOfMemoryError vulnerability. By adding validation before allocation in [0m          [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mType1Lexer.readCharString[0m[1;39m([0m[1;39m)[0m[39m`, it prevents malicious font data from causing [0m        [2m                [0m
[2;36m                    [0m         [39mresource exhaustion while maintaining full compatibility with legitimate Type1 [0m     [2m                [0m
[2;36m                    [0m         [39mfonts. The approach follows established coding patterns throughout the [0m             [2m                [0m
[2;36m                    [0m         [39mPDFBox/FontBox codebase and provides clear diagnostic information when malformed [0m   [2m                [0m
[2;36m                    [0m         [39mfonts are encountered.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=773681;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=275575;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=354641;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=31354;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpxcthxwkp[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_5/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768180925.4869425[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-full-01_vuln_5.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/12/26 01:22:07][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mpdfbox[0m         ]8;id=500672;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=900584;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=362363;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=708756;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mpdfbox[0m                [2m               [0m
[2;36m[01/12/26 01:22:08][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=163458;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=406936;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mpdfbox[0m                 [2m               [0m
