[2;36m[01/11/26 12:20:19][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=486857;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=744046;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpvljjrnvi[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-de[0m [2m               [0m
[2;36m                    [0m         [35mlta-04_vuln_6/[0m[95magent-output-1768134019.8893127[0m                                        [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-commons-compress_cc-delta-04_vuln_6.toml     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN        ]8;id=166678;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=459470;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m[01/11/26 12:22:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN       ]8;id=993607;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=780464;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m119.90[0m seconds; [33mexception[0m=[3;91mFalse[0m                             [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for     ]8;id=60683;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=420121;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Started[33m...[0m                                                  [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for    ]8;id=379398;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=249423;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                         [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=690225;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=762622;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m119[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=612185;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=116840;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:22:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.95[0m        ]8;id=807933;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=243973;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/11/26 12:22:21][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=478418;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=301468;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=708930;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=599078;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=944309;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=347637;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=304019;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=447678;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:22:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m1.15[0m        ]8;id=11294;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=629164;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=403457;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=888687;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:22:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.89[0m        ]8;id=327938;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=631955;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/11/26 12:22:29][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=386569;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=435628;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp18099518381005482429/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:460[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:400[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:324[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a87e9aa6b0374484                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp18099518381005482429/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:460[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:400[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:324[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a87e9aa6b0374484                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/11/26 12:22:48][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=912160;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=526424;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/11/26 12:26:17][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=774620;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=500090;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/11/26 12:26:48][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=910448;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=36455;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=687498;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=362003;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:26:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.98[0m        ]8;id=779914;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=22719;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/11/26 12:26:50][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Started[33m...[0m             ]8;id=619581;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=216155;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpgwpo6lod[0m                                                 ]8;id=366987;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=101537;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/11/26 12:28:13][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Took [1;36m83.44[0m seconds;   ]8;id=654435;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=616997;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Started[33m...[0m       ]8;id=63034;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=779092;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:28:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Took [1;36m20.00[0m      ]8;id=751371;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=651104;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Started[33m...[0m          ]8;id=848132;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=175863;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:28:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Took [1;36m5.06[0m seconds; ]8;id=58140;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=248150;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Started[33m...[0m              ]8;id=60058;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=555902;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Took [1;36m0.00[0m seconds;     ]8;id=45287;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=714505;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=211711;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=976236;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:28:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.84[0m        ]8;id=5807;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=797047;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/11/26 12:28:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=494649;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=21616;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:28:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.92[0m        ]8;id=653162;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=67497;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=420801;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=194145;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/11/26 12:28:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.89[0m        ]8;id=594651;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=336664;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=509711;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=27066;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/main/java/org/apache/commons/compress/archivers/ArchiveEntry.java         [2m                [0m
[2;36m                    [0m         +++ b/src/main/java/org/apache/commons/compress/archivers/ArchiveEntry.java         [2m                [0m
[2;36m                    [0m         @@ [1;36m-77[0m,[1;36m14[0m +[1;36m77[0m,[1;36m16[0m @@                                                                 [2m                [0m
[2;36m                    [0m               *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m              default Path [1;35mresolveIn[0m[1m([0mfinal Path parentPath[1m)[0m throws IOException [1m{[0m             [2m                [0m
[2;36m                    [0m                  final String name = [1;35mgetName[0m[1m([0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         -        final Path outputFile = [1;35mparentPath.resolve[0m[1m([0mname[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +        String decodedName;                                                        [2m                [0m
[2;36m                    [0m         +        try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         +            decodedName = [1;35mURLDecoder.decode[0m[1m([0mname,                                  [2m                [0m
[2;36m                    [0m         [1;35mStandardCharsets.US_ASCII.name[0m[1m([0m[1m)[0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m         +        [1m}[0m catch [1m([0mIllegalArgumentException | UnsupportedEncodingException e[1m)[0m [1m{[0m      [2m                [0m
[2;36m                    [0m         +            decodedName = name;                                                    [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        final Path outputFile = [1;35mparentPath.resolve[0m[1m([0mdecodedName[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;       [2m                [0m
[2;36m                    [0m                  if [1m([0m![1;35moutputFile.startsWith[0m[1m([0mparentPath[1m)[0m[1m)[0m [1m{[0m                                  [2m                [0m
[2;36m                    [0m                      throw new [1;35mIOException[0m[1m([0m[1;35mString.format[0m[1m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m,    [2m                [0m
[2;36m                    [0m         parentPath, name, outputFile[1m)[0m[1m)[0m;                                                     [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         -        try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -            return [1;35mparentPath.resolve[0m[1m([0m[1;35mURLDecoder.decode[0m[1m([0mname,                      [2m                [0m
[2;36m                    [0m         [1;35mStandardCharsets.US_ASCII.name[0m[1m([0m[1m)[0m[1m)[0m[1m)[0m;                                                 [2m                [0m
[2;36m                    [0m         -        [1m}[0m catch [1m([0mIllegalArgumentException | UnsupportedEncodingException e[1m)[0m [1m{[0m      [2m                [0m
[2;36m                    [0m         -            return outputFile;                                                     [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        return outputFile;                                                         [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp18099518381005482429/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:86[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:460[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:400[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:324[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:204[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: a87e9aa6b0374484                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A critical security vulnerability has been detected in the Apache Commons Compress  [2m                [0m
[2;36m                    [0m         library's `Expander` class. The fuzzer has identified a file path traversal         [2m                [0m
[2;36m                    [0m         vulnerability [1m([0malso known as directory traversal[1m)[0m that allows an attacker to access [2m                [0m
[2;36m                    [0m         files and directories outside of the intended target directory. The vulnerability   [2m                [0m
[2;36m                    [0m         is triggered when processing archive files through the `[1;35mExpander.expand[0m[1m([0m[1m)[0m` method,  [2m                [0m
[2;36m                    [0m         with the malicious path attempting to traverse to                                   [2m                [0m
[2;36m                    [0m         `[35m/tmp/expander-tmp18099518381005482429/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m`.      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Vulnerability Type                                                              [2m                [0m
[2;36m                    [0m         This is a **File Path Traversal** vulnerability [1m([0malso known as Directory Traversal  [2m                [0m
[2;36m                    [0m         or Path Traversal[1m)[0m, classified as a critical security issue. Path traversal         [2m                [0m
[2;36m                    [0m         vulnerabilities occur when an application uses user-supplied input to construct     [2m                [0m
[2;36m                    [0m         file paths without proper validation, allowing attackers to access files and        [2m                [0m
[2;36m                    [0m         directories outside of the intended restricted directory.                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Issue Details                                                                   [2m                [0m
[2;36m                    [0m         The vulnerability manifests in the following manner:                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **Detection Point**: The Jazzer sanitizer detected the path traversal attempt at [2m                [0m
[2;36m                    [0m         `[1;35mFilePathTraversal.check[0m[1m([0m[1m)[0m`, indicating that validation logic exists but is being   [2m                [0m
[2;36m                    [0m         triggered by malicious input rather than preventing it at the source.               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **Malicious Path Pattern**: The detected path contains the classic traversal     [2m                [0m
[2;36m                    [0m         pattern `..[35m/../[0m` within the path                                                    [2m                [0m
[2;36m                    [0m         `[35m/tmp/expander-tmp18099518381005482429/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m`,      [2m                [0m
[2;36m                    [0m         which attempts to navigate up the directory structure to escape the intended output [2m                [0m
[2;36m                    [0m         directory.                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Call Stack Analysis**: The vulnerability is triggered through the following    [2m                [0m
[2;36m                    [0m         execution path:                                                                     [2m                [0m
[2;36m                    [0m            - Entry point: `[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0m[1m)[0m` [1m([0mfuzzer harness[1m)[0m            [2m                [0m
[2;36m                    [0m            - Primary expansion logic: Multiple nested calls to `[1;35mExpander.expand[0m[1m([0m[1m)[0m` methods  [2m                [0m
[2;36m                    [0m         at lines [1;36m204[0m, [1;36m324[0m, [1;36m400[0m, [1;36m460[0m                                                         [2m                [0m
[2;36m                    [0m            - Final vulnerable operation: `[1;35mExpander.expand[0m[1m([0m[1m)[0m` at line [1;36m86[0m, which likely       [2m                [0m
[2;36m                    [0m         performs file system operations                                                     [2m                [0m
[2;36m                    [0m            - The path is passed as the first argument to a method that triggers             [2m                [0m
[2;36m                    [0m         `[1;35mpathFirstArgHook[0m[1m([0m[1m)[0m`                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **Archive Processing Context**: The vulnerability occurs during archive          [2m                [0m
[2;36m                    [0m         expansion operations, suggesting that the malicious path is embedded within an      [2m                [0m
[2;36m                    [0m         archive entry [1m([0msuch as a filename or directory name in a ZIP, TAR, or similar       [2m                [0m
[2;36m                    [0m         archive format[1m)[0m.                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Areas Requiring Investigation                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         To obtain a comprehensive understanding of this vulnerability, the following        [2m                [0m
[2;36m                    [0m         components should be thoroughly investigated:                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **Expander.java Class**:                                                         [2m                [0m
[2;36m                    [0m            - Lines [1;36m86[0m, [1;36m204[0m, [1;36m324[0m, [1;36m400[0m, and [1;36m460[0m where the `[1;35mexpand[0m[1m([0m[1m)[0m` methods are defined and  [2m                [0m
[2;36m                    [0m         called                                                                              [2m                [0m
[2;36m                    [0m            - Input validation and sanitization logic for archive entry names                [2m                [0m
[2;36m                    [0m            - How file paths are constructed from archive entries                            [2m                [0m
[2;36m                    [0m            - Whether path normalization or canonicalization is performed before file        [2m                [0m
[2;36m                    [0m         operations                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **Archive Entry Processing**:                                                    [2m                [0m
[2;36m                    [0m            - How the library extracts and processes entry names from various archive        [2m                [0m
[2;36m                    [0m         formats                                                                             [2m                [0m
[2;36m                    [0m            - Whether entry names are validated before being used in file system operations  [2m                [0m
[2;36m                    [0m            - The logic for handling special characters, relative paths, and path separators [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **File System Operations**:                                                      [2m                [0m
[2;36m                    [0m            - Methods that create files or directories based on archive entry names          [2m                [0m
[2;36m                    [0m            - Whether symbolic links in archives are handled safely                          [2m                [0m
[2;36m                    [0m            - Temporary directory creation and management [1m([0mas evidenced by the               [2m                [0m
[2;36m                    [0m         `[35m/tmp/[0m[95mexpander-tmp...[0m` path[1m)[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **Security Boundaries**:                                                         [2m                [0m
[2;36m                    [0m            - Intended security model for archive expansion [1m([0me.g., should expansion be       [2m                [0m
[2;36m                    [0m         restricted to a specific directory?[1m)[0m                                                [2m                [0m
[2;36m                    [0m            - Existing validation or sanitization mechanisms [1m([0mif any[1m)[0m                        [2m                [0m
[2;36m                    [0m            - Whether the library documents security considerations for users                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m. **Related Archive Formats**:                                                     [2m                [0m
[2;36m                    [0m            - Whether this vulnerability affects all supported archive formats or only       [2m                [0m
[2;36m                    [0m         specific ones                                                                       [2m                [0m
[2;36m                    [0m            - Format-specific parsing logic that might introduce path traversal              [2m                [0m
[2;36m                    [0m         opportunities                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp18099518381005482429/output/q/r/s/t/../../[0m[95mjazzer-traversal[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:86[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:460[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:400[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:324[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:204[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mExpanderFuzzer.jav[0m[1;92ma:52[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: a87e9aa6b0374484[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:1[0m[39m-[0m[1;36m46[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.examples;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.channels.Channels;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.commons.compress.archivers.ArchiveException;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.commons.compress.archivers.ArchiveInputStream;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.commons.compress.archivers.ArchiveStreamFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZFile;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.tar.TarArchiveEntry;[0m                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.archivers.tar.TarFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.archivers.zip.ZipArchiveEntry;[0m                [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.compress.archivers.zip.ZipFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.commons.io.output.NullOutputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:67[0m[39m-[0m[1;36m93[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:19[0m[39m-[0m[1;36m26[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.UnsupportedEncodingException;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.net.URLDecoder;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:70[0m[39m-[0m[1;36m90[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Resolves this entry in the given parent Path.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m                [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @return a resolved and normalized Path.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mURLDecoder.decode[0m[1;39m([0m[39mname, [0m                   [2m                [0m
[2;36m                    [0m         [1;35mStandardCharsets.US_ASCII.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIllegalArgumentException | UnsupportedEncodingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            return outputFile;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:1[0m[39m-[0m[1;36m42[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.examples;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static org.junit.jupiter.api.Assertions.assertArrayEquals;[0m                [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import static org.junit.jupiter.api.Assertions.assertEquals;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import static org.junit.jupiter.api.Assertions.assertFalse;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import static org.junit.jupiter.api.Assertions.assertThrows;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import static org.junit.jupiter.api.Assertions.assertTrue;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import static org.junit.jupiter.api.Assumptions.assumeFalse;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import static org.junit.jupiter.api.Assumptions.assumeTrue;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.AbstractTest;[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:188[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m215[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, ArchiveException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../foo"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPathWithSimilarSibling[0m[1;39m([0m[1;39m)[0m[39m throws [0m            [2m                [0m
[2;36m                    [0m         [39mIOException, ArchiveException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        final String sibling = [0m[1;35mtempResultDir.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"x"[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        final File s = new [0m[1;35mFile[0m[1;39m([0m[1;35mtempResultDir.getParentFile[0m[1;39m([0m[1;39m)[0m[39m, sibling[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[1;35massumeFalse[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;35ms.mkdirs[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        [0m[1;35massumeTrue[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../"[0m[39m + sibling + [0m[32m"/a"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    void [0m[1;35mtestFileCantEscapeViaAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, [0m               [2m                [0m
[2;36m                    [0m         [39mArchiveException [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"/tmp/foo"[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        [0m[1;35massertFalse[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mtempResultDir, [0m[32m"tmp/foo"[0m[1;39m)[0m[1;35m.isFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:292[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m301[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    public void [0m[1;35mtestURLDecoding[0m[1;39m([0m[39m@TempDir Path output[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        Path input = [0m[1;35mPaths.get[0m[1;39m([0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:                [0m[1;35mExpanderTest.class.getResource[0m[1;39m([0m[32m"/testURLDecoded.zip"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39minput, output[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        File[0m[1;39m[[0m[1;39m][0m[39m files = [0m[1;35moutput.toFile[0m[1;39m([0m[1;39m)[0m[1;35m.listFiles[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m1[0m[39m, files.length[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"test.txt"[0m[39m, files[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m12[0m[39m, [0m[1;35mFiles.size[0m[1;39m([0m[39mfiles[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:70[0m[39m-[0m[1;36m90[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Resolves this entry in the given parent Path.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m                [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @return a resolved and normalized Path.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mURLDecoder.decode[0m[1;39m([0m[39mname, [0m                   [2m                [0m
[2;36m                    [0m         [1;35mStandardCharsets.US_ASCII.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIllegalArgumentException | UnsupportedEncodingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            return outputFile;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mRELEASE-NOTES.txt:[0m[1;36m245[0m[39m-[0m[1;36m260[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m245:C[0m[39mhanges in this version include:[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:New Features[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:------------[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:*            Add and use [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[39m, ZipFile.Builder, and deprecate [0m     [2m                [0m
[2;36m                    [0m         [39mconstructors. Thanks to Gary Gregory. [0m                                              [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:*            Add and use [0m[1;35mSevenZFile.builder[0m[1;39m([0m[1;39m)[0m[39m, SevenZFile.Builder, and [0m         [2m                [0m
[2;36m                    [0m         [39mdeprecate constructors. Thanks to Gary Gregory. [0m                                    [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:*            Add and use [0m[1;35mArchiveInputStream.getCharset[0m[1;39m([0m[1;39m)[0m[39m. Thanks to Gary [0m       [2m                [0m
[2;36m                    [0m         [39mGregory. [0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:*            Add and use [0m[1;35mArchiveEntry.resolveIn[0m[1;39m([0m[39mPath[0m[1;39m)[0m[39m. Thanks to Gary Gregory. [0m [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:*            Add Maven property project.build.outputTimestamp for build [0m        [2m                [0m
[2;36m                    [0m         [39mreproducibility. Thanks to Gary Gregory. [0m                                           [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:*            Add new runtime dependencies on commons-codec, commons-lang3 and [0m  [2m                [0m
[2;36m                    [0m         [39mcommons-io[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m256:F[0m[39mixed Bugs[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:---------[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:*  COMPRESS-[0m[1;36m632[0m[39m:  Check for invalid PAX values in TarArchiveEntry #[0m[1;36m438[0m[39m. Thanks [0m [2m                [0m
[2;36m                    [0m         [39mto Yakov Shafranovich, Gary Gregory. [0m                                               [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:*  COMPRESS-[0m[1;36m632[0m[39m:  Fix for zero size headers in ArjInputStream #[0m[1;36m439[0m[39m. Thanks to [0m  [2m                [0m
[2;36m                    [0m         [39mYakov Shafranovich, Gary Gregory. [0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/changes/changes.xml:[0m[1;36m250[0m[39m-[0m[1;36m270[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"fix"[0m[39m [0m[33missue[0m[39m=[0m[32m"COMPRESS[0m[32m-658"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Arnout[0m[32m [0m    [2m                [0m
[2;36m                    [0m         [32mEngelen"[0m[39m>Fix formatting the lowest expressable DOS time #[0m[1;36m472[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m              [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"fix"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Romain[0m[32m Manni-Bucau, Gary [0m       [2m                [0m
[2;36m                    [0m         [32mGregory"[0m[39m>Drop reflection from ExtraFieldUtils static initialization #[0m[1;36m480[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m  [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"fix"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Gary[0m[32m Gregory"[0m[39m>Preserve [0m         [2m                [0m
[2;36m                    [0m         [39mexception causation in [0m[1;35mExtraFieldUtils.register[0m[1;39m([0m[39mClass[0m[1;39m)[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m                    [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:      <!-- ADD -->[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"add"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Gary[0m[32m Gregory"[0m[39m>New runtime [0m      [2m                [0m
[2;36m                    [0m         [39mdependencies on commons-codec, commons-lang3 and commons-io.<[0m[35m/[0m[95maction[0m[39m>[0m               [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"add"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Gary[0m[32m Gregory"[0m[39m>Add and use [0m      [2m                [0m
[2;36m                    [0m         [1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[39m, ZipFile.Builder, and deprecate constructors.<[0m[35m/[0m[95maction[0m[39m>[0m            [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"add"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Gary[0m[32m Gregory"[0m[39m>Add and use [0m      [2m                [0m
[2;36m                    [0m         [1;35mSevenZFile.builder[0m[1;39m([0m[1;39m)[0m[39m, SevenZFile.Builder, and deprecate constructors.<[0m[35m/[0m[95maction[0m[39m>[0m      [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"add"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Gary[0m[32m Gregory"[0m[39m>Add and use [0m      [2m                [0m
[2;36m                    [0m         [1;35mArchiveInputStream.getCharset[0m[1;39m([0m[1;39m)[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"add"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Gary[0m[32m Gregory"[0m[39m>Add and use [0m      [2m                [0m
[2;36m                    [0m         [1;35mArchiveEntry.resolveIn[0m[1;39m([0m[39mPath[0m[1;39m)[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"add"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Gary[0m[32m Gregory"[0m[39m>Add Maven [0m        [2m                [0m
[2;36m                    [0m         [39mproperty project.build.outputTimestamp for build reproducibility.<[0m[35m/[0m[95maction[0m[39m>[0m          [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:      <!-- UPDATE -->[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"update"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Gary[0m[32m Gregory"[0m[39m>Bump [0m          [2m                [0m
[2;36m                    [0m         [39mcommons-lang3 from [0m[1;36m3.13[0m[39m.[0m[1;36m0[0m[39m to [0m[1;36m3.14[0m[39m.[0m[1;36m0[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"update"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Dependabot"[0m[39m>Bump [0m            [2m                [0m
[2;36m                    [0m         [39mcom.github.marschall:memoryfilesystem from [0m[1;36m2.6[0m[39m.[0m[1;36m1[0m[39m to [0m[1;36m2.8[0m[39m.[0m[1;36m0[0m[39m #[0m[1;36m444[0m[39m, #[0m[1;36m458[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m      [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"update"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Gary[0m[32m Gregory"[0m[39m>Bump [0m          [2m                [0m
[2;36m                    [0m         [39mcommons-io from [0m[1;36m2.15[0m[39m.[0m[1;36m0[0m[39m to [0m[1;36m2.15[0m[39m.[0m[1;36m1[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"update"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Dependabot"[0m[39m>Bump [0m            [2m                [0m
[2;36m                    [0m         [39morg.apache.commons:commons-parent from [0m[1;36m64[0m[39m to [0m[1;36m66[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m                           [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"update"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Dependabot"[0m[39m>Bump [0m            [2m                [0m
[2;36m                    [0m         [39mcom.github.luben:zstd-jni from [0m[1;36m1.5[0m[39m.[0m[1;36m5[0m[39m-[0m[1;36m10[0m[39m to [0m[1;36m1.5[0m[39m.[0m[1;36m5[0m[39m-[0m[1;36m11[0m[39m #[0m[1;36m448[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m                  [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"update"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Dependabot"[0m[39m>Bump [0m            [2m                [0m
[2;36m                    [0m         [39morg.slf4j:slf4j-api from [0m[1;36m2.0[0m[39m.[0m[1;36m9[0m[39m to [0m[1;36m2.0[0m[39m.[0m[1;36m12[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"update"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Dependabot"[0m[39m>Bump [0m            [2m                [0m
[2;36m                    [0m         [39mcommons-co[0m[1;92mdec:c[0m[39mommons-codec from [0m[1;36m1.16[0m[39m.[0m[1;36m0[0m[39m to [0m[1;36m1.16[0m[39m.[0m[1;36m1[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m                         [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"update"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Gary[0m[32m Gregory"[0m[39m>Add dependency[0m [2m                [0m
[2;36m                    [0m         [39mon commons-co[0m[1;92mdec:c[0m[39mommons-co[0m[1;92mdec:1[0m[39m.[0m[1;36m16.1[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"update"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Gary[0m[32m Gregory"[0m[39m>Add dependency[0m [2m                [0m
[2;36m                    [0m         [39mon org.apache.commons:commons-lang[0m[1;92m3:3[0m[39m.[0m[1;36m14.0[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m                                [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:      <action [0m[33mtype[0m[39m=[0m[32m"update"[0m[39m [0m[33mdev[0m[39m=[0m[32m"ggregory"[0m[39m due-[0m[33mto[0m[39m=[0m[32m"Gary[0m[32m Gregory"[0m[39m>Add dependency[0m [2m                [0m
[2;36m                    [0m         [39mon commons-io:commons-io:[0m[1;36m2.15[0m[39m.[0m[1;36m1[0m[39m.<[0m[35m/[0m[95maction[0m[39m>[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/utils/IOUtils.jav[0m[1;92ma:21[0m[39m-[0m[1;36m34[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.channels.ReadableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.file.LinkOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.commons.io.FileUtils;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.commons.io.output.NullOutputStream;[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/utils/IOUtils.jav[0m[1;92ma:41[0m[39m-[0m[1;36m60[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:public final class IOUtils [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Empty array of type [0m[1;39m{[0m[39m@link LinkOption[0m[1;39m}[0m[39m.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * @since [0m[1;36m1.21[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    public static final LinkOption[0m[1;39m[[0m[1;39m][0m[39m EMPTY_LINK_[0m[1;33mOPTIONS[0m[39m = [0m[1;39m{[0m[1;39m}[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * Closes the given Closeable and swallows any IOException that may occur.[0m   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * @param c Closeable to close, can be null[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * @since [0m[1;36m1.7[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     * @deprecated Use [0m[1;39m{[0m[39m@link [0m                                                   [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.io.IOUtils#[0m[1;35mcloseQuietly[0m[1;39m([0m[39mCloseable[0m[1;39m)[0m[1;39m}[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    @Deprecated[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public static void [0m[1;35mcloseQuietly[0m[1;39m([0m[39mfinal Closeable c[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35morg.apache.commons.io.IOUtils.closeQuietly[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/resources/testURLDecoded.zip:[0m[1;36m1[0m[39m-[0m[1;36m4[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:PK   �ayY-;�       [0m[1;36m5[0m[39m %[0m[1;36m74[0m[39m%[0m[1;36m65[0m[39m%[0m[1;36m73[0m[39m%[0m[1;36m74.[0m[39mtxtUT[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: ��Dg��Dg��Dg[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:         ��ە[0m[1;39m][0m[39m?��ڕ[0m[1;39m][0m[39m?��ڕ[0m[1;39m][0m[39m?��H���[0m[1;35mW[0m[1;39m([0m[39m�[0m[35m/[0m[39m�I� PK    �ayY-;�       -               %[0m[1;36m74[0m[39m%[0m[1;36m65[0m[39m%[0m[1;36m73[0m[39m%[0m[1;36m74.[0m[39mtxtUT ��Dg[0m                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:         ��ە[0m[1;39m][0m[39m?��ڕ[0m[1;39m][0m[39m?��ڕ[0m[1;39m][0m[39m?�PK      k   q     [0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/zip/Lister.jav[0m[1;92ma:51[0m[39m-[0m[1;36m61[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private static void [0m[1;35mextract[0m[1;39m([0m[39mfinal Path targetDir, final ZipArchiveEntry [0m     [2m                [0m
[2;36m                    [0m         [39mentry, final InputStream inputStream[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        final Path outputFile = [0m[1;35mentry.resolveIn[0m[1;39m([0m[39mtargetDir[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        final Path parent = [0m[1;35moutputFile.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        if [0m[1;39m([0m[39mparent != null && ![0m[1;35mFiles.exists[0m[1;39m([0m[39mparent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;35mFiles.copy[0m[1;39m([0m[39minputStream, outputFile[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static void [0m[1;35mlist[0m[1;39m([0m[39mfinal ZipArchiveEntry entry[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/AbstractTest.jav[0m[1;92ma:156[0m[39m-[0m[1;36m168[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            [0m[1;35minputStream.iterator[0m[1;39m([0m[1;39m)[0m[1;35m.forEachRemaining[0m[1;39m([0m[39mentry -> [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:                final Path outputFile = [0m[1;35mentry.resolveIn[0m[1;39m([0m[39mresult[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                long bytesCopied = [0m[1;36m0[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                if [0m[1;39m([0m[1;35mentry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                    [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39moutputFile[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                    [0m[1;35mFiles.createDirectories[0m[1;39m([0m[1;35moutputFile.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:                    bytesCopied = [0m[1;35mFiles.copy[0m[1;39m([0m[39minputStream, outputFile[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                final long size = [0m[1;35mentry.getSize[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                if [0m[1;39m([0m[39msize != ArchiveEntry.SIZE_UNKNOWN[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                    [0m[1;35massertEquals[0m[1;39m([0m[39msize, bytesCopied, [0m[32m"Entry.size should equal [0m   [2m                [0m
[2;36m                    [0m         [32mbytes read."[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:70[0m[39m-[0m[1;36m93[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:70[0m[39m-[0m[1;36m90[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Resolves this entry in the given parent Path.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m                [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @return a resolved and normalized Path.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mURLDecoder.decode[0m[1;39m([0m[39mname, [0m                   [2m                [0m
[2;36m                    [0m         [1;35mStandardCharsets.US_ASCII.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIllegalArgumentException | UnsupportedEncodingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            return outputFile;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:188[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m215[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, ArchiveException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../foo"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPathWithSimilarSibling[0m[1;39m([0m[1;39m)[0m[39m throws [0m            [2m                [0m
[2;36m                    [0m         [39mIOException, ArchiveException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        final String sibling = [0m[1;35mtempResultDir.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"x"[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        final File s = new [0m[1;35mFile[0m[1;39m([0m[1;35mtempResultDir.getParentFile[0m[1;39m([0m[1;39m)[0m[39m, sibling[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[1;35massumeFalse[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;35ms.mkdirs[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        [0m[1;35massumeTrue[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../"[0m[39m + sibling + [0m[32m"/a"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    void [0m[1;35mtestFileCantEscapeViaAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, [0m               [2m                [0m
[2;36m                    [0m         [39mArchiveException [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"/tmp/foo"[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        [0m[1;35massertFalse[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mtempResultDir, [0m[32m"tmp/foo"[0m[1;39m)[0m[1;35m.isFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:70[0m[39m-[0m[1;36m90[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Resolves this entry in the given parent Path.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * @param parentPath the [0m[1;39m{[0m[39m@link Path#[0m[1;35mresolve[0m[1;39m([0m[39mPath[0m[1;39m)[0m[1;39m}[0m[39m receiver.[0m                [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @return a resolved and normalized Path.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @throws IOException if this method detects a Zip slip.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35mparentPath.resolve[0m[1;39m([0m[1;35mURLDecoder.decode[0m[1;39m([0m[39mname, [0m                   [2m                [0m
[2;36m                    [0m         [1;35mStandardCharsets.US_ASCII.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIllegalArgumentException | UnsupportedEncodingException e[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            return outputFile;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:292[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m301[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    public void [0m[1;35mtestURLDecoding[0m[1;39m([0m[39m@TempDir Path output[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        Path input = [0m[1;35mPaths.get[0m[1;39m([0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:                [0m[1;35mExpanderTest.class.getResource[0m[1;39m([0m[32m"/testURLDecoded.zip"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39minput, output[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        File[0m[1;39m[[0m[1;39m][0m[39m files = [0m[1;35moutput.toFile[0m[1;39m([0m[1;39m)[0m[1;35m.listFiles[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m1[0m[39m, files.length[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"test.txt"[0m[39m, files[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m12[0m[39m, [0m[1;35mFiles.size[0m[1;39m([0m[39mfiles[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause of the path traversal vulnerability in the `[0m[1;35mArchiveEntry.resolveIn[0m[1;39m([0m[1;39m)[0m[39m` method [0m [2m                [0m
[2;36m                    [0m         [39mat lines [0m[1;36m78[0m[39m-[0m[1;36m89[0m[39m of [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m`src/main/java/org/apache/commons/compress/archivers/ArchiveEntry.java`.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is a **Time-Of-Check-Time-Of-Use [0m[1;39m([0m[39mTOCTOU[0m[1;39m)[0m[39m** security flaw:[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Line [0m[1;36m80[0m[39m**: Creates and normalizes a path from the non-decoded entry name[0m       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Lines [0m[1;36m81[0m[39m-[0m[1;36m83[0m[39m**: Validates that this path starts with the parent directory [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39msecurity check[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Line [0m[1;36m85[0m[39m**: URL-decodes the name and creates a **different** path that is [0m      [2m                [0m
[2;36m                    [0m         [39mreturned[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Critical Issue**: The decoded path is never validated before being returned[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Attack Vector[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAn attacker can embed URL-encoded path traversal sequences in archive entry names:[0m  [2m                [0m
[2;36m                    [0m         [39m- Entry name: `q/r/s/t/%2E%2E/%2E%2E/jazzer-traversal`[0m                              [2m                [0m
[2;36m                    [0m         [39m- First validation [0m[1;39m([0m[39mline [0m[1;36m80[0m[39m-[0m[1;36m83[0m[1;39m)[0m[39m: Checks the encoded version which appears safe[0m      [2m                [0m
[2;36m                    [0m         [39m- Decoded path [0m[1;39m([0m[39mline [0m[1;36m85[0m[1;39m)[0m[39m: Becomes `q/r/s/t/..[0m[35m/../[0m[95mjazzer-traversal[0m[39m` which can escape[0m [2m                [0m
[2;36m                    [0m         [39mthe parent directory[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why Previous Logic Cannot Be Preserved As-Is[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe current implementation attempts to support URL-encoded filenames [0m[1;39m([0m[39mas shown by [0m  [2m                [0m
[2;36m                    [0m         [39m`testURLDecoding` test case with `testURLDecoded.zip`[0m[1;39m)[0m[39m, but does so insecurely by [0m  [2m                [0m
[2;36m                    [0m         [39mvalidating before decoding. This ordering creates the vulnerability and cannot be [0m  [2m                [0m
[2;36m                    [0m         [39mpreserved.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Patch Location[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File**: `src/main/java/org/apache/commons/compress/archivers/ArchiveEntry.java`  [0m [2m                [0m
[2;36m                    [0m         [39m**Method**: `[0m[1;35mresolveIn[0m[1;39m([0m[39mPath parentPath[0m[1;39m)[0m[39m` at lines [0m[1;36m78[0m[39m-[0m[1;36m89[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Implementation Steps[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Reorder the operations** in the `[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m` method:[0m                          [2m                [0m
[2;36m                    [0m         [39m   - Move URL decoding to occur **before** path resolution and validation[0m           [2m                [0m
[2;36m                    [0m         [39m   - Perform validation on the **decoded** path [0m[1;39m([0m[39mthe actual path that will be used[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m   - Return the validated decoded path[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Maintain error handling** for URL decoding failures:[0m                           [2m                [0m
[2;36m                    [0m         [39m   - If `[0m[1;35mURLDecoder.decode[0m[1;39m([0m[1;39m)[0m[39m` throws an exception, fall back to using the original [0m [2m                [0m
[2;36m                    [0m         [39mnon-decoded name[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - This preserves backward compatibility with archives containing non-URL-encoded[0m [2m                [0m
[2;36m                    [0m         [39mnames[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserve the existing validation logic**:[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Keep the `[0m[1;35mnormalize[0m[1;39m([0m[1;39m)[0m[39m` call to resolve relative path components[0m                [2m                [0m
[2;36m                    [0m         [39m   - Keep the `[0m[1;35mstartsWith[0m[1;39m([0m[1;39m)[0m[39m` check to ensure the path remains within the parent [0m    [2m                [0m
[2;36m                    [0m         [39mdirectory[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - Keep the same exception message format for consistency[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Detailed Implementation Plan[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace the current implementation [0m[1;39m([0m[39mlines [0m[1;36m78[0m[39m-[0m[1;36m89[0m[1;39m)[0m[39m with the following logic:[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Get the entry name via [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Attempt to URL-decode the name:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   a. Try: decodedName = [0m[1;35mURLDecoder.decode[0m[1;39m([0m[39mname, [0m[1;35mStandardCharsets.US_ASCII.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m   b. Catch [0m[1;39m([0m[39mIllegalArgumentException | UnsupportedEncodingException[0m[1;39m)[0m[39m: decodedName [0m [2m                [0m
[2;36m                    [0m         [39m= name[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Resolve and normalize the decoded path: outputFile = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mparentPath.resolve[0m[1;39m([0m[39mdecodedName[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Validate the decoded path: if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m throw [0m        [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Return the validated decoded path[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Approach Is Optimal[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Eliminates TOCTOU vulnerability**: Validation happens on the same path that is[0m [2m                [0m
[2;36m                    [0m         [39mreturned[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Maintains URL decoding functionality**: Legitimate URL-encoded filenames still[0m [2m                [0m
[2;36m                    [0m         [39mwork [0m[1;39m([0m[39msupports `testURLDecoded.zip`[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves existing security checks**: The `[0m[1;35mstartsWith[0m[1;39m([0m[1;39m)[0m[39m` validation remains [0m   [2m                [0m
[2;36m                    [0m         [39mintact[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Backward compatible**: Existing tests continue to pass[0m                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Single point of change**: Fix is localized to one method in the security [0m      [2m                [0m
[2;36m                    [0m         [39mboundary[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **No external dependencies modified**: Only changes internal Apache Commons [0m     [2m                [0m
[2;36m                    [0m         [39mCompress code[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Justification for Not Modifying Other Code[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Harness code [0m[1;39m([0m[39mExpanderFuzzer.java[0m[1;39m)[0m[39m**: Not modified - it's the fuzzing entry [0m   [2m                [0m
[2;36m                    [0m         [39mpoint, not the vulnerability source[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Expander.java lines [0m[1;36m67[0m[39m-[0m[1;36m93[0m[39m**: Not modified - correctly uses `[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m`, [0m     [2m                [0m
[2;36m                    [0m         [39mwhich will be fixed[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Test files**: Not modified - existing tests verify the fix works correctly[0m     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Utility functions**: Not modified - vulnerability is isolated to `[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m`[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Impact Analysis[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Files affected by fix**: Only [0m                                                    [2m                [0m
[2;36m                    [0m         [39m`src/main/java/org/apache/commons/compress/archivers/ArchiveEntry.java`[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Dependent code that benefits** [0m[1;39m([0m[39mno changes needed[0m[1;39m)[0m[39m:[0m                               [2m                [0m
[2;36m                    [0m         [39m- `Expander.java` - automatically protected after fix[0m                               [2m                [0m
[2;36m                    [0m         [39m- `Lister.java` - automatically protected after fix  [0m                               [2m                [0m
[2;36m                    [0m         [39m- `AbstractTest.java` - automatically protected after fix[0m                           [2m                [0m
[2;36m                    [0m         [39m- All archive format implementations using `ArchiveEntry`[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Tests that validate the fix**:[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- `testFileCantEscapeDoubleDotPath` - continues to pass[0m                             [2m                [0m
[2;36m                    [0m         [39m- `testFileCantEscapeDoubleDotPathWithSimilarSibling` - continues to pass[0m           [2m                [0m
[2;36m                    [0m         [39m- `testFileCantEscapeViaAbsolutePath` - continues to pass[0m                           [2m                [0m
[2;36m                    [0m         [39m- `testURLDecoding` - continues to pass [0m[1;39m([0m[39mlegitimate URL-encoded filenames still [0m    [2m                [0m
[2;36m                    [0m         [39mwork[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- Fuzzer test case - will now be properly rejected instead of causing security [0m     [2m                [0m
[2;36m                    [0m         [39missue[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Side Effect**: Archives with URL-encoded path traversal attempts will now [0m     [2m                [0m
[2;36m                    [0m         [39mthrow IOException[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: This is the intended behavior - malicious archives should be [0m  [2m                [0m
[2;36m                    [0m         [39mrejected[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Side Effect**: Error messages will show decoded paths in the exception[0m         [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: This is beneficial for debugging - shows the actual malicious [0m [2m                [0m
[2;36m                    [0m         [39mpath attempt[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Side Effect**: [0m[3;35mNone[0m[39m for legitimate archives with properly encoded filenames[0m    [2m                [0m
[2;36m                    [0m         [39m   - **Confirmation**: The `testURLDecoded.zip` test case validates this continues [0m [2m                [0m
[2;36m                    [0m         [39mto work[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Security Model Preserved[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix maintains the intended security model of `[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m`:[0m                     [2m                [0m
[2;36m                    [0m         [39m- Prevent Zip Slip attacks [0m[1;39m([0m[39mpath traversal outside parent directory[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m- Support legitimate URL-encoded filenames[0m                                          [2m                [0m
[2;36m                    [0m         [39m- Throw IOException with clear error message when attacks are detected[0m              [2m                [0m
[2;36m                    [0m         [39m- Maintain API compatibility [0m[1;39m([0m[39msame method signature, same return type, same [0m        [2m                [0m
[2;36m                    [0m         [39mexceptions[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=469686;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=767016;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=694693;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=636695;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpvljjrnvi[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-de[0m [2m               [0m
[2;36m                    [0m         [35mlta-04_vuln_6/[0m[95magent-output-1768134522.9952588[0m                                        [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-commons-compress_cc-delta-04_vuln_6.toml     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/11/26 12:28:45][0m[2;36m [0m[34mINFO    [0m Deleting environments directory:                                                     ]8;id=224957;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=822079;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/.cache/environments/[0m[95mapache-commons-compress[0m                         [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=44316;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=874237;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-commons-compre[0m [2m               [0m
[2;36m                    [0m         [95mss[0m                                                                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=571003;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=197769;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-commons-compres[0m [2m               [0m
[2;36m                    [0m         [95ms[0m                                                                                    [2m               [0m
