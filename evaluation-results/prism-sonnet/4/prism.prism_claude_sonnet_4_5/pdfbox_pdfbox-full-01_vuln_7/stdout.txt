[2;36m[01/12/26 01:30:39][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=777299;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=779988;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpxltmmefu[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_7/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768181439.8920565[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-full-01_vuln_7.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=618746;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=394049;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:31:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Took      ]8;id=756829;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=332667;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m78.18[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=680143;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=542374;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=644207;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=250244;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=501633;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=577741;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m78[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=300637;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=529172;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:31:59][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.90[0m seconds;                ]8;id=191826;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=28397;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 01:32:00][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=71144;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=719065;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=725615;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=341887;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=14304;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=703528;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=932467;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=678740;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:32:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m1.13[0m seconds;                ]8;id=605977;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=481251;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=188178;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=302130;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:32:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.89[0m seconds;                ]8;id=243994;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=189332;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 01:32:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=262481;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=952414;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:32:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.96[0m seconds;                ]8;id=214631;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=934194;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running a pov[1m)[0m Started[33m...[0m                         ]8;id=739165;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=8974;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:33:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running a pov[1m)[0m Took [1;36m30.51[0m seconds;               ]8;id=485447;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=101099;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;92mTrue[0m                                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m Crash analysis results is empty. This should not happen.                              ]8;id=755503;file:///home/user/crete/packages/crete/commons/crash_analysis/functions/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=425026;file:///home/user/crete/packages/crete/commons/crash_analysis/functions/__init__.py#41\[2m41[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=884786;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=584341;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:33:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.93[0m seconds;                ]8;id=798334;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=162014;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 01:33:37][0m[2;36m [0m[34mINFO    [0m Found jstack output at                                                                ]8;id=351367;file:///home/user/crete/packages/crete/framework/analyzer/services/jvm_timeout_stacktrace/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=503502;file:///home/user/crete/packages/crete/framework/analyzer/services/jvm_timeout_stacktrace/__init__.py#43\[2m43[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/pdfbox/[0m[95mjstack.txt[0m       [2m              [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=237184;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=291166;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/12/26 01:33:58][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=609357;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=559810;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/12/26 01:39:12][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=524031;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=378811;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/12/26 01:41:51][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=772542;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=773605;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=24559;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=867835;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:41:52][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.98[0m seconds;                ]8;id=646711;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=759362;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Started[33m...[0m                              ]8;id=807033;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=76028;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp0i42wmsf[0m                                                 ]8;id=592720;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=420163;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/12/26 01:42:51][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Took [1;36m58.43[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=916795;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=227390;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Started[33m...[0m                        ]8;id=453389;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=666429;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:43:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Took [1;36m14.66[0m seconds;              ]8;id=335580;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=40872;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Started[33m...[0m                           ]8;id=235414;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=52580;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:43:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Took [1;36m5.52[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=262336;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=304272;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Started[33m...[0m                               ]8;id=335262;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=975182;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=165242;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=537574;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=748052;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=578903;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:43:12][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.86[0m seconds;                ]8;id=205661;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=683879;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/12/26 01:43:13][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=676599;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=987959;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:43:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.94[0m seconds;                ]8;id=40699;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=417608;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=858474;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=453550;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 01:43:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.91[0m seconds;                ]8;id=670015;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=609511;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=567463;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=218533;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java               [2m                [0m
[2;36m                    [0m         +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java               [2m                [0m
[2;36m                    [0m         @@ [1;36m-219[0m,[1;36m7[0m +[1;36m219[0m,[1;36m9[0m @@                                                                 [2m                [0m
[2;36m                    [0m                                      || [1;35mlexer.peekToken[0m[1m([0m[1m)[0m[1;35m.getText[0m[1m([0m[1m)[0m[1;35m.equals[0m[1m([0m[32m"readonly"[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                                      || [1;35mlexer.peekToken[0m[1m([0m[1m)[0m[1;35m.getText[0m[1m([0m[1m)[0m[1;35m.equals[0m[1m([0m[32m"def"[0m[1m)[0m[1m)[0m[1m)[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                      [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -                [1;35mlexer.nextToken[0m[1m([0m[1m)[0m;                                                 [2m                [0m
[2;36m                    [0m         +                if [1m([0m[1;35mlexer.nextToken[0m[1m([0m[1m)[0m == null[1m)[0m [1m{[0m                                   [2m                [0m
[2;36m                    [0m         +                    throw new [1;35mIOException[0m[1m([0m[32m"Should have found dup, readonly or [0m     [2m                [0m
[2;36m                    [0m         [32mdef?! EOF?"[0m[1m)[0m;                                                                       [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m                      [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                      Map[1m<[0m[1;95mInteger[0m[39m, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-559[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m561[0m[39m,[0m[1;36m9[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m for a more thorough validation, the presence of [0m[32m"begin"[0m[39m before [0m     [2m                [0m
[2;36m                    [0m         [39mPrivate[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m determines how code before and following charstrings should look[0m    [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m it is not currently checked anyway[0m                                  [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unexpected EOF while searching for /Private[0m [2m                [0m
[2;36m                    [0m         [32mdict"[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m             peekToken = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39mpeekToken == null[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-640[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m644[0m[39m,[0m[1;36m9[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m         while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m                 && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unexpected EOF while searching for [0m         [2m                [0m
[2;36m                    [0m         [32m/CharStrings dict"[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-707[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m713[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m allocate size [0m[1;39m([0m[39marray indexes may not be in-order[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m         int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39mlength < [0m[1;36m0[0m[39m || length > [0m[1;36m65536[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid Subrs array length: "[0m[39m + length[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mfont.subrs.add[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-777[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m787[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m     private void [0m[1;35mreadCharStrings[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m         int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39mlength < [0m[1;36m0[0m[39m || length > [0m[1;36m65536[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid CharStrings dict length: "[0m[39m + length[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dict"[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m could actually be a sequence ending in [0m[32m"CharStrings begin"[0m[39m, too[0m         [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m instead of the [0m[32m"dup begin"[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m              [2m                [0m
[2;36m                    [0m         [39m+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m              [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-23[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m23[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m import java.util.Map;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m import java.util.Optional;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m import java.util.Map.Entry;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m+import java.util.Set;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m import org.apache.logging.log4j.LogManager;[0m                                        [2m                [0m
[2;36m                    [0m         [39m import org.apache.logging.log4j.Logger;[0m                                            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-98[0m[39m,[0m[1;36m17[0m[39m +[0m[1;36m99[0m[39m,[0m[1;36m19[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mdocument.setStartXref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m         long prev = startXrefOffset;[0m                                               [2m                [0m
[2;36m                    [0m         [39m-        [0m[35m/[0m[35m/[0m[95mlastPrev[0m[39m prevents potential infinite loops in crafted files[0m              [2m                [0m
[2;36m                    [0m         [39m-        long lastPrev = [0m[1;36m-1[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m ---- parse whole chain of xref tables/object streams using PREV [0m        [2m                [0m
[2;36m                    [0m         [39mreference[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        Set<Long> prevSet = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m         COSDictionary trailer = null;[0m                                              [2m                [0m
[2;36m                    [0m         [39m-        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-            lastPrev = prev;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            [0m[35m/[0m[35m/[0m[39m save expected position for loop detection[0m                           [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mprevSet.add[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m skip white spaces[0m                                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+            [0m[35m/[0m[35m/[0m[39m save current position as well due to skipped spaces[0m                 [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mprevSet.add[0m[1;39m([0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m -- parse xref[0m                                                       [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m == X[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-170[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m173[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m                     [0m[1;35mtrailer.setLong[0m[1;39m([0m[39mCOSName.PREV, prev[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-            if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[1;35mprevSet.contains[0m[1;39m([0m[39mprev[0m[1;39m)[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m                 throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m                [2m                [0m
[2;36m                    [0m         [39m+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m                [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-18[0m[39m,[0m[1;36m8[0m[39m +[0m[1;36m18[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m import java.util.ArrayDeque;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m import java.util.Collections;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+import java.util.HashSet;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m import java.util.Iterator;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+import java.util.List;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m import java.util.Queue;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+import java.util.Set;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m import org.apache.pdfbox.cos.COSArray;[0m                                             [2m                [0m
[2;36m                    [0m         [39m import org.apache.pdfbox.cos.COSBase;[0m                                              [2m                [0m
[2;36m                    [0m         [39m import org.apache.pdfbox.cos.COSDictionary;[0m                                        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-180[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m183[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m     private final class PageIterator implements Iterator<PDPage>[0m                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m         private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m+        private Set<COSDictionary> seen = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         private [0m[1;35mPageIterator[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-205[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m209[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m          *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         private List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[1;35mseen.contains[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Found an infinite loop in the page tree"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m+                return [0m[1;35mCollections.emptyList[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mseen.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m                 return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mERROR: libFuzzer: timeout[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA timeout error has been detected during fuzzing operations with libFuzzer. The [0m    [2m                [0m
[2;36m                    [0m         [39mfuzzer has identified an execution path or input that causes the program to exceed [0m [2m                [0m
[2;36m                    [0m         [39mthe configured timeout threshold, indicating a potential infinite loop, excessive [0m  [2m                [0m
[2;36m                    [0m         [39mcomputation, or algorithmic complexity issue in the codebase under test.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue manifests as a libFuzzer timeout error, which occurs when the fuzzer [0m     [2m                [0m
[2;36m                    [0m         [39mfeeds input to the target program that causes execution to exceed the predefined [0m   [2m                [0m
[2;36m                    [0m         [39mtime limit [0m[1;39m([0m[39mtypically a few seconds[0m[1;39m)[0m[39m. This indicates that the codebase contains at [0m [2m                [0m
[2;36m                    [0m         [39mleast one code path that can result in unexpectedly long execution times.[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### What the Issue Is[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe timeout error signifies that:[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- The fuzzer successfully generated an input that triggers prolonged execution in [0m  [2m                [0m
[2;36m                    [0m         [39mthe target code[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- The execution time exceeded libFuzzer's timeout threshold before completing[0m       [2m                [0m
[2;36m                    [0m         [39m- The program likely entered a computationally expensive operation, infinite or [0m    [2m                [0m
[2;36m                    [0m         [39mnear-infinite loop, or experienced algorithmic complexity issues with certain [0m      [2m                [0m
[2;36m                    [0m         [39minputs[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m- This represents a potential Denial of Service [0m[1;39m([0m[39mDoS[0m[1;39m)[0m[39m vulnerability, as malicious [0m  [2m                [0m
[2;36m                    [0m         [39mactors could craft inputs that cause the application to hang or become unresponsive[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis is classified as a **Denial of Service [0m[1;39m([0m[39mDoS[0m[1;39m)[0m[39m** vulnerability, specifically:[0m    [2m                [0m
[2;36m                    [0m         [39m- **Algorithmic Complexity Attack**: Where specially crafted inputs trigger [0m        [2m                [0m
[2;36m                    [0m         [39mworst-case algorithmic behavior[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- **Resource Exhaustion**: Where processing certain inputs consumes excessive CPU [0m  [2m                [0m
[2;36m                    [0m         [39mtime[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m- **Hang/Freeze Condition**: Where the application becomes unresponsive due to [0m     [2m                [0m
[2;36m                    [0m         [39mprolonged execution[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Important Observations[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Reproducibility**: LibFuzzer typically saves the input that triggered the [0m     [2m                [0m
[2;36m                    [0m         [39mtimeout, allowing for reproduction and debugging of the issue[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Severity**: While not typically leading to memory corruption or code [0m          [2m                [0m
[2;36m                    [0m         [39mexecution, timeout issues can be exploited to make services unavailable[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Input Dependency**: The timeout is triggered by specific input patterns [0m       [2m                [0m
[2;36m                    [0m         [39mgenerated by the fuzzer, suggesting input validation or handling logic may be [0m      [2m                [0m
[2;36m                    [0m         [39minvolved[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Non-terminating Behavior**: The code path affected does not complete within [0m   [2m                [0m
[2;36m                    [0m         [39mreasonable time bounds[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a holistic understanding of this issue, the following parts of the codebase[0m [2m                [0m
[2;36m                    [0m         [39mshould be investigated:[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Input Processing Functions**: Examine all functions that directly process or [0m  [2m                [0m
[2;36m                    [0m         [39mparse input data, particularly:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - Parsers and deserializers[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - Input validation routines[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - Data transformation functions[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Loop Constructs**: Identify and review all loops in the execution path, [0m       [2m                [0m
[2;36m                    [0m         [39mfocusing on:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   - Loop termination conditions[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - Iterator increments/decrements[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - While loops that depend on input data[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Recursive functions that might not have proper base cases[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Algorithmic Complexity**: Analyze algorithms used for:[0m                         [2m                [0m
[2;36m                    [0m         [39m   - String operations [0m[1;39m([0m[39mpattern matching, searching, replacing[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Collection operations [0m[1;39m([0m[39msorting, searching, filtering[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m   - Graph or tree traversals[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - Mathematical computations[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Resource-Intensive Operations**: Review code sections involving:[0m               [2m                [0m
[2;36m                    [0m         [39m   - Regular expression matching with complex patterns[0m                              [2m                [0m
[2;36m                    [0m         [39m   - Nested loops with input-dependent bounds[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - Backtracking algorithms[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - Dynamic programming solutions without memoization[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **State Management**: Examine state machines or stateful processing logic that [0m  [2m                [0m
[2;36m                    [0m         [39mmight:[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - Enter invalid states[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - Fail to progress through expected state transitions[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Get stuck in specific state combinations[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Dependency Libraries**: Check if third-party libraries or dependencies are [0m    [2m                [0m
[2;36m                    [0m         [39minvolved in the timeout path, as they might contain their own complexity issues[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **The Fuzzer-Generated Input**: Analyze the specific input that triggered the [0m   [2m                [0m
[2;36m                    [0m         [39mtimeout to understand:[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - Input characteristics [0m[1;39m([0m[39msize, structure, patterns[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m   - What makes this input special or pathological[0m                                  [2m                [0m
[2;36m                    [0m         [39m   - Common patterns across multiple timeout-triggering inputs[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mERROR: libFuzzer: timeout[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.jav[0m[1;92ma:19[0m[39m-[0m[1;36m54[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.security.GeneralSecurityException;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.security.KeyStore;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.pdfbox.cos.COSArray;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.pdfbox.cos.COSBase;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.pdfbox.cos.COSDictionary;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.pdfbox.cos.COSDocument;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.pdfbox.cos.COSName;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.pdfbox.cos.COSNull;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.pdfbox.cos.COSNumber;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.pdfbox.cos.COSObject;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.pdfbox.cos.COSObjectKey;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.pdfbox.cos.COSStream;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.pdfbox.cos.ICOSParser;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.pdfbox.io.IOUtils;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.pdfbox.io.RandomAccessRead;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.pdfbox.io.RandomAccessReadView;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.pdfbox.io.RandomAccessStreamCache.StreamCacheCreateFunction;[0m   [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.pdfbox.pdmodel.encryption.AccessPermission;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.pdfbox.pdmodel.encryption.DecryptionMaterial;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.pdfbox.pdmodel.encryption.InvalidPasswordException;[0m            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.pdfbox.pdmodel.encryption.PDEncryption;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.pdfbox.pdmodel.encryption.ProtectionPolicy;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.pdfbox.pdmodel.encryption.PublicKeyDecryptionMaterial;[0m         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.pdfbox.pdmodel.encryption.SecurityHandler;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.apache.pdfbox.pdmodel.encryption.StandardDecryptionMaterial;[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.jav[0m[1;92ma:62[0m[39m-[0m[1;36m192[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:public class COSParser extends BaseParser implements ICOSParser[0m                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    private static final String PDF_[0m[1;33mHEAD[0m[39mER = [0m[32m"%PDF-"[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private static final String FDF_[0m[1;33mHEAD[0m[39mER = [0m[32m"%FDF-"[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private static final String PDF_DEFAULT_VERSION = [0m[32m"1.4"[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private static final String FDF_DEFAULT_VERSION = [0m[32m"1.0"[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    private static final char[0m[1;39m[[0m[1;39m][0m[39m STARTXREF = [0m[1;39m{[0m[39m [0m                                   [2m                [0m
[2;36m                    [0m         [32m's'[0m[39m,[0m[32m't'[0m[39m,[0m[32m'a'[0m[39m,[0m[32m'r'[0m[39m,[0m[32m't'[0m[39m,[0m[32m'x'[0m[39m,[0m[32m'r'[0m[39m,[0m[32m'e'[0m[39m,[0m[32m'f'[0m[39m [0m[1;39m}[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    private static final byte[0m[1;39m[[0m[1;39m][0m[39m ENDSTREAM = [0m[1;39m{[0m[39m E, N, D, S, T, R, E, A, M [0m[1;39m}[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    private static final byte[0m[1;39m[[0m[1;39m][0m[39m ENDOBJ = [0m[1;39m{[0m[39m E, N, D, O, B, J [0m[1;39m}[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    protected static final long MINIMUM_SEARCH_OFFSET = [0m[1;36m6[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private static final int STRMBUFLEN = [0m[1;36m2048[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    private final byte[0m[1;39m[[0m[1;39m][0m[39m strmBuf = new byte[0m[1;39m[[0m[39m STRMBUFLEN [0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private AccessPermission accessPermission;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private InputStream keyStoreInputStream = null;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[1;39m{[0m[32m"squid:S2068"[0m[1;39m}[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    private String password = [0m[32m""[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private String keyAlias = null;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     * The range within the %%EOF marker will be searched.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * Useful if there are additional characters after %%EOF within the PDF. [0m    [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    public static final String SYSPROP_EOFLOOKUPRANGE =[0m                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[32m"org.apache.pdfbox.pdfparser.nonSequentialPDFParser.eofLookupRange"[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     * How many trailing bytes to read for EOF marker.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    private static final int DEFAULT_TRAIL_BYTECOUNT = [0m[1;36m2048[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * EOF-marker.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    private static final char[0m[1;39m[[0m[1;39m][0m[39m EOF_MARKER = [0m[1;39m{[0m[39m [0m[32m'%'[0m[39m, [0m[32m'%'[0m[39m, [0m[32m'E'[0m[39m, [0m[32m'O'[0m[39m, [0m[32m'F'[0m[39m [0m[1;39m}[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:     * obj-marker.[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    private static final char[0m[1;39m[[0m[1;39m][0m[39m OBJ_MARKER = [0m[1;39m{[0m[39m [0m[32m'o'[0m[39m, [0m[32m'b'[0m[39m, [0m[32m'j'[0m[39m [0m[1;39m}[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:     * file length.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    private final long fileLen;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:     * is parser using auto healing capacity ?[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    private boolean isLenient = true;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    protected boolean initialParseDone = false;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    private boolean trailerWasRebuild = false;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    private BruteForceParser bruteForceParser = null;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    private PDEncryption encryption = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    private final Map<COSObjectKey, Long> xrefTable = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:     * Intermediate cache. Contains all objects of already read compressed [0m     [2m                [0m
[2;36m                    [0m         [39mobject streams. Objects are removed after[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:     * dereferencing them.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    private final Map<Long, Map<COSObjectKey, COSBase>> decompressedObjects = [0m  [2m                [0m
[2;36m                    [0m         [39mnew HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:     * The security handler.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    private SecurityHandler<ProtectionPolicy> securityHandler = null;[0m           [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:     *  how many trailing bytes to read for EOF marker.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    private int readTrailBytes = DEFAULT_TRAIL_BYTECOUNT; [0m                      [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mCOSParser.class[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:     * Default constructor.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:     * @param source input representing the pdf.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:     * @throws IOException if something went wrong[0m                              [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    public [0m[1;35mCOSParser[0m[1;39m([0m[39mRandomAccessRead source[0m[1;39m)[0m[39m throws IOException[0m                [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39msource, null, null, null[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:     * Constructor for encrypted pdfs.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:     * @param source input representing the pdf.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:     * @param password password to be used for decryption.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:     * @param keyStore key store to be used for decryption when using public [0m   [2m                [0m
[2;36m                    [0m         [39mkey security[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:     * @param keyAlias alias to be used for decryption when using public key [0m   [2m                [0m
[2;36m                    [0m         [39msecurity[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:     * @throws IOException if the source data could not be read[0m                 [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    public [0m[1;35mCOSParser[0m[1;39m([0m[39mRandomAccessRead source, String password, InputStream [0m     [2m                [0m
[2;36m                    [0m         [39mkeyStore,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            String keyAlias[0m[1;39m)[0m[39m throws IOException[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39msource, password, keyStore, keyAlias, null[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:     * Constructor for encrypted pdfs.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:     * @param source input representing the pdf.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:     * @param password password to be used for decryption.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:     * @param keyStore key store to be used for decryption when using public [0m   [2m                [0m
[2;36m                    [0m         [39mkey security[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:     * @param keyAlias alias to be used for decryption when using public key [0m   [2m                [0m
[2;36m                    [0m         [39msecurity[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:     * @param streamCacheCreateFunction a function to create an instance of the[0m [2m                [0m
[2;36m                    [0m         [39mstream cache[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:     * @throws IOException if the source data could not be read[0m                 [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    public [0m[1;35mCOSParser[0m[1;39m([0m[39mRandomAccessRead source, String password, InputStream [0m     [2m                [0m
[2;36m                    [0m         [39mkeyStore,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:            String keyAlias, StreamCacheCreateFunction [0m                         [2m                [0m
[2;36m                    [0m         [39mstreamCacheCreateFunction[0m[1;39m)[0m[39m throws IOException[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39msource[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        this.password = password;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        this.keyAlias = keyAlias;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:        fileLen = [0m[1;35msource.length[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        keyStoreInputStream = keyStore;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        [0m[1;35minit[0m[1;39m([0m[39mstreamCacheCreateFunction[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.jav[0m[1;92ma:793[0m[39m-[0m[1;36m885[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:    private long [0m[1;35mreadUntilEndStream[0m[1;39m([0m[39mfinal EndstreamFilterStream out[0m[1;39m)[0m[39m throws [0m    [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:        int bufSize;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:        int charMatchCount = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m keyw = ENDSTREAM;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:        [0m[35m/[0m[35m/[0m[39m last character position of shortest keyword [0m[1;39m([0m[32m'endobj'[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:        final int quickTestOffset = [0m[1;36m5[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:        [0m[35m/[0m[35m/[0m[39m read next chunk into buffer; already matched chars are added to [0m     [2m                [0m
[2;36m                    [0m         [39mbeginning of buffer[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:        while [0m[1;39m([0m[39m [0m[1;39m([0m[39m bufSize = [0m[1;35msource.read[0m[1;39m([0m[39m strmBuf, charMatchCount, STRMBUFLEN - [0m [2m                [0m
[2;36m                    [0m         [39mcharMatchCount [0m[1;39m)[0m[39m [0m[1;39m)[0m[39m > [0m[1;36m0[0m[39m [0m[1;39m)[0m[39m [0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:            bufSize += charMatchCount;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:            int bIdx = charMatchCount;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:            int quickTestIdx;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:            [0m[35m/[0m[35m/[0m[39m iterate over buffer, trying to find keyword match[0m                [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:            for [0m[1;39m([0m[39m int maxQuicktestIdx = bufSize - quickTestOffset; bIdx < [0m      [2m                [0m
[2;36m                    [0m         [39mbufSize; bIdx++ [0m[1;39m)[0m[39m [0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:                [0m[35m/[0m[35m/[0m[39m reduce compare operations by first test last character we [0m   [2m                [0m
[2;36m                    [0m         [39mwould have to[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:                [0m[35m/[0m[35m/[0m[39m match if current one matches; if it is not a character from [0m [2m                [0m
[2;36m                    [0m         [39mkeywords[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:                [0m[35m/[0m[35m/[0m[39m we can move behind the test character; this shortcut is [0m     [2m                [0m
[2;36m                    [0m         [39minspired by the [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:                [0m[35m/[0m[35m/[0m[39m Boyer-Moore string search algorithm and can reduce parsing [0m  [2m                [0m
[2;36m                    [0m         [39mtime by approx. [0m[1;36m20[0m[39m%[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:                quickTestIdx = bIdx + quickTestOffset;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:                if [0m[1;39m([0m[39mcharMatchCount == [0m[1;36m0[0m[39m && quickTestIdx < maxQuicktestIdx[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:                [0m[1;39m{[0m[39m                    [0m                                           [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:                    final byte ch = strmBuf[0m[1;39m[[0m[39mquickTestIdx[0m[1;39m][0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:                    if [0m[1;39m([0m[39m [0m[1;39m([0m[39m ch > [0m[32m't'[0m[39m [0m[1;39m)[0m[39m || [0m[1;39m([0m[39m ch < [0m[32m'a'[0m[39m [0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m                        [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:                        [0m[35m/[0m[35m/[0m[39m last character we would have to match if current [0m    [2m                [0m
[2;36m                    [0m         [39mcharacter would match[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:                        [0m[35m/[0m[35m/[0m[39m is not a character from keywords -> jump behind and [0m [2m                [0m
[2;36m                    [0m         [39mstart over[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:                        bIdx = quickTestIdx;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:                        continue;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:                [0m[35m/[0m[35m/[0m[39m could be negative - but we only compare to ASCII[0m             [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:                final byte ch = strmBuf[0m[1;39m[[0m[39mbIdx[0m[1;39m][0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                if [0m[1;39m([0m[39m ch == keyw[0m[1;39m[[0m[39m charMatchCount [0m[1;39m][0m[39m [0m[1;39m)[0m[39m [0m                            [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:                    if [0m[1;39m([0m[39m ++charMatchCount == keyw.length [0m[1;39m)[0m[39m [0m                     [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m837[0m[39m:                        [0m[35m/[0m[35m/[0m[39m match found[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:                        bIdx++;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:                [0m[1;39m}[0m[39m [0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:                else [0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:                    if [0m[1;39m([0m[39m [0m[1;39m([0m[39m charMatchCount == [0m[1;36m3[0m[39m [0m[1;39m)[0m[39m && [0m[1;39m([0m[39m ch == ENDOBJ[0m[1;39m[[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39mcharMatchCount [0m[1;39m][0m[39m [0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:                        [0m[35m/[0m[35m/[0m[39m maybe ENDSTREAM is missing but we could have ENDOBJ[0m  [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:                        keyw = ENDOBJ;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:                        charMatchCount++;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:                    [0m[1;39m}[0m[39m [0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:                    else [0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:                        [0m[35m/[0m[35m/[0m[39m no match; incrementing match start by [0m[1;36m1[0m[39m would be [0m    [2m                [0m
[2;36m                    [0m         [39mdumb since we already know [0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m853[0m[39m:                        [0m[35m/[0m[35m/[0m[39m matched chars depending on current char read we may [0m [2m                [0m
[2;36m                    [0m         [39malready have beginning [0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:                        [0m[35m/[0m[35m/[0m[39m of a new match: [0m[32m'e'[0m[39m: first char matched; [0m[32m'n'[0m[39m: if we [0m [2m                [0m
[2;36m                    [0m         [39mare at match position [0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:                        [0m[35m/[0m[35m/[0m[39m idx [0m[1;36m7[0m[39m we already read [0m[32m'e'[0m[39m thus [0m[1;36m2[0m[39m chars matched for [0m  [2m                [0m
[2;36m                    [0m         [39meach other char we have [0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:                        [0m[35m/[0m[35m/[0m[39m to start matching first keyword char beginning with [0m [2m                [0m
[2;36m                    [0m         [39mnext read position[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:                        charMatchCount = [0m[1;39m([0m[39m ch == E [0m[1;39m)[0m[39m ? [0m[1;36m1[0m[39m : [0m[1;39m([0m[39m [0m[1;39m([0m[39m ch == N [0m[1;39m)[0m[39m && [0m[1;39m([0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mcharMatchCount == [0m[1;36m7[0m[39m [0m[1;39m)[0m[39m [0m[1;39m)[0m[39m ? [0m[1;36m2[0m[39m : [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:                        [0m[35m/[0m[35m/[0m[39m search again for [0m[32m'endstream'[0m                         [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:                        keyw = ENDSTREAM;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:                [0m[1;39m}[0m[39m [0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:            int contentBytes = [0m[1;35mMath.max[0m[1;39m([0m[39m [0m[1;36m0[0m[39m, bIdx - charMatchCount [0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:            [0m[35m/[0m[35m/[0m[39m write buffer content until first matched char to output stream[0m   [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:            if [0m[1;39m([0m[39m contentBytes > [0m[1;36m0[0m[39m [0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:                [0m[1;35mout.filter[0m[1;39m([0m[39mstrmBuf, [0m[1;36m0[0m[39m, contentBytes[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:            if [0m[1;39m([0m[39m charMatchCount == keyw.length [0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:                [0m[35m/[0m[35m/[0m[39m keyword matched; unread matched keyword [0m[1;39m([0m[39mendstream/endobj[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mand following buffered content[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:                [0m[1;35msource.rewind[0m[1;39m([0m[39m bufSize - contentBytes [0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:            [0m[1;39m}[0m[39m [0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:            else [0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:                [0m[35m/[0m[35m/[0m[39m copy matched chars at start of buffer[0m                        [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:                [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39m keyw, [0m[1;36m0[0m[39m, strmBuf, [0m[1;36m0[0m[39m, charMatchCount [0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:            [0m[1;39m}[0m[39m            [0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:        [0m[35m/[0m[35m/[0m[39m this writes a lonely CR or drops trailing CR LF and LF[0m               [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:        return [0m[1;35mout.calculateLength[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.jav[0m[1;92ma:89[0m[39m-[0m[1;36m195[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    public COSDictionary [0m[1;35mparseXref[0m[1;39m([0m[39mCOSDocument document, long startXRefOffset[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mthrows IOException[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[1;35msource.seek[0m[1;39m([0m[39mstartXRefOffset[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        long startXrefOffset = [0m[1;35mMath.max[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;35mparseStartXref[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[35m/[0m[35m/[0m[39m check the startxref offset[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        long fixedOffset = [0m[1;35mcheckXRefOffset[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            startXrefOffset = fixedOffset;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;35mdocument.setStartXref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        long prev = startXrefOffset;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        [0m[35m/[0m[35m/[0m[95mlastPrev[0m[39m prevents potential infinite loops in crafted files[0m           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        long lastPrev = [0m[1;36m-1[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[35m/[0m[35m/[0m[39m ---- parse whole chain of xref tables/object streams using PREV [0m     [2m                [0m
[2;36m                    [0m         [39mreference[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        COSDictionary trailer = null;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            lastPrev = prev;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[35m/[0m[35m/[0m[39m skip white spaces[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[35m/[0m[35m/[0m[39m -- parse xref[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            if [0m[1;39m([0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m == X[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                [0m[35m/[0m[35m/[0m[39m xref table and trailer[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[35m/[0m[35m/[0m[39m use existing parser to parse xref table[0m                      [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mparseXrefTable[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m || ![0m[1;35mparseTrailer[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Expected trailer object at offset "[0m  [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:                            + [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                [0m[35m/[0m[35m/[0m[39m check for a XRef stream, it may contain some object ids of [0m  [2m                [0m
[2;36m                    [0m         [39mcompressed objects [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:                [0m[1;35mif[0m[1;39m([0m[1;35mtrailer.containsKey[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:                    int streamOffset = [0m[1;35mtrailer.getInt[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:                    [0m[35m/[0m[35m/[0m[39m check the xref stream reference[0m                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:                    fixedOffset = [0m[1;35mcheckXRefOffset[0m[1;39m([0m[39mstreamOffset[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:                    if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[39m && fixedOffset != streamOffset[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                        [0m[1;35mLOG.warn[0m[1;39m([0m[32m"/XRefStm offset [0m[32m{[0m[32m}[0m[32m is incorrect, corrected to[0m [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m, streamOffset,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                                fixedOffset[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                        streamOffset = [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mfixedOffset;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                        [0m[1;35mtrailer.setInt[0m[1;39m([0m[39mCOSName.XREF_STM, streamOffset[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:                    if [0m[1;39m([0m[39mstreamOffset > [0m[1;36m0[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                        [0m[1;35msource.seek[0m[1;39m([0m[39mstreamOffset[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                        [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                        try[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:                            [0m[1;35mparseXrefObjStream[0m[1;39m([0m[39mprev, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:                            [0m[1;35mdocument.setHasHybridXRef[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:                        catch [0m[1;39m([0m[39mIOException ex[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                            [0m[1;35mLOG.error[0m[1;39m([0m[32m"Failed to parse /XRefStm at offset "[0m[39m + [0m  [2m                [0m
[2;36m                    [0m         [39mstreamOffset, ex[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                        [0m[1;35mLOG.error[0m[1;39m([0m[32m"Skipped XRef stream due to a corrupt offset:[0m [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m, streamOffset[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                prev = [0m[1;35mtrailer.getLong[0m[1;39m([0m[39mCOSName.PREV[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[35m/[0m[35m/[0m[39m parse xref stream[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                prev = [0m[1;35mparseXrefObjStream[0m[1;39m([0m[39mprev, true[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            if [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                [0m[35m/[0m[35m/[0m[39m check the xref table reference[0m                               [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                fixedOffset = [0m[1;35mcheckXRefOffset[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[39m && fixedOffset != prev[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                    prev = fixedOffset;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                    [0m[1;35mtrailer.setLong[0m[1;39m([0m[39mCOSName.PREV, prev[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        [0m[35m/[0m[35m/[0m[39m ---- build valid xrefs out of the xref chain[0m                         [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[1;35mxrefTrailerResolver.setStartxref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:        trailer = [0m[1;35mxrefTrailerResolver.getTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        [0m[1;35mdocument.setTrailer[0m[1;39m([0m[39mtrailer[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        [0m[1;35mdocument.setIsXRefStream[0m[1;39m([0m[39mXRefType.STREAM == [0m                            [2m                [0m
[2;36m                    [0m         [1;35mxrefTrailerResolver.getXrefType[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        [0m[35m/[0m[35m/[0m[39m check the offsets of all referenced objects[0m                          [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        [0m[1;35mcheckXrefOffsets[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        [0m[35m/[0m[35m/[0m[39m copy xref table[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        [0m[1;35mdocument.addXRefTable[0m[1;39m([0m[1;35mxrefTrailerResolver.getXrefTable[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:        [0m[35m/[0m[35m/[0m[39m remember the highest XRef object number to avoid it being reused in [0m [2m                [0m
[2;36m                    [0m         [39mincremental saving[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        Optional<Long> maxValue = [0m[1;35mdocument.getXrefTable[0m[1;39m([0m[1;39m)[0m[1;35m.keySet[0m[1;39m([0m[1;39m)[0m[1;35m.stream[0m[1;39m([0m[1;39m)[0m[39m [0m[35m/[0m[35m/[0m  [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                [0m[1;35m.map[0m[1;39m([0m[39mCOSObjectKey::getNumber[0m[1;39m)[0m[39m [0m[35m/[0m[35m/[0m                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                [0m[1;35m.reduce[0m[1;39m([0m[39mLong::max[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;35mdocument.setHighestXRefObjectNumber[0m[1;39m([0m[1;35mmaxValue.isPresent[0m[1;39m([0m[1;39m)[0m[39m ? [0m             [2m                [0m
[2;36m                    [0m         [1;35mmaxValue.get[0m[1;39m([0m[1;39m)[0m[39m : [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        return trailer;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BruteForceParser.jav[0m[1;92ma:45[0m[39m-[0m[1;36m217[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:public class BruteForceParser[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    private static final char[0m[1;39m[[0m[1;39m][0m[39m XREF_TABLE = [0m[1;39m{[0m[39m [0m[32m'x'[0m[39m, [0m[32m'r'[0m[39m, [0m[32m'e'[0m[39m, [0m[32m'f'[0m[39m [0m[1;39m}[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    private static final char[0m[1;39m[[0m[1;39m][0m[39m XREF_STREAM = [0m[1;39m{[0m[39m [0m[32m'/'[0m[39m, [0m[32m'X'[0m[39m, [0m[32m'R'[0m[39m, [0m[32m'e'[0m[39m, [0m[32m'f'[0m[39m [0m[1;39m}[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    private static final long MINIMUM_SEARCH_OFFSET = [0m[1;36m6[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * EOF-marker.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private static final char[0m[1;39m[[0m[1;39m][0m[39m EOF_MARKER = [0m[1;39m{[0m[39m [0m[32m'%'[0m[39m, [0m[32m'%'[0m[39m, [0m[32m'E'[0m[39m, [0m[32m'O'[0m[39m, [0m[32m'F'[0m[39m [0m[1;39m}[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * obj-marker.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    private static final char[0m[1;39m[[0m[1;39m][0m[39m OBJ_MARKER = [0m[1;39m{[0m[39m [0m[32m'o'[0m[39m, [0m[32m'b'[0m[39m, [0m[32m'j'[0m[39m [0m[1;39m}[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * trailer-marker.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    private static final char[0m[1;39m[[0m[1;39m][0m[39m TRAILER_MARKER = [0m[1;39m{[0m[39m [0m[32m't'[0m[39m, [0m[32m'r'[0m[39m, [0m[32m'a'[0m[39m, [0m[32m'i'[0m[39m, [0m[32m'l'[0m[39m, [0m[32m'e'[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [32m'r'[0m[39m [0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * ObjStream-marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    private static final char[0m[1;39m[[0m[1;39m][0m[39m OBJ_STREAM = [0m[1;39m{[0m[39m [0m[32m'/'[0m[39m, [0m[32m'O'[0m[39m, [0m[32m'b'[0m[39m, [0m[32m'j'[0m[39m, [0m[32m'S'[0m[39m, [0m[32m't'[0m[39m, [0m[32m'm'[0m [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final Logger LOG = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mLogManager.getLogger[0m[1;39m([0m[39mBruteForceParser.class[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * Contains all found objects of a brute force search.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private final Map<COSObjectKey, Long> bfSearchCOSObjectKeyOffsets = new [0m     [2m                [0m
[2;36m                    [0m         [39mHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private boolean bfSearchTriggered = false;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private final COSParser parser;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private final COSDocument document;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private final RandomAccessRead source;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * Constructor. Triggers a brute force search for all objects of the [0m        [2m                [0m
[2;36m                    [0m         [39mdocument.[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     * @param cosDocument the corresponding COS document[0m                         [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     * @param cosParser the COSParser to be used for reading the pdf[0m             [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * @throws IOException if the source data could not be read[0m                  [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    public [0m[1;35mBruteForceParser[0m[1;39m([0m[39mCOSDocument cosDocument, COSParser cosParser[0m[1;39m)[0m[39m throws[0m [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        document = cosDocument;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        parser = cosParser;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        source = parser.source;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * Indicates wether the brute force search for objects was triggered.[0m       [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     * @return true if the search was triggered[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    public boolean [0m[1;35mbfSearchTriggered[0m[1;39m([0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        return bfSearchTriggered;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:     * Returns all found objects of a brute force search.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:     * @return map containing all found objects of a brute force search[0m         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:     * @throws IOException if something went wrong[0m                              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    protected Map<COSObjectKey, Long> [0m[1;35mgetBFCOSObjectOffsets[0m[1;39m([0m[1;39m)[0m[39m throws [0m           [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        if [0m[1;39m([0m[39m!bfSearchTriggered[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            bfSearchTriggered = true;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:            [0m[1;35mbfSearchForObjects[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        return bfSearchCOSObjectKeyOffsets;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:     * Brute force search for every object in the pdf.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:     * @throws IOException if something went wrong[0m                              [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    private void [0m[1;35mbfSearchForObjects[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                        [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        long lastEOFMarker = [0m[1;35mbfSearchForLastEOFMarker[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        long originOffset = [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        long currentOffset = MINIMUM_SEARCH_OFFSET;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        long lastObjectId = Long.MIN_VALUE;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        int lastGenID = Integer.MIN_VALUE;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        long lastObjOffset = Long.MIN_VALUE;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        char[0m[1;39m[[0m[1;39m][0m[39m endobjString = [0m[32m"ndo"[0m[1;35m.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        char[0m[1;39m[[0m[1;39m][0m[39m endobjRemainingString = [0m[32m"bj"[0m[1;35m.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        boolean endOfObjFound = false;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        do[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            [0m[1;35msource.seek[0m[1;39m([0m[39mcurrentOffset[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            int nextChar = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            currentOffset++;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            if [0m[1;39m([0m[1;35mBaseParser.isWhitespace[0m[1;39m([0m[39mnextChar[0m[1;39m)[0m[39m && [0m                           [2m                [0m
[2;36m                    [0m         [1;35mparser.isString[0m[1;39m([0m[39mOBJ_MARKER[0m[1;39m)[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                long tempOffset = currentOffset - [0m[1;36m2[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                [0m[1;35msource.seek[0m[1;39m([0m[39mtempOffset[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                int genID = [0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                [0m[35m/[0m[35m/[0m[39m is the next char a digit?[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                if [0m[1;39m([0m[1;35mBaseParser.isDigit[0m[1;39m([0m[39mgenID[0m[1;39m)[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                    genID -= [0m[1;36m48[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:                    tempOffset--;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:                    [0m[1;35msource.seek[0m[1;39m([0m[39mtempOffset[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                    if [0m[1;39m([0m[1;35mparser.isWhitespace[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                        while [0m[1;39m([0m[39mtempOffset > MINIMUM_SEARCH_OFFSET && [0m           [2m                [0m
[2;36m                    [0m         [1;35mparser.isWhitespace[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                            [0m[1;35msource.seek[0m[1;39m([0m[39m--tempOffset[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                        boolean objectIDFound = false;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                        while [0m[1;39m([0m[39mtempOffset > MINIMUM_SEARCH_OFFSET && [0m           [2m                [0m
[2;36m                    [0m         [1;35mparser.isDigit[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                            [0m[1;35msource.seek[0m[1;39m([0m[39m--tempOffset[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                            objectIDFound = true;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                        if [0m[1;39m([0m[39mobjectIDFound[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                            [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                            long objectId = [0m[1;35mparser.readObjectNumber[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                            if [0m[1;39m([0m[39mlastObjOffset > [0m[1;36m0[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:                                [0m[35m/[0m[35m/[0m[39m add the former object ID only if there was a[0m [2m                [0m
[2;36m                    [0m         [39msubsequent object ID[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:                                [0m[1;35mbfSearchCOSObjectKeyOffsets.put[0m[1;39m([0m                [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:                                        new [0m[1;35mCOSObjectKey[0m[1;39m([0m[39mlastObjectId, [0m         [2m                [0m
[2;36m                    [0m         [39mlastGenID[0m[1;39m)[0m[39m, lastObjOffset[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:                            lastObjectId = objectId;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                            lastGenID = genID;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                            lastObjOffset = tempOffset + [0m[1;36m1[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:                            currentOffset += OBJ_MARKER.length - [0m[1;36m1[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:                            endOfObjFound = false;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            [0m[35m/[0m[35m/[0m[39m check for [0m[32m"endo"[0m[39m as abbreviation for [0m[32m"endobj"[0m[39m, as the pdf may be[0m [2m                [0m
[2;36m                    [0m         [39mcut off[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[35m/[0m[35m/[0m[39m in the middle of the keyword, see PDFBOX-[0m[1;36m3936[0m[39m.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            [0m[35m/[0m[35m/[0m[39m We could possibly implement a more intelligent algorithm if [0m     [2m                [0m
[2;36m                    [0m         [39mnecessary[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            else if [0m[1;39m([0m[39mnextChar == [0m[32m'e'[0m[39m && [0m[1;35mparser.isString[0m[1;39m([0m[39mendobjString[0m[1;39m)[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                currentOffset += endobjString.length;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                [0m[1;35msource.seek[0m[1;39m([0m[39mcurrentOffset[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                if [0m[1;39m([0m[1;35mparser.isEOF[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:                    endOfObjFound = true;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:                else if [0m[1;39m([0m[1;35mparser.isString[0m[1;39m([0m[39mendobjRemainingString[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                    currentOffset += endobjRemainingString.length;[0m              [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                    endOfObjFound = true;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:        [0m[1;39m}[0m[39m while [0m[1;39m([0m[39mcurrentOffset < lastEOFMarker && ![0m[1;35mparser.isEOF[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mlastEOFMarker < Long.MAX_VALUE || endOfObjFound[0m[1;39m)[0m[39m && lastObjOffset [0m [2m                [0m
[2;36m                    [0m         [39m> [0m[1;36m0[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:            [0m[35m/[0m[35m/[0m[39m if the pdf wasn't cut off in the middle or if the last object [0m   [2m                [0m
[2;36m                    [0m         [39mends with a [0m[32m"endobj"[0m[39m marker[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[35m/[0m[35m/[0m[39m the last object id has to be added here so that it can't get [0m    [2m                [0m
[2;36m                    [0m         [39mlost as there isn't any subsequent object id[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35mbfSearchCOSObjectKeyOffsets.put[0m[1;39m([0m[39mnew [0m[1;35mCOSObjectKey[0m[1;39m([0m[39mlastObjectId, [0m     [2m                [0m
[2;36m                    [0m         [39mlastGenID[0m[1;39m)[0m[39m,[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:                    lastObjOffset[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:        [0m[35m/[0m[35m/[0m[39m reestablish origin position[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        [0m[1;35msource.seek[0m[1;39m([0m[39moriginOffset[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BruteForceParser.jav[0m[1;92ma:524[0m[39m-[0m[1;36m560[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:    private long [0m[1;35mbfSearchForLastEOFMarker[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                  [2m                [0m
[2;36m                    [0m         [1;36m525[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m526[0m[39m:        long lastEOFMarker = [0m[1;36m-1[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m527[0m[39m:        long originOffset = [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:        [0m[1;35msource.seek[0m[1;39m([0m[39mMINIMUM_SEARCH_OFFSET[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m529[0m[39m:        long tempMarker = [0m[1;35mfindString[0m[1;39m([0m[39mEOF_MARKER[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:        while [0m[1;39m([0m[39mtempMarker != [0m[1;36m-1[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:            try[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:                [0m[35m/[0m[35m/[0m[39m check if the following data is some valid pdf content[0m        [2m                [0m
[2;36m                    [0m         [1;36m535[0m[39m:                [0m[35m/[0m[35m/[0m[39m which most likely indicates that the pdf is linearized,[0m      [2m                [0m
[2;36m                    [0m         [1;36m536[0m[39m:                [0m[35m/[0m[35m/[0m[39m updated or just cut off somewhere in the middle[0m              [2m                [0m
[2;36m                    [0m         [1;36m537[0m[39m:                [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m538[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mparser.isString[0m[1;39m([0m[39mXREF_TABLE[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m539[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m540[0m[39m:                    [0m[1;35mparser.readObjectNumber[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m541[0m[39m:                    [0m[1;35mparser.readGenerationNumber[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m542[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m543[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m544[0m[39m:            catch [0m[1;39m([0m[39mIOException exception[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m545[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m546[0m[39m:                [0m[35m/[0m[35m/[0m[39m save the EOF marker as the following data is most likely [0m    [2m                [0m
[2;36m                    [0m         [39msome garbage[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m547[0m[39m:                [0m[1;35mLOG.debug[0m[1;39m([0m[32m"An exception occurred during brute force for last [0m   [2m                [0m
[2;36m                    [0m         [32mEOF - ignoring"[0m[39m,[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m548[0m[39m:                        exception[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m549[0m[39m:                lastEOFMarker = tempMarker;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m550[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m551[0m[39m:            tempMarker = [0m[1;35mfindString[0m[1;39m([0m[39mEOF_MARKER[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m552[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m553[0m[39m:        [0m[1;35msource.seek[0m[1;39m([0m[39moriginOffset[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m554[0m[39m:        [0m[35m/[0m[35m/[0m[39m no EOF marker found[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:        if [0m[1;39m([0m[39mlastEOFMarker == [0m[1;36m-1[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:            lastEOFMarker = Long.MAX_VALUE;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:        return lastEOFMarker;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BruteForceParser.jav[0m[1;92ma:641[0m[39m-[0m[1;36m660[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:    private List<Long> [0m[1;35mbfSearchForXRefTables[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m               [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:        List<Long> bfSearchXRefTablesOffsets = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:        [0m[35m/[0m[35m/[0m[39m a pdf may contain more than one xref entry[0m                           [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:        [0m[1;35msource.seek[0m[1;39m([0m[39mMINIMUM_SEARCH_OFFSET[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:        [0m[35m/[0m[35m/[0m[39m search for xref tables[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:        long newOffset = [0m[1;35mfindString[0m[1;39m([0m[39mXREF_TABLE[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:        while [0m[1;39m([0m[39mnewOffset != [0m[1;36m-1[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:            [0m[1;35msource.seek[0m[1;39m([0m[39mnewOffset - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:            [0m[35m/[0m[35m/[0m[39m ensure that we don't read [0m[32m"startxref"[0m[39m instead of [0m[32m"xref"[0m          [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:            if [0m[1;39m([0m[1;35mparser.isWhitespace[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:                [0m[1;35mbfSearchXRefTablesOffsets.add[0m[1;39m([0m[39mnewOffset[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:            [0m[1;35msource.seek[0m[1;39m([0m[39mnewOffset + [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:            newOffset = [0m[1;35mfindString[0m[1;39m([0m[39mXREF_TABLE[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:        return bfSearchXRefTablesOffsets;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BruteForceParser.jav[0m[1;92ma:667[0m[39m-[0m[1;36m735[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:    private List<Long> [0m[1;35mbfSearchForXRefStreams[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m              [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:        List<Long> bfSearchXRefStreamsOffsets = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:        [0m[35m/[0m[35m/[0m[39m a pdf may contain more than one [0m[35m/[0m[95mXRef[0m[39m entry[0m                          [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:        [0m[1;35msource.seek[0m[1;39m([0m[39mMINIMUM_SEARCH_OFFSET[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:        [0m[35m/[0m[35m/[0m[39m search for XRef streams[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:        String objString = [0m[32m" obj"[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:        char[0m[1;39m[[0m[1;39m][0m[39m string = [0m[1;35mobjString.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:        long xrefOffset = [0m[1;35mfindString[0m[1;39m([0m[39mXREF_STREAM[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:        while [0m[1;39m([0m[39mxrefOffset != [0m[1;36m-1[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:            [0m[35m/[0m[35m/[0m[39m search backwards for the beginning of the stream[0m                 [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:            long newOffset = [0m[1;36m-1[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:            boolean objFound = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:            for [0m[1;39m([0m[39mint i = [0m[1;36m1[0m[39m; i < [0m[1;36m40[0m[39m && !objFound; i++[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:                long currentOffset = xrefOffset - [0m[1;39m([0m[39mi * [0m[1;36m10[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:                if [0m[1;39m([0m[39mcurrentOffset > [0m[1;36m0[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m685[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m686[0m[39m:                    [0m[1;35msource.seek[0m[1;39m([0m[39mcurrentOffset[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m687[0m[39m:                    for [0m[1;39m([0m[39mint j = [0m[1;36m0[0m[39m; j < [0m[1;36m10[0m[39m; j++[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m688[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m689[0m[39m:                        if [0m[1;39m([0m[1;35mparser.isString[0m[1;39m([0m[39mstring[0m[1;39m)[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m690[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m691[0m[39m:                            long tempOffset = currentOffset - [0m[1;36m1[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m692[0m[39m:                            [0m[1;35msource.seek[0m[1;39m([0m[39mtempOffset[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m693[0m[39m:                            [0m[35m/[0m[35m/[0m[39m is the next char a digit?[0m                        [2m                [0m
[2;36m                    [0m         [1;36m694[0m[39m:                            if [0m[1;39m([0m[1;35mparser.isDigit[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m695[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m696[0m[39m:                                tempOffset--;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m697[0m[39m:                                [0m[1;35msource.seek[0m[1;39m([0m[39mtempOffset[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:                                if [0m[1;39m([0m[1;35mparser.isSpace[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:                                [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:                                    int length = [0m[1;36m0[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m701[0m[39m:                                    [0m[1;35msource.seek[0m[1;39m([0m[39m--tempOffset[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m702[0m[39m:                                    while [0m[1;39m([0m[39mtempOffset > MINIMUM_SEARCH_OFFSET [0m  [2m                [0m
[2;36m                    [0m         [39m&& [0m[1;35mparser.isDigit[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m703[0m[39m:                                    [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m704[0m[39m:                                        [0m[1;35msource.seek[0m[1;39m([0m[39m--tempOffset[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m705[0m[39m:                                        length++;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:                                    [0m[1;39m}[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:                                    if [0m[1;39m([0m[39mlength > [0m[1;36m0[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:                                    [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:                                        [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:                                        newOffset = [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:                                    [0m[1;39m}[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:                                [0m[1;39m}[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:                            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"Fixed reference for xref stream [0m[32m{[0m[32m}[0m[32m -> [0m   [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m, xrefOffset,[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:                                    newOffset[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:                            objFound = true;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:                            break;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:                        else[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                            currentOffset++;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:                            [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:            if [0m[1;39m([0m[39mnewOffset > [0m[1;36m-1[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:                [0m[1;35mbfSearchXRefStreamsOffsets.add[0m[1;39m([0m[39mnewOffset[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:            [0m[1;35msource.seek[0m[1;39m([0m[39mxrefOffset + [0m[1;36m5[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:            xrefOffset = [0m[1;35mfindString[0m[1;39m([0m[39mXREF_STREAM[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:        return bfSearchXRefStreamsOffsets;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:382[0m[39m-[0m[1;36m432[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:    private List<Token> [0m[1;35mreadValue[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                          [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:        List<Token> value = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:        Token token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:        if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:            return value;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:        [0m[1;35mvalue.add[0m[1;39m([0m[39mtoken[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:        if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.START_ARRAY[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:            int openArray = [0m[1;36m1[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:            while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:                if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:                    return value;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:                if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.START_ARRAY[0m[1;39m)[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:                    openArray++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:                token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:                [0m[1;35mvalue.add[0m[1;39m([0m[39mtoken[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:                if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.END_ARRAY[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:                    openArray--;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:                    if [0m[1;39m([0m[39mopenArray == [0m[1;36m0[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:        else if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.START_PROC[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:            [0m[1;35mvalue.addAll[0m[1;39m([0m[1;35mreadProc[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:        else if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.START_DICT[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:            [0m[35m/[0m[35m/[0m[39m skip [0m[32m"/GlyphNames2HostCode << >> def"[0m                            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.END_DICT[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:            return value;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:        [0m[1;35mreadPostScriptWrapper[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:        return value;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:469[0m[39m-[0m[1;36m505[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:    private List<Token> [0m[1;35mreadProc[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                           [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        List<Token> value = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        int openProc = [0m[1;36m1[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Malformed procedure: missing token"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.START_PROC[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:                openProc++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:            Token token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:            [0m[1;35mvalue.add[0m[1;39m([0m[39mtoken[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:            if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.END_PROC[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                openProc--;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39mopenProc == [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:        Token executeonly = [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"executeonly"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:        if [0m[1;39m([0m[39mexecuteonly != null[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:            [0m[1;35mvalue.add[0m[1;39m([0m[39mexecuteonly[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        return value;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:541[0m[39m-[0m[1;36m649[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m541[0m[39m:    private void [0m[1;35mparseBinary[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                   [2m                [0m
[2;36m                    [0m         [1;36m542[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m543[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m decrypted;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m544[0m[39m:        [0m[35m/[0m[35m/[0m[39m Sometimes, fonts use the hex format, so this needs to be converted [0m  [2m                [0m
[2;36m                    [0m         [39mbefore decryption[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m545[0m[39m:        if [0m[1;39m([0m[1;35misBinary[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m546[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m547[0m[39m:            decrypted = [0m[1;35mdecrypt[0m[1;39m([0m[39mbytes, EEXEC_KEY, [0m[1;36m4[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m548[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m549[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m550[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m551[0m[39m:            decrypted = [0m[1;35mdecrypt[0m[1;39m([0m[1;35mhexToBinary[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m, EEXEC_KEY, [0m[1;36m4[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m552[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m553[0m[39m:        lexer = new [0m[1;35mType1Lexer[0m[1;39m([0m[39mdecrypted[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m554[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:        [0m[35m/[0m[35m/[0m[39m find [0m[35m/[0m[95mPrivate[0m[39m dict[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:        Token peekToken = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:        while [0m[1;39m([0m[39mpeekToken != null && ![0m[32m"Private"[0m[1;35m.equals[0m[1;39m([0m[1;35mpeekToken.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:            [0m[35m/[0m[35m/[0m[39m for a more thorough validation, the presence of [0m[32m"begin"[0m[39m before [0m  [2m                [0m
[2;36m                    [0m         [39mPrivate[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:            [0m[35m/[0m[35m/[0m[39m determines how code before and following charstrings should look[0m [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:            [0m[35m/[0m[35m/[0m[39m it is not currently checked anyway[0m                               [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:            peekToken = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:        if [0m[1;39m([0m[39mpeekToken == null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m566[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m567[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Private token not found"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m568[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m569[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m570[0m[39m:        [0m[35m/[0m[35m/[0m[39m Private dict[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m571[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL, [0m[32m"Private"[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m572[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m573[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dict"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m574[0m[39m:        [0m[35m/[0m[35m/[0m[39m actually could also be [0m[32m"/Private 10 dict def Private begin"[0m          [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:        [0m[35m/[0m[35m/[0m[39m instead of the [0m[32m"dup"[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:        [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"begin"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:        int lenIV = [0m[1;36m4[0m[39m; [0m[35m/[0m[35m/[0m[39m number of random bytes at start of charstring[0m         [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:            [0m[35m/[0m[35m/[0m[39m key/value[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:            String key = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:            switch [0m[1;39m([0m[39mkey[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:                case [0m[32m"Subrs"[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:                    [0m[1;35mreadSubrs[0m[1;39m([0m[39mlenIV[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:                case [0m[32m"OtherSubrs"[0m[39m:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:                    [0m[1;35mreadOtherSubrs[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:                case [0m[32m"lenIV"[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:                    lenIV = [0m[1;35mreadDictValue[0m[1;39m([0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m602[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m603[0m[39m:                case [0m[32m"ND"[0m[39m:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m604[0m[39m:                    [0m[1;35mread[0m[1;39m([0m[39mToken.START_PROC[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m605[0m[39m:                    [0m[35m/[0m[35m/[0m[39m the access restrictions are not mandatory[0m                [2m                [0m
[2;36m                    [0m         [1;36m606[0m[39m:                    [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"noaccess"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m607[0m[39m:                    [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m608[0m[39m:                    [0m[1;35mread[0m[1;39m([0m[39mToken.END_PROC[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m609[0m[39m:                    [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"executeonly"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m610[0m[39m:                    [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m611[0m[39m:                    [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m612[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m613[0m[39m:                case [0m[32m"NP"[0m[39m:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m614[0m[39m:                    [0m[1;35mread[0m[1;39m([0m[39mToken.START_PROC[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m615[0m[39m:                    [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"noaccess"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m616[0m[39m:                    [0m[1;35mread[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m617[0m[39m:                    [0m[1;35mread[0m[1;39m([0m[39mToken.END_PROC[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m618[0m[39m:                    [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"executeonly"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m619[0m[39m:                    [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m620[0m[39m:                    [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m621[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m622[0m[39m:                case [0m[32m"RD"[0m[39m:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m623[0m[39m:                    [0m[35m/[0m[35m/[0m[39m [0m[35m/[0m[95mRD[0m[39m [0m[1;39m{[0m[39mstring currentfile exch readstring pop[0m[1;39m}[0m[39m bind [0m       [2m                [0m
[2;36m                    [0m         [39mexecuteonly def[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m624[0m[39m:                    [0m[1;35mread[0m[1;39m([0m[39mToken.START_PROC[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m625[0m[39m:                    [0m[1;35mreadProcVoid[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m626[0m[39m:                    [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"bind"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:                    [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"executeonly"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m628[0m[39m:                    [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m629[0m[39m:                    [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m630[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m631[0m[39m:                default:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:                    [0m[1;35mreadPrivate[0m[1;39m([0m[39mkey, [0m[1;35mreadDictValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:        [0m[35m/[0m[35m/[0m[39m some fonts have [0m[32m"2 index"[0m[39m here, others have [0m[32m"end noaccess put"[0m       [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:        [0m[35m/[0m[35m/[0m[39m sometimes followed by [0m[32m"put"[0m[39m. Either way, we just skip until[0m          [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:        [0m[35m/[0m[35m/[0m[39m the [0m[35m/[0m[95mCharStrings[0m[39m dict is found[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:        while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:                && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:        [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL, [0m[32m"CharStrings"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:        [0m[1;35mreadCharStrings[0m[1;39m([0m[39mlenIV[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:706[0m[39m-[0m[1;36m743[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:    private void [0m[1;35mreadSubrs[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                        [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:        [0m[35m/[0m[35m/[0m[39m allocate size [0m[1;39m([0m[39marray indexes may not be in-order[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:            [0m[1;35mfont.subrs.add[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:            if [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                  [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:            Token index = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:            [0m[35m/[0m[35m/[0m[39m RD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:            Token charstring = [0m[1;35mread[0m[1;39m([0m[39mToken.CHARSTRING[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:            int j = [0m[1;35mindex.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:            if [0m[1;39m([0m[39mj < [0m[1;35mfont.subrs.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                [0m[1;35mfont.subrs.set[0m[1;39m([0m[39mj, [0m[1;35mdecrypt[0m[1;39m([0m[1;35mcharstring.getData[0m[1;39m([0m[1;39m)[0m[39m, CHARSTRING_KEY,[0m [2m                [0m
[2;36m                    [0m         [39mlenIV[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:            [0m[1;35mreadPut[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:        [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:777[0m[39m-[0m[1;36m813[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:    private void [0m[1;35mreadCharStrings[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                  [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dict"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:        [0m[35m/[0m[35m/[0m[39m could actually be a sequence ending in [0m[32m"CharStrings begin"[0m[39m, too[0m      [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:        [0m[35m/[0m[35m/[0m[39m instead of the [0m[32m"dup begin"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"begin"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:                [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"end"[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:            [0m[35m/[0m[35m/[0m[39m key/value[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:            String name = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:            [0m[35m/[0m[35m/[0m[39m RD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:            Token charstring = [0m[1;35mread[0m[1;39m([0m[39mToken.CHARSTRING[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:            [0m[1;35mfont.charstrings.put[0m[1;39m([0m[39mname, [0m[1;35mdecrypt[0m[1;39m([0m[1;35mcharstring.getData[0m[1;39m([0m[1;39m)[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39mCHARSTRING_KEY, lenIV[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:            [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:        [0m[35m/[0m[35m/[0m[39m some fonts have one [0m[32m"end"[0m[39m, others two[0m                                [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"end"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:        [0m[35m/[0m[35m/[0m[39m since checking ends here, this does not matter [0m[33m...[0m[39m.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:        [0m[35m/[0m[35m/[0m[39m more thorough checking would see whether there is [0m[32m"begin"[0m[39m before [0m    [2m                [0m
[2;36m                    [0m         [35m/[0m[95mPrivate[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:        [0m[35m/[0m[35m/[0m[39m and expect a [0m[32m"def"[0m[39m somewhere, otherwise a [0m[32m"put"[0m                      [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.jav[0m[1;92ma:955[0m[39m-[0m[1;36m999[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m955[0m[39m:    private int [0m[1;35mcheckPagesDictionary[0m[1;39m([0m[39mCOSDictionary pagesDict, Set<COSObject> [0m   [2m                [0m
[2;36m                    [0m         [39mset[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m956[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m957[0m[39m:        [0m[35m/[0m[35m/[0m[39m check for kids[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m958[0m[39m:        COSArray kidsArray = [0m[1;35mpagesDict.getCOSArray[0m[1;39m([0m[39mCOSName.KIDS[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m959[0m[39m:        int numberOfPages = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m960[0m[39m:        if [0m[1;39m([0m[39mkidsArray != null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m961[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m962[0m[39m:            List<? extends COSBase> kidsList = [0m[1;35mkidsArray.toList[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m963[0m[39m:            for [0m[1;39m([0m[39mCOSBase kid : kidsList[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m964[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m965[0m[39m:                if [0m[1;39m([0m[39m![0m[1;39m([0m[39mkid instanceof COSObject[0m[1;39m)[0m[39m || [0m[1;35mset.contains[0m[1;39m([0m[1;39m([0m[39mCOSObject[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mkid[0m[1;39m)[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m966[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m967[0m[39m:                    [0m[1;35mkidsArray.remove[0m[1;39m([0m[39mkid[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m968[0m[39m:                    continue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m969[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m970[0m[39m:                COSObject kidObject = [0m[1;39m([0m[39mCOSObject[0m[1;39m)[0m[39m kid;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m971[0m[39m:                COSBase kidBaseobject = [0m[1;35mkidObject.getObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m972[0m[39m:                [0m[35m/[0m[35m/[0m[39m object wasn't dereferenced -> remove it[0m                      [2m                [0m
[2;36m                    [0m         [1;36m973[0m[39m:                if [0m[1;39m([0m[39mkidBaseobject == null || [0m                                   [2m                [0m
[2;36m                    [0m         [1;35mkidBaseobject.equals[0m[1;39m([0m[39mCOSNull.NULL[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:                    [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Removed null object [0m[32m{[0m[32m}[0m[32m from pages dictionary"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39mkid[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:                    [0m[1;35mkidsArray.remove[0m[1;39m([0m[39mkid[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:                else if [0m[1;39m([0m[39mkidBaseobject instanceof COSDictionary[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:                    COSDictionary kidDictionary = [0m[1;39m([0m[39mCOSDictionary[0m[1;39m)[0m[39m [0m              [2m                [0m
[2;36m                    [0m         [39mkidBaseobject;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:                    COSName type = [0m[1;35mkidDictionary.getCOSName[0m[1;39m([0m[39mCOSName.TYPE[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:                    if [0m[1;39m([0m[1;35mCOSName.PAGES.equals[0m[1;39m([0m[39mtype[0m[1;39m)[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:                        [0m[35m/[0m[35m/[0m[39m process nested pages dictionaries[0m                    [2m                [0m
[2;36m                    [0m         [1;36m985[0m[39m:                        [0m[1;35mset.add[0m[1;39m([0m[39mkidObject[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m986[0m[39m:                        numberOfPages += [0m[1;35mcheckPagesDictionary[0m[1;39m([0m[39mkidDictionary, [0m   [2m                [0m
[2;36m                    [0m         [39mset[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m987[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m988[0m[39m:                    else if [0m[1;39m([0m[1;35mCOSName.PAGE.equals[0m[1;39m([0m[39mtype[0m[1;39m)[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m989[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m990[0m[39m:                        [0m[35m/[0m[35m/[0m[39m count pages[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m991[0m[39m:                        numberOfPages++;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m992[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m993[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m994[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m995[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m996[0m[39m:        [0m[35m/[0m[35m/[0m[39m fix counter[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m997[0m[39m:        [0m[1;35mpagesDict.setInt[0m[1;39m([0m[39mCOSName.COUNT, numberOfPages[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m998[0m[39m:        return numberOfPages;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m999[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.jav[0m[1;92ma:371[0m[39m-[0m[1;36m399[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:    private int [0m[1;35mlastIndexOf[0m[1;39m([0m[39mfinal char[0m[1;39m[[0m[1;39m][0m[39m pattern, final byte[0m[1;39m[[0m[1;39m][0m[39m buf, final int [0m  [2m                [0m
[2;36m                    [0m         [39mendOff[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        final int lastPatternChOff = pattern.length - [0m[1;36m1[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        int bufOff = endOff;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:        int patOff = lastPatternChOff;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:        char lookupCh = pattern[0m[1;39m[[0m[39mpatOff[0m[1;39m][0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:        while [0m[1;39m([0m[39m--bufOff >= [0m[1;36m0[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:            if [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mbufOff[0m[1;39m][0m[39m == lookupCh[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:                if [0m[1;39m([0m[39m--patOff < [0m[1;36m0[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:                    [0m[35m/[0m[35m/[0m[39m whole pattern matched[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:                    return bufOff;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:                [0m[35m/[0m[35m/[0m[39m matched current char, advance to preceding one[0m               [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                lookupCh = pattern[0m[1;39m[[0m[39mpatOff[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:            else if [0m[1;39m([0m[39mpatOff < lastPatternChOff[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:                [0m[35m/[0m[35m/[0m[39m no char match but already matched some chars; reset[0m          [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:                patOff = lastPatternChOff;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:                lookupCh = pattern[0m[1;39m[[0m[39mpatOff[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:        return [0m[1;36m-1[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:192[0m[39m-[0m[1;36m239[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    private void [0m[1;35mreadEncoding[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                              [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            String name = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"StandardEncoding"[0m[1;39m)[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                font.encoding = StandardEncoding.INSTANCE;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unknown encoding: "[0m[39m + name[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            [0m[35m/[0m[35m/[0m[39m [0m[1;36m0[0m[39m [0m[1;36m1[0m[39m [0m[1;36m255[0m[39m [0m[1;39m{[0m[1;36m1[0m[39m index exch [0m[35m/[0m[95m.notdef[0m[39m put [0m[1;39m}[0m[39m for[0m                         [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[35m/[0m[35m/[0m[39m we have to check [0m[32m"readonly"[0m[39m and [0m[32m"def"[0m[39m too[0m                        [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            [0m[35m/[0m[35m/[0m[39m as some fonts don't provide any dup-values, see PDFBOX-[0m[1;36m2134[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                    && [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:            Map<Integer, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            while [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                    [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                int code = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                String name = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"put"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                [0m[1;35mcodeToName.put[0m[1;39m([0m[39mcode, name[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:            font.encoding = new [0m[1;35mBuiltInEncoding[0m[1;39m([0m[39mcodeToName[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:117[0m[39m-[0m[1;36m249[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    private Token [0m[1;35mreadToken[0m[1;39m([0m[39mToken prevToken[0m[1;39m)[0m[39m throws IOException[0m                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        boolean skip;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        do[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:            skip = false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:            while [0m[1;39m([0m[1;35mbuffer.hasRemaining[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                char c = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:                [0m[35m/[0m[35m/[0m[39m delimiters[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:                if [0m[1;39m([0m[39mc == [0m[32m'%'[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                    [0m[35m/[0m[35m/[0m[39m comment[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                    [0m[1;35mreadComment[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'[0m[32m([0m[32m'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                    return [0m[1;35mreadString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'[0m[32m)[0m[32m'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                    [0m[35m/[0m[35m/[0m[39m not allowed outside a string context[0m                     [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"unexpected closing parenthesis"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'[0m[32m[[0m[32m'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                    return new [0m[1;35mToken[0m[1;39m([0m[39mc, Token.START_ARRAY[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'[0m[32m{[0m[32m'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                    return new [0m[1;35mToken[0m[1;39m([0m[39mc, Token.START_PROC[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'[0m[32m][0m[32m'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                    return new [0m[1;35mToken[0m[1;39m([0m[39mc, Token.END_ARRAY[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'[0m[32m}[0m[32m'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                    return new [0m[1;35mToken[0m[1;39m([0m[39mc, Token.END_PROC[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'/'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                    String regular = [0m[1;35mreadRegular[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                    if [0m[1;39m([0m[39mregular == null[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                        [0m[35m/[0m[35m/[0m[39m the stream is corrupt[0m                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:                        throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Could not read token at[0m [2m                [0m
[2;36m                    [0m         [32mposition "[0m[39m +[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                                                        [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                    return new [0m[1;35mToken[0m[1;39m([0m[39mregular, Token.LITERAL[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'<'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                    char c2 = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                    if [0m[1;39m([0m[39mc2 == c[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                        return new [0m[1;35mToken[0m[1;39m([0m[32m"<<"[0m[39m, Token.START_DICT[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:                        [0m[35m/[0m[35m/[0m[39m code may have to be changed in something better, [0m    [2m                [0m
[2;36m                    [0m         [39mmaybe new token type[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:                        [0m[1;35mbuffer.position[0m[1;39m([0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:                        return new [0m[1;35mToken[0m[1;39m([0m[39mc, Token.NAME[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[32m'>'[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:                    char c2 = [0m[1;35mgetChar[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:                    if [0m[1;39m([0m[39mc2 == c[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:                        return new [0m[1;35mToken[0m[1;39m([0m[32m">>"[0m[39m, Token.END_DICT[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                        [0m[35m/[0m[35m/[0m[39m code may have to be changed in something better, [0m    [2m                [0m
[2;36m                    [0m         [39mmaybe new token type[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:                        [0m[1;35mbuffer.position[0m[1;39m([0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                        return new [0m[1;35mToken[0m[1;39m([0m[39mc, Token.NAME[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                else if [0m[1;39m([0m[1;35mCharacter.isWhitespace[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:                    skip = true;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:                else if [0m[1;39m([0m[39mc == [0m[1;36m0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                    [0m[1;35mLOG.warn[0m[1;39m([0m[32m"NULL byte in font, skipped"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                    skip = true;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:                else[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:                    [0m[1;35mbuffer.position[0m[1;39m([0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[39m [0m[1;36m-1[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                    [0m[35m/[0m[35m/[0m[39m regular character: try parse as number[0m                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:                    Token number = [0m[1;35mtryReadNumber[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:                    if [0m[1;39m([0m[39mnumber != null[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                        return number;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                        [0m[35m/[0m[35m/[0m[39m otherwise this must be a name[0m                        [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                        String name = [0m[1;35mreadRegular[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                            [0m[35m/[0m[35m/[0m[39m the stream is corrupt[0m                            [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                            throw new [0m[1;35mDamagedFontException[0m[1;39m([0m[32m"Could not read [0m     [2m                [0m
[2;36m                    [0m         [32mtoken at position "[0m[39m +[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                                                           [0m[1;35mbuffer.position[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"RD"[0m[1;39m)[0m[39m || [0m[1;35mname.equals[0m[1;39m([0m[32m"-|"[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                            [0m[35m/[0m[35m/[0m[39m return the next CharString instead[0m               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                            if [0m[1;39m([0m[39mprevToken != null && [0m[1;35mprevToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == [0m    [2m                [0m
[2;36m                    [0m         [39mToken.INTEGER[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                                return [0m[1;35mreadCharString[0m[1;39m([0m[1;35mprevToken.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            else[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"expected INTEGER before [0m [2m                [0m
[2;36m                    [0m         [32m-| or RD"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                        else[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                            return new [0m[1;35mToken[0m[1;39m([0m[39mname, Token.NAME[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        while [0m[1;39m([0m[39mskip[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.jav[0m[1;92ma:931[0m[39m-[0m[1;36m953[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m931[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m932[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m933[0m[39m:     * Check if all entries of the pages dictionary are present. Those which [0m   [2m                [0m
[2;36m                    [0m         [39mcan't be dereferenced are removed.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m934[0m[39m:     * [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m935[0m[39m:     * @param root the root dictionary of the pdf[0m                               [2m                [0m
[2;36m                    [0m         [1;36m936[0m[39m:     * @throws java.io.IOException if the page tree root is null[0m                [2m                [0m
[2;36m                    [0m         [1;36m937[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m938[0m[39m:    protected void [0m[1;35mcheckPages[0m[1;39m([0m[39mCOSDictionary root[0m[1;39m)[0m[39m throws IOException[0m            [2m                [0m
[2;36m                    [0m         [1;36m939[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m940[0m[39m:        if [0m[1;39m([0m[39mtrailerWasRebuild[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m941[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m942[0m[39m:            [0m[35m/[0m[35m/[0m[39m check if all page objects are dereferenced[0m                       [2m                [0m
[2;36m                    [0m         [1;36m943[0m[39m:            COSDictionary pages = [0m[1;35mroot.getCOSDictionary[0m[1;39m([0m[39mCOSName.PAGES[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m944[0m[39m:            if [0m[1;39m([0m[39mpages != null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m945[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m946[0m[39m:                [0m[1;35mcheckPagesDictionary[0m[1;39m([0m[39mpages, new HashSet<>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m947[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m948[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m949[0m[39m:        if [0m[1;39m([0m[1;35mroot.getCOSDictionary[0m[1;39m([0m[39mCOSName.PAGES[0m[1;39m)[0m[39m == null[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m950[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m951[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Page tree root must be a dictionary"[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m952[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m953[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.jav[0m[1;92ma:100[0m[39m-[0m[1;36m177[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        long prev = startXrefOffset;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        [0m[35m/[0m[35m/[0m[95mlastPrev[0m[39m prevents potential infinite loops in crafted files[0m           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        long lastPrev = [0m[1;36m-1[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[35m/[0m[35m/[0m[39m ---- parse whole chain of xref tables/object streams using PREV [0m     [2m                [0m
[2;36m                    [0m         [39mreference[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        COSDictionary trailer = null;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            lastPrev = prev;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[35m/[0m[35m/[0m[39m skip white spaces[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[35m/[0m[35m/[0m[39m -- parse xref[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            if [0m[1;39m([0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m == X[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                [0m[35m/[0m[35m/[0m[39m xref table and trailer[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[35m/[0m[35m/[0m[39m use existing parser to parse xref table[0m                      [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mparseXrefTable[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m || ![0m[1;35mparseTrailer[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Expected trailer object at offset "[0m  [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:                            + [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                [0m[35m/[0m[35m/[0m[39m check for a XRef stream, it may contain some object ids of [0m  [2m                [0m
[2;36m                    [0m         [39mcompressed objects [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:                [0m[1;35mif[0m[1;39m([0m[1;35mtrailer.containsKey[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:                    int streamOffset = [0m[1;35mtrailer.getInt[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:                    [0m[35m/[0m[35m/[0m[39m check the xref stream reference[0m                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:                    fixedOffset = [0m[1;35mcheckXRefOffset[0m[1;39m([0m[39mstreamOffset[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:                    if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[39m && fixedOffset != streamOffset[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                        [0m[1;35mLOG.warn[0m[1;39m([0m[32m"/XRefStm offset [0m[32m{[0m[32m}[0m[32m is incorrect, corrected to[0m [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m, streamOffset,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                                fixedOffset[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                        streamOffset = [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mfixedOffset;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                        [0m[1;35mtrailer.setInt[0m[1;39m([0m[39mCOSName.XREF_STM, streamOffset[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:                    if [0m[1;39m([0m[39mstreamOffset > [0m[1;36m0[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                        [0m[1;35msource.seek[0m[1;39m([0m[39mstreamOffset[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                        [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                        try[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:                            [0m[1;35mparseXrefObjStream[0m[1;39m([0m[39mprev, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:                            [0m[1;35mdocument.setHasHybridXRef[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:                        catch [0m[1;39m([0m[39mIOException ex[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                            [0m[1;35mLOG.error[0m[1;39m([0m[32m"Failed to parse /XRefStm at offset "[0m[39m + [0m  [2m                [0m
[2;36m                    [0m         [39mstreamOffset, ex[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                        [0m[1;35mLOG.error[0m[1;39m([0m[32m"Skipped XRef stream due to a corrupt offset:[0m [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m, streamOffset[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                prev = [0m[1;35mtrailer.getLong[0m[1;39m([0m[39mCOSName.PREV[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[35m/[0m[35m/[0m[39m parse xref stream[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                prev = [0m[1;35mparseXrefObjStream[0m[1;39m([0m[39mprev, true[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            if [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                [0m[35m/[0m[35m/[0m[39m check the xref table reference[0m                               [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                fixedOffset = [0m[1;35mcheckXRefOffset[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[39m && fixedOffset != prev[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                    prev = fixedOffset;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                    [0m[1;35mtrailer.setLong[0m[1;39m([0m[39mCOSName.PREV, prev[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_3/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m15[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java [0m     [2m                [0m
[2;36m                    [0m         [39mb/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index c995d96e2..c4a973ade [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-219[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m219[0m[39m,[0m[1;36m9[0m[39m @@ final class Type1Parser[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:                             || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:                             || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:             [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-                [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+                if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:+                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Should have found dup, readonly or [0m  [2m                [0m
[2;36m                    [0m         [32mdef?! EOF?"[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:+                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:             [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:             Map<Integer, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_8/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m54[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java [0m    [2m                [0m
[2;36m                    [0m         [39mb/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index e8b53efc4..97bc49a2a [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-23[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m23[0m[39m,[0m[1;36m7[0m[39m @@ import java.util.HashSet;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: import java.util.Optional;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: import java.util.Map.Entry;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:+import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: [0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: import org.apache.logging.log4j.LogManager;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: import org.apache.logging.log4j.Logger;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:@@ [0m[1;36m-98[0m[39m,[0m[1;36m17[0m[39m +[0m[1;36m99[0m[39m,[0m[1;36m19[0m[39m @@ public class XrefParser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:         [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:         [0m[1;35mdocument.setStartXref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:         long prev = startXrefOffset;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:-        [0m[35m/[0m[35m/[0m[95mlastPrev[0m[39m prevents potential infinite loops in crafted files[0m           [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:-        long lastPrev = [0m[1;36m-1[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:         [0m[35m/[0m[35m/[0m[39m ---- parse whole chain of xref tables/object streams using PREV [0m     [2m                [0m
[2;36m                    [0m         [39mreference[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:+        Set<Long> prevSet = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:         COSDictionary trailer = null;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:-        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:+        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:         [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:-            lastPrev = prev;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:+            [0m[35m/[0m[35m/[0m[39m save expected position for loop detection[0m                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:+            [0m[1;35mprevSet.add[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:             [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:             [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:             [0m[35m/[0m[35m/[0m[39m skip white spaces[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:             [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:+            [0m[35m/[0m[35m/[0m[39m save current position as well due to skipped spaces[0m              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:+            [0m[1;35mprevSet.add[0m[1;39m([0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:             [0m[35m/[0m[35m/[0m[39m -- parse xref[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:             if [0m[1;39m([0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m == X[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:             [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:@@ [0m[1;36m-120[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m123[0m[39m,[0m[1;36m7[0m[39m @@ public class XrefParser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:                             + [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:                 [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:                 trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:-                [0m[35m/[0m[35m/[0m[39m check for a XRef stream, it may contain some object ids of [0m  [2m                [0m
[2;36m                    [0m         [39mcompressed objects [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:+                [0m[35m/[0m[35m/[0m[39m check for a XRef stream, it may contain some object ids of [0m  [2m                [0m
[2;36m                    [0m         [39mcompressed objects[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:                 [0m[1;35mif[0m[1;39m([0m[1;35mtrailer.containsKey[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                 [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                     int streamOffset = [0m[1;35mtrailer.getInt[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:@@ [0m[1;36m-170[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m173[0m[39m,[0m[1;36m7[0m[39m @@ public class XrefParser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                     [0m[1;35mtrailer.setLong[0m[1;39m([0m[39mCOSName.PREV, prev[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                 [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:-            if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:+            if [0m[1;39m([0m[1;35mprevSet.contains[0m[1;39m([0m[39mprev[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:             [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:                 throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_7/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m25[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java [0m      [2m                [0m
[2;36m                    [0m         [39mb/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index 949b259c3..f4a3c6f66 [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-180[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m180[0m[39m,[0m[1;36m7[0m[39m @@ public class PDPageTree implements COSObjectable, [0m            [2m                [0m
[2;36m                    [0m         [39mIterable<PDPage>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:     private final class PageIterator implements Iterator<PDPage>[0m                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:     [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:         private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+        private Set<COSDictionary> seen = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:         private [0m[1;35mPageIterator[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:         [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:             List<COSDictionary> kids = [0m[1;35menqueueKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:@@ [0m[1;36m-205[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m205[0m[39m,[0m[1;36m11[0m[39m @@ public class PDPageTree implements COSObjectable, [0m          [2m                [0m
[2;36m                    [0m         [39mIterable<PDPage>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:          *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:         private List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:         [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:+            if [0m[1;39m([0m[1;35mseen.contains[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:+                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Found an infinite loop in the page tree"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:+                return Collections.EMPTY_LIST;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:+            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:+            [0m[1;35mseen.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:             if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:             [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:                 return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:556[0m[39m-[0m[1;36m563[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:        Token peekToken = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:        while [0m[1;39m([0m[39mpeekToken != null && ![0m[32m"Private"[0m[1;35m.equals[0m[1;39m([0m[1;35mpeekToken.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:            [0m[35m/[0m[35m/[0m[39m for a more thorough validation, the presence of [0m[32m"begin"[0m[39m before [0m  [2m                [0m
[2;36m                    [0m         [39mPrivate[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:            [0m[35m/[0m[35m/[0m[39m determines how code before and following charstrings should look[0m [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:            [0m[35m/[0m[35m/[0m[39m it is not currently checked anyway[0m                               [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:            peekToken = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:640[0m[39m-[0m[1;36m644[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:        while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:                && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BruteForceParser.jav[0m[1;92ma:780[0m[39m-[0m[1;36m809[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:    private long [0m[1;35mfindString[0m[1;39m([0m[39mchar[0m[1;39m[[0m[1;39m][0m[39m string[0m[1;39m)[0m[39m throws IOException[0m                   [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:        long position = -1L;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:        int stringLength = string.length;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:        int counter = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:        int readChar = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:        while [0m[1;39m([0m[39mreadChar != [0m[1;36m-1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:            if [0m[1;39m([0m[39mreadChar == string[0m[1;39m[[0m[39mcounter[0m[1;39m][0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:                if [0m[1;39m([0m[39mcounter == [0m[1;36m0[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:                    position = [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:                counter++;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:                if [0m[1;39m([0m[39mcounter == stringLength[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:                    return position;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:            else if [0m[1;39m([0m[39mcounter > [0m[1;36m0[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:                counter = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:                position = -1L;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:                continue;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:            readChar = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:        return position;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.jav[0m[1;92ma:281[0m[39m-[0m[1;36m328[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:    protected COSDictionary [0m[1;35mparseCOSDictionary[0m[1;39m([0m[39mboolean isDirect[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        [0m[1;35mreadExpectedChar[0m[1;39m([0m[32m'<'[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        [0m[1;35mreadExpectedChar[0m[1;39m([0m[32m'<'[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:        [0m[1;35mskipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        COSDictionary obj = new [0m[1;35mCOSDictionary[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:        [0m[1;35mobj.setDirect[0m[1;39m([0m[39misDirect[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:            [0m[1;35mskipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            char c = [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m [0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:            if [0m[1;39m([0m[39mc == [0m[32m'>'[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:            else if [0m[1;39m([0m[39mc == [0m[32m'/'[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                [0m[35m/[0m[35m/[0m[39m something went wrong, most likely the dictionary is [0m         [2m                [0m
[2;36m                    [0m         [39mcorrupted[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                [0m[35m/[0m[35m/[0m[39m stop immediately and return everything read so far[0m           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mparseCOSDictionaryNameValuePair[0m[1;39m([0m[39mobj[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                    return obj;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:                [0m[35m/[0m[35m/[0m[39m invalid dictionary, we were expecting a [0m[35m/[0m[95mName[0m[39m, read until [0m   [2m                [0m
[2;36m                    [0m         [39mthe end or until we can recover[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Invalid dictionary, found: '[0m[32m{[0m[32m}[0m[32m' but expected: '/' at [0m [2m                [0m
[2;36m                    [0m         [32moffset [0m[32m{[0m[32m}[0m[32m"[0m[39m, c,[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:                        [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:                if [0m[1;39m([0m[1;35mreadUntilEndOfCOSDictionary[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                    [0m[35m/[0m[35m/[0m[39m we couldn't recover[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:                    return obj;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:        try[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:            [0m[1;35mreadExpectedChar[0m[1;39m([0m[32m'>'[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:            [0m[1;35mreadExpectedChar[0m[1;39m([0m[32m'>'[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:        catch [0m[1;39m([0m[39mIOException exception[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Invalid dictionary, can't find end of dictionary at [0m      [2m                [0m
[2;36m                    [0m         [32moffset [0m[32m{[0m[32m}[0m[32m"[0m[39m,[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:                    [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:        return obj;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.jav[0m[1;92ma:339[0m[39m-[0m[1;36m375[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:    private boolean [0m[1;35mreadUntilEndOfCOSDictionary[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m            [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:        int c = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:        while [0m[1;39m([0m[39mc != [0m[1;36m-1[0m[39m && c != [0m[32m'/'[0m[39m && c != [0m[32m'>'[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:            [0m[35m/[0m[35m/[0m[39m in addition to stopping when we find [0m[35m/[0m[39m or >, we also want[0m        [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:            [0m[35m/[0m[35m/[0m[39m to stop when we find endstream or endobj.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:            if [0m[1;39m([0m[39mc == E[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:                c = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:                if [0m[1;39m([0m[39mc == N[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:                    c = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:                    if [0m[1;39m([0m[39mc == D[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:                        c = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:                        boolean isStream = c == S && [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m == T && [0m     [2m                [0m
[2;36m                    [0m         [1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m == R[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:                                && [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m == E && [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m == A && [0m [2m                [0m
[2;36m                    [0m         [1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m == M;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:                        boolean isObj = !isStream && c == O && [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m ==[0m [2m                [0m
[2;36m                    [0m         [39mB[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:                                && [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m == J;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:                        if [0m[1;39m([0m[39misStream || isObj[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:                            [0m[35m/[0m[35m/[0m[39m we're done reading this object![0m                  [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:                            return true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:            c = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:        if [0m[1;39m([0m[39mc == [0m[1;36m-1[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            return true;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        [0m[1;35msource.rewind[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:        return false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.jav[0m[1;92ma:528[0m[39m-[0m[1;36m679[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:    protected COSString [0m[1;35mparseCOSString[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                     [2m                [0m
[2;36m                    [0m         [1;36m529[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:        char nextChar = [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:        if [0m[1;39m([0m[39mnextChar == [0m[32m'<'[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:            return [0m[1;35mparseCOSHexString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m535[0m[39m:        else if [0m[1;39m([0m[39mnextChar != [0m[32m'[0m[32m([0m[32m'[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m536[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m537[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39m [0m[32m"parseCOSString string should start with '[0m[32m([0m[32m'[0m [2m                [0m
[2;36m                    [0m         [32mor '<' and not '"[0m[39m +[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m538[0m[39m:                    nextChar + [0m[32m"' at offset "[0m[39m + [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m539[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m540[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m541[0m[39m:        ByteArrayOutputStream out = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m542[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m543[0m[39m:        [0m[35m/[0m[35m/[0m[39m This is the number of braces read[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m544[0m[39m:        int braces = [0m[1;36m1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m545[0m[39m:        int c = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m546[0m[39m:        [0m[1;35mwhile[0m[1;39m([0m[39m braces > [0m[1;36m0[0m[39m && c != [0m[1;36m-1[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m547[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m548[0m[39m:            char ch = [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39mc;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m549[0m[39m:            int nextc = [0m[1;36m-2[0m[39m; [0m[35m/[0m[35m/[0m[39m not yet read[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m550[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m551[0m[39m:            if [0m[1;39m([0m[39mch == [0m[32m'[0m[32m)[0m[32m'[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m552[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m553[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m554[0m[39m:                braces--;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:                braces = [0m[1;35mcheckForEndOfString[0m[1;39m([0m[39mbraces[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m braces != [0m[1;36m0[0m[39m [0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mch[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:            else if [0m[1;39m([0m[39mch == [0m[32m'[0m[32m([0m[32m'[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:                braces++;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:                [0m[1;35mout.write[0m[1;39m([0m[39mch[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m566[0m[39m:            else [0m[1;35mif[0m[1;39m([0m[39m ch == '\\' [0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m567[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m568[0m[39m:                [0m[35m/[0m[35m/[0m[95mpatched[0m[39m by ram[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m569[0m[39m:                char next = [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m570[0m[39m:                [0m[1;35mswitch[0m[1;39m([0m[39mnext[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m571[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m572[0m[39m:                    case [0m[32m'n'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m573[0m[39m:                        [0m[1;35mout.write[0m[1;39m([0m[32m'\n'[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m574[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:                    case [0m[32m'r'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:                        [0m[1;35mout.write[0m[1;39m([0m[32m'\r'[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:                    case [0m[32m't'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:                        [0m[1;35mout.write[0m[1;39m([0m[32m'\t'[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:                    case [0m[32m'b'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:                        [0m[1;35mout.write[0m[1;39m([0m[32m'\b'[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:                    case [0m[32m'f'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:                        [0m[1;35mout.write[0m[1;39m([0m[32m'\f'[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:                    case [0m[32m'[0m[32m)[0m[32m'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:                        [0m[35m/[0m[35m/[0m[39m PDFBox [0m[1;36m276[0m[39m [0m[35m/[0m[95mTitle[0m[39m [0m[1;39m([0m[39mc:\[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:                    braces = [0m[1;35mcheckForEndOfString[0m[1;39m([0m[39mbraces[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:                        [0m[1;35mif[0m[1;39m([0m[39m braces != [0m[1;36m0[0m[39m [0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:                            [0m[1;35mout.write[0m[1;39m([0m[39mnext[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:                        else[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:                            [0m[1;35mout.write[0m[1;39m([0m[39m'\\'[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:                    case [0m[32m'[0m[32m([0m[32m'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:                    case '\\':[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:                        [0m[1;35mout.write[0m[1;39m([0m[39mnext[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m602[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m603[0m[39m:                    case ASCII_LF:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m604[0m[39m:                    case ASCII_CR:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m605[0m[39m:                        [0m[35m/[0m[35m/[0m[95mthis[0m[39m is a break in the line so ignore it and the [0m     [2m                [0m
[2;36m                    [0m         [39mnewline and continue[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m606[0m[39m:                        c = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m607[0m[39m:                        [0m[1;35mwhile[0m[1;39m([0m[39m [0m[1;35misEOL[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m && c != [0m[1;36m-1[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m608[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m609[0m[39m:                            c = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m610[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m611[0m[39m:                        nextc = c;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m612[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m613[0m[39m:                    case [0m[32m'0'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m614[0m[39m:                    case [0m[32m'1'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m615[0m[39m:                    case [0m[32m'2'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m616[0m[39m:                    case [0m[32m'3'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m617[0m[39m:                    case [0m[32m'4'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m618[0m[39m:                    case [0m[32m'5'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m619[0m[39m:                    case [0m[32m'6'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m620[0m[39m:                    case [0m[32m'7'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m621[0m[39m:                        StringBuilder octal = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m622[0m[39m:                        [0m[1;35moctal.append[0m[1;39m([0m[39m next [0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m623[0m[39m:                        c = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m624[0m[39m:                        char digit = [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39mc;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m625[0m[39m:                        [0m[1;35mif[0m[1;39m([0m[39m digit >= [0m[32m'0'[0m[39m && digit <= [0m[32m'7'[0m[39m [0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m626[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:                            [0m[1;35moctal.append[0m[1;39m([0m[39m digit [0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m628[0m[39m:                            c = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m629[0m[39m:                            digit = [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39mc;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m630[0m[39m:                            [0m[1;35mif[0m[1;39m([0m[39m digit >= [0m[32m'0'[0m[39m && digit <= [0m[32m'7'[0m[39m [0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m631[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:                                [0m[1;35moctal.append[0m[1;39m([0m[39m digit [0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:                            else[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:                            [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:                                nextc = c;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:                        else[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:                            nextc = c;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:                        int character = [0m[1;36m0[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:                        try[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:                            character = [0m[1;35mInteger.parseInt[0m[1;39m([0m[39m [0m[1;35moctal.toString[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;36m8[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:                        [0m[1;35mcatch[0m[1;39m([0m[39m NumberFormatException e [0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:                            throw new [0m[1;35mIOException[0m[1;39m([0m[39m [0m[32m"Error: Expected octal [0m      [2m                [0m
[2;36m                    [0m         [32mcharacter, [0m[32mactual[0m[32m='"[0m[39m + octal + [0m[32m"'"[0m[39m, e [0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:                        [0m[1;35mout.write[0m[1;39m([0m[39mcharacter[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:                    default:[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:                        [0m[35m/[0m[35m/[0m[39m dropping the backslash[0m                               [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:                        [0m[35m/[0m[35m/[0m[39m see [0m[1;92m7.3.4.2[0m[39m Literal Strings for further information[0m  [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:                        [0m[1;35mout.write[0m[1;39m([0m[39mnext[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:                [0m[1;35mout.write[0m[1;39m([0m[39mch[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:            if [0m[1;39m([0m[39mnextc != [0m[1;36m-2[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:                c = nextc;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:                c = [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:        if [0m[1;39m([0m[39mc != [0m[1;36m-1[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:            [0m[1;35msource.rewind[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:        return new [0m[1;35mCOSString[0m[1;39m([0m[1;35mout.toByteArray[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.jav[0m[1;92ma:429[0m[39m-[0m[1;36m444[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:    public COSBase [0m[1;35mdereferenceCOSObject[0m[1;39m([0m[39mCOSObject obj[0m[1;39m)[0m[39m throws IOException[0m       [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:        long currentPos = [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:        COSObjectKey key = [0m[1;35mobj.getKey[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:        COSBase parsedObj = [0m[1;35mparseObjectDynamically[0m[1;39m([0m[39mkey, false[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:        if [0m[1;39m([0m[39mparsedObj != null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:            [0m[1;35mparsedObj.setDirect[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:            [0m[1;35mparsedObj.setKey[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:        if [0m[1;39m([0m[39mcurrentPos > [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:            [0m[1;35msource.seek[0m[1;39m([0m[39mcurrentPos[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:        return parsedObj;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.jav[0m[1;92ma:465[0m[39m-[0m[1;36m496[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m465[0m[39m:    private synchronized COSBase [0m[1;35mparseObjectDynamically[0m[1;39m([0m[39mCOSObjectKey objKey,[0m    [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:            boolean requireExistingNotCompressedObj[0m[1;39m)[0m[39m throws IOException[0m         [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:        COSObject pdfObject = [0m[1;35mdocument.getObjectFromPool[0m[1;39m([0m[39mobjKey[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mpdfObject.isObjectNull[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:            return [0m[1;35mpdfObject.getObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        Long offsetOrObjstmObNr = [0m[1;35mgetObjectOffset[0m[1;39m([0m[39mobjKey, [0m                      [2m                [0m
[2;36m                    [0m         [39mrequireExistingNotCompressedObj[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        COSBase referencedObject = null;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        if [0m[1;39m([0m[39moffsetOrObjstmObNr != null[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[39moffsetOrObjstmObNr > [0m[1;36m0[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                referencedObject = [0m[1;35mparseFileObject[0m[1;39m([0m[39moffsetOrObjstmObNr, objKey[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:                [0m[35m/[0m[35m/[0m[39m xref value is object nr of object stream containing object [0m  [2m                [0m
[2;36m                    [0m         [39mto be parsed[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                [0m[35m/[0m[35m/[0m[39m since our object was not found it means object stream was [0m   [2m                [0m
[2;36m                    [0m         [39mnot parsed so far[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                referencedObject = [0m[1;35mparseObjectStreamObject[0m[1;39m([0m[39m-offsetOrObjstmObNr,[0m [2m                [0m
[2;36m                    [0m         [39mobjKey[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:        if [0m[1;39m([0m[39mreferencedObject == null || referencedObject instanceof COSNull[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[35m/[0m[35m/[0m[39m not defined object -> NULL object [0m[1;39m([0m[39mSpec. [0m[1;36m1.7[0m[39m, chap. [0m[1;36m3.2[0m[39m.[0m[1;36m9[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:            [0m[35m/[0m[35m/[0m[39m or some other issue with dereferencing[0m                           [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:            [0m[35m/[0m[35m/[0m[39m remove parser to avoid endless recursion[0m                         [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:            [0m[1;35mpdfObject.setToNull[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:        return referencedObject;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.jav[0m[1;92ma:621[0m[39m-[0m[1;36m658[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m621[0m[39m:    protected COSBase [0m[1;35mparseObjectStreamObject[0m[1;39m([0m[39mlong objstmObjNr, COSObjectKey [0m   [2m                [0m
[2;36m                    [0m         [39mkey[0m[1;39m)[0m[39m throws IOException[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m622[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m623[0m[39m:        Map<COSObjectKey, COSBase> streamObjects = [0m                             [2m                [0m
[2;36m                    [0m         [1;35mdecompressedObjects.computeIfAbsent[0m[1;39m([0m[39mobjstmObjNr,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m624[0m[39m:                n -> new HashMap<>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m625[0m[39m:        [0m[35m/[0m[35m/[0m[39m did we already read the compressed object stream?[0m                    [2m                [0m
[2;36m                    [0m         [1;36m626[0m[39m:        COSBase objectStreamObject = [0m[1;35mstreamObjects.remove[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:        if [0m[1;39m([0m[39mobjectStreamObject != null[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m628[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m629[0m[39m:            return objectStreamObject;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m630[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m631[0m[39m:        final COSObjectKey objKey = [0m[1;35mgetObjectKey[0m[1;39m([0m[39mobjstmObjNr, [0m[1;36m0[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:        final COSBase objstmBaseObj = [0m                                          [2m                [0m
[2;36m                    [0m         [1;35mdocument.getObjectFromPool[0m[1;39m([0m[39mobjKey[0m[1;39m)[0m[1;35m.getObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:        if [0m[1;39m([0m[39mobjstmBaseObj instanceof COSStream[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:            try[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:                PDFObjectStreamParser parser = new [0m                             [2m                [0m
[2;36m                    [0m         [1;35mPDFObjectStreamParser[0m[1;39m([0m[1;39m([0m[39mCOSStream[0m[1;39m)[0m[39m objstmBaseObj,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:                        document[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:                Map<COSObjectKey, COSBase> allStreamObjects = [0m                  [2m                [0m
[2;36m                    [0m         [1;35mparser.parseAllObjects[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:                objectStreamObject = [0m[1;35mallStreamObjects.remove[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:                [0m[1;35mallStreamObjects.entrySet[0m[1;39m([0m[1;39m)[0m[1;35m.stream[0m[1;39m([0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:                        [0m[1;35m.forEach[0m[1;39m([0m[39me -> [0m[1;35mstreamObjects.putIfAbsent[0m[1;39m([0m[1;35me.getKey[0m[1;39m([0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;35me.getValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:            catch [0m[1;39m([0m[39mIOException ex[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:                if [0m[1;39m([0m[39misLenient[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:                    [0m[1;35mLOG.error[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[32m"object stream [0m[32m{[0m[32m}[0m[32m could not be parsed due [0m  [2m                [0m
[2;36m                    [0m         [32mto an exception"[0m[39m +[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:                            objstmObjNr, ex[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:                else[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:                    throw ex;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:        return objectStreamObject;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:706[0m[39m-[0m[1;36m743[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:    private void [0m[1;35mreadSubrs[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                        [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:        [0m[35m/[0m[35m/[0m[39m allocate size [0m[1;39m([0m[39marray indexes may not be in-order[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:            [0m[1;35mfont.subrs.add[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:            if [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                  [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:            Token index = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:            [0m[35m/[0m[35m/[0m[39m RD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:            Token charstring = [0m[1;35mread[0m[1;39m([0m[39mToken.CHARSTRING[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:            int j = [0m[1;35mindex.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:            if [0m[1;39m([0m[39mj < [0m[1;35mfont.subrs.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                [0m[1;35mfont.subrs.set[0m[1;39m([0m[39mj, [0m[1;35mdecrypt[0m[1;39m([0m[1;35mcharstring.getData[0m[1;39m([0m[1;39m)[0m[39m, CHARSTRING_KEY,[0m [2m                [0m
[2;36m                    [0m         [39mlenIV[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:            [0m[1;35mreadPut[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:        [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:777[0m[39m-[0m[1;36m813[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:    private void [0m[1;35mreadCharStrings[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                  [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dict"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:        [0m[35m/[0m[35m/[0m[39m could actually be a sequence ending in [0m[32m"CharStrings begin"[0m[39m, too[0m      [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:        [0m[35m/[0m[35m/[0m[39m instead of the [0m[32m"dup begin"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"begin"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:                [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"end"[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:            [0m[35m/[0m[35m/[0m[39m key/value[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:            String name = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:            [0m[35m/[0m[35m/[0m[39m RD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:            Token charstring = [0m[1;35mread[0m[1;39m([0m[39mToken.CHARSTRING[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:            [0m[1;35mfont.charstrings.put[0m[1;39m([0m[39mname, [0m[1;35mdecrypt[0m[1;39m([0m[1;35mcharstring.getData[0m[1;39m([0m[1;39m)[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39mCHARSTRING_KEY, lenIV[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:            [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:        [0m[35m/[0m[35m/[0m[39m some fonts have one [0m[32m"end"[0m[39m, others two[0m                                [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"end"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:        [0m[35m/[0m[35m/[0m[39m since checking ends here, this does not matter [0m[33m...[0m[39m.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:        [0m[35m/[0m[35m/[0m[39m more thorough checking would see whether there is [0m[32m"begin"[0m[39m before [0m    [2m                [0m
[2;36m                    [0m         [35m/[0m[95mPrivate[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:        [0m[35m/[0m[35m/[0m[39m and expect a [0m[32m"def"[0m[39m somewhere, otherwise a [0m[32m"put"[0m                      [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/README.m[0m[1;92md:1[0m[39m-[0m[1;36m11[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What design decisions were considered for this challenge?[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Unlike with commons-compress, where we focused on individual challenges,[0m          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:we wanted to add a large number of vulnerabilities into on large full repository [0m [2m                [0m
[2;36m                    [0m         [39mscan.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:# Why this set of vulnerabilities?[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:While there's a heavy focus on the Type1 font parser, there are vulnerabilities[0m   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:that also focus on general structure of the PDF file.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:# Delta vs Full and why?[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:See above. We wanted at least one challenge to be a full repository challenge [0m   [2m                [0m
[2;36m                    [0m         [39mwith a [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:large number of vulnerabilities.[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_3/README.m[0m[1;92md:1[0m[39m-[0m[1;36m19[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What functions and functionality is relevant?[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Parsing a Type1 font embedded in a PDF.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:# Why is this vulnerable?[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m5:Fa[0m[39milure to check if next value is null.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:# Is this a replay and/or is inspired by anything?[0m                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:This reintroduces an infinite loop fixed on PDFBOX-[0m[1;36m5624[0m                           [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:# What makes it interesting?[0m                                                     [2m                [0m
[2;36m                    [0m         [1;92m11:A[0m[39ms with the other Type1 font vulnerabilities, the POV was[0m                        [2m                [0m
[2;36m                    [0m         [1;92m12:fa[0m[39mirly easily generated with a custom harness and a custom seed corpus.[0m          [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:However, neither of these resources were made available in the competition.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m15:F[0m[39murther, finding the vulnerability is non-trivial.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:# Additional details[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:* [0m[4;94mhttps://issues.apache.org/jira/browse/PDFBOX-5624[0m                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:* [0m                                                                               [2m                [0m
[2;36m                    [0m         [4;94mhttps://github.com/apache/pdfbox/commit/aa7dc6ccd1c3055b70c8084d7bf383f799047ad5[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_8/README.m[0m[1;92md:1[0m[39m-[0m[1;36m23[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What functions and functionality is relevant?[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Parsing an xref table in a PDF.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:# Why is this vulnerable?[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:There's no check for circular references in the xref table.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:# Is this a replay and/or is inspired by anything?[0m                                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:This is a replay of a famous infinite loop/Denial of Service[0m                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:vulnerability that was fixed in PDFBOX-[0m[1;36m3919[0m[39m. Andreas Bogk[0m                         [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:presented this vulnerability at Chaos Communication Camp in [0m[1;36m2011[0m[39m.[0m                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:It affected poppler, qpdf and PDFBox among, probably, many other[0m                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:PDF parsers.[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:# What makes it interesting?[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:This is a very famous vulnerability. It would be challenging[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:to identify and patch without historical context.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:# Additional details[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:The POV is taken from: [0m                                                          [2m                [0m
[2;36m                    [0m         [4;94mhttps://bugs.launchpad.net/ubuntu/+source/poppler/+bug/825554[0m                       [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:See also: [0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:* [0m[4;94mhttps://www.ieee-security.org/TC/SPW2014/papers/5103a198.PDF[0m[39m [0m                  [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:* [0m                                                                               [2m                [0m
[2;36m                    [0m         [4;94mhttps://www.bleepingcomputer.com/news/software/six-year-old-loop-bug-re-discovered-[0m [2m                [0m
[2;36m                    [0m         [4;94mto-affect-almost-all-major-pdf-viewers/[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:* [0m                                                                               [2m                [0m
[2;36m                    [0m         [4;94mhttps://blog.fuzzing-project.org/59-Six-year-old-PDF-loop-bug-affects-most-major-im[0m [2m                [0m
[2;36m                    [0m         [4;94mplementations.html[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.jav[0m[1;92ma:180[0m[39m-[0m[1;36m220[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    private final class PageIterator implements Iterator<PDPage>[0m                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        private [0m[1;35mPageIterator[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            List<COSDictionary> kids = [0m[1;35menqueueKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            while [0m[1;39m([0m[39m![0m[1;35mkids.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                List<COSDictionary> newKids = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                for [0m[1;39m([0m[39mCOSDictionary kid : kids[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:                    [0m[1;35mnewKids.addAll[0m[1;39m([0m[1;35menqueueKids[0m[1;39m([0m[39mkid[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                kids = newKids;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[35m/[0m[39m**[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:         * This takes a node, and, if it is a page adds it to the queue.[0m        [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:         * If it is a PageTreeNode, it returns the children for that node.[0m      [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:         *[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:         * @param node[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:         * @return[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        private List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:            if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                if [0m[1;39m([0m[39mnode != null && [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mCOSName.PAGE.equals[0m[1;39m([0m[1;35mnode.getCOSName[0m[1;39m([0m[39mCOSName.TYPE[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                    [0m[1;35mqueue.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                else[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                    [0m[1;35mLOG.error[0m[1;39m([0m[32m"Page skipped due to an invalid or missing type [0m  [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m,[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.jav[0m[1;92ma:713[0m[39m-[0m[1;36m777[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:    protected COSStream [0m[1;35mparseCOSStream[0m[1;39m([0m[39mCOSDictionary dic[0m[1;39m)[0m[39m throws IOException[0m    [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:        [0m[35m/[0m[35m/[0m[39m read [0m[32m'stream'[0m[39m; this was already tested in [0m[1;35mparseObjectsDynamically[0m[1;39m([0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:        [0m[1;35mreadString[0m[1;39m([0m[1;39m)[0m[39m; [0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:        [0m[1;35mskipWhiteSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:        [0m[35m/[0m[39m*[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:         * This needs to be dic.getItem because when we are parsing, the [0m       [2m                [0m
[2;36m                    [0m         [39munderlying object might still be null.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:        COSNumber streamLengthObj = [0m[1;35mgetLength[0m[1;39m([0m[1;35mdic.getItem[0m[1;39m([0m[39mCOSName.LENGTH[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:        if [0m[1;39m([0m[39mstreamLengthObj == null[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:            if [0m[1;39m([0m[39misLenient[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:                        [0m[32m"The stream doesn't provide any stream length, using [0m   [2m                [0m
[2;36m                    [0m         [32mfallback readUntilEnd, at offset [0m[32m{[0m[32m}[0m[32m"[0m[39m,[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:                        [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Missing length for stream."[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:        long streamStartPosition = [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:        long streamLength;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:        if [0m[1;39m([0m[39mstreamLengthObj != null && [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mvalidateStreamLength[0m[1;39m([0m[1;35mstreamLengthObj.longValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:            streamLength = [0m[1;35mstreamLengthObj.longValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:            [0m[35m/[0m[35m/[0m[39m skip stream[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:            [0m[1;35msource.seek[0m[1;39m([0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[39m + [0m[1;35mstreamLengthObj.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:            streamLength = [0m[1;35mreadUntilEndStream[0m[1;39m([0m[39mnew [0m[1;35mEndstreamFilterStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:            if [0m[1;39m([0m[39mstreamLengthObj == null || [0m[1;35mstreamLengthObj.longValue[0m[1;39m([0m[1;39m)[0m[39m != [0m      [2m                [0m
[2;36m                    [0m         [39mstreamLength[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:                [0m[1;35mdic.setLong[0m[1;39m([0m[39mCOSName.LENGTH, streamLength[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:        String endStream = [0m[1;35mreadString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:        if [0m[1;39m([0m[1;35mendStream.equals[0m[1;39m([0m[32m"endobj"[0m[1;39m)[0m[39m && isLenient[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"stream ends with 'endobj' instead of 'endstream' at [0m      [2m                [0m
[2;36m                    [0m         [32moffset [0m[32m{[0m[32m}[0m[32m"[0m[39m,[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:                    [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:            [0m[35m/[0m[35m/[0m[39m avoid follow-up warning about missing endobj[0m                     [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:            [0m[1;35msource.rewind[0m[1;39m([0m[39mENDOBJ.length[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:        else if [0m[1;39m([0m[1;35mendStream.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m9[0m[39m && isLenient && [0m                        [2m                [0m
[2;36m                    [0m         [1;35mendStream.startsWith[0m[1;39m([0m[39mENDSTREAM_STRING[0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"stream ends with '[0m[32m{[0m[32m}[0m[32m' instead of 'endstream' at offset [0m   [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m, endStream,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:                    [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:            [0m[35m/[0m[35m/[0m[39m unread the [0m[32m"extra"[0m[39m bytes[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;35msource.rewind[0m[1;39m([0m[1;35mendStream.substring[0m[1;39m([0m[1;36m9[0m[1;39m)[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.ISO_8859_1[0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:        else if [0m[1;39m([0m[39m![0m[1;35mendStream.equals[0m[1;39m([0m[39mENDSTREAM_STRING[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m772[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m                                              [2m                [0m
[2;36m                    [0m         [1;36m773[0m[39m:                    [0m[32m"Error reading stream, [0m[32mexpected[0m[32m='endstream' [0m[32mactual[0m[32m='"[0m       [2m                [0m
[2;36m                    [0m         [1;36m774[0m[39m:                            + endStream + [0m[32m"' at offset "[0m[39m + [0m                     [2m                [0m
[2;36m                    [0m         [1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m775[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m776[0m[39m:        return [0m[1;35mdocument.createCOSStream[0m[1;39m([0m[39mdic, streamStartPosition, [0m              [2m                [0m
[2;36m                    [0m         [39mstreamLength[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.jav[0m[1;92ma:755[0m[39m-[0m[1;36m822[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:    protected COSArray [0m[1;35mparseCOSArray[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                       [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:        long startPosition = [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:        [0m[1;35mreadExpectedChar[0m[1;39m([0m[32m'[0m[32m[[0m[32m'[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:        COSArray po = new [0m[1;35mCOSArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:        COSBase pbo;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:        [0m[1;35mskipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:        int i;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:        while [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mi = [0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m && [0m[1;39m([0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m i != [0m[32m'[0m[32m][0m[32m'[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:            pbo = [0m[1;35mparseDirObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39m pbo instanceof COSObject [0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:                [0m[35m/[0m[35m/[0m[39m the current empty COSObject is replaced with the correct one[0m [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:                pbo = null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:                [0m[35m/[0m[35m/[0m[39m We have to check if the expected values are there or not [0m    [2m                [0m
[2;36m                    [0m         [39mPDFBOX-[0m[1;36m385[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:                if [0m[1;39m([0m[1;35mpo.size[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m1[0m[39m && [0m[1;35mpo.get[0m[1;39m([0m[1;35mpo.size[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m instanceof [0m          [2m                [0m
[2;36m                    [0m         [39mCOSInteger[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m772[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m773[0m[39m:                    COSInteger genNumber = [0m[1;39m([0m[39mCOSInteger[0m[1;39m)[0m[1;35mpo.remove[0m[1;39m([0m[39m [0m[1;35mpo.size[0m[1;39m([0m[1;39m)[0m[39m [0m[1;36m-1[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m774[0m[39m:                    if [0m[1;39m([0m[1;35mpo.size[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[39m && [0m[1;35mpo.get[0m[1;39m([0m[1;35mpo.size[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m instanceof [0m      [2m                [0m
[2;36m                    [0m         [39mCOSInteger[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m775[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m776[0m[39m:                        COSInteger number = [0m[1;39m([0m[39mCOSInteger[0m[1;39m)[0m[1;35mpo.remove[0m[1;39m([0m[39m [0m[1;35mpo.size[0m[1;39m([0m[1;39m)[0m[39m [0m[1;36m-1[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:                        if [0m[1;39m([0m[1;35mnumber.longValue[0m[1;39m([0m[1;39m)[0m[39m >= [0m[1;36m0[0m[39m && [0m[1;35mgenNumber.intValue[0m[1;39m([0m[1;39m)[0m[39m >= [0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:                            COSObjectKey key = [0m[1;35mgetObjectKey[0m[1;39m([0m[1;35mnumber.longValue[0m[1;39m([0m[1;39m)[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:                                    [0m[1;35mgenNumber.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:                            pbo = [0m[1;35mgetObjectFromPool[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:                        else[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:                            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Invalid value[0m[32m([0m[32ms[0m[32m)[0m[32m for an object key [0m[32m{[0m[32m}[0m[32m [0m    [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m, [0m[1;35mnumber.longValue[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:                                    [0m[1;35mgenNumber.intValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:            [0m[35m/[0m[35m/[0m[39m something went wrong[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:            if [0m[1;39m([0m[39mpbo == null[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:                [0m[35m/[0m[35m/[0m[95mit[0m[39m could be a bad object in the array which is just skipped[0m   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Corrupt array element at offset [0m[32m{[0m[32m}[0m[32m, start offset: [0m    [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m,[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:                        [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[39m, startPosition[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:                String isThisTheEnd = [0m[1;35mreadString[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:                [0m[35m/[0m[35m/[0m[39m return immediately if a corrupt element is followed by [0m      [2m                [0m
[2;36m                    [0m         [39manother array[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:                [0m[35m/[0m[35m/[0m[39m to avoid a possible infinite recursion as most likely the [0m   [2m                [0m
[2;36m                    [0m         [39mwhole array is corrupted[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:                if [0m[1;39m([0m[1;35misThisTheEnd.isEmpty[0m[1;39m([0m[1;39m)[0m[39m && [0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m == [0m[32m'[0m[32m[[0m[32m'[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:                    return po;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35msource.rewind[0m[1;39m([0m[1;35misThisTheEnd.getBytes[0m[1;39m([0m[39mStandardCharsets.ISO_8859_1[0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:                [0m[35m/[0m[35m/[0m[39m This could also be an [0m[32m"endobj"[0m[39m or [0m[32m"endstream"[0m[39m which means we[0m [2m                [0m
[2;36m                    [0m         [39mcan assume that[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:                [0m[35m/[0m[35m/[0m[39m the array has ended.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:                [0m[1;35mif[0m[1;39m([0m[1;35mENDOBJ_STRING.equals[0m[1;39m([0m[39misThisTheEnd[0m[1;39m)[0m[39m || [0m                       [2m                [0m
[2;36m                    [0m         [1;35mENDSTREAM_STRING.equals[0m[1;39m([0m[39misThisTheEnd[0m[1;39m)[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:                    return po;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:                [0m[1;35mpo.add[0m[1;39m([0m[39mpbo[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:            [0m[1;35mskipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:        [0m[35m/[0m[35m/[0m[39m read [0m[32m'[0m[32m][0m[32m'[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:        [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:        [0m[1;35mskipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:        return po;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.jav[0m[1;92ma:948[0m[39m-[0m[1;36m1016[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m948[0m[39m:    protected COSBase [0m[1;35mparseDirObject[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                       [2m                [0m
[2;36m                    [0m         [1;36m949[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m950[0m[39m:        [0m[1;35mskipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m951[0m[39m:        char c = [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m [0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m952[0m[39m:        [0m[1;35mswitch[0m[1;39m([0m[39mc[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m953[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m954[0m[39m:        case [0m[32m'<'[0m[39m:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m955[0m[39m:            [0m[35m/[0m[35m/[0m[39m pull off first left bracket[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m956[0m[39m:            [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m957[0m[39m:            [0m[35m/[0m[35m/[0m[39m check for second left bracket[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m958[0m[39m:            c = [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m [0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m959[0m[39m:            [0m[1;35msource.rewind[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m960[0m[39m:            return c == [0m[32m'<'[0m[39m ? [0m[1;35mparseCOSDictionary[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m : [0m[1;35mparseCOSString[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m961[0m[39m:        case [0m[32m'[0m[32m[[0m[32m'[0m[39m:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m962[0m[39m:            [0m[35m/[0m[35m/[0m[39m array[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m963[0m[39m:            return [0m[1;35mparseCOSArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m964[0m[39m:        case [0m[32m'[0m[32m([0m[32m'[0m[39m:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m965[0m[39m:            return [0m[1;35mparseCOSString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m966[0m[39m:        case [0m[32m'/'[0m[39m:   [0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m967[0m[39m:            [0m[35m/[0m[35m/[0m[39m name[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m968[0m[39m:            return [0m[1;35mparseCOSName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m969[0m[39m:        case [0m[32m'n'[0m[39m:   [0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m970[0m[39m:            [0m[35m/[0m[35m/[0m[39m null[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m971[0m[39m:            [0m[1;35mreadExpectedString[0m[1;39m([0m[39mNULL, false[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m972[0m[39m:            return COSNull.NULL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m973[0m[39m:        case [0m[32m't'[0m[39m:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:            [0m[1;35mreadExpectedString[0m[1;39m([0m[39mTRUE, false[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:            return COSBoolean.TRUE;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:        case [0m[32m'f'[0m[39m:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:            [0m[1;35mreadExpectedString[0m[1;39m([0m[39mFALSE, false[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:            return COSBoolean.FALSE;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:        case [0m[32m'R'[0m[39m:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:            [0m[1;35msource.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:            return new [0m[1;35mCOSObject[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:        case [0m[1;39m([0m[39mchar[0m[1;39m)[0m[1;36m-1[0m[39m:[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:        default:[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m985[0m[39m:            if [0m[1;39m([0m[1;35misDigit[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m || c == [0m[32m'-'[0m[39m || c == [0m[32m'+'[0m[39m || c == [0m[32m'.'[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m986[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m987[0m[39m:                return [0m[1;35mparseCOSNumber[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m988[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m989[0m[39m:            [0m[35m/[0m[35m/[0m[39m This is not suppose to happen, but we will allow for it[0m          [2m                [0m
[2;36m                    [0m         [1;36m990[0m[39m:            [0m[35m/[0m[35m/[0m[39m so we are more compatible with POS writers that don't[0m            [2m                [0m
[2;36m                    [0m         [1;36m991[0m[39m:            [0m[35m/[0m[35m/[0m[39m follow the spec[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m992[0m[39m:            long startOffset = [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m993[0m[39m:            String badString = [0m[1;35mreadString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m994[0m[39m:            if [0m[1;39m([0m[1;35mbadString.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m995[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m996[0m[39m:                int peek = [0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m997[0m[39m:                [0m[35m/[0m[35m/[0m[39m we can end up in an infinite loop otherwise[0m                  [2m                [0m
[2;36m                    [0m         [1;36m998[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unknown dir object [0m[32mc[0m[32m='"[0m[39m + c + [0m[32m"' [0m[32mcInt[0m[32m="[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m c + [0m[32m" [0m[32mpeek[0m[32m='"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m999[0m[39m:                        + [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m peek + [0m[32m"' [0m[32mpeekInt[0m[32m="[0m[39m + peek + [0m[32m" at offset "[0m[39m + [0m  [2m                [0m
[2;36m                    [0m         [1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1000[0m[39m:                        + [0m[32m" [0m[32m([0m[32mstart offset: "[0m[39m + startOffset + [0m[32m"[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1001[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1002[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1003[0m[39m:            [0m[35m/[0m[35m/[0m[39m if it's an endstream/endobj, we want to put it back so the [0m     [2m                [0m
[2;36m                    [0m         [39mcaller will see it[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1004[0m[39m:            if [0m[1;39m([0m[1;35mENDOBJ_STRING.equals[0m[1;39m([0m[39mbadString[0m[1;39m)[0m[39m || [0m                            [2m                [0m
[2;36m                    [0m         [1;35mENDSTREAM_STRING.equals[0m[1;39m([0m[39mbadString[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1005[0m[39m:            [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1006[0m[39m:                [0m                                                               [2m                [0m
[2;36m                    [0m         [1;35msource.rewind[0m[1;39m([0m[1;35mbadString.getBytes[0m[1;39m([0m[39mStandardCharsets.ISO_8859_1[0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1007[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1008[0m[39m:            else[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1009[0m[39m:            [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1010[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Skipped unexpected dir object = '[0m[32m{[0m[32m}[0m[32m' at offset [0m[32m{[0m[32m}[0m[32m [0m   [2m                [0m
[2;36m                    [0m         [32m([0m[32mstart offset: [0m[32m{[0m[32m}[0m[32m)[0m[32m"[0m[39m,[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1011[0m[39m:                        badString, [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[39m, startOffset[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1012[0m[39m:                return this instanceof PDFStreamParser ? null : COSNull.NULL;[0m  [2m                [0m
[2;36m                    [0m         [1;36m1013[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1014[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1015[0m[39m:        return null;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1016[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/COSParser.jav[0m[1;92ma:62[0m[39m-[0m[1;36m141[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:public class COSParser extends BaseParser implements ICOSParser[0m                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    private static final String PDF_[0m[1;33mHEAD[0m[39mER = [0m[32m"%PDF-"[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private static final String FDF_[0m[1;33mHEAD[0m[39mER = [0m[32m"%FDF-"[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private static final String PDF_DEFAULT_VERSION = [0m[32m"1.4"[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private static final String FDF_DEFAULT_VERSION = [0m[32m"1.0"[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    private static final char[0m[1;39m[[0m[1;39m][0m[39m STARTXREF = [0m[1;39m{[0m[39m [0m                                   [2m                [0m
[2;36m                    [0m         [32m's'[0m[39m,[0m[32m't'[0m[39m,[0m[32m'a'[0m[39m,[0m[32m'r'[0m[39m,[0m[32m't'[0m[39m,[0m[32m'x'[0m[39m,[0m[32m'r'[0m[39m,[0m[32m'e'[0m[39m,[0m[32m'f'[0m[39m [0m[1;39m}[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    private static final byte[0m[1;39m[[0m[1;39m][0m[39m ENDSTREAM = [0m[1;39m{[0m[39m E, N, D, S, T, R, E, A, M [0m[1;39m}[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    private static final byte[0m[1;39m[[0m[1;39m][0m[39m ENDOBJ = [0m[1;39m{[0m[39m E, N, D, O, B, J [0m[1;39m}[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    protected static final long MINIMUM_SEARCH_OFFSET = [0m[1;36m6[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private static final int STRMBUFLEN = [0m[1;36m2048[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    private final byte[0m[1;39m[[0m[1;39m][0m[39m strmBuf = new byte[0m[1;39m[[0m[39m STRMBUFLEN [0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private AccessPermission accessPermission;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private InputStream keyStoreInputStream = null;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[1;39m{[0m[32m"squid:S2068"[0m[1;39m}[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    private String password = [0m[32m""[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private String keyAlias = null;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     * The range within the %%EOF marker will be searched.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * Useful if there are additional characters after %%EOF within the PDF. [0m    [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    public static final String SYSPROP_EOFLOOKUPRANGE =[0m                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[32m"org.apache.pdfbox.pdfparser.nonSequentialPDFParser.eofLookupRange"[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     * How many trailing bytes to read for EOF marker.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    private static final int DEFAULT_TRAIL_BYTECOUNT = [0m[1;36m2048[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * EOF-marker.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    private static final char[0m[1;39m[[0m[1;39m][0m[39m EOF_MARKER = [0m[1;39m{[0m[39m [0m[32m'%'[0m[39m, [0m[32m'%'[0m[39m, [0m[32m'E'[0m[39m, [0m[32m'O'[0m[39m, [0m[32m'F'[0m[39m [0m[1;39m}[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:     * obj-marker.[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    private static final char[0m[1;39m[[0m[1;39m][0m[39m OBJ_MARKER = [0m[1;39m{[0m[39m [0m[32m'o'[0m[39m, [0m[32m'b'[0m[39m, [0m[32m'j'[0m[39m [0m[1;39m}[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:     * file length.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    private final long fileLen;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:     * is parser using auto healing capacity ?[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    private boolean isLenient = true;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    protected boolean initialParseDone = false;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    private boolean trailerWasRebuild = false;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    private BruteForceParser bruteForceParser = null;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    private PDEncryption encryption = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    private final Map<COSObjectKey, Long> xrefTable = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:     * Intermediate cache. Contains all objects of already read compressed [0m     [2m                [0m
[2;36m                    [0m         [39mobject streams. Objects are removed after[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:     * dereferencing them.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    private final Map<Long, Map<COSObjectKey, COSBase>> decompressedObjects = [0m  [2m                [0m
[2;36m                    [0m         [39mnew HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:     * The security handler.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    private SecurityHandler<ProtectionPolicy> securityHandler = null;[0m           [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:     *  how many trailing bytes to read for EOF marker.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    private int readTrailBytes = DEFAULT_TRAIL_BYTECOUNT; [0m                      [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mCOSParser.class[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/PDFParser.jav[0m[1;92ma:105[0m[39m-[0m[1;36m123[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    protected void [0m[1;35minitialParse[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        COSDictionary trailer = [0m[1;35mretrieveTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        COSDictionary root = [0m[1;35mtrailer.getCOSDictionary[0m[1;39m([0m[39mCOSName.ROOT[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        if [0m[1;39m([0m[39mroot == null[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Missing root object specification in [0m        [2m                [0m
[2;36m                    [0m         [32mtrailer."[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        [0m[35m/[0m[35m/[0m[39m in some pdfs the type value [0m[32m"Catalog"[0m[39m is missing in the root object[0m  [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[1;35misLenient[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mroot.containsKey[0m[1;39m([0m[39mCOSName.TYPE[0m[1;39m)[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            [0m[1;35mroot.setItem[0m[1;39m([0m[39mCOSName.TYPE, COSName.CATALOG[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[35m/[0m[35m/[0m[39m check pages dictionaries[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        [0m[1;35mcheckPages[0m[1;39m([0m[39mroot[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;35mdocument.setDecrypted[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        initialParseDone = true;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/challenge.yaml:[0m[1;36m1[0m[39m-[0m[1;36m46[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:metadata_spec_version: v1[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:name: [0m[32m'Lemon Aquarium'[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:# fuzz_tooling project info that pairs to this challenge[0m                          [2m                [0m
[2;36m                    [0m         [1;92m6:f[0m[39muzz_tooling_project_name: [0m[32m'pdfbox'[0m                                               [2m                [0m
[2;36m                    [0m         [1;92m7:f[0m[39muzz_tooling_url: [0m[4;94mhttps://github.com/aixcc-finals/oss-fuzz-aixcc.git[0m              [2m                [0m
[2;36m                    [0m         [1;92m8:f[0m[39muzz_tooling_ref: challenge-state/pdfbox-full-[0m[1;36m01[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m10:c[0m[39mhallenge_type: full     # full | delta[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m12:ba[0m[39mse_ref: challenges/pdfbox-full-[0m[1;36m01[0m                                              [2m                [0m
[2;36m                    [0m         [1;92m13:de[0m[39mlta_ref: null # this is null for full scans, a hash for delta scans[0m            [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:required_memory_gb: [0m[1;36m32[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:timeouts: [0m[32m'enabled'[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:# A list of the vulnerabilities included in this challenge[0m                       [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:# This should always match the dir names in .aixcc/vulns/*[0m                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:vulnerabilities:[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:    - vuln_0[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:    - vuln_1[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:    - vuln_3[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:    - vuln_4[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    - vuln_5[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:    - vuln_6[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    - vuln_7[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    - vuln_8[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:sarif:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    broadcast: false[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    target: null[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    correct: null[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:# harness fuzz targets available for this challenge[0m                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:harnesses:[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    - [0m[32m'DomXfaParserFuzzer'[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    - [0m[32m'DomXmpParserFuzzer'[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    - [0m[32m'PDFExtractTextFuzzer'[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    - [0m[32m'PDFStreamParserFuzzer'[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    - [0m[32m'PDFWriteReadFuzzer'[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    - [0m[32m'PDFOCRFuzzer'[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:patch_exclude_list:[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    - [0m[32m'.*/src/test/.*'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/README.m[0m[1;92md:1[0m[39m-[0m[1;36m11[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What design decisions were considered for this challenge?[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Unlike with commons-compress, where we focused on individual challenges,[0m          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:we wanted to add a large number of vulnerabilities into on large full repository [0m [2m                [0m
[2;36m                    [0m         [39mscan.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:# Why this set of vulnerabilities?[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:While there's a heavy focus on the Type1 font parser, there are vulnerabilities[0m   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:that also focus on general structure of the PDF file.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:# Delta vs Full and why?[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:See above. We wanted at least one challenge to be a full repository challenge [0m   [2m                [0m
[2;36m                    [0m         [39mwith a [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:large number of vulnerabilities.[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis Summary[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mBased on the evaluation report and code analysis, the libFuzzer timeout is caused [0m  [2m                [0m
[2;36m                    [0m         [39mby multiple infinite loop and resource exhaustion vulnerabilities in the PDFBox [0m    [2m                [0m
[2;36m                    [0m         [39mcodebase. I've identified the following critical issues:[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Confirmed Infinite Loop Vulnerabilities[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Type1Parser - Missing null checks in parsing loops [0m[1;39m([0m[39mvuln_3, vuln_4[0m[1;39m)[0m[39m**[0m          [2m                [0m
[2;36m                    [0m         [39m   - Locations: `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java`[0m   [2m                [0m
[2;36m                    [0m         [39m     - Lines [0m[1;36m217[0m[39m-[0m[1;36m223[0m[39m [0m[1;39m([0m[39mreadEncoding method[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [39m     - Lines [0m[1;36m556[0m[39m-[0m[1;36m563[0m[39m [0m[1;39m([0m[39mparseBinary method - searching for [0m[32m"/Private"[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m     - Lines [0m[1;36m640[0m[39m-[0m[1;36m644[0m[39m [0m[1;39m([0m[39mparseBinary method - searching for [0m[32m"CharStrings"[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m   - Root cause: While loops call `[0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m` without checking for null, [0m   [2m                [0m
[2;36m                    [0m         [39mcausing infinite loops at EOF[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **XRef circular reference detection [0m[1;39m([0m[39mvuln_8 - PDFBOX-[0m[1;36m3919[0m[1;39m)[0m[39m**[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Location: `pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java` [0m  [2m                [0m
[2;36m                    [0m         [39mlines [0m[1;36m100[0m[39m-[0m[1;36m177[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   - Root cause: Only tracks the immediately previous PREV offset, cannot detect [0m   [2m                [0m
[2;36m                    [0m         [39mlonger cycles [0m[1;39m([0m[39mA→B→C→A[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Page tree circular reference [0m[1;39m([0m[39mvuln_7 - PDFBOX-[0m[1;36m4623[0m[1;39m)[0m[39m**[0m                          [2m                [0m
[2;36m                    [0m         [39m   - Location: `pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java` [0m    [2m                [0m
[2;36m                    [0m         [39mlines [0m[1;36m180[0m[39m-[0m[1;36m220[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   - Root cause: No cycle detection in page tree traversal iterator[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Unbounded memory allocation [0m[1;39m([0m[39mvuln_5[0m[1;39m)[0m[39m**[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - Location: `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java`[0m    [2m                [0m
[2;36m                    [0m         [39m     - Line [0m[1;36m709[0m[39m [0m[1;39m([0m[39mreadSubrs method[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m     - Line [0m[1;36m779[0m[39m [0m[1;39m([0m[39mreadCharStrings method[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Root cause: Allocates arrays based on user input without bounds validation[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix [0m[1;36m1[0m[39m: Type1Parser null checks [0m[1;39m([0m[39mvuln_3, vuln_4[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File: `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java`**[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mApply null checks after `[0m[1;35mnextToken[0m[1;39m([0m[1;39m)[0m[39m` calls in three locations:[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **readEncoding method [0m[1;39m([0m[39mlines [0m[1;36m217[0m[39m-[0m[1;36m223[0m[1;39m)[0m[39m**:[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - After line [0m[1;36m222[0m[39m `[0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;`, add null check[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Throw IOException if null is returned[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Pattern: `if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unexpected [0m  [2m                [0m
[2;36m                    [0m         [32mEOF while searching for dup, readonly, or def"[0m[1;39m)[0m[39m; [0m[1;39m}[0m[39m`[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **parseBinary method - searching for [0m[32m"/Private"[0m[39m [0m[1;39m([0m[39mlines [0m[1;36m556[0m[39m-[0m[1;36m563[0m[1;39m)[0m[39m**:[0m               [2m                [0m
[2;36m                    [0m         [39m   - The loop at line [0m[1;36m557[0m[39m continues while `peekToken != null && [0m                    [2m                [0m
[2;36m                    [0m         [39m![0m[32m"Private"[0m[1;35m.equals[0m[1;39m([0m[1;35mpeekToken.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m`[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - After line [0m[1;36m562[0m[39m `[0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;`, update peekToken with null check[0m          [2m                [0m
[2;36m                    [0m         [39m   - If [0m[1;35mnextToken[0m[1;39m([0m[1;39m)[0m[39m returns null, break or throw IOException[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **parseBinary method - searching for [0m[32m"CharStrings"[0m[39m [0m[1;39m([0m[39mlines [0m[1;36m640[0m[39m-[0m[1;36m644[0m[1;39m)[0m[39m**:[0m            [2m                [0m
[2;36m                    [0m         [39m   - After line [0m[1;36m643[0m[39m `[0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;`, add null check[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Throw IOException if null is returned[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Pattern: `if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unexpected [0m  [2m                [0m
[2;36m                    [0m         [32mEOF while searching for CharStrings"[0m[1;39m)[0m[39m; [0m[1;39m}[0m[39m`[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix [0m[1;36m2[0m[39m: XRef cycle detection with Set [0m[1;39m([0m[39mvuln_8[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File: `pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java`**[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace single-value tracking with Set-based tracking:[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Remove `long lastPrev = [0m[1;36m-1[0m[39m;` at line [0m[1;36m102[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Add `Set<Long> prevSet = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;` before the while loop[0m                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Change while condition from `while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m[39m` to `while [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m[39m`[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Remove `lastPrev = prev;` at line [0m[1;36m107[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Add `[0m[1;35mprevSet.add[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;` after line [0m[1;36m107[0m[39m [0m[1;39m([0m[39mafter seeking[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Add `[0m[1;35mprevSet.add[0m[1;39m([0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;` after line [0m[1;36m111[0m[39m [0m[1;39m([0m[39mafter skipSpaces to [0m    [2m                [0m
[2;36m                    [0m         [39mtrack actual position[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. Change condition at line [0m[1;36m173[0m[39m from `if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m[39m` to `if [0m                [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;35mprevSet.contains[0m[1;39m([0m[39mprev[0m[1;39m)[0m[1;39m)[0m[39m`[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis ensures ALL previously visited offsets are tracked, not just the last one.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix [0m[1;36m3[0m[39m: Page tree cycle detection [0m[1;39m([0m[39mvuln_7[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File: `pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java`**[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd visited set to PageIterator:[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. At line [0m[1;36m182[0m[39m, add field: `private Set<COSDictionary> seen = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;`[0m     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. In `enqueueKids` method [0m[1;39m([0m[39mbefore line [0m[1;36m208[0m[1;39m)[0m[39m, add cycle detection:[0m                  [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[1;35mseen.contains[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Found an infinite loop in the page tree"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m       return [0m[1;35mCollections.emptyList[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   [0m[1;35mseen.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. This prevents processing the same node twice[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix [0m[1;36m4[0m[39m: Bounds validation for array allocation [0m[1;39m([0m[39mvuln_5[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File: `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java`**[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd reasonable bounds checking:[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **readSubrs method [0m[1;39m([0m[39mline [0m[1;36m709[0m[1;39m)[0m[39m**:[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - After reading length: `int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;`[0m           [2m                [0m
[2;36m                    [0m         [39m   - Add validation: `if [0m[1;39m([0m[39mlength < [0m[1;36m0[0m[39m || length > [0m[1;36m65536[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m throw new [0m                [2m                [0m
[2;36m                    [0m         [1;35mIOException[0m[1;39m([0m[32m"Invalid Subrs array length: "[0m[39m + length[0m[1;39m)[0m[39m; [0m[1;39m}[0m[39m`[0m                            [2m                [0m
[2;36m                    [0m         [39m   - The limit of [0m[1;36m65536[0m[39m is reasonable for Type1 font subroutines[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **readCharStrings method [0m[1;39m([0m[39mline [0m[1;36m779[0m[1;39m)[0m[39m**:[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - After reading length: `int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;`[0m           [2m                [0m
[2;36m                    [0m         [39m   - Add validation: `if [0m[1;39m([0m[39mlength < [0m[1;36m0[0m[39m || length > [0m[1;36m65536[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m throw new [0m                [2m                [0m
[2;36m                    [0m         [1;35mIOException[0m[1;39m([0m[32m"Invalid CharStrings dict length: "[0m[39m + length[0m[1;39m)[0m[39m; [0m[1;39m}[0m[39m`[0m                       [2m                [0m
[2;36m                    [0m         [39m   - The limit of [0m[1;36m65536[0m[39m is reasonable for character definitions[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Approach is Optimal[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Targets Root Causes**: Each fix addresses the actual root cause [0m[1;39m([0m[39mmissing null [0m [2m                [0m
[2;36m                    [0m         [39mchecks, insufficient cycle detection, unbounded allocation[0m[1;39m)[0m[39m rather than symptoms[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Minimal Code Changes**: The fixes are surgical and localized, minimizing risk [0m [2m                [0m
[2;36m                    [0m         [39mof breaking existing functionality[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves Parsing Logic**: All fixes maintain the existing parsing flow and [0m   [2m                [0m
[2;36m                    [0m         [39monly add safety checks[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Follows Established Patterns**: The fixes mirror the good patches provided for[0m [2m                [0m
[2;36m                    [0m         [39mvuln_3, vuln_7, and vuln_8, which are known to resolve these issues[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **No Breaking Changes**: The fixes throw IOExceptions on malformed input, which [0m [2m                [0m
[2;36m                    [0m         [39mis the expected behavior for corrupt PDFs/fonts[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Preserves Existing Logic[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Type1Parser null checks**: Only affects malformed fonts that would have caused[0m [2m                [0m
[2;36m                    [0m         [39minfinite loops; valid fonts continue to parse normally[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **XRef Set tracking**: Replaces less-effective single-step tracking with [0m        [2m                [0m
[2;36m                    [0m         [39mcomprehensive tracking; valid PDF chains parse identically[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Page tree Set**: Only affects circular page trees [0m[1;39m([0m[39minvalid PDFs[0m[1;39m)[0m[39m; valid [0m       [2m                [0m
[2;36m                    [0m         [39mhierarchies are unaffected[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Bounds checking**: Rejects unreasonably large allocations while allowing all [0m  [2m                [0m
[2;36m                    [0m         [39mlegitimate Type1 fonts to parse[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Timeout[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe libFuzzer timeout is caused by the fuzzer generating inputs that trigger [0m       [2m                [0m
[2;36m                    [0m         [39minfinite loops or excessive resource allocation. These fixes:[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Prevent infinite loops** by ensuring all loops have proper termination [0m         [2m                [0m
[2;36m                    [0m         [39mconditions[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- **Detect cycles** before they cause infinite traversal[0m                            [2m                [0m
[2;36m                    [0m         [39m- **Limit resource consumption** by rejecting pathological inputs early[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effects and Mitigation[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Potential**: Some extremely large but technically valid fonts might be [0m        [2m                [0m
[2;36m                    [0m         [39mrejected by bounds checks[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: The [0m[1;36m65536[0m[39m limit is very generous and exceeds any real-world [0m   [2m                [0m
[2;36m                    [0m         [39mType1 font[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Potential**: Stricter error handling might reject some PDFs that were [0m         [2m                [0m
[2;36m                    [0m         [39mpreviously parsed in lenient mode[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: These PDFs were already causing timeouts or infinite loops, so[0m [2m                [0m
[2;36m                    [0m         [39mrejecting them early is preferable[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Potential**: Performance overhead from Set operations in XRef/page tree [0m       [2m                [0m
[2;36m                    [0m         [39mparsing[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: Negligible compared to I/O and parsing operations; prevents [0m   [2m                [0m
[2;36m                    [0m         [39mcatastrophic timeout cases[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe provided patches show this exact pattern:[0m                                       [2m                [0m
[2;36m                    [0m         [39m- vuln_3 patch: Adds null check after `[0m[1;35mnextToken[0m[1;39m([0m[1;39m)[0m[39m`[0m                                 [2m                [0m
[2;36m                    [0m         [39m- vuln_8 patch: Replaces single-value with Set-based tracking  [0m                     [2m                [0m
[2;36m                    [0m         [39m- vuln_7 patch: Adds Set-based cycle detection in page tree[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThese solutions have been tested and proven effective, giving us confidence in [0m     [2m                [0m
[2;36m                    [0m         [39mapplying the same patterns.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/12/26 01:43:16][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=382795;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=33934;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=360709;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=640884;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpxltmmefu[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_7/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768182196.2857423[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-full-01_vuln_7.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/12/26 01:43:18][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mpdfbox[0m         ]8;id=968467;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=842322;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=784030;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=174833;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mpdfbox[0m                [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=258173;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=279263;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mpdfbox[0m                 [2m               [0m
