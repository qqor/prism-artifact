{
  "project_name": "systemd",
  "vulnerability_identifier": "systemd_systemd-full-001_systemd-001",
  "source_directory": "/home/qqor/crete/.cache/official-afc-systemd",
  "llm_usage": {
    "total_cost": 3.0300030000000002,
    "prompt_tokens": 864966,
    "completion_tokens": 29007
  },
  "variant": "sound",
  "diff": "--- a/src/udev/udev-rules.c\n+++ b/src/udev/udev-rules.c\n@@ -1141,11 +1141,14 @@\n         char *i, *j, *m;\n         bool is_escaped = false, is_case_insensitive = false, is_prefix_match = false;\n         int pos = 0;\n+        size_t input_len;\n \n         assert(str);\n         assert(ret_value);\n         assert(ret_endpos);\n         assert(ret_is_case_insensitive);\n+\n+        input_len = strlen(str);\n \n         /* check if string is prefixed with:\n          * - \"e\" for escaped\n@@ -1185,10 +1188,18 @@\n                  * so it could be safely interpreted as nulstr.\n                  */\n                 if (is_prefix_match){\n+                        /* Check if buffer has space for j[0], j[1], j[2] */\n+                        if (j + 2 >= str + input_len)\n+                                return -EOVERFLOW;\n+                        \n                         j[0] = '*';\n                         j[1] = '\\0';\n                         j[2] = '\\0';\n                 } else {\n+                        /* Check if buffer has space for j[0], j[1] */\n+                        if (j + 1 >= str + input_len)\n+                                return -EOVERFLOW;\n+                        \n                         j[0] = '\\0';\n                         j[1] = '\\0';\n                 }\n@@ -1216,6 +1227,10 @@\n                 * so it could be safely interpreted as nulstr.\n                 */\n                 if (is_prefix_match){\n+                        /* Check if buffer has space for: content at (pos-1) + '*' + two '\\0' */\n+                        if (pos + l + 1 >= input_len)\n+                                return -EOVERFLOW;\n+                        \n                         /* need more room to make rule glob match */\n                         memcpy(str + pos - 1, unescaped, l + 1);\n                         str[pos + l - 1] = '*';\n@@ -1224,6 +1239,10 @@\n                         m = str + pos - 1;\n \n                 } else {\n+                        /* Check if buffer has space for: content at m + two '\\0' */\n+                        if ((size_t)(m - str) + l + 1 >= input_len)\n+                                return -EOVERFLOW;\n+                        \n                         memcpy(m, unescaped, l + 1);\n                         m[l] = '\\0';\n                         m[l + 1] = '\\0';\n",
  "stdout": "",
  "stderr": ""
}