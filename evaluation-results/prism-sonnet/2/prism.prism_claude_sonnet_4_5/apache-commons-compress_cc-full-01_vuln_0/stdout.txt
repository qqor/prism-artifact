[2;36m[01/07/26 20:18:13][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=717519;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=586279;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp0ypdeaxj[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-fu[0m [2m               [0m
[2;36m                    [0m         [35mll-01_vuln_0/[0m[95magent-output-1767817093.392805[0m                                          [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-commons-compress_cc-full-01_vuln_0.toml      [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN        ]8;id=996238;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=214346;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m[01/07/26 20:19:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN       ]8;id=279891;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=496040;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m78.54[0m seconds; [33mexception[0m=[3;91mFalse[0m                              [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for     ]8;id=610093;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=238085;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Started[33m...[0m                                                  [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for    ]8;id=358611;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=408459;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                         [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=328508;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=57096;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m78[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=497676;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=238291;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 20:19:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.92[0m        ]8;id=474972;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=995146;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/07/26 20:19:33][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=379058;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=998919;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=487826;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=791629;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=833790;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=592926;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=375329;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=185884;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 20:19:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m1.06[0m        ]8;id=938927;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=172446;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=842800;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=321683;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 20:19:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.89[0m        ]8;id=685157;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=391449;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/07/26 20:19:41][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=918426;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=18345;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazze.com:[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:583[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:183[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/sun.net.www.http.HttpClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URL.openStream[0m[1;39m([0m[39mURL.jav[0m[1;92ma:1161[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.readCentralDirectoryEntry[0m[1;39m([0m[39mZipFile[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:1552[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.populateFromCentralDirectory[0m[1;39m([0m[39mZipF[0m [2m                [0m
[2;36m                    [0m         [39mile.jav[0m[1;92ma:1329[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:905[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:971[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:938[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:876[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mCompressZipFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mCompressZipFuzzer.jav[0m[1;92ma:30[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b38823cc610751ee[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazze.com:[0m[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URL.openStream[0m[1;39m([0m[39mURL.jav[0m[1;92ma:1161[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.readCentralDirectoryEntry[0m[1;39m([0m[39mZipFile[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:1552[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.populateFromCentralDirectory[0m[1;39m([0m[39mZipF[0m [2m                [0m
[2;36m                    [0m         [39mile.jav[0m[1;92ma:1329[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:905[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:971[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:938[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init[0m[1m>[0m[1m([0mZipFile.jav[1;92ma:876[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35mCompressZipFuzzer.fuzzerTestOneInput[0m[1m([0mCompressZipFuzzer.jav[1;92ma:30[0m[1m)[0m          [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: b38823cc610751ee                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/07/26 20:20:02][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=747296;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=468566;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/07/26 20:24:03][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=622405;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=57997;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/07/26 20:24:37][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=757549;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=847271;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=553434;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=567522;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 20:24:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.94[0m        ]8;id=436051;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=808977;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Started[33m...[0m             ]8;id=877522;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=993720;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpi46ify0b[0m                                                 ]8;id=514730;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=285914;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/07/26 20:25:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Took [1;36m32.91[0m seconds;   ]8;id=633190;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=756070;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Started[33m...[0m       ]8;id=537442;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=869108;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 20:25:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Took [1;36m20.36[0m      ]8;id=162747;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=465529;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Started[33m...[0m          ]8;id=212705;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=140833;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 20:25:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Took [1;36m4.98[0m seconds; ]8;id=914165;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=376496;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Started[33m...[0m              ]8;id=585653;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=580802;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Took [1;36m0.00[0m seconds;     ]8;id=290899;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=424972;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=581220;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=597262;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 20:25:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.89[0m        ]8;id=811292;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=698290;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/07/26 20:25:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=148180;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=464772;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 20:25:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.90[0m        ]8;id=918143;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=26513;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=701208;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=241360;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 20:25:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.88[0m        ]8;id=712239;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=177727;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=569247;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=308392;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java          [2m                [0m
[2;36m                    [0m         +++ b/src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java          [2m                [0m
[2;36m                    [0m         @@ [1;36m-1548[0m,[1;36m15[0m +[1;36m1548[0m,[1;36m6[0m @@                                                              [2m                [0m
[2;36m                    [0m                      throw new [1;35mEOFException[0m[1m([0m[1m)[0m;                                              [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                  String commentString = [1;35mentryEncoding.decode[0m[1m([0mcomment[1m)[0m;                      [2m                [0m
[2;36m                    [0m         -        if [1m([0m[1;35mcommentString.startsWith[0m[1m([0m[32m"http"[0m[1m)[0m || [1;35mcommentString.startsWith[0m[1m([0m[32m"https"[0m[1m)[0m[1m)[0m [2m                [0m
[2;36m                    [0m         [1m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         -            try [1m([0mInputStream is = new [1;35mURL[0m[1m([0mcommentString[1m)[0m[1;35m.openStream[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m           [2m                [0m
[2;36m                    [0m         -                ByteArrayOutputStream bos = new [1;35mByteArrayOutputStream[0m[1m([0m[1m)[0m;           [2m                [0m
[2;36m                    [0m         -                [1;35mIOUtils.copy[0m[1m([0mis, bos[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         -                commentString = new [1;35mString[0m[1m([0m[1;35mbos.toByteArray[0m[1m([0m[1m)[0m,                      [2m                [0m
[2;36m                    [0m         StandardCharsets.UTF_8[1m)[0m;                                                            [2m                [0m
[2;36m                    [0m         -            [1m}[0m catch [1m([0mIOException e[1m)[0m [1m{[0m                                              [2m                [0m
[2;36m                    [0m         -                [35m/[0m[35m/[0m[95mswallow[0m                                                          [2m                [0m
[2;36m                    [0m         -            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m                  [1;35mze.setComment[0m[1m([0mcommentString[1m)[0m;                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  if [1m([0m!hasUTF8Flag && useUnicodeExtraFields[1m)[0m [1m{[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazze.com:[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:583[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:183[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/sun.net.www.http.HttpClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URL.openStream[0m[1;39m([0m[39mURL.jav[0m[1;92ma:1161[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.readCentralDirectoryEntry[0m[1;39m([0m[39mZipFile[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:1552[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.populateFromCentralDirectory[0m[1;39m([0m[39mZipF[0m [2m                [0m
[2;36m                    [0m         [39mile.jav[0m[1;92ma:1329[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:905[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:971[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:938[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:876[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mCompressZipFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mCompressZipFuzzer.jav[0m[1;92ma:30[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b38823cc610751ee[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability has been detected in the Apache [0m [2m                [0m
[2;36m                    [0m         [39mCommons Compress library during fuzzing operations. The vulnerability was triggered[0m [2m                [0m
[2;36m                    [0m         [39mwhen processing a ZIP file, where an attempted connection to an external domain [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mjazze.com:[0m[1;36m80[0m[1;39m)[0m[39m was made based on untrusted input data. This security issue has been[0m [2m                [0m
[2;36m                    [0m         [39mclassified as medium severity by the Jazzer fuzzing framework.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue represents a Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability detected [0m   [2m                [0m
[2;36m                    [0m         [39mduring fuzz testing of ZIP file processing functionality. SSRF vulnerabilities [0m     [2m                [0m
[2;36m                    [0m         [39moccur when an application makes outbound requests to destinations that are [0m         [2m                [0m
[2;36m                    [0m         [39mcontrolled or influenced by untrusted user input, potentially allowing attackers [0m   [2m                [0m
[2;36m                    [0m         [39mto:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m- Exfiltrate sensitive data from the application or internal network[0m                [2m                [0m
[2;36m                    [0m         [39m- Access or probe internal services that should not be publicly accessible[0m          [2m                [0m
[2;36m                    [0m         [39m- Bypass access controls or firewalls[0m                                               [2m                [0m
[2;36m                    [0m         [39m- Perform port scanning of internal networks[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability was triggered during the execution of [0m                            [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mCompressZipFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m30[0m[39m, which instantiates a `ZipFile`[0m [2m                [0m
[2;36m                    [0m         [39mobject from the Apache Commons Compress library. The stack trace reveals the [0m       [2m                [0m
[2;36m                    [0m         [39mfollowing execution flow:[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer creates a `ZipFile` object with untrusted input data[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. During ZIP file initialization, the library attempts to populate data from the [0m  [2m                [0m
[2;36m                    [0m         [39mcentral directory [0m[1;39m([0m[39m`populateFromCentralDirectory`[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. While reading central directory entries [0m[1;39m([0m[39m`readCentralDirectoryEntry` at line [0m    [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[1;39m)[0m[39m, the library encounters what appears to be a URL[0m                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. The library attempts to open a stream to this URL using [0m                         [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mjava.net.URL.openStream[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. This triggers an HTTP connection attempt through Java's standard networking [0m     [2m                [0m
[2;36m                    [0m         [39mstack[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. The connection attempt to [0m[32m"jazze.com:80"[0m[39m is intercepted by Jazzer's SSRF [0m        [2m                [0m
[2;36m                    [0m         [39msanitizer, which raises the security issue[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mKey observations from the stack trace:[0m                                              [2m                [0m
[2;36m                    [0m         [39m- The vulnerability originates from within the Apache Commons Compress library code[0m [2m                [0m
[2;36m                    [0m         [39mitself, specifically in the `[0m[1;35mZipFile.readCentralDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m` method[0m            [2m                [0m
[2;36m                    [0m         [39m- The library appears to interpret data within ZIP file structures as URLs and [0m     [2m                [0m
[2;36m                    [0m         [39mattempts to fetch them[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- The connection attempt goes through the standard Java HTTP client implementation[0m  [2m                [0m
[2;36m                    [0m         [39m- The issue occurs during the parsing phase of the ZIP file, not during extraction[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a holistic understanding of this vulnerability, the following parts of the [0m [2m                [0m
[2;36m                    [0m         [39mcodebase should be investigated:[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m**[0m[1;35morg.apache.commons.compress.archivers.zip.ZipFile.readCentralDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m** [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m1552[0m[1;39m)[0m[39m: This is where the URL opening is triggered and should be examined to [0m  [2m                [0m
[2;36m                    [0m         [39munderstand why and under what conditions the library attempts to open external URLs[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m**[0m[1;35morg.apache.commons.compress.archivers.zip.ZipFile.populateFromCentralDirectory[0m[1;39m([0m[1;39m)[0m[39m*[0m [2m                [0m
[2;36m                    [0m         [39m* [0m[1;39m([0m[39mline [0m[1;36m1329[0m[1;39m)[0m[39m: This method orchestrates the reading of central directory entries [0m   [2m                [0m
[2;36m                    [0m         [39mand should be reviewed to understand the overall ZIP parsing logic[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **ZipFile constructors and initialization logic**: The chain starts at line [0m[1;36m876[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mand proceeds through lines [0m[1;36m938[0m[39m, [0m[1;36m971[0m[39m, and [0m[1;36m905[0m[39m, indicating multiple constructor [0m      [2m                [0m
[2;36m                    [0m         [39mvariants that ultimately lead to the vulnerable code path[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **ZIP file format handling logic**: Understanding how the library interprets and[0m [2m                [0m
[2;36m                    [0m         [39mprocesses various fields in the ZIP central directory structure, particularly any [0m  [2m                [0m
[2;36m                    [0m         [39mfields that might be interpreted as URLs or network resources[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **CompressZipFuzzer.java** [0m[1;39m([0m[39mline [0m[1;36m30[0m[1;39m)[0m[39m: While the harness is not the root cause, [0m  [2m                [0m
[2;36m                    [0m         [39mexamining it will help understand what type of input triggered this behavior and [0m   [2m                [0m
[2;36m                    [0m         [39mwhether there are specific ZIP file structures that are more likely to trigger SSRF[0m [2m                [0m
[2;36m                    [0m         [39mattempts[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability demonstrates that the Apache Commons Compress library may be [0m     [2m                [0m
[2;36m                    [0m         [39mmaking network requests based on content found within ZIP file structures, which [0m   [2m                [0m
[2;36m                    [0m         [39mrepresents a significant security concern when processing untrusted ZIP files.[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazze.com:[0m[1;36m80[0m                                               [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URL.openStream[0m[1;39m([0m[39mURL.jav[0m[1;92ma:1161[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.readCentralDirectoryEntry[0m[1;39m([0m[39mZipFile[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:1552[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.zip.ZipFile.populateFromCentralDirectory[0m[1;39m([0m[39mZipF[0m [2m                [0m
[2;36m                    [0m         [39mile.jav[0m[1;92ma:1329[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:905[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:971[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:938[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipFile.<init>[0m[1;39m([0m[39mZipFile.jav[0m[1;92ma:876[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mCompressZipFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mCompressZipFuzzer.jav[0m[1;92ma:30[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b38823cc610751ee[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1540[0m[39m-[0m[1;36m1570[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:            throw z;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:        [0m[1;35msetSizesAndOffsetFromZip64Extra[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:        [0m[1;35msanityCheckLFHOffset[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m comment = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, commentLen[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:        if [0m[1;39m([0m[39mcomment.length < commentLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:        String commentString = [0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mcomment[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:        if [0m[1;39m([0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[39m || [0m                               [2m                [0m
[2;36m                    [0m         [1;35mcommentString.startsWith[0m[1;39m([0m[32m"https"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:            try [0m[1;39m([0m[39mInputStream is = new [0m[1;35mURL[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[1;35m.openStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:                ByteArrayOutputStream bos = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, bos[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:                commentString = new [0m[1;35mString[0m[1;39m([0m[1;35mbos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m, [0m                 [2m                [0m
[2;36m                    [0m         [39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:        [0m[1;35mze.setComment[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:        if [0m[1;39m([0m[39m!hasUTF8Flag && useUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:            [0m[1;35mnoUTF8Flag.put[0m[1;39m([0m[39mze, new [0m[1;35mNameAndComment[0m[1;39m([0m[39mfileName, comment[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:        [0m[1;35mze.setStreamContiguous[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:     * Walks through all recorded entries and adds the data available from the[0m [2m                [0m
[2;36m                    [0m         [39mlocal file header.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:21[0m[39m-[0m[1;36m71[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.SequenceInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.nio.ByteOrder;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.nio.file.OpenOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import java.util.Comparator;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import java.util.EnumSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import java.util.stream.Collectors;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import java.util.stream.IntStream;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import java.util.zip.Inflater;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.apache.commons.compress.archivers.EntryStreamOffsets;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:import org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream;[0m [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.deflate64.Deflate64CompressorInputStream;[0m   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:import org.apache.commons.compress.compressors.xz.XZCompressorInputStream;[0m       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.zstandard.ZstdCompressorInputStream;[0m        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:import org.apache.commons.compress.utils.BoundedArchiveInputStream;[0m              [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:import org.apache.commons.compress.utils.BoundedSeekableByteChannelInputStream;[0m  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:import org.apache.commons.compress.utils.IOUtils;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:import org.apache.commons.compress.utils.InputStreamStatistics;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:import org.apache.commons.compress.utils.SeekableInMemoryByteChannel;[0m            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:import org.apache.commons.io.Charsets;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:import org.apache.commons.io.FilenameUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:import org.apache.commons.io.build.AbstractOrigin.ByteArrayOrigin;[0m               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:import org.apache.commons.io.build.AbstractStreamBuilder;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:import org.apache.commons.io.function.IOStream;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:import org.apache.commons.io.input.BoundedInputStream;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1443[0m[39m-[0m[1;36m1567[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1443[0m[39m:    private void [0m[1;35mreadCentralDirectoryEntry[0m[1;39m([0m[39mfinal Map<ZipArchiveEntry, [0m         [2m                [0m
[2;36m                    [0m         [39mNameAndComment> noUTF8Flag[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1444[0m[39m:        [0m[1;35mcfhBbuf.rewind[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:        [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39marchive, cfhBbuf[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1446[0m[39m:        int off = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1447[0m[39m:        final Entry ze = new [0m[1;35mEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1448[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:        final int versionMadeBy = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:        [0m[1;35mze.setVersionMadeBy[0m[1;39m([0m[39mversionMadeBy[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:        [0m[1;35mze.setPlatform[0m[1;39m([0m[1;35mtoPlatform[0m[1;39m([0m[39mversionMadeBy[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1453[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1454[0m[39m:        [0m[1;35mze.setVersionRequired[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1455[0m[39m:        off += ZipConstants.SHORT; [0m[35m/[0m[35m/[0m[39m version required[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1456[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1457[0m[39m:        final GeneralPurposeBit gpFlag = [0m[1;35mGeneralPurposeBit.parse[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m1458[0m[39m:        final boolean hasUTF8Flag = [0m[1;35mgpFlag.usesUTF8ForNames[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1459[0m[39m:        final ZipEncoding entryEncoding = hasUTF8Flag ? [0m                       [2m                [0m
[2;36m                    [0m         [39mZipEncodingHelper.ZIP_ENCODING_UTF_8 : zipEncoding;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1460[0m[39m:        if [0m[1;39m([0m[39mhasUTF8Flag[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1461[0m[39m:            [0m[1;35mze.setNameSource[0m[1;39m([0m[39mZipArchiveEntry.NameSource.NAME_WITH_EFS_FLAG[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m1462[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1463[0m[39m:        [0m[1;35mze.setGeneralPurposeBit[0m[1;39m([0m[39mgpFlag[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1464[0m[39m:        [0m[1;35mze.setRawFlag[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1465[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1466[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1467[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1468[0m[39m:        [0m[35m/[0m[35m/[0m[39m noinspection MagicConstant[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1469[0m[39m:        [0m[1;35mze.setMethod[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1470[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1471[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1472[0m[39m:        final long time = [0m[1;35mZipUtil.dosToJavaTime[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, [0m      [2m                [0m
[2;36m                    [0m         [39moff[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1473[0m[39m:        [0m[1;35mze.setTime[0m[1;39m([0m[39mtime[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1474[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1475[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1476[0m[39m:        [0m[1;35mze.setCrc[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:        long size = [0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:        if [0m[1;39m([0m[39msize < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mcompressed size"[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:        [0m[1;35mze.setCompressedSize[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:        size = [0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:        if [0m[1;39m([0m[39msize < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative size"[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;35mze.setSize[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:        final int fileNameLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:        if [0m[1;39m([0m[39mfileNameLen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mfileNameLen"[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:        final int extraLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:        if [0m[1;39m([0m[39mextraLen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mextraLen"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:        final int commentLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:        if [0m[1;39m([0m[39mcommentLen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mcommentLen"[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:        [0m[1;35mze.setDiskNumberStart[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:        [0m[1;35mze.setInternalAttributes[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:        [0m[1;35mze.setExternalAttributes[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m fileName = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, fileNameLen[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:        if [0m[1;39m([0m[39mfileName.length < fileNameLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1522[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:        [0m[1;35mze.setName[0m[1;39m([0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m, fileName[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:        [0m[35m/[0m[35m/[0m[39m LFH offset,[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:        [0m[1;35mze.setLocalHeaderOffset[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m + [0m               [2m                [0m
[2;36m                    [0m         [39mfirstLocalFileHeaderOffset[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1528[0m[39m:        [0m[35m/[0m[35m/[0m[39m data offset will be filled later[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:        [0m[1;35mentries.add[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m cdExtraData = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, extraLen[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:        if [0m[1;39m([0m[39mcdExtraData.length < extraLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:        try [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:            [0m[1;35mze.setCentralDirectoryExtra[0m[1;39m([0m[39mcdExtraData[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal RuntimeException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:            final ZipException z = new [0m[1;35mZipException[0m[1;39m([0m[32m"Invalid extra data in [0m    [2m                [0m
[2;36m                    [0m         [32mentry "[0m[39m + [0m[1;35mze.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:            [0m[1;35mz.initCause[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:            throw z;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:        [0m[1;35msetSizesAndOffsetFromZip64Extra[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:        [0m[1;35msanityCheckLFHOffset[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m comment = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, commentLen[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:        if [0m[1;39m([0m[39mcomment.length < commentLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:        String commentString = [0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mcomment[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:        if [0m[1;39m([0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[39m || [0m                               [2m                [0m
[2;36m                    [0m         [1;35mcommentString.startsWith[0m[1;39m([0m[32m"https"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:            try [0m[1;39m([0m[39mInputStream is = new [0m[1;35mURL[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[1;35m.openStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:                ByteArrayOutputStream bos = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, bos[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:                commentString = new [0m[1;35mString[0m[1;39m([0m[1;35mbos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m, [0m                 [2m                [0m
[2;36m                    [0m         [39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:        [0m[1;35mze.setComment[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:        if [0m[1;39m([0m[39m!hasUTF8Flag && useUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:            [0m[1;35mnoUTF8Flag.put[0m[1;39m([0m[39mze, new [0m[1;35mNameAndComment[0m[1;39m([0m[39mfileName, comment[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:        [0m[1;35mze.setStreamContiguous[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1300[0m[39m-[0m[1;36m1335[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1300[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1301[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1302[0m[39m:        return null;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1303[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1304[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1305[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1306[0m[39m:     * Reads the central directory of the given archive and populates the [0m     [2m                [0m
[2;36m                    [0m         [39minternal tables with ZipArchiveEntry instances.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1307[0m[39m:     * <p>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1308[0m[39m:     * The ZipArchiveEntrys will know all data that can be obtained from the [0m  [2m                [0m
[2;36m                    [0m         [39mcentral directory alone, but not the data that requires the local file header or[0m    [2m                [0m
[2;36m                    [0m         [1;36m1309[0m[39m:     * additional data to be read.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1310[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1311[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1312[0m[39m:     * @return a map of zip entries that didn't have the language encoding [0m    [2m                [0m
[2;36m                    [0m         [39mflag set when read.[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1313[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1314[0m[39m:    private Map<ZipArchiveEntry, NameAndComment> [0m                              [2m                [0m
[2;36m                    [0m         [1;35mpopulateFromCentralDirectory[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1315[0m[39m:        final HashMap<ZipArchiveEntry, NameAndComment> noUTF8Flag = new [0m       [2m                [0m
[2;36m                    [0m         [39mHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1316[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1317[0m[39m:        [0m[1;35mpositionAtCentralDirectory[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1318[0m[39m:        centralDirectoryStartOffset = [0m[1;35marchive.position[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1319[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1320[0m[39m:        [0m[1;35mwordBbuf.rewind[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1321[0m[39m:        [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39marchive, wordBbuf[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1322[0m[39m:        long sig = [0m[1;35mZipLong.getValue[0m[1;39m([0m[39mwordBuf[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1323[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1324[0m[39m:        if [0m[1;39m([0m[39msig != CFH_SIG && [0m[1;35mstartsWithLocalFileHeader[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1325[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Central directory is empty, can't expand"[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [32m" corrupt archive."[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1326[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1327[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1328[0m[39m:        while [0m[1;39m([0m[39msig == CFH_SIG[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1329[0m[39m:            [0m[1;35mreadCentralDirectoryEntry[0m[1;39m([0m[39mnoUTF8Flag[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1330[0m[39m:            [0m[1;35mwordBbuf.rewind[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1331[0m[39m:            [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39marchive, wordBbuf[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1332[0m[39m:            sig = [0m[1;35mZipLong.getValue[0m[1;39m([0m[39mwordBuf[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1333[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1334[0m[39m:        return noUTF8Flag;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1335[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:896[0m[39m-[0m[1;36m910[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    private [0m[1;35mZipFile[0m[1;39m([0m[39mfinal SeekableByteChannel channel, final String [0m            [2m                [0m
[2;36m                    [0m         [39mchannelDescription, final Charset encoding, final boolean useUnicodeExtraFields,[0m    [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:            final boolean closeOnError, final boolean ignoreLocalFileHeader[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:        this.isSplitZipArchive = channel instanceof [0m                            [2m                [0m
[2;36m                    [0m         [39mZipSplitReadOnlySeekableByteChannel;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:        this.encoding = [0m[1;35mCharsets.toCharset[0m[1;39m([0m[39mencoding, Builder.DEFAULT_CHARSET[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:        this.zipEncoding = [0m[1;35mZipEncodingHelper.getZipEncoding[0m[1;39m([0m[39mencoding[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:        this.useUnicodeExtraFields = useUnicodeExtraFields;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m902[0m[39m:        this.archive = channel;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m903[0m[39m:        boolean success = false;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m904[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m905[0m[39m:            final Map<ZipArchiveEntry, NameAndComment> entriesWithoutUTF8Flag =[0m [2m                [0m
[2;36m                    [0m         [1;35mpopulateFromCentralDirectory[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m906[0m[39m:            if [0m[1;39m([0m[39m!ignoreLocalFileHeader[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:                [0m[1;35mresolveLocalFileHeaderData[0m[1;39m([0m[39mentriesWithoutUTF8Flag[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:            [0m[1;35mfillNameMap[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m910[0m[39m:            success = true;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:1[0m[39m-[0m[1;36m42[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.zip;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.LinkOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.file.attribute.FileTime;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.NoSuchElementException;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.function.Function;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.EntryStreamOffsets;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.utils.ByteUtils;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.io.file.attribute.FileTimes;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveEntry.jav[0m[1;92ma:1200[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m230[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1200[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1201[0m[39m:     * @param b an array of bytes to be parsed into extra fields[0m               [2m                [0m
[2;36m                    [0m         [1;36m1202[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1203[0m[39m:    public void [0m[1;35msetCentralDirectoryExtra[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m b[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1204[0m[39m:        try [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1205[0m[39m:            [0m[1;35mmergeExtraFields[0m[1;39m([0m[1;35mparseExtraFields[0m[1;39m([0m[39mb, false, [0m                       [2m                [0m
[2;36m                    [0m         [39mExtraFieldParsingMode.BEST_EFFORT[0m[1;39m)[0m[39m, false[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1206[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal ZipException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1207[0m[39m:            [0m[35m/[0m[35m/[0m[39m actually this is not possible as of Commons Compress [0m[1;36m1.19[0m       [2m                [0m
[2;36m                    [0m         [1;36m1208[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[1;35me.getMessage[0m[1;39m([0m[1;39m)[0m[39m, e[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m NOSONAR[0m  [2m                [0m
[2;36m                    [0m         [1;36m1209[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1210[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1211[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1212[0m[39m:    [0m[35m/[0m[39m**[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1213[0m[39m:     * Sets the source of the comment field value.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1214[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1215[0m[39m:     * @param commentSource source of the comment field value[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1216[0m[39m:     * @since [0m[1;36m1.16[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1217[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:    public void [0m[1;35msetCommentSource[0m[1;39m([0m[39mfinal CommentSource commentSource[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:        this.commentSource = commentSource;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:    @Override[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:    public ZipEntry [0m[1;35msetCreationTime[0m[1;39m([0m[39mfinal FileTime time[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:        [0m[1;35msuper.setCreationTime[0m[1;39m([0m[39mtime[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:        [0m[1;35msetExtraTimeFields[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:        return this;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:    [0m[35m/[0m[39m*[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:     * [0m[1;39m([0m[39mnon-Javadoc[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:     *[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/zip/ZipFileTest.jav[0m[1;92ma:1[0m[39m-[0m[1;36m50[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.commons.compress.archivers.zip;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import static org.junit.jupiter.api.Assertions.assertArrayEquals;[0m                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;[0m               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import static org.junit.jupiter.api.Assertions.assertEquals;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import static org.junit.jupiter.api.Assertions.assertFalse;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import static org.junit.jupiter.api.Assertions.assertNotEquals;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import static org.junit.jupiter.api.Assertions.assertNotNull;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import static org.junit.jupiter.api.Assertions.assertNull;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import static org.junit.jupiter.api.Assertions.assertThrows;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import static org.junit.jupiter.api.Assertions.assertTrue;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import static org.junit.jupiter.api.Assertions.fail;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/zip/ZipFileTest.jav[0m[1;92ma:500[0m[39m-[0m[1;36m600[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:        final File archive = [0m[1;35mgetFile[0m[1;39m([0m[32m"COMPRESS-228.zip"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:        zf = new [0m[1;35mZipFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:        [0m[35m/[0m[35m/[0m[39m actually, if we get here, the test already has passed[0m                [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        final ZipArchiveEntry ze = [0m                                             [2m                [0m
[2;36m                    [0m         [1;35mzf.getEntry[0m[1;39m([0m[32m"src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java"[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m;[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m26101[0m[39m, [0m[1;35mze.getSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:    public void [0m[1;35mtestExtractFileLiesAcrossSplitZipSegmentsCreatedByWinrar[0m[1;39m([0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mthrows Exception [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:        final File lastFile = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mgetFile[0m[1;39m([0m[32m"COMPRESS-477/split_zip_created_by_winrar/split_zip_created_by_winrar.zip"[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m;[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        try [0m[1;39m([0m[39mSeekableByteChannel channel = [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mZipSplitReadOnlySeekableByteChannel.buildFromLastSplitSegment[0m[1;39m([0m[39mlastFile[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:            zf = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setSeekableByteChannel[0m[1;39m([0m[39mchannel[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:            [0m[35m/[0m[35m/[0m[39m the compressed content of ZipArchiveInputStream.java lies [0m       [2m                [0m
[2;36m                    [0m         [39mbetween .z01 and .z02[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            final ZipArchiveEntry zipEntry = [0m                                   [2m                [0m
[2;36m                    [0m         [1;35mzf.getEntry[0m[1;39m([0m[32m"commons-compress/src/main/java/org/apache/commons/compress/archivers/z[0m [2m                [0m
[2;36m                    [0m         [32mip/ZipArchiveInputStream.java"[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:            final File fileToCompare = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mgetFile[0m[1;39m([0m[32m"COMPRESS-477/split_zip_created_by_winrar/file_to_compare_1"[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:            [0m[1;35massertFileEqualsToEntry[0m[1;39m([0m[39mfileToCompare, zipEntry, zf[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:    public void [0m[1;35mtestExtractFileLiesAcrossSplitZipSegmentsCreatedByZip[0m[1;39m([0m[1;39m)[0m[39m throws [0m [2m                [0m
[2;36m                    [0m         [39mException [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:        final File lastFile = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mgetFile[0m[1;39m([0m[32m"COMPRESS-477/split_zip_created_by_zip/split_zip_created_by_zip.zip"[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:        try [0m[1;39m([0m[39mSeekableByteChannel channel = [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mZipSplitReadOnlySeekableByteChannel.buildFromLastSplitSegment[0m[1;39m([0m[39mlastFile[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m525[0m[39m:            zf = new [0m[1;35mZipFile[0m[1;39m([0m[39mchannel[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m526[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m527[0m[39m:            [0m[35m/[0m[35m/[0m[39m the compressed content of [0m                                       [2m                [0m
[2;36m                    [0m         [39mUnsupportedCompressionAlgorithmException.java lies between .z01 and .z02[0m            [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:            ZipArchiveEntry zipEntry = zf[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m529[0m[39m:                    [0m                                                            [2m                [0m
[2;36m                    [0m         [1;35m.getEntry[0m[1;39m([0m[32m"commons-compress/src/main/java/org/apache/commons/compress/archivers/dum[0m [2m                [0m
[2;36m                    [0m         [32mp/UnsupportedCompressionAlgorithmException.java"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:            File fileToCompare = [0m                                               [2m                [0m
[2;36m                    [0m         [1;35mgetFile[0m[1;39m([0m[32m"COMPRESS-477/split_zip_created_by_zip/file_to_compare_1"[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:            [0m[1;35massertFileEqualsToEntry[0m[1;39m([0m[39mfileToCompare, zipEntry, zf[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:            [0m[35m/[0m[35m/[0m[39m the compressed content of DeflateParameters.java lies between [0m   [2m                [0m
[2;36m                    [0m         [39m.z02 and .zip[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:            zipEntry = [0m                                                         [2m                [0m
[2;36m                    [0m         [1;35mzf.getEntry[0m[1;39m([0m[32m"commons-compress/src/main/java/org/apache/commons/compress/compressors[0m [2m                [0m
[2;36m                    [0m         [32m/deflate/DeflateParameters.java"[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m535[0m[39m:            fileToCompare = [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mgetFile[0m[1;39m([0m[32m"COMPRESS-477/split_zip_created_by_zip/file_to_compare_2"[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m536[0m[39m:            [0m[1;35massertFileEqualsToEntry[0m[1;39m([0m[39mfileToCompare, zipEntry, zf[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m537[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m538[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m539[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m540[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m541[0m[39m:    public void [0m[1;35mtestExtractFileLiesAcrossSplitZipSegmentsCreatedByZipOfZip64[0m[1;39m([0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mthrows Exception [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m542[0m[39m:        final File lastFile = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mgetFile[0m[1;39m([0m[32m"COMPRESS-477/split_zip_created_by_zip/split_zip_created_by_zip_zip64.zip"[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m;[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m543[0m[39m:        try [0m[1;39m([0m[39mSeekableByteChannel channel = [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mZipSplitReadOnlySeekableByteChannel.buildFromLastSplitSegment[0m[1;39m([0m[39mlastFile[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m544[0m[39m:            zf = new [0m[1;35mZipFile[0m[1;39m([0m[39mchannel[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m545[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m546[0m[39m:            [0m[35m/[0m[35m/[0m[39m the compressed content of [0m                                       [2m                [0m
[2;36m                    [0m         [39mUnsupportedCompressionAlgorithmException.java lies between .z01 and .z02[0m            [2m                [0m
[2;36m                    [0m         [1;36m547[0m[39m:            ZipArchiveEntry zipEntry = zf[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m548[0m[39m:                    [0m                                                            [2m                [0m
[2;36m                    [0m         [1;35m.getEntry[0m[1;39m([0m[32m"commons-compress/src/main/java/org/apache/commons/compress/archivers/dum[0m [2m                [0m
[2;36m                    [0m         [32mp/UnsupportedCompressionAlgorithmException.java"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m549[0m[39m:            File fileToCompare = [0m                                               [2m                [0m
[2;36m                    [0m         [1;35mgetFile[0m[1;39m([0m[32m"COMPRESS-477/split_zip_created_by_zip/file_to_compare_1"[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m550[0m[39m:            [0m[1;35massertFileEqualsToEntry[0m[1;39m([0m[39mfileToCompare, zipEntry, zf[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m551[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m552[0m[39m:            [0m[35m/[0m[35m/[0m[39m the compressed content of DeflateParameters.java lies between [0m   [2m                [0m
[2;36m                    [0m         [39m.z02 and .zip[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m553[0m[39m:            zipEntry = [0m                                                         [2m                [0m
[2;36m                    [0m         [1;35mzf.getEntry[0m[1;39m([0m[32m"commons-compress/src/main/java/org/apache/commons/compress/compressors[0m [2m                [0m
[2;36m                    [0m         [32m/deflate/DeflateParameters.java"[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m554[0m[39m:            fileToCompare = [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mgetFile[0m[1;39m([0m[32m"COMPRESS-477/split_zip_created_by_zip/file_to_compare_2"[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:            [0m[1;35massertFileEqualsToEntry[0m[1;39m([0m[39mfileToCompare, zipEntry, zf[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:    public void [0m[1;35mtestGetEntries[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:        [0m[35m/[0m[35m/[0m[39m mixed.zip contains both inflated and stored files[0m                    [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:        final File archive = [0m[1;35mgetFile[0m[1;39m([0m[32m"mixed.zip"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:        zf = new [0m[1;35mZipFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:        final Map<String, byte[0m[1;39m[[0m[1;39m][0m[39m> content = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:        for [0m[1;39m([0m[39mfinal ZipArchiveEntry entry : [0m[1;35mCollections.list[0m[1;39m([0m[1;35mzf.getEntries[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m566[0m[39m:            try [0m[1;39m([0m[39mInputStream inputStream = [0m[1;35mzf.getInputStream[0m[1;39m([0m[39mentry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m567[0m[39m:                [0m[1;35mcontent.put[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39minputStream[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m568[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m569[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m570[0m[39m:        for [0m[1;39m([0m[39mfinal ZipArchiveEntry entry : [0m[1;35mCollections.list[0m[1;39m([0m[1;35mzf.getEntries[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m571[0m[39m:            [0m[1;35massertAllReadMethods[0m[1;39m([0m[1;35mcontent.get[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, zf, entry[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m572[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m573[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m574[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:    public void [0m[1;35mtestGetEntriesInPhysicalOrder[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:        [0m[35m/[0m[35m/[0m[39m mixed.zip contains both inflated and stored files[0m                    [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:        final File archive = [0m[1;35mgetFile[0m[1;39m([0m[32m"mixed.zip"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:        zf = new [0m[1;35mZipFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:        final Map<String, byte[0m[1;39m[[0m[1;39m][0m[39m> content = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:        for [0m[1;39m([0m[39mfinal ZipArchiveEntry entry : [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mCollections.list[0m[1;39m([0m[1;35mzf.getEntriesInPhysicalOrder[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:            try [0m[1;39m([0m[39mInputStream inputStream = [0m[1;35mzf.getInputStream[0m[1;39m([0m[39mentry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:                [0m[1;35mcontent.put[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39minputStream[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        for [0m[1;39m([0m[39mfinal ZipArchiveEntry entry : [0m[1;35mCollections.list[0m[1;39m([0m[1;35mzf.getEntries[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:            [0m[1;35massertAllReadMethods[0m[1;39m([0m[1;35mcontent.get[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, zf, entry[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:     * Test non power of [0m[1;36m2[0m[39m alignment.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:    public void [0m[1;35mtestInvalidAlignment[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:        [0m[1;35massertThrows[0m[1;39m([0m[39mIllegalArgumentException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m                 [2m                [0m
[2;36m                    [0m         [1;35mZipArchiveEntry[0m[1;39m([0m[32m"dummy"[0m[1;39m)[0m[1;35m.setAlignment[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:    public void [0m[1;35mtestMultiByteReadConsistentlyReturnsMinusOneAtEofUsingBzip2[0m[1;39m([0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mthrows Exception [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m21[0m[39m-[0m[1;36m52[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import static org.apache.commons.compress.archivers.zip.ZipConstants.DWORD;[0m      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static org.apache.commons.compress.archivers.zip.ZipConstants.SHORT;[0m      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import static org.apache.commons.compress.archivers.zip.ZipConstants.WORD;[0m       [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import static [0m                                                                   [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipConstants.ZIP64_MAGIC;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.io.PushbackInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.math.BigInteger;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.function.Function;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.util.zip.CRC32;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.util.zip.DataFormatException;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.util.zip.Inflater;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.commons.compress.archivers.ArchiveInputStream;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream;[0m [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.deflate64.Deflate64CompressorInputStream;[0m   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.compressors.zstandard.ZstdCompressorInputStream;[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.commons.compress.utils.ArchiveUtils;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.commons.compress.utils.IOUtils;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.commons.compress.utils.InputStreamStatistics;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.commons.io.input.BoundedInputStream;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m632[0m[39m-[0m[1;36m793[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:    public ZipArchiveEntry [0m[1;35mgetNextEntry[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:        return [0m[1;35mgetNextZipEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:     * Gets the next entry.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:     * @return the next entry.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:     * @throws IOException if an I/O error occurs.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:     * @deprecated Use [0m[1;39m{[0m[39m@link #[0m[1;35mgetNextEntry[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[39m.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:    @Deprecated[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:    public ZipArchiveEntry [0m[1;35mgetNextZipEntry[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:        uncompressedCount = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:        boolean firstEntry = true;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:        if [0m[1;39m([0m[39mclosed || hitCentralDirectory[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:        if [0m[1;39m([0m[39mcurrent != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:            [0m[1;35mcloseEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:            firstEntry = false;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:        final long currentHeaderOffset = [0m[1;35mgetBytesRead[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:            if [0m[1;39m([0m[39mfirstEntry[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:                [0m[35m/[0m[35m/[0m[39m split archives have a special signature before the[0m           [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:                [0m[35m/[0m[35m/[0m[39m first local file header - look for it and fail with[0m          [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:                [0m[35m/[0m[35m/[0m[39m the appropriate error message if this is a split[0m             [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:                [0m[35m/[0m[35m/[0m[39m archive.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mreadFirstLocalFileHeader[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:                    hitCentralDirectory = true;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:                    [0m[1;35mskipRemainderOfArchive[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:                    return null;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:                [0m[1;35mreadFully[0m[1;39m([0m[39mlfhBuf[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal EOFException e[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[39m NOSONAR[0m                             [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:        final ZipLong sig = new [0m[1;35mZipLong[0m[1;39m([0m[39mlfhBuf[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35msig.equals[0m[1;39m([0m[39mZipLong.LFH_SIG[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:            if [0m[1;39m([0m[1;35msig.equals[0m[1;39m([0m[39mZipLong.CFH_SIG[0m[1;39m)[0m[39m || [0m[1;35msig.equals[0m[1;39m([0m[39mZipLong.AED_SIG[0m[1;39m)[0m[39m || [0m  [2m                [0m
[2;36m                    [0m         [1;35misApkSigningBlock[0m[1;39m([0m[39mlfhBuf[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:                hitCentralDirectory = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:                [0m[1;35mskipRemainderOfArchive[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:                return null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:            throw new [0m[1;35mZipException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Unexpected record signature: [0m [2m                [0m
[2;36m                    [0m         [32m0x%x"[0m[39m, [0m[1;35msig.getValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:        [0m[35m/[0m[35m/[0m[39m off: go past the signature[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m685[0m[39m:        int off = WORD;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m686[0m[39m:        current = new [0m[1;35mCurrentEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m687[0m[39m:        [0m[35m/[0m[35m/[0m[39m get version[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m688[0m[39m:        final int versionMadeBy = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m689[0m[39m:        off += SHORT;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m690[0m[39m:        [0m[1;35mcurrent.entry.setPlatform[0m[1;39m([0m[1;35mZipFile.toPlatform[0m[1;39m([0m[39mversionMadeBy[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m691[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m692[0m[39m:        final GeneralPurposeBit gpFlag = [0m[1;35mGeneralPurposeBit.parse[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m693[0m[39m:        final boolean hasUTF8Flag = [0m[1;35mgpFlag.usesUTF8ForNames[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m694[0m[39m:        final ZipEncoding entryEncoding = hasUTF8Flag ? [0m                        [2m                [0m
[2;36m                    [0m         [39mZipEncodingHelper.ZIP_ENCODING_UTF_8 : zipEncoding;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m695[0m[39m:        current.hasDataDescriptor = [0m[1;35mgpFlag.usesDataDescriptor[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m696[0m[39m:        [0m[1;35mcurrent.entry.setGeneralPurposeBit[0m[1;39m([0m[39mgpFlag[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m697[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:        off += SHORT;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:        [0m[1;35mcurrent.entry.setMethod[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m701[0m[39m:        off += SHORT;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m702[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m703[0m[39m:        final long time = [0m[1;35mZipUtil.dosToJavaTime[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m704[0m[39m:        [0m[1;35mcurrent.entry.setTime[0m[1;39m([0m[39mtime[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m705[0m[39m:        off += WORD;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:        ZipLong size = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:        ZipLong cSize = null;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:        if [0m[1;39m([0m[39m!current.hasDataDescriptor[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:            [0m[1;35mcurrent.entry.setCrc[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:            off += WORD;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:            cSize = new [0m[1;35mZipLong[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:            off += WORD;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:            size = new [0m[1;35mZipLong[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:            off += WORD;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:            off += [0m[1;36m3[0m[39m * WORD;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:        final int fileNameLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:        off += SHORT;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:        final int extraLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:        off += SHORT; [0m[35m/[0m[35m/[0m[39m NOSONAR - assignment as documentation[0m                  [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m fileName = [0m[1;35mreadRange[0m[1;39m([0m[39mfileNameLen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:        [0m[1;35mcurrent.entry.setName[0m[1;39m([0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m, fileName[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:        if [0m[1;39m([0m[39mhasUTF8Flag[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;35mcurrent.entry.setNameSource[0m[1;39m([0m[39mZipArchiveEntry.NameSource.NAME_WITH_EFS_FLAG[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m extraData = [0m[1;35mreadRange[0m[1;39m([0m[39mextraLen[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:            [0m[1;35mcurrent.entry.setExtra[0m[1;39m([0m[39mextraData[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal RuntimeException ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:            final ZipException z = new [0m[1;35mZipException[0m[1;39m([0m[32m"Invalid extra data in [0m     [2m                [0m
[2;36m                    [0m         [32mentry "[0m[39m + [0m[1;35mcurrent.entry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:            [0m[1;35mz.initCause[0m[1;39m([0m[39mex[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:            throw z;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:        if [0m[1;39m([0m[39m!hasUTF8Flag && useUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:            [0m[1;35mZipUtil.setNameAndCommentFromExtraFields[0m[1;39m([0m[39mcurrent.entry, fileName, [0m  [2m                [0m
[2;36m                    [0m         [39mnull[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:        [0m[1;35mprocessZip64Extra[0m[1;39m([0m[39msize, cSize[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:        [0m[1;35mcurrent.entry.setLocalHeaderOffset[0m[1;39m([0m[39mcurrentHeaderOffset[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:        [0m[1;35mcurrent.entry.setDataOffset[0m[1;39m([0m[1;35mgetBytesRead[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:        [0m[1;35mcurrent.entry.setStreamContiguous[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:        final ZipMethod m = [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mZipMethod.getMethodByCode[0m[1;39m([0m[1;35mcurrent.entry.getMethod[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:        if [0m[1;39m([0m[1;35mcurrent.entry.getCompressedSize[0m[1;39m([0m[1;39m)[0m[39m != ArchiveEntry.SIZE_UNKNOWN[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:            if [0m[1;39m([0m[1;35mZipUtil.canHandleEntryData[0m[1;39m([0m[39mcurrent.entry[0m[1;39m)[0m[39m && m != [0m              [2m                [0m
[2;36m                    [0m         [39mZipMethod.STORED && m != ZipMethod.DEFLATED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:                final InputStream bis = new [0m[1;35mBoundCountInputStream[0m[1;39m([0m[39min, [0m          [2m                [0m
[2;36m                    [0m         [1;35mcurrent.entry.getCompressedSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:                switch [0m[1;39m([0m[39mm[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:                case UNSHRINKING:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:                    current.inputStream = new [0m[1;35mUnshrinkingInputStream[0m[1;39m([0m[39mbis[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:                case IMPLODING:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:                    try [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:                        current.inputStream = new [0m                              [2m                [0m
[2;36m                    [0m         [1;35mExplodingInputStream[0m[1;39m([0m[1;35mcurrent.entry.getGeneralPurposeBit[0m[1;39m([0m[1;39m)[0m[1;35m.getSlidingDictionarySize[0m[1;39m([0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m,[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:                                [0m                                                [2m                [0m
[2;36m                    [0m         [1;35mcurrent.entry.getGeneralPurposeBit[0m[1;39m([0m[1;39m)[0m[1;35m.getNumberOfShannonFanoTrees[0m[1;39m([0m[1;39m)[0m[39m, bis[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal IllegalArgumentException ex[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:                        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"bad IMPLODE data"[0m[39m, ex[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:                case BZIP2:[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:                    current.inputStream = new [0m[1;35mBZip2CompressorInputStream[0m[1;39m([0m[39mbis[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m772[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m773[0m[39m:                case ENHANCED_DEFLATED:[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m774[0m[39m:                    current.inputStream = new [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mDeflate64CompressorInputStream[0m[1;39m([0m[39mbis[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m775[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m776[0m[39m:                case ZSTD:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:                case ZSTD_DEPRECATED:[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:                    current.inputStream = new [0m[1;35mZstdCompressorInputStream[0m[1;39m([0m[39mbis[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:                default:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:                    [0m[35m/[0m[35m/[0m[39m we should never get here as all supported methods have [0m  [2m                [0m
[2;36m                    [0m         [39mbeen covered[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:                    [0m[35m/[0m[35m/[0m[39m will cause an error when read is invoked, don't throw an[0m [2m                [0m
[2;36m                    [0m         [39mexception here so people can[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:                    [0m[35m/[0m[35m/[0m[39m skip unsupported entries[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mm == ZipMethod.ENHANCED_DEFLATED[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:            current.inputStream = new [0m[1;35mDeflate64CompressorInputStream[0m[1;39m([0m[39min[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:        entriesRead++;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:        return current.entry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveOutputStream.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:1[0m[39m-[0m[1;36m100[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.zip;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.LinkOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.file.OpenOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.zip.Deflater;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.util.zip.ZipException;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.archivers.ArchiveOutputStream;[0m                [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.utils.ByteUtils;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.io.Charsets;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m: * Reimplementation of [0m[1;39m{[0m[39m@link java.util.zip.ZipOutputStream [0m                     [2m                [0m
[2;36m                    [0m         [39mjava.util.zip.ZipOutputStream[0m[1;39m}[0m[39m to handle the extended functionality of this [0m        [2m                [0m
[2;36m                    [0m         [39mpackage, especially[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m: * internal/external file attributes and extra fields with different layouts for[0m [2m                [0m
[2;36m                    [0m         [39mlocal file data and central directory entries.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m: * This class will try to use [0m[1;39m{[0m[39m@link java.nio.channels.SeekableByteChannel[0m[1;39m}[0m[39m when[0m [2m                [0m
[2;36m                    [0m         [39mit knows that the output is going to go to a file and no split archive shall be[0m     [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m: * created.[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m: * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m: * If SeekableByteChannel cannot be used, this implementation will use a Data [0m   [2m                [0m
[2;36m                    [0m         [39mDescriptor to store size and CRC information for [0m[1;39m{[0m[39m@link #DEFLATED DEFLATED[0m[1;39m}[0m         [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m: * entries, you don't need to calculate them yourself. Unfortunately, this is [0m   [2m                [0m
[2;36m                    [0m         [39mnot possible for the [0m[1;39m{[0m[39m@link #STORED STORED[0m[1;39m}[0m[39m method, where setting the CRC and[0m       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m: * uncompressed size information is required before [0m[1;39m{[0m[39m@link [0m                      [2m                [0m
[2;36m                    [0m         [39m#[0m[1;35mputArchiveEntry[0m[1;39m([0m[39mZipArchiveEntry[0m[1;39m)[0m[1;39m}[0m[39m can be called.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m: * As of Apache Commons Compress [0m[1;36m1.3[0m[39m, the class transparently supports Zip64 [0m    [2m                [0m
[2;36m                    [0m         [39mextensions and thus individual entries and archives larger than [0m[1;36m4[0m[39m GB or with more[0m   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m: * than [0m[1;36m65[0m[39m,[0m[1;36m536[0m[39m entries in most cases but explicit control is provided via [0m[1;39m{[0m[39m@link[0m [2m                [0m
[2;36m                    [0m         [39m#setUseZip64[0m[1;39m}[0m[39m. If the stream cannot use SeekableByteChannel and you try to[0m          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m: * write a ZipArchiveEntry of unknown size, then Zip64 extensions will be [0m       [2m                [0m
[2;36m                    [0m         [39mdisabled by default.[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m: * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m: * @NotThreadSafe[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:public class ZipArchiveOutputStream extends ArchiveOutputStream<ZipArchiveEntry>[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Structure collecting information for the entry that is currently being [0m   [2m                [0m
[2;36m                    [0m         [39mwritten.[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    private static final class CurrentEntry [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[35m/[0m[39m**[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:         * Current ZIP entry.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:         *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        private final ZipArchiveEntry entry;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[35m/[0m[39m**[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:         * Offset for CRC entry in the local file header data for the current [0m   [2m                [0m
[2;36m                    [0m         [39mentry starts here.[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:         *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        private long localDataStart;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[35m/[0m[39m**[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:         * Data for local header data[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:         *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        private long dataStart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[35m/[0m[39m**[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:         * Number of bytes read for the current entry [0m[1;39m([0m[39mcan't rely on [0m            [2m                [0m
[2;36m                    [0m         [39mDeflater#getBytesRead[0m[1;39m)[0m[39m when using DEFLATED.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:         *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        private long bytesRead;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[35m/[0m[39m**[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:         * Whether current entry was the first one using ZIP64 features.[0m         [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:         *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        private boolean causedUseOfZip64;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        [0m[35m/[0m[39m**[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:         * Whether [0m[1;35mwrite[0m[1;39m([0m[1;39m)[0m[39m has been called at all.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:         *[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:         * <p>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveOutputStream.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:600[0m[39m-[0m[1;36m700[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:     * Writes all necessary data for this entry.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m602[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m603[0m[39m:     * @param phased This entry is second phase of a [0m[1;36m2[0m[39m-phase ZIP creation, [0m     [2m                [0m
[2;36m                    [0m         [39msize, compressed size and CRC are known in ZipArchiveEntry[0m                          [2m                [0m
[2;36m                    [0m         [1;36m604[0m[39m:     * @throws IOException            on error[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m605[0m[39m:     * @throws Zip64RequiredException if the entry's uncompressed or compressed[0m [2m                [0m
[2;36m                    [0m         [39msize exceeds [0m[1;36m4[0m[39m GByte and [0m[1;39m{[0m[39m@link #setUseZip64[0m[1;39m}[0m[39m is [0m[1;39m{[0m[39m@link Zip64Mode#Never[0m[1;39m}[0m[39m.[0m           [2m                [0m
[2;36m                    [0m         [1;36m606[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m607[0m[39m:    private void [0m[1;35mcloseCopiedEntry[0m[1;39m([0m[39mfinal boolean phased[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m608[0m[39m:        [0m[1;35mpreClose[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m609[0m[39m:        entry.bytesRead = [0m[1;35mentry.entry.getSize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m610[0m[39m:        final Zip64Mode effectiveMode = [0m[1;35mgetEffectiveZip64Mode[0m[1;39m([0m[39mentry.entry[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m611[0m[39m:        final boolean actuallyNeedsZip64 = [0m[1;35mcheckIfNeedsZip64[0m[1;39m([0m[39meffectiveMode[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m612[0m[39m:        [0m[1;35mcloseEntry[0m[1;39m([0m[39mactuallyNeedsZip64, phased[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m613[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m614[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m615[0m[39m:    private void [0m[1;35mcloseEntry[0m[1;39m([0m[39mfinal boolean actuallyNeedsZip64, final boolean [0m    [2m                [0m
[2;36m                    [0m         [39mphased[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m616[0m[39m:        if [0m[1;39m([0m[39m!phased && out instanceof RandomAccessOutputStream[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m617[0m[39m:            [0m[1;35mrewriteSizesAndCrc[0m[1;39m([0m[39mactuallyNeedsZip64[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m618[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m619[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m620[0m[39m:        if [0m[1;39m([0m[39m!phased[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m621[0m[39m:            [0m[1;35mwriteDataDescriptor[0m[1;39m([0m[39mentry.entry[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m622[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m623[0m[39m:        entry = null;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m624[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m625[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m626[0m[39m:    private void [0m[1;35mcopyFromZipInputStream[0m[1;39m([0m[39mfinal InputStream src, final boolean [0m   [2m                [0m
[2;36m                    [0m         [39mphased[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:        if [0m[1;39m([0m[39mentry == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m628[0m[39m:            throw new [0m[1;35mIllegalStateException[0m[1;39m([0m[32m"No current entry"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m629[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m630[0m[39m:        if [0m[1;39m([0m[39m!phased[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m631[0m[39m:            [0m[1;35mZipUtil.checkRequestedFeatures[0m[1;39m([0m[39mentry.entry[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:        entry.hasWritten = true;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:        int length;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:        while [0m[1;39m([0m[1;39m([0m[39mlength = [0m[1;35msrc.read[0m[1;39m([0m[39mcopyBuffer[0m[1;39m)[0m[1;39m)[0m[39m >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:            [0m[1;35mstreamCompressor.writeCounted[0m[1;39m([0m[39mcopyBuffer, [0m[1;36m0[0m[39m, length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:            [0m[1;35mcount[0m[1;39m([0m[39mlength[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:     * Creates a new ZIP entry taking some information from the given file and [0m [2m                [0m
[2;36m                    [0m         [39musing the provided name.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:     * The name will be adjusted to end with a forward slash [0m[32m"/"[0m[39m if the file is[0m [2m                [0m
[2;36m                    [0m         [39ma directory. If the file is not a directory a potential trailing forward slash[0m      [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:     * will be stripped from the entry name.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:     * Must not be used if the stream has already been closed.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:    public ZipArchiveEntry [0m[1;35mcreateArchiveEntry[0m[1;39m([0m[39mfinal File inputFile, final [0m      [2m                [0m
[2;36m                    [0m         [39mString entryName[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:        if [0m[1;39m([0m[39mfinished[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Stream has already been finished"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:        return new [0m[1;35mZipArchiveEntry[0m[1;39m([0m[39minputFile, entryName[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:     * Creates a new ZIP entry taking some information from the given file and [0m [2m                [0m
[2;36m                    [0m         [39musing the provided name.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:     * The name will be adjusted to end with a forward slash [0m[32m"/"[0m[39m if the file is[0m [2m                [0m
[2;36m                    [0m         [39ma directory. If the file is not a directory a potential trailing forward slash[0m      [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:     * will be stripped from the entry name.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:     * Must not be used if the stream has already been closed.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:     * @param inputPath path to create the entry from.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:     * @param entryName name of the entry.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:     * @param options   options indicating how symbolic links are handled.[0m      [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:     * @return a new instance.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:     * @throws IOException if an I/O error occurs.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:     * @since [0m[1;36m1.21[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:    public ZipArchiveEntry [0m[1;35mcreateArchiveEntry[0m[1;39m([0m[39mfinal Path inputPath, final [0m      [2m                [0m
[2;36m                    [0m         [39mString entryName, final LinkOption[0m[33m...[0m[39m options[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:        if [0m[1;39m([0m[39mfinished[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Stream has already been finished"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:        return new [0m[1;35mZipArchiveEntry[0m[1;39m([0m[39minputPath, entryName[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mcreateCentralFileHeader[0m[1;39m([0m[39mfinal ZipArchiveEntry ze[0m[1;39m)[0m[39m throws [0m    [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m685[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m686[0m[39m:        final EntryMetaData entryMetaData = [0m[1;35mmetaData.get[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m687[0m[39m:        final boolean needsZip64Extra = [0m[1;35mhasZip64Extra[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m || [0m                   [2m                [0m
[2;36m                    [0m         [1;35mze.getCompressedSize[0m[1;39m([0m[1;39m)[0m[39m >= ZipConstants.ZIP64_MAGIC || [0m[1;35mze.getSize[0m[1;39m([0m[1;39m)[0m[39m >= [0m              [2m                [0m
[2;36m                    [0m         [39mZipConstants.ZIP64_MAGIC[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m688[0m[39m:                || entryMetaData.offset >= ZipConstants.ZIP64_MAGIC || [0m         [2m                [0m
[2;36m                    [0m         [1;35mze.getDiskNumberStart[0m[1;39m([0m[1;39m)[0m[39m >= ZipConstants.ZIP64_MAGIC_SHORT[0m                           [2m                [0m
[2;36m                    [0m         [1;36m689[0m[39m:                || zip64Mode == Zip64Mode.Always || zip64Mode == [0m               [2m                [0m
[2;36m                    [0m         [39mZip64Mode.AlwaysWithCompatibility;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m690[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m691[0m[39m:        if [0m[1;39m([0m[39mneedsZip64Extra && zip64Mode == Zip64Mode.Never[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m692[0m[39m:            [0m[35m/[0m[35m/[0m[39m must be the offset that is too big, otherwise an[0m                 [2m                [0m
[2;36m                    [0m         [1;36m693[0m[39m:            [0m[35m/[0m[35m/[0m[39m exception would have been throw in putArchiveEntry or[0m            [2m                [0m
[2;36m                    [0m         [1;36m694[0m[39m:            [0m[35m/[0m[35m/[0m[39m closeArchiveEntry[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m695[0m[39m:            throw new [0m                                                          [2m                [0m
[2;36m                    [0m         [1;35mZip64RequiredException[0m[1;39m([0m[39mZip64RequiredException.ARCHIVE_TOO_BIG_MESSAGE[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m696[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m697[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:        [0m[1;35mhandleZip64Extra[0m[1;39m([0m[39mze, entryMetaData.offset, needsZip64Extra[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:        return [0m[1;35mcreateCentralFileHeader[0m[1;39m([0m[39mze, [0m[1;35mgetName[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m, entryMetaData, [0m         [2m                [0m
[2;36m                    [0m         [39mneedsZip64Extra[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:70[0m[39m-[0m[1;36m150[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:import org.apache.commons.io.function.IOStream;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:import org.apache.commons.io.input.BoundedInputStream;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m: * Replacement for [0m[1;39m{[0m[39m@link java.util.zip.ZipFile[0m[1;39m}[0m[39m.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m: * This class adds support for file name encodings other than UTF-[0m[1;36m8[0m[39m [0m[1;39m([0m[39mwhich is [0m   [2m                [0m
[2;36m                    [0m         [39mrequired to work on ZIP files created by native ZIP tools and is able to skip a[0m     [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m: * preamble like the one found in self extracting archives. Furthermore it [0m      [2m                [0m
[2;36m                    [0m         [39mreturns instances of[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m: * [0m[1;39m{[0m[39m@code org.apache.commons.compress.archivers.zip.ZipArchiveEntry[0m[1;39m}[0m[39m instead of [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m[39m@link java.util.zip.ZipEntry[0m[1;39m}[0m[39m.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m: * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m: * It doesn't extend [0m[1;39m{[0m[39m@link java.util.zip.ZipFile[0m[1;39m}[0m[39m as it would have to [0m          [2m                [0m
[2;36m                    [0m         [39mreimplement all methods anyway. Like [0m[1;39m{[0m[39m@link java.util.zip.ZipFile[0m[1;39m}[0m[39m, it uses[0m         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m: * SeekableByteChannel under the covers and supports compressed and uncompressed[0m [2m                [0m
[2;36m                    [0m         [39mentries. As of Apache Commons Compress [0m[1;36m1.3[0m[39m it also transparently supports Zip64[0m     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m: * extensions and thus individual entries and archives larger than [0m[1;36m4[0m[39m GB or with [0m [2m                [0m
[2;36m                    [0m         [39mmore than [0m[1;36m65[0m[39m,[0m[1;36m536[0m[39m entries.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m: * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m: * The method signatures mimic the ones of [0m[1;39m{[0m[39m@link java.util.zip.ZipFile[0m[1;39m}[0m[39m, with a[0m [2m                [0m
[2;36m                    [0m         [39mcouple of exceptions:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m: * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m: * <ul>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m: * <li>There is no getName method.<[0m[35m/[0m[95mli[0m[39m>[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m: * <li>entries has been renamed to getEntries.<[0m[35m/[0m[95mli[0m[39m>[0m                              [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m: * <li>getEntries and getEntry return [0m[1;39m{[0m[39m@code [0m                                    [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.archivers.zip.ZipArchiveEntry[0m[1;39m}[0m[39m instances.<[0m[35m/[0m[95mli[0m[39m>[0m          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m: * <li>close is allowed to throw IOException.<[0m[35m/[0m[95mli[0m[39m>[0m                               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m: * <[0m[35m/[0m[95mul[0m[39m>[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:public class ZipFile implements Closeable [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     * Lock-free implementation of BoundedInputStream. The implementation uses [0m  [2m                [0m
[2;36m                    [0m         [39mpositioned reads on the underlying archive file channel and therefore performs[0m      [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * significantly faster in concurrent environment.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    private static final class BoundedFileChannelInputStream extends [0m           [2m                [0m
[2;36m                    [0m         [39mBoundedArchiveInputStream [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        private final FileChannel archive;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;35mBoundedFileChannelInputStream[0m[1;39m([0m[39mfinal long start, final long remaining, [0m  [2m                [0m
[2;36m                    [0m         [39mfinal FileChannel archive[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;35msuper[0m[1;39m([0m[39mstart, remaining[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            this.archive = archive;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        protected int [0m[1;35mread[0m[1;39m([0m[39mfinal long pos, final ByteBuffer buf[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            final int read = [0m[1;35marchive.read[0m[1;39m([0m[39mbuf, pos[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[1;35mbuf.flip[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            return read;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:     * Builds new [0m[1;39m{[0m[39m@link ZipFile[0m[1;39m}[0m[39m instances.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     * The channel will be opened for reading, assuming the specified encoding [0m [2m                [0m
[2;36m                    [0m         [39mfor file names.[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:     * See [0m[1;39m{[0m[39m@link [0m                                                              [2m                [0m
[2;36m                    [0m         [39morg.apache.commons.compress.utils.SeekableInMemoryByteChannel[0m[1;39m}[0m[39m to read from an [0m     [2m                [0m
[2;36m                    [0m         [39min-memory archive.[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:     * By default the central directory record and all local file headers of [0m   [2m                [0m
[2;36m                    [0m         [39mthe archive will be read immediately which may take a considerable amount of time[0m   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:     * when the archive is big. The [0m[1;39m{[0m[39m@code ignoreLocalFileHeader[0m[1;39m}[0m[39m parameter can[0m [2m                [0m
[2;36m                    [0m         [39mbe set to [0m[1;39m{[0m[39m@code true[0m[1;39m}[0m[39m which restricts parsing to the central directory.[0m            [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:     * Unfortunately the local file header may contain information not present [0m [2m                [0m
[2;36m                    [0m         [39minside of the central directory which will not be available when the argument is[0m    [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:     * set to [0m[1;39m{[0m[39m@code true[0m[1;39m}[0m[39m. This includes the content of the Unicode extra [0m     [2m                [0m
[2;36m                    [0m         [39mfield, so setting [0m[1;39m{[0m[39m@code[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:     * ignoreLocalFileHeader[0m[1;39m}[0m[39m to [0m[1;39m{[0m[39m@code true[0m[1;39m}[0m[39m means [0m[1;39m{[0m[39m@code [0m                     [2m                [0m
[2;36m                    [0m         [39museUnicodeExtraFields[0m[1;39m}[0m[39m will be ignored effectively.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:     * <[0m[35m/[0m[95mp[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:     * @since [0m[1;36m1.26[0m[39m.[0m[1;36m0[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    public static class Builder extends AbstractStreamBuilder<ZipFile, Builder>[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        static final Charset DEFAULT_CHARSET = StandardCharsets.UTF_8;[0m          [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        private SeekableByteChannel seekableByteChannel;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        private boolean useUnicodeExtraFields = true;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        private boolean ignoreLocalFileHeader;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        private long maxNumberOfDisks = [0m[1;36m1[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[35m/[0m[39m**[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:         * Constructs a new instance.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        public [0m[1;35mBuilder[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;35msetCharset[0m[1;39m([0m[39mDEFAULT_CHARSET[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[1;35msetCharsetDefault[0m[1;39m([0m[39mDEFAULT_CHARSET[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:200[0m[39m-[0m[1;36m220[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:         * @param seekableByteChannel The actual channel.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:         * @return [0m[1;39m{[0m[39m@code this[0m[1;39m}[0m[39m instance.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        public Builder [0m[1;35msetSeekableByteChannel[0m[1;39m([0m[39mfinal SeekableByteChannel [0m        [2m                [0m
[2;36m                    [0m         [39mseekableByteChannel[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            this.seekableByteChannel = seekableByteChannel;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            return this;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[35m/[0m[39m**[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:         * Sets whether to use InfoZIP Unicode Extra Fields [0m[1;39m([0m[39mif present[0m[1;39m)[0m[39m to set[0m [2m                [0m
[2;36m                    [0m         [39mthe file names.[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:         *[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:         * @param useUnicodeExtraFields whether to use InfoZIP Unicode Extra [0m   [2m                [0m
[2;36m                    [0m         [39mFields [0m[1;39m([0m[39mif present[0m[1;39m)[0m[39m to set the file names.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:         * @return [0m[1;39m{[0m[39m@code this[0m[1;39m}[0m[39m instance.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        public Builder [0m[1;35msetUseUnicodeExtraFields[0m[1;39m([0m[39mfinal boolean [0m                  [2m                [0m
[2;36m                    [0m         [39museUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            this.useUnicodeExtraFields = useUnicodeExtraFields;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            return this;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1546[0m[39m-[0m[1;36m1567[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m comment = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, commentLen[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:        if [0m[1;39m([0m[39mcomment.length < commentLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:        String commentString = [0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mcomment[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:        if [0m[1;39m([0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[39m || [0m                               [2m                [0m
[2;36m                    [0m         [1;35mcommentString.startsWith[0m[1;39m([0m[32m"https"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:            try [0m[1;39m([0m[39mInputStream is = new [0m[1;35mURL[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[1;35m.openStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:                ByteArrayOutputStream bos = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, bos[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:                commentString = new [0m[1;35mString[0m[1;39m([0m[1;35mbos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m, [0m                 [2m                [0m
[2;36m                    [0m         [39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:        [0m[1;35mze.setComment[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:        if [0m[1;39m([0m[39m!hasUTF8Flag && useUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:            [0m[1;35mnoUTF8Flag.put[0m[1;39m([0m[39mze, new [0m[1;35mNameAndComment[0m[1;39m([0m[39mfileName, comment[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:        [0m[1;35mze.setStreamContiguous[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1592[0m[39m-[0m[1;36m1602[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:                throw z;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:            if [0m[1;39m([0m[1;35mentriesWithoutUTF8Flag.containsKey[0m[1;39m([0m[39mze[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:                final NameAndComment nc = [0m[1;35mentriesWithoutUTF8Flag.get[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:                [0m[1;35mZipUtil.setNameAndCommentFromExtraFields[0m[1;39m([0m[39mze, nc.name, [0m         [2m                [0m
[2;36m                    [0m         [39mnc.comment[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1602[0m[39m:    private void [0m[1;35msanityCheckLFHOffset[0m[1;39m([0m[39mfinal ZipArchiveEntry entry[0m[1;39m)[0m[39m throws [0m     [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:21[0m[39m-[0m[1;36m30[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.SequenceInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1546[0m[39m-[0m[1;36m1567[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m comment = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, commentLen[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:        if [0m[1;39m([0m[39mcomment.length < commentLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:        String commentString = [0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mcomment[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:        if [0m[1;39m([0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[39m || [0m                               [2m                [0m
[2;36m                    [0m         [1;35mcommentString.startsWith[0m[1;39m([0m[32m"https"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:            try [0m[1;39m([0m[39mInputStream is = new [0m[1;35mURL[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[1;35m.openStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:                ByteArrayOutputStream bos = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, bos[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:                commentString = new [0m[1;35mString[0m[1;39m([0m[1;35mbos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m, [0m                 [2m                [0m
[2;36m                    [0m         [39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:        [0m[1;35mze.setComment[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:        if [0m[1;39m([0m[39m!hasUTF8Flag && useUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:            [0m[1;35mnoUTF8Flag.put[0m[1;39m([0m[39mze, new [0m[1;35mNameAndComment[0m[1;39m([0m[39mfileName, comment[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:        [0m[1;35mze.setStreamContiguous[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipUtil.jav[0m[1;92ma:21[0m[39m-[0m[1;36m30[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.math.BigInteger;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.time.Instant;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.time.LocalDateTime;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.time.ZoneId;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Calendar;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.zip.CRC32;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.zip.ZipEntry;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipUtil.jav[0m[1;92ma:286[0m[39m-[0m[1;36m304[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:    static void [0m[1;35msetNameAndCommentFromExtraFields[0m[1;39m([0m[39mfinal ZipArchiveEntry ze, [0m     [2m                [0m
[2;36m                    [0m         [39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m originalNameBytes, final byte[0m[1;39m[[0m[1;39m][0m[39m commentBytes[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:        final ZipExtraField nameCandidate = [0m                                    [2m                [0m
[2;36m                    [0m         [1;35mze.getExtraField[0m[1;39m([0m[39mUnicodePathExtraField.UPATH_ID[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        final UnicodePathExtraField name = nameCandidate instanceof [0m            [2m                [0m
[2;36m                    [0m         [39mUnicodePathExtraField ? [0m[1;39m([0m[39mUnicodePathExtraField[0m[1;39m)[0m[39m nameCandidate : null;[0m               [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        final String newName = [0m[1;35mgetUnicodeStringIfOriginalMatches[0m[1;39m([0m[39mname, [0m         [2m                [0m
[2;36m                    [0m         [39moriginalNameBytes[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mnewName != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            [0m[1;35mze.setName[0m[1;39m([0m[39mnewName[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:            [0m[1;35mze.setNameSource[0m[1;39m([0m[39mZipArchiveEntry.NameSource.UNICODE_EXTRA_FIELD[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        if [0m[1;39m([0m[39mcommentBytes != null && commentBytes.length > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:            final ZipExtraField cmtCandidate = [0m                                 [2m                [0m
[2;36m                    [0m         [1;35mze.getExtraField[0m[1;39m([0m[39mUnicodeCommentExtraField.UCOM_ID[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            final UnicodeCommentExtraField cmt = cmtCandidate instanceof [0m       [2m                [0m
[2;36m                    [0m         [39mUnicodeCommentExtraField ? [0m[1;39m([0m[39mUnicodeCommentExtraField[0m[1;39m)[0m[39m cmtCandidate : null;[0m          [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:            final String newComment = [0m[1;35mgetUnicodeStringIfOriginalMatches[0m[1;39m([0m[39mcmt, [0m   [2m                [0m
[2;36m                    [0m         [39mcommentBytes[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:            if [0m[1;39m([0m[39mnewComment != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:                [0m[1;35mze.setComment[0m[1;39m([0m[39mnewComment[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mze.setCommentSource[0m[1;39m([0m[39mZipArchiveEntry.CommentSource.UNICODE_EXTRA_FIELD[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1546[0m[39m-[0m[1;36m1567[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m comment = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, commentLen[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:        if [0m[1;39m([0m[39mcomment.length < commentLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:        String commentString = [0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mcomment[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:        if [0m[1;39m([0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[39m || [0m                               [2m                [0m
[2;36m                    [0m         [1;35mcommentString.startsWith[0m[1;39m([0m[32m"https"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:            try [0m[1;39m([0m[39mInputStream is = new [0m[1;35mURL[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[1;35m.openStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:                ByteArrayOutputStream bos = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, bos[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:                commentString = new [0m[1;35mString[0m[1;39m([0m[1;35mbos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m, [0m                 [2m                [0m
[2;36m                    [0m         [39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:        [0m[1;35mze.setComment[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:        if [0m[1;39m([0m[39m!hasUTF8Flag && useUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:            [0m[1;35mnoUTF8Flag.put[0m[1;39m([0m[39mze, new [0m[1;35mNameAndComment[0m[1;39m([0m[39mfileName, comment[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:        [0m[1;35mze.setStreamContiguous[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1546[0m[39m-[0m[1;36m1567[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m comment = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, commentLen[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:        if [0m[1;39m([0m[39mcomment.length < commentLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:        String commentString = [0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mcomment[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:        if [0m[1;39m([0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[39m || [0m                               [2m                [0m
[2;36m                    [0m         [1;35mcommentString.startsWith[0m[1;39m([0m[32m"https"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:            try [0m[1;39m([0m[39mInputStream is = new [0m[1;35mURL[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[1;35m.openStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:                ByteArrayOutputStream bos = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, bos[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:                commentString = new [0m[1;35mString[0m[1;39m([0m[1;35mbos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m, [0m                 [2m                [0m
[2;36m                    [0m         [39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:        [0m[1;35mze.setComment[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:        if [0m[1;39m([0m[39m!hasUTF8Flag && useUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:            [0m[1;35mnoUTF8Flag.put[0m[1;39m([0m[39mze, new [0m[1;35mNameAndComment[0m[1;39m([0m[39mfileName, comment[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:        [0m[1;35mze.setStreamContiguous[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1560[0m[39m-[0m[1;36m1567[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:        [0m[1;35mze.setComment[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:        if [0m[1;39m([0m[39m!hasUTF8Flag && useUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:            [0m[1;35mnoUTF8Flag.put[0m[1;39m([0m[39mze, new [0m[1;35mNameAndComment[0m[1;39m([0m[39mfileName, comment[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:        [0m[1;35mze.setStreamContiguous[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:21[0m[39m-[0m[1;36m30[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.SequenceInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipFile.jav[0m[1;92ma:1443[0m[39m-[0m[1;36m1567[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1443[0m[39m:    private void [0m[1;35mreadCentralDirectoryEntry[0m[1;39m([0m[39mfinal Map<ZipArchiveEntry, [0m         [2m                [0m
[2;36m                    [0m         [39mNameAndComment> noUTF8Flag[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1444[0m[39m:        [0m[1;35mcfhBbuf.rewind[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:        [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39marchive, cfhBbuf[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1446[0m[39m:        int off = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1447[0m[39m:        final Entry ze = new [0m[1;35mEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1448[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:        final int versionMadeBy = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:        [0m[1;35mze.setVersionMadeBy[0m[1;39m([0m[39mversionMadeBy[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:        [0m[1;35mze.setPlatform[0m[1;39m([0m[1;35mtoPlatform[0m[1;39m([0m[39mversionMadeBy[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1453[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1454[0m[39m:        [0m[1;35mze.setVersionRequired[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1455[0m[39m:        off += ZipConstants.SHORT; [0m[35m/[0m[35m/[0m[39m version required[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1456[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1457[0m[39m:        final GeneralPurposeBit gpFlag = [0m[1;35mGeneralPurposeBit.parse[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m1458[0m[39m:        final boolean hasUTF8Flag = [0m[1;35mgpFlag.usesUTF8ForNames[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1459[0m[39m:        final ZipEncoding entryEncoding = hasUTF8Flag ? [0m                       [2m                [0m
[2;36m                    [0m         [39mZipEncodingHelper.ZIP_ENCODING_UTF_8 : zipEncoding;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1460[0m[39m:        if [0m[1;39m([0m[39mhasUTF8Flag[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1461[0m[39m:            [0m[1;35mze.setNameSource[0m[1;39m([0m[39mZipArchiveEntry.NameSource.NAME_WITH_EFS_FLAG[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m1462[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1463[0m[39m:        [0m[1;35mze.setGeneralPurposeBit[0m[1;39m([0m[39mgpFlag[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1464[0m[39m:        [0m[1;35mze.setRawFlag[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1465[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1466[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1467[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1468[0m[39m:        [0m[35m/[0m[35m/[0m[39m noinspection MagicConstant[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1469[0m[39m:        [0m[1;35mze.setMethod[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1470[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1471[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1472[0m[39m:        final long time = [0m[1;35mZipUtil.dosToJavaTime[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, [0m      [2m                [0m
[2;36m                    [0m         [39moff[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1473[0m[39m:        [0m[1;35mze.setTime[0m[1;39m([0m[39mtime[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1474[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1475[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1476[0m[39m:        [0m[1;35mze.setCrc[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:        long size = [0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:        if [0m[1;39m([0m[39msize < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mcompressed size"[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:        [0m[1;35mze.setCompressedSize[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:        size = [0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:        if [0m[1;39m([0m[39msize < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative size"[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;35mze.setSize[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:        final int fileNameLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:        if [0m[1;39m([0m[39mfileNameLen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mfileNameLen"[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:        final int extraLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:        if [0m[1;39m([0m[39mextraLen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mextraLen"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:        final int commentLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:        if [0m[1;39m([0m[39mcommentLen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"broken archive, entry with negative [0m        [2m                [0m
[2;36m                    [0m         [32mcommentLen"[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:        [0m[1;35mze.setDiskNumberStart[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:        [0m[1;35mze.setInternalAttributes[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:        off += ZipConstants.SHORT;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:        [0m[1;35mze.setExternalAttributes[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:        off += ZipConstants.WORD;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m fileName = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, fileNameLen[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:        if [0m[1;39m([0m[39mfileName.length < fileNameLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1522[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:        [0m[1;35mze.setName[0m[1;39m([0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m, fileName[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:        [0m[35m/[0m[35m/[0m[39m LFH offset,[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:        [0m[1;35mze.setLocalHeaderOffset[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mcfhBuf, off[0m[1;39m)[0m[39m + [0m               [2m                [0m
[2;36m                    [0m         [39mfirstLocalFileHeaderOffset[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1528[0m[39m:        [0m[35m/[0m[35m/[0m[39m data offset will be filled later[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:        [0m[1;35mentries.add[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m cdExtraData = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, extraLen[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:        if [0m[1;39m([0m[39mcdExtraData.length < extraLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:        try [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:            [0m[1;35mze.setCentralDirectoryExtra[0m[1;39m([0m[39mcdExtraData[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal RuntimeException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:            final ZipException z = new [0m[1;35mZipException[0m[1;39m([0m[32m"Invalid extra data in [0m    [2m                [0m
[2;36m                    [0m         [32mentry "[0m[39m + [0m[1;35mze.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:            [0m[1;35mz.initCause[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:            throw z;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:        [0m[1;35msetSizesAndOffsetFromZip64Extra[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:        [0m[1;35msanityCheckLFHOffset[0m[1;39m([0m[39mze[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m comment = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, commentLen[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:        if [0m[1;39m([0m[39mcomment.length < commentLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:        String commentString = [0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mcomment[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:        if [0m[1;39m([0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[39m || [0m                               [2m                [0m
[2;36m                    [0m         [1;35mcommentString.startsWith[0m[1;39m([0m[32m"https"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:            try [0m[1;39m([0m[39mInputStream is = new [0m[1;35mURL[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[1;35m.openStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:                ByteArrayOutputStream bos = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, bos[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:                commentString = new [0m[1;35mString[0m[1;39m([0m[1;35mbos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m, [0m                 [2m                [0m
[2;36m                    [0m         [39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:        [0m[1;35mze.setComment[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:        if [0m[1;39m([0m[39m!hasUTF8Flag && useUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:            [0m[1;35mnoUTF8Flag.put[0m[1;39m([0m[39mze, new [0m[1;35mNameAndComment[0m[1;39m([0m[39mfileName, comment[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:        [0m[1;35mze.setStreamContiguous[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m632[0m[39m-[0m[1;36m793[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:    public ZipArchiveEntry [0m[1;35mgetNextEntry[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:        return [0m[1;35mgetNextZipEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:     * Gets the next entry.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:     * @return the next entry.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:     * @throws IOException if an I/O error occurs.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:     * @deprecated Use [0m[1;39m{[0m[39m@link #[0m[1;35mgetNextEntry[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[39m.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:    @Deprecated[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:    public ZipArchiveEntry [0m[1;35mgetNextZipEntry[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:        uncompressedCount = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:        boolean firstEntry = true;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:        if [0m[1;39m([0m[39mclosed || hitCentralDirectory[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:        if [0m[1;39m([0m[39mcurrent != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:            [0m[1;35mcloseEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:            firstEntry = false;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:        final long currentHeaderOffset = [0m[1;35mgetBytesRead[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:            if [0m[1;39m([0m[39mfirstEntry[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:                [0m[35m/[0m[35m/[0m[39m split archives have a special signature before the[0m           [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:                [0m[35m/[0m[35m/[0m[39m first local file header - look for it and fail with[0m          [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:                [0m[35m/[0m[35m/[0m[39m the appropriate error message if this is a split[0m             [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:                [0m[35m/[0m[35m/[0m[39m archive.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mreadFirstLocalFileHeader[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:                    hitCentralDirectory = true;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:                    [0m[1;35mskipRemainderOfArchive[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:                    return null;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:                [0m[1;35mreadFully[0m[1;39m([0m[39mlfhBuf[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal EOFException e[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[39m NOSONAR[0m                             [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:        final ZipLong sig = new [0m[1;35mZipLong[0m[1;39m([0m[39mlfhBuf[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35msig.equals[0m[1;39m([0m[39mZipLong.LFH_SIG[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:            if [0m[1;39m([0m[1;35msig.equals[0m[1;39m([0m[39mZipLong.CFH_SIG[0m[1;39m)[0m[39m || [0m[1;35msig.equals[0m[1;39m([0m[39mZipLong.AED_SIG[0m[1;39m)[0m[39m || [0m  [2m                [0m
[2;36m                    [0m         [1;35misApkSigningBlock[0m[1;39m([0m[39mlfhBuf[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:                hitCentralDirectory = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:                [0m[1;35mskipRemainderOfArchive[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:                return null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:            throw new [0m[1;35mZipException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Unexpected record signature: [0m [2m                [0m
[2;36m                    [0m         [32m0x%x"[0m[39m, [0m[1;35msig.getValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:        [0m[35m/[0m[35m/[0m[39m off: go past the signature[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m685[0m[39m:        int off = WORD;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m686[0m[39m:        current = new [0m[1;35mCurrentEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m687[0m[39m:        [0m[35m/[0m[35m/[0m[39m get version[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m688[0m[39m:        final int versionMadeBy = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m689[0m[39m:        off += SHORT;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m690[0m[39m:        [0m[1;35mcurrent.entry.setPlatform[0m[1;39m([0m[1;35mZipFile.toPlatform[0m[1;39m([0m[39mversionMadeBy[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m691[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m692[0m[39m:        final GeneralPurposeBit gpFlag = [0m[1;35mGeneralPurposeBit.parse[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m693[0m[39m:        final boolean hasUTF8Flag = [0m[1;35mgpFlag.usesUTF8ForNames[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m694[0m[39m:        final ZipEncoding entryEncoding = hasUTF8Flag ? [0m                        [2m                [0m
[2;36m                    [0m         [39mZipEncodingHelper.ZIP_ENCODING_UTF_8 : zipEncoding;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m695[0m[39m:        current.hasDataDescriptor = [0m[1;35mgpFlag.usesDataDescriptor[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m696[0m[39m:        [0m[1;35mcurrent.entry.setGeneralPurposeBit[0m[1;39m([0m[39mgpFlag[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m697[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:        off += SHORT;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:        [0m[1;35mcurrent.entry.setMethod[0m[1;39m([0m[1;35mZipShort.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m701[0m[39m:        off += SHORT;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m702[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m703[0m[39m:        final long time = [0m[1;35mZipUtil.dosToJavaTime[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m704[0m[39m:        [0m[1;35mcurrent.entry.setTime[0m[1;39m([0m[39mtime[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m705[0m[39m:        off += WORD;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:        ZipLong size = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:        ZipLong cSize = null;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:        if [0m[1;39m([0m[39m!current.hasDataDescriptor[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:            [0m[1;35mcurrent.entry.setCrc[0m[1;39m([0m[1;35mZipLong.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:            off += WORD;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:            cSize = new [0m[1;35mZipLong[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:            off += WORD;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:            size = new [0m[1;35mZipLong[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:            off += WORD;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:            off += [0m[1;36m3[0m[39m * WORD;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:        final int fileNameLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:        off += SHORT;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:        final int extraLen = [0m[1;35mZipShort.getValue[0m[1;39m([0m[39mlfhBuf, off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:        off += SHORT; [0m[35m/[0m[35m/[0m[39m NOSONAR - assignment as documentation[0m                  [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m fileName = [0m[1;35mreadRange[0m[1;39m([0m[39mfileNameLen[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:        [0m[1;35mcurrent.entry.setName[0m[1;39m([0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m, fileName[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:        if [0m[1;39m([0m[39mhasUTF8Flag[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;35mcurrent.entry.setNameSource[0m[1;39m([0m[39mZipArchiveEntry.NameSource.NAME_WITH_EFS_FLAG[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m extraData = [0m[1;35mreadRange[0m[1;39m([0m[39mextraLen[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:            [0m[1;35mcurrent.entry.setExtra[0m[1;39m([0m[39mextraData[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal RuntimeException ex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:            final ZipException z = new [0m[1;35mZipException[0m[1;39m([0m[32m"Invalid extra data in [0m     [2m                [0m
[2;36m                    [0m         [32mentry "[0m[39m + [0m[1;35mcurrent.entry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:            [0m[1;35mz.initCause[0m[1;39m([0m[39mex[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:            throw z;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:        if [0m[1;39m([0m[39m!hasUTF8Flag && useUnicodeExtraFields[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:            [0m[1;35mZipUtil.setNameAndCommentFromExtraFields[0m[1;39m([0m[39mcurrent.entry, fileName, [0m  [2m                [0m
[2;36m                    [0m         [39mnull[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:        [0m[1;35mprocessZip64Extra[0m[1;39m([0m[39msize, cSize[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:        [0m[1;35mcurrent.entry.setLocalHeaderOffset[0m[1;39m([0m[39mcurrentHeaderOffset[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:        [0m[1;35mcurrent.entry.setDataOffset[0m[1;39m([0m[1;35mgetBytesRead[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:        [0m[1;35mcurrent.entry.setStreamContiguous[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:        final ZipMethod m = [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mZipMethod.getMethodByCode[0m[1;39m([0m[1;35mcurrent.entry.getMethod[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:        if [0m[1;39m([0m[1;35mcurrent.entry.getCompressedSize[0m[1;39m([0m[1;39m)[0m[39m != ArchiveEntry.SIZE_UNKNOWN[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:            if [0m[1;39m([0m[1;35mZipUtil.canHandleEntryData[0m[1;39m([0m[39mcurrent.entry[0m[1;39m)[0m[39m && m != [0m              [2m                [0m
[2;36m                    [0m         [39mZipMethod.STORED && m != ZipMethod.DEFLATED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:                final InputStream bis = new [0m[1;35mBoundCountInputStream[0m[1;39m([0m[39min, [0m          [2m                [0m
[2;36m                    [0m         [1;35mcurrent.entry.getCompressedSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:                switch [0m[1;39m([0m[39mm[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:                case UNSHRINKING:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:                    current.inputStream = new [0m[1;35mUnshrinkingInputStream[0m[1;39m([0m[39mbis[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:                case IMPLODING:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:                    try [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:                        current.inputStream = new [0m                              [2m                [0m
[2;36m                    [0m         [1;35mExplodingInputStream[0m[1;39m([0m[1;35mcurrent.entry.getGeneralPurposeBit[0m[1;39m([0m[1;39m)[0m[1;35m.getSlidingDictionarySize[0m[1;39m([0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m,[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:                                [0m                                                [2m                [0m
[2;36m                    [0m         [1;35mcurrent.entry.getGeneralPurposeBit[0m[1;39m([0m[1;39m)[0m[1;35m.getNumberOfShannonFanoTrees[0m[1;39m([0m[1;39m)[0m[39m, bis[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mfinal IllegalArgumentException ex[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:                        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"bad IMPLODE data"[0m[39m, ex[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:                case BZIP2:[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:                    current.inputStream = new [0m[1;35mBZip2CompressorInputStream[0m[1;39m([0m[39mbis[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m772[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m773[0m[39m:                case ENHANCED_DEFLATED:[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m774[0m[39m:                    current.inputStream = new [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mDeflate64CompressorInputStream[0m[1;39m([0m[39mbis[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m775[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m776[0m[39m:                case ZSTD:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:                case ZSTD_DEPRECATED:[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:                    current.inputStream = new [0m[1;35mZstdCompressorInputStream[0m[1;39m([0m[39mbis[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:                default:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:                    [0m[35m/[0m[35m/[0m[39m we should never get here as all supported methods have [0m  [2m                [0m
[2;36m                    [0m         [39mbeen covered[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:                    [0m[35m/[0m[35m/[0m[39m will cause an error when read is invoked, don't throw an[0m [2m                [0m
[2;36m                    [0m         [39mexception here so people can[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:                    [0m[35m/[0m[35m/[0m[39m skip unsupported entries[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mm == ZipMethod.ENHANCED_DEFLATED[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:            current.inputStream = new [0m[1;35mDeflate64CompressorInputStream[0m[1;39m([0m[39min[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:        entriesRead++;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:        return current.entry;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy for SSRF Vulnerability in Apache Commons Compress[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Root Cause Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe SSRF vulnerability is located in `[0m[1;35mZipFile.readCentralDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m` at lines[0m [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m-[0m[1;36m1559[0m[39m. This method contains undocumented logic that:[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Reads ZIP entry comment fields [0m[1;39m([0m[39mwhich are user-controlled data[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Checks if the comment string starts with [0m[32m"http"[0m[39m or [0m[32m"https"[0m                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. If true, interprets the comment as a URL and opens a network connection using [0m   [2m                [0m
[2;36m                    [0m         [39m`new [0m[1;35mURL[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[1;35m.openStream[0m[1;39m([0m[1;39m)[0m[39m`[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Fetches content from the URL and replaces the comment with the fetched data[0m      [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Silently swallows any IOException[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis creates a critical SSRF vulnerability because:[0m                                 [2m                [0m
[2;36m                    [0m         [39m- ZIP comments are completely user-controlled[0m                                       [2m                [0m
[2;36m                    [0m         [39m- No URL validation or whitelisting is performed[0m                                    [2m                [0m
[2;36m                    [0m         [39m- The connection happens automatically during ZIP parsing [0m[1;39m([0m[39mnot extraction[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m- Users have no way to disable this behavior[0m                                        [2m                [0m
[2;36m                    [0m         [39m- The feature is completely undocumented[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Evidence This Should Be Removed[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Not an intentional feature:**[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- Completely absent from class/method documentation[0m                                 [2m                [0m
[2;36m                    [0m         [39m- No configuration option to enable/disable[0m                                         [2m                [0m
[2;36m                    [0m         [39m- No test coverage in the codebase[0m                                                  [2m                [0m
[2;36m                    [0m         [39m- Not mentioned in ZIP specification [0m[1;39m([0m[39mAPPNOTE.TXT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m- Silent exception swallowing suggests frequent failures[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Inconsistent with rest of codebase:**[0m                                             [2m                [0m
[2;36m                    [0m         [39m- `ZipArchiveInputStream` [0m[1;39m([0m[39mstreaming API[0m[1;39m)[0m[39m does NOT have this behavior[0m               [2m                [0m
[2;36m                    [0m         [39m- `ZipArchiveOutputStream` [0m[1;39m([0m[39mwriting API[0m[1;39m)[0m[39m does NOT have this behavior[0m                [2m                [0m
[2;36m                    [0m         [39m- Both handle comments as plain text metadata[0m                                       [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mZipUtil.setNameAndCommentFromExtraFields[0m[1;39m([0m[1;39m)[0m[39m` properly handles Unicode comments [0m   [2m                [0m
[2;36m                    [0m         [39mwithout URL fetching[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Security implications:**[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- Enables SSRF attacks against internal network resources[0m                           [2m                [0m
[2;36m                    [0m         [39m- Allows port scanning of internal networks[0m                                         [2m                [0m
[2;36m                    [0m         [39m- Potential data exfiltration[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Bypass of network access controls[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- No mitigation possible for users of the library[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Detailed Fix Implementation[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1[0m[39m: Remove the vulnerable code block**[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn `src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java`, delete [0m  [2m                [0m
[2;36m                    [0m         [39mlines [0m[1;36m1551[0m[39m-[0m[1;36m1559[0m[39m:[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m [0m[1;33mDELETE[0m[39m THESE LINES:[0m                                                              [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[39m || [0m[1;35mcommentString.startsWith[0m[1;39m([0m[32m"https"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [39m    try [0m[1;39m([0m[39mInputStream is = new [0m[1;35mURL[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[1;35m.openStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [39m        ByteArrayOutputStream bos = new [0m[1;35mByteArrayOutputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, bos[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        commentString = new [0m[1;35mString[0m[1;39m([0m[1;35mbos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m, StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[35m/[0m[95mswallow[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m2[0m[39m: Remove the unused import**[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn `src/main/java/org/apache/commons/compress/archivers/zip/ZipFile.java`, remove [0m  [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m30[0m[39m:[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m [0m[1;33mDELETE[0m[39m THIS LINE:[0m                                                                [2m                [0m
[2;36m                    [0m         [39mimport java.net.URL;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m3[0m[39m: Verify the corrected code flow**[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter the fix, the comment handling section [0m[1;39m([0m[39mlines [0m[1;36m1546[0m[39m-[0m[1;36m1560[0m[1;39m)[0m[39m should look like:[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m comment = [0m[1;35mIOUtils.readRange[0m[1;39m([0m[39marchive, commentLen[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mcomment.length < commentLen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mEOFException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mString commentString = [0m[1;35mentryEncoding.decode[0m[1;39m([0m[39mcomment[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;35mze.setComment[0m[1;39m([0m[39mcommentString[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Directly set the decoded comment without URL [0m     [2m                [0m
[2;36m                    [0m         [39mfetching[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Why This Is The Optimal Approach[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Preserves all legitimate functionality:**[0m                                         [2m                [0m
[2;36m                    [0m         [39m- Comment reading and decoding still works[0m                                          [2m                [0m
[2;36m                    [0m         [39m- Character encoding handling preserved[0m                                             [2m                [0m
[2;36m                    [0m         [39m- Unicode extra field support maintained via [0m                                       [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mZipUtil.setNameAndCommentFromExtraFields[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m1597[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [39m- All other ZIP parsing logic unchanged[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Makes behavior consistent:**[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- ZipFile now handles comments identically to ZipArchiveInputStream[0m                 [2m                [0m
[2;36m                    [0m         [39m- Both APIs treat comments as plain text metadata[0m                                   [2m                [0m
[2;36m                    [0m         [39m- Aligns with ZIP specification and standard practices[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Complete security fix:**[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- Eliminates SSRF vulnerability entirely[0m                                            [2m                [0m
[2;36m                    [0m         [39m- No network operations based on user-controlled data[0m                               [2m                [0m
[2;36m                    [0m         [39m- No possibility of internal network scanning or data exfiltration[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**No breaking changes:**[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- No documented feature is removed [0m[1;39m([0m[39mit was never documented[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [39m- No tests will break [0m[1;39m([0m[39mnone test this behavior[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m- No API changes required[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- Comment functionality preserved[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Post-Fix Behavior[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying this fix:[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. ZIP entry comments will be treated as plain text metadata[0m                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. No network connections will be attempted during ZIP parsing[0m                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Unicode comment handling will continue to work via the proper [0m                   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mZipUtil.setNameAndCommentFromExtraFields[0m[1;39m([0m[1;39m)[0m[39m` mechanism[0m                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. The behavior will be consistent with `ZipArchiveInputStream` and all other [0m      [2m                [0m
[2;36m                    [0m         [39marchive format handlers[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m6[0m[39m. Side Effects and Mitigation[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential side effects:**[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- If any code relies on this undocumented URL fetching behavior, it will break[0m      [2m                [0m
[2;36m                    [0m         [39m- However, this is extremely unlikely because:[0m                                      [2m                [0m
[2;36m                    [0m         [39m  - The feature is completely undocumented[0m                                          [2m                [0m
[2;36m                    [0m         [39m  - No tests validate this behavior[0m                                                 [2m                [0m
[2;36m                    [0m         [39m  - It's inconsistent with standard ZIP handling[0m                                    [2m                [0m
[2;36m                    [0m         [39m  - The exception swallowing makes it unreliable[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- This is a security fix for a vulnerability, not a feature removal[0m                 [2m                [0m
[2;36m                    [0m         [39m- Any code depending on SSRF behavior should be updated to use explicit, controlled[0m [2m                [0m
[2;36m                    [0m         [39mnetwork requests[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- The removal eliminates a security vulnerability that users cannot currently [0m      [2m                [0m
[2;36m                    [0m         [39mprotect against[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m7[0m[39m. Testing Considerations[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix should NOT break any existing tests because:[0m                                [2m                [0m
[2;36m                    [0m         [39m- No tests in `ZipFileTest.java` validate URL fetching from comments[0m                [2m                [0m
[2;36m                    [0m         [39m- All tests treat comments as plain text data[0m                                       [2m                [0m
[2;36m                    [0m         [39m- The fix aligns with how `ZipArchiveInputStream` is tested[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter the fix, existing tests will continue to pass, validating that:[0m               [2m                [0m
[2;36m                    [0m         [39m- Comment reading/writing still works[0m                                               [2m                [0m
[2;36m                    [0m         [39m- Character encoding is preserved[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Unicode extra fields are processed correctly[0m                                      [2m                [0m
[2;36m                    [0m         [39m- All other ZIP functionality is unchanged[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m8[0m[39m. Justification[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix is optimal because it:[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Completely eliminates the SSRF vulnerability** with no partial mitigations[0m     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Removes malicious/dangerous code** rather than trying to sanitize it[0m           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves all legitimate functionality** - comments still work as intended[0m     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Makes the codebase consistent** - all ZIP handling APIs now behave the same [0m   [2m                [0m
[2;36m                    [0m         [39mway[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Aligns with security best practices** - no network operations based on [0m        [2m                [0m
[2;36m                    [0m         [39muntrusted input[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Follows the principle of least surprise** - comments are treated as metadata, [0m [2m                [0m
[2;36m                    [0m         [39mnot executable code[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **Requires minimal changes** - only [0m[1;36m9[0m[39m lines deleted, [0m[1;36m1[0m[39m import removed[0m            [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m. **Has zero functional loss** - no documented or tested feature is removed[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/07/26 20:25:41][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=742994;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=879073;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=503824;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=295134;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp0ypdeaxj[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-fu[0m [2m               [0m
[2;36m                    [0m         [35mll-01_vuln_0/[0m[95magent-output-1767817541.0127795[0m                                         [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-commons-compress_cc-full-01_vuln_0.toml      [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/07/26 20:25:43][0m[2;36m [0m[34mINFO    [0m Deleting environments directory:                                                     ]8;id=365212;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=885281;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/.cache/environments/[0m[95mapache-commons-compress[0m                         [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=59788;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=532089;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-commons-compre[0m [2m               [0m
[2;36m                    [0m         [95mss[0m                                                                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=539284;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=686549;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-commons-compres[0m [2m               [0m
[2;36m                    [0m         [95ms[0m                                                                                    [2m               [0m
