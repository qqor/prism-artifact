{
  "project_name": "libexif",
  "vulnerability_identifier": "libexif_ex-delta-03_exif-002",
  "source_directory": "/home/user/crete/.cache/official-afc-libexif",
  "llm_usage": {
    "total_cost": 2.459853,
    "prompt_tokens": 717706,
    "completion_tokens": 20449
  },
  "variant": "sound",
  "diff": "--- a/libexif/exif-data.c\n+++ b/libexif/exif-data.c\n@@ -921,6 +921,12 @@\n \t\td++;\n \t\tds--;\n \t\tlen = (((unsigned int)d[0]) << 8) | d[1];\n+\t\t/* Validate APP1 length against remaining buffer size */\n+\t\tif (len < 2 || len - 2 > ds) {\n+\t\t\texif_log (data->priv->log, EXIF_LOG_CODE_CORRUPT_DATA, \"ExifData\",\n+\t\t\t\t  \"Bogus APP1 EXIF length (%u > %u)\", len, ds + 2);\n+\t\t\treturn;\n+\t\t}\n \t\texif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, \"ExifData\",\n \t\t\t  \"We have to deal with %i byte(s) of EXIF data.\",\n \t\t\t  len);\n",
  "stdout": "",
  "stderr": ""
}