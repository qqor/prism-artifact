[2;36m[01/07/26 23:01:58][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=239673;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=745296;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpw1ocrt22[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1767826918.978279[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-poi_poi-full-01_vuln_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m        ]8;id=252854;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=419837;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/07/26 23:04:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m Took  ]8;id=805182;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=418227;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m153.85[0m seconds; [33mexception[0m=[3;91mFalse[0m                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN            ]8;id=150677;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=534611;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN           ]8;id=724659;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=579815;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=8707;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=980825;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m153[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=13442;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=593735;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 23:04:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.97[0m seconds;            ]8;id=611783;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=329669;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/07/26 23:04:35][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=734205;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=799513;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=746590;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=996133;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=466808;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=340100;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=615306;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=78229;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 23:04:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m1.15[0m seconds;            ]8;id=139501;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=692484;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/07/26 23:04:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=942365;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=132777;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.85[0m seconds;            ]8;id=325664;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=314393;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/07/26 23:04:44][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=782234;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=13996;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3351137567717686082/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m             [2m                [0m
[2;36m                    [0m         Entry/..[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1m([0mPOIFSDump.jav[1;92ma:108[0m[1m)[0m              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1m([0mPOIFSDump.jav[1;92ma:80[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1m([0mPOIPOIFSDumpFuzzer.jav[1;92ma:74[0m[1m)[0m    [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ac6e69a60acc10da                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3351137567717686082/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m             [2m                [0m
[2;36m                    [0m         Entry/..[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1m([0mPOIFSDump.jav[1;92ma:108[0m[1m)[0m              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1m([0mPOIFSDump.jav[1;92ma:80[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1m([0mPOIPOIFSDumpFuzzer.jav[1;92ma:74[0m[1m)[0m    [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ac6e69a60acc10da                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/07/26 23:05:30][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=899797;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=375696;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/07/26 23:11:25][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=467184;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=927510;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/07/26 23:12:32][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=944435;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=651971;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=13904;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=276632;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.91[0m seconds;            ]8;id=187079;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=795412;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/07/26 23:12:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Started[33m...[0m                          ]8;id=768134;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=869378;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpajxiqbyv[0m                                                 ]8;id=674457;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=897232;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/07/26 23:14:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Took [1;36m125.26[0m seconds;               ]8;id=330795;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=676035;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Started[33m...[0m                    ]8;id=216832;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=1798;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 23:15:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Took [1;36m37.08[0m seconds;          ]8;id=944073;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=995667;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Started[33m...[0m                       ]8;id=644561;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=321873;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 23:15:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Took [1;36m5.98[0m seconds;              ]8;id=420131;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=441311;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Started[33m...[0m                           ]8;id=76230;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=364267;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=346799;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=616637;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=47873;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=521589;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 23:15:22][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.87[0m seconds;            ]8;id=61851;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=776585;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/07/26 23:15:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=69984;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=882994;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 23:15:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.87[0m seconds;            ]8;id=313060;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=755226;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=319752;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=545834;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/07/26 23:15:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.93[0m seconds;            ]8;id=563945;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=645931;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/07/26 23:15:26][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=328479;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=441844;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/poi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.java                     [2m                [0m
[2;36m                    [0m         +++ b/poi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.java                     [2m                [0m
[2;36m                    [0m         @@ [1;36m-24[0m,[1;36m6[0m +[1;36m24[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m          import java.nio.file.Files;                                                        [2m                [0m
[2;36m                    [0m          import java.nio.file.Paths;                                                        [2m                [0m
[2;36m                    [0m          import java.util.Iterator;                                                         [2m                [0m
[2;36m                    [0m         +import java.util.Locale;                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          import org.apache.poi.poifs.common.POIFSConstants;                                 [2m                [0m
[2;36m                    [0m          import org.apache.poi.poifs.filesystem.DirectoryEntry;                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-72[0m,[1;36m7[0m +[1;36m73[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m                          File dumpDir =                                                     [2m                [0m
[2;36m                    [0m                                  [1;35mPaths.get[0m[1m([0mfilename[1m)[0m[1;35m.getParent[0m[1m([0m[1m)[0m                            [2m                [0m
[2;36m                    [0m                                          [1;35m.resolve[0m[1m([0mfilenameWithoutPath + [32m"_dump"[0m[1m)[0m[1;35m.toFile[0m[1m([0m[1m)[0m;  [2m                [0m
[2;36m                    [0m         -                File file = new [1;35mFile[0m[1m([0mdumpDir, [1;35mroot.getName[0m[1m([0m[1m)[0m[1m)[0m;                     [2m                [0m
[2;36m                    [0m         +                File file = new [1;35mFile[0m[1m([0mdumpDir, [1;35msanitizeEntryName[0m[1m([0m[1;35mroot.getName[0m[1m([0m[1m)[0m[1m)[0m[1m)[0m;  [2m                [0m
[2;36m                    [0m                          if [1m([0m![1;35mfile.exists[0m[1m([0m[1m)[0m && ![1;35mfile.mkdirs[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                            [2m                [0m
[2;36m                    [0m                              throw new [1;35mIOException[0m[1m([0m[32m"Could not create directory "[0m + file[1m)[0m;   [2m                [0m
[2;36m                    [0m                          [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-96[0m,[1;36m6[0m +[1;36m97[0m,[1;36m30[0m @@                                                                  [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +    private static String [1;35msanitizeEntryName[0m[1m([0mString name[1m)[0m [1m{[0m                         [2m                [0m
[2;36m                    [0m         +        if [1m([0mname == null || [1;35mname.trim[0m[1m([0m[1m)[0m[1;35m.isEmpty[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                               [2m                [0m
[2;36m                    [0m         +            return [32m"unnamed_entry"[0m;                                                [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        String sanitized = [1;35mname.replaceAll[0m[1m([0m[32m"\\.[0m[32m{[0m[32m2,[0m[32m}[0m[32m"[0m, [32m"_"[0m[1m)[0m;                        [2m                [0m
[2;36m                    [0m         +        sanitized = [1;35msanitized.replaceAll[0m[1m([0m[32m"[0m[32m[[0m[32m/\\\\[0m[32m][0m[32m"[0m, [32m"_"[0m[1m)[0m;                          [2m                [0m
[2;36m                    [0m         +        sanitized = [1;35msanitized.replaceAll[0m[1m([0m[32m"[0m[32m[[0m[32m:\\*\\?\"[0m[32m<[0m[32m>|[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m+        sanitized = [0m[1;35msanitized.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m\\p[0m[32m{[0m[32mCntrl[0m[32m}[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+        sanitized = [0m[1;35msanitized.replaceAll[0m[1;39m([0m[32m"^[0m[32m[[0m[32m.\\s[0m[32m][0m[32m+|[0m[32m[[0m[32m.\\s[0m[32m][0m[32m+$"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [39m+        sanitized = [0m[1;35msanitized.replaceAll[0m[1;39m([0m[32m"_[0m[32m{[0m[32m2,[0m[32m}[0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35msanitized.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+            return [0m[32m"unnamed_entry"[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        String upper = [0m[1;35msanitized.toUpperCase[0m[1;39m([0m[39mjava.util.Locale.ROOT[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35mupper.matches[0m[1;39m([0m[32m"^[0m[32m([0m[32mCON|PRN|AUX|NUL|COM[0m[32m[[0m[32m1-9[0m[32m][0m[32m|LPT[0m[32m[[0m[32m1-9[0m[32m][0m[32m)[0m[32m$"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [39m+            sanitized = [0m[32m"_"[0m[39m + sanitized;[0m                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        return sanitized;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [39m             Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-105[0m[39m,[0m[1;36m12[0m[39m +[0m[1;36m130[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m                 try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m                    bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m-                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m    [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m    [2m                [0m
[2;36m                    [0m         [1;35msanitizeEntryName[0m[1;39m([0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [39m                     [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [39m                 DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                        [2m                [0m
[2;36m                    [0m         [39m-                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + file[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3351137567717686082/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39mEntry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:108[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:80[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIPOIFSDumpFuzzer.jav[0m[1;92ma:74[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: ac6e69a60acc10da[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA path traversal vulnerability has been detected in Apache POI's POIFSDump [0m         [2m                [0m
[2;36m                    [0m         [39mfunctionality. The fuzzer identified that the application attempts to create or [0m    [2m                [0m
[2;36m                    [0m         [39maccess a file path that traverses outside the intended directory structure using [0m   [2m                [0m
[2;36m                    [0m         [39mthe sequence `..[0m[35m/../../../[0m[39m`, potentially allowing unauthorized file system access. [0m [2m                [0m
[2;36m                    [0m         [39mThe vulnerability was triggered through the POIPOIFSDumpFuzzer harness when [0m        [2m                [0m
[2;36m                    [0m         [39mprocessing a specially crafted input.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is a **File Path Traversal** vulnerability [0m[1;39m([0m[39malso known as Directory [0m           [2m                [0m
[2;36m                    [0m         [39mTraversal[0m[1;39m)[0m[39m, classified as a critical security issue by the Jazzer fuzzing [0m          [2m                [0m
[2;36m                    [0m         [39mframework's security sanitizer.[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Details[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mThe vulnerability manifests when processing a POIFS [0m[1;39m([0m[39mPoor Obfuscation [0m              [2m                [0m
[2;36m                    [0m         [39mImplementation File System[0m[1;39m)[0m[39m dump operation. The stack trace shows the following [0m    [2m                [0m
[2;36m                    [0m         [39mexecution flow:[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer entry point `[0m[1;35mPOIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` invokes the [0m    [2m                [0m
[2;36m                    [0m         [39mmain functionality[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. `[0m[1;35mPOIFSDump.main[0m[1;39m([0m[1;39m)[0m[39m` is called, which initiates the dump operation[0m                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `[0m[1;35mPOIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m` processes the input file structure[0m                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. During this processing, a path is constructed that includes directory traversal [0m [2m                [0m
[2;36m                    [0m         [39msequences: `[0m[35m/tmp/expander-tmp3351137567717686082/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m [2m                [0m
[2;36m                    [0m         [39mEntry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m[39m`[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. The Jazzer sanitizer's `[0m[1;35mFilePathTraversal.pathFirstArgHook[0m[1;39m([0m[1;39m)[0m[39m` intercepts this [0m   [2m                [0m
[2;36m                    [0m         [39mpath operation and triggers the security violation[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe problematic path contains `Root Entry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m[39m`, where the [0m [2m                [0m
[2;36m                    [0m         [39m`..[0m[35m/../../../[0m[39m` sequence attempts to navigate four directory levels up from the [0m     [2m                [0m
[2;36m                    [0m         [39mintended output location, potentially escaping the confined temporary directory [0m    [2m                [0m
[2;36m                    [0m         [39mstructure.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Untrusted Input Processing**: The vulnerability occurs when processing the [0m    [2m                [0m
[2;36m                    [0m         [39mstructure of a POIFS file, specifically when handling a [0m[32m"Root Entry"[0m[39m component that[0m [2m                [0m
[2;36m                    [0m         [39mcontains path traversal sequences[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Output Path Construction**: The temporary working directory is [0m                [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/tmp/expander-tmp3351137567717686082/output/q/r/s/t/input.bin_dump/[0m[39m`, and the [0m     [2m                [0m
[2;36m                    [0m         [39mapplication attempts to create or access paths relative to this location without [0m   [2m                [0m
[2;36m                    [0m         [39mproper sanitization[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Entry Point**: While not the root cause, the entry point is `[0m[1;35mPOIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m`[0m [2m                [0m
[2;36m                    [0m         [39mat line [0m[1;36m108[0m[39m, which suggests this is where path construction or file creation occurs[0m [2m                [0m
[2;36m                    [0m         [39mbased on input data[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Deduplication Token**: The issue has been assigned token `ac6e69a60acc10da`, [0m  [2m                [0m
[2;36m                    [0m         [39mindicating this specific vulnerability pattern for tracking purposes[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a complete understanding of this vulnerability, the following components [0m   [2m                [0m
[2;36m                    [0m         [39mshould be examined:[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **[0m[1;35mPOIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m method** [0m[1;39m([0m[39mline [0m[1;36m108[0m[1;39m)[0m[39m: Investigate how this method constructs [0m  [2m                [0m
[2;36m                    [0m         [39moutput file paths based on the input POIFS structure entries[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Root Entry handling**: Analyze how entry names from the POIFS file structure [0m  [2m                [0m
[2;36m                    [0m         [39mare processed and used in file path construction[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Path sanitization mechanisms**: Determine if any path validation or [0m           [2m                [0m
[2;36m                    [0m         [39msanitization exists in the codebase and why it failed to prevent this traversal[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **[0m[1;35mPOIFSDump.main[0m[1;39m([0m[1;39m)[0m[39m method** [0m[1;39m([0m[39mline [0m[1;36m80[0m[1;39m)[0m[39m: Review how the dump operation is [0m         [2m                [0m
[2;36m                    [0m         [39minitiated and configured[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **POIFS file structure parsing**: Examine how the application reads and [0m         [2m                [0m
[2;36m                    [0m         [39minterprets directory/entry names from the input file format, as malicious entry [0m    [2m                [0m
[2;36m                    [0m         [39mnames appear to be the attack vector[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **File creation/write operations**: Identify where actual file system operations[0m [2m                [0m
[2;36m                    [0m         [39moccur that utilize the unsanitized paths[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3351137567717686082/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39mEntry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:108[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:80[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIPOIFSDumpFuzzer.jav[0m[1;92ma:74[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: ac6e69a60acc10da[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:1[0m[39m-[0m[1;36m26[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.poi.poifs.dev;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:99[0m[39m-[0m[1;36m122[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mentry instanceof DocumentNode[0m[1;39m)[0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                final DocumentNode node = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                final byte[0m[1;39m[[0m[1;39m][0m[39m bytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                   bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mdir, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Skipping unsupported POIFS entry: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mentry[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/test/java/org/apache/poi/poifs/crypt/tests/TestEncryptor.jav[0m[1;92ma:416[0m[39m-[0m[1;36m427[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:    private void [0m[1;35mlistEntry[0m[1;39m([0m[39mDocumentNode de, String ext, String path[0m[1;39m)[0m[39m throws [0m    [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:        path += [0m[32m"\\" + de.getName[0m[32m([0m[32m)[0m[32m.replaceAll[0m[32m([0m[32m"[0m[1;39m[[0m[39m\\p[0m[1;39m{[0m[39mCntrl[0m[1;39m}[0m[1;39m][0m[32m", "[0m[39m_"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:        [0m[1;35mSystem.out.println[0m[1;39m([0m[39mext+[0m[32m": "[0m[39m+path+[0m[32m" [0m[32m([0m[32m"[0m[39m+[0m[1;35mde.getSize[0m[1;39m([0m[1;39m)[0m[39m+[0m[32m" bytes[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        String name = [0m[1;35mde.getName[0m[1;39m([0m[1;39m)[0m[1;35m.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m\\p[0m[32m{[0m[32mCntrl[0m[32m}[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:        InputStream is = [0m                                                       [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39mDirectoryNode[0m[1;39m)[0m[1;35mde.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.createDocumentInputStream[0m[1;39m([0m[39mde[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:        FileOutputStream fos = new [0m[1;35mFileOutputStream[0m[1;39m([0m[32m"solr."[0m[39m+name+[0m[32m"."[0m[39m+ext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, fos[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:        [0m[1;35mfos.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:        [0m[1;35mis.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/Entry.jav[0m[1;92ma:1[0m[39m-[0m[1;36m95[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.poi.poifs.filesystem;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: * This interface provides access to an object managed by a Filesystem[0m           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: * instance. Entry objects are further divided into DocumentEntry and[0m            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: * DirectoryEntry instances.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public interface Entry[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     * get the name of the Entry[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * @return name[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     * is this a DirectoryEntry?[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * @return true if the Entry is a DirectoryEntry, else false[0m                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    public boolean [0m[1;35misDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * is this a DocumentEntry?[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * @return true if the Entry is a DocumentEntry, else false[0m                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public boolean [0m[1;35misDocumentEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * get this Entry's parent [0m[1;39m([0m[39mthe DirectoryEntry that owns this[0m                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * Entry[0m[1;39m)[0m[39m. All Entry objects, except the root Entry, has a parent.[0m           [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * @return this Entry's parent; null iff this is the root Entry[0m              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public DirectoryEntry [0m[1;35mgetParent[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * Delete this Entry. This operation should succeed, but there are[0m           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * special circumstances when it will not:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * If this Entry is the root of the Entry tree, it cannot be[0m                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * deleted, as there is no way to create another one.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * If this Entry is a directory, it cannot be deleted unless it is[0m           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * empty.[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @return true if the Entry was successfully deleted, else false[0m            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    public boolean [0m[1;35mdelete[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * Rename this Entry. This operation will fail if:[0m                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     * There is a sibling Entry [0m[1;39m([0m[39mi.e., an Entry whose parent is the[0m              [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * same as this Entry's parent[0m[1;39m)[0m[39m with the same name.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * This Entry is the root of the Entry tree. Its name is dictated[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     * by the Filesystem and many not be changed.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     * @param newName the new name for this Entry[0m                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * @return true if the operation succeeded, else false[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public boolean [0m[1;35mrenameTo[0m[1;39m([0m[39mfinal String newName[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m[1;39m}[0m[39m   [0m[35m/[0m[35m/[0m[39m end public interface Entry[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/xdgf/util/Util.jav[0m[1;92ma:34[0m[39m-[0m[1;36m36[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static String [0m[1;35msanitizeFilename[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/xdgf/util/Util.jav[0m[1;92ma:1[0m[39m-[0m[1;36m37[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.xdgf.util;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:public class Util [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:    public static int [0m[1;35mcountLines[0m[1;39m([0m[39mString str[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:        int lines = [0m[1;36m1[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        int pos = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        while [0m[1;39m([0m[1;39m([0m[39mpos = [0m[1;35mstr.indexOf[0m[1;39m([0m[32m'\n'[0m[39m, pos[0m[1;39m)[0m[39m + [0m[1;36m1[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:            lines++;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:        return lines;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[35m/[0m[39m this probably isn't [0m[1;36m100[0m[39m% correct, so don't use it in security-sensitive[0m   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[35m/[0m[35m/[0m[39m applications![0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[35m/[0m[39m from: [0m[4;94mhttp://www.rgagnon.com/javadetails/java-0662.html[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static String [0m[1;35msanitizeFilename[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/EntryNode.jav[0m[1;92ma:1[0m[39m-[0m[1;36m23[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.poi.poifs.filesystem;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.poi.poifs.property.Property;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/EntryNode.jav[0m[1;92ma:33[0m[39m-[0m[1;36m102[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:public abstract class EntryNode[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    implements Entry[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[35m/[0m[39m the DocumentProperty backing this object[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private Property      _property;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[35m/[0m[35m/[0m[39m this object's parent Entry[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private DirectoryNode _parent;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * create a DocumentNode. This method is not public by design; it[0m            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * is intended strictly for the internal use of extending classes[0m            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param property the Property for this Entry[0m                               [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param parent the parent of this entry[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    protected [0m[1;35mEntryNode[0m[1;39m([0m[39mfinal Property property, final DirectoryNode parent[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        _property = property;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        _parent   = parent;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * grant access to the property[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * @return the property backing this entry[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    protected Property [0m[1;35mgetProperty[0m[1;39m([0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        return _property;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * is this the root of the tree?[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @return true if so, else false[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    protected boolean [0m[1;35misRoot[0m[1;39m([0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[35m/[0m[35m/[0m[39m only the root Entry has no parent [0m[33m...[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        return [0m[1;39m([0m[39m_parent == null[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     * extensions use this method to verify internal rules regarding[0m             [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * deletion of the underlying store.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * @return true if it's ok to delete the underlying store, else[0m              [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     *         false[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    protected abstract boolean [0m[1;35misDeleteOK[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[35m/[0m[39m* ********** START implementation of Entry ********** *[0m[35m/[0m                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     * get the name of the Entry[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     * @return name[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        return [0m[1;35m_property.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:1[0m[39m-[0m[1;36m33[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.poifs.property;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.poi.hpsf.ClassID;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.poifs.common.POIFSConstants;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.poifs.dev.POIFSViewable;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.util.ByteField;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.util.IntegerField;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.util.LittleEndianConsts;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.util.ShortField;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:116[0m[39m-[0m[1;36m162[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:     * Constructor from byte data[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     * @param index index number[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     * @param array byte data[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     * @param offset offset into byte data[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    protected [0m[1;35mProperty[0m[1;39m([0m[39mint index, byte [0m[1;39m[[0m[1;39m][0m[39m array, int offset[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        _raw_data          = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39marray, offset, offset + [0m        [2m                [0m
[2;36m                    [0m         [39mPOIFSConstants.PROPERTY_SIZE[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        _name_size         = new [0m[1;35mShortField[0m[1;39m([0m[39m_name_size_offset, _raw_data[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        _property_type     = new [0m                                               [2m                [0m
[2;36m                    [0m         [1;35mByteField[0m[1;39m([0m[39mPropertyConstants.PROPERTY_TYPE_OFFSET, _raw_data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        _node_color        = new [0m[1;35mByteField[0m[1;39m([0m[39m_node_color_offset, _raw_data[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        _previous_property = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_previous_property_offset, [0m       [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        _next_property     = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_next_property_offset, [0m           [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        _child_property    = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_child_property_offset, [0m          [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        _storage_clsid     = new [0m[1;35mClassID[0m[1;39m([0m[39m_raw_data,_storage_clsid_offset[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        _user_flags        = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_user_flags_offset, [0m[1;36m0[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        _seconds_1         = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_seconds_1_offset, _raw_data[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        _days_1            = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_days_1_offset, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        _seconds_2         = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_seconds_2_offset, _raw_data[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        _days_2            = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_days_2_offset, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        _start_block       = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_start_block_offset, _raw_data[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        _size              = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_size_offset, _raw_data[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        _index             = index;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        int name_length = [0m[1;39m([0m[1;35m_name_size.get[0m[1;39m([0m[1;39m)[0m[39m [0m[35m/[0m[39m LittleEndianConsts.SHORT_SIZE[0m[1;39m)[0m[39m - [0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        if [0m[1;39m([0m[39mname_length < [0m[1;36m1[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            _name = [0m[32m""[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            char[0m[1;39m[[0m[1;39m][0m[39m char_array  = new char[0m[1;39m[[0m[39m name_length [0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            int    name_offset = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            for [0m[1;39m([0m[39mint j = [0m[1;36m0[0m[39m; j < name_length; j++[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                char_array[0m[1;39m[[0m[39m j [0m[1;39m][0m[39m = [0m[1;39m([0m[39m char [0m[1;39m)[0m[39m new [0m[1;35mShortField[0m[1;39m([0m[39mname_offset,[0m          [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                                                          _raw_data[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                name_offset     += LittleEndianConsts.SHORT_SIZE;[0m               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            _name = new [0m[1;35mString[0m[1;39m([0m[39mchar_array, [0m[1;36m0[0m[39m, name_length[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        _next_child     = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        _previous_child = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:232[0m[39m-[0m[1;36m286[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:     * Get the name of this property[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:     * @return property name as String[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:        return _name;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:     * @return true if a directory type Property[0m                                [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    abstract public boolean [0m[1;35misDirectory[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:     * Sets the storage clsid, which is the Class ID of a COM object which[0m      [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:     *   reads and writes this stream[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:     * @return storage Class ID for this property stream[0m                        [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    public ClassID [0m[1;35mgetStorageClsid[0m[1;39m([0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:        return _storage_clsid;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:     * Set the name; silently truncates the name if it's too long.[0m              [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:     * @param name the new name[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    protected void [0m[1;35msetName[0m[1;39m([0m[39mString name[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        char[0m[1;39m[[0m[1;39m][0m[39m char_array = [0m[1;35mname.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        int    limit      = [0m[1;35mMath.min[0m[1;39m([0m[39mchar_array.length, _max_name_length[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:        _name = new [0m[1;35mString[0m[1;39m([0m[39mchar_array, [0m[1;36m0[0m[39m, limit[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:        short offset = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:        int   j      = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        for [0m[1;39m([0m[39m; j < limit; j++[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:            new [0m[1;35mShortField[0m[1;39m([0m[39moffset, [0m[1;39m([0m[39m short [0m[1;39m)[0m[39m char_array[0m[1;39m[[0m[39m j [0m[1;39m][0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            offset += [0m[1;39m([0m[39mshort[0m[1;39m)[0m[39m LittleEndianConsts.SHORT_SIZE;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:        for [0m[1;39m([0m[39m; j < _max_name_length + [0m[1;36m1[0m[39m; j++[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:            new [0m[1;35mShortField[0m[1;39m([0m[39moffset, [0m[1;39m([0m[39m short [0m[1;39m)[0m[39m [0m[1;36m0[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:            offset += [0m[1;39m([0m[39mshort[0m[1;39m)[0m[39m LittleEndianConsts.SHORT_SIZE;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        [0m[35m/[0m[35m/[0m[39m double the count, and include the null at the end[0m                    [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        _name_size[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:            [0m[1;35m.set[0m[1;39m([0m[1;39m([0m[39m short [0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mlimit + [0m[1;36m1[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:                            * LittleEndianConsts.SHORT_SIZE[0m[1;39m)[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/test/java/org/apache/poi/POIDataSamples.jav[0m[1;92ma:172[0m[39m-[0m[1;36m224[0m                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35msampleFileName.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:               String fn = sampleFileName;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:               [0m[1;35mif[0m[1;39m([0m[1;35mfn.indexOf[0m[1;39m([0m[32m'/'[0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                  fn = [0m[1;35mfn.substring[0m[1;39m([0m[1;35mfn.indexOf[0m[1;39m([0m[32m'/'[0m[1;39m)[0m[39m+[0m[1;36m1[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:               [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfn.equals[0m[1;39m([0m[1;35mf.getCanonicalFile[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:                   throw new [0m[1;35mIllegalStateException[0m[1;39m([0m[32m"File name is [0m               [2m                [0m
[2;36m                    [0m         [32mcase-sensitive: requested '"[0m[39m + fn[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:                        + [0m[32m"' but actual file is '"[0m[39m + [0m                           [2m                [0m
[2;36m                    [0m         [1;35mf.getCanonicalFile[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"'"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:            throw new [0m[1;35mIllegalStateException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        return f;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    private void [0m[1;35minitialise[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:        String dataDirName = [0m[1;35mSystem.getProperty[0m[1;39m([0m[39mTEST_PROPERTY[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        if [0m[1;39m([0m[39mdataDirName == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            [0m[35m/[0m[35m/[0m[39m check to see if we can just get the resources from the classpath[0m [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            InputStream is = [0m[1;35mopenClasspathResource[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            if [0m[1;39m([0m[39mis != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                try [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                    [0m[1;35mis.close[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m be nice[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                    throw new [0m[1;35mRuntimeException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:                _sampleDataIsAvaliableOnClassPath = true;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                return;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            if [0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[32m"test-data"[0m[1;39m)[0m[1;35m.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                dataDirName = [0m[32m"test-data"[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[32m"../test-data"[0m[1;39m)[0m[1;35m.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:               dataDirName = [0m[32m"../test-data"[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:               throw new [0m[1;35mRuntimeException[0m[1;39m([0m[32m"Must set system property '"[0m[39m +[0m        [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                       TEST_PROPERTY + [0m[32m"' before running tests"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:        File dataDir = new [0m[1;35mFile[0m[1;39m([0m[39mdataDirName, _moduleDir[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mdataDir.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            throw new [0m[1;35mRuntimeException[0m[1;39m([0m[32m"Data dir '"[0m[39m + dataDir + [0m[32m"' does not [0m    [2m                [0m
[2;36m                    [0m         [32mexist"[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        [0m[35m/[0m[35m/[0m[39m convert to canonical file, to make any subsequent error messages[0m     [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        [0m[35m/[0m[35m/[0m[39m clearer.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            _resolvedDataDir = [0m[1;35mdataDir.getCanonicalFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:            throw new [0m[1;35mRuntimeException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSLister.jav[0m[1;92ma:1[0m[39m-[0m[1;36m31[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.poifs.dev;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.poifs.filesystem.DirectoryNode;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.poifs.filesystem.DocumentNode;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.poifs.filesystem.Entry;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.poifs.filesystem.POIFSFileSystem;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSLister.jav[0m[1;92ma:79[0m[39m-[0m[1;36m107[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:   public static void [0m[1;35mdisplayDirectory[0m[1;39m([0m[39mDirectoryNode dir, String indent, boolean[0m [2m                [0m
[2;36m                    [0m         [39mwithSizes[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      [0m[1;35mSystem.out.println[0m[1;39m([0m[39mindent + [0m[1;35mdir.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" -"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      String newIndent = indent + [0m[32m"  "[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:      boolean hadChildren = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:      [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mdir.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:         hadChildren = true;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:         Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:         if [0m[1;39m([0m[39mentry instanceof DirectoryNode[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            [0m[1;35mdisplayDirectory[0m[1;39m([0m[1;39m([0m[39mDirectoryNode[0m[1;39m)[0m[39m entry, newIndent, withSizes[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:         [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            DocumentNode doc = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            String name = [0m[1;35mdoc.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            String size = [0m[32m""[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            if [0m[1;39m([0m[1;35mname.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m < [0m[1;36m10[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:               String altname = [0m[32m"[0m[32m([0m[32m0x0"[0m[39m + [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m [0m[1;35mname.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m + [0m[32m"[0m[32m)[0m[32m"[0m[39m + [0m           [2m                [0m
[2;36m                    [0m         [1;35mname.substring[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:               name = [0m[1;35mname.substring[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m + [0m[32m" <"[0m[39m + altname + [0m[32m">"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            if [0m[1;39m([0m[39mwithSizes[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:               size = [0m[32m" [0m[32m[[0m[32m"[0m[39m + [0m[1;35mdoc.getSize[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" / 0x"[0m[39m +[0m                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                      [0m[1;35mInteger.toHexString[0m[1;39m([0m[1;35mdoc.getSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m + [0m[32m"[0m[32m][0m[32m"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;35mSystem.out.println[0m[1;39m([0m[39mnewIndent + name + size[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:         [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:      if [0m[1;39m([0m[39m!hadChildren[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:         [0m[1;35mSystem.out.println[0m[1;39m([0m[39mnewIndent + [0m[32m"[0m[32m([0m[32mno children[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/EntryUtils.jav[0m[1;92ma:33[0m[39m-[0m[1;36m58[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:@Internal[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:public final class EntryUtils [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    private [0m[1;35mEntryUtils[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * Copies an Entry into a target POIFS directory, recursively[0m                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Internal[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public static void [0m[1;35mcopyNodeRecursively[0m[1;39m([0m[39m Entry entry, DirectoryEntry target [0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    throws IOException [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        if [0m[1;39m([0m[39m [0m[1;35mentry.isDirectoryEntry[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            DirectoryEntry dirEntry = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:            DirectoryEntry newTarget = [0m[1;35mtarget.createDirectory[0m[1;39m([0m[39m [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:            [0m[1;35mnewTarget.setStorageClsid[0m[1;39m([0m[39m [0m[1;35mdirEntry.getStorageClsid[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:            Iterator<Entry> entries = [0m[1;35mdirEntry.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            while [0m[1;39m([0m[39m [0m[1;35mentries.hasNext[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                [0m[1;35mcopyNodeRecursively[0m[1;39m([0m[39m [0m[1;35mentries.next[0m[1;39m([0m[1;39m)[0m[39m, newTarget [0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            DocumentEntry dentry = [0m[1;39m([0m[39mDocumentEntry[0m[1;39m)[0m[39m entry;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            DocumentInputStream dstream = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39m dentry [0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            [0m[1;35mtarget.createDocument[0m[1;39m([0m[39m [0m[1;35mdentry.getName[0m[1;39m([0m[1;39m)[0m[39m, dstream [0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:            [0m[1;35mdstream.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:1[0m[39m-[0m[1;36m100[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.util;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.PushbackInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.channels.ReadableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.zip.CRC32;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.zip.Checksum;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.commons.io.input.BoundedInputStream;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.commons.io.output.UnsynchronizedByteArrayOutputStream;[0m         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.poi.logging.PoiLogManager;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.poi.EmptyFileException;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:@Internal[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:public final class IOUtils [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private static final Logger LOG = [0m[1;35mPoiLogManager.getLogger[0m[1;39m([0m[39mIOUtils.class[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * The default buffer size to use for the [0m[1;35mskip[0m[1;39m([0m[1;39m)[0m[39m methods.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    private static final int SKIP_BUFFER_SIZE = [0m[1;36m2048[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * The current set global allocation limit override,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * [0m[1;36m-1[0m[39m means limits are applied per record type.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private static int BYTE_ARRAY_MAX_OVERRIDE = [0m[1;36m-1[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * The max init size of ByteArrayOutputStream.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * [0m[1;36m-1[0m[39m means init size of ByteArrayOutputStream could be up to [0m               [2m                [0m
[2;36m                    [0m         [39mInteger.MAX_VALUE[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private static int MAX_BYTE_ARRAY_INIT_SIZE = [0m[1;36m-1[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * The default size of the bytearray used while reading input streams. This [0m [2m                [0m
[2;36m                    [0m         [39mis meant to be pretty small.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private static final int DEFAULT_BUFFER_SIZE = [0m[1;36m4096[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private [0m[1;35mIOUtils[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[35m/[0m[35m/[0m[39m no instances of this class[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * @param maxOverride the max init size of ByteArrayOutputStream.[0m            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * [0m[1;36m-1[0m[39m [0m[1;39m([0m[39mthe default[0m[1;39m)[0m[39m means init size of ByteArrayOutputStream could be up to [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m[39m@link Integer#MAX_VALUE[0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @since POI [0m[1;36m5.2[0m[39m.[0m[1;36m2[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    public static void [0m[1;35msetMaxByteArrayInitSize[0m[1;39m([0m[39mfinal int maxOverride[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        MAX_BYTE_ARRAY_INIT_SIZE = maxOverride;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     * @return the max init size of ByteArrayOutputStream.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     * [0m[1;36m-1[0m[39m [0m[1;39m([0m[39mthe default[0m[1;39m)[0m[39m means init size of ByteArrayOutputStream could be up to [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m[39m@link Integer#MAX_VALUE[0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * @since POI [0m[1;36m5.2[0m[39m.[0m[1;36m2[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    public static int [0m[1;35mgetMaxByteArrayInitSize[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        return MAX_BYTE_ARRAY_INIT_SIZE;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * If this value is set to &gt; [0m[1;36m0[0m[39m, [0m[1;39m{[0m[39m@link #[0m[1;35msafelyAllocate[0m[1;39m([0m[39mlong, int[0m[1;39m)[0m[1;39m}[0m[39m will [0m  [2m                [0m
[2;36m                    [0m         [39mignore the[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * maximum record length parameter.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     * This is designed to allow users to bypass the hard-coded maximum record [0m  [2m                [0m
[2;36m                    [0m         [39mlengths[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     * if they are willing to accept the risk of allocating memory up to the [0m    [2m                [0m
[2;36m                    [0m         [39msize specified.[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     * It also allows to impose a lower limit than used for very memory [0m         [2m                [0m
[2;36m                    [0m         [39mconstrained systems.[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     * Note: This is a per-allocation limit and does not allow you to limit the [0m [2m                [0m
[2;36m                    [0m         [39moverall sum of allocations![0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * Use [0m[1;36m-1[0m[39m for using the limits specified per record-type.[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:46[0m[39m-[0m[1;36m80[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public static void [0m[1;35mmain[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m args[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        if [0m[1;39m([0m[39margs.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Must specify at least one file to dump"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        boolean dumpProps = false, dumpMini = false;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        for [0m[1;39m([0m[39mString filename : args[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            if [0m[1;39m([0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dumprops"[0m[1;39m)[0m[39m ||[0m                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-props"[0m[1;39m)[0m[39m ||[0m                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-properties"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:                dumpProps = true;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:                continue;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            if [0m[1;39m([0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dumpmini"[0m[1;39m)[0m[39m ||[0m                        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-mini"[0m[1;39m)[0m[39m ||[0m                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-ministream"[0m[1;39m)[0m[39m ||[0m             [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-mini-stream"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:                dumpMini = true;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                continue;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                 POIFSFileSystem fs = new [0m[1;35mPOIFSFileSystem[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                DirectoryEntry root = [0m[1;35mfs.getRoot[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                String filenameWithoutPath = new [0m[1;35mFile[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                File dumpDir =[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                        [0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                                [0m[1;35m.resolve[0m[1;39m([0m[39mfilenameWithoutPath + [0m                  [2m                [0m
[2;36m                    [0m         [32m"_dump"[0m[1;39m)[0m[1;35m.toFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + file[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mroot, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:123[0m[39m-[0m[1;36m139[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mPOIFSFileSystem fs, int startBlock, String name, [0m   [2m                [0m
[2;36m                    [0m         [39mFile parent[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, name[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[1;35mfile.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            POIFSStream stream = new [0m[1;35mPOIFSStream[0m[1;39m([0m[39mfs, startBlock[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m b = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[1;35mfs.getBigBlockSize[0m[1;39m([0m[1;39m)[0m[39m, [0m            [2m                [0m
[2;36m                    [0m         [1;35mPOIFSFileSystem.getMaxRecordLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            for [0m[1;39m([0m[39mByteBuffer bb : stream[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                int len = [0m[1;35mbb.remaining[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                [0m[1;35mbb.get[0m[1;39m([0m[39mb[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                [0m[1;35mout.write[0m[1;39m([0m[39mb, [0m[1;36m0[0m[39m, len[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/xdgf/util/Util.jav[0m[1;92ma:31[0m[39m-[0m[1;36m36[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[35m/[0m[39m this probably isn't [0m[1;36m100[0m[39m% correct, so don't use it in security-sensitive[0m   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[35m/[0m[35m/[0m[39m applications![0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[35m/[0m[39m from: [0m[4;94mhttp://www.rgagnon.com/javadetails/java-0662.html[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static String [0m[1;35msanitizeFilename[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:123[0m[39m-[0m[1;36m162[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    protected [0m[1;35mProperty[0m[1;39m([0m[39mint index, byte [0m[1;39m[[0m[1;39m][0m[39m array, int offset[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        _raw_data          = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39marray, offset, offset + [0m        [2m                [0m
[2;36m                    [0m         [39mPOIFSConstants.PROPERTY_SIZE[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        _name_size         = new [0m[1;35mShortField[0m[1;39m([0m[39m_name_size_offset, _raw_data[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        _property_type     = new [0m                                               [2m                [0m
[2;36m                    [0m         [1;35mByteField[0m[1;39m([0m[39mPropertyConstants.PROPERTY_TYPE_OFFSET, _raw_data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        _node_color        = new [0m[1;35mByteField[0m[1;39m([0m[39m_node_color_offset, _raw_data[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        _previous_property = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_previous_property_offset, [0m       [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        _next_property     = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_next_property_offset, [0m           [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        _child_property    = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_child_property_offset, [0m          [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        _storage_clsid     = new [0m[1;35mClassID[0m[1;39m([0m[39m_raw_data,_storage_clsid_offset[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        _user_flags        = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_user_flags_offset, [0m[1;36m0[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        _seconds_1         = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_seconds_1_offset, _raw_data[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        _days_1            = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_days_1_offset, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        _seconds_2         = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_seconds_2_offset, _raw_data[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        _days_2            = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_days_2_offset, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        _start_block       = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_start_block_offset, _raw_data[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        _size              = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_size_offset, _raw_data[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        _index             = index;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        int name_length = [0m[1;39m([0m[1;35m_name_size.get[0m[1;39m([0m[1;39m)[0m[39m [0m[35m/[0m[39m LittleEndianConsts.SHORT_SIZE[0m[1;39m)[0m[39m - [0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        if [0m[1;39m([0m[39mname_length < [0m[1;36m1[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            _name = [0m[32m""[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            char[0m[1;39m[[0m[1;39m][0m[39m char_array  = new char[0m[1;39m[[0m[39m name_length [0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            int    name_offset = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            for [0m[1;39m([0m[39mint j = [0m[1;36m0[0m[39m; j < name_length; j++[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                char_array[0m[1;39m[[0m[39m j [0m[1;39m][0m[39m = [0m[1;39m([0m[39m char [0m[1;39m)[0m[39m new [0m[1;35mShortField[0m[1;39m([0m[39mname_offset,[0m          [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                                                          _raw_data[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                name_offset     += LittleEndianConsts.SHORT_SIZE;[0m               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            _name = new [0m[1;35mString[0m[1;39m([0m[39mchar_array, [0m[1;36m0[0m[39m, name_length[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        _next_child     = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        _previous_child = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:237[0m[39m-[0m[1;36m240[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:        return _name;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:262[0m[39m-[0m[1;36m286[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    protected void [0m[1;35msetName[0m[1;39m([0m[39mString name[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        char[0m[1;39m[[0m[1;39m][0m[39m char_array = [0m[1;35mname.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        int    limit      = [0m[1;35mMath.min[0m[1;39m([0m[39mchar_array.length, _max_name_length[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:        _name = new [0m[1;35mString[0m[1;39m([0m[39mchar_array, [0m[1;36m0[0m[39m, limit[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:        short offset = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:        int   j      = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        for [0m[1;39m([0m[39m; j < limit; j++[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:            new [0m[1;35mShortField[0m[1;39m([0m[39moffset, [0m[1;39m([0m[39m short [0m[1;39m)[0m[39m char_array[0m[1;39m[[0m[39m j [0m[1;39m][0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            offset += [0m[1;39m([0m[39mshort[0m[1;39m)[0m[39m LittleEndianConsts.SHORT_SIZE;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:        for [0m[1;39m([0m[39m; j < _max_name_length + [0m[1;36m1[0m[39m; j++[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:            new [0m[1;35mShortField[0m[1;39m([0m[39moffset, [0m[1;39m([0m[39m short [0m[1;39m)[0m[39m [0m[1;36m0[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:            offset += [0m[1;39m([0m[39mshort[0m[1;39m)[0m[39m LittleEndianConsts.SHORT_SIZE;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        [0m[35m/[0m[35m/[0m[39m double the count, and include the null at the end[0m                    [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        _name_size[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:            [0m[1;35m.set[0m[1;39m([0m[1;39m([0m[39m short [0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mlimit + [0m[1;36m1[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:                            * LittleEndianConsts.SHORT_SIZE[0m[1;39m)[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/EntryNode.jav[0m[1;92ma:99[0m[39m-[0m[1;36m102[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        return [0m[1;35m_property.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:99[0m[39m-[0m[1;36m122[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mentry instanceof DocumentNode[0m[1;39m)[0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                final DocumentNode node = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                final byte[0m[1;39m[[0m[1;39m][0m[39m bytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                   bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mdir, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Skipping unsupported POIFS entry: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mentry[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Root Cause Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability occurs in `[0m[1;35mPOIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m99[0m[39m-[0m[1;36m122[0m[1;39m)[0m[39m where entry [0m   [2m                [0m
[2;36m                    [0m         [39mnames from POIFS file structures are used directly in file path construction [0m       [2m                [0m
[2;36m                    [0m         [39mwithout sanitization. The attack chain is:[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Malicious POIFS file contains entries with names like [0m                           [2m                [0m
[2;36m                    [0m         [39m`..[0m[35m/../../../[0m[95mjazzer-traversal[0m[39m`[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. `Property` class reads these names from file bytes without validation[0m            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `[0m[1;35mEntry.getName[0m[1;39m([0m[1;39m)[0m[39m` returns unsanitized names[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. `[0m[1;35mPOIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m` uses these names in `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m` at [0m   [2m                [0m
[2;36m                    [0m         [39mlines [0m[1;36m108[0m[39m and [0m[1;36m113[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Java's `File` constructor concatenates paths without preventing traversal, [0m      [2m                [0m
[2;36m                    [0m         [39mallowing escape from the intended directory[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Fix Implementation Strategy[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Primary Fix Location:** [0m                                                          [2m                [0m
[2;36m                    [0m         [39m`poi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.java`[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m1[0m[39m: Create a Path Sanitization Method[0m                                      [2m                [0m
[2;36m                    [0m         [39mAdd a private static helper method to `POIFSDump` class that sanitizes entry names [0m [2m                [0m
[2;36m                    [0m         [39mbefore using them in file operations:[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate static String [0m[1;35msanitizeEntryName[0m[1;39m([0m[39mString name[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Sanitization Logic:**[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Handle null/empty input → return a safe default name [0m[1;39m([0m[39me.g., [0m[32m"unnamed"[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Replace all `..` sequences with underscores to prevent parent directory [0m         [2m                [0m
[2;36m                    [0m         [39mtraversal[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Remove ALL path separator characters [0m[1;39m([0m[39m`[0m[35m/[0m[39m`, `\`, and platform-specific [0m           [2m                [0m
[2;36m                    [0m         [39mseparators[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Replace other problematic filesystem characters [0m[1;39m([0m[39m`:`, `*`, `?`, `"`, `<`, `>`, [0m  [2m                [0m
[2;36m                    [0m         [39m`|`[0m[1;39m)[0m[39m with underscores[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Trim leading/trailing whitespace and dots[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Handle control characters by replacing with underscores[0m                          [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. Validate result is not empty or consists only of dots/spaces → use fallback name[0m [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m. Ensure result doesn't become a reserved filename on Windows [0m[1;39m([0m[39mCON, PRN, AUX, [0m     [2m                [0m
[2;36m                    [0m         [39metc.[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation Requirements:**[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Use multiple regex replacements or character-by-character filtering[0m               [2m                [0m
[2;36m                    [0m         [39m- Pattern [0m[1;36m1[0m[39m: Replace `\.\.+` [0m[1;39m([0m[39mtwo or more consecutive dots[0m[1;39m)[0m[39m with single underscore[0m  [2m                [0m
[2;36m                    [0m         [39m- Pattern [0m[1;36m2[0m[39m: Replace `[0m[1;39m[[0m[35m/[0m[39m\\:*?"<>|[0m[1;39m][0m[39m` with underscores[0m                                [2m                [0m
[2;36m                    [0m         [39m- Pattern [0m[1;36m3[0m[39m: Strip control characters `[0m[1;39m[[0m[39m\p[0m[1;39m{[0m[39mCntrl[0m[1;39m}[0m[1;39m][0m[39m`[0m                                 [2m                [0m
[2;36m                    [0m         [39m- Trim and validate final result[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Maximum length check [0m[1;39m([0m[39moptional, but good practice for filesystem compatibility[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m2[0m[39m: Apply Sanitization at File Creation Points[0m                             [2m                [0m
[2;36m                    [0m         [39mModify the `[0m[1;35mdump[0m[1;39m([0m[1;39m)[0m[39m` method at two critical locations:[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location [0m[1;36m1[0m[39m [0m[1;39m([0m[39mLine [0m[1;36m108[0m[39m - Document nodes[0m[1;39m)[0m[39m:**[0m                                         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Current vulnerable code:[0m                                                         [2m                [0m
[2;36m                    [0m         [39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Fixed code:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location [0m[1;36m2[0m[39m [0m[1;39m([0m[39mLine [0m[1;36m113[0m[39m - Directory entries[0m[1;39m)[0m[39m:**[0m                                      [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Current vulnerable code:[0m                                                         [2m                [0m
[2;36m                    [0m         [39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Fixed code:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Also fix line [0m[1;36m75[0m[39m in [0m[1;35mmain[0m[1;39m([0m[1;39m)[0m[39m method** where root entry name is used:[0m                [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Current code:[0m                                                                    [2m                [0m
[2;36m                    [0m         [39mFile file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Fixed code:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mFile file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m3[0m[39m: Preserve Existing Functionality[0m                                        [2m                [0m
[2;36m                    [0m         [39m- The `[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[39m` operation on line [0m[1;36m108[0m[39m can be removed since sanitization includes [0m   [2m                [0m
[2;36m                    [0m         [39mtrimming[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- Maintain the recursive directory creation logic [0m[1;39m([0m[39mlines [0m[1;36m114[0m[39m-[0m[1;36m116[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m- Preserve error handling for directory creation failures[0m                           [2m                [0m
[2;36m                    [0m         [39m- Keep the iteration and entry type checking logic unchanged[0m                        [2m                [0m
[2;36m                    [0m         [39m- Ensure legitimate file names remain readable and valid[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Justification[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why This Approach is Optimal:**[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Minimal Code Impact:** Changes are localized to POIFSDump.java only, avoiding [0m [2m                [0m
[2;36m                    [0m         [39mmodifications to core POIFS classes [0m[1;39m([0m[39mProperty, Entry, EntryNode[0m[1;39m)[0m[39m which are used [0m    [2m                [0m
[2;36m                    [0m         [39mthroughout the codebase for legitimate purposes[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Defense in Depth:** Sanitization occurs at the point of use [0m[1;39m([0m[39mfile system [0m      [2m                [0m
[2;36m                    [0m         [39moperations[0m[1;39m)[0m[39m rather than at data parsing, which:[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Doesn't affect POIFS reading/writing functionality[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Doesn't break existing code that uses entry names for display or internal [0m     [2m                [0m
[2;36m                    [0m         [39moperations[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - Follows the principle of sanitizing at the trust boundary [0m[1;39m([0m[39mPOIFS → filesystem[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves Core Logic:** The Property and Entry classes correctly represent [0m    [2m                [0m
[2;36m                    [0m         [39mPOIFS file structure data; sanitization should occur only when transitioning to OS [0m [2m                [0m
[2;36m                    [0m         [39mfilesystem operations[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **No Side Effects:** [0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - Other code using [0m[1;35mEntry.getName[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39mlike POIFSLister for display[0m[1;39m)[0m[39m remains [0m       [2m                [0m
[2;36m                    [0m         [39munaffected[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - EntryUtils copying within POIFS structures continues to work[0m                   [2m                [0m
[2;36m                    [0m         [39m   - Test code is not impacted[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Security Best Practices:**[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - Whitelist approach for allowed characters would be ideal but may break [0m        [2m                [0m
[2;36m                    [0m         [39mlegitimate international filenames[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - Blacklist approach targeting specific attack patterns [0m[1;39m([0m[39m`.., [0m[35m/[0m[39m, \`[0m[1;39m)[0m[39m is more [0m    [2m                [0m
[2;36m                    [0m         [39mpractical[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - Multiple layers of sanitization provide defense against bypass attempts[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why Not Modify Property/Entry Classes:**[0m                                          [2m                [0m
[2;36m                    [0m         [39m- These classes represent the POIFS file format specification faithfully[0m            [2m                [0m
[2;36m                    [0m         [39m- Modifying them would affect all consumers of the API[0m                              [2m                [0m
[2;36m                    [0m         [39m- Entry names might legitimately need to preserve certain characters for round-trip[0m [2m                [0m
[2;36m                    [0m         [39mfidelity[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- The security issue is specific to file extraction, not file format representation[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why Not Use Existing [0m[1;35mUtil.sanitizeFilename[0m[1;39m([0m[1;39m)[0m[39m:**[0m                                   [2m                [0m
[2;36m                    [0m         [39m- The existing method explicitly warns against security-sensitive use [0m[1;39m([0m[39mline [0m[1;36m31[0m[39m-[0m[1;36m32[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mcomment[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- It doesn't handle `..` sequences adequately[0m                                       [2m                [0m
[2;36m                    [0m         [39m- It's in poi-ooxml module [0m[1;39m([0m[39mxdgf.util[0m[1;39m)[0m[39m, not appropriate to create dependency from [0m  [2m                [0m
[2;36m                    [0m         [39mpoi module[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- A purpose-built method provides better security and control[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Potential Side Effects and Mitigation[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m1[0m[39m: Filename Collisions**[0m                                              [2m                [0m
[2;36m                    [0m         [39m- **Risk:** Multiple entries with names differing only in path traversal sequences [0m [2m                [0m
[2;36m                    [0m         [39mmight sanitize to same name[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- **Mitigation:** This is acceptable; the alternative [0m[1;39m([0m[39mallowing path traversal[0m[1;39m)[0m[39m is [0m [2m                [0m
[2;36m                    [0m         [39ma critical security vulnerability[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- **Impact:** Rarely occurs with legitimate files; malicious files are expected to [0m [2m                [0m
[2;36m                    [0m         [39mfail gracefully[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m2[0m[39m: Loss of Original Filename Information**[0m                            [2m                [0m
[2;36m                    [0m         [39m- **Risk:** Sanitized names might be less descriptive than originals[0m                [2m                [0m
[2;36m                    [0m         [39m- **Mitigation:** Document extraction is a development/debugging tool, not [0m         [2m                [0m
[2;36m                    [0m         [39mproduction functionality[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- **Impact:** Minimal; the data content is preserved, only unsafe names are [0m        [2m                [0m
[2;36m                    [0m         [39mmodified[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m3[0m[39m: Empty or Invalid Results**[0m                                         [2m                [0m
[2;36m                    [0m         [39m- **Risk:** Heavily sanitized name might become empty or consist only of [0m           [2m                [0m
[2;36m                    [0m         [39munderscores[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m- **Mitigation:** Fallback to [0m[32m"unnamed_entry"[0m[39m or [0m[32m"entry_<index>"[0m[39m ensures valid [0m     [2m                [0m
[2;36m                    [0m         [39mfilename[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- **Impact:** [0m[3;35mNone[0m[39m; ensures robust operation even with pathological inputs[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Implementation Details[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Recommended Sanitization Algorithm:**[0m                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate static String [0m[1;35msanitizeEntryName[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mname == null || [0m[1;35mname.trim[0m[1;39m([0m[1;39m)[0m[1;35m.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m        return [0m[32m"unnamed_entry"[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Step [0m[1;36m1[0m[39m: Replace consecutive dots [0m[1;39m([0m[39m.. sequences[0m[1;39m)[0m[39m to prevent traversal[0m         [2m                [0m
[2;36m                    [0m         [39m    String sanitized = [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"\\.[0m[32m{[0m[32m2,[0m[32m}[0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Step [0m[1;36m2[0m[39m: Remove all path separators[0m                                           [2m                [0m
[2;36m                    [0m         [39m    sanitized = [0m[1;35msanitized.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m/\\\\[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Step [0m[1;36m3[0m[39m: Replace filesystem-illegal characters[0m                                [2m                [0m
[2;36m                    [0m         [39m    sanitized = [0m[1;35msanitized.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\*\\?\"<>|[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Step [0m[1;36m4[0m[39m: Remove control characters[0m                                            [2m                [0m
[2;36m                    [0m         [39m    sanitized = [0m[1;35msanitized.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m\\p[0m[32m{[0m[32mCntrl[0m[32m}[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Step [0m[1;36m5[0m[39m: Trim whitespace and dots from edges[0m                                  [2m                [0m
[2;36m                    [0m         [39m    sanitized = [0m[1;35msanitized.replaceAll[0m[1;39m([0m[32m"^[0m[32m[[0m[32m.\\s[0m[32m][0m[32m+|[0m[32m[[0m[32m.\\s[0m[32m][0m[32m+$"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Step [0m[1;36m6[0m[39m: Collapse multiple underscores[0m                                        [2m                [0m
[2;36m                    [0m         [39m    sanitized = [0m[1;35msanitized.replaceAll[0m[1;39m([0m[32m"_[0m[32m{[0m[32m2,[0m[32m}[0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Step [0m[1;36m7[0m[39m: Ensure non-empty result[0m                                              [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35msanitized.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        return [0m[32m"unnamed_entry"[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Step [0m[1;36m8[0m[39m: Check for Windows reserved names [0m[1;39m([0m[39moptional but recommended[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m    String upper = [0m[1;35msanitized.toUpperCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mupper.matches[0m[1;39m([0m[32m"^[0m[32m([0m[32mCON|PRN|AUX|NUL|COM[0m[32m[[0m[32m1-9[0m[32m][0m[32m|LPT[0m[32m[[0m[32m1-9[0m[32m][0m[32m)[0m[32m$"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [39m        sanitized = [0m[32m"_"[0m[39m + sanitized;[0m                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    return sanitized;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Lines to Modify:**[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Add [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;39m)[0m[39m method after line [0m[1;36m98[0m[39m [0m[1;39m([0m[39mbefore [0m[1;35mdump[0m[1;39m([0m[1;39m)[0m[39m method[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Line [0m[1;36m75[0m[39m: Change `new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m` to `new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m       [2m                [0m
[2;36m                    [0m         [1;35msanitizeEntryName[0m[1;39m([0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m`[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Line [0m[1;36m108[0m[39m: Change `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m` to `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35msanitizeEntryName[0m[1;39m([0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m`[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Line [0m[1;36m113[0m[39m: Change `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m` to `new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m       [2m                [0m
[2;36m                    [0m         [1;35msanitizeEntryName[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m`[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m6[0m[39m. Testing Considerations[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix should be validated to ensure:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Path traversal sequences are neutralized[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Legitimate POIFS files extract correctly[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. International characters in filenames are handled appropriately[0m                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Edge cases [0m[1;39m([0m[39mempty names, all dots, all spaces[0m[1;39m)[0m[39m produce valid filenames[0m           [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Recursive directory creation still works[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. No regression in existing POI tests[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis approach provides comprehensive protection against path traversal while [0m       [2m                [0m
[2;36m                    [0m         [39mmaintaining backward compatibility and preserving the functionality of POIFSDump as[0m [2m                [0m
[2;36m                    [0m         [39ma development tool.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=20094;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=363900;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=440042;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=970606;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpw1ocrt22[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1767827726.2909877[0m                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-poi_poi-full-01_vuln_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/07/26 23:15:28][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mapache-poi[0m     ]8;id=470544;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=39045;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=379271;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=197684;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-poi[0m            [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=500413;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=554806;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-poi[0m             [2m               [0m
