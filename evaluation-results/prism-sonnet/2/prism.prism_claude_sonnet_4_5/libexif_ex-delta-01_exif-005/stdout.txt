[2;36m[01/08/26 04:53:44][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=900209;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=950164;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpjeov_but[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/libexif_ex-delta-01_exif-005/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1767848024.2807288[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/libexif_ex-delta-01_exif-[1;36m005.[0mtoml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-libexif[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Building Cached for CLEAN environment[1m)[0m           ]8;id=47664;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=485394;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/08/26 04:54:12][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Building Cached for CLEAN environment[1m)[0m Took     ]8;id=83931;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=708071;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m28.10[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=492806;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=840050;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running tests for Cached for CLEAN environment[1m)[0m ]8;id=546806;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=235198;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=612753;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=9987;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m28[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=411923;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=953287;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 04:54:13][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.89[0m seconds;               ]8;id=415221;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=670534;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=609547;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=507424;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=562006;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=961928;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=410191;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=83306;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=200052;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=391732;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 04:54:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.93[0m seconds;               ]8;id=121103;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=493112;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=327840;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=901575;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 04:54:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.81[0m seconds;               ]8;id=172777;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=764201;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/08/26 04:54:17][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=258692;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=347880;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer exif_from_data_fuzzer -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m [1m<[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m863523546[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2850[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x555a79c3d738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x555a79c3e25a[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2850[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x555a79c3e260[0m[39m,[0m[1;36m0x555a79c49480[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x515000000785[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x555a79b7afc0[0m[39m bp [0m[1;36m0x7ffe17df2b00[0m[39m sp [0m[1;36m0x7ffe17df2af8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x515000000785[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555a79b7afbf[0m[39m in exif_get_sshort [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555a79b7afbf[0m[39m in exif_get_short [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m104:10[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555a79b7d854[0m[39m in exif_mnote_data_apple_load [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m110:29[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555a79b60efe[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555a79b6036e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555a79b5d8af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x555a79a12330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555a799fd5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x555a79a0303f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x555a79a2e2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fd925e4c082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x555a799f578d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8078d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: exif_get_sshort--exif_get_short--exif_mnote_data_apple_load[0m            [2m                [0m
[2;36m                    [0m         [1;36m0x515000000785[0m[39m is located [0m[1;36m5[0m[39m bytes after [0m[1;36m512[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x515000000580[0m[39m,[0m[1;36m0x515000000780[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555a79b1e0ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555a79b9a8f3[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555a799fd5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555a79a0303f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555a79a2e2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7fd925e4c082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39min exif_get_sshort[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000580[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000600[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000680[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000700[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x515000000780[0m[39m:[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000800[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000880[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000900[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000980[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000a00[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpdz0ucir_[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m < [0m    [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m863523546[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2850[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x555a79c3d738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x555a79c3e25a[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2850[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x555a79c3e260[0m[39m,[0m[1;36m0x555a79c49480[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x515000000785[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x555a79b7afc0[0m[39m bp [0m[1;36m0x7ffe17df2b00[0m[39m sp [0m[1;36m0x7ffe17df2af8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x515000000785[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555a79b7afbf[0m[39m in exif_get_sshort [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555a79b7afbf[0m[39m in exif_get_short [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m104:10[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555a79b7d854[0m[39m in exif_mnote_data_apple_load [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m110:29[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555a79b60efe[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555a79b6036e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555a79b5d8af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x555a79a12330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555a799fd5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x555a79a0303f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x555a79a2e2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fd925e4c082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x555a799f578d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8078d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: exif_get_sshort--exif_get_short--exif_mnote_data_apple_load[0m            [2m                [0m
[2;36m                    [0m         [1;36m0x515000000785[0m[39m is located [0m[1;36m5[0m[39m bytes after [0m[1;36m512[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x515000000580[0m[39m,[0m[1;36m0x515000000780[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555a79b1e0ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555a79b9a8f3[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555a799fd5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555a79a0303f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555a79a2e2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7fd925e4c082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39min exif_get_sshort[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000580[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000600[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000680[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000700[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x515000000780[0m:[1m[[0mfa[1m][0mfa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x515000000800[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x515000000880[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x515000000900[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x515000000980[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x515000000a00[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m14[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpdz0ucir_[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         exif_from_data_fuzzer -[33mruns[0m=[1;36m100[0m.                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/08/26 04:54:38][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=904338;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=662695;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/08/26 04:58:33][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=102858;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=896632;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/08/26 05:00:30][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=415585;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=573481;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=770074;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=633457;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 05:00:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.91[0m seconds;               ]8;id=789736;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=926113;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Patching[1m)[0m Started[33m...[0m                             ]8;id=435420;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=839757;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpynufs7o5[0m                                                 ]8;id=90166;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=69435;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/08/26 05:00:57][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Patching[1m)[0m Took [1;36m25.27[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=845692;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=715641;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Checking build[1m)[0m Started[33m...[0m                       ]8;id=136706;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=404336;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 05:01:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Checking build[1m)[0m Took [1;36m3.75[0m seconds;              ]8;id=831434;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=385863;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running PoV[1m)[0m Started[33m...[0m                          ]8;id=855646;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=836797;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 05:01:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running PoV[1m)[0m Took [1;36m1.81[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=380960;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=707209;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Testing[1m)[0m Started[33m...[0m                              ]8;id=307653;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=742901;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=670096;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=423292;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=161275;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=89200;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 05:01:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.84[0m seconds;               ]8;id=795247;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=478776;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/08/26 05:01:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=972741;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=342629;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.92[0m seconds;               ]8;id=190259;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=536964;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/08/26 05:01:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=495074;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=967781;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 05:01:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.91[0m seconds;               ]8;id=417365;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=23512;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=646435;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=546721;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/libexif/apple/exif-mnote-data-apple.c                                         [2m                [0m
[2;36m                    [0m         +++ b/libexif/apple/exif-mnote-data-apple.c                                         [2m                [0m
[2;36m                    [0m         @@ [1;36m-28[0m,[1;36m6[0m +[1;36m28[0m,[1;36m8[0m @@                                                                   [2m                [0m
[2;36m                    [0m          #include [1m<[0m[1;95mlibexif[0m[39m/exif-data.h>[0m                                                     [2m                [0m
[2;36m                    [0m         [39m #include <libexif/exif-utils.h>[0m                                                    [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m       [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m static void[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m [0m[1;35mexif_mnote_data_apple_free[0m[1;39m([0m[39mExifMnoteData *md[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m     ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                             [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-62[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m64[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39m!d || !buf || [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39m!d || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                              [2m                [0m
[2;36m                    [0m         [39m                  [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m         return;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-70[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m72[0m[39m,[0m[1;36m13[0m[39m @@[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [39m     ofs = d->offset + [0m[1;36m6[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[39m* Sanity check the offset - need at least [0m[1;36m16[0m[39m bytes for header *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mofs, buf_size, [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                              [2m                [0m
[2;36m                    [0m         [39m+                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+        return;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [39m         d->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                                       [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-84[0m[39m,[0m[1;36m8[0m[39m +[0m[1;36m93[0m[39m,[0m[1;36m15[0m[39m @@[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     tcount = [0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    [0m[35m/[0m[39m* Sanity check the offset *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[39m + tcount * [0m[1;36m6[0m[39m + [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[39m* Limit the number of tags to prevent excessive memory allocation *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mtcount > [0m[1;36m100[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                              [2m                [0m
[2;36m                    [0m         [39m+                 [0m[32m"ExifMnoteApple"[0m[39m, [0m[32m"Too many tags [0m[32m([0m[32m%u[0m[32m)[0m[32m in Apple MakerNote"[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mtcount[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m+        return;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[39m* Sanity check the offset - each entry is [0m[1;36m12[0m[39m bytes *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mofs, buf_size, [0m[1;36m16[0m[39m + tcount * [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                              [2m                [0m
[2;36m                    [0m         [39m                  [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-107[0m[39m,[0m[1;36m21[0m[39m +[0m[1;36m123[0m[39m,[0m[1;36m42[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < tcount; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[39m* Check if we have enough buffer for the [0m[1;36m12[0m[39m-byte entry header *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mofs, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                          [2m                [0m
[2;36m                    [0m         [39m+                     [0m[32m"ExifMnoteApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+            break;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs, d->order[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m         d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m2[0m[39m, d->order[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [39m         d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components = [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m4[0m[39m, d->order[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m         d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order = d->order;[0m                                            [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[39m* Check for integer overflow in size calculation *[0m[35m/[0m                       [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m                          [2m                [0m
[2;36m                    [0m         [39m+            buf_size [0m[35m/[0m[39m [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m < [0m               [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                          [2m                [0m
[2;36m                    [0m         [39m+                     [0m[32m"ExifMnoteApple"[0m[39m, [0m[32m"Tag size overflow detected [0m[32m([0m[32m%u * %lu[0m[32m)[0m[32m"[0m[39m,[0m    [2m                [0m
[2;36m                    [0m         [39m+                     [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m, [0m                  [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+            continue;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         dsize = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m                      [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [39m             dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m             dofs = ofs + [0m[1;36m8[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-       [0m[39mif [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [39m-       [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [39m-                                  [0m[32m"ExifMnoteApplet"[0m[39m, [0m[32m"Tag size overflow detected [0m  [2m                [0m
[2;36m                    [0m         [32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, buf_size[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m-       [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m-       [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[39m* Check if data extends beyond buffer *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdofs, buf_size, dsize[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                          [2m                [0m
[2;36m                    [0m         [39m+                     [0m[32m"ExifMnoteApple"[0m[39m, [0m[32m"Tag data past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m,[0m    [2m                [0m
[2;36m                    [0m         [39m+                     [0m[1;39m([0m[39munsigned[0m[1;39m)[0m[1;39m([0m[39mdofs + dsize[0m[1;39m)[0m[39m, buf_size[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m+            continue;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         ofs += [0m[1;36m12[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m         d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, dsize[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39m!d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m < [0m    [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m863523546[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2850[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x555a79c3d738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x555a79c3e25a[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2850[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x555a79c3e260[0m[39m,[0m[1;36m0x555a79c49480[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x515000000785[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x555a79b7afc0[0m[39m bp [0m[1;36m0x7ffe17df2b00[0m[39m sp [0m[1;36m0x7ffe17df2af8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x515000000785[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555a79b7afbf[0m[39m in exif_get_sshort [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555a79b7afbf[0m[39m in exif_get_short [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m104:10[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555a79b7d854[0m[39m in exif_mnote_data_apple_load [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m110:29[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555a79b60efe[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555a79b6036e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555a79b5d8af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x555a79a12330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555a799fd5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x555a79a0303f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x555a79a2e2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fd925e4c082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x555a799f578d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8078d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: exif_get_sshort--exif_get_short--exif_mnote_data_apple_load[0m            [2m                [0m
[2;36m                    [0m         [1;36m0x515000000785[0m[39m is located [0m[1;36m5[0m[39m bytes after [0m[1;36m512[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x515000000580[0m[39m,[0m[1;36m0x515000000780[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555a79b1e0ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555a79b9a8f3[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555a799fd5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555a79a0303f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555a79a2e2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7fd925e4c082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39min exif_get_sshort[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000580[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000600[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000680[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000700[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x515000000780[0m[39m:[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000800[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000880[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000900[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000980[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000a00[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpdz0ucir_[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow vulnerability has been detected in the libexif library [0m      [2m                [0m
[2;36m                    [0m         [39mduring fuzzing tests. The issue occurs when processing EXIF data, specifically in [0m  [2m                [0m
[2;36m                    [0m         [39mthe `exif_get_sshort` function which attempts to read [0m[1;36m1[0m[39m byte beyond the bounds of a[0m [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m-byte allocated heap buffer. The overflow is triggered through the Apple [0m        [2m                [0m
[2;36m                    [0m         [39mMakerNote data processing path when parsing EXIF metadata.[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Details[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe AddressSanitizer [0m[1;39m([0m[39mASan[0m[1;39m)[0m[39m detected a heap-buffer-overflow vulnerability with a [0m   [2m                [0m
[2;36m                    [0m         [39mscariness score of [0m[1;36m12[0m[39m, classified as a [0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow. The [0m       [2m                [0m
[2;36m                    [0m         [39minvalid read operation attempts to access memory at address `[0m[1;36m0x515000000785[0m[39m`, which[0m [2m                [0m
[2;36m                    [0m         [39mis located [0m[1;36m5[0m[39m bytes after the end of a [0m[1;36m512[0m[39m-byte heap-allocated region [0m               [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`[0m[1;36m0x515000000580[0m[39m` to `[0m[1;36m0x515000000780[0m[39m`[0m[1;39m)[0m[39m.[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Call Stack Analysis[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability manifests through the following execution path:[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Point**: The fuzzer harness [0m[1;39m([0m[39m`LLVMFuzzerTestOneInput`[0m[1;39m)[0m[39m in [0m               [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m` at line [0m[1;36m51[0m[39m initiates the test[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Data Creation**: `exif_data_new_from_data` is called to create EXIF data [0m      [2m                [0m
[2;36m                    [0m         [39mstructure from raw input[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Data Loading**: `exif_data_load_data` processes the EXIF data at line [0m[1;36m1010[0m     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Apple MakerNote Processing**: `exif_mnote_data_apple_load` in [0m                 [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m` at line [0m[1;36m110[0m[39m handles [0m           [2m                [0m
[2;36m                    [0m         [39mApple-specific MakerNote data[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Vulnerability Trigger**: `exif_get_short` and subsequently `exif_get_sshort` [0m  [2m                [0m
[2;36m                    [0m         [39min `[0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m` perform the out-of-bounds read operation[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis is a **heap-buffer-overflow** vulnerability, specifically a read operation [0m    [2m                [0m
[2;36m                    [0m         [39mthat extends beyond allocated memory boundaries. The overflow is relatively small [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;36m5[0m[39m bytes past the buffer end[0m[1;39m)[0m[39m, but still represents a security risk as it could [0m    [2m                [0m
[2;36m                    [0m         [39mlead to:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- Information disclosure by reading unintended memory contents[0m                      [2m                [0m
[2;36m                    [0m         [39m- Potential program crashes[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- Possible exploitation vectors depending on the surrounding memory layout[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Buffer Allocation**: A [0m[1;36m512[0m[39m-byte region was allocated on the heap through the [0m  [2m                [0m
[2;36m                    [0m         [39mstandard `malloc` function called via the C++ `operator new`[0m                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Overflow Offset**: The invalid read occurs exactly [0m[1;36m5[0m[39m bytes after the allocated[0m [2m                [0m
[2;36m                    [0m         [39mbuffer ends[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Data Processing Context**: The overflow happens during the processing of Apple[0m [2m                [0m
[2;36m                    [0m         [39mMakerNote EXIF data, suggesting the issue is related to parsing vendor-specific [0m    [2m                [0m
[2;36m                    [0m         [39mmetadata[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Utility Function Involvement**: The vulnerability occurs in low-level utility [0m [2m                [0m
[2;36m                    [0m         [39mfunctions [0m[1;39m([0m[39m`exif_get_sshort`[0m[35m/[0m[39m`exif_get_short`[0m[1;39m)[0m[39m responsible for reading short [0m       [2m                [0m
[2;36m                    [0m         [39minteger values from binary data[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Code Areas Requiring Investigation[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a comprehensive understanding of this vulnerability, the following [0m       [2m                [0m
[2;36m                    [0m         [39mcomponents should be examined:[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **`[0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m`**: [0m                                        [2m                [0m
[2;36m                    [0m         [39m   - The `exif_get_sshort` and `exif_get_short` functions [0m[1;39m([0m[39maround line [0m[1;36m104[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m   - Boundary checking mechanisms in these utility functions[0m                        [2m                [0m
[2;36m                    [0m         [39m   - How these functions calculate and validate buffer offsets[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **`[0m[35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m`**:[0m                        [2m                [0m
[2;36m                    [0m         [39m   - The `exif_mnote_data_apple_load` function [0m[1;39m([0m[39mspecifically line [0m[1;36m110[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m   - How it calculates offsets when reading Apple MakerNote data[0m                    [2m                [0m
[2;36m                    [0m         [39m   - Size validation logic before calling `exif_get_short`[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **`[0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m`**:[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - The `exif_data_load_data` function [0m[1;39m([0m[39mline [0m[1;36m1010[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - How it validates data sizes before delegating to vendor-specific parsers[0m       [2m                [0m
[2;36m                    [0m         [39m   - Buffer size tracking and propagation to downstream functions[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Apple MakerNote Structure Handling**:[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - The expected format and structure of Apple MakerNote data[0m                      [2m                [0m
[2;36m                    [0m         [39m   - How field counts and offsets are calculated and validated[0m                      [2m                [0m
[2;36m                    [0m         [39m   - Any assumptions made about minimum data sizes[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe investigation should focus on understanding whether proper bounds checking is [0m  [2m                [0m
[2;36m                    [0m         [39mperformed before data access operations, and how buffer sizes are tracked and [0m      [2m                [0m
[2;36m                    [0m         [39mvalidated throughout the EXIF parsing pipeline.[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m < [0m    [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m863523546[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2850[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x555a79c3d738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x555a79c3e25a[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2850[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x555a79c3e260[0m[39m,[0m[1;36m0x555a79c49480[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x515000000785[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x555a79b7afc0[0m[39m bp [0m[1;36m0x7ffe17df2b00[0m[39m sp [0m[1;36m0x7ffe17df2af8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x515000000785[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555a79b7afbf[0m[39m in exif_get_sshort [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555a79b7afbf[0m[39m in exif_get_short [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m104:10[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555a79b7d854[0m[39m in exif_mnote_data_apple_load [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m110:29[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555a79b60efe[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555a79b6036e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555a79b5d8af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x555a79a12330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555a799fd5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x555a79a0303f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x555a79a2e2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fd925e4c082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x555a799f578d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8078d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: exif_get_sshort--exif_get_short--exif_mnote_data_apple_load[0m            [2m                [0m
[2;36m                    [0m         [1;36m0x515000000785[0m[39m is located [0m[1;36m5[0m[39m bytes after [0m[1;36m512[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x515000000580[0m[39m,[0m[1;36m0x515000000780[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555a79b1e0ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555a79b9a8f3[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555a799fd5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555a79a0303f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555a79a2e2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7fd925e4c082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39min exif_get_sshort[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000580[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000600[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000680[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000700[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x515000000780[0m[39m:[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000800[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000880[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000900[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000980[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000a00[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpdz0ucir_[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-utils.[0m[1;92mc:78[0m[39m-[0m[1;36m105[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39mcase EXIF_FORMAT_BYTE:[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39mcase EXIF_FORMAT_ASCII:[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39mdefault:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m        [0m[35m/[0m[39m* Nothing here. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m86:E[0m[39mxifSShort[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;92m87:e[0m[39mxif_get_sshort [0m[1;39m([0m[39mconst unsigned char *buf, ExifByteOrder order[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!buf[0m[1;39m)[0m[39m return [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        switch [0m[1;39m([0m[39morder[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        case EXIF_BYTE_ORDER_MOTOROLA:[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39mbuf[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | buf[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        case EXIF_BYTE_ORDER_INTEL:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39mbuf[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | buf[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[35m/[0m[39m* Won't be reached *[0m[35m/[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mreturn [0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m101:E[0m[39mxifShort[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;92m102:e[0m[39mxif_get_short [0m[1;39m([0m[39mconst unsigned char *buf, ExifByteOrder order[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[39mreturn [0m[1;39m([0m[39mexif_get_sshort [0m[1;39m([0m[39mbuf, order[0m[1;39m)[0m[39m & [0m[1;36m0xffff[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:56[0m[39m-[0m[1;36m137[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m57:e[0m[1;35mxif_mnote_data_apple_load[0m[1;39m([0m[39mExifMnoteData *md, const unsigned char *buf, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mint buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    unsigned int tcount, i;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    unsigned int dsize;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    unsigned int ofs, dofs;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    if [0m[1;39m([0m[39m!d || !buf || [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    ofs = d->offset + [0m[1;36m6[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        d->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        d->order = EXIF_BYTE_ORDER_INTEL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Unrecognized byte order"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    tcount = [0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[35m/[0m[39m* Sanity check the offset *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    if [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[39m + tcount * [0m[1;36m6[0m[39m + [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[35m/[0m[39m* [0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m: total %d tags\n"[0m[39m, __FUNCTION__, __LINE__, tcount[0m[1;39m)[0m[39m; *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    ofs += [0m[1;36m16[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[1;35mexif_mnote_data_apple_free[0m[1;39m([0m[39mmd[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    d->entries = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m * tcount[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    if [0m[1;39m([0m[39m!d->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m *[0m [2m                [0m
[2;36m                    [0m         [39mtcount[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < tcount; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs, d->order[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m2[0m[39m, d->order[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components = [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m4[0m[39m, d->order[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order = d->order;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        dsize = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m                   [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            dofs = ofs + [0m[1;36m8[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                                  [0m[32m"ExifMnoteApplet"[0m[39m, [0m[32m"Tag size overflow [0m        [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, buf_size[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        ofs += [0m[1;36m12[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, dsize[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        if [0m[1;39m([0m[39m!d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, dsize[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            continue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, buf + dofs, dsize[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size = dsize;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    d->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:791[0m[39m-[0m[1;36m837[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:[0m[1;35minterpret_maker_note[0m[1;39m([0m[39mExifData *data, const unsigned char *d, unsigned int ds[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:    [0m[39mint mnoteid;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:    [0m[39mExifEntry* e = exif_data_get_entry [0m[1;39m([0m[39mdata, EXIF_TAG_MAKER_NOTE[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!e[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_olympus_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Olympus MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_olympus_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_canon_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Canon MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_canon_new [0m[1;39m([0m[39mdata->priv->mem, [0m       [2m                [0m
[2;36m                    [0m         [39mdata->priv->options[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_fuji_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Fuji MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_fuji_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:    [0m[35m/[0m[39m* NOTE: Must do Pentax detection last because some of the[0m                  [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:    [0m[39m * heuristics are pretty general. *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_pentax_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Pentax MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_pentax_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_apple_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Apple MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_apple_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    [0m[35m/[0m[39m* [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[39m * If we are able to interpret the maker note, do so.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdata->priv->md[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_log [0m[1;39m([0m[39mdata->priv->md, data->priv->log[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_set_byte_order [0m[1;39m([0m[39mdata->priv->md,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mdata->priv->order[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_set_offset [0m[1;39m([0m[39mdata->priv->md,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m    data->priv->offset_mnote[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_load [0m[1;39m([0m[39mdata->priv->md, d, ds[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m837[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:203[0m[39m-[0m[1;36m260[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m204:e[0m[39mxif_mnote_data_canon_load [0m[1;39m([0m[39mExifMnoteData *ne,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39mExifMnoteDataCanon *n = [0m[1;39m([0m[39mExifMnoteDataCanon *[0m[1;39m)[0m[39m ne;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[39mExifShort c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39mlong failsafe_size = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, n->order[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing to much memory[0m [2m                [0m
[2;36m                    [0m         [39mor time. There are [0m[1;36m24[0m[39m named tags currently.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m * The format allows specifying the same range of memory as often as it [0m    [2m                [0m
[2;36m                    [0m         [39mcan, so this multiplies quickly. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39mif [0m[1;39m([0m[39mc > [0m[1;36m100[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifMnoteCanon"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [32m"Too much tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Canon MakerNote"[0m[39m, c[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[35m/[0m[39m* Remove any old entries *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[39mexif_mnote_data_canon_clear [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[39mn->entries = exif_mem_alloc [0m[1;39m([0m[39mne->mem, sizeof [0m[1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteCanon"[0m[39m, sizeof [0m               [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[35m/[0m[39m* Parse the entries *[0m[35m/[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo,buf_size,[0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:289[0m[39m-[0m[1;36m298[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:    [0m[39m        [0m[39m        [0m[39msize_t dataofs = o + [0m[1;36m8[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m[39m dataofs = exif_get_long [0m[1;39m([0m[39mbuf + dataofs, [0m         [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m + [0m[1;36m6[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdataofs, buf_size, s[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_DEBUG,[0m             [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[32m"ExifMnoteCanon"[0m[39m,[0m                           [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[32m"Tag data past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m,[0m    [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[1;39m([0m[39munsigned[0m[1;39m)[0m[1;39m([0m[39mdataofs + s[0m[1;39m)[0m[39m, buf_size[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:403[0m[39m-[0m[1;36m444[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:    [0m[35m/[0m[39m* Sanity check the offset *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo2,buf_size,[0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + o2, n->order[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:    [0m[39mo2 += [0m[1;36m2[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing to much memory[0m [2m                [0m
[2;36m                    [0m         [39mor time. There are [0m[1;36m150[0m[39m named tags currently.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:    [0m[39m * The format allows specifying the same range of memory as often as it [0m    [2m                [0m
[2;36m                    [0m         [39mcan, so this multiplies quickly. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:    [0m[39mif [0m[1;39m([0m[39mc > [0m[1;36m300[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifMnoteOlympus"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [32m"Too much tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Olympus MakerNote"[0m[39m, c[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:    [0m[35m/[0m[39m* Remove any old entries *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:    [0m[39mexif_mnote_data_olympus_clear [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:    [0m[39mn->entries = exif_mem_alloc [0m[1;39m([0m[39men->mem, sizeof [0m[1;39m([0m[39mMnoteOlympusEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39men->log, [0m[32m"ExifMnoteOlympus"[0m[39m, sizeof [0m             [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mMnoteOlympusEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:    [0m[35m/[0m[39m* Parse all c entries, storing ones that are successfully parsed *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = o2; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteOlympusEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:    [0m[39m    n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m + [0m   [2m                [0m
[2;36m                    [0m         [39mbase;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:    [0m[39m    n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:    [0m[39m    n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, n->order[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:472[0m[39m-[0m[1;36m498[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:    [0m[39m        [0m[39m        [0m[39msize_t dataofs = o + [0m[1;36m8[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[35m/[0m[39m* The data in this case is merely a pointer *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mdataofs = exif_get_long [0m[1;39m([0m[39mbuf + dataofs, n->order[0m[1;39m)[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [39mdatao;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:#ifdef EXIF_OVERCOME_SANYO_OFFSET_BUG[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[35m/[0m[39m* Some Sanyo models [0m[1;39m([0m[39me.g. VPC-C5, C40[0m[1;39m)[0m[39m suffer from[0m [2m                [0m
[2;36m                    [0m         [39ma bug when[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m * writing the offset for the [0m                      [2m                [0m
[2;36m                    [0m         [39mMNOTE_OLYMPUS_TAG_THUMBNAILIMAGE[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m * tag in its MakerNote. The offset is actually the[0m [2m                [0m
[2;36m                    [0m         [39mabsolute[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m * position in the file instead of the position [0m    [2m                [0m
[2;36m                    [0m         [39mwithin the IFD.[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:    [0m[39m        [0m[39m        [0m[39m    if [0m[1;39m([0m[39mdataofs > [0m[1;39m([0m[39mbuf_size - s[0m[1;39m)[0m[39m && n->version == sanyoV1[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[35m/[0m[39m* fix pointer *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mdataofs -= datao + [0m[1;36m6[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG,[0m     [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteOlympus"[0m[39m,[0m               [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Inconsistent thumbnail tag [0m      [2m                [0m
[2;36m                    [0m         [32moffset; attempting to recover"[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:    [0m[39m        [0m[39m        [0m[39m    [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdataofs, buf_size, s[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG,[0m             [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteOlympus"[0m[39m,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag data past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[1;39m([0m[39munsigned[0m[1;39m)[0m[1;39m([0m[39mdataofs + s[0m[1;39m)[0m[39m, buf_size[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:31[0m[39m-[0m[1;36m32[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:33[0m[39m-[0m[1;36m34[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:38[0m[39m-[0m[1;36m39[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/mnote-apple-entry.h:[0m[1;36m30[0m[39m-[0m[1;36m37[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:struct _MnoteAppleEntry [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    MnoteAppleTag tag;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    ExifFormat format;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    unsigned long components;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    unsigned char *data;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    unsigned int size;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    ExifByteOrder order;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:56[0m[39m-[0m[1;36m93[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m57:e[0m[1;35mxif_mnote_data_apple_load[0m[1;39m([0m[39mExifMnoteData *md, const unsigned char *buf, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mint buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    unsigned int tcount, i;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    unsigned int dsize;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    unsigned int ofs, dofs;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    if [0m[1;39m([0m[39m!d || !buf || [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    ofs = d->offset + [0m[1;36m6[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        d->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        d->order = EXIF_BYTE_ORDER_INTEL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Unrecognized byte order"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    tcount = [0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[35m/[0m[39m* Sanity check the offset *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    if [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[39m + tcount * [0m[1;36m6[0m[39m + [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-utils.[0m[1;92mc:86[0m[39m-[0m[1;36m105[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m86:E[0m[39mxifSShort[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;92m87:e[0m[39mxif_get_sshort [0m[1;39m([0m[39mconst unsigned char *buf, ExifByteOrder order[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!buf[0m[1;39m)[0m[39m return [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        switch [0m[1;39m([0m[39morder[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        case EXIF_BYTE_ORDER_MOTOROLA:[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39mbuf[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | buf[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        case EXIF_BYTE_ORDER_INTEL:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39mbuf[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | buf[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[35m/[0m[39m* Won't be reached *[0m[35m/[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mreturn [0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m101:E[0m[39mxifShort[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;92m102:e[0m[39mxif_get_short [0m[1;39m([0m[39mconst unsigned char *buf, ExifByteOrder order[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[39mreturn [0m[1;39m([0m[39mexif_get_sshort [0m[1;39m([0m[39mbuf, order[0m[1;39m)[0m[39m & [0m[1;36m0xffff[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-utils.[0m[1;92mc:164[0m[39m-[0m[1;36m168[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m164:E[0m[39mxifLong[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;92m165:e[0m[39mxif_get_long [0m[1;39m([0m[39mconst unsigned char *buf, ExifByteOrder order[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        return [0m[1;39m([0m[39mexif_get_slong [0m[1;39m([0m[39mbuf, order[0m[1;39m)[0m[39m & [0m[1;36m0xffffffff[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:246[0m[39m-[0m[1;36m273[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo,buf_size,[0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteCanon"[0m[39m,[0m           [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    [0m[39m        [0m[39m        [0m[32m"Loading entry 0x%x [0m[32m([0m[32m'%s'[0m[32m)[0m[32m..."[0m[39m, n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag,[0m     [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[39m        [0m[39m        [0m[39m mnote_canon_tag_get_name [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Check if we overflow the multiplication. Use buf_size as the max[0m [2m                [0m
[2;36m                    [0m         [39msize for integer overflow detection,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[39m        [0m[39m * we will check the buffer sizes closer later. *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m    [0m[39mexif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m         [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf_size [0m[35m/[0m[39m exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m< n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:    [0m[39m        [0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Tag size overflow detected [0m[32m([0m[32m%u[0m [2m                [0m
[2;36m                    [0m         [32m* %lu[0m[32m)[0m[32m"[0m[39m, exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m, [0m                         [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:109[0m[39m-[0m[1;36m133[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < tcount; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs, d->order[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m2[0m[39m, d->order[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components = [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m4[0m[39m, d->order[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order = d->order;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        dsize = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m                   [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            dofs = ofs + [0m[1;36m8[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                                  [0m[32m"ExifMnoteApplet"[0m[39m, [0m[32m"Tag size overflow [0m        [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, buf_size[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        ofs += [0m[1;36m12[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, dsize[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        if [0m[1;39m([0m[39m!d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, dsize[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            continue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, buf + dofs, dsize[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size = dsize;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-utils.[0m[1;92mc:129[0m[39m-[0m[1;36m142[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m129:E[0m[39mxifSLong[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;92m130:e[0m[39mxif_get_slong [0m[1;39m([0m[39mconst unsigned char *b, ExifByteOrder order[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!b[0m[1;39m)[0m[39m return [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        switch [0m[1;39m([0m[39morder[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        case EXIF_BYTE_ORDER_MOTOROLA:[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m << [0m[1;36m24[0m[1;39m)[0m[39m | [0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m16[0m[1;39m)[0m[39m | [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        case EXIF_BYTE_ORDER_INTEL:[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m24[0m[1;39m)[0m[39m | [0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m << [0m[1;36m16[0m[1;39m)[0m[39m | [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[35m/[0m[39m* Won't be reached *[0m[35m/[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39mreturn [0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.h:[0m[1;36m30[0m[39m-[0m[1;36m38[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:typedef struct _ExifMnoteDataApple ExifMnoteDataApple;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:struct _ExifMnoteDataApple [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    ExifMnoteData parent;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    ExifByteOrder order;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    unsigned int offset;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    MnoteAppleEntry *entries;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    unsigned int count;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/mnote-apple-entry.[0m[1;92mc:33[0m[39m-[0m[1;36m155[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m33:c[0m[39mhar *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[1;35mmnote_apple_entry_get_value[0m[1;39m([0m[39mMnoteAppleEntry *entry, char *v, unsigned int [0m       [2m                [0m
[2;36m                    [0m         [39mmaxlen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    ExifLong  vl;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    ExifSLong vsl;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    ExifShort vs;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    ExifSShort vss;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    ExifRational vr;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    ExifSRational vsr;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    size_t size;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    unsigned char *data;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    if [0m[1;39m([0m[39m!entry[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        return NULL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39mv, [0m[1;36m0[0m[39m, maxlen[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    maxlen--;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    size = entry->size;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    data = entry->data;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    switch [0m[1;39m([0m[39mentry->tag[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    case MNOTE_APPLE_TAG_HDR:[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     [0m[39mif [0m[1;39m([0m[39msize < [0m[1;36m4[0m[1;39m)[0m[39m return NULL;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     [0m[39mif [0m[1;39m([0m[39mentry->format != EXIF_FORMAT_SLONG[0m[1;39m)[0m[39m return NULL;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     [0m[39mif [0m[1;39m([0m[39mentry->components != [0m[1;36m1[0m[1;39m)[0m[39m return NULL;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        vsl = [0m[1;35mexif_get_slong[0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35msnprintf[0m[1;39m([0m[39mv, maxlen, [0m[32m"%d"[0m[39m, vsl[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        break;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    case MNOTE_APPLE_TAG_IMAGE_UNIQUE_ID:[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    case MNOTE_APPLE_TAG_BURST_UUID:[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    case MNOTE_APPLE_TAG_MEDIA_GROUP_UUID:[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     [0m[39mif [0m[1;39m([0m[39mentry->format != EXIF_FORMAT_ASCII[0m[1;39m)[0m[39m return NULL;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     [0m[39mstrncpy [0m[1;39m([0m[39mv, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m data, MIN [0m[1;39m([0m[39mmaxlen-[0m[1;36m1[0m[39m, size[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     [0m[39mv[0m[1;39m[[0m[39mMIN [0m[1;39m([0m[39mmaxlen-[0m[1;36m1[0m[39m, size[0m[1;39m)[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        break;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    default:[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     [0m[39mswitch [0m[1;39m([0m[39mentry->format[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mcase EXIF_FORMAT_ASCII:[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     [0m[39m    strncpy [0m[1;39m([0m[39mv, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mdata, [0m[1;35mMIN[0m[1;39m([0m[39mmaxlen, size[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[39mcase EXIF_FORMAT_SHORT: [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[39m    size_t i, len = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39m    [0m[1;35mfor[0m[1;39m([0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<entry->components; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39msize < [0m[1;36m2[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39mlen > maxlen[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m        [0m[39mvs = exif_get_short [0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39m        [0m[39msnprintf [0m[1;39m([0m[39mv+len, maxlen-len, [0m[32m"%hu "[0m[39m, vs[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39m        [0m[39mlen = [0m[1;35mstrlen[0m[1;39m([0m[39mv[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39m        [0m[39mdata += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39m        [0m[39msize -= [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mcase EXIF_FORMAT_SSHORT: [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39m    size_t i, len = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39m    [0m[1;35mfor[0m[1;39m([0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<entry->components; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39msize < [0m[1;36m2[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39mlen > maxlen[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     [0m[39m        [0m[39mvss = exif_get_sshort [0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[39m        [0m[39msnprintf [0m[1;39m([0m[39mv+len, maxlen-len, [0m[32m"%hi "[0m[39m, vss[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39m        [0m[39mlen = [0m[1;35mstrlen[0m[1;39m([0m[39mv[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[39m        [0m[39mdata += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[39m        [0m[39msize -= [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[39mbreak;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        case EXIF_FORMAT_LONG: [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[39m    size_t i, len = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[39m    [0m[1;35mfor[0m[1;39m([0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<entry->components; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39msize < [0m[1;36m4[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mlen > maxlen[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[39m        [0m[39mvl = exif_get_long [0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[39m        [0m[39msnprintf [0m[1;39m([0m[39mv+len, maxlen-len, [0m[32m"%lu "[0m[39m, [0m[1;39m([0m[39mlong unsigned[0m[1;39m)[0m[39m vl[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[39m        [0m[39mlen = [0m[1;35mstrlen[0m[1;39m([0m[39mv[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[39m        [0m[39mdata += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[39m        [0m[39msize -= [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[39mcase EXIF_FORMAT_SLONG: [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39m    size_t i, len = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m    [0m[1;35mfor[0m[1;39m([0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<entry->components; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39msize < [0m[1;36m4[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mlen > maxlen[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[39m        [0m[39m    break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[39m        [0m[39mvsl = exif_get_slong [0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[39m        [0m[39msnprintf [0m[1;39m([0m[39mv+len, maxlen-len, [0m[32m"%li "[0m[39m, [0m[1;39m([0m[39mlong int[0m[1;39m)[0m[39m vsl[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[39m        [0m[39mlen = [0m[1;35mstrlen[0m[1;39m([0m[39mv[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[39m        [0m[39mdata += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[39m        [0m[39msize -= [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[39mcase EXIF_FORMAT_RATIONAL:[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[39m    vr = exif_get_rational [0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[39m    if [0m[1;39m([0m[39m!vr.denominator[0m[1;39m)[0m[39m break;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[39m    snprintf [0m[1;39m([0m[39mv, maxlen, [0m[32m"%2.4f"[0m[39m, [0m[1;39m([0m[39mdouble[0m[1;39m)[0m[39m vr.numerator [0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m    vr.denominator[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[39mcase EXIF_FORMAT_SRATIONAL:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39m    vsr = exif_get_srational [0m[1;39m([0m[39mdata, entry->order[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[39m    if [0m[1;39m([0m[39m!vsr.denominator[0m[1;39m)[0m[39m break;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[39m    snprintf [0m[1;39m([0m[39mv, maxlen, [0m[32m"%2.4f"[0m[39m, [0m[1;39m([0m[39mdouble[0m[1;39m)[0m[39m vsr.numerator [0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[39m        [0m[39m  vsr.denominator[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[39mcase EXIF_FORMAT_UNDEFINED:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39mdefault:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39m    snprintf [0m[1;39m([0m[39mv, maxlen, [0m[1;35m_[0m[1;39m([0m[32m"%i bytes unknown data"[0m[1;39m)[0m[39m, entry->size[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    [0m[39m    break;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[39mbreak;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:     [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:     return v;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:200[0m[39m-[0m[1;36m235[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag starts past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m, doff, [0m [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[39mif [0m[1;39m([0m[39ms > size - doff[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag data goes past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mdoff+s, size[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39mentry->data = exif_data_alloc [0m[1;39m([0m[39mdata, s[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    [0m[39mif [0m[1;39m([0m[39mentry->data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39m        [0m[39mentry->size = s;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39mentry->data, d + doff, s[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mdata->priv->log, [0m[32m"ExifData"[0m[39m, s[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[35m/[0m[39m* If this is the MakerNote, remember the offset *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39mif [0m[1;39m([0m[39mentry->tag == EXIF_TAG_MAKER_NOTE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!entry->data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"MakerNote found with empty data"[0m[1;39m)[0m[39m;   [0m    [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry->size > [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m     [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       [0m[32m"MakerNote found [0m[32m([0m[32m%02x %02x %02x [0m    [2m                [0m
[2;36m                    [0m         [32m%02x "[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       [0m[32m"%02x %02x %02x...[0m[32m)[0m[32m."[0m[39m,[0m               [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       entry->data[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, entry->data[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mentry->data[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       entry->data[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m, entry->data[0m[1;39m[[0m[1;36m4[0m[1;39m][0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mentry->data[0m[1;39m[[0m[1;36m5[0m[1;39m][0m[39m,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       entry->data[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[39m        [0m[39mdata->priv->offset_mnote = doff;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[39mreturn [0m[1;36m1[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:219[0m[39m-[0m[1;36m234[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[35m/[0m[39m* If this is the MakerNote, remember the offset *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39mif [0m[1;39m([0m[39mentry->tag == EXIF_TAG_MAKER_NOTE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!entry->data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"MakerNote found with empty data"[0m[1;39m)[0m[39m;   [0m    [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry->size > [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m     [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       [0m[32m"MakerNote found [0m[32m([0m[32m%02x %02x %02x [0m    [2m                [0m
[2;36m                    [0m         [32m%02x "[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       [0m[32m"%02x %02x %02x...[0m[32m)[0m[32m."[0m[39m,[0m               [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       entry->data[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, entry->data[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mentry->data[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       entry->data[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m, entry->data[0m[1;39m[[0m[1;36m4[0m[1;39m][0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mentry->data[0m[1;39m[[0m[1;36m5[0m[1;39m][0m[39m,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       entry->data[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[39m        [0m[39mdata->priv->offset_mnote = doff;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:212[0m[39m-[0m[1;36m225[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, n->order[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:244[0m[39m-[0m[1;36m254[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39mo2 = [0m[1;36m6[0m[39m + n->offset; [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo2,buf_size,[0m[1;36m10[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:236[0m[39m-[0m[1;36m247[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:int[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;92m237:e[0m[1;35mxif_mnote_data_apple_identify[0m[1;39m([0m[39mconst ExifData *ed, const ExifEntry *e[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    int variant;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    if [0m[1;39m([0m[39m![0m[1;35mstrcmp[0m[1;39m([0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m e->data, [0m[32m"Apple iOS"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:        variant = [0m[1;36m1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:        variant = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    return variant;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:65[0m[39m-[0m[1;36m93[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    if [0m[1;39m([0m[39m!d || !buf || [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    ofs = d->offset + [0m[1;36m6[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        d->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        d->order = EXIF_BYTE_ORDER_INTEL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Unrecognized byte order"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    tcount = [0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[35m/[0m[39m* Sanity check the offset *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    if [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[39m + tcount * [0m[1;36m6[0m[39m + [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:190[0m[39m-[0m[1;36m235[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[39m * in the entry but somewhere else [0m[1;39m([0m[39moffset[0m[1;39m)[0m[39m.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[39m        [0m[39mdoff = exif_get_long [0m[1;39m([0m[39md + offset + [0m[1;36m8[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:    [0m[39melse[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:    [0m[39m        [0m[39mdoff = offset + [0m[1;36m8[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:    [0m[35m/[0m[39m* Sanity checks *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdoff >= size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag starts past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m, doff, [0m [2m                [0m
[2;36m                    [0m         [39msize[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[39mif [0m[1;39m([0m[39ms > size - doff[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag data goes past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mdoff+s, size[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39mentry->data = exif_data_alloc [0m[1;39m([0m[39mdata, s[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    [0m[39mif [0m[1;39m([0m[39mentry->data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39m        [0m[39mentry->size = s;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39mentry->data, d + doff, s[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mdata->priv->log, [0m[32m"ExifData"[0m[39m, s[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[35m/[0m[39m* If this is the MakerNote, remember the offset *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39mif [0m[1;39m([0m[39mentry->tag == EXIF_TAG_MAKER_NOTE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m!entry->data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"MakerNote found with empty data"[0m[1;39m)[0m[39m;   [0m    [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry->size > [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m     [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       [0m[32m"MakerNote found [0m[32m([0m[32m%02x %02x %02x [0m    [2m                [0m
[2;36m                    [0m         [32m%02x "[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       [0m[32m"%02x %02x %02x...[0m[32m)[0m[32m."[0m[39m,[0m               [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       entry->data[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, entry->data[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mentry->data[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       entry->data[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m, entry->data[0m[1;39m[[0m[1;36m4[0m[1;39m][0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mentry->data[0m[1;39m[[0m[1;36m5[0m[1;39m][0m[39m,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m       entry->data[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[39m        [0m[39mdata->priv->offset_mnote = doff;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[39mreturn [0m[1;36m1[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:31[0m[39m-[0m[1;36m32[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:31[0m[39m-[0m[1;36m32[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:51[0m[39m-[0m[1;36m52[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:56[0m[39m-[0m[1;36m137[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m57:e[0m[1;35mxif_mnote_data_apple_load[0m[1;39m([0m[39mExifMnoteData *md, const unsigned char *buf, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mint buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    unsigned int tcount, i;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    unsigned int dsize;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    unsigned int ofs, dofs;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    if [0m[1;39m([0m[39m!d || !buf || [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    ofs = d->offset + [0m[1;36m6[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        d->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        d->order = EXIF_BYTE_ORDER_INTEL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Unrecognized byte order"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    tcount = [0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[35m/[0m[39m* Sanity check the offset *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    if [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[39m + tcount * [0m[1;36m6[0m[39m + [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[35m/[0m[39m* [0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m: total %d tags\n"[0m[39m, __FUNCTION__, __LINE__, tcount[0m[1;39m)[0m[39m; *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    ofs += [0m[1;36m16[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[1;35mexif_mnote_data_apple_free[0m[1;39m([0m[39mmd[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    d->entries = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m * tcount[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    if [0m[1;39m([0m[39m!d->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m *[0m [2m                [0m
[2;36m                    [0m         [39mtcount[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < tcount; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs, d->order[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m2[0m[39m, d->order[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components = [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m4[0m[39m, d->order[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order = d->order;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        dsize = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m                   [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            dofs = ofs + [0m[1;36m8[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                                  [0m[32m"ExifMnoteApplet"[0m[39m, [0m[32m"Tag size overflow [0m        [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, buf_size[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        ofs += [0m[1;36m12[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, dsize[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        if [0m[1;39m([0m[39m!d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, dsize[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            continue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, buf + dofs, dsize[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size = dsize;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    d->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:203[0m[39m-[0m[1;36m273[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m204:e[0m[39mxif_mnote_data_canon_load [0m[1;39m([0m[39mExifMnoteData *ne,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39mExifMnoteDataCanon *n = [0m[1;39m([0m[39mExifMnoteDataCanon *[0m[1;39m)[0m[39m ne;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[39mExifShort c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39mlong failsafe_size = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, n->order[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing to much memory[0m [2m                [0m
[2;36m                    [0m         [39mor time. There are [0m[1;36m24[0m[39m named tags currently.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m * The format allows specifying the same range of memory as often as it [0m    [2m                [0m
[2;36m                    [0m         [39mcan, so this multiplies quickly. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39mif [0m[1;39m([0m[39mc > [0m[1;36m100[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifMnoteCanon"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [32m"Too much tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Canon MakerNote"[0m[39m, c[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[35m/[0m[39m* Remove any old entries *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[39mexif_mnote_data_canon_clear [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[39mn->entries = exif_mem_alloc [0m[1;39m([0m[39mne->mem, sizeof [0m[1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteCanon"[0m[39m, sizeof [0m               [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[35m/[0m[39m* Parse the entries *[0m[35m/[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo,buf_size,[0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteCanon"[0m[39m,[0m           [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    [0m[39m        [0m[39m        [0m[32m"Loading entry 0x%x [0m[32m([0m[32m'%s'[0m[32m)[0m[32m..."[0m[39m, n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag,[0m     [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[39m        [0m[39m        [0m[39m mnote_canon_tag_get_name [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Check if we overflow the multiplication. Use buf_size as the max[0m [2m                [0m
[2;36m                    [0m         [39msize for integer overflow detection,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[39m        [0m[39m * we will check the buffer sizes closer later. *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m    [0m[39mexif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m         [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf_size [0m[35m/[0m[39m exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m< n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:    [0m[39m        [0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Tag size overflow detected [0m[32m([0m[32m%u[0m [2m                [0m
[2;36m                    [0m         [32m* %lu[0m[32m)[0m[32m"[0m[39m, exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m, [0m                         [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:289[0m[39m-[0m[1;36m298[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:    [0m[39m        [0m[39m        [0m[39msize_t dataofs = o + [0m[1;36m8[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m[39m dataofs = exif_get_long [0m[1;39m([0m[39mbuf + dataofs, [0m         [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m + [0m[1;36m6[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdataofs, buf_size, s[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_DEBUG,[0m             [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[32m"ExifMnoteCanon"[0m[39m,[0m                           [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[32m"Tag data past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m,[0m    [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[1;39m([0m[39munsigned[0m[1;39m)[0m[1;39m([0m[39mdataofs + s[0m[1;39m)[0m[39m, buf_size[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis Summary[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and the evaluation report, I've identified the [0m   [2m                [0m
[2;36m                    [0m         [39mroot cause of the heap-buffer-overflow vulnerability in the Apple MakerNote loader.[0m [2m                [0m
[2;36m                    [0m         [39mThe issue stems from multiple missing bounds checks in [0m                             [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m`, which is the ONLY MakerNote [0m  [2m                [0m
[2;36m                    [0m         [39mimplementation that doesn't use the CHECKOVERFLOW macro pattern consistently used [0m  [2m                [0m
[2;36m                    [0m         [39macross all other vendor implementations [0m[1;39m([0m[39mCanon, Olympus, Pentax, Fuji[0m[1;39m)[0m[39m.[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Core Issues Identified[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Missing CHECKOVERFLOW macro**: The Apple implementation doesn't define or use [0m [2m                [0m
[2;36m                    [0m         [39mthe CHECKOVERFLOW macro that all other MakerNote implementations use[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Incorrect size calculation [0m[1;39m([0m[39mLine [0m[1;36m88[0m[1;39m)[0m[39m**: Uses `tcount * [0m[1;36m6[0m[39m` instead of `tcount *[0m [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m` for IFD entries[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - Each IFD entry is [0m[1;36m12[0m[39m bytes [0m[1;39m([0m[1;36m2[0m[39m bytes tag + [0m[1;36m2[0m[39m bytes format + [0m[1;36m4[0m[39m bytes components [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[1;36m4[0m[39m bytes data/offset[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - This allows reading beyond buffer boundaries[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Missing bounds checks before buffer accesses**:[0m                                [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m72[0m[39m-[0m[1;36m77[0m[39m: Accesses `buf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m` and `buf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m` without validation[0m    [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m85[0m[39m: Calls `[0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, [0m[33m...[0m[1;39m)[0m[39m` without validation[0m        [2m                [0m
[2;36m                    [0m         [39m   - Lines [0m[1;36m110[0m[39m-[0m[1;36m112[0m[39m: Reads [0m[1;36m12[0m[39m-byte entry headers without validation[0m                  [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m116[0m[39m: Calls `[0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, [0m[33m...[0m[1;39m)[0m[39m` without validation[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Missing integer overflow check [0m[1;39m([0m[39mLine [0m[1;36m114[0m[1;39m)[0m[39m**: No check for `format_size * [0m      [2m                [0m
[2;36m                    [0m         [39mcomponents` overflow[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Insufficient data bounds check [0m[1;39m([0m[39mLine [0m[1;36m120[0m[1;39m)[0m[39m**: Checks `dofs > buf_size` instead [0m [2m                [0m
[2;36m                    [0m         [39mof `dofs + dsize > buf_size`[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe utility functions `exif_get_sshort`, `exif_get_short`, and `exif_get_long` in [0m  [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m` do NOT perform bounds checking - they blindly [0m  [2m                [0m
[2;36m                    [0m         [39maccess buffer positions. This is by design, as these functions are used throughout [0m [2m                [0m
[2;36m                    [0m         [39mthe codebase and expect callers to validate bounds first. All other MakerNote [0m      [2m                [0m
[2;36m                    [0m         [39mimplementations follow this contract by using CHECKOVERFLOW before calling these [0m   [2m                [0m
[2;36m                    [0m         [39mfunctions, but the Apple implementation does not.[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must be applied to `[0m[35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m` [0m    [2m                [0m
[2;36m                    [0m         [39mfollowing the proven pattern from Canon and Olympus implementations. The strategy [0m  [2m                [0m
[2;36m                    [0m         [39minvolves:[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Add CHECKOVERFLOW Macro Definition[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd the CHECKOVERFLOW macro at the top of the file [0m[1;39m([0m[39mafter includes, around line [0m    [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m-[0m[1;36m32[0m[1;39m)[0m[39m:[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m \[0m                                 [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - [0m      [2m                [0m
[2;36m                    [0m         [39mstructsize [0m[1;39m)[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis macro is identical to those used in Canon, Olympus, Pentax, and Fuji [0m          [2m                [0m
[2;36m                    [0m         [39mimplementations.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Fix Initial Header Validation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace the validation at lines [0m[1;36m65[0m[39m-[0m[1;36m93[0m[39m with proper bounds checking:[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current problematic code:**[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m65[0m[39m: `if [0m[1;39m([0m[39m!d || !buf || [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m`[0m                                 [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m72[0m[39m: `ofs = d->offset + [0m[1;36m6[0m[39m;`[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m74[0m[39m-[0m[1;36m77[0m[39m: Access `buf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m` and `buf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m` without validation[0m        [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m85[0m[39m: `tcount = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;`[0m                     [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m88[0m[39m: `if [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[39m + tcount * [0m[1;36m6[0m[39m + [0m[1;36m4[0m[1;39m)[0m[39m`[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fixed approach:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Validate minimum buffer size accounting for offset[0m                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Calculate `ofs = d->offset + [0m[1;36m6[0m[39m` [0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Check `[0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mofs, buf_size, [0m[1;36m16[0m[1;39m)[0m[39m` before accessing byte order markers and[0m [2m                [0m
[2;36m                    [0m         [39mtag count[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Read tag count only after validation[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Check `[0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mofs, buf_size, [0m[1;36m16[0m[39m + tcount * [0m[1;36m12[0m[1;39m)[0m[39m` for full entry space [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39musing [0m[1;36m12[0m[39m, not [0m[1;36m6[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m3[0m[39m: Add Bounds Check in Entry Reading Loop[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn the loop at lines [0m[1;36m109[0m[39m-[0m[1;36m133[0m[39m, add CHECKOVERFLOW before reading each entry header:[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current problematic code:**[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m110[0m[39m-[0m[1;36m112[0m[39m: Read entry header without validation[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fixed approach:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Before line [0m[1;36m110[0m[39m, add: `if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mofs, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m break; [0m[1;39m}[0m[39m`[0m         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. This ensures [0m[1;36m12[0m[39m bytes are available for reading tag, format, components, and [0m    [2m                [0m
[2;36m                    [0m         [39mdata/offset[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m4[0m[39m: Add Integer Overflow Check[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter line [0m[1;36m113[0m[39m [0m[1;39m([0m[39mreading components[0m[1;39m)[0m[39m, add integer overflow validation:[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Add check:**[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m                                   [2m                [0m
[2;36m                    [0m         [39m    buf_size [0m[35m/[0m[39m [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m < [0m                        [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[32m"ExifMnoteApple"[0m[39m, [0m[32m"Tag size overflow detected"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m    continue;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis prevents integer overflow when calculating `dsize = format_size * components` [0m [2m                [0m
[2;36m                    [0m         [39mat line [0m[1;36m114[0m[39m.[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m5[0m[39m: Fix Data Bounds Validation[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace the check at line [0m[1;36m120[0m[39m with proper CHECKOVERFLOW:[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current problematic code:**[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m120[0m[39m: `if [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m`[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fixed approach:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Replace with: `if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdofs, buf_size, dsize[0m[1;39m)[0m[1;39m)[0m[39m`[0m                         [2m                [0m
[2;36m                    [0m         [39m- This properly checks that `dsize` bytes starting at `dofs` are within buffer [0m     [2m                [0m
[2;36m                    [0m         [39mbounds[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m6[0m[39m: Add Additional Safety Checks[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd a reasonable upper limit on tag count [0m[1;39m([0m[39mlike Canon's [0m[1;36m100[0m[39m or Olympus's [0m[1;36m300[0m[1;39m)[0m[39m after[0m [2m                [0m
[2;36m                    [0m         [39mreading tcount at line [0m[1;36m85[0m[39m:[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mtcount > [0m[1;36m100[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[32m"ExifMnoteApple"[0m[39m, [0m[32m"Too many tags [0m[32m([0m[32m%u[0m[32m)[0m[32m in Apple MakerNote"[0m[39m, tcount[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m    return;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This is the Optimal Approach[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Follows Established Pattern**: This fix replicates the proven, safe [0m           [2m                [0m
[2;36m                    [0m         [39mimplementation pattern used by Canon, Olympus, Pentax, and Fuji MakerNote loaders [0m  [2m                [0m
[2;36m                    [0m         [39min the same codebase[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Minimal Code Changes**: Only modifies the Apple MakerNote loader, avoiding [0m    [2m                [0m
[2;36m                    [0m         [39mchanges to utility functions or other parts of the codebase[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves Existing Logic**: Maintains all existing functionality while adding [0m [2m                [0m
[2;36m                    [0m         [39mnecessary safety checks[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Comprehensive Protection**: Addresses all identified buffer overflow [0m          [2m                [0m
[2;36m                    [0m         [39mvulnerabilities, not just the immediate issue[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Consistent with Codebase Standards**: Uses the same CHECKOVERFLOW macro and [0m   [2m                [0m
[2;36m                    [0m         [39mvalidation patterns already present in the codebase[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Issues[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Prevents the reported overflow**: The CHECKOVERFLOW at line [0m[1;36m250[0m[39m in Canon [0m       [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mequivalent to our Step [0m[1;36m3[0m[1;39m)[0m[39m prevents reading beyond allocated buffer[0m                 [2m                [0m
[2;36m                    [0m         [39m- **Fixes incorrect size calculation**: Using `tcount * [0m[1;36m12[0m[39m` instead of `tcount * [0m[1;36m6[0m[39m`[0m [2m                [0m
[2;36m                    [0m         [39mensures correct buffer size validation[0m                                              [2m                [0m
[2;36m                    [0m         [39m- **Validates all buffer accesses**: Every call to `exif_get_short` and [0m            [2m                [0m
[2;36m                    [0m         [39m`exif_get_long` is protected by prior bounds checking[0m                               [2m                [0m
[2;36m                    [0m         [39m- **Prevents integer overflows**: Checks multiplication overflow before allocating [0m [2m                [0m
[2;36m                    [0m         [39mmemory based on calculated sizes[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Rejected Valid Data**: Malformed but previously accepted EXIF data will now be[0m [2m                [0m
[2;36m                    [0m         [39mrejected[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: This is desired behavior - corrupt data should be rejected [0m    [2m                [0m
[2;36m                    [0m         [39mrather than processed unsafely[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Performance Impact**: Additional bounds checks add minimal overhead[0m            [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: The checks are simple integer comparisons with negligible [0m     [2m                [0m
[2;36m                    [0m         [39mperformance impact[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Behavior Changes**: Function may return earlier for invalid data[0m               [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: This is the correct behavior - failing fast on invalid input [0m  [2m                [0m
[2;36m                    [0m         [39mis a security best practice[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix directly mirrors the implementations in:[0m                                   [2m                [0m
[2;36m                    [0m         [39m- `[0m[35m/src/libexif/libexif/canon/[0m[95mexif-mnote-data-canon.c[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m218[0m[39m, [0m[1;36m250[0m[39m, [0m[1;36m267[0m[39m-[0m[1;36m273[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [1;36m292[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m- `[0m[35m/src/libexif/libexif/olympus/[0m[95mexif-mnote-data-olympus.c[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m404[0m[39m, [0m[1;36m436[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m-[0m[1;36m464[0m[39m, [0m[1;36m492[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- `[0m[35m/src/libexif/libexif/pentax/[0m[95mexif-mnote-data-pentax.c[0m[39m`[0m                            [2m                [0m
[2;36m                    [0m         [39m- `[0m[35m/src/libexif/libexif/fuji/[0m[95mexif-mnote-data-fuji.c[0m[39m`[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAll these implementations use identical CHECKOVERFLOW macros and follow the same [0m   [2m                [0m
[2;36m                    [0m         [39mvalidation pattern, demonstrating that this approach is the established standard in[0m [2m                [0m
[2;36m                    [0m         [39mthis codebase for safe MakerNote parsing.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=657046;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=542367;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=61985;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=825521;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpjeov_but[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/libexif_ex-delta-01_exif-005/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1767848466.5333672[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/libexif_ex-delta-01_exif-[1;36m005.[0mtoml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-libexif[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/08/26 05:01:08][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mlibexif[0m        ]8;id=468475;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=91842;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=182408;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=587701;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mlibexif[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=999202;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=150905;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m                [2m               [0m
