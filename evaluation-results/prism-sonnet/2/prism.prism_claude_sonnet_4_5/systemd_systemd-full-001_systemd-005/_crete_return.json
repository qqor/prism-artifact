{
  "project_name": "systemd",
  "vulnerability_identifier": "systemd_systemd-full-001_systemd-005",
  "source_directory": "/home/qqor/crete/.cache/official-afc-systemd",
  "llm_usage": {
    "total_cost": 1.194879,
    "prompt_tokens": 276448,
    "completion_tokens": 24369
  },
  "variant": "sound",
  "diff": "--- a/src/systemctl/systemctl.c\n+++ b/src/systemctl/systemctl.c\n@@ -127,20 +127,32 @@\n const char *arg_drop_in = NULL;\n ImagePolicy *arg_image_policy = NULL;\n \n+static void freep_and_nullify(void *p) {\n+        char **pp = (char **) p;\n+        free(*pp);\n+        *pp = NULL;\n+}\n+\n+static void image_policy_freep_and_nullify(void *p) {\n+        ImagePolicy **pp = (ImagePolicy **) p;\n+        image_policy_free(*pp);\n+        *pp = NULL;\n+}\n+\n STATIC_DESTRUCTOR_REGISTER(arg_types, strv_freep);\n STATIC_DESTRUCTOR_REGISTER(arg_states, strv_freep);\n STATIC_DESTRUCTOR_REGISTER(arg_properties, strv_freep);\n STATIC_DESTRUCTOR_REGISTER(_arg_job_mode, unsetp);\n STATIC_DESTRUCTOR_REGISTER(arg_wall, strv_freep);\n STATIC_DESTRUCTOR_REGISTER(arg_kill_whom, unsetp);\n-STATIC_DESTRUCTOR_REGISTER(arg_root, freep);\n-STATIC_DESTRUCTOR_REGISTER(arg_image, freep);\n+STATIC_DESTRUCTOR_REGISTER(arg_root, freep_and_nullify);\n+STATIC_DESTRUCTOR_REGISTER(arg_image, freep_and_nullify);\n STATIC_DESTRUCTOR_REGISTER(arg_reboot_argument, unsetp);\n STATIC_DESTRUCTOR_REGISTER(arg_host, unsetp);\n STATIC_DESTRUCTOR_REGISTER(arg_boot_loader_entry, unsetp);\n STATIC_DESTRUCTOR_REGISTER(arg_clean_what, strv_freep);\n STATIC_DESTRUCTOR_REGISTER(arg_drop_in, unsetp);\n-STATIC_DESTRUCTOR_REGISTER(arg_image_policy, image_policy_freep);\n+STATIC_DESTRUCTOR_REGISTER(arg_image_policy, image_policy_freep_and_nullify);\n \n static int systemctl_help(void) {\n         _cleanup_free_ char *link = NULL;\n",
  "stdout": "",
  "stderr": ""
}