[2;36m[01/08/26 13:18:40][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=599705;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=204711;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpyfce4iv7[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/systemd_systemd-full-001_syst[0m [2m               [0m
[2;36m                    [0m         [35memd-005/[0m[95magent-output-1767878320.0798922[0m                                              [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/systemd_systemd-full-001_systemd-[1;36m005.[0mtoml           [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-systemd[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Building Cached for CLEAN environment[1m)[0m           ]8;id=422736;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=847755;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/08/26 13:20:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Building Cached for CLEAN environment[1m)[0m Took     ]8;id=191555;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=970440;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m80.07[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=40933;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=372515;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running tests for Cached for CLEAN environment[1m)[0m ]8;id=558455;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=174185;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=265154;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=287705;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m80[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=832238;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=822915;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 13:20:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.96[0m seconds;               ]8;id=313361;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=958988;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/08/26 13:20:03][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=285165;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=145641;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=305017;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=731860;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=844355;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=31175;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=720579;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=586365;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 13:20:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m1.36[0m seconds;               ]8;id=754386;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=639779;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/08/26 13:20:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=717899;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=785859;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 13:20:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.92[0m seconds;               ]8;id=203839;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=383850;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/08/26 13:20:08][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=204436;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=604887;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m-systemctl-parse-argv                                                  [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer fuzz-systemctl-parse-argv -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                          [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-systemctl-parse-argv[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m   [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                             [2m                [0m
[2;36m                    [0m         INFO: Seed: [1;36m1149568460[0m                                                              [2m                [0m
[2;36m                    [0m         INFO: Loaded [1;36m2[0m modules   [1m([0m[1;36m100324[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m94611[0m [1m[[0m[1;36m0x7fe0056ae920[0m,     [2m                [0m
[2;36m                    [0m         [1;36m0x7fe0056c5ab3[0m[1m)[0m, [1;36m5713[0m [1m[[0m[1;36m0x55abaf5bc598[0m, [1;36m0x55abaf5bdbe9[0m[1m)[0m,                             [2m                [0m
[2;36m                    [0m         INFO: Loaded [1;36m2[0m PC tables [1m([0m[1;36m100324[0m PCs[1m)[0m: [1;36m94611[0m [1m[[0m[1;36m0x7fe0056c5ab8[0m,[1;36m0x7fe0058373e8[0m[1m)[0m, [1;36m5713[0m  [2m                [0m
[2;36m                    [0m         [1m[[0m[1;36m0x55abaf5bdbf0[0m,[1;36m0x55abaf5d4100[0m[1m)[0m,                                                    [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-systemctl-parse-argv[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                  [2m                [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         =================================================================                   [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: attempting double-free on [1;36m0x502000007310[0m in thread   [2m                [0m
[2;36m                    [0m         T0:                                                                                 [2m                [0m
[2;36m                    [0m         SCARINESS: [1;36m42[0m [1m([0mdouble-free[1m)[0m                                                         [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55abaf404956[0m in free                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m:[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x7fe0050c6dd3[0m in parse_path_argument                                        [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/shared/[0m[95mparse-argument.c[0m:[1;92m68:24[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55abaf4969ad[0m in systemctl_parse_argv                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95msystemctl.c[0m:[1;92m732:29[0m                      [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55abaf444698[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95mfuzz-systemctl-parse-argv.c[0m:[1;92m58:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55abaf4b8050[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55abaf4a32c5[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55abaf4a8d5f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55abaf4d4002[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x7fe004744082[0m in __libc_start_main                                          [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55abaf36bbdd[0m in _start [1m([0m[35m/out/[0m[95mfuzz-systemctl-parse-argv+0x8cbdd[0m[1m)[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: __interceptor_free--parse_path_argument--systemctl_parse_argv          [2m                [0m
[2;36m                    [0m         [1;36m0x502000007310[0m is located [1;36m0[0m bytes inside of [1;36m16[0m-byte region                          [2m                [0m
[2;36m                    [0m         [1m[[0m[1;36m0x502000007310[0m,[1;36m0x502000007320[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m         freed by thread T0 here:                                                            [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55abaf404956[0m in free                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m:[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55abaf4448f1[0m in static_destruct                                            [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mstatic-destruct.h[0m:[1;92m95:25[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55abaf4448f1[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95mfuzz-systemctl-parse-argv.c[0m:[1;92m74:9[0m        [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55abaf4b8050[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55abaf4a32c5[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55abaf4a8d5f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55abaf4d4002[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x7fe004744082[0m in __libc_start_main                                          [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: __interceptor_free--static_destruct--LLVMFuzzerTestOneInput            [2m                [0m
[2;36m                    [0m         previously allocated by thread T0 here:                                             [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55abaf404fdc[0m in realloc                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m:[1;92m82:3[0m                   [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x7fe0051f626e[0m in path_extend_internal                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mpath-util.c[0m:[1;92m585:14[0m                          [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x7fe0051f68c4[0m in path_make_absolute_cwd                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mpath-util.c[0m:[1;92m92:21[0m                           [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x7fe0050c6e16[0m in parse_path_argument                                        [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/shared/[0m[95mparse-argument.c[0m:[1;92m72:13[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55abaf4969ad[0m in systemctl_parse_argv                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95msystemctl.c[0m:[1;92m732:29[0m                      [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55abaf444698[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95mfuzz-systemctl-parse-argv.c[0m:[1;92m58:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55abaf4b8050[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55abaf4a32c5[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55abaf4a8d5f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55abaf4d4002[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x7fe004744082[0m in __libc_start_main                                         [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: __interceptor_realloc--path_extend_internal--path_make_absolute_cwd    [2m                [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: double-free                                              [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/shared/[0m[95mparse-argument.c[0m:[1;92m68:24[0m in                  [2m                [0m
[2;36m                    [0m         parse_path_argument                                                                 [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp3j3y1eq_[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         fuzz-systemctl-parse-argv -[33mruns[0m=[1;36m100[0m.                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m-systemctl-parse-argv                                                  [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer fuzz-systemctl-parse-argv -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                          [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-systemctl-parse-argv[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m   [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m < [35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         INFO: Running with entropic power schedule [1m([0m[1;36m0xFF[0m, [1;36m100[0m[1m)[0m.                             [2m                [0m
[2;36m                    [0m         INFO: Seed: [1;36m1149568460[0m                                                              [2m                [0m
[2;36m                    [0m         INFO: Loaded [1;36m2[0m modules   [1m([0m[1;36m100324[0m inline [1;36m8[0m-bit counters[1m)[0m: [1;36m94611[0m [1m[[0m[1;36m0x7fe0056ae920[0m,     [2m                [0m
[2;36m                    [0m         [1;36m0x7fe0056c5ab3[0m[1m)[0m, [1;36m5713[0m [1m[[0m[1;36m0x55abaf5bc598[0m, [1;36m0x55abaf5bdbe9[0m[1m)[0m,                             [2m                [0m
[2;36m                    [0m         INFO: Loaded [1;36m2[0m PC tables [1m([0m[1;36m100324[0m PCs[1m)[0m: [1;36m94611[0m [1m[[0m[1;36m0x7fe0056c5ab8[0m,[1;36m0x7fe0058373e8[0m[1m)[0m, [1;36m5713[0m  [2m                [0m
[2;36m                    [0m         [1m[[0m[1;36m0x55abaf5bdbf0[0m,[1;36m0x55abaf5d4100[0m[1m)[0m,                                                    [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-systemctl-parse-argv[0m: Running [1;36m1[0m inputs [1;36m100[0m [1;35mtime[0m[1m([0ms[1m)[0m each.                  [2m                [0m
[2;36m                    [0m         Running: [35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         =================================================================                   [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: attempting double-free on [1;36m0x502000007310[0m in thread   [2m                [0m
[2;36m                    [0m         T0:                                                                                 [2m                [0m
[2;36m                    [0m         SCARINESS: [1;36m42[0m [1m([0mdouble-free[1m)[0m                                                         [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55abaf404956[0m in free                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m:[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x7fe0050c6dd3[0m in parse_path_argument                                        [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/shared/[0m[95mparse-argument.c[0m:[1;92m68:24[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55abaf4969ad[0m in systemctl_parse_argv                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95msystemctl.c[0m:[1;92m732:29[0m                      [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55abaf444698[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95mfuzz-systemctl-parse-argv.c[0m:[1;92m58:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55abaf4b8050[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55abaf4a32c5[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55abaf4a8d5f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55abaf4d4002[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x7fe004744082[0m in __libc_start_main                                          [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55abaf36bbdd[0m in _start [1m([0m[35m/out/[0m[95mfuzz-systemctl-parse-argv+0x8cbdd[0m[1m)[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: __interceptor_free--parse_path_argument--systemctl_parse_argv          [2m                [0m
[2;36m                    [0m         [1;36m0x502000007310[0m is located [1;36m0[0m bytes inside of [1;36m16[0m-byte region                          [2m                [0m
[2;36m                    [0m         [1m[[0m[1;36m0x502000007310[0m,[1;36m0x502000007320[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m         freed by thread T0 here:                                                            [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55abaf404956[0m in free                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m:[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x55abaf4448f1[0m in static_destruct                                            [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mstatic-destruct.h[0m:[1;92m95:25[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x55abaf4448f1[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95mfuzz-systemctl-parse-argv.c[0m:[1;92m74:9[0m        [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x55abaf4b8050[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55abaf4a32c5[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55abaf4a8d5f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55abaf4d4002[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x7fe004744082[0m in __libc_start_main                                          [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: __interceptor_free--static_destruct--LLVMFuzzerTestOneInput            [2m                [0m
[2;36m                    [0m         previously allocated by thread T0 here:                                             [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x55abaf404fdc[0m in realloc                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m:[1;92m82:3[0m                   [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x7fe0051f626e[0m in path_extend_internal                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mpath-util.c[0m:[1;92m585:14[0m                          [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x7fe0051f68c4[0m in path_make_absolute_cwd                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mpath-util.c[0m:[1;92m92:21[0m                           [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x7fe0050c6e16[0m in parse_path_argument                                        [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/shared/[0m[95mparse-argument.c[0m:[1;92m72:13[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x55abaf4969ad[0m in systemctl_parse_argv                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95msystemctl.c[0m:[1;92m732:29[0m                      [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x55abaf444698[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95mfuzz-systemctl-parse-argv.c[0m:[1;92m58:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x55abaf4b8050[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x55abaf4a32c5[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x55abaf4a8d5f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x55abaf4d4002[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x7fe004744082[0m in __libc_start_main                                         [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: __interceptor_realloc--path_extend_internal--path_make_absolute_cwd    [2m                [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: double-free                                              [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/shared/[0m[95mparse-argument.c[0m:[1;92m68:24[0m in                  [2m                [0m
[2;36m                    [0m         parse_path_argument                                                                 [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp3j3y1eq_[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         fuzz-systemctl-parse-argv -[33mruns[0m=[1;36m100[0m.                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/08/26 13:20:31][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=77019;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=116089;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/08/26 13:25:42][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=477511;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=575635;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/08/26 13:27:57][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=485105;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=724607;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=137995;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=196706;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 13:27:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.99[0m seconds;               ]8;id=183147;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=999844;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Patching[1m)[0m Started[33m...[0m                             ]8;id=606205;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=164639;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp2rakpqm0[0m                                                 ]8;id=83922;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=75592;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/08/26 13:29:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Patching[1m)[0m Took [1;36m65.74[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=353997;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=753878;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Checking build[1m)[0m Started[33m...[0m                       ]8;id=236228;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=234761;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 13:29:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Checking build[1m)[0m Took [1;36m11.47[0m seconds;             ]8;id=833246;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=819642;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running PoV[1m)[0m Started[33m...[0m                          ]8;id=244998;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=420217;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 13:29:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running PoV[1m)[0m Took [1;36m2.15[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=396947;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=755131;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Testing[1m)[0m Started[33m...[0m                              ]8;id=923448;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=962490;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=88123;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=149621;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=199697;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=46721;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 13:29:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.98[0m seconds;               ]8;id=243944;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=939277;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/08/26 13:29:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=261761;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=942032;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 13:29:22][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.99[0m seconds;               ]8;id=579629;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=51333;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=233447;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=52116;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 13:29:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.89[0m seconds;               ]8;id=730899;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=604528;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=928100;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=395265;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/systemctl/systemctl.c                                                     [2m                [0m
[2;36m                    [0m         +++ b/src/systemctl/systemctl.c                                                     [2m                [0m
[2;36m                    [0m         @@ [1;36m-127[0m,[1;36m20[0m +[1;36m127[0m,[1;36m32[0m @@                                                               [2m                [0m
[2;36m                    [0m          const char *arg_drop_in = NULL;                                                    [2m                [0m
[2;36m                    [0m          ImagePolicy *arg_image_policy = NULL;                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +static void [1;35mfreep_and_nullify[0m[1m([0mvoid *p[1m)[0m [1m{[0m                                           [2m                [0m
[2;36m                    [0m         +        char **pp = [1m([0mchar **[1m)[0m p;                                                   [2m                [0m
[2;36m                    [0m         +        [1;35mfree[0m[1m([0m*pp[1m)[0m;                                                                 [2m                [0m
[2;36m                    [0m         +        *pp = NULL;                                                                [2m                [0m
[2;36m                    [0m         +[1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +static void [1;35mimage_policy_freep_and_nullify[0m[1m([0mvoid *p[1m)[0m [1m{[0m                              [2m                [0m
[2;36m                    [0m         +        ImagePolicy **pp = [1m([0mImagePolicy **[1m)[0m p;                                     [2m                [0m
[2;36m                    [0m         +        [1;35mimage_policy_free[0m[1m([0m*pp[1m)[0m;                                                    [2m                [0m
[2;36m                    [0m         +        *pp = NULL;                                                                [2m                [0m
[2;36m                    [0m         +[1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m          [1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_types, strv_freep[1m)[0m;                                 [2m                [0m
[2;36m                    [0m          [1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_states, strv_freep[1m)[0m;                                [2m                [0m
[2;36m                    [0m          [1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_properties, strv_freep[1m)[0m;                            [2m                [0m
[2;36m                    [0m          [1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0m_arg_job_mode, unsetp[1m)[0m;                                 [2m                [0m
[2;36m                    [0m          [1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_wall, strv_freep[1m)[0m;                                  [2m                [0m
[2;36m                    [0m          [1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_kill_whom, unsetp[1m)[0m;                                 [2m                [0m
[2;36m                    [0m         -[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_root, freep[1m)[0m;                                       [2m                [0m
[2;36m                    [0m         -[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_image, freep[1m)[0m;                                      [2m                [0m
[2;36m                    [0m         +[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_root, freep_and_nullify[1m)[0m;                           [2m                [0m
[2;36m                    [0m         +[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_image, freep_and_nullify[1m)[0m;                          [2m                [0m
[2;36m                    [0m          [1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_reboot_argument, unsetp[1m)[0m;                           [2m                [0m
[2;36m                    [0m          [1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_host, unsetp[1m)[0m;                                      [2m                [0m
[2;36m                    [0m          [1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_boot_loader_entry, unsetp[1m)[0m;                         [2m                [0m
[2;36m                    [0m          [1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_clean_what, strv_freep[1m)[0m;                            [2m                [0m
[2;36m                    [0m          [1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_drop_in, unsetp[1m)[0m;                                   [2m                [0m
[2;36m                    [0m         -[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_image_policy, image_policy_freep[1m)[0m;                  [2m                [0m
[2;36m                    [0m         +[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1m([0marg_image_policy, image_policy_freep_and_nullify[1m)[0m;      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static int [1;35msystemctl_help[0m[1m([0mvoid[1m)[0m [1m{[0m                                                  [2m                [0m
[2;36m                    [0m                  _cleanup_free_ char *link = NULL;                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m-systemctl-parse-argv                                                  [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer fuzz-systemctl-parse-argv -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                          [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-systemctl-parse-argv[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m   [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1149568460[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m100324[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7fe0056ae920[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x7fe0056c5ab3[0m[1;39m)[0m[39m, [0m[1;36m5713[0m[39m [0m[1;39m[[0m[1;36m0x55abaf5bc598[0m[39m, [0m[1;36m0x55abaf5bdbe9[0m[1;39m)[0m[39m, [0m                            [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m100324[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7fe0056c5ab8[0m[39m,[0m[1;36m0x7fe0058373e8[0m[1;39m)[0m[39m, [0m[1;36m5713[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x55abaf5bdbf0[0m[39m,[0m[1;36m0x55abaf5d4100[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-systemctl-parse-argv[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                  [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: attempting double-free on [0m[1;36m0x502000007310[0m[39m in thread [0m  [2m                [0m
[2;36m                    [0m         [39mT0:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m42[0m[39m [0m[1;39m([0m[39mdouble-free[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55abaf404956[0m[39m in free [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe0050c6dd3[0m[39m in parse_path_argument [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/shared/[0m[95mparse-argument.c[0m[39m:[0m[1;92m68:24[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55abaf4969ad[0m[39m in systemctl_parse_argv [0m                                      [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95msystemctl.c[0m[39m:[0m[1;92m732:29[0m                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55abaf444698[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95mfuzz-systemctl-parse-argv.c[0m[39m:[0m[1;92m58:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55abaf4b8050[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55abaf4a32c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55abaf4a8d5f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55abaf4d4002[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x7fe004744082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55abaf36bbdd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-systemctl-parse-argv+0x8cbdd[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_free--parse_path_argument--systemctl_parse_argv[0m          [2m                [0m
[2;36m                    [0m         [1;36m0x502000007310[0m[39m is located [0m[1;36m0[0m[39m bytes inside of [0m[1;36m16[0m[39m-byte region [0m                         [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x502000007310[0m[39m,[0m[1;36m0x502000007320[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mfreed by thread T0 here:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55abaf404956[0m[39m in free [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55abaf4448f1[0m[39m in static_destruct [0m                                           [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mstatic-destruct.h[0m[39m:[0m[1;92m95:25[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55abaf4448f1[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95mfuzz-systemctl-parse-argv.c[0m[39m:[0m[1;92m74:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55abaf4b8050[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55abaf4a32c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55abaf4a8d5f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55abaf4d4002[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fe004744082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_free--static_destruct--LLVMFuzzerTestOneInput[0m            [2m                [0m
[2;36m                    [0m         [39mpreviously allocated by thread T0 here:[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55abaf404fdc[0m[39m in realloc [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m82:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe0051f626e[0m[39m in path_extend_internal [0m                                      [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mpath-util.c[0m[39m:[0m[1;92m585:14[0m                          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x7fe0051f68c4[0m[39m in path_make_absolute_cwd [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mpath-util.c[0m[39m:[0m[1;92m92:21[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x7fe0050c6e16[0m[39m in parse_path_argument [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/shared/[0m[95mparse-argument.c[0m[39m:[0m[1;92m72:13[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55abaf4969ad[0m[39m in systemctl_parse_argv [0m                                      [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95msystemctl.c[0m[39m:[0m[1;92m732:29[0m                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55abaf444698[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95mfuzz-systemctl-parse-argv.c[0m[39m:[0m[1;92m58:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55abaf4b8050[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55abaf4a32c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55abaf4a8d5f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55abaf4d4002[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fe004744082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_realloc--path_extend_internal--path_make_absolute_cwd[0m    [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: double-free [0m                                             [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/shared/[0m[95mparse-argument.c[0m[39m:[0m[1;92m68:24[0m[39m in [0m                 [2m                [0m
[2;36m                    [0m         [39mparse_path_argument[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp3j3y1eq_[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz-systemctl-parse-argv -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA double-free memory vulnerability [0m[1;39m([0m[39mAddressSanitizer error[0m[1;39m)[0m[39m has been detected in [0m   [2m                [0m
[2;36m                    [0m         [39mthe systemd codebase during fuzzing of the `fuzz-systemctl-parse-argv` component. [0m  [2m                [0m
[2;36m                    [0m         [39mThe issue occurs when attempting to free memory at address `[0m[1;36m0x502000007310[0m[39m` that [0m   [2m                [0m
[2;36m                    [0m         [39mhas already been freed, resulting in a crash with a SCARINESS score of [0m[1;36m42[0m[39m. The [0m     [2m                [0m
[2;36m                    [0m         [39mvulnerability is triggered through the `parse_path_argument` function during [0m       [2m                [0m
[2;36m                    [0m         [39margument parsing in systemctl.[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Overview[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mThe issue manifests as an AddressSanitizer double-free error during fuzzing tests [0m  [2m                [0m
[2;36m                    [0m         [39mof the systemctl argument parsing functionality. The error occurs when the same [0m    [2m                [0m
[2;36m                    [0m         [39mmemory location is freed twice, which is a critical memory safety violation that [0m   [2m                [0m
[2;36m                    [0m         [39mcan lead to program crashes and potential security vulnerabilities.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is a **double-free vulnerability**, where memory at a specific address is [0m     [2m                [0m
[2;36m                    [0m         [39mdeallocated twice. Double-free vulnerabilities are classified as memory corruption [0m [2m                [0m
[2;36m                    [0m         [39missues and can potentially be exploited to:[0m                                         [2m                [0m
[2;36m                    [0m         [39m- Cause denial of service through program crashes[0m                                   [2m                [0m
[2;36m                    [0m         [39m- Potentially lead to arbitrary code execution in certain circumstances[0m             [2m                [0m
[2;36m                    [0m         [39m- Corrupt heap metadata[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Stack Trace Analysis[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**First Free Operation:**[0m                                                           [2m                [0m
[2;36m                    [0m         [39mThe initial free occurs in the cleanup path at:[0m                                     [2m                [0m
[2;36m                    [0m         [39m- `static_destruct` in `src/systemctl/fuzz-systemctl-parse-argv.[0m[1;92mc:74[0m[39m`[0m               [2m                [0m
[2;36m                    [0m         [39m- This is part of the fuzzer test cleanup routine[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Second Free Operation [0m[1;39m([0m[39mDouble-Free[0m[1;39m)[0m[39m:**[0m                                            [2m                [0m
[2;36m                    [0m         [39mThe problematic second free attempt occurs at:[0m                                      [2m                [0m
[2;36m                    [0m         [39m- `parse_path_argument` in `src/shared/parse-argument.[0m[1;92mc:68[0m[39m`[0m                         [2m                [0m
[2;36m                    [0m         [39m- Called from `systemctl_parse_argv` in `src/systemctl/systemctl.[0m[1;92mc:732[0m[39m`[0m             [2m                [0m
[2;36m                    [0m         [39m- Triggered during the fuzzer test input processing at [0m                             [2m                [0m
[2;36m                    [0m         [39m`fuzz-systemctl-parse-argv.[0m[1;92mc:58[0m[39m`[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Original Allocation:**[0m                                                            [2m                [0m
[2;36m                    [0m         [39mThe memory was originally allocated through:[0m                                        [2m                [0m
[2;36m                    [0m         [39m- `realloc` called from `path_extend_internal` in `src/basic/path-util.[0m[1;92mc:585[0m[39m`[0m       [2m                [0m
[2;36m                    [0m         [39m- Via `path_make_absolute_cwd` in `src/basic/path-util.[0m[1;92mc:92[0m[39m`[0m                        [2m                [0m
[2;36m                    [0m         [39m- Leading to `parse_path_argument` in `src/shared/parse-argument.[0m[1;92mc:72[0m[39m`[0m              [2m                [0m
[2;36m                    [0m         [39m- Initiated from `systemctl_parse_argv` in `src/systemctl/systemctl.[0m[1;92mc:732[0m[39m`[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Memory Region**: The affected memory is a [0m[1;36m16[0m[39m-byte region starting at address [0m  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;36m0x502000007310[0m[39m`[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Call Flow**: The issue involves a path argument parsing workflow:[0m              [2m                [0m
[2;36m                    [0m         [39m   - Memory is allocated during path argument processing[0m                            [2m                [0m
[2;36m                    [0m         [39m   - The path is made absolute using `path_make_absolute_cwd`[0m                       [2m                [0m
[2;36m                    [0m         [39m   - Memory is freed once during normal cleanup in `parse_path_argument`[0m            [2m                [0m
[2;36m                    [0m         [39m   - Memory is freed again during the static destructor cleanup in the fuzzer [0m      [2m                [0m
[2;36m                    [0m         [39mharness[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Affected Components**:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - Path parsing utilities [0m[1;39m([0m[39m`src/basic/path-util.c`[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Argument parsing shared code [0m[1;39m([0m[39m`src/shared/parse-argument.c`[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m   - Systemctl main functionality [0m[1;39m([0m[39m`src/systemctl/systemctl.c`[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Fuzzer test harness [0m[1;39m([0m[39m`src/systemctl/fuzz-systemctl-parse-argv.c`[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Code Areas Requiring Investigation[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a holistic view of this issue, the following components should be [0m        [2m                [0m
[2;36m                    [0m         [39mexamined:[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **`src/shared/parse-argument.c`** [0m[1;39m([0m[39mline [0m[1;36m68[0m[39m, [0m[1;36m72[0m[1;39m)[0m[39m:[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - The `parse_path_argument` function's memory management logic[0m                   [2m                [0m
[2;36m                    [0m         [39m   - How memory ownership is handled for parsed path arguments[0m                      [2m                [0m
[2;36m                    [0m         [39m   - Whether the function is responsible for freeing allocated memory[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **`src/systemctl/systemctl.c`** [0m[1;39m([0m[39mline [0m[1;36m732[0m[1;39m)[0m[39m:[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - The `systemctl_parse_argv` function's handling of path arguments[0m               [2m                [0m
[2;36m                    [0m         [39m   - Memory ownership semantics for parsed arguments[0m                                [2m                [0m
[2;36m                    [0m         [39m   - How parsed arguments are stored and managed[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **`src/basic/path-util.c`** [0m[1;39m([0m[39mlines [0m[1;36m92[0m[39m, [0m[1;36m585[0m[1;39m)[0m[39m:[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - The `path_make_absolute_cwd` and `path_extend_internal` functions[0m              [2m                [0m
[2;36m                    [0m         [39m   - Memory allocation and ownership transfer patterns[0m                              [2m                [0m
[2;36m                    [0m         [39m   - Whether allocated memory is intended to be owned by the caller[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **`src/basic/static-destruct.h`** [0m[1;39m([0m[39mline [0m[1;36m95[0m[1;39m)[0m[39m:[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - The static destructor mechanism used in the fuzzer[0m                             [2m                [0m
[2;36m                    [0m         [39m   - How cleanup is performed for static/global resources[0m                           [2m                [0m
[2;36m                    [0m         [39m   - Whether there's a conflict between automatic cleanup and explicit cleanup[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **`src/systemctl/fuzz-systemctl-parse-argv.c`** [0m[1;39m([0m[39mlines [0m[1;36m58[0m[39m, [0m[1;36m74[0m[1;39m)[0m[39m:[0m                  [2m                [0m
[2;36m                    [0m         [39m   - The fuzzer harness implementation[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - Initialization and cleanup patterns[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Whether the harness correctly handles memory lifecycle for parsed arguments[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe investigation should focus on understanding the intended memory ownership [0m      [2m                [0m
[2;36m                    [0m         [39msemantics throughout this call chain and identifying where the ownership contract [0m  [2m                [0m
[2;36m                    [0m         [39mis violated, leading to the double-free condition.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m[39m-systemctl-parse-argv[0m                                                  [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz-systemctl-parse-argv -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                          [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-systemctl-parse-argv[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1149568460[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m100324[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7fe0056ae920[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x7fe0056c5ab3[0m[1;39m)[0m[39m, [0m[1;36m5713[0m[39m [0m[1;39m[[0m[1;36m0x55abaf5bc598[0m[39m, [0m[1;36m0x55abaf5bdbe9[0m[1;39m)[0m[39m, [0m                            [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m100324[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7fe0056c5ab8[0m[39m,[0m[1;36m0x7fe0058373e8[0m[1;39m)[0m[39m, [0m[1;36m5713[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x55abaf5bdbf0[0m[39m,[0m[1;36m0x55abaf5d4100[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-systemctl-parse-argv[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                  [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: attempting double-free on [0m[1;36m0x502000007310[0m[39m in thread [0m  [2m                [0m
[2;36m                    [0m         [39mT0:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m42[0m[39m [0m[1;39m([0m[39mdouble-free[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55abaf404956[0m[39m in free [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe0050c6dd3[0m[39m in parse_path_argument [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/shared/[0m[95mparse-argument.c[0m[39m:[0m[1;92m68:24[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55abaf4969ad[0m[39m in systemctl_parse_argv [0m                                      [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95msystemctl.c[0m[39m:[0m[1;92m732:29[0m                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55abaf444698[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95mfuzz-systemctl-parse-argv.c[0m[39m:[0m[1;92m58:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55abaf4b8050[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55abaf4a32c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55abaf4a8d5f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55abaf4d4002[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x7fe004744082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55abaf36bbdd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-systemctl-parse-argv+0x8cbdd[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_free--parse_path_argument--systemctl_parse_argv[0m          [2m                [0m
[2;36m                    [0m         [1;36m0x502000007310[0m[39m is located [0m[1;36m0[0m[39m bytes inside of [0m[1;36m16[0m[39m-byte region [0m                         [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x502000007310[0m[39m,[0m[1;36m0x502000007320[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mfreed by thread T0 here:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55abaf404956[0m[39m in free [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m52:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55abaf4448f1[0m[39m in static_destruct [0m                                           [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mstatic-destruct.h[0m[39m:[0m[1;92m95:25[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55abaf4448f1[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95mfuzz-systemctl-parse-argv.c[0m[39m:[0m[1;92m74:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55abaf4b8050[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55abaf4a32c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55abaf4a8d5f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55abaf4d4002[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fe004744082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_free--static_destruct--LLVMFuzzerTestOneInput[0m            [2m                [0m
[2;36m                    [0m         [39mpreviously allocated by thread T0 here:[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55abaf404fdc[0m[39m in realloc [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m82:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x7fe0051f626e[0m[39m in path_extend_internal [0m                                      [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mpath-util.c[0m[39m:[0m[1;92m585:14[0m                          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x7fe0051f68c4[0m[39m in path_make_absolute_cwd [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/basic/[0m[95mpath-util.c[0m[39m:[0m[1;92m92:21[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x7fe0050c6e16[0m[39m in parse_path_argument [0m                                       [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/shared/[0m[95mparse-argument.c[0m[39m:[0m[1;92m72:13[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55abaf4969ad[0m[39m in systemctl_parse_argv [0m                                      [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95msystemctl.c[0m[39m:[0m[1;92m732:29[0m                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55abaf444698[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/systemctl/[0m[95mfuzz-systemctl-parse-argv.c[0m[39m:[0m[1;92m58:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55abaf4b8050[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55abaf4a32c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55abaf4a8d5f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55abaf4d4002[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7fe004744082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_realloc--path_extend_internal--path_make_absolute_cwd[0m    [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: double-free [0m                                             [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/shared/[0m[95mparse-argument.c[0m[39m:[0m[1;92m68:24[0m[39m in [0m                 [2m                [0m
[2;36m                    [0m         [39mparse_path_argument[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp3j3y1eq_[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz-systemctl-parse-argv -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/fuzz-systemctl-parse-argv.[0m[1;92mc:1[0m[39m-[0m[1;36m77[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include <stdio.h>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#include <unistd.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#include [0m[32m"env-util.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include [0m[32m"fd-util.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"fuzz.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"nulstr-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#include [0m[32m"selinux-util.h"[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include [0m[32m"static-destruct.h"[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include [0m[32m"stdio-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include [0m[32m"strv.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#include [0m[32m"systemctl.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#include [0m[32m"systemctl-util.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:int [0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t *data, size_t size[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:        _cleanup_strv_free_ char **argv = NULL;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:        _cleanup_close_ int orig_stdout_fd = -EBADF;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        if [0m[1;39m([0m[39msize > [0m[1;36m16[0m[39m*[0m[1;36m1024[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:                return [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* See the comment below about the limit for [0m          [2m                [0m
[2;36m                    [0m         [1;35mstrv_length[0m[1;39m([0m[1;39m)[0m[39m. *[0m[35m/[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        [0m[1;35mfuzz_setup_logging[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:        arg_pager_flags = PAGER_DISABLE; [0m[35m/[0m[39m* We shouldn't execute the pager *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:        argv = [0m[1;35mstrv_parse_nulstr[0m[1;39m([0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39mdata, size[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        if [0m[1;39m([0m[39m!argv[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:        if [0m[1;39m([0m[39m!argv[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:                return [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* argv[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m should always be present, but may be [0m       [2m                [0m
[2;36m                    [0m         [39mzero-length. *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        if [0m[1;39m([0m[1;35mstrv_length[0m[1;39m([0m[39margv[0m[1;39m)[0m[39m > [0m[1;36m1024[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:                return [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* oss-fuzz reports timeouts which are caused by [0m      [2m                [0m
[2;36m                    [0m         [39mappending to a very long strv.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:                           * The code is indeed not very efficient, but it's [0m    [2m                [0m
[2;36m                    [0m         [39mdesigned for normal command-line[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:                           * use, where we don't expect more than a dozen of [0m    [2m                [0m
[2;36m                    [0m         [39mentries. The fact that it is[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:                           * slow with ~100k entries is not particularly [0m        [2m                [0m
[2;36m                    [0m         [39minteresting. Let's just refuse such[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:                           * long command lines. *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        if [0m[1;39m([0m[1;35mgetenv_bool[0m[1;39m([0m[32m"SYSTEMD_FUZZ_OUT[0m[1;33mPUT[0m[32m"[0m[1;39m)[0m[39m <= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:                orig_stdout_fd = [0m[1;35mfcntl[0m[1;39m([0m[1;35mfileno[0m[1;39m([0m[39mstdout[0m[1;39m)[0m[39m, F_DUPFD_CLOEXEC, [0m[1;36m3[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                if [0m[1;39m([0m[39morig_stdout_fd < [0m[1;36m0[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                        [0m[1;35mlog_warning_errno[0m[1;39m([0m[39morig_stdout_fd, [0m[32m"Failed to duplicate [0m  [2m                [0m
[2;36m                    [0m         [32mfd 1: %m"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                else[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                        [0m[1;35massert_se[0m[1;39m([0m[1;35mfreopen[0m[1;39m([0m[32m"/dev/null"[0m[39m, [0m[32m"w"[0m[39m, stdout[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                opterr = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* do not print errors *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[35m/[0m[39m* We need to reset some global state manually here since libfuzzer [0m     [2m                [0m
[2;36m                    [0m         [39mfeeds a single process with[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:         * multiple inputs, so we might carry over state from previous [0m          [2m                [0m
[2;36m                    [0m         [39minvocations that can trigger[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:         * certain asserts. *[0m[35m/[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        optind = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* this tells the getopt machinery to reinitialize *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        arg_transport = BUS_TRANSPORT_LOCAL;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        r = [0m[1;35msystemctl_dispatch_parse_argv[0m[1;39m([0m[1;35mstrv_length[0m[1;39m([0m[39margv[0m[1;39m)[0m[39m, argv[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse args: %m"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                [0m[1;35mlog_info[0m[1;39m([0m[39mr == [0m[1;36m0[0m[39m ? [0m[32m"Done!"[0m[39m : [0m[32m"Action!"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        if [0m[1;39m([0m[39morig_stdout_fd >= [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[1;35mfreopen[0m[1;39m([0m[1;35mFORMAT_PROC_FD_PATH[0m[1;39m([0m[39morig_stdout_fd[0m[1;39m)[0m[39m, [0m[32m"w"[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mstdout[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mrelease_busses[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[39m* We open the bus for communication with logind.[0m      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                           * It needs to be closed to avoid apparent leaks. *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mmac_selinux_finish[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[35m/[0m[39m* Call static destructors to do global state cleanup. We do it here, [0m   [2m                [0m
[2;36m                    [0m         [39mand not in fuzz-main.c so that[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:         * any global state is destroyed between fuzzer runs. *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/shared/parse-argument.[0m[1;92mc:1[0m[39m-[0m[1;36m30[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include [0m[32m"format-table.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#include [0m[32m"parse-argument.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#include [0m[32m"path-util.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#include [0m[32m"signal-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include [0m[32m"stdio-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"string-table.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"string-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m[35m/[0m[39m* All functions in this file emit warnings. *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:int [0m[1;35mparse_boolean_argument[0m[1;39m([0m[39mconst char *optname, const char *s, bool *ret[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:        [0m[35m/[0m[39m* Returns the result through *ret and the return value. *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:        if [0m[1;39m([0m[39ms[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:                r = [0m[1;35mparse_boolean[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:                        return [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse boolean [0m      [2m                [0m
[2;36m                    [0m         [32margument to %s: %s."[0m[39m, optname, s[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:                if [0m[1;39m([0m[39mret[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:                        *ret = r;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:                return r;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:                [0m[35m/[0m[39m* s may be NULL. This is controlled by [0m[1;35mgetopt_long[0m[1;39m([0m[1;39m)[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39mparameters. *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:                if [0m[1;39m([0m[39mret[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:                        *ret = true;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:                return true;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/shared/parse-argument.[0m[1;92mc:60[0m[39m-[0m[1;36m85[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:         * This function is intended to be used in command line parsers, to [0m     [2m                [0m
[2;36m                    [0m         [39mhandle paths that are passed[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:         * in. It makes the path absolute, and reduces it to NULL if omitted or [0m [2m                [0m
[2;36m                    [0m         [39mroot [0m[1;39m([0m[39mthe latter optionally[0m[1;39m)[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:         *[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:         * NOTE THAT THIS WILL FREE THE PREVIOUS ARGUMENT POINTER ON SUCCESS![0m    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:         * Hence, do not pass in uninitialized pointers.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:         *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        if [0m[1;39m([0m[1;35misempty[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                *arg = [0m[1;35mmfree[0m[1;39m([0m[39m*arg[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        r = [0m[1;35mpath_make_absolute_cwd[0m[1;39m([0m[39mpath, &p[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                return [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse path \"%s\" and make [0m [2m                [0m
[2;36m                    [0m         [32mit absolute: %m"[0m[39m, path[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;35mpath_simplify[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        if [0m[1;39m([0m[39msuppress_root && [0m[1;35mempty_or_root[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                p = [0m[1;35mmfree[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        return [0m[1;35mfree_and_replace[0m[1;39m([0m[39m*arg, p[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:int [0m[1;35mparse_signal_argument[0m[1;39m([0m[39mconst char *s, int *ret[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:1[0m[39m-[0m[1;36m50[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include <getopt.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#include <locale.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#include <unistd.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include [0m[32m"sd-daemon.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"build.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#include [0m[32m"bus-util.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include [0m[32m"capsule-util.h"[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include [0m[32m"dissect-image.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include [0m[32m"install.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#include [0m[32m"logs-show.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#include [0m[32m"main-func.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:#include [0m[32m"mount-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:#include [0m[32m"output-mode.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:#include [0m[32m"pager.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:#include [0m[32m"parse-argument.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:#include [0m[32m"path-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#include [0m[32m"pretty-print.h"[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#include [0m[32m"process-util.h"[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#include [0m[32m"reboot-util.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include [0m[32m"rlimit-util.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include [0m[32m"signal-util.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include [0m[32m"stat-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include [0m[32m"string-table.h"[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include [0m[32m"systemctl-add-dependency.h"[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include [0m[32m"systemctl-cancel-job.h"[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#include [0m[32m"systemctl-clean-or-freeze.h"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#include [0m[32m"systemctl-compat-halt.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:#include [0m[32m"systemctl-compat-runlevel.h"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#include [0m[32m"systemctl-compat-shutdown.h"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#include [0m[32m"systemctl-compat-telinit.h"[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#include [0m[32m"systemctl-daemon-reload.h"[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#include [0m[32m"systemctl-edit.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:#include [0m[32m"systemctl-enable.h"[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#include [0m[32m"systemctl-is-active.h"[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#include [0m[32m"systemctl-is-enabled.h"[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:#include [0m[32m"systemctl-is-system-running.h"[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#include [0m[32m"systemctl-kill.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:#include [0m[32m"systemctl-list-dependencies.h"[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:#include [0m[32m"systemctl-list-jobs.h"[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:#include [0m[32m"systemctl-list-machines.h"[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:#include [0m[32m"systemctl-list-unit-files.h"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:#include [0m[32m"systemctl-list-units.h"[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:#include [0m[32m"systemctl-log-setting.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:#include [0m[32m"systemctl-logind.h"[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#include [0m[32m"systemctl-mount.h"[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:#include [0m[32m"systemctl-preset-all.h"[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:51[0m[39m-[0m[1;36m100[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#include [0m[32m"systemctl-reset-failed.h"[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:#include [0m[32m"systemctl-service-watchdogs.h"[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#include [0m[32m"systemctl-set-default.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#include [0m[32m"systemctl-set-environment.h"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:#include [0m[32m"systemctl-set-property.h"[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:#include [0m[32m"systemctl-show.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:#include [0m[32m"systemctl-start-special.h"[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:#include [0m[32m"systemctl-start-unit.h"[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:#include [0m[32m"systemctl-switch-root.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:#include [0m[32m"systemctl-sysv-compat.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:#include [0m[32m"systemctl-trivial-method.h"[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:#include [0m[32m"systemctl-util.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:#include [0m[32m"systemctl-whoami.h"[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:#include [0m[32m"systemctl.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:#include [0m[32m"terminal-util.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:#include [0m[32m"time-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:#include [0m[32m"user-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#include [0m[32m"verbs.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:#include [0m[32m"virt.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m71:c[0m[39mhar **arg_types = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m72:c[0m[39mhar **arg_states = NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m73:c[0m[39mhar **arg_properties = NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;92m74:b[0m[39mool arg_all = false;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;92m75:e[0m[39mnum dependency arg_dependency = DEPENDENCY_FORWARD;[0m                             [2m                [0m
[2;36m                    [0m         [1;92m76:c[0m[39monst char *_arg_job_mode = NULL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:RuntimeScope arg_runtime_scope = RUNTIME_SCOPE_SYSTEM;[0m                           [2m                [0m
[2;36m                    [0m         [1;92m78:b[0m[39mool arg_wait = false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m79:b[0m[39mool arg_no_block = false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:int arg_legend = [0m[1;36m-1[0m[39m; [0m[35m/[0m[39m* [0m[1;36m-1[0m[39m: true, unless --quiet is passed, [0m[1;36m1[0m[39m: true *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:PagerFlags arg_pager_flags = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;92m82:b[0m[39mool arg_no_wtmp = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m83:b[0m[39mool arg_no_sync = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m84:b[0m[39mool arg_no_wall = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m85:b[0m[39mool arg_no_reload = false;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;92m86:B[0m[39musPrintPropertyFlags arg_print_flags = [0m[1;36m0[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;92m87:b[0m[39mool arg_show_types = false;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:int arg_check_inhibitors = [0m[1;36m-1[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;92m89:b[0m[39mool arg_dry_run = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m90:b[0m[39mool arg_quiet = false;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;92m91:b[0m[39mool arg_no_warn = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m92:b[0m[39mool arg_full = false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m93:b[0m[39mool arg_recursive = false;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;92m94:b[0m[39mool arg_with_dependencies = false;[0m                                              [2m                [0m
[2;36m                    [0m         [1;92m95:b[0m[39mool arg_show_transaction = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:int arg_force = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;92m97:b[0m[39mool arg_ask_password = false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;92m98:b[0m[39mool arg_runtime = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:UnitFilePresetMode arg_preset_mode = UNIT_FILE_PRESET_FULL;[0m                      [2m                [0m
[2;36m                    [0m         [1;92m100:c[0m[39mhar **arg_wall = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:710[0m[39m-[0m[1;36m750[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:                case ARG_NO_LEGEND:[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:                        arg_legend = false;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:                case ARG_LEGEND:[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:                        r = [0m[1;35mparse_boolean_argument[0m[1;39m([0m[32m"--legend"[0m[39m, optarg, NULL[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:                        arg_legend = r;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:                case ARG_NO_PAGER:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                        arg_pager_flags |= PAGER_DISABLE;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:                case ARG_NO_WALL:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:                        arg_no_wall = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:                case ARG_ROOT:[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:                        r = [0m[1;35mparse_path_argument[0m[1;39m([0m[39moptarg, false, &arg_root[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:                case ARG_IMAGE:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                        r = [0m[1;35mparse_path_argument[0m[1;39m([0m[39moptarg, false, &arg_image[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:                case ARG_IMAGE_POLICY:[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:                        r = [0m[1;35mparse_image_policy_argument[0m[1;39m([0m[39moptarg, [0m                [2m                [0m
[2;36m                    [0m         [39m&arg_image_policy[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:                case [0m[32m'l'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:                        arg_full = true;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/static-destruct.h:[0m[1;36m1[0m[39m-[0m[1;36m105[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#pragma once[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#include [0m[32m"alloc-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#include [0m[32m"macro.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include [0m[32m"memory-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m[35m/[0m[39m* A framework for registering static variables that shall be freed on shutdown [0m  [2m                [0m
[2;36m                    [0m         [39mof a process. It's a bit like gcc's[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * destructor attribute, but allows us to precisely schedule when we want to [0m    [2m                [0m
[2;36m                    [0m         [39mfree the variables. This is supposed to[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * feel a bit like the gcc cleanup attribute, but for static variables. Note [0m    [2m                [0m
[2;36m                    [0m         [39mthat this does not work for static[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * variables declared in .so's, as the list is private to the same linking unit.[0m [2m                [0m
[2;36m                    [0m         [39mBut maybe that's a good thing. *[0m[35m/[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#define _common_static_destruct_attrs_                                  \[0m        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:        [0m[35m/[0m[39m* Older compilers don't know [0m[32m"retain"[0m[39m attribute. *[0m[35m/[0m[39m            \[0m        [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:        [0m[1;35m_Pragma[0m[1;39m([0m[32m"GCC diagnostic ignored \"-Wattributes\""[0m[1;39m)[0m[39m              \[0m        [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:        [0m[35m/[0m[39m* The actual destructor structure we place in a special section to find[0m [2m                [0m
[2;36m                    [0m         [39mit. *[0m[35m/[0m[39m \[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:        [0m[1;35m_section_[0m[1;39m([0m[32m"SYSTEMD_STATIC_DESTRUCT"[0m[1;39m)[0m[39m                            \[0m        [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:        [0m[35m/[0m[39m* Use pointer alignment, since that is apparently what gcc does for [0m    [2m                [0m
[2;36m                    [0m         [39mstatic variables. *[0m[35m/[0m[39m \[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:        _alignptr_                                                      \[0m        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:        [0m[35m/[0m[39m* Make sure this is not dropped from the image despite not being [0m       [2m                [0m
[2;36m                    [0m         [39mexplicitly referenced. *[0m[35m/[0m[39m \[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        _used_                                                          \[0m        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:        [0m[35m/[0m[39m* Prevent garbage collection by the linker. *[0m[35m/[0m[39m                 \[0m        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        _retain_                                                        \[0m        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        [0m[35m/[0m[39m* Make sure that AddressSanitizer doesn't pad this variable: we want [0m   [2m                [0m
[2;36m                    [0m         [39meverything in this section[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:         * packed next to each other so that we can enumerate it. *[0m[35m/[0m[39m    \[0m        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:        _variable_no_sanitize_address_[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:typedef enum StaticDestructorType [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        STATIC_DESTRUCTOR_SIMPLE,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:        STATIC_DESTRUCTOR_ARRAY,[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        _STATIC_DESTRUCTOR_TYPE_MAX,[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:        _STATIC_DESTRUCTOR_INVALID = -EINVAL,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[1;39m}[0m[39m StaticDestructorType;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:typedef struct SimpleCleanup [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        void *data;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        free_func_t destroy;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[1;39m}[0m[39m SimpleCleanup;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:typedef struct StaticDestructor [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        StaticDestructorType type;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        union [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                SimpleCleanup simple;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                ArrayCleanup array;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        [0m[1;39m}[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m[1;39m}[0m[39m StaticDestructor;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#define [0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39mvariable, func[0m[1;39m)[0m[39m \[0m                             [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;35m_STATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39mUNIQ, variable, func[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:#define [0m[1;35m_STATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39muq, variable, func[0m[1;39m)[0m[39m                 \[0m        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[35m/[0m[39m* Type-safe destructor *[0m[35m/[0m[39m                                      \[0m        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        static void [0m[1;35mUNIQ_T[0m[1;39m([0m[39mstatic_destructor_wrapper, uq[0m[1;39m)[0m[1;39m([0m[39mvoid *p[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m    \[0m        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:                [0m[1;35mtypeof[0m[1;39m([0m[39mvariable[0m[1;39m)[0m[39m *q = p;                                \[0m        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                [0m[1;35mfunc[0m[1;39m([0m[39mq[0m[1;39m)[0m[39m;                                                \[0m        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;39m}[0m[39m                                                               \[0m        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        _common_static_destruct_attrs_                                  \[0m        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        static const StaticDestructor [0m[1;35mUNIQ_T[0m[1;39m([0m[39mstatic_destructor_entry, uq[0m[1;39m)[0m[39m = [0m[1;39m{[0m[39m \[0m  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                .type = STATIC_DESTRUCTOR_SIMPLE,                       \[0m        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:                .simple.data = &[0m[1;39m([0m[39mvariable[0m[1;39m)[0m[39m,                             \[0m        [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                .simple.destroy = [0m[1;35mUNIQ_T[0m[1;39m([0m[39mstatic_destructor_wrapper, uq[0m[1;39m)[0m[39m, \[0m       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:#define [0m[1;35mSTATIC_ARRAY_DESTRUCTOR_REGISTER[0m[1;39m([0m[39ma, n, func[0m[1;39m)[0m[39m            \[0m                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35m_STATIC_ARRAY_DESTRUCTOR_REGISTER[0m[1;39m([0m[39mUNIQ, a, n, func[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#define [0m[1;35m_STATIC_ARRAY_DESTRUCTOR_REGISTER[0m[1;39m([0m[39muq, a, n, func[0m[1;39m)[0m[39m               \[0m        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[35m/[0m[39m* Type-safety check *[0m[35m/[0m[39m                                         \[0m        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        _unused_ static void [0m[1;39m([0m[39m* [0m[1;35mUNIQ_T[0m[1;39m([0m[39mstatic_destructor_wrapper, [0m               [2m                [0m
[2;36m                    [0m         [39muq[0m[1;39m)[0m[1;39m)[0m[1;39m([0m[1;35mtypeof[0m[1;39m([0m[39ma[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m *x, size_t y[0m[1;39m)[0m[39m = [0m[1;39m([0m[39mfunc[0m[1;39m)[0m[39m; \[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        _common_static_destruct_attrs_                                  \[0m        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        static const StaticDestructor [0m[1;35mUNIQ_T[0m[1;39m([0m[39mstatic_destructor_entry, uq[0m[1;39m)[0m[39m = [0m[1;39m{[0m[39m \[0m  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                .type = STATIC_DESTRUCTOR_ARRAY,                        \[0m        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                .array.parray = [0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39m &[0m[1;39m([0m[39ma[0m[1;39m)[0m[39m,                          \[0m        [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                .array.pn = &[0m[1;39m([0m[39mn[0m[1;39m)[0m[39m,                                       \[0m        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                .array.pfunc = [0m[1;39m([0m[39mfree_array_func_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mfunc[0m[1;39m)[0m[39m,              \[0m        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;39m}[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m[35m/[0m[39m* Beginning and end of our section listing the destructors. We define these as [0m [2m                [0m
[2;36m                    [0m         [39mweak as we want this to work[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m: * even if no destructors are defined and the section is missing. *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;92m81:e[0m[39mxtern const StaticDestructor _weak_ __start_SYSTEMD_STATIC_DESTRUCT[0m[1;39m[[0m[1;39m][0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;92m82:e[0m[39mxtern const StaticDestructor _weak_ __stop_SYSTEMD_STATIC_DESTRUCT[0m[1;39m[[0m[1;39m][0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m[35m/[0m[39m* The function to destroy everything. [0m[1;39m([0m[39mNote that this must be static inline, as[0m [2m                [0m
[2;36m                    [0m         [39mit's key that it remains in[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m: * the same linking unit as the variables we want to destroy.[0m[1;39m)[0m[39m *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:static inline void [0m[1;35mstatic_destruct[0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        if [0m[1;39m([0m[39m!__start_SYSTEMD_STATIC_DESTRUCT[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                return;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        for [0m[1;39m([0m[39mconst StaticDestructor *d = [0m                                        [2m                [0m
[2;36m                    [0m         [1;35mALIGN_PTR[0m[1;39m([0m[39m__start_SYSTEMD_STATIC_DESTRUCT[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:             d < __stop_SYSTEMD_STATIC_DESTRUCT;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:             d = [0m[1;35mALIGN_PTR[0m[1;39m([0m[39md + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                switch [0m[1;39m([0m[39md->type[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                case STATIC_DESTRUCTOR_SIMPLE:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                        d->[0m[1;35msimple.destroy[0m[1;39m([0m[39md->simple.data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                        break;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                case STATIC_DESTRUCTOR_ARRAY:[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                        [0m[1;35marray_cleanup[0m[1;39m([0m[39m&d->array[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                default:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                        [0m[1;35massert_not_reached[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/memory-util.h:[0m[1;36m1[0m[39m-[0m[1;36m50[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#pragma once[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#include <inttypes.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#include <malloc.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#include <stdbool.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include <string.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include <sys/types.h>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#include [0m[32m"alloc-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include [0m[32m"macro.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include [0m[32m"memory-util-fundamental.h"[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:size_t [0m[1;35mpage_size[0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m _pure_;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#define [0m[1;35mPAGE_ALIGN[0m[1;39m([0m[39ml[0m[1;39m)[0m[39m          [0m[1;35mALIGN_TO[0m[1;39m([0m[39ml, [0m[1;35mpage_size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:#define [0m[1;35mPAGE_ALIGN_U64[0m[1;39m([0m[39ml[0m[1;39m)[0m[39m      [0m[1;35mALIGN_TO_U64[0m[1;39m([0m[39ml, [0m[1;35mpage_size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:#define [0m[1;35mPAGE_ALIGN_DOWN[0m[1;39m([0m[39ml[0m[1;39m)[0m[39m     [0m[1;35mALIGN_DOWN[0m[1;39m([0m[39ml, [0m[1;35mpage_size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:#define [0m[1;35mPAGE_ALIGN_DOWN_U64[0m[1;39m([0m[39ml[0m[1;39m)[0m[39m [0m[1;35mALIGN_DOWN_U64[0m[1;39m([0m[39ml, [0m[1;35mpage_size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:#define [0m[1;35mPAGE_OFFSET[0m[1;39m([0m[39ml[0m[1;39m)[0m[39m         [0m[1;35mALIGN_OFFSET[0m[1;39m([0m[39ml, [0m[1;35mpage_size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:#define [0m[1;35mPAGE_OFFSET_U64[0m[1;39m([0m[39ml[0m[1;39m)[0m[39m     [0m[1;35mALIGN_OFFSET_U64[0m[1;39m([0m[39ml, [0m[1;35mpage_size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[35m/[0m[39m* Normal [0m[1;35mmemcpy[0m[1;39m([0m[1;39m)[0m[39m requires src to be nonnull. We do nothing if n is [0m[1;36m0[0m[39m. *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:static inline void* [0m[1;35mmemcpy_safe[0m[1;39m([0m[39mvoid *dst, const void *src, size_t n[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        if [0m[1;39m([0m[39mn == [0m[1;36m0[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:                return dst;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39msrc[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:        return [0m[1;35mmemcpy[0m[1;39m([0m[39mdst, src, n[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m[35m/[0m[39m* Normal [0m[1;35mmempcpy[0m[1;39m([0m[1;39m)[0m[39m requires src to be nonnull. We do nothing if n is [0m[1;36m0[0m[39m. *[0m[35m/[0m      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:static inline void* [0m[1;35mmempcpy_safe[0m[1;39m([0m[39mvoid *dst, const void *src, size_t n[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        if [0m[1;39m([0m[39mn == [0m[1;36m0[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:                return dst;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39msrc[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mmempcpy[0m[1;39m([0m[39mdst, src, n[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#define [0m[1;35mmempcpy_typesafe[0m[1;39m([0m[39mdst, src, n[0m[1;39m)[0m[39m                                   \[0m        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                                              \[0m        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:                size_t _sz_;                                            \[0m        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[1;35mMUL_SAFE[0m[1;39m([0m[39m&_sz_, [0m[1;35msizeof[0m[1;39m([0m[1;39m([0m[39mdst[0m[1;39m)[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m, n[0m[1;39m)[0m[1;39m)[0m[39m;        \[0m        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:                [0m[1;39m([0m[1;35mtypeof[0m[1;39m([0m[1;39m([0m[39mdst[0m[1;39m)[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m*[0m[1;39m)[0m[39m [0m[1;35mmempcpy_safe[0m[1;39m([0m[39mdst, src, _sz_[0m[1;39m)[0m[39m;       \[0m        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[35m/[0m[39m* Normal [0m[1;35mmemcmp[0m[1;39m([0m[1;39m)[0m[39m requires s1 and s2 to be nonnull. We do nothing if n is [0m[1;36m0[0m[39m. *[0m[35m/[0m [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:static inline int [0m[1;35mmemcmp_safe[0m[1;39m([0m[39mconst void *s1, const void *s2, size_t n[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        if [0m[1;39m([0m[39mn == [0m[1;36m0[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39ms1[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39ms2[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/memory-util.h:[0m[1;36m70[0m[39m-[0m[1;36m110[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        return [0m[1;39m([0m[39muint8_t*[0m[1;39m)[0m[39ms + n;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m[35m/[0m[39m* Normal [0m[1;35mmemmem[0m[1;39m([0m[1;39m)[0m[39m requires haystack to be nonnull, which is annoying for [0m       [2m                [0m
[2;36m                    [0m         [39mzero-length buffers *[0m[35m/[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:static inline void *[0m[1;35mmemmem_safe[0m[1;39m([0m[39mconst void *haystack, size_t haystacklen, const [0m [2m                [0m
[2;36m                    [0m         [39mvoid *needle, size_t needlelen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        if [0m[1;39m([0m[39mneedlelen <= [0m[1;36m0[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                return [0m[1;39m([0m[39mvoid*[0m[1;39m)[0m[39m haystack;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        if [0m[1;39m([0m[39mhaystacklen < needlelen[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                return NULL;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mhaystack[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mneedle[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        return [0m[1;35mmemmem[0m[1;39m([0m[39mhaystack, haystacklen, needle, needlelen[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:static inline void *[0m[1;35mmempmem_safe[0m[1;39m([0m[39mconst void *haystack, size_t haystacklen, const[0m [2m                [0m
[2;36m                    [0m         [39mvoid *needle, size_t needlelen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        const uint8_t *p;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        p = [0m[1;35mmemmem_safe[0m[1;39m([0m[39mhaystack, haystacklen, needle, needlelen[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        if [0m[1;39m([0m[39m!p[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                return NULL;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        return [0m[1;39m([0m[39muint8_t*[0m[1;39m)[0m[39m p + needlelen;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:static inline void* [0m[1;35merase_and_free[0m[1;39m([0m[39mvoid *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        size_t l;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        if [0m[1;39m([0m[39m!p[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                return NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        l = [0m[1;35mMALLOC_SIZEOF_SAFE[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39mp, l[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        return [0m[1;35mmfree[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:static inline void [0m[1;35merase_and_freep[0m[1;39m([0m[39mvoid *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;35merase_and_free[0m[1;39m([0m[39m*[0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39m p[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:51[0m[39m-[0m[1;36m150[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#include [0m[32m"systemctl-reset-failed.h"[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:#include [0m[32m"systemctl-service-watchdogs.h"[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#include [0m[32m"systemctl-set-default.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#include [0m[32m"systemctl-set-environment.h"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:#include [0m[32m"systemctl-set-property.h"[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:#include [0m[32m"systemctl-show.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:#include [0m[32m"systemctl-start-special.h"[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:#include [0m[32m"systemctl-start-unit.h"[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:#include [0m[32m"systemctl-switch-root.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:#include [0m[32m"systemctl-sysv-compat.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:#include [0m[32m"systemctl-trivial-method.h"[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:#include [0m[32m"systemctl-util.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:#include [0m[32m"systemctl-whoami.h"[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:#include [0m[32m"systemctl.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:#include [0m[32m"terminal-util.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:#include [0m[32m"time-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:#include [0m[32m"user-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#include [0m[32m"verbs.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:#include [0m[32m"virt.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m71:c[0m[39mhar **arg_types = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m72:c[0m[39mhar **arg_states = NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m73:c[0m[39mhar **arg_properties = NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;92m74:b[0m[39mool arg_all = false;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;92m75:e[0m[39mnum dependency arg_dependency = DEPENDENCY_FORWARD;[0m                             [2m                [0m
[2;36m                    [0m         [1;92m76:c[0m[39monst char *_arg_job_mode = NULL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:RuntimeScope arg_runtime_scope = RUNTIME_SCOPE_SYSTEM;[0m                           [2m                [0m
[2;36m                    [0m         [1;92m78:b[0m[39mool arg_wait = false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m79:b[0m[39mool arg_no_block = false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:int arg_legend = [0m[1;36m-1[0m[39m; [0m[35m/[0m[39m* [0m[1;36m-1[0m[39m: true, unless --quiet is passed, [0m[1;36m1[0m[39m: true *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:PagerFlags arg_pager_flags = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;92m82:b[0m[39mool arg_no_wtmp = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m83:b[0m[39mool arg_no_sync = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m84:b[0m[39mool arg_no_wall = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m85:b[0m[39mool arg_no_reload = false;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;92m86:B[0m[39musPrintPropertyFlags arg_print_flags = [0m[1;36m0[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;92m87:b[0m[39mool arg_show_types = false;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:int arg_check_inhibitors = [0m[1;36m-1[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;92m89:b[0m[39mool arg_dry_run = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m90:b[0m[39mool arg_quiet = false;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;92m91:b[0m[39mool arg_no_warn = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m92:b[0m[39mool arg_full = false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m93:b[0m[39mool arg_recursive = false;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;92m94:b[0m[39mool arg_with_dependencies = false;[0m                                              [2m                [0m
[2;36m                    [0m         [1;92m95:b[0m[39mool arg_show_transaction = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:int arg_force = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;92m97:b[0m[39mool arg_ask_password = false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;92m98:b[0m[39mool arg_runtime = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:UnitFilePresetMode arg_preset_mode = UNIT_FILE_PRESET_FULL;[0m                      [2m                [0m
[2;36m                    [0m         [1;92m100:c[0m[39mhar **arg_wall = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m101:c[0m[39monst char *arg_kill_whom = NULL;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:int arg_signal = SIGTERM;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:int arg_kill_value;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;92m104:b[0m[39mool arg_kill_value_set = false;[0m                                                [2m                [0m
[2;36m                    [0m         [1;92m105:c[0m[39mhar *arg_root = NULL;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;92m106:c[0m[39mhar *arg_image = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:usec_t arg_when = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;92m108:b[0m[39mool arg_stdin = false;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m109:c[0m[39monst char *arg_reboot_argument = NULL;[0m                                         [2m                [0m
[2;36m                    [0m         [1;92m110:e[0m[39mnum action arg_action = ACTION_SYSTEMCTL;[0m                                      [2m                [0m
[2;36m                    [0m         [1;92m111:B[0m[39musTransport arg_transport = BUS_TRANSPORT_LOCAL;[0m                               [2m                [0m
[2;36m                    [0m         [1;92m112:c[0m[39monst char *arg_host = NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:unsigned arg_lines = [0m[1;36m10[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:OutputMode arg_output = OUT[0m[1;33mPUT[0m[39m_SHORT;[0m                                           [2m                [0m
[2;36m                    [0m         [1;92m115:b[0m[39mool arg_plain = false;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m116:b[0m[39mool arg_firmware_setup = false;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:usec_t arg_boot_loader_menu = USEC_INFINITY;[0m                                    [2m                [0m
[2;36m                    [0m         [1;92m118:c[0m[39monst char *arg_boot_loader_entry = NULL;[0m                                       [2m                [0m
[2;36m                    [0m         [1;92m119:b[0m[39mool arg_now = false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m120:b[0m[39mool arg_jobs_before = false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;92m121:b[0m[39mool arg_jobs_after = false;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;92m122:c[0m[39mhar **arg_clean_what = NULL;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:TimestampStyle arg_timestamp_style = TIMESTAMP_PRETTY;[0m                          [2m                [0m
[2;36m                    [0m         [1;92m124:b[0m[39mool arg_read_only = false;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;92m125:b[0m[39mool arg_mkdir = false;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m126:b[0m[39mool arg_marked = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m127:c[0m[39monst char *arg_drop_in = NULL;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:ImagePolicy *arg_image_policy = NULL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_types, strv_freep[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_states, strv_freep[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_properties, strv_freep[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39m_arg_job_mode, unsetp[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_wall, strv_freep[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_kill_whom, unsetp[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_root, freep[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_image, freep[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_reboot_argument, unsetp[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_host, unsetp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_boot_loader_entry, unsetp[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_clean_what, strv_freep[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_drop_in, unsetp[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_image_policy, image_policy_freep[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:static int [0m[1;35msystemctl_help[0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        _cleanup_free_ char *link = NULL;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        int r;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:        [0m[1;35mpager_open[0m[1;39m([0m[39marg_pager_flags[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:1377[0m[39m-[0m[1;36m1377[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:1377[0m[39m-[0m[1;36m1377[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/path-util.[0m[1;92mc:85[0m[39m-[0m[1;36m105[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                _cleanup_free_ char *cwd = NULL;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                r = [0m[1;35msafe_getcwd[0m[1;39m([0m[39m&cwd[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                        return r;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                c = [0m[1;35mpath_join[0m[1;39m([0m[39mcwd, p[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        if [0m[1;39m([0m[39m!c[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                return -ENOMEM;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        *ret = c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:int [0m[1;35mpath_make_relative[0m[1;39m([0m[39mconst char *from, const char *to, char **ret[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        _cleanup_free_ char *result = NULL;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        unsigned n_parents;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        const char *f, *t;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        int r, k;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/path-util.[0m[1;92mc:575[0m[39m-[0m[1;36m595[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:                add = [0m[1;36m1[0m[39m + [0m[1;35mstrlen[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:                if [0m[1;39m([0m[39msz > SIZE_MAX - add[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[39m* overflow check *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:                        [0m[1;35mva_end[0m[1;39m([0m[39map[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:                        return NULL;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:                sz += add;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:        [0m[1;35mva_end[0m[1;39m([0m[39map[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:        nx = [0m[1;35mrealloc[0m[1;39m([0m[39mx ? *x : NULL, [0m[1;35mGREEDY_ALLOC_ROUND_UP[0m[1;39m([0m[39msz+[0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        if [0m[1;39m([0m[39m!nx[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:                return NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:        if [0m[1;39m([0m[39mx[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:                *x = nx;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:        if [0m[1;39m([0m[39mold_sz > [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:                slash = nx[0m[1;39m[[0m[39mold_sz-[0m[1;36m1[0m[1;39m][0m[39m == [0m[32m'/'[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:        else [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:                nx[0m[1;39m[[0m[39mold_sz[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:                slash = true; [0m[35m/[0m[39m* no need to generate a slash anymore *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/shared/parse-argument.[0m[1;92mc:55[0m[39m-[0m[1;36m81[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:int [0m[1;35mparse_path_argument[0m[1;39m([0m[39mconst char *path, bool suppress_root, char **arg[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        char *p;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[35m/[0m[39m*[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:         * This function is intended to be used in command line parsers, to [0m     [2m                [0m
[2;36m                    [0m         [39mhandle paths that are passed[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:         * in. It makes the path absolute, and reduces it to NULL if omitted or [0m [2m                [0m
[2;36m                    [0m         [39mroot [0m[1;39m([0m[39mthe latter optionally[0m[1;39m)[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:         *[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:         * NOTE THAT THIS WILL FREE THE PREVIOUS ARGUMENT POINTER ON SUCCESS![0m    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:         * Hence, do not pass in uninitialized pointers.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:         *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        if [0m[1;39m([0m[1;35misempty[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                *arg = [0m[1;35mmfree[0m[1;39m([0m[39m*arg[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        r = [0m[1;35mpath_make_absolute_cwd[0m[1;39m([0m[39mpath, &p[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                return [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse path \"%s\" and make [0m [2m                [0m
[2;36m                    [0m         [32mit absolute: %m"[0m[39m, path[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;35mpath_simplify[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        if [0m[1;39m([0m[39msuppress_root && [0m[1;35mempty_or_root[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                p = [0m[1;35mmfree[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        return [0m[1;35mfree_and_replace[0m[1;39m([0m[39m*arg, p[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/fuzz-systemctl-parse-argv.[0m[1;92mc:40[0m[39m-[0m[1;36m77[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:                           * long command lines. *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        if [0m[1;39m([0m[1;35mgetenv_bool[0m[1;39m([0m[32m"SYSTEMD_FUZZ_OUT[0m[1;33mPUT[0m[32m"[0m[1;39m)[0m[39m <= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:                orig_stdout_fd = [0m[1;35mfcntl[0m[1;39m([0m[1;35mfileno[0m[1;39m([0m[39mstdout[0m[1;39m)[0m[39m, F_DUPFD_CLOEXEC, [0m[1;36m3[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                if [0m[1;39m([0m[39morig_stdout_fd < [0m[1;36m0[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                        [0m[1;35mlog_warning_errno[0m[1;39m([0m[39morig_stdout_fd, [0m[32m"Failed to duplicate [0m  [2m                [0m
[2;36m                    [0m         [32mfd 1: %m"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                else[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                        [0m[1;35massert_se[0m[1;39m([0m[1;35mfreopen[0m[1;39m([0m[32m"/dev/null"[0m[39m, [0m[32m"w"[0m[39m, stdout[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                opterr = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* do not print errors *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[35m/[0m[39m* We need to reset some global state manually here since libfuzzer [0m     [2m                [0m
[2;36m                    [0m         [39mfeeds a single process with[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:         * multiple inputs, so we might carry over state from previous [0m          [2m                [0m
[2;36m                    [0m         [39minvocations that can trigger[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:         * certain asserts. *[0m[35m/[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        optind = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* this tells the getopt machinery to reinitialize *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        arg_transport = BUS_TRANSPORT_LOCAL;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        r = [0m[1;35msystemctl_dispatch_parse_argv[0m[1;39m([0m[1;35mstrv_length[0m[1;39m([0m[39margv[0m[1;39m)[0m[39m, argv[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse args: %m"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                [0m[1;35mlog_info[0m[1;39m([0m[39mr == [0m[1;36m0[0m[39m ? [0m[32m"Done!"[0m[39m : [0m[32m"Action!"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        if [0m[1;39m([0m[39morig_stdout_fd >= [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[1;35mfreopen[0m[1;39m([0m[1;35mFORMAT_PROC_FD_PATH[0m[1;39m([0m[39morig_stdout_fd[0m[1;39m)[0m[39m, [0m[32m"w"[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mstdout[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mrelease_busses[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[39m* We open the bus for communication with logind.[0m      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                           * It needs to be closed to avoid apparent leaks. *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mmac_selinux_finish[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[35m/[0m[39m* Call static destructors to do global state cleanup. We do it here, [0m   [2m                [0m
[2;36m                    [0m         [39mand not in fuzz-main.c so that[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:         * any global state is destroyed between fuzzer runs. *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:1377[0m[39m-[0m[1;36m1377[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/journal/fuzz-journald-stream.[0m[1;92mc:1[0m[39m-[0m[1;36m38[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include <linux/sockios.h>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#include <sys/ioctl.h>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#include <unistd.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include [0m[32m"fd-util.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"fuzz.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"fuzz-journald.h"[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#include [0m[32m"journald-stream.h"[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:int [0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t *data, size_t size[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:        _cleanup_close_pair_ int stream_fds[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = EBADF_PAIR;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39mserver_freep[0m[1;39m)[0m[39m Server *s = NULL;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:        StdoutStream *stream;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:        int v, fd0;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:        if [0m[1;39m([0m[1;35moutside_size_range[0m[1;39m([0m[39msize, [0m[1;36m1[0m[39m, [0m[1;36m65536[0m[1;39m)[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:        [0m[1;35mfuzz_setup_logging[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:        [0m[1;35massert_se[0m[1;39m([0m[1;35msocketpair[0m[1;39m([0m[39mAF_UNIX, SOCK_STREAM|SOCK_CLOEXEC|SOCK_NONBLOCK, [0m[1;36m0[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [39mstream_fds[0m[1;39m)[0m[39m >= [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        [0m[1;35massert_se[0m[1;39m([0m[1;35mserver_new[0m[1;39m([0m[39m&s[0m[1;39m)[0m[39m >= [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        [0m[1;35mdummy_server_init[0m[1;39m([0m[39ms, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:        [0m[1;35massert_se[0m[1;39m([0m[1;35mstdout_stream_install[0m[1;39m([0m[39ms, stream_fds[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, &stream[0m[1;39m)[0m[39m >= [0m[1;36m0[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:        fd0 = [0m[1;35mTAKE_FD[0m[1;39m([0m[39mstream_fds[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m; [0m[35m/[0m[39m* avoid double close *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        [0m[1;35massert_se[0m[1;39m([0m[1;35mwrite[0m[1;39m([0m[39mstream_fds[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m, data, size[0m[1;39m)[0m[39m == [0m[1;39m([0m[39mssize_t[0m[1;39m)[0m[39m size[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:        while [0m[1;39m([0m[1;35mioctl[0m[1;39m([0m[39mfd0, SIOCINQ, &v[0m[1;39m)[0m[39m == [0m[1;36m0[0m[39m && v[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:                [0m[1;35msd_event_run[0m[1;39m([0m[39ms->event, UINT64_MAX[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:        if [0m[1;39m([0m[39ms->n_stdout_streams > [0m[1;36m0[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:                [0m[1;35mstdout_stream_destroy[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/fuzz/fuzz-varlink.[0m[1;92mc:1[0m[39m-[0m[1;36m50[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include <unistd.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#include [0m[32m"sd-varlink.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include [0m[32m"errno-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"fd-util.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"fuzz.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#include [0m[32m"hexdecoct.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include [0m[32m"iovec-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include [0m[32m"log.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:static FILE *null = NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:static int [0m[1;35mmethod_something[0m[1;39m([0m[39msd_varlink *v, sd_json_variant *p, [0m                  [2m                [0m
[2;36m                    [0m         [39msd_varlink_method_flags_t flags, void *userdata[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:        [0m[1;35msd_json_variant_dump[0m[1;39m([0m[39mp, SD_JSON_FORMAT_NEWLINE|SD_JSON_FORMAT_PRETTY, [0m   [2m                [0m
[2;36m                    [0m         [39mnull, NULL[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:static int [0m[1;35mreply_callback[0m[1;39m([0m[39msd_varlink *v, sd_json_variant *p, const char [0m         [2m                [0m
[2;36m                    [0m         [39m*error_id, sd_varlink_reply_flags_t flags, void *userdata[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        [0m[1;35msd_json_variant_dump[0m[1;39m([0m[39mp, SD_JSON_FORMAT_NEWLINE|SD_JSON_FORMAT_PRETTY, [0m   [2m                [0m
[2;36m                    [0m         [39mnull, NULL[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:static int [0m[1;35mio_callback[0m[1;39m([0m[39msd_event_source *s, int fd, uint32_t revents, void [0m       [2m                [0m
[2;36m                    [0m         [39m*userdata[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:        struct iovec *iov = [0m[1;35mASSERT_PTR[0m[1;39m([0m[39muserdata[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:        bool write_eof = false, read_eof = false;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mfd >= [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mrevents & [0m[1;39m([0m[39mEPOLLOUT|EPOLLHUP|EPOLLERR[0m[1;39m)[0m[1;39m)[0m[39m && iov->iov_len > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:                ssize_t n;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:                [0m[35m/[0m[39m* never write more than [0m[1;36m143[0m[39m bytes a time, to make broken up [0m    [2m                [0m
[2;36m                    [0m         [1;35mrecv[0m[1;39m([0m[1;39m)[0m[39ms on the other side more[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:                 * likely, and thus test some additional code paths. *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:                n = [0m[1;35msend[0m[1;39m([0m[39mfd, iov->iov_base, [0m[1;35mMIN[0m[1;39m([0m[39miov->iov_len, 143U[0m[1;39m)[0m[39m, [0m            [2m                [0m
[2;36m                    [0m         [39mMSG_NOSIGNAL|MSG_DONTWAIT[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:                if [0m[1;39m([0m[39mn < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:                        if [0m[1;39m([0m[1;35mERRNO_IS_DISCONNECT[0m[1;39m([0m[39merrno[0m[1;39m)[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:                                write_eof = true;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:                        else[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:                                [0m[1;35massert_se[0m[1;39m([0m[39merrno == EAGAIN[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                [0m[1;39m}[0m[39m else[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                        [0m[1;35miovec_increment[0m[1;39m([0m[39miov, [0m[1;36m1[0m[39m, n[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        if [0m[1;39m([0m[39mrevents & EPOLLIN[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                char c[0m[1;39m[[0m[1;36m137[0m[1;39m][0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                ssize_t n;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:51[0m[39m-[0m[1;36m100[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#include [0m[32m"systemctl-reset-failed.h"[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:#include [0m[32m"systemctl-service-watchdogs.h"[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#include [0m[32m"systemctl-set-default.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#include [0m[32m"systemctl-set-environment.h"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:#include [0m[32m"systemctl-set-property.h"[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:#include [0m[32m"systemctl-show.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:#include [0m[32m"systemctl-start-special.h"[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:#include [0m[32m"systemctl-start-unit.h"[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:#include [0m[32m"systemctl-switch-root.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:#include [0m[32m"systemctl-sysv-compat.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:#include [0m[32m"systemctl-trivial-method.h"[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:#include [0m[32m"systemctl-util.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:#include [0m[32m"systemctl-whoami.h"[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:#include [0m[32m"systemctl.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:#include [0m[32m"terminal-util.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:#include [0m[32m"time-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:#include [0m[32m"user-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#include [0m[32m"verbs.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:#include [0m[32m"virt.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m71:c[0m[39mhar **arg_types = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m72:c[0m[39mhar **arg_states = NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m73:c[0m[39mhar **arg_properties = NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;92m74:b[0m[39mool arg_all = false;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;92m75:e[0m[39mnum dependency arg_dependency = DEPENDENCY_FORWARD;[0m                             [2m                [0m
[2;36m                    [0m         [1;92m76:c[0m[39monst char *_arg_job_mode = NULL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:RuntimeScope arg_runtime_scope = RUNTIME_SCOPE_SYSTEM;[0m                           [2m                [0m
[2;36m                    [0m         [1;92m78:b[0m[39mool arg_wait = false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m79:b[0m[39mool arg_no_block = false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:int arg_legend = [0m[1;36m-1[0m[39m; [0m[35m/[0m[39m* [0m[1;36m-1[0m[39m: true, unless --quiet is passed, [0m[1;36m1[0m[39m: true *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:PagerFlags arg_pager_flags = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;92m82:b[0m[39mool arg_no_wtmp = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m83:b[0m[39mool arg_no_sync = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m84:b[0m[39mool arg_no_wall = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m85:b[0m[39mool arg_no_reload = false;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;92m86:B[0m[39musPrintPropertyFlags arg_print_flags = [0m[1;36m0[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;92m87:b[0m[39mool arg_show_types = false;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:int arg_check_inhibitors = [0m[1;36m-1[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;92m89:b[0m[39mool arg_dry_run = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m90:b[0m[39mool arg_quiet = false;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;92m91:b[0m[39mool arg_no_warn = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m92:b[0m[39mool arg_full = false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m93:b[0m[39mool arg_recursive = false;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;92m94:b[0m[39mool arg_with_dependencies = false;[0m                                              [2m                [0m
[2;36m                    [0m         [1;92m95:b[0m[39mool arg_show_transaction = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:int arg_force = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;92m97:b[0m[39mool arg_ask_password = false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;92m98:b[0m[39mool arg_runtime = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:UnitFilePresetMode arg_preset_mode = UNIT_FILE_PRESET_FULL;[0m                      [2m                [0m
[2;36m                    [0m         [1;92m100:c[0m[39mhar **arg_wall = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:710[0m[39m-[0m[1;36m750[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:                case ARG_NO_LEGEND:[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:                        arg_legend = false;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:                case ARG_LEGEND:[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:                        r = [0m[1;35mparse_boolean_argument[0m[1;39m([0m[32m"--legend"[0m[39m, optarg, NULL[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:                        arg_legend = r;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:                case ARG_NO_PAGER:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                        arg_pager_flags |= PAGER_DISABLE;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:                case ARG_NO_WALL:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:                        arg_no_wall = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:                case ARG_ROOT:[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:                        r = [0m[1;35mparse_path_argument[0m[1;39m([0m[39moptarg, false, &arg_root[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:                case ARG_IMAGE:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                        r = [0m[1;35mparse_path_argument[0m[1;39m([0m[39moptarg, false, &arg_image[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:                case ARG_IMAGE_POLICY:[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:                        r = [0m[1;35mparse_image_policy_argument[0m[1;39m([0m[39moptarg, [0m                [2m                [0m
[2;36m                    [0m         [39m&arg_image_policy[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:                case [0m[32m'l'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:                        arg_full = true;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:1377[0m[39m-[0m[1;36m1377[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/fundamental/memory-util-fundamental.h:[0m[1;36m1[0m[39m-[0m[1;36m80[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#pragma once[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#include <stddef.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#if SD_BOOT[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#  include [0m[32m"efi-string.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#else[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#  include <string.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include [0m[32m"macro-fundamental.h"[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#define [0m[1;35mmemzero[0m[1;39m([0m[39mx, l[0m[1;39m)[0m[39m                                           \[0m                [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                                      \[0m                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:                size_t _l_ = [0m[1;39m([0m[39ml[0m[1;39m)[0m[39m;                               \[0m                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:                _l_ > [0m[1;36m0[0m[39m ? [0m[1;35mmemset[0m[1;39m([0m[1;39m([0m[39mx[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m, _l_[0m[1;39m)[0m[39m : [0m[1;39m([0m[39mx[0m[1;39m)[0m[39m;            \[0m                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:#if !SD_BOOT && HAVE_EXPLICIT_BZERO[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:static inline void *[0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39mvoid *p, size_t l[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        if [0m[1;39m([0m[39mp && l > [0m[1;36m0[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:                [0m[1;35mexplicit_bzero[0m[1;39m([0m[39mp, l[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        return p;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:static inline void *[0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39mvoid *p, size_t l[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:        if [0m[1;39m([0m[39mp && l > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:                [0m[1;35mmemset[0m[1;39m([0m[39mp, [0m[1;36m0[0m[39m, l[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:                __asm__ [0m[1;35m__volatile__[0m[1;39m([0m[32m""[0m[39m : : [0m[32m"r"[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m : [0m[32m"memory"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:        return p;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:struct VarEraser [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        [0m[35m/[0m[39m* NB: This is a pointer to memory to erase in case of [0m[1;35mCLEANUP_ERASE[0m[1;39m([0m[1;39m)[0m[39m. [0m [2m                [0m
[2;36m                    [0m         [39mPointer to pointer to memory[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:         * to erase in case of [0m[1;35mCLEANUP_ERASE_PTR[0m[1;39m([0m[1;39m)[0m[39m *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        void *p;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        size_t size;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:static inline void [0m[1;35merase_var[0m[1;39m([0m[39mstruct VarEraser *e[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        [0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39me->p, e->size[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m[35m/[0m[39m* Mark var to be erased when leaving scope. *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#define [0m[1;35mCLEANUP_ERASE[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m                                              \[0m        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39merase_var[0m[1;39m)[0m[39m _unused_ struct VarEraser [0m[1;35mCONCATENATE[0m[1;39m([0m[39m_eraser_, [0m    [2m                [0m
[2;36m                    [0m         [39mUNIQ[0m[1;39m)[0m[39m = [0m[1;39m{[0m[39m \[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:                .p = &[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m,                                            \[0m        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                .size = [0m[1;35msizeof[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m,                                    \[0m        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:static inline void [0m[1;35merase_varp[0m[1;39m([0m[39mstruct VarEraser *e[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[35m/[0m[39m* Very similar to [0m[1;35merase_var[0m[1;39m([0m[1;39m)[0m[39m, but assumes `p` is a pointer to a [0m       [2m                [0m
[2;36m                    [0m         [39mpointer whose memory shall be destructed. *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        if [0m[1;39m([0m[39m!e->p[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:                return;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39m*[0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39m e->p, e->size[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m[35m/[0m[39m* Mark pointer so that memory pointed to is erased when leaving scope. Note: [0m   [2m                [0m
[2;36m                    [0m         [39mthis takes a pointer to the[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m: * specified pointer, instead of just a copy of it. This is to allow callers to [0m [2m                [0m
[2;36m                    [0m         [39minvalidate the pointer after[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m: * use, if they like, disabling our automatic erasure [0m[1;39m([0m[39mfor example because they [0m [2m                [0m
[2;36m                    [0m         [39msucceeded with whatever they[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m: * wanted to do and now intend to return the allocated buffer to their caller [0m   [2m                [0m
[2;36m                    [0m         [39mwithout it being erased[0m[1;39m)[0m[39m. *[0m[35m/[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#define [0m[1;35mCLEANUP_ERASE_PTR[0m[1;39m([0m[39mptr, sz[0m[1;39m)[0m[39m                                      \[0m        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39merase_varp[0m[1;39m)[0m[39m _unused_ struct VarEraser [0m[1;35mCONCATENATE[0m[1;39m([0m[39m_eraser_, [0m   [2m                [0m
[2;36m                    [0m         [39mUNIQ[0m[1;39m)[0m[39m = [0m[1;39m{[0m[39m \[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                .p = [0m[1;39m([0m[39mptr[0m[1;39m)[0m[39m,                                             \[0m        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                .size = [0m[1;39m([0m[39msz[0m[1;39m)[0m[39m,                                           \[0m        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:typedef void [0m[1;39m([0m[39m*free_array_func_t[0m[1;39m)[0m[1;39m([0m[39mvoid *p, size_t n[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[35m/[0m[39m* An automatic _cleanup_-like logic for destroy arrays [0m[1;39m([0m[39mi.e. pointers + size[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mwhen leaving scope *[0m[35m/[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:typedef struct ArrayCleanup [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        void **parray;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        size_t *pn;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        free_array_func_t pfunc;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/shared/parse-argument.h:[0m[1;36m1[0m[39m-[0m[1;36m11[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#pragma once[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#include <stdbool.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#include [0m[32m"sd-json.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:int [0m[1;35mparse_boolean_argument[0m[1;39m([0m[39mconst char *optname, const char *s, bool *ret[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:int [0m[1;35mparse_json_argument[0m[1;39m([0m[39mconst char *s, sd_json_format_flags_t *ret[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:int [0m[1;35mparse_path_argument[0m[1;39m([0m[39mconst char *path, bool suppress_root, char **arg[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:int [0m[1;35mparse_signal_argument[0m[1;39m([0m[39mconst char *s, int *ret[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/shared/parse-argument.h:[0m[1;36m1[0m[39m-[0m[1;36m11[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#pragma once[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#include <stdbool.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#include [0m[32m"sd-json.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:int [0m[1;35mparse_boolean_argument[0m[1;39m([0m[39mconst char *optname, const char *s, bool *ret[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:int [0m[1;35mparse_json_argument[0m[1;39m([0m[39mconst char *s, sd_json_format_flags_t *ret[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:int [0m[1;35mparse_path_argument[0m[1;39m([0m[39mconst char *path, bool suppress_root, char **arg[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:int [0m[1;35mparse_signal_argument[0m[1;39m([0m[39mconst char *s, int *ret[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/shared/parse-argument.[0m[1;92mc:1[0m[39m-[0m[1;36m30[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include [0m[32m"format-table.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#include [0m[32m"parse-argument.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#include [0m[32m"path-util.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#include [0m[32m"signal-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include [0m[32m"stdio-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"string-table.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"string-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m[35m/[0m[39m* All functions in this file emit warnings. *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:int [0m[1;35mparse_boolean_argument[0m[1;39m([0m[39mconst char *optname, const char *s, bool *ret[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:        [0m[35m/[0m[39m* Returns the result through *ret and the return value. *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:        if [0m[1;39m([0m[39ms[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:                r = [0m[1;35mparse_boolean[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:                        return [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse boolean [0m      [2m                [0m
[2;36m                    [0m         [32margument to %s: %s."[0m[39m, optname, s[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:                if [0m[1;39m([0m[39mret[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:                        *ret = r;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:                return r;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:                [0m[35m/[0m[39m* s may be NULL. This is controlled by [0m[1;35mgetopt_long[0m[1;39m([0m[1;39m)[0m[39m [0m           [2m                [0m
[2;36m                    [0m         [39mparameters. *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:                if [0m[1;39m([0m[39mret[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:                        *ret = true;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:                return true;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/shared/parse-argument.[0m[1;92mc:55[0m[39m-[0m[1;36m110[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:int [0m[1;35mparse_path_argument[0m[1;39m([0m[39mconst char *path, bool suppress_root, char **arg[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        char *p;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[35m/[0m[39m*[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:         * This function is intended to be used in command line parsers, to [0m     [2m                [0m
[2;36m                    [0m         [39mhandle paths that are passed[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:         * in. It makes the path absolute, and reduces it to NULL if omitted or [0m [2m                [0m
[2;36m                    [0m         [39mroot [0m[1;39m([0m[39mthe latter optionally[0m[1;39m)[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:         *[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:         * NOTE THAT THIS WILL FREE THE PREVIOUS ARGUMENT POINTER ON SUCCESS![0m    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:         * Hence, do not pass in uninitialized pointers.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:         *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        if [0m[1;39m([0m[1;35misempty[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                *arg = [0m[1;35mmfree[0m[1;39m([0m[39m*arg[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        r = [0m[1;35mpath_make_absolute_cwd[0m[1;39m([0m[39mpath, &p[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                return [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse path \"%s\" and make [0m [2m                [0m
[2;36m                    [0m         [32mit absolute: %m"[0m[39m, path[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;35mpath_simplify[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        if [0m[1;39m([0m[39msuppress_root && [0m[1;35mempty_or_root[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                p = [0m[1;35mmfree[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        return [0m[1;35mfree_and_replace[0m[1;39m([0m[39m*arg, p[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:int [0m[1;35mparse_signal_argument[0m[1;39m([0m[39mconst char *s, int *ret[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        if [0m[1;39m([0m[1;35mstreq[0m[1;39m([0m[39ms, [0m[32m"help"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                [0m[1;35mDUMP_STRING_TABLE[0m[1;39m([0m[39msignal, int, _NSIG[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        if [0m[1;39m([0m[1;35mstreq[0m[1;39m([0m[39ms, [0m[32m"list"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                [0m[1;35m_cleanup_[0m[1;39m([0m[39mtable_unrefp[0m[1;39m)[0m[39m Table *table = NULL;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:                table = [0m[1;35mtable_new[0m[1;39m([0m[32m"signal"[0m[39m, [0m[32m"name"[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                if [0m[1;39m([0m[39m!table[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                        return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                for [0m[1;39m([0m[39mint i = [0m[1;36m1[0m[39m; i < _NSIG; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                        r = [0m[1;35mtable_add_many[0m[1;39m([0m                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                                        table,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                                        TABLE_INT, i,[0m                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                                        TABLE_SIGNAL, i[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                                return [0m[1;35mtable_log_add_error[0m[1;39m([0m[39mr[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                r = [0m[1;35mtable_print[0m[1;39m([0m[39mtable, NULL[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:710[0m[39m-[0m[1;36m760[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:                case ARG_NO_LEGEND:[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:                        arg_legend = false;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:                case ARG_LEGEND:[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:                        r = [0m[1;35mparse_boolean_argument[0m[1;39m([0m[32m"--legend"[0m[39m, optarg, NULL[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:                        arg_legend = r;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:                case ARG_NO_PAGER:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                        arg_pager_flags |= PAGER_DISABLE;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:                case ARG_NO_WALL:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:                        arg_no_wall = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:                case ARG_ROOT:[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:                        r = [0m[1;35mparse_path_argument[0m[1;39m([0m[39moptarg, false, &arg_root[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:                case ARG_IMAGE:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                        r = [0m[1;35mparse_path_argument[0m[1;39m([0m[39moptarg, false, &arg_image[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:                case ARG_IMAGE_POLICY:[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:                        r = [0m[1;35mparse_image_policy_argument[0m[1;39m([0m[39moptarg, [0m                [2m                [0m
[2;36m                    [0m         [39m&arg_image_policy[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:                case [0m[32m'l'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:                        arg_full = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:                case ARG_FAILED:[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:                        if [0m[1;39m([0m[1;35mstrv_extend[0m[1;39m([0m[39m&arg_states, [0m[32m"failed"[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:                                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:                case ARG_DRY_RUN:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:                        arg_dry_run = true;[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/static-destruct.h:[0m[1;36m80[0m[39m-[0m[1;36m105[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m: * even if no destructors are defined and the section is missing. *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;92m81:e[0m[39mxtern const StaticDestructor _weak_ __start_SYSTEMD_STATIC_DESTRUCT[0m[1;39m[[0m[1;39m][0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;92m82:e[0m[39mxtern const StaticDestructor _weak_ __stop_SYSTEMD_STATIC_DESTRUCT[0m[1;39m[[0m[1;39m][0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m[35m/[0m[39m* The function to destroy everything. [0m[1;39m([0m[39mNote that this must be static inline, as[0m [2m                [0m
[2;36m                    [0m         [39mit's key that it remains in[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m: * the same linking unit as the variables we want to destroy.[0m[1;39m)[0m[39m *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:static inline void [0m[1;35mstatic_destruct[0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        if [0m[1;39m([0m[39m!__start_SYSTEMD_STATIC_DESTRUCT[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                return;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        for [0m[1;39m([0m[39mconst StaticDestructor *d = [0m                                        [2m                [0m
[2;36m                    [0m         [1;35mALIGN_PTR[0m[1;39m([0m[39m__start_SYSTEMD_STATIC_DESTRUCT[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:             d < __stop_SYSTEMD_STATIC_DESTRUCT;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:             d = [0m[1;35mALIGN_PTR[0m[1;39m([0m[39md + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                switch [0m[1;39m([0m[39md->type[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                case STATIC_DESTRUCTOR_SIMPLE:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                        d->[0m[1;35msimple.destroy[0m[1;39m([0m[39md->simple.data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                        break;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                case STATIC_DESTRUCTOR_ARRAY:[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                        [0m[1;35marray_cleanup[0m[1;39m([0m[39m&d->array[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                default:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                        [0m[1;35massert_not_reached[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/fundamental/macro-fundamental.h:[0m[1;36m380[0m[39m-[0m[1;36m400[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                                       \[0m              [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                type *_pvar_ = &[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m;                           \[0m              [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:                type _var_ = *_pvar_;                            \[0m              [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:                type _nullvalue_ = nullvalue;                    \[0m              [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:                *_pvar_ = _nullvalue_;                           \[0m              [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:                _var_;                                           \[0m              [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:#define [0m[1;35mTAKE_PTR_TYPE[0m[1;39m([0m[39mptr, type[0m[1;39m)[0m[39m [0m[1;35mTAKE_GENERIC[0m[1;39m([0m[39mptr, type, NULL[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:#define [0m[1;35mTAKE_PTR[0m[1;39m([0m[39mptr[0m[1;39m)[0m[39m [0m[1;35mTAKE_PTR_TYPE[0m[1;39m([0m[39mptr, [0m[1;35mtypeof[0m[1;39m([0m[39mptr[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:#define [0m[1;35mTAKE_STRUCT_TYPE[0m[1;39m([0m[39ms, type[0m[1;39m)[0m[39m [0m[1;35mTAKE_GENERIC[0m[1;39m([0m[39ms, type, [0m[1;39m{[0m[1;39m}[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:#define [0m[1;35mTAKE_STRUCT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m [0m[1;35mTAKE_STRUCT_TYPE[0m[1;39m([0m[39ms, [0m[1;35mtypeof[0m[1;39m([0m[39ms[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:[0m[35m/[0m[39m*[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m: * STRLEN - return the length of a string literal, minus the trailing NUL byte.[0m [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m: *          Contrary to [0m[1;35mstrlen[0m[1;39m([0m[1;39m)[0m[39m, this is a constant expression.[0m                [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m: * @x: a string literal.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:#define [0m[1;35mSTRLEN[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[32m""[0m[39mx""[0m[1;39m)[0m[39m - [0m[1;35msizeof[0m[1;39m([0m[1;35mtypeof[0m[1;39m([0m[39mx[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:#define [0m[1;35mmfree[0m[1;39m([0m[39mmemory[0m[1;39m)[0m[39m                           \[0m                               [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                      \[0m                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/fuzz-systemctl-parse-argv.[0m[1;92mc:50[0m[39m-[0m[1;36m77[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[35m/[0m[39m* We need to reset some global state manually here since libfuzzer [0m     [2m                [0m
[2;36m                    [0m         [39mfeeds a single process with[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:         * multiple inputs, so we might carry over state from previous [0m          [2m                [0m
[2;36m                    [0m         [39minvocations that can trigger[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:         * certain asserts. *[0m[35m/[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        optind = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* this tells the getopt machinery to reinitialize *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        arg_transport = BUS_TRANSPORT_LOCAL;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        r = [0m[1;35msystemctl_dispatch_parse_argv[0m[1;39m([0m[1;35mstrv_length[0m[1;39m([0m[39margv[0m[1;39m)[0m[39m, argv[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse args: %m"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                [0m[1;35mlog_info[0m[1;39m([0m[39mr == [0m[1;36m0[0m[39m ? [0m[32m"Done!"[0m[39m : [0m[32m"Action!"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        if [0m[1;39m([0m[39morig_stdout_fd >= [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[1;35mfreopen[0m[1;39m([0m[1;35mFORMAT_PROC_FD_PATH[0m[1;39m([0m[39morig_stdout_fd[0m[1;39m)[0m[39m, [0m[32m"w"[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mstdout[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mrelease_busses[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[39m* We open the bus for communication with logind.[0m      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                           * It needs to be closed to avoid apparent leaks. *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mmac_selinux_finish[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[35m/[0m[39m* Call static destructors to do global state cleanup. We do it here, [0m   [2m                [0m
[2;36m                    [0m         [39mand not in fuzz-main.c so that[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:         * any global state is destroyed between fuzzer runs. *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/shared/parse-argument.[0m[1;92mc:55[0m[39m-[0m[1;36m81[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:int [0m[1;35mparse_path_argument[0m[1;39m([0m[39mconst char *path, bool suppress_root, char **arg[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        char *p;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[35m/[0m[39m*[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:         * This function is intended to be used in command line parsers, to [0m     [2m                [0m
[2;36m                    [0m         [39mhandle paths that are passed[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:         * in. It makes the path absolute, and reduces it to NULL if omitted or [0m [2m                [0m
[2;36m                    [0m         [39mroot [0m[1;39m([0m[39mthe latter optionally[0m[1;39m)[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:         *[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:         * NOTE THAT THIS WILL FREE THE PREVIOUS ARGUMENT POINTER ON SUCCESS![0m    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:         * Hence, do not pass in uninitialized pointers.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:         *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        if [0m[1;39m([0m[1;35misempty[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                *arg = [0m[1;35mmfree[0m[1;39m([0m[39m*arg[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        r = [0m[1;35mpath_make_absolute_cwd[0m[1;39m([0m[39mpath, &p[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                return [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse path \"%s\" and make [0m [2m                [0m
[2;36m                    [0m         [32mit absolute: %m"[0m[39m, path[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;35mpath_simplify[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        if [0m[1;39m([0m[39msuppress_root && [0m[1;35mempty_or_root[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                p = [0m[1;35mmfree[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        return [0m[1;35mfree_and_replace[0m[1;39m([0m[39m*arg, p[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/memory-util.h:[0m[1;36m70[0m[39m-[0m[1;36m110[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        return [0m[1;39m([0m[39muint8_t*[0m[1;39m)[0m[39ms + n;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m[35m/[0m[39m* Normal [0m[1;35mmemmem[0m[1;39m([0m[1;39m)[0m[39m requires haystack to be nonnull, which is annoying for [0m       [2m                [0m
[2;36m                    [0m         [39mzero-length buffers *[0m[35m/[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:static inline void *[0m[1;35mmemmem_safe[0m[1;39m([0m[39mconst void *haystack, size_t haystacklen, const [0m [2m                [0m
[2;36m                    [0m         [39mvoid *needle, size_t needlelen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        if [0m[1;39m([0m[39mneedlelen <= [0m[1;36m0[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                return [0m[1;39m([0m[39mvoid*[0m[1;39m)[0m[39m haystack;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        if [0m[1;39m([0m[39mhaystacklen < needlelen[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                return NULL;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mhaystack[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mneedle[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        return [0m[1;35mmemmem[0m[1;39m([0m[39mhaystack, haystacklen, needle, needlelen[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:static inline void *[0m[1;35mmempmem_safe[0m[1;39m([0m[39mconst void *haystack, size_t haystacklen, const[0m [2m                [0m
[2;36m                    [0m         [39mvoid *needle, size_t needlelen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        const uint8_t *p;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        p = [0m[1;35mmemmem_safe[0m[1;39m([0m[39mhaystack, haystacklen, needle, needlelen[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        if [0m[1;39m([0m[39m!p[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                return NULL;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        return [0m[1;39m([0m[39muint8_t*[0m[1;39m)[0m[39m p + needlelen;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:static inline void* [0m[1;35merase_and_free[0m[1;39m([0m[39mvoid *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        size_t l;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        if [0m[1;39m([0m[39m!p[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                return NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        l = [0m[1;35mMALLOC_SIZEOF_SAFE[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39mp, l[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        return [0m[1;35mmfree[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:static inline void [0m[1;35merase_and_freep[0m[1;39m([0m[39mvoid *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;35merase_and_free[0m[1;39m([0m[39m*[0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39m p[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/fuzz-systemctl-parse-argv.[0m[1;92mc:40[0m[39m-[0m[1;36m77[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:                           * long command lines. *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        if [0m[1;39m([0m[1;35mgetenv_bool[0m[1;39m([0m[32m"SYSTEMD_FUZZ_OUT[0m[1;33mPUT[0m[32m"[0m[1;39m)[0m[39m <= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:                orig_stdout_fd = [0m[1;35mfcntl[0m[1;39m([0m[1;35mfileno[0m[1;39m([0m[39mstdout[0m[1;39m)[0m[39m, F_DUPFD_CLOEXEC, [0m[1;36m3[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                if [0m[1;39m([0m[39morig_stdout_fd < [0m[1;36m0[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                        [0m[1;35mlog_warning_errno[0m[1;39m([0m[39morig_stdout_fd, [0m[32m"Failed to duplicate [0m  [2m                [0m
[2;36m                    [0m         [32mfd 1: %m"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                else[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                        [0m[1;35massert_se[0m[1;39m([0m[1;35mfreopen[0m[1;39m([0m[32m"/dev/null"[0m[39m, [0m[32m"w"[0m[39m, stdout[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                opterr = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* do not print errors *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[35m/[0m[39m* We need to reset some global state manually here since libfuzzer [0m     [2m                [0m
[2;36m                    [0m         [39mfeeds a single process with[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:         * multiple inputs, so we might carry over state from previous [0m          [2m                [0m
[2;36m                    [0m         [39minvocations that can trigger[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:         * certain asserts. *[0m[35m/[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        optind = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* this tells the getopt machinery to reinitialize *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        arg_transport = BUS_TRANSPORT_LOCAL;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        r = [0m[1;35msystemctl_dispatch_parse_argv[0m[1;39m([0m[1;35mstrv_length[0m[1;39m([0m[39margv[0m[1;39m)[0m[39m, argv[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse args: %m"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                [0m[1;35mlog_info[0m[1;39m([0m[39mr == [0m[1;36m0[0m[39m ? [0m[32m"Done!"[0m[39m : [0m[32m"Action!"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        if [0m[1;39m([0m[39morig_stdout_fd >= [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[1;35mfreopen[0m[1;39m([0m[1;35mFORMAT_PROC_FD_PATH[0m[1;39m([0m[39morig_stdout_fd[0m[1;39m)[0m[39m, [0m[32m"w"[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mstdout[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mrelease_busses[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[39m* We open the bus for communication with logind.[0m      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                           * It needs to be closed to avoid apparent leaks. *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mmac_selinux_finish[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[35m/[0m[39m* Call static destructors to do global state cleanup. We do it here, [0m   [2m                [0m
[2;36m                    [0m         [39mand not in fuzz-main.c so that[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:         * any global state is destroyed between fuzzer runs. *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/fundamental/memory-util-fundamental.h:[0m[1;36m60[0m[39m-[0m[1;36m90[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39m*[0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39m e->p, e->size[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m[35m/[0m[39m* Mark pointer so that memory pointed to is erased when leaving scope. Note: [0m   [2m                [0m
[2;36m                    [0m         [39mthis takes a pointer to the[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m: * specified pointer, instead of just a copy of it. This is to allow callers to [0m [2m                [0m
[2;36m                    [0m         [39minvalidate the pointer after[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m: * use, if they like, disabling our automatic erasure [0m[1;39m([0m[39mfor example because they [0m [2m                [0m
[2;36m                    [0m         [39msucceeded with whatever they[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m: * wanted to do and now intend to return the allocated buffer to their caller [0m   [2m                [0m
[2;36m                    [0m         [39mwithout it being erased[0m[1;39m)[0m[39m. *[0m[35m/[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#define [0m[1;35mCLEANUP_ERASE_PTR[0m[1;39m([0m[39mptr, sz[0m[1;39m)[0m[39m                                      \[0m        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39merase_varp[0m[1;39m)[0m[39m _unused_ struct VarEraser [0m[1;35mCONCATENATE[0m[1;39m([0m[39m_eraser_, [0m   [2m                [0m
[2;36m                    [0m         [39mUNIQ[0m[1;39m)[0m[39m = [0m[1;39m{[0m[39m \[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                .p = [0m[1;39m([0m[39mptr[0m[1;39m)[0m[39m,                                             \[0m        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                .size = [0m[1;39m([0m[39msz[0m[1;39m)[0m[39m,                                           \[0m        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:typedef void [0m[1;39m([0m[39m*free_array_func_t[0m[1;39m)[0m[1;39m([0m[39mvoid *p, size_t n[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[35m/[0m[39m* An automatic _cleanup_-like logic for destroy arrays [0m[1;39m([0m[39mi.e. pointers + size[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mwhen leaving scope *[0m[35m/[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:typedef struct ArrayCleanup [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        void **parray;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        size_t *pn;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        free_array_func_t pfunc;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m[39m ArrayCleanup;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:static inline void [0m[1;35marray_cleanup[0m[1;39m([0m[39mconst ArrayCleanup *c[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39m!c->parray == !c->pn[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        if [0m[1;39m([0m[39m!c->parray[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                return;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/fundamental/memory-util-fundamental.h:[0m[1;36m1[0m[39m-[0m[1;36m100[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#pragma once[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#include <stddef.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#if SD_BOOT[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#  include [0m[32m"efi-string.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#else[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#  include <string.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include [0m[32m"macro-fundamental.h"[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#define [0m[1;35mmemzero[0m[1;39m([0m[39mx, l[0m[1;39m)[0m[39m                                           \[0m                [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                                      \[0m                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:                size_t _l_ = [0m[1;39m([0m[39ml[0m[1;39m)[0m[39m;                               \[0m                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:                _l_ > [0m[1;36m0[0m[39m ? [0m[1;35mmemset[0m[1;39m([0m[1;39m([0m[39mx[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m, _l_[0m[1;39m)[0m[39m : [0m[1;39m([0m[39mx[0m[1;39m)[0m[39m;            \[0m                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:#if !SD_BOOT && HAVE_EXPLICIT_BZERO[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:static inline void *[0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39mvoid *p, size_t l[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        if [0m[1;39m([0m[39mp && l > [0m[1;36m0[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:                [0m[1;35mexplicit_bzero[0m[1;39m([0m[39mp, l[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        return p;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:static inline void *[0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39mvoid *p, size_t l[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:        if [0m[1;39m([0m[39mp && l > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:                [0m[1;35mmemset[0m[1;39m([0m[39mp, [0m[1;36m0[0m[39m, l[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:                __asm__ [0m[1;35m__volatile__[0m[1;39m([0m[32m""[0m[39m : : [0m[32m"r"[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m : [0m[32m"memory"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:        return p;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:struct VarEraser [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        [0m[35m/[0m[39m* NB: This is a pointer to memory to erase in case of [0m[1;35mCLEANUP_ERASE[0m[1;39m([0m[1;39m)[0m[39m. [0m [2m                [0m
[2;36m                    [0m         [39mPointer to pointer to memory[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:         * to erase in case of [0m[1;35mCLEANUP_ERASE_PTR[0m[1;39m([0m[1;39m)[0m[39m *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        void *p;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        size_t size;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:static inline void [0m[1;35merase_var[0m[1;39m([0m[39mstruct VarEraser *e[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        [0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39me->p, e->size[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m[35m/[0m[39m* Mark var to be erased when leaving scope. *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:#define [0m[1;35mCLEANUP_ERASE[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m                                              \[0m        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39merase_var[0m[1;39m)[0m[39m _unused_ struct VarEraser [0m[1;35mCONCATENATE[0m[1;39m([0m[39m_eraser_, [0m    [2m                [0m
[2;36m                    [0m         [39mUNIQ[0m[1;39m)[0m[39m = [0m[1;39m{[0m[39m \[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:                .p = &[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m,                                            \[0m        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                .size = [0m[1;35msizeof[0m[1;39m([0m[39mvar[0m[1;39m)[0m[39m,                                    \[0m        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:static inline void [0m[1;35merase_varp[0m[1;39m([0m[39mstruct VarEraser *e[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[35m/[0m[39m* Very similar to [0m[1;35merase_var[0m[1;39m([0m[1;39m)[0m[39m, but assumes `p` is a pointer to a [0m       [2m                [0m
[2;36m                    [0m         [39mpointer whose memory shall be destructed. *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        if [0m[1;39m([0m[39m!e->p[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:                return;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39m*[0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39m e->p, e->size[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m[35m/[0m[39m* Mark pointer so that memory pointed to is erased when leaving scope. Note: [0m   [2m                [0m
[2;36m                    [0m         [39mthis takes a pointer to the[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m: * specified pointer, instead of just a copy of it. This is to allow callers to [0m [2m                [0m
[2;36m                    [0m         [39minvalidate the pointer after[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m: * use, if they like, disabling our automatic erasure [0m[1;39m([0m[39mfor example because they [0m [2m                [0m
[2;36m                    [0m         [39msucceeded with whatever they[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m: * wanted to do and now intend to return the allocated buffer to their caller [0m   [2m                [0m
[2;36m                    [0m         [39mwithout it being erased[0m[1;39m)[0m[39m. *[0m[35m/[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#define [0m[1;35mCLEANUP_ERASE_PTR[0m[1;39m([0m[39mptr, sz[0m[1;39m)[0m[39m                                      \[0m        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39merase_varp[0m[1;39m)[0m[39m _unused_ struct VarEraser [0m[1;35mCONCATENATE[0m[1;39m([0m[39m_eraser_, [0m   [2m                [0m
[2;36m                    [0m         [39mUNIQ[0m[1;39m)[0m[39m = [0m[1;39m{[0m[39m \[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                .p = [0m[1;39m([0m[39mptr[0m[1;39m)[0m[39m,                                             \[0m        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                .size = [0m[1;39m([0m[39msz[0m[1;39m)[0m[39m,                                           \[0m        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:typedef void [0m[1;39m([0m[39m*free_array_func_t[0m[1;39m)[0m[1;39m([0m[39mvoid *p, size_t n[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[35m/[0m[39m* An automatic _cleanup_-like logic for destroy arrays [0m[1;39m([0m[39mi.e. pointers + size[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mwhen leaving scope *[0m[35m/[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:typedef struct ArrayCleanup [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        void **parray;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        size_t *pn;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        free_array_func_t pfunc;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m[39m ArrayCleanup;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:static inline void [0m[1;35marray_cleanup[0m[1;39m([0m[39mconst ArrayCleanup *c[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39m!c->parray == !c->pn[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        if [0m[1;39m([0m[39m!c->parray[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                return;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        if [0m[1;39m([0m[39m*c->parray[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                [0m[1;35massert[0m[1;39m([0m[39mc->pfunc[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                c->[0m[1;35mpfunc[0m[1;39m([0m[39m*c->parray, *c->pn[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                *c->parray = NULL;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        *c->pn = [0m[1;36m0[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#define [0m[1;35mCLEANUP_ARRAY[0m[1;39m([0m[39marray, n, func[0m[1;39m)[0m[39m                                   \[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/memory-util.h:[0m[1;36m20[0m[39m-[0m[1;36m60[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:#define [0m[1;35mPAGE_OFFSET_U64[0m[1;39m([0m[39ml[0m[1;39m)[0m[39m     [0m[1;35mALIGN_OFFSET_U64[0m[1;39m([0m[39ml, [0m[1;35mpage_size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[35m/[0m[39m* Normal [0m[1;35mmemcpy[0m[1;39m([0m[1;39m)[0m[39m requires src to be nonnull. We do nothing if n is [0m[1;36m0[0m[39m. *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:static inline void* [0m[1;35mmemcpy_safe[0m[1;39m([0m[39mvoid *dst, const void *src, size_t n[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        if [0m[1;39m([0m[39mn == [0m[1;36m0[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:                return dst;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39msrc[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:        return [0m[1;35mmemcpy[0m[1;39m([0m[39mdst, src, n[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m[35m/[0m[39m* Normal [0m[1;35mmempcpy[0m[1;39m([0m[1;39m)[0m[39m requires src to be nonnull. We do nothing if n is [0m[1;36m0[0m[39m. *[0m[35m/[0m      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:static inline void* [0m[1;35mmempcpy_safe[0m[1;39m([0m[39mvoid *dst, const void *src, size_t n[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        if [0m[1;39m([0m[39mn == [0m[1;36m0[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:                return dst;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39msrc[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mmempcpy[0m[1;39m([0m[39mdst, src, n[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#define [0m[1;35mmempcpy_typesafe[0m[1;39m([0m[39mdst, src, n[0m[1;39m)[0m[39m                                   \[0m        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        [0m[1;39m([0m[1;39m{[0m[39m                                                              \[0m        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:                size_t _sz_;                                            \[0m        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[1;35mMUL_SAFE[0m[1;39m([0m[39m&_sz_, [0m[1;35msizeof[0m[1;39m([0m[1;39m([0m[39mdst[0m[1;39m)[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m, n[0m[1;39m)[0m[1;39m)[0m[39m;        \[0m        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:                [0m[1;39m([0m[1;35mtypeof[0m[1;39m([0m[1;39m([0m[39mdst[0m[1;39m)[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m*[0m[1;39m)[0m[39m [0m[1;35mmempcpy_safe[0m[1;39m([0m[39mdst, src, _sz_[0m[1;39m)[0m[39m;       \[0m        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        [0m[1;39m}[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[35m/[0m[39m* Normal [0m[1;35mmemcmp[0m[1;39m([0m[1;39m)[0m[39m requires s1 and s2 to be nonnull. We do nothing if n is [0m[1;36m0[0m[39m. *[0m[35m/[0m [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:static inline int [0m[1;35mmemcmp_safe[0m[1;39m([0m[39mconst void *s1, const void *s2, size_t n[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        if [0m[1;39m([0m[39mn == [0m[1;36m0[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39ms1[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39ms2[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        return [0m[1;35mmemcmp[0m[1;39m([0m[39ms1, s2, n[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m[35m/[0m[39m* Compare s1 [0m[1;39m([0m[39mlength n1[0m[1;39m)[0m[39m with s2 [0m[1;39m([0m[39mlength n2[0m[1;39m)[0m[39m in lexicographic order. *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:static inline int [0m[1;35mmemcmp_nn[0m[1;39m([0m[39mconst void *s1, size_t n1, const void *s2, size_t [0m   [2m                [0m
[2;36m                    [0m         [39mn2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mmemcmp_safe[0m[1;39m([0m[39ms1, s2, [0m[1;35mMIN[0m[1;39m([0m[39mn1, n2[0m[1;39m)[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            ?: [0m[1;35mCMP[0m[1;39m([0m[39mn1, n2[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:#define [0m[1;35mzero[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35mmemzero[0m[1;39m([0m[39m&[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mx[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:1377[0m[39m-[0m[1;36m1377[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:1377[0m[39m-[0m[1;36m1377[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/fuzz-systemctl-parse-argv.[0m[1;92mc:40[0m[39m-[0m[1;36m77[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:                           * long command lines. *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        if [0m[1;39m([0m[1;35mgetenv_bool[0m[1;39m([0m[32m"SYSTEMD_FUZZ_OUT[0m[1;33mPUT[0m[32m"[0m[1;39m)[0m[39m <= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:                orig_stdout_fd = [0m[1;35mfcntl[0m[1;39m([0m[1;35mfileno[0m[1;39m([0m[39mstdout[0m[1;39m)[0m[39m, F_DUPFD_CLOEXEC, [0m[1;36m3[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                if [0m[1;39m([0m[39morig_stdout_fd < [0m[1;36m0[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                        [0m[1;35mlog_warning_errno[0m[1;39m([0m[39morig_stdout_fd, [0m[32m"Failed to duplicate [0m  [2m                [0m
[2;36m                    [0m         [32mfd 1: %m"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                else[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                        [0m[1;35massert_se[0m[1;39m([0m[1;35mfreopen[0m[1;39m([0m[32m"/dev/null"[0m[39m, [0m[32m"w"[0m[39m, stdout[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                opterr = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* do not print errors *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[35m/[0m[39m* We need to reset some global state manually here since libfuzzer [0m     [2m                [0m
[2;36m                    [0m         [39mfeeds a single process with[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:         * multiple inputs, so we might carry over state from previous [0m          [2m                [0m
[2;36m                    [0m         [39minvocations that can trigger[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:         * certain asserts. *[0m[35m/[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        optind = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* this tells the getopt machinery to reinitialize *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        arg_transport = BUS_TRANSPORT_LOCAL;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        r = [0m[1;35msystemctl_dispatch_parse_argv[0m[1;39m([0m[1;35mstrv_length[0m[1;39m([0m[39margv[0m[1;39m)[0m[39m, argv[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse args: %m"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                [0m[1;35mlog_info[0m[1;39m([0m[39mr == [0m[1;36m0[0m[39m ? [0m[32m"Done!"[0m[39m : [0m[32m"Action!"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        if [0m[1;39m([0m[39morig_stdout_fd >= [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[1;35mfreopen[0m[1;39m([0m[1;35mFORMAT_PROC_FD_PATH[0m[1;39m([0m[39morig_stdout_fd[0m[1;39m)[0m[39m, [0m[32m"w"[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mstdout[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mrelease_busses[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[39m* We open the bus for communication with logind.[0m      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                           * It needs to be closed to avoid apparent leaks. *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mmac_selinux_finish[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[35m/[0m[39m* Call static destructors to do global state cleanup. We do it here, [0m   [2m                [0m
[2;36m                    [0m         [39mand not in fuzz-main.c so that[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:         * any global state is destroyed between fuzzer runs. *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/fundamental/memory-util-fundamental.h:[0m[1;36m60[0m[39m-[0m[1;36m90[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39m*[0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39m e->p, e->size[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m[35m/[0m[39m* Mark pointer so that memory pointed to is erased when leaving scope. Note: [0m   [2m                [0m
[2;36m                    [0m         [39mthis takes a pointer to the[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m: * specified pointer, instead of just a copy of it. This is to allow callers to [0m [2m                [0m
[2;36m                    [0m         [39minvalidate the pointer after[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m: * use, if they like, disabling our automatic erasure [0m[1;39m([0m[39mfor example because they [0m [2m                [0m
[2;36m                    [0m         [39msucceeded with whatever they[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m: * wanted to do and now intend to return the allocated buffer to their caller [0m   [2m                [0m
[2;36m                    [0m         [39mwithout it being erased[0m[1;39m)[0m[39m. *[0m[35m/[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#define [0m[1;35mCLEANUP_ERASE_PTR[0m[1;39m([0m[39mptr, sz[0m[1;39m)[0m[39m                                      \[0m        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39merase_varp[0m[1;39m)[0m[39m _unused_ struct VarEraser [0m[1;35mCONCATENATE[0m[1;39m([0m[39m_eraser_, [0m   [2m                [0m
[2;36m                    [0m         [39mUNIQ[0m[1;39m)[0m[39m = [0m[1;39m{[0m[39m \[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                .p = [0m[1;39m([0m[39mptr[0m[1;39m)[0m[39m,                                             \[0m        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                .size = [0m[1;39m([0m[39msz[0m[1;39m)[0m[39m,                                           \[0m        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:typedef void [0m[1;39m([0m[39m*free_array_func_t[0m[1;39m)[0m[1;39m([0m[39mvoid *p, size_t n[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[35m/[0m[39m* An automatic _cleanup_-like logic for destroy arrays [0m[1;39m([0m[39mi.e. pointers + size[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mwhen leaving scope *[0m[35m/[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:typedef struct ArrayCleanup [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        void **parray;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        size_t *pn;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        free_array_func_t pfunc;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m[39m ArrayCleanup;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:static inline void [0m[1;35marray_cleanup[0m[1;39m([0m[39mconst ArrayCleanup *c[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39m!c->parray == !c->pn[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        if [0m[1;39m([0m[39m!c->parray[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                return;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/shared/parse-argument.[0m[1;92mc:55[0m[39m-[0m[1;36m81[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:int [0m[1;35mparse_path_argument[0m[1;39m([0m[39mconst char *path, bool suppress_root, char **arg[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        char *p;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[35m/[0m[39m*[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:         * This function is intended to be used in command line parsers, to [0m     [2m                [0m
[2;36m                    [0m         [39mhandle paths that are passed[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:         * in. It makes the path absolute, and reduces it to NULL if omitted or [0m [2m                [0m
[2;36m                    [0m         [39mroot [0m[1;39m([0m[39mthe latter optionally[0m[1;39m)[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:         *[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:         * NOTE THAT THIS WILL FREE THE PREVIOUS ARGUMENT POINTER ON SUCCESS![0m    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:         * Hence, do not pass in uninitialized pointers.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:         *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        if [0m[1;39m([0m[1;35misempty[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                *arg = [0m[1;35mmfree[0m[1;39m([0m[39m*arg[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        r = [0m[1;35mpath_make_absolute_cwd[0m[1;39m([0m[39mpath, &p[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                return [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse path \"%s\" and make [0m [2m                [0m
[2;36m                    [0m         [32mit absolute: %m"[0m[39m, path[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;35mpath_simplify[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        if [0m[1;39m([0m[39msuppress_root && [0m[1;35mempty_or_root[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                p = [0m[1;35mmfree[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        return [0m[1;35mfree_and_replace[0m[1;39m([0m[39m*arg, p[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/memory-util.h:[0m[1;36m70[0m[39m-[0m[1;36m110[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        return [0m[1;39m([0m[39muint8_t*[0m[1;39m)[0m[39ms + n;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m[35m/[0m[39m* Normal [0m[1;35mmemmem[0m[1;39m([0m[1;39m)[0m[39m requires haystack to be nonnull, which is annoying for [0m       [2m                [0m
[2;36m                    [0m         [39mzero-length buffers *[0m[35m/[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:static inline void *[0m[1;35mmemmem_safe[0m[1;39m([0m[39mconst void *haystack, size_t haystacklen, const [0m [2m                [0m
[2;36m                    [0m         [39mvoid *needle, size_t needlelen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        if [0m[1;39m([0m[39mneedlelen <= [0m[1;36m0[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                return [0m[1;39m([0m[39mvoid*[0m[1;39m)[0m[39m haystack;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        if [0m[1;39m([0m[39mhaystacklen < needlelen[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                return NULL;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mhaystack[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mneedle[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        return [0m[1;35mmemmem[0m[1;39m([0m[39mhaystack, haystacklen, needle, needlelen[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:static inline void *[0m[1;35mmempmem_safe[0m[1;39m([0m[39mconst void *haystack, size_t haystacklen, const[0m [2m                [0m
[2;36m                    [0m         [39mvoid *needle, size_t needlelen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        const uint8_t *p;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        p = [0m[1;35mmemmem_safe[0m[1;39m([0m[39mhaystack, haystacklen, needle, needlelen[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        if [0m[1;39m([0m[39m!p[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                return NULL;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        return [0m[1;39m([0m[39muint8_t*[0m[1;39m)[0m[39m p + needlelen;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:static inline void* [0m[1;35merase_and_free[0m[1;39m([0m[39mvoid *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        size_t l;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        if [0m[1;39m([0m[39m!p[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                return NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        l = [0m[1;35mMALLOC_SIZEOF_SAFE[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39mp, l[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        return [0m[1;35mmfree[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:static inline void [0m[1;35merase_and_freep[0m[1;39m([0m[39mvoid *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;35merase_and_free[0m[1;39m([0m[39m*[0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39m p[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/path-util.[0m[1;92mc:85[0m[39m-[0m[1;36m105[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                _cleanup_free_ char *cwd = NULL;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                r = [0m[1;35msafe_getcwd[0m[1;39m([0m[39m&cwd[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                        return r;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                c = [0m[1;35mpath_join[0m[1;39m([0m[39mcwd, p[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        if [0m[1;39m([0m[39m!c[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                return -ENOMEM;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        *ret = c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:int [0m[1;35mpath_make_relative[0m[1;39m([0m[39mconst char *from, const char *to, char **ret[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        _cleanup_free_ char *result = NULL;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        unsigned n_parents;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        const char *f, *t;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        int r, k;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/path-util.[0m[1;92mc:575[0m[39m-[0m[1;36m595[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:                add = [0m[1;36m1[0m[39m + [0m[1;35mstrlen[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:                if [0m[1;39m([0m[39msz > SIZE_MAX - add[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[39m* overflow check *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:                        [0m[1;35mva_end[0m[1;39m([0m[39map[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:                        return NULL;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:                sz += add;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:        [0m[1;35mva_end[0m[1;39m([0m[39map[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:        nx = [0m[1;35mrealloc[0m[1;39m([0m[39mx ? *x : NULL, [0m[1;35mGREEDY_ALLOC_ROUND_UP[0m[1;39m([0m[39msz+[0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        if [0m[1;39m([0m[39m!nx[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:                return NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:        if [0m[1;39m([0m[39mx[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:                *x = nx;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:        if [0m[1;39m([0m[39mold_sz > [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:                slash = nx[0m[1;39m[[0m[39mold_sz-[0m[1;36m1[0m[1;39m][0m[39m == [0m[32m'/'[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:        else [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:                nx[0m[1;39m[[0m[39mold_sz[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:                slash = true; [0m[35m/[0m[39m* no need to generate a slash anymore *[0m[35m/[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/static-destruct.h:[0m[1;36m80[0m[39m-[0m[1;36m105[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m: * even if no destructors are defined and the section is missing. *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;92m81:e[0m[39mxtern const StaticDestructor _weak_ __start_SYSTEMD_STATIC_DESTRUCT[0m[1;39m[[0m[1;39m][0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;92m82:e[0m[39mxtern const StaticDestructor _weak_ __stop_SYSTEMD_STATIC_DESTRUCT[0m[1;39m[[0m[1;39m][0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m[35m/[0m[39m* The function to destroy everything. [0m[1;39m([0m[39mNote that this must be static inline, as[0m [2m                [0m
[2;36m                    [0m         [39mit's key that it remains in[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m: * the same linking unit as the variables we want to destroy.[0m[1;39m)[0m[39m *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:static inline void [0m[1;35mstatic_destruct[0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        if [0m[1;39m([0m[39m!__start_SYSTEMD_STATIC_DESTRUCT[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                return;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        for [0m[1;39m([0m[39mconst StaticDestructor *d = [0m                                        [2m                [0m
[2;36m                    [0m         [1;35mALIGN_PTR[0m[1;39m([0m[39m__start_SYSTEMD_STATIC_DESTRUCT[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:             d < __stop_SYSTEMD_STATIC_DESTRUCT;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:             d = [0m[1;35mALIGN_PTR[0m[1;39m([0m[39md + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                switch [0m[1;39m([0m[39md->type[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                case STATIC_DESTRUCTOR_SIMPLE:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                        d->[0m[1;35msimple.destroy[0m[1;39m([0m[39md->simple.data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                        break;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                case STATIC_DESTRUCTOR_ARRAY:[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                        [0m[1;35marray_cleanup[0m[1;39m([0m[39m&d->array[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                default:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                        [0m[1;35massert_not_reached[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/fundamental/memory-util-fundamental.h:[0m[1;36m60[0m[39m-[0m[1;36m90[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;35mexplicit_bzero_safe[0m[1;39m([0m[39m*[0m[1;39m([0m[39mvoid**[0m[1;39m)[0m[39m e->p, e->size[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m[35m/[0m[39m* Mark pointer so that memory pointed to is erased when leaving scope. Note: [0m   [2m                [0m
[2;36m                    [0m         [39mthis takes a pointer to the[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m: * specified pointer, instead of just a copy of it. This is to allow callers to [0m [2m                [0m
[2;36m                    [0m         [39minvalidate the pointer after[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m: * use, if they like, disabling our automatic erasure [0m[1;39m([0m[39mfor example because they [0m [2m                [0m
[2;36m                    [0m         [39msucceeded with whatever they[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m: * wanted to do and now intend to return the allocated buffer to their caller [0m   [2m                [0m
[2;36m                    [0m         [39mwithout it being erased[0m[1;39m)[0m[39m. *[0m[35m/[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#define [0m[1;35mCLEANUP_ERASE_PTR[0m[1;39m([0m[39mptr, sz[0m[1;39m)[0m[39m                                      \[0m        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39merase_varp[0m[1;39m)[0m[39m _unused_ struct VarEraser [0m[1;35mCONCATENATE[0m[1;39m([0m[39m_eraser_, [0m   [2m                [0m
[2;36m                    [0m         [39mUNIQ[0m[1;39m)[0m[39m = [0m[1;39m{[0m[39m \[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                .p = [0m[1;39m([0m[39mptr[0m[1;39m)[0m[39m,                                             \[0m        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                .size = [0m[1;39m([0m[39msz[0m[1;39m)[0m[39m,                                           \[0m        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:typedef void [0m[1;39m([0m[39m*free_array_func_t[0m[1;39m)[0m[1;39m([0m[39mvoid *p, size_t n[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[35m/[0m[39m* An automatic _cleanup_-like logic for destroy arrays [0m[1;39m([0m[39mi.e. pointers + size[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mwhen leaving scope *[0m[35m/[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:typedef struct ArrayCleanup [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        void **parray;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        size_t *pn;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        free_array_func_t pfunc;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m[39m ArrayCleanup;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:static inline void [0m[1;35marray_cleanup[0m[1;39m([0m[39mconst ArrayCleanup *c[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39m!c->parray == !c->pn[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        if [0m[1;39m([0m[39m!c->parray[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                return;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/fuzz-systemctl-parse-argv.[0m[1;92mc:40[0m[39m-[0m[1;36m77[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:                           * long command lines. *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        if [0m[1;39m([0m[1;35mgetenv_bool[0m[1;39m([0m[32m"SYSTEMD_FUZZ_OUT[0m[1;33mPUT[0m[32m"[0m[1;39m)[0m[39m <= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:                orig_stdout_fd = [0m[1;35mfcntl[0m[1;39m([0m[1;35mfileno[0m[1;39m([0m[39mstdout[0m[1;39m)[0m[39m, F_DUPFD_CLOEXEC, [0m[1;36m3[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                if [0m[1;39m([0m[39morig_stdout_fd < [0m[1;36m0[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                        [0m[1;35mlog_warning_errno[0m[1;39m([0m[39morig_stdout_fd, [0m[32m"Failed to duplicate [0m  [2m                [0m
[2;36m                    [0m         [32mfd 1: %m"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                else[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                        [0m[1;35massert_se[0m[1;39m([0m[1;35mfreopen[0m[1;39m([0m[32m"/dev/null"[0m[39m, [0m[32m"w"[0m[39m, stdout[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                opterr = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* do not print errors *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[35m/[0m[39m* We need to reset some global state manually here since libfuzzer [0m     [2m                [0m
[2;36m                    [0m         [39mfeeds a single process with[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:         * multiple inputs, so we might carry over state from previous [0m          [2m                [0m
[2;36m                    [0m         [39minvocations that can trigger[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:         * certain asserts. *[0m[35m/[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        optind = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* this tells the getopt machinery to reinitialize *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        arg_transport = BUS_TRANSPORT_LOCAL;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        r = [0m[1;35msystemctl_dispatch_parse_argv[0m[1;39m([0m[1;35mstrv_length[0m[1;39m([0m[39margv[0m[1;39m)[0m[39m, argv[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse args: %m"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                [0m[1;35mlog_info[0m[1;39m([0m[39mr == [0m[1;36m0[0m[39m ? [0m[32m"Done!"[0m[39m : [0m[32m"Action!"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        if [0m[1;39m([0m[39morig_stdout_fd >= [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[1;35mfreopen[0m[1;39m([0m[1;35mFORMAT_PROC_FD_PATH[0m[1;39m([0m[39morig_stdout_fd[0m[1;39m)[0m[39m, [0m[32m"w"[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mstdout[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mrelease_busses[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[39m* We open the bus for communication with logind.[0m      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                           * It needs to be closed to avoid apparent leaks. *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mmac_selinux_finish[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[35m/[0m[39m* Call static destructors to do global state cleanup. We do it here, [0m   [2m                [0m
[2;36m                    [0m         [39mand not in fuzz-main.c so that[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:         * any global state is destroyed between fuzzer runs. *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:51[0m[39m-[0m[1;36m100[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#include [0m[32m"systemctl-reset-failed.h"[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:#include [0m[32m"systemctl-service-watchdogs.h"[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#include [0m[32m"systemctl-set-default.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#include [0m[32m"systemctl-set-environment.h"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:#include [0m[32m"systemctl-set-property.h"[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:#include [0m[32m"systemctl-show.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:#include [0m[32m"systemctl-start-special.h"[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:#include [0m[32m"systemctl-start-unit.h"[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:#include [0m[32m"systemctl-switch-root.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:#include [0m[32m"systemctl-sysv-compat.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:#include [0m[32m"systemctl-trivial-method.h"[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:#include [0m[32m"systemctl-util.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:#include [0m[32m"systemctl-whoami.h"[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:#include [0m[32m"systemctl.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:#include [0m[32m"terminal-util.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:#include [0m[32m"time-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:#include [0m[32m"user-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#include [0m[32m"verbs.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:#include [0m[32m"virt.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m71:c[0m[39mhar **arg_types = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m72:c[0m[39mhar **arg_states = NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m73:c[0m[39mhar **arg_properties = NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;92m74:b[0m[39mool arg_all = false;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;92m75:e[0m[39mnum dependency arg_dependency = DEPENDENCY_FORWARD;[0m                             [2m                [0m
[2;36m                    [0m         [1;92m76:c[0m[39monst char *_arg_job_mode = NULL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:RuntimeScope arg_runtime_scope = RUNTIME_SCOPE_SYSTEM;[0m                           [2m                [0m
[2;36m                    [0m         [1;92m78:b[0m[39mool arg_wait = false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m79:b[0m[39mool arg_no_block = false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:int arg_legend = [0m[1;36m-1[0m[39m; [0m[35m/[0m[39m* [0m[1;36m-1[0m[39m: true, unless --quiet is passed, [0m[1;36m1[0m[39m: true *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:PagerFlags arg_pager_flags = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;92m82:b[0m[39mool arg_no_wtmp = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m83:b[0m[39mool arg_no_sync = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m84:b[0m[39mool arg_no_wall = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m85:b[0m[39mool arg_no_reload = false;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;92m86:B[0m[39musPrintPropertyFlags arg_print_flags = [0m[1;36m0[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;92m87:b[0m[39mool arg_show_types = false;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:int arg_check_inhibitors = [0m[1;36m-1[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;92m89:b[0m[39mool arg_dry_run = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m90:b[0m[39mool arg_quiet = false;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;92m91:b[0m[39mool arg_no_warn = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m92:b[0m[39mool arg_full = false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m93:b[0m[39mool arg_recursive = false;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;92m94:b[0m[39mool arg_with_dependencies = false;[0m                                              [2m                [0m
[2;36m                    [0m         [1;92m95:b[0m[39mool arg_show_transaction = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:int arg_force = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;92m97:b[0m[39mool arg_ask_password = false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;92m98:b[0m[39mool arg_runtime = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:UnitFilePresetMode arg_preset_mode = UNIT_FILE_PRESET_FULL;[0m                      [2m                [0m
[2;36m                    [0m         [1;92m100:c[0m[39mhar **arg_wall = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:710[0m[39m-[0m[1;36m750[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:                case ARG_NO_LEGEND:[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:                        arg_legend = false;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:                case ARG_LEGEND:[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:                        r = [0m[1;35mparse_boolean_argument[0m[1;39m([0m[32m"--legend"[0m[39m, optarg, NULL[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:                        arg_legend = r;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:                case ARG_NO_PAGER:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                        arg_pager_flags |= PAGER_DISABLE;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:                case ARG_NO_WALL:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:                        arg_no_wall = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:                case ARG_ROOT:[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:                        r = [0m[1;35mparse_path_argument[0m[1;39m([0m[39moptarg, false, &arg_root[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:                case ARG_IMAGE:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                        r = [0m[1;35mparse_path_argument[0m[1;39m([0m[39moptarg, false, &arg_image[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:                case ARG_IMAGE_POLICY:[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:                        r = [0m[1;35mparse_image_policy_argument[0m[1;39m([0m[39moptarg, [0m                [2m                [0m
[2;36m                    [0m         [39m&arg_image_policy[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:                case [0m[32m'l'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:                        arg_full = true;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:1377[0m[39m-[0m[1;36m1377[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/fuzz-systemctl-parse-argv.[0m[1;92mc:1[0m[39m-[0m[1;36m77[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include <stdio.h>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#include <unistd.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#include [0m[32m"env-util.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include [0m[32m"fd-util.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"fuzz.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"nulstr-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#include [0m[32m"selinux-util.h"[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include [0m[32m"static-destruct.h"[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include [0m[32m"stdio-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include [0m[32m"strv.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#include [0m[32m"systemctl.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#include [0m[32m"systemctl-util.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:int [0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t *data, size_t size[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:        _cleanup_strv_free_ char **argv = NULL;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:        _cleanup_close_ int orig_stdout_fd = -EBADF;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        if [0m[1;39m([0m[39msize > [0m[1;36m16[0m[39m*[0m[1;36m1024[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:                return [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* See the comment below about the limit for [0m          [2m                [0m
[2;36m                    [0m         [1;35mstrv_length[0m[1;39m([0m[1;39m)[0m[39m. *[0m[35m/[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        [0m[1;35mfuzz_setup_logging[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:        arg_pager_flags = PAGER_DISABLE; [0m[35m/[0m[39m* We shouldn't execute the pager *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:        argv = [0m[1;35mstrv_parse_nulstr[0m[1;39m([0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39mdata, size[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        if [0m[1;39m([0m[39m!argv[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:        if [0m[1;39m([0m[39m!argv[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:                return [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* argv[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m should always be present, but may be [0m       [2m                [0m
[2;36m                    [0m         [39mzero-length. *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        if [0m[1;39m([0m[1;35mstrv_length[0m[1;39m([0m[39margv[0m[1;39m)[0m[39m > [0m[1;36m1024[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:                return [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* oss-fuzz reports timeouts which are caused by [0m      [2m                [0m
[2;36m                    [0m         [39mappending to a very long strv.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:                           * The code is indeed not very efficient, but it's [0m    [2m                [0m
[2;36m                    [0m         [39mdesigned for normal command-line[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:                           * use, where we don't expect more than a dozen of [0m    [2m                [0m
[2;36m                    [0m         [39mentries. The fact that it is[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:                           * slow with ~100k entries is not particularly [0m        [2m                [0m
[2;36m                    [0m         [39minteresting. Let's just refuse such[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:                           * long command lines. *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        if [0m[1;39m([0m[1;35mgetenv_bool[0m[1;39m([0m[32m"SYSTEMD_FUZZ_OUT[0m[1;33mPUT[0m[32m"[0m[1;39m)[0m[39m <= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:                orig_stdout_fd = [0m[1;35mfcntl[0m[1;39m([0m[1;35mfileno[0m[1;39m([0m[39mstdout[0m[1;39m)[0m[39m, F_DUPFD_CLOEXEC, [0m[1;36m3[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                if [0m[1;39m([0m[39morig_stdout_fd < [0m[1;36m0[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                        [0m[1;35mlog_warning_errno[0m[1;39m([0m[39morig_stdout_fd, [0m[32m"Failed to duplicate [0m  [2m                [0m
[2;36m                    [0m         [32mfd 1: %m"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                else[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                        [0m[1;35massert_se[0m[1;39m([0m[1;35mfreopen[0m[1;39m([0m[32m"/dev/null"[0m[39m, [0m[32m"w"[0m[39m, stdout[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                opterr = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* do not print errors *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[35m/[0m[39m* We need to reset some global state manually here since libfuzzer [0m     [2m                [0m
[2;36m                    [0m         [39mfeeds a single process with[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:         * multiple inputs, so we might carry over state from previous [0m          [2m                [0m
[2;36m                    [0m         [39minvocations that can trigger[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:         * certain asserts. *[0m[35m/[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        optind = [0m[1;36m0[0m[39m; [0m[35m/[0m[39m* this tells the getopt machinery to reinitialize *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        arg_transport = BUS_TRANSPORT_LOCAL;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        r = [0m[1;35msystemctl_dispatch_parse_argv[0m[1;39m([0m[1;35mstrv_length[0m[1;39m([0m[39margv[0m[1;39m)[0m[39m, argv[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse args: %m"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                [0m[1;35mlog_info[0m[1;39m([0m[39mr == [0m[1;36m0[0m[39m ? [0m[32m"Done!"[0m[39m : [0m[32m"Action!"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        if [0m[1;39m([0m[39morig_stdout_fd >= [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[1;35mfreopen[0m[1;39m([0m[1;35mFORMAT_PROC_FD_PATH[0m[1;39m([0m[39morig_stdout_fd[0m[1;39m)[0m[39m, [0m[32m"w"[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mstdout[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mrelease_busses[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[39m* We open the bus for communication with logind.[0m      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                           * It needs to be closed to avoid apparent leaks. *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mmac_selinux_finish[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[35m/[0m[39m* Call static destructors to do global state cleanup. We do it here, [0m   [2m                [0m
[2;36m                    [0m         [39mand not in fuzz-main.c so that[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:         * any global state is destroyed between fuzzer runs. *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:51[0m[39m-[0m[1;36m150[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#include [0m[32m"systemctl-reset-failed.h"[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:#include [0m[32m"systemctl-service-watchdogs.h"[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#include [0m[32m"systemctl-set-default.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#include [0m[32m"systemctl-set-environment.h"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:#include [0m[32m"systemctl-set-property.h"[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:#include [0m[32m"systemctl-show.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:#include [0m[32m"systemctl-start-special.h"[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:#include [0m[32m"systemctl-start-unit.h"[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:#include [0m[32m"systemctl-switch-root.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:#include [0m[32m"systemctl-sysv-compat.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:#include [0m[32m"systemctl-trivial-method.h"[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:#include [0m[32m"systemctl-util.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:#include [0m[32m"systemctl-whoami.h"[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:#include [0m[32m"systemctl.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:#include [0m[32m"terminal-util.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:#include [0m[32m"time-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:#include [0m[32m"user-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:#include [0m[32m"verbs.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:#include [0m[32m"virt.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m71:c[0m[39mhar **arg_types = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m72:c[0m[39mhar **arg_states = NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m73:c[0m[39mhar **arg_properties = NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;92m74:b[0m[39mool arg_all = false;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;92m75:e[0m[39mnum dependency arg_dependency = DEPENDENCY_FORWARD;[0m                             [2m                [0m
[2;36m                    [0m         [1;92m76:c[0m[39monst char *_arg_job_mode = NULL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:RuntimeScope arg_runtime_scope = RUNTIME_SCOPE_SYSTEM;[0m                           [2m                [0m
[2;36m                    [0m         [1;92m78:b[0m[39mool arg_wait = false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m79:b[0m[39mool arg_no_block = false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:int arg_legend = [0m[1;36m-1[0m[39m; [0m[35m/[0m[39m* [0m[1;36m-1[0m[39m: true, unless --quiet is passed, [0m[1;36m1[0m[39m: true *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:PagerFlags arg_pager_flags = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;92m82:b[0m[39mool arg_no_wtmp = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m83:b[0m[39mool arg_no_sync = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m84:b[0m[39mool arg_no_wall = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m85:b[0m[39mool arg_no_reload = false;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;92m86:B[0m[39musPrintPropertyFlags arg_print_flags = [0m[1;36m0[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;92m87:b[0m[39mool arg_show_types = false;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:int arg_check_inhibitors = [0m[1;36m-1[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;92m89:b[0m[39mool arg_dry_run = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m90:b[0m[39mool arg_quiet = false;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;92m91:b[0m[39mool arg_no_warn = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m92:b[0m[39mool arg_full = false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m93:b[0m[39mool arg_recursive = false;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;92m94:b[0m[39mool arg_with_dependencies = false;[0m                                              [2m                [0m
[2;36m                    [0m         [1;92m95:b[0m[39mool arg_show_transaction = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:int arg_force = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;92m97:b[0m[39mool arg_ask_password = false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;92m98:b[0m[39mool arg_runtime = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:UnitFilePresetMode arg_preset_mode = UNIT_FILE_PRESET_FULL;[0m                      [2m                [0m
[2;36m                    [0m         [1;92m100:c[0m[39mhar **arg_wall = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m101:c[0m[39monst char *arg_kill_whom = NULL;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:int arg_signal = SIGTERM;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:int arg_kill_value;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;92m104:b[0m[39mool arg_kill_value_set = false;[0m                                                [2m                [0m
[2;36m                    [0m         [1;92m105:c[0m[39mhar *arg_root = NULL;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;92m106:c[0m[39mhar *arg_image = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:usec_t arg_when = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;92m108:b[0m[39mool arg_stdin = false;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m109:c[0m[39monst char *arg_reboot_argument = NULL;[0m                                         [2m                [0m
[2;36m                    [0m         [1;92m110:e[0m[39mnum action arg_action = ACTION_SYSTEMCTL;[0m                                      [2m                [0m
[2;36m                    [0m         [1;92m111:B[0m[39musTransport arg_transport = BUS_TRANSPORT_LOCAL;[0m                               [2m                [0m
[2;36m                    [0m         [1;92m112:c[0m[39monst char *arg_host = NULL;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:unsigned arg_lines = [0m[1;36m10[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:OutputMode arg_output = OUT[0m[1;33mPUT[0m[39m_SHORT;[0m                                           [2m                [0m
[2;36m                    [0m         [1;92m115:b[0m[39mool arg_plain = false;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m116:b[0m[39mool arg_firmware_setup = false;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:usec_t arg_boot_loader_menu = USEC_INFINITY;[0m                                    [2m                [0m
[2;36m                    [0m         [1;92m118:c[0m[39monst char *arg_boot_loader_entry = NULL;[0m                                       [2m                [0m
[2;36m                    [0m         [1;92m119:b[0m[39mool arg_now = false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m120:b[0m[39mool arg_jobs_before = false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;92m121:b[0m[39mool arg_jobs_after = false;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;92m122:c[0m[39mhar **arg_clean_what = NULL;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:TimestampStyle arg_timestamp_style = TIMESTAMP_PRETTY;[0m                          [2m                [0m
[2;36m                    [0m         [1;92m124:b[0m[39mool arg_read_only = false;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;92m125:b[0m[39mool arg_mkdir = false;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;92m126:b[0m[39mool arg_marked = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m127:c[0m[39monst char *arg_drop_in = NULL;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:ImagePolicy *arg_image_policy = NULL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_types, strv_freep[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_states, strv_freep[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_properties, strv_freep[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39m_arg_job_mode, unsetp[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_wall, strv_freep[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_kill_whom, unsetp[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_root, freep[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_image, freep[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_reboot_argument, unsetp[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_host, unsetp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_boot_loader_entry, unsetp[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_clean_what, strv_freep[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_drop_in, unsetp[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:[0m[1;35mSTATIC_DESTRUCTOR_REGISTER[0m[1;39m([0m[39marg_image_policy, image_policy_freep[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:static int [0m[1;35msystemctl_help[0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        _cleanup_free_ char *link = NULL;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        int r;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:        [0m[1;35mpager_open[0m[1;39m([0m[39marg_pager_flags[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/systemctl/systemctl.[0m[1;92mc:710[0m[39m-[0m[1;36m750[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:                case ARG_NO_LEGEND:[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:                        arg_legend = false;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:                case ARG_LEGEND:[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:                        r = [0m[1;35mparse_boolean_argument[0m[1;39m([0m[32m"--legend"[0m[39m, optarg, NULL[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:                        arg_legend = r;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:                case ARG_NO_PAGER:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                        arg_pager_flags |= PAGER_DISABLE;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:                case ARG_NO_WALL:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:                        arg_no_wall = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:                case ARG_ROOT:[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:                        r = [0m[1;35mparse_path_argument[0m[1;39m([0m[39moptarg, false, &arg_root[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:                case ARG_IMAGE:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                        r = [0m[1;35mparse_path_argument[0m[1;39m([0m[39moptarg, false, &arg_image[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:                case ARG_IMAGE_POLICY:[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:                        r = [0m[1;35mparse_image_policy_argument[0m[1;39m([0m[39moptarg, [0m                [2m                [0m
[2;36m                    [0m         [39m&arg_image_policy[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:                                return r;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:                case [0m[32m'l'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:                        arg_full = true;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/shared/parse-argument.[0m[1;92mc:55[0m[39m-[0m[1;36m81[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:int [0m[1;35mparse_path_argument[0m[1;39m([0m[39mconst char *path, bool suppress_root, char **arg[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        char *p;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[35m/[0m[39m*[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:         * This function is intended to be used in command line parsers, to [0m     [2m                [0m
[2;36m                    [0m         [39mhandle paths that are passed[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:         * in. It makes the path absolute, and reduces it to NULL if omitted or [0m [2m                [0m
[2;36m                    [0m         [39mroot [0m[1;39m([0m[39mthe latter optionally[0m[1;39m)[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:         *[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:         * NOTE THAT THIS WILL FREE THE PREVIOUS ARGUMENT POINTER ON SUCCESS![0m    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:         * Hence, do not pass in uninitialized pointers.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:         *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        if [0m[1;39m([0m[1;35misempty[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:                *arg = [0m[1;35mmfree[0m[1;39m([0m[39m*arg[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        r = [0m[1;35mpath_make_absolute_cwd[0m[1;39m([0m[39mpath, &p[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                return [0m[1;35mlog_error_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to parse path \"%s\" and make [0m [2m                [0m
[2;36m                    [0m         [32mit absolute: %m"[0m[39m, path[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;35mpath_simplify[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        if [0m[1;39m([0m[39msuppress_root && [0m[1;35mempty_or_root[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                p = [0m[1;35mmfree[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        return [0m[1;35mfree_and_replace[0m[1;39m([0m[39m*arg, p[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/static-destruct.h:[0m[1;36m80[0m[39m-[0m[1;36m105[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m: * even if no destructors are defined and the section is missing. *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;92m81:e[0m[39mxtern const StaticDestructor _weak_ __start_SYSTEMD_STATIC_DESTRUCT[0m[1;39m[[0m[1;39m][0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;92m82:e[0m[39mxtern const StaticDestructor _weak_ __stop_SYSTEMD_STATIC_DESTRUCT[0m[1;39m[[0m[1;39m][0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m[35m/[0m[39m* The function to destroy everything. [0m[1;39m([0m[39mNote that this must be static inline, as[0m [2m                [0m
[2;36m                    [0m         [39mit's key that it remains in[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m: * the same linking unit as the variables we want to destroy.[0m[1;39m)[0m[39m *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:static inline void [0m[1;35mstatic_destruct[0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        if [0m[1;39m([0m[39m!__start_SYSTEMD_STATIC_DESTRUCT[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                return;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        for [0m[1;39m([0m[39mconst StaticDestructor *d = [0m                                        [2m                [0m
[2;36m                    [0m         [1;35mALIGN_PTR[0m[1;39m([0m[39m__start_SYSTEMD_STATIC_DESTRUCT[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:             d < __stop_SYSTEMD_STATIC_DESTRUCT;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:             d = [0m[1;35mALIGN_PTR[0m[1;39m([0m[39md + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                switch [0m[1;39m([0m[39md->type[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                case STATIC_DESTRUCTOR_SIMPLE:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                        d->[0m[1;35msimple.destroy[0m[1;39m([0m[39md->simple.data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                        break;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                case STATIC_DESTRUCTOR_ARRAY:[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                        [0m[1;35marray_cleanup[0m[1;39m([0m[39m&d->array[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                default:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                        [0m[1;35massert_not_reached[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis Summary[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and the evaluation report, I've identified the [0m   [2m                [0m
[2;36m                    [0m         [39mroot cause of the double-free vulnerability:[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe double-free occurs due to improper handling of global variable lifecycle across[0m [2m                [0m
[2;36m                    [0m         [39mmultiple fuzzer iterations:[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **First fuzzer iteration:**[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - `arg_root` and `arg_image` are initialized to NULL[0m                             [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35msystemctl_parse_argv[0m[1;39m([0m[1;39m)[0m[39m` calls `[0m[1;35mparse_path_argument[0m[1;39m([0m[1;39m)[0m[39m` which allocates new [0m    [2m                [0m
[2;36m                    [0m         [39mmemory and stores it in these globals[0m                                               [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m` is called at the end, which uses `[0m[1;35mfreep[0m[1;39m([0m[1;39m)[0m[39m` to free the [0m    [2m                [0m
[2;36m                    [0m         [39mmemory[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - **Critical Issue:** `[0m[1;35mfreep[0m[1;39m([0m[1;39m)[0m[39m` frees the memory but does NOT set the pointer to[0m [2m                [0m
[2;36m                    [0m         [39mNULL, leaving dangling pointers[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Second fuzzer iteration:**[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - `arg_root` and `arg_image` still point to freed memory [0m[1;39m([0m[39mdangling pointers[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35msystemctl_parse_argv[0m[1;39m([0m[1;39m)[0m[39m` calls `[0m[1;35mparse_path_argument[0m[1;39m([0m[1;39m)[0m[39m` again[0m                   [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mparse_path_argument[0m[1;39m([0m[1;39m)[0m[39m` line [0m[1;36m80[0m[39m calls `[0m[1;35mfree_and_replace[0m[1;39m([0m[39m*arg, p[0m[1;39m)[0m[39m` which [0m       [2m                [0m
[2;36m                    [0m         [39mattempts to free the old value[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - This tries to free already-freed memory → **DOUBLE-FREE**[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue is architectural: `[0m[1;35mparse_path_argument[0m[1;39m([0m[1;39m)[0m[39m` is designed for command-line [0m   [2m                [0m
[2;36m                    [0m         [39mparsing where the old value is either NULL or valid allocated memory. The fuzzer's [0m [2m                [0m
[2;36m                    [0m         [39mmulti-iteration pattern violates this assumption by leaving dangling pointers after[0m [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m`.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Code Locations[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Vulnerable pattern:** `src/systemctl/fuzz-systemctl-parse-argv.[0m[1;92mc:74[0m[39m` calls [0m     [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- **Dangling pointer source:** `[0m[1;35mfreep[0m[1;39m([0m[1;39m)[0m[39m` in STATIC_DESTRUCTOR mechanism doesn't [0m    [2m                [0m
[2;36m                    [0m         [39mnullify pointers[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- **Double-free trigger:** `[0m[1;35mparse_path_argument[0m[1;39m([0m[1;39m)[0m[39m` at [0m                              [2m                [0m
[2;36m                    [0m         [39m`src/shared/parse-argument.[0m[1;92mc:80[0m[39m` via `[0m[1;35mfree_and_replace[0m[1;39m([0m[1;39m)[0m[39m`[0m                           [2m                [0m
[2;36m                    [0m         [39m- **Affected variables:** `arg_root`, `arg_image`, `arg_image_policy` [0m[1;39m([0m[39mregistered [0m  [2m                [0m
[2;36m                    [0m         [39mwith STATIC_DESTRUCTOR_REGISTER[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must be applied to the **fuzzer code** [0m                                     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`src/systemctl/fuzz-systemctl-parse-argv.c`[0m[1;39m)[0m[39m, not the core systemctl logic, [0m       [2m                [0m
[2;36m                    [0m         [39mbecause:[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The core code is correct for normal execution[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The issue is specific to the fuzzer's multi-iteration pattern[0m                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Modifying core code could break existing functionality[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Implementation Steps[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1[0m[39m: Reset pointers after `[0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m`**[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter line [0m[1;36m74[0m[39m in `fuzz-systemctl-parse-argv.c` where `[0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m` is called,[0m [2m                [0m
[2;36m                    [0m         [39mexplicitly reset all global pointers that were freed to NULL:[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[39m* Reset pointers to NULL after [0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m to prevent double-free on next [0m   [2m                [0m
[2;36m                    [0m         [39miteration.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m * [0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m frees the memory but doesn't nullify pointers, leaving [0m        [2m                [0m
[2;36m                    [0m         [39mdangling pointers[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m * that cause double-free when [0m[1;35mparse_path_argument[0m[1;39m([0m[1;39m)[0m[39m tries to free them again. *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [39marg_root = NULL;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39marg_image = NULL;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39marg_image_policy = NULL;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m2[0m[39m: Add similar resets for other affected variables**[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mCheck the STATIC_DESTRUCTOR_REGISTER declarations in `systemctl.c` [0m[1;39m([0m[39maround line [0m    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m-[0m[1;36m143[0m[1;39m)[0m[39m and reset all pointer variables that might be modified during argument [0m    [2m                [0m
[2;36m                    [0m         [39mparsing:[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- `arg_types = NULL;`[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- `arg_states = NULL;`[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- `arg_properties = NULL;`[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- `arg_wall = NULL;`[0m                                                                [2m                [0m
[2;36m                    [0m         [39m- `arg_clean_what = NULL;`[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThese need to be reset because they might also be freed by `[0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m` and [0m [2m                [0m
[2;36m                    [0m         [39mcould cause similar issues if modified during parsing.[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m3[0m[39m: Ensure proper initialization at function start**[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWhile lines [0m[1;36m55[0m[39m-[0m[1;36m56[0m[39m already reset some global state, ensure that critical pointer [0m    [2m                [0m
[2;36m                    [0m         [39mvariables are also reset at the **beginning** of `[0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` before [0m [2m                [0m
[2;36m                    [0m         [39many processing:[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mint [0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t *data, size_t size[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [39m    _cleanup_strv_free_ char **argv = NULL;[0m                                         [2m                [0m
[2;36m                    [0m         [39m    _cleanup_close_ int orig_stdout_fd = -EBADF;[0m                                    [2m                [0m
[2;36m                    [0m         [39m    int r;[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[39m* Reset global pointers at the start of each iteration to ensure clean state [0m  [2m                [0m
[2;36m                    [0m         [39m*[0m[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m    arg_root = NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m    arg_image = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m    arg_image_policy = NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39msize > [0m[1;36m16[0m[39m*[0m[1;36m1024[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [39m        return [0m[1;36m0[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m rest of the function[0m                                                     [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis provides defense-in-depth by ensuring variables start in a clean state.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Is the Optimal Approach[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Minimal Impact:** Only affects fuzzer code, doesn't modify core systemctl [0m     [2m                [0m
[2;36m                    [0m         [39mfunctionality[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Preserves Design:** Maintains the STATIC_DESTRUCTOR_REGISTER pattern used [0m     [2m                [0m
[2;36m                    [0m         [39mthroughout systemd[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Addresses Root Cause:** Fixes the dangling pointer issue that causes the [0m      [2m                [0m
[2;36m                    [0m         [39mdouble-free[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Compatible with Fuzzing:** Properly handles the multi-iteration pattern of [0m    [2m                [0m
[2;36m                    [0m         [39mlibfuzzer[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Preserves Existing Logic[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- The core `[0m[1;35mparse_path_argument[0m[1;39m([0m[1;39m)[0m[39m` function remains unchanged[0m                       [2m                [0m
[2;36m                    [0m         [39m- The STATIC_DESTRUCTOR_REGISTER mechanism continues to work as designed[0m            [2m                [0m
[2;36m                    [0m         [39m- Normal systemctl execution is unaffected[0m                                          [2m                [0m
[2;36m                    [0m         [39m- Other fuzzers using similar patterns can apply the same fix[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Issue[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix ensures that after `[0m[1;35mstatic_destruct[0m[1;39m([0m[1;39m)[0m[39m` frees memory:[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Pointers are explicitly set to NULL[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Next iteration starts with clean state[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `[0m[1;35mparse_path_argument[0m[1;39m([0m[1;39m)[0m[39m` sees NULL pointers [0m[1;39m([0m[39mexpected initial state[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. No attempt to free dangling pointers[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. No double-free[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m1[0m[39m:** Additional lines of code in fuzzer[0m                               [2m                [0m
[2;36m                    [0m         [39m- **Mitigation:** Minimal - only adds ~[0m[1;36m10[0m[39m lines of reset code[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m2[0m[39m:** Could miss other variables needing reset[0m                         [2m                [0m
[2;36m                    [0m         [39m- **Mitigation:** Review all STATIC_DESTRUCTOR_REGISTER declarations and reset all [0m [2m                [0m
[2;36m                    [0m         [39mpointer types[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m3[0m[39m:** Performance overhead from resetting variables[0m                    [2m                [0m
[2;36m                    [0m         [39m- **Mitigation:** Negligible - simple pointer assignments are extremely fast[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis pattern of resetting global state between fuzzer iterations is already [0m        [2m                [0m
[2;36m                    [0m         [39mpresent:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m55[0m[39m: `optind = [0m[1;36m0[0m[39m;` - resets getopt machinery[0m                                  [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m56[0m[39m: `arg_transport = BUS_TRANSPORT_LOCAL;` - resets transport mode[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix extends this pattern to include pointer variables that need explicit NULL [0m  [2m                [0m
[2;36m                    [0m         [39minitialization.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Code Ranges Used for Fix Strategy[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<code_range>src/systemctl/fuzz-systemctl-parse-argv.[0m[1;92mc:1[0m[39m-[0m[1;36m77[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m             [2m                [0m
[2;36m                    [0m         [39m<code_range>src/systemctl/systemctl.[0m[1;92mc:51[0m[39m-[0m[1;36m150[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                           [2m                [0m
[2;36m                    [0m         [39m<code_range>src/systemctl/systemctl.[0m[1;92mc:710[0m[39m-[0m[1;36m750[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                          [2m                [0m
[2;36m                    [0m         [39m<code_range>src/shared/parse-argument.[0m[1;92mc:55[0m[39m-[0m[1;36m81[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                          [2m                [0m
[2;36m                    [0m         [39m<code_range>src/basic/static-destruct.h:[0m[1;36m80[0m[39m-[0m[1;36m105[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/08/26 13:29:24][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=819500;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=846516;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=708071;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=577240;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpyfce4iv7[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/systemd_systemd-full-001_syst[0m [2m               [0m
[2;36m                    [0m         [35memd-005/[0m[95magent-output-1767878964.346033[0m                                               [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/systemd_systemd-full-001_systemd-[1;36m005.[0mtoml           [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-systemd[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/08/26 13:29:26][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95msystemd[0m        ]8;id=919720;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=379268;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m[01/08/26 13:29:27][0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=497619;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=98931;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95msystemd[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=305737;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=42426;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m                [2m               [0m
