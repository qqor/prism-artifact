[2;36m[01/08/26 04:03:01][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=654215;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=18547;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp_xk5ramv[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/freerdp_fp-full-01_vuln_004/[0m[95ma[0m [2m               [0m
[2;36m                    [0m         [95mgent-output-1767844981.8247035[0m                                                       [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/freerdp_fp-full-01_vuln_004.toml                    [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-freerdp[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m           ]8;id=690477;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=910864;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/08/26 04:03:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m Took     ]8;id=107094;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=437221;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m31.74[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=60440;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=59073;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m ]8;id=7009;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=320766;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=980260;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=168785;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m31[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=540360;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=546843;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 04:03:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.78[0m seconds;               ]8;id=869230;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=694269;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/08/26 04:03:35][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=341454;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=211549;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=162695;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=123585;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=248220;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=956065;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=435952;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=8112;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 04:03:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m1.02[0m seconds;               ]8;id=202465;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=817735;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=238163;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=144991;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 04:03:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.86[0m seconds;               ]8;id=202124;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=200205;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/08/26 04:03:39][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=224392;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=905351;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         =================================================================                   [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: heap-buffer-overflow on address [1;36m0x519000001d60[0m at pc [2m                [0m
[2;36m                    [0m         [1;36m0x565420dbcd91[0m bp [1;36m0x7fff1d7a4750[0m sp [1;36m0x7fff1d7a4748[0m                                  [2m                [0m
[2;36m                    [0m         WRITE of size [1;36m8[0m at [1;36m0x519000001d60[0m thread T0                                         [2m                [0m
[2;36m                    [0m         SCARINESS: [1;36m42[0m [1m([0m[1;36m8[0m-byte-write-heap-buffer-overflow[1m)[0m                                   [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x565420dbcd90[0m in Stream_Read                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m                                     [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x565420dbcd90[0m in gcc_read_client_network_data                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m1875:3[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x565420dbcd90[0m in gcc_read_client_data_blocks                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m617:10[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x565420db700b[0m in gcc_read_conference_create_request                         [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m414:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x565420cff2ff[0m in mcs_recv_connect_initial                                   [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m700:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x565420ad6efb[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1441:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x565420a5e785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x565420a5e785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x565420915100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x565420900375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x565420905e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x5654209310b2[0m in main                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x7f83ee933082[0m in __libc_start_main                                         [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m13[0m [1;36m0x5654208f855d[0m in _start [1m([0m[35m/out/[0m[95mTestFuzzCoreServer+0x3d655d[0m[1m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: Stream_Read--gcc_read_client_network_data--gcc_read_client_data_blocks [2m                [0m
[2;36m                    [0m         [1;36m0x519000001d60[0m is located [1;36m0[0m bytes after [1;36m992[0m-byte region                             [2m                [0m
[2;36m                    [0m         [1m[[0m[1;36m0x519000001980[0m,[1;36m0x519000001d60[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m         allocated by thread T0 here:                                                        [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x565420a21099[0m in calloc                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m:[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x565420d049b6[0m in mcs_new [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m1446:34[0m         [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x565420ad6ee4[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1438:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x565420a5e785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x565420a5e785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x565420915100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x565420900375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x565420905e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x5654209310b2[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x7f83ee933082[0m in __libc_start_main                                          [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: __interceptor_calloc--mcs_new--freerdp_is_valid_mcs_create_request     [2m                [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: heap-buffer-overflow                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m in Stream_Read                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         =================================================================                   [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ERROR: AddressSanitizer: heap-buffer-overflow on address [1;36m0x519000001d60[0m at pc [2m                [0m
[2;36m                    [0m         [1;36m0x565420dbcd91[0m bp [1;36m0x7fff1d7a4750[0m sp [1;36m0x7fff1d7a4748[0m                                  [2m                [0m
[2;36m                    [0m         WRITE of size [1;36m8[0m at [1;36m0x519000001d60[0m thread T0                                         [2m                [0m
[2;36m                    [0m         SCARINESS: [1;36m42[0m [1m([0m[1;36m8[0m-byte-write-heap-buffer-overflow[1m)[0m                                   [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x565420dbcd90[0m in Stream_Read                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m                                     [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x565420dbcd90[0m in gcc_read_client_network_data                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m1875:3[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x565420dbcd90[0m in gcc_read_client_data_blocks                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m617:10[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x565420db700b[0m in gcc_read_conference_create_request                         [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m:[1;92m414:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x565420cff2ff[0m in mcs_recv_connect_initial                                   [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m700:7[0m                                            [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x565420ad6efb[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1441:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x565420a5e785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x565420a5e785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x565420915100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x565420900375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m10[0m [1;36m0x565420905e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m11[0m [1;36m0x5654209310b2[0m in main                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m12[0m [1;36m0x7f83ee933082[0m in __libc_start_main                                         [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m             #[1;36m13[0m [1;36m0x5654208f855d[0m in _start [1m([0m[35m/out/[0m[95mTestFuzzCoreServer+0x3d655d[0m[1m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: Stream_Read--gcc_read_client_network_data--gcc_read_client_data_blocks [2m                [0m
[2;36m                    [0m         [1;36m0x519000001d60[0m is located [1;36m0[0m bytes after [1;36m992[0m-byte region                             [2m                [0m
[2;36m                    [0m         [1m[[0m[1;36m0x519000001980[0m,[1;36m0x519000001d60[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m         allocated by thread T0 here:                                                        [2m                [0m
[2;36m                    [0m             #[1;36m0[0m [1;36m0x565420a21099[0m in calloc                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m:[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m             #[1;36m1[0m [1;36m0x565420d049b6[0m in mcs_new [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m:[1;92m1446:34[0m         [2m                [0m
[2;36m                    [0m             #[1;36m2[0m [1;36m0x565420ad6ee4[0m in freerdp_is_valid_mcs_create_request                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m:[1;92m1438:16[0m                                      [2m                [0m
[2;36m                    [0m             #[1;36m3[0m [1;36m0x565420a5e785[0m in test_server                                                [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m             #[1;36m4[0m [1;36m0x565420a5e785[0m in LLVMFuzzerTestOneInput                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m:[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m             #[1;36m5[0m [1;36m0x565420915100[0m in fuzzer::Fuzzer::[1;35mExecuteCallback[0m[1m([0munsigned char const*,      [2m                [0m
[2;36m                    [0m         unsigned long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m:[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m             #[1;36m6[0m [1;36m0x565420900375[0m in fuzzer::[1;35mRunOneTest[0m[1m([0mfuzzer::Fuzzer*, char const*, unsigned  [2m                [0m
[2;36m                    [0m         long[1m)[0m [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m             #[1;36m7[0m [1;36m0x565420905e0f[0m in fuzzer::[1;35mFuzzerDriver[0m[1m([0mint*, char***, int [1m([0m*[1m)[0m[1m([0munsigned char  [2m                [0m
[2;36m                    [0m         const*, unsigned long[1m)[0m[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m:[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m             #[1;36m8[0m [1;36m0x5654209310b2[0m in main                                                       [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m:[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m             #[1;36m9[0m [1;36m0x7f83ee933082[0m in __libc_start_main                                          [2m                [0m
[2;36m                    [0m         [1m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1m)[0m [1m([0mBuildId:                                 [2m                [0m
[2;36m                    [0m         5792732f783158c66fb4f3756458ca24e46e827d[1m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: __interceptor_calloc--mcs_new--freerdp_is_valid_mcs_create_request     [2m                [0m
[2;36m                    [0m         SUMMARY: AddressSanitizer: heap-buffer-overflow                                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m:[1;92m703:3[0m in Stream_Read                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/08/26 04:04:02][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=22583;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=528919;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/08/26 04:10:14][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=200414;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=546918;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/08/26 04:10:59][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=708735;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=113719;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=540222;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=674868;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 04:11:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.88[0m seconds;               ]8;id=633167;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=327790;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Started[33m...[0m                             ]8;id=860839;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=85702;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp51jc6tdb[0m                                                 ]8;id=987930;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=78756;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/08/26 04:11:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Took [1;36m23.19[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=804451;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=458141;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Started[33m...[0m                       ]8;id=128454;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=366990;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 04:11:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Took [1;36m12.82[0m seconds;             ]8;id=636216;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=420403;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Started[33m...[0m                          ]8;id=464309;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=297759;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 04:11:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Took [1;36m3.63[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=967340;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=604685;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Started[33m...[0m                              ]8;id=976386;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=949789;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=964842;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=736239;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=731752;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=921796;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 04:11:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.86[0m seconds;               ]8;id=284350;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=870404;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=45838;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=552614;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/08/26 04:11:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.87[0m seconds;               ]8;id=918287;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=27674;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/08/26 04:11:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=230629;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=640914;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.91[0m seconds;               ]8;id=31899;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=426567;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/08/26 04:11:44][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=204985;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=260932;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/libfreerdp/core/gcc.c                                                         [2m                [0m
[2;36m                    [0m         +++ b/libfreerdp/core/gcc.c                                                         [2m                [0m
[2;36m                    [0m         @@ [1;36m-1854[0m,[1;36m13[0m +[1;36m1854[0m,[1;36m20[0m @@                                                             [2m                [0m
[2;36m                    [0m                 if [1m([0mblockLength [1m<[0m[39m [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-       [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-       [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [39m-       [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-       [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m-       [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+       [0m[39mUINT32 channelCount = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m+       [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+       [0m[39mif [0m[1;39m([0m[39mchannelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [39m+       [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"announced channels[0m[32m([0m[32m%"[0m[39m PRIu32 [0m[32m"[0m[32m)[0m[32m exceed the %d [0m       [2m                [0m
[2;36m                    [0m         [32mlimit"[0m[39m, [0m                                                                            [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39m         channelCount, CHANNEL_MAX_COUNT[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+       [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+       [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + channelCount * [0m[1;36m12[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+       [0m[39mmcs->channelCount = [0m[1;39m([0m[39mINT8[0m[1;39m)[0m[39mchannelCount;[0m                                     [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x519000001d60[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x565420dbcd91[0m[39m bp [0m[1;36m0x7fff1d7a4750[0m[39m sp [0m[1;36m0x7fff1d7a4748[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m8[0m[39m at [0m[1;36m0x519000001d60[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m42[0m[39m [0m[1;39m([0m[1;36m8[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x565420dbcd90[0m[39m in Stream_Read [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m[39m:[0m[1;92m703:3[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x565420dbcd90[0m[39m in gcc_read_client_network_data [0m                              [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m1875:3[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x565420dbcd90[0m[39m in gcc_read_client_data_blocks [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m617:10[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x565420db700b[0m[39m in gcc_read_conference_create_request [0m                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m414:7[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x565420cff2ff[0m[39m in mcs_recv_connect_initial [0m                                  [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m[39m:[0m[1;92m700:7[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x565420ad6efb[0m[39m in freerdp_is_valid_mcs_create_request [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m[39m:[0m[1;92m1441:16[0m                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x565420a5e785[0m[39m in test_server [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x565420a5e785[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x565420915100[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x565420900375[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x565420905e0f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x5654209310b2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7f83ee933082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x5654208f855d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCoreServer+0x3d655d[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Stream_Read--gcc_read_client_network_data--gcc_read_client_data_blocks[0m [2m                [0m
[2;36m                    [0m         [1;36m0x519000001d60[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m992[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x519000001980[0m[39m,[0m[1;36m0x519000001d60[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x565420a21099[0m[39m in calloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x565420d049b6[0m[39m in mcs_new [0m[35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m[39m:[0m[1;92m1446:34[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x565420ad6ee4[0m[39m in freerdp_is_valid_mcs_create_request [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m[39m:[0m[1;92m1438:16[0m                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x565420a5e785[0m[39m in test_server [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x565420a5e785[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x565420915100[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x565420900375[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x565420905e0f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5654209310b2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x7f83ee933082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_calloc--mcs_new--freerdp_is_valid_mcs_create_request[0m     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m[39m:[0m[1;92m703:3[0m[39m in Stream_Read[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow vulnerability has been detected in FreeRDP's core library. [0m  [2m                [0m
[2;36m                    [0m         [39mThe issue occurs during the parsing of MCS [0m[1;39m([0m[39mMultipoint Communication Service[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mconnection requests, specifically when reading client network data from a GCC [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mGeneric Conference Control[0m[1;39m)[0m[39m data block. AddressSanitizer reports an [0m[1;36m8[0m[39m-byte write [0m  [2m                [0m
[2;36m                    [0m         [39moperation that overflows a [0m[1;36m992[0m[39m-byte heap-allocated buffer by attempting to write at[0m [2m                [0m
[2;36m                    [0m         [39mthe boundary address immediately after the allocated region.[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is a **heap-buffer-overflow** vulnerability with a SCARINESS score of [0m[1;36m42[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mindicating an [0m[1;36m8[0m[39m-byte write operation beyond the bounds of a heap-allocated buffer.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Details[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mThe overflow occurs in the following execution path:[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer test harness [0m[1;39m([0m[39m`TestFuzzCoreServer.c`[0m[1;39m)[0m[39m invokes [0m                        [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mfreerdp_is_valid_mcs_create_request[0m[1;39m([0m[1;39m)[0m[39m` to validate an MCS create request[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. This triggers `[0m[1;35mmcs_recv_connect_initial[0m[1;39m([0m[1;39m)[0m[39m` which processes the MCS connection [0m   [2m                [0m
[2;36m                    [0m         [39minitial PDU[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The code proceeds to `[0m[1;35mgcc_read_conference_create_request[0m[1;39m([0m[1;39m)[0m[39m` to parse GCC [0m        [2m                [0m
[2;36m                    [0m         [39mconference creation data[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Within this, `[0m[1;35mgcc_read_client_data_blocks[0m[1;39m([0m[1;39m)[0m[39m` is called to process client data [0m   [2m                [0m
[2;36m                    [0m         [39mblocks[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Finally, `[0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[1;39m)[0m[39m` attempts to read network data using [0m   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mStream_Read[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. The `[0m[1;35mStream_Read[0m[1;39m([0m[1;39m)[0m[39m` macro/function performs an [0m[1;36m8[0m[39m-byte write at address [0m          [2m                [0m
[2;36m                    [0m         [39m`[0m[1;36m0x519000001d60[0m[39m`, which is exactly at the boundary [0m[1;39m([0m[1;36m0[0m[39m bytes after[0m[1;39m)[0m[39m of a [0m[1;36m992[0m[39m-byte [0m   [2m                [0m
[2;36m                    [0m         [39mregion allocated from `[0m[1;36m0x519000001980[0m[39m` to `[0m[1;36m0x519000001d60[0m[39m`[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Buffer Allocation:**[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- The buffer is allocated in `[0m[1;35mmcs_new[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m1446[0m[39m in `mcs.c` using `[0m[1;35mcalloc[0m[1;39m([0m[1;39m)[0m[39m`[0m   [2m                [0m
[2;36m                    [0m         [39m- The allocated region size is [0m[1;36m992[0m[39m bytes[0m                                            [2m                [0m
[2;36m                    [0m         [39m- The allocation is part of MCS structure initialization during validation of an [0m   [2m                [0m
[2;36m                    [0m         [39mMCS create request[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Overflow Location:**[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- The write occurs at the exact boundary of the allocated buffer [0m[1;39m([0m[39m`[0m[1;36m0x519000001d60[0m[39m`[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m- This indicates an off-by-one error or insufficient bounds checking before the [0m    [2m                [0m
[2;36m                    [0m         [39mwrite operation[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- The overflow happens in `[0m[1;35mStream_Read[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m703[0m[39m of [0m                           [2m                [0m
[2;36m                    [0m         [39m`winpr/include/winpr/stream.h`[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Call Chain:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mThe issue manifests through the RDP protocol parsing stack:[0m                         [2m                [0m
[2;36m                    [0m         [39m- MCS layer: Connection initial processing[0m                                          [2m                [0m
[2;36m                    [0m         [39m- GCC layer: Conference create request and client data blocks parsing[0m               [2m                [0m
[2;36m                    [0m         [39m- Network data reading: Stream operations[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Code Areas for Investigation[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a holistic understanding of this vulnerability, the following components [0m [2m                [0m
[2;36m                    [0m         [39mshould be examined:[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Stream Operations** [0m[1;39m([0m[39m`winpr/include/winpr/stream.h:[0m[1;36m703[0m[39m`[0m[1;39m)[0m[39m:[0m                      [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35mStream_Read[0m[1;39m([0m[1;39m)[0m[39m` implementation and its bounds checking mechanisms[0m          [2m                [0m
[2;36m                    [0m         [39m   - How stream buffer sizes are tracked and validated before read/write operations[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **GCC Network Data Parsing** [0m[1;39m([0m[39m`libfreerdp/core/gcc.[0m[1;92mc:1875[0m[39m`[0m[1;39m)[0m[39m:[0m                     [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[1;39m)[0m[39m` function implementation[0m                   [2m                [0m
[2;36m                    [0m         [39m   - How it determines the size of data to read[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Validation of length fields from the incoming data stream[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **GCC Data Block Processing** [0m[1;39m([0m[39m`libfreerdp/core/gcc.[0m[1;92mc:617[0m[39m`[0m[1;39m)[0m[39m:[0m                     [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35mgcc_read_client_data_blocks[0m[1;39m([0m[1;39m)[0m[39m` function[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - How it iterates through multiple data blocks and calculates their sizes[0m        [2m                [0m
[2;36m                    [0m         [39m   - Validation of block count and individual block lengths[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **GCC Conference Request** [0m[1;39m([0m[39m`libfreerdp/core/gcc.[0m[1;92mc:414[0m[39m`[0m[1;39m)[0m[39m:[0m                        [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35mgcc_read_conference_create_request[0m[1;39m([0m[1;39m)[0m[39m` function[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Overall structure parsing and size calculations[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **MCS Connection Initial** [0m[1;39m([0m[39m`libfreerdp/core/mcs.[0m[1;92mc:700[0m[39m`[0m[1;39m)[0m[39m:[0m                        [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35mmcs_recv_connect_initial[0m[1;39m([0m[1;39m)[0m[39m` function[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Initial buffer allocation and size determination[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **MCS Structure Initialization** [0m[1;39m([0m[39m`libfreerdp/core/mcs.[0m[1;92mc:1446[0m[39m`[0m[1;39m)[0m[39m:[0m                 [2m                [0m
[2;36m                    [0m         [39m   - The `[0m[1;35mmcs_new[0m[1;39m([0m[1;39m)[0m[39m` function[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - How the [0m[1;36m992[0m[39m-byte buffer size is determined[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Whether this size accounts for all expected data to be read[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability appears to stem from inadequate validation of length fields in [0m   [2m                [0m
[2;36m                    [0m         [39mthe protocol data, allowing an attacker-controlled input to specify sizes that [0m     [2m                [0m
[2;36m                    [0m         [39mexceed the allocated buffer capacity. The parsing code should be reviewed to ensure[0m [2m                [0m
[2;36m                    [0m         [39mthat all length fields are properly validated against available buffer space before[0m [2m                [0m
[2;36m                    [0m         [39mperforming read operations.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x519000001d60[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x565420dbcd91[0m[39m bp [0m[1;36m0x7fff1d7a4750[0m[39m sp [0m[1;36m0x7fff1d7a4748[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m8[0m[39m at [0m[1;36m0x519000001d60[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m42[0m[39m [0m[1;39m([0m[1;36m8[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x565420dbcd90[0m[39m in Stream_Read [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m[39m:[0m[1;92m703:3[0m                                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x565420dbcd90[0m[39m in gcc_read_client_network_data [0m                              [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m1875:3[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x565420dbcd90[0m[39m in gcc_read_client_data_blocks [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m617:10[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x565420db700b[0m[39m in gcc_read_conference_create_request [0m                        [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mgcc.c[0m[39m:[0m[1;92m414:7[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x565420cff2ff[0m[39m in mcs_recv_connect_initial [0m                                  [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m[39m:[0m[1;92m700:7[0m                                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x565420ad6efb[0m[39m in freerdp_is_valid_mcs_create_request [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m[39m:[0m[1;92m1441:16[0m                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x565420a5e785[0m[39m in test_server [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x565420a5e785[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x565420915100[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x565420900375[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x565420905e0f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x5654209310b2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x7f83ee933082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x5654208f855d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCoreServer+0x3d655d[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: Stream_Read--gcc_read_client_network_data--gcc_read_client_data_blocks[0m [2m                [0m
[2;36m                    [0m         [1;36m0x519000001d60[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m992[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x519000001980[0m[39m,[0m[1;36m0x519000001d60[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x565420a21099[0m[39m in calloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m75:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x565420d049b6[0m[39m in mcs_new [0m[35m/src/FreeRDP/libfreerdp/core/[0m[95mmcs.c[0m[39m:[0m[1;92m1446:34[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x565420ad6ee4[0m[39m in freerdp_is_valid_mcs_create_request [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/[0m[95mfreerdp.c[0m[39m:[0m[1;92m1438:16[0m                                      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x565420a5e785[0m[39m in test_server [0m                                               [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m82:3[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x565420a5e785[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCoreServer.c[0m[39m:[0m[1;92m106:2[0m                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x565420915100[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x565420900375[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x565420905e0f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5654209310b2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x7f83ee933082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_calloc--mcs_new--freerdp_is_valid_mcs_create_request[0m     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/winpr/include/winpr/[0m[95mstream.h[0m[39m:[0m[1;92m703:3[0m[39m in Stream_Read[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mwinpr/include/winpr/stream.h:[0m[1;36m698[0m[39m-[0m[1;36m705[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:    [0m[39mstatic INLINE void [0m[1;35mStream_Read[0m[1;39m([0m[39mwStream* _s, void* _b, size_t _n[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39m_s[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m701[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39m_b || [0m[1;39m([0m[39m_n == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m702[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[1;35mStream_GetRemainingCapacity[0m[1;39m([0m[39m_s[0m[1;39m)[0m[39m >= _n[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m703[0m[39m:    [0m[39m        [0m[1;35mmemcpy[0m[1;39m([0m[39m_b, [0m[1;39m([0m[39m_s->pointer[0m[1;39m)[0m[39m, [0m[1;39m([0m[39m_n[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m704[0m[39m:    [0m[39m        [0m[1;35mStream_Seek[0m[1;39m([0m[39m_s, _n[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m705[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1848[0m[39m-[0m[1;36m1890[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1848:B[0m[39mOOL [0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1849[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1850[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1851[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1852[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1853[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1854[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1855[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1857[0m[39m:   [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1858[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1859[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1860[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1861[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1862[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1863[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1864[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1865[0m[39m:   [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1866[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1867[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1868[0m[39m:   [0m[39m        [0m[35m/[0m[39m**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1869[0m[39m:   [0m[39m        [0m[39m * CHANNEL_DEF[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1870[0m[39m:   [0m[39m        [0m[39m * - name: an [0m[1;36m8[0m[39m-byte array containing a null-terminated collection[0m  [2m                [0m
[2;36m                    [0m         [1;36m1871[0m[39m:   [0m[39m        [0m[39m *   of seven ANSI characters that uniquely identify the channel.[0m   [2m                [0m
[2;36m                    [0m         [1;36m1872[0m[39m:   [0m[39m        [0m[39m * - options: a [0m[1;36m32[0m[39m-bit, unsigned integer. Channel option flags[0m      [2m                [0m
[2;36m                    [0m         [1;36m1873[0m[39m:   [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1874[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1875[0m[39m:   [0m[39m        [0m[1;35mStream_Read[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* name [0m[1;39m([0m[1;36m8[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1876[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1877[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmemchr[0m[1;39m([0m[39mchannel->Name, [0m[1;36m0[0m[39m, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1878[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1879[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1880[0m[39m:   [0m[39m        [0m[39m        [0m[39m    TAG,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1881[0m[39m:   [0m[39m        [0m[39m        [0m[39m    [0m[32m"protocol violation: received a static channel name [0m    [2m                [0m
[2;36m                    [0m         [32mwith missing null-termination"[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1882[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1883[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1884[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1885[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* options [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m1886[0m[39m:   [0m[39m        [0m[39mchannel->ChannelId = mcs->baseChannelId++;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1887[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1888[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1889[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1890[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:578[0m[39m-[0m[1;36m699[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m578:B[0m[39mOOL [0m[1;35mgcc_read_client_data_blocks[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs, UINT16 length[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:    [0m[39mBOOL gotMultitransport = FALSE;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:    [0m[39mwhile [0m[1;39m([0m[39mlength > [0m[1;36m0[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:    [0m[39m        [0m[39mwStream sbuffer = [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:    [0m[39m        [0m[39mUINT16 type = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:    [0m[39m        [0m[39mUINT16 blockLength = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_user_data_header[0m[1;39m([0m[39ms, &type, &blockLength[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[39mblockLength [0m [2m                [0m
[2;36m                    [0m         [39m- [0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:    [0m[39m        [0m[39mwStream* sub = [0m[1;35mStream_StaticConstInit[0m[1;39m([0m[39m&sbuffer, [0m[1;35mStream_Pointer[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mblockLength - [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39msub[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:    [0m[39m        [0m[1;35mStream_Seek[0m[1;39m([0m[39ms, blockLength - [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m602[0m[39m:    [0m[39m        [0m[39mswitch [0m[1;39m([0m[39mtype[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m603[0m[39m:    [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m604[0m[39m:    [0m[39m        [0m[39m        [0m[39mcase CS_CORE:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m605[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_client_core_data[0m[1;39m([0m[39msub, mcs[0m[1;39m)[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m606[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m607[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m608[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m609[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m610[0m[39m:    [0m[39m        [0m[39m        [0m[39mcase CS_SECURITY:[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m611[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_client_security_data[0m[1;39m([0m[39msub, mcs[0m[1;39m)[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m612[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m613[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m614[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m615[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m616[0m[39m:    [0m[39m        [0m[39m        [0m[39mcase CS_NET:[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m617[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[39msub, mcs[0m[1;39m)[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m618[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m619[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m620[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m621[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m622[0m[39m:    [0m[39m        [0m[39m        [0m[39mcase CS_CLUSTER:[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m623[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_client_cluster_data[0m[1;39m([0m[39msub, mcs[0m[1;39m)[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m624[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m625[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m626[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m628[0m[39m:    [0m[39m        [0m[39m        [0m[39mcase CS_MONITOR:[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m629[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_client_monitor_data[0m[1;39m([0m[39msub, mcs[0m[1;39m)[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m630[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m631[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:    [0m[39m        [0m[39m        [0m[39mcase CS_MCS_MSGCHANNEL:[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_client_message_channel_data[0m[1;39m([0m[39msub, [0m     [2m                [0m
[2;36m                    [0m         [39mmcs[0m[1;39m)[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:    [0m[39m        [0m[39m        [0m[39mcase CS_MONITOR_EX:[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_client_monitor_extended_data[0m[1;39m([0m[39msub, [0m    [2m                [0m
[2;36m                    [0m         [39mmcs[0m[1;39m)[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:    [0m[39m        [0m[39m        [0m[39mcase CS_UNUSED1:[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_client_unused1_data[0m[1;39m([0m[39msub[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:    [0m[39m        [0m[39m        [0m[39mcase [0m[1;36m0xC009[0m[39m:[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:    [0m[39m        [0m[39m        [0m[39mcase CS_MULTITRANSPORT:[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mgotMultitransport = TRUE;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mif [0m                                                 [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m![0m[1;35mgcc_read_client_multitransport_channel_data[0m[1;39m([0m[39msub, mcs[0m[1;39m)[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:    [0m[39m        [0m[39m        [0m[39mdefault:[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"Unknown GCC client data block: [0m      [2m                [0m
[2;36m                    [0m         [32m0x%04"[0m[39m PRIX16 [0m[32m""[0m[39m, type[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;35mwinpr_HexDump[0m[1;39m([0m[39mTAG, WLOG_[0m[1;33mTRACE[0m[39m, [0m[1;35mStream_Pointer[0m[1;39m([0m[39msub[0m[1;39m)[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;35mStream_GetRemainingLength[0m[1;39m([0m[39msub[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:    [0m[39m        [0m[39mconst size_t rem = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39msub[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mrem > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:    [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:    [0m[39m        [0m[39m        [0m[39mchar buffer[0m[1;39m[[0m[1;36m128[0m[1;39m][0m[39m = [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:    [0m[39m        [0m[39m        [0m[39mconst size_t total = [0m[1;35mStream_Length[0m[1;39m([0m[39msub[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:    [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG,[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:    [0m[39m        [0m[39m        [0m[39m         [0m[32m"Error parsing GCC client data block %s: Actual [0m   [2m                [0m
[2;36m                    [0m         [32mOffset: %"[0m[39m PRIuz[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:    [0m[39m        [0m[39m        [0m[39m         [0m[32m" Expected Offset: %"[0m[39m PRIuz,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:    [0m[39m        [0m[39m        [0m[39m         [0m[1;35mgcc_block_type_string[0m[1;39m([0m[39mtype, buffer, [0m               [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[1;39m)[0m[39m, total - rem, total[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mblockLength > length[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:    [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:    [0m[39m        [0m[39m        [0m[39mchar buffer[0m[1;39m[[0m[1;36m128[0m[1;39m][0m[39m = [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:    [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG,[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:    [0m[39m        [0m[39m        [0m[39m         [0m[32m"Error parsing GCC client data block %s: got [0m      [2m                [0m
[2;36m                    [0m         [32mblockLength 0x%04"[0m[39m PRIx16[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:    [0m[39m        [0m[39m        [0m[39m         [0m[32m", but only 0x%04"[0m[39m PRIx16 [0m[32m"remaining"[0m[39m,[0m             [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:    [0m[39m        [0m[39m        [0m[39m         [0m[1;35mgcc_block_type_string[0m[1;39m([0m[39mtype, buffer, [0m               [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[1;39m)[0m[39m, blockLength, length[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:    [0m[39m        [0m[39m        [0m[39mlength = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m685[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m686[0m[39m:    [0m[39m        [0m[39melse[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m687[0m[39m:    [0m[39m        [0m[39m        [0m[39mlength -= blockLength;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m688[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m689[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m690[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!gotMultitransport[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m691[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m692[0m[39m:    [0m[39m        [0m[39mrdpSettings* settings = [0m[1;35mmcs_get_settings[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m693[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mfreerdp_settings_set_bool[0m[1;39m([0m[39msettings, [0m                           [2m                [0m
[2;36m                    [0m         [39mFreeRDP_SupportMultitransport, FALSE[0m[1;39m)[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m694[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m695[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mfreerdp_settings_set_uint32[0m[1;39m([0m[39msettings, [0m                         [2m                [0m
[2;36m                    [0m         [39mFreeRDP_MultitransportFlags, [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m696[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m697[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:    [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:360[0m[39m-[0m[1;36m418[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m360:B[0m[39mOOL [0m[1;35mgcc_read_conference_create_request[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:    [0m[39mUINT16 length = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:    [0m[39mBYTE choice = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:    [0m[39mBYTE number = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:    [0m[39mBYTE selection = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:    [0m[35m/[0m[39m* ConnectData *[0m[35m/[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_choice[0m[1;39m([0m[39ms, &choice[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_object_identifier[0m[1;39m([0m[39ms, t124_02_98_oid[0m[1;39m)[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:    [0m[35m/[0m[39m* ConnectDat[0m[1;92ma::c[0m[39monnectPDU [0m[1;39m([0m[39mOCTET_STRING[0m[1;39m)[0m[39m *[0m[35m/[0m                                [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_length[0m[1;39m([0m[39ms, &length[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:    [0m[35m/[0m[39m* ConnectGCCPDU *[0m[35m/[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_choice[0m[1;39m([0m[39ms, &choice[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_selection[0m[1;39m([0m[39ms, &selection[0m[1;39m)[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    [0m[35m/[0m[39m* ConferenceCreateRequest::conferenceName *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_numeric_string[0m[1;39m([0m[39ms, [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m [0m[35m/[0m[39m* ConferenceName::numeric *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_padding[0m[1;39m([0m[39ms, [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m [0m[35m/[0m[39m* padding *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[35m/[0m[39m* UserData [0m[1;39m([0m[39mSET OF SEQUENCE[0m[1;39m)[0m[39m *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_number_of_sets[0m[1;39m([0m[39ms, &number[0m[1;39m)[0m[39m || number != [0m[1;36m1[0m[1;39m)[0m[39m [0m[35m/[0m[39m* one set of [0m     [2m                [0m
[2;36m                    [0m         [39mUserData *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_choice[0m[1;39m([0m[39ms, &choice[0m[1;39m)[0m[39m ||[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:    [0m[39m    choice != [0m[1;36m0xC0[0m[1;39m)[0m[39m [0m[35m/[0m[39m* UserData::value present + select h221NonStandard [0m[1;39m([0m[1;36m1[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m*[0m[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:    [0m[35m/[0m[39m* h221NonStandard *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_octet_string[0m[1;39m([0m[39ms, h221_cs_key, [0m[1;36m4[0m[39m,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:    [0m[39m                           [0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m [0m[35m/[0m[39m* h221NonStandard, client-to-server H.[0m[1;36m221[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mkey, [0m[32m"Duca"[0m[39m *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:    [0m[35m/[0m[39m* userData::value [0m[1;39m([0m[39mOCTET_STRING[0m[1;39m)[0m[39m *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mper_read_length[0m[1;39m([0m[39ms, &length[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, length[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_client_data_blocks[0m[1;39m([0m[39ms, mcs, length[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:    [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.[0m[1;92mc:1430[0m[39m-[0m[1;36m1455[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1430[0m[39m:rdpMcs* [0m[1;35mmcs_new[0m[1;39m([0m[39mrdpTransport* transport[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1431[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1432[0m[39m:   [0m[39mrdpMcs* mcs = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1433[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1434[0m[39m:   [0m[39mmcs = [0m[1;39m([0m[39mrdpMcs*[0m[1;39m)[0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mrdpMcs[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1435[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1436[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!mcs[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1437[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1438[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1439[0m[39m:   [0m[39mmcs->transport = transport;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1440[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->targetParameters, [0m[1;36m34[0m[39m, [0m[1;36m2[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0xFFFF[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1441[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->minimumParameters, [0m[1;36m1[0m[39m, [0m[1;36m1[0m[39m, [0m[1;36m1[0m[39m, [0m[1;36m0x420[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1442[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->maximumParameters, [0m[1;36m0xFFFF[0m[39m, [0m[1;36m0xFC17[0m[39m, [0m[1;36m0xFFFF[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m0xFFFF[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1443[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->domainParameters, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0xFFFF[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1444[0m[39m:   [0m[39mmcs->channelCount = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:   [0m[39mmcs->baseChannelId = MCS_GLOBAL_CHANNEL_ID + [0m[1;36m1[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1446[0m[39m:   [0m[39mmcs->channels = [0m[1;39m([0m[39mrdpMcsChannel*[0m[1;39m)[0m[1;35mcalloc[0m[1;39m([0m[39mCHANNEL_MAX_COUNT, [0m                  [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mrdpMcsChannel[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1447[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1448[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!mcs->channels[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:   [0m[39m        [0m[39mgoto out_free;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:   [0m[39mreturn mcs;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:out_free:[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1453[0m[39m:   [0m[1;35mfree[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1454[0m[39m:   [0m[39mreturn NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1455[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mwinpr/include/winpr/wtsapi.h:[0m[1;36m74[0m[39m-[0m[1;36m75[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:#define CHANNEL_MAX_COUNT [0m[1;36m31[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:#define CHANNEL_NAME_LEN [0m[1;36m7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mwinpr/libwinpr/utils/stream.[0m[1;92mc:127[0m[39m-[0m[1;36m137[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:wStream* [0m[1;35mStream_StaticConstInit[0m[1;39m([0m[39mwStream* s, const BYTE* buffer, size_t size[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[39munion[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[39m        [0m[39mBYTE* b;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39m        [0m[39mconst BYTE* cb;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[1;39m}[0m[39m cnv;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[39mcnv.cb = buffer;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[39mreturn [0m[1;35mStream_StaticInit[0m[1;39m([0m[39ms, cnv.b, size[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mwinpr/libwinpr/utils/stream.[0m[1;92mc:251[0m[39m-[0m[1;36m265[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:size_t [0m[1;35mStream_GetRemainingCapacity[0m[1;39m([0m[39mconst wStream* _s[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39msize_t cur = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39m_s[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39m_s->buffer <= _s->pointer[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[39mcur = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[39m_s->pointer - _s->buffer[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcur <= _s->capacity[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39mif [0m[1;39m([0m[39mcur > _s->capacity[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:    [0m[39m        [0m[1;35mWLog_FATAL[0m[1;39m([0m[39mSTREAM_TAG, [0m[32m"wStream API misuse: stream was written out [0m [2m                [0m
[2;36m                    [0m         [32mof bounds"[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:    [0m[39m        [0m[1;35mwinpr_log_backtrace[0m[1;39m([0m[39mSTREAM_TAG, WLOG_FATAL, [0m[1;36m20[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:    [0m[39mreturn [0m[1;39m([0m[39m_s->capacity - cur[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m118[0m[39m-[0m[1;36m126[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:struct rdp_mcs_channel[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mchar Name[0m[1;39m[[0m[39mCHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39mUINT32 options;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39mUINT16 ChannelId;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39mBOOL joined;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[39mvoid* handle;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:typedef struct rdp_mcs_channel rdpMcsChannel;[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mwinpr/libwinpr/utils/stream.[0m[1;92mc:139[0m[39m-[0m[1;36m154[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:wStream* [0m[1;35mStream_StaticInit[0m[1;39m([0m[39mwStream* s, BYTE* buffer, size_t size[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39mconst wStream empty = [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[39m*s = empty;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39ms->buffer = s->pointer = buffer;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39ms->capacity = s->length = size;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    [0m[39ms->pool = NULL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[39ms->count = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[39ms->isAllocatedStream = FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[39ms->isOwner = FALSE;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    [0m[39mreturn s;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mwinpr/libwinpr/utils/stream.[0m[1;92mc:267[0m[39m-[0m[1;36m282[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:size_t [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39mconst wStream* _s[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:    [0m[39msize_t cur = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39m_s[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39m_s->buffer <= _s->pointer[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39m_s->length <= _s->capacity[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:    [0m[39mcur = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[39m_s->pointer - _s->buffer[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcur <= _s->length[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:    [0m[39mif [0m[1;39m([0m[39mcur > _s->length[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:    [0m[39m        [0m[1;35mWLog_FATAL[0m[1;39m([0m[39mSTREAM_TAG, [0m[32m"wStream API misuse: stream was read out of [0m [2m                [0m
[2;36m                    [0m         [32mbounds"[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:    [0m[39m        [0m[1;35mwinpr_log_backtrace[0m[1;39m([0m[39mSTREAM_TAG, WLOG_FATAL, [0m[1;36m20[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:    [0m[39mreturn [0m[1;39m([0m[39m_s->length - cur[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m128[0m[39m-[0m[1;36m149[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:struct rdp_mcs[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[39mrdpTransport* transport;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39mUINT16 userId;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[39mUINT16 baseChannelId;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[39mUINT16 messageChannelId;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    [0m[39mUINT32 flags;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    [0m[39mDomainParameters domainParameters;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[39mDomainParameters targetParameters;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[39mDomainParameters minimumParameters;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39mDomainParameters maximumParameters;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[39mBOOL userChannelJoined;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[39mBOOL globalChannelJoined;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[39mBOOL messageChannelJoined;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39mINT8 channelCount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39mrdpMcsChannel* channels;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1157[0m[39m-[0m[1;36m1203[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1157:B[0m[39mOOL [0m[1;35mgcc_read_client_core_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:   [0m[39mchar buffer[0m[1;39m[[0m[1;36m2048[0m[1;39m][0m[39m = [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:   [0m[39mchar strbuffer[0m[1;39m[[0m[1;36m130[0m[1;39m][0m[39m = [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:   [0m[39mUINT32 version = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1162[0m[39m:   [0m[39mBYTE connectionType = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1163[0m[39m:   [0m[39mUINT32 clientColorDepth = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1164[0m[39m:   [0m[39mUINT16 colorDepth = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1165[0m[39m:   [0m[39mUINT16 postBeta2ColorDepth = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1166[0m[39m:   [0m[39mUINT16 highColorDepth = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1167[0m[39m:   [0m[39mUINT32 serverSelectedProtocol = [0m[1;36m0[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1168[0m[39m:   [0m[39mrdpSettings* settings = [0m[1;35mmcs_get_settings[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1169[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1170[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1171[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39msettings[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1172[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1173[0m[39m:   [0m[39msize_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1174[0m[39m:   [0m[35m/[0m[39m* Length of all required fields, until imeFileName *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1175[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m128[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1176[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1177[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1178[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, version[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* version [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1179[0m[39m:   [0m[39msettings->RdpVersion = [0m[1;35mrdp_version_common[0m[1;39m([0m[39mversion, settings->RdpVersion[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m1180[0m[39m:   [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, settings->DesktopWidth[0m[1;39m)[0m[39m;  [0m[35m/[0m[39m* DesktopWidth [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39m*[0m[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1181[0m[39m:   [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, settings->DesktopHeight[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* DesktopHeight [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m*[0m[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1182[0m[39m:   [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, colorDepth[0m[1;39m)[0m[39m;              [0m[35m/[0m[39m* ColorDepth [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m  [2m                [0m
[2;36m                    [0m         [1;36m1183[0m[39m:   [0m[1;35mStream_Seek_UINT16[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* SASSequence [0m[1;39m([0m[39mSecure Access Sequence[0m[1;39m)[0m[39m [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m [2m                [0m
[2;36m                    [0m         [1;36m1184[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, settings->KeyboardLayout[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* KeyboardLayout [0m[1;39m([0m[1;36m4[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1185[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, settings->ClientBuild[0m[1;39m)[0m[39m;    [0m[35m/[0m[39m* ClientBuild [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39m*[0m[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1186[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1187[0m[39m:   [0m[35m/[0m[39m* clientName [0m[1;39m([0m[1;36m32[0m[39m bytes, null-terminated unicode, truncated to [0m[1;36m15[0m[39m [0m          [2m                [0m
[2;36m                    [0m         [39mcharacters[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1188[0m[39m:   [0m[39mif [0m[1;39m([0m[1;35mStream_Read_UTF16_String_As_UTF8_Buffer[0m[1;39m([0m[39ms, [0m[1;36m32[0m[39m [0m[35m/[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39mWCHAR[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [39mstrbuffer,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1189[0m[39m:   [0m[39m                                            [0m[1;35mARRAYSIZE[0m[1;39m([0m[39mstrbuffer[0m[1;39m)[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m1190[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1191[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to convert client host name"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1192[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1193[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1194[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1195[0m[39m:   [0m[39mif [0m[1;39m([0m[39m![0m[1;35mfreerdp_settings_set_string[0m[1;39m([0m[39msettings, FreeRDP_ClientHostname, [0m         [2m                [0m
[2;36m                    [0m         [39mstrbuffer[0m[1;39m)[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1196[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1197[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1198[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, settings->KeyboardType[0m[1;39m)[0m[39m;        [0m[35m/[0m[39m* KeyboardType [0m[1;39m([0m[1;36m4[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1199[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, settings->KeyboardSubType[0m[1;39m)[0m[39m;     [0m[35m/[0m[39m* KeyboardSubType [0m[1;39m([0m[1;36m4[0m [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1200[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, settings->KeyboardFunctionKey[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* [0m                   [2m                [0m
[2;36m                    [0m         [39mKeyboardFunctionKey [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1201[0m[39m:   [0m[1;35mStream_Seek[0m[1;39m([0m[39ms, [0m[1;36m64[0m[1;39m)[0m[39m;                                   [0m[35m/[0m[39m* imeFileName [0m[1;39m([0m[1;36m64[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1202[0m[39m:   [0m[39mblockLength -= [0m[1;36m128[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1203[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:919[0m[39m-[0m[1;36m932[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m919:B[0m[39mOOL [0m[1;35mgcc_read_user_data_header[0m[1;39m([0m[39mwStream* s, UINT16* type, UINT16* length[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, [0m[1;36m4[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:    [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, *type[0m[1;39m)[0m[39m;   [0m[35m/[0m[39m* type *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:    [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, *length[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* length *[0m[35m/[0m                                [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39m*length < [0m[1;36m4[0m[1;39m)[0m[39m || [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, [0m            [2m                [0m
[2;36m                    [0m         [1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[39m*length - [0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:    [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m930[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m931[0m[39m:    [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m932[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1557[0m[39m-[0m[1;36m1583[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1557:B[0m[39mOOL [0m[1;35mgcc_read_client_security_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39mrdpSettings* settings = [0m[1;35mmcs_get_settings[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39msettings[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m8[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:   [0m[39mif [0m[1;39m([0m[39msettings->UseRdpSecurityLayer[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, settings->EncryptionMethods[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* [0m             [2m                [0m
[2;36m                    [0m         [39mencryptionMethods *[0m[35m/[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39msettings->EncryptionMethods == ENCRYPTION_METHOD_NONE[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, settings->EncryptionMethods[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* [0m     [2m                [0m
[2;36m                    [0m         [39mextEncryptionMethods *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:   [0m[39m        [0m[39melse[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1575[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Seek[0m[1;39m([0m[39ms, [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:   [0m[39melse[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:   [0m[39m        [0m[1;35mStream_Seek[0m[1;39m([0m[39ms, [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1581[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1582[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1583[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1857[0m[39m-[0m[1;36m1863[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1857[0m[39m:   [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1858[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1859[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1860[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1861[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1862[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1863[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m147[0m[39m-[0m[1;36m148[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39mINT8 channelCount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39mrdpMcsChannel* channels;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/peer.[0m[1;92mc:67[0m[39m-[0m[1;36m77[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     [0m[39mconst size_t length = [0m[1;35mstrnlen[0m[1;39m([0m[39mname, [0m[1;36m9[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     [0m[39mif [0m[1;39m([0m[39mlength > [0m[1;36m8[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39m        [0m[39mreturn NULL; [0m[35m/[0m[39m* SVC maximum name length is [0m[1;36m8[0m[39m *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[39mfor [0m[1;39m([0m[39m; index < mcs->channelCount; index++[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[39m        [0m[39mmcsChannel = &[0m[1;39m([0m[39mmcs->channels[0m[1;39m[[0m[39mindex[0m[1;39m][0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39m!mcsChannel->joined[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/channels.[0m[1;92mc:61[0m[39m-[0m[1;36m70[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mrdp[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mdata || [0m[1;39m([0m[39msize == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     [0m[39mmcs = rdp->mcs;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     [0m[39m        [0m[39mconst rdpMcsChannel* cur = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39mcur->ChannelId == channelId[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/channels.[0m[1;92mc:178[0m[39m-[0m[1;36m188[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39mBOOL found = FALSE;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39mHANDLE hChannel = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[39m        [0m[39mrdpContext* context = client->context;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[39m        [0m[39mrdpMcs* mcs = context->rdp->mcs;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:    [0m[39m        [0m[39mfor [0m[1;39m([0m[39mUINT32 index = [0m[1;36m0[0m[39m; index < mcs->channelCount; index++[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:    [0m[39m        [0m[39m        [0m[39mconst rdpMcsChannel* mcsChannel = &[0m[1;39m([0m[39mmcs->channels[0m[1;39m[[0m[39mindex[0m[1;39m][0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mmcsChannel->ChannelId == channelId[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:578[0m[39m-[0m[1;36m601[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m578:B[0m[39mOOL [0m[1;35mgcc_read_client_data_blocks[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs, UINT16 length[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:    [0m[39mBOOL gotMultitransport = FALSE;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:    [0m[39mwhile [0m[1;39m([0m[39mlength > [0m[1;36m0[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:    [0m[39m        [0m[39mwStream sbuffer = [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:    [0m[39m        [0m[39mUINT16 type = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:    [0m[39m        [0m[39mUINT16 blockLength = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_user_data_header[0m[1;39m([0m[39ms, &type, &blockLength[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[39mblockLength [0m [2m                [0m
[2;36m                    [0m         [39m- [0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:    [0m[39m        [0m[39mwStream* sub = [0m[1;35mStream_StaticConstInit[0m[1;39m([0m[39m&sbuffer, [0m[1;35mStream_Pointer[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mblockLength - [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39msub[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:    [0m[39m        [0m[1;35mStream_Seek[0m[1;39m([0m[39ms, blockLength - [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1901[0m[39m-[0m[1;36m1920[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1901:B[0m[39mOOL [0m[1;35mgcc_write_client_network_data[0m[1;39m([0m[39mwStream* s, const rdpMcs* mcs[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m1902[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1903[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1904[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1905[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > [0m[1;36m0[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1906[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1907[0m[39m:   [0m[39m        [0m[39mconst size_t length = mcs->channelCount * [0m[1;36m12[0m[39m + [0m[1;36m8[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1908[0m[39m:   [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mlength <= UINT16_MAX[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1909[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_write_user_data_header[0m[1;39m([0m[39ms, CS_NET, [0m[1;39m([0m[39mUINT16[0m[1;39m)[0m[39mlength[0m[1;39m)[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m1910[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1911[0m[39m:   [0m[39m        [0m[1;35mStream_Write_UINT32[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m1912[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1913[0m[39m:   [0m[39m        [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1914[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1915[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1916[0m[39m:   [0m[39m        [0m[39m        [0m[35m/[0m[39m* CHANNEL_DEF *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1917[0m[39m:   [0m[39m        [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1918[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Write[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* [0m   [2m                [0m
[2;36m                    [0m         [39mname [0m[1;39m([0m[1;36m8[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1919[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Write_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m;             [0m[35m/[0m[39m* [0m   [2m                [0m
[2;36m                    [0m         [39moptions [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1920[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.[0m[1;92mc:301[0m[39m-[0m[1;36m320[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:static int [0m[1;35mmcs_initialize_client_channels[0m[1;39m([0m[39mrdpMcs* mcs, const rdpSettings* [0m      [2m                [0m
[2;36m                    [0m         [39msettings[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!mcs || !settings[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m-1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:    [0m[39mmcs->channelCount = [0m[1;35mfreerdp_settings_get_uint32[0m[1;39m([0m[39msettings, [0m                  [2m                [0m
[2;36m                    [0m         [39mFreeRDP_ChannelCount[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:    [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:    [0m[39m        [0m[39mmcs->channelCount = CHANNEL_MAX_COUNT;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:    [0m[1;35mZeroMemory[0m[1;39m([0m[39mmcs->channels, [0m[1;35msizeof[0m[1;39m([0m[39mrdpMcsChannel[0m[1;39m)[0m[39m * CHANNEL_MAX_COUNT[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mUINT32 index = [0m[1;36m0[0m[39m; index < mcs->channelCount; index++[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:    [0m[39m        [0m[39mconst CHANNEL_DEF* defchannel =[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:    [0m[39m        [0m[39m    [0m[1;35mfreerdp_settings_get_pointer_array[0m[1;39m([0m[39msettings, [0m                   [2m                [0m
[2;36m                    [0m         [39mFreeRDP_ChannelDefArray, index[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:    [0m[39m        [0m[39mrdpMcsChannel* cur = &mcs->channels[0m[1;39m[[0m[39mindex[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mdefchannel[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:    [0m[39m        [0m[1;35mCopyMemory[0m[1;39m([0m[39mcur->Name, defchannel->name, CHANNEL_NAME_LEN[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:    [0m[39m        [0m[39mcur->options = defchannel->options;[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1848[0m[39m-[0m[1;36m1890[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1848:B[0m[39mOOL [0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1849[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1850[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1851[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1852[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1853[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1854[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1855[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1857[0m[39m:   [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1858[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1859[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1860[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1861[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1862[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1863[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1864[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1865[0m[39m:   [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1866[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1867[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1868[0m[39m:   [0m[39m        [0m[35m/[0m[39m**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1869[0m[39m:   [0m[39m        [0m[39m * CHANNEL_DEF[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1870[0m[39m:   [0m[39m        [0m[39m * - name: an [0m[1;36m8[0m[39m-byte array containing a null-terminated collection[0m  [2m                [0m
[2;36m                    [0m         [1;36m1871[0m[39m:   [0m[39m        [0m[39m *   of seven ANSI characters that uniquely identify the channel.[0m   [2m                [0m
[2;36m                    [0m         [1;36m1872[0m[39m:   [0m[39m        [0m[39m * - options: a [0m[1;36m32[0m[39m-bit, unsigned integer. Channel option flags[0m      [2m                [0m
[2;36m                    [0m         [1;36m1873[0m[39m:   [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1874[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1875[0m[39m:   [0m[39m        [0m[1;35mStream_Read[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* name [0m[1;39m([0m[1;36m8[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1876[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1877[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmemchr[0m[1;39m([0m[39mchannel->Name, [0m[1;36m0[0m[39m, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1878[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1879[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1880[0m[39m:   [0m[39m        [0m[39m        [0m[39m    TAG,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1881[0m[39m:   [0m[39m        [0m[39m        [0m[39m    [0m[32m"protocol violation: received a static channel name [0m    [2m                [0m
[2;36m                    [0m         [32mwith missing null-termination"[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1882[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1883[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1884[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1885[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* options [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m1886[0m[39m:   [0m[39m        [0m[39mchannel->ChannelId = mcs->baseChannelId++;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1887[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1888[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1889[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1890[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:578[0m[39m-[0m[1;36m601[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m578:B[0m[39mOOL [0m[1;35mgcc_read_client_data_blocks[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs, UINT16 length[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:    [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:    [0m[39mBOOL gotMultitransport = FALSE;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:    [0m[39mwhile [0m[1;39m([0m[39mlength > [0m[1;36m0[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:    [0m[39m        [0m[39mwStream sbuffer = [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:    [0m[39m        [0m[39mUINT16 type = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:    [0m[39m        [0m[39mUINT16 blockLength = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_read_user_data_header[0m[1;39m([0m[39ms, &type, &blockLength[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[1;39m([0m[39mblockLength [0m [2m                [0m
[2;36m                    [0m         [39m- [0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:    [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:    [0m[39m        [0m[39mwStream* sub = [0m[1;35mStream_StaticConstInit[0m[1;39m([0m[39m&sbuffer, [0m[1;35mStream_Pointer[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mblockLength - [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39msub[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:    [0m[39m        [0m[1;35mStream_Seek[0m[1;39m([0m[39ms, blockLength - [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mwinpr/include/winpr/stream.h:[0m[1;36m143[0m[39m-[0m[1;36m152[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[39mstatic INLINE UINT8 [0m[1;35mstream_read_u8[0m[1;39m([0m[39mwStream* _s, BOOL seek[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39m_s[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39m_s[0m[1;39m)[0m[39m >= [0m[1;35msizeof[0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39m        [0m[39mconst UINT8 v = [0m[1;35mwinpr_Data_Get_UINT8[0m[1;39m([0m[39m_s->pointer[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mseek[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    [0m[39m        [0m[39m        [0m[1;35mStream_Seek[0m[1;39m([0m[39m_s, [0m[1;35msizeof[0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[39m        [0m[39mreturn v;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mwinpr/include/winpr/stream.h:[0m[1;36m614[0m[39m-[0m[1;36m619[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m614[0m[39m:#define [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39m_s, _v[0m[1;39m)[0m[39m      \[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m615[0m[39m:    [0m[39mdo                                 \[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m616[0m[39m:    [0m[1;39m{[0m[39m                                  \[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m617[0m[39m:    [0m[39m        [0m[39m_v = [0m[1;35mstream_read_u8[0m[1;39m([0m[39m_s, TRUE[0m[1;39m)[0m[39m; \[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m618[0m[39m:    [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m619[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1901[0m[39m-[0m[1;36m1920[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1901:B[0m[39mOOL [0m[1;35mgcc_write_client_network_data[0m[1;39m([0m[39mwStream* s, const rdpMcs* mcs[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m1902[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1903[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1904[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1905[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > [0m[1;36m0[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1906[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1907[0m[39m:   [0m[39m        [0m[39mconst size_t length = mcs->channelCount * [0m[1;36m12[0m[39m + [0m[1;36m8[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1908[0m[39m:   [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mlength <= UINT16_MAX[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1909[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_write_user_data_header[0m[1;39m([0m[39ms, CS_NET, [0m[1;39m([0m[39mUINT16[0m[1;39m)[0m[39mlength[0m[1;39m)[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m1910[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1911[0m[39m:   [0m[39m        [0m[1;35mStream_Write_UINT32[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m1912[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1913[0m[39m:   [0m[39m        [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1914[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1915[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1916[0m[39m:   [0m[39m        [0m[39m        [0m[35m/[0m[39m* CHANNEL_DEF *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1917[0m[39m:   [0m[39m        [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1918[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Write[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* [0m   [2m                [0m
[2;36m                    [0m         [39mname [0m[1;39m([0m[1;36m8[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1919[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Write_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m;             [0m[35m/[0m[39m* [0m   [2m                [0m
[2;36m                    [0m         [39moptions [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1920[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1925[0m[39m-[0m[1;36m1971[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1925:B[0m[39mOOL [0m[1;35mgcc_read_server_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1926[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1927[0m[39m:   [0m[39mUINT16 channelId = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1928[0m[39m:   [0m[39mUINT16 MCSChannelId = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1929[0m[39m:   [0m[39mUINT16 channelCount = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1930[0m[39m:   [0m[39mINT8 parsedChannelCount = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1931[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1932[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1933[0m[39m:   [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, [0m[1;36m4[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1934[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1935[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1936[0m[39m:   [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, MCSChannelId[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* MCSChannelId *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1937[0m[39m:   [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1938[0m[39m:   [0m[39mparsedChannelCount = channelCount;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1939[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1940[0m[39m:   [0m[39mif [0m[1;39m([0m[39mchannelCount != mcs->channelCount[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1941[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1942[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"requested %"[0m[39m PRIu32 [0m[32m" channels, got %"[0m[39m PRIu16 [0m[32m" [0m     [2m                [0m
[2;36m                    [0m         [32minstead"[0m[39m, mcs->channelCount,[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1943[0m[39m:   [0m[39m        [0m[39m         channelCount[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1944[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1945[0m[39m:   [0m[39m        [0m[35m/[0m[39m* we ensure that the response is not bigger than the request *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m1946[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1947[0m[39m:   [0m[39m        [0m[39mmcs->channelCount = channelCount;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1948[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1949[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1950[0m[39m:   [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLengthOfSize[0m[1;39m([0m[39mTAG, s, channelCount, 2ull[0m[1;39m)[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m1951[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1952[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1953[0m[39m:   [0m[39mif [0m[1;39m([0m[39mCHANNEL_MAX_COUNT < parsedChannelCount[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1954[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1955[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"requested %"[0m[39m PRIu32 [0m[32m" channels > [0m                    [2m                [0m
[2;36m                    [0m         [32mCHANNEL_MAX_COUNT[0m[32m([0m[32m31[0m[32m)[0m[32m %"[0m[39m PRIu16,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1956[0m[39m:   [0m[39m        [0m[39m         mcs->channelCount, CHANNEL_MAX_COUNT[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1957[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1958[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1959[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1960[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < parsedChannelCount; i++[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1961[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1962[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1963[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, channelId[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelId *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1964[0m[39m:   [0m[39m        [0m[39mchannel->ChannelId = channelId;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1965[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1966[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1967[0m[39m:   [0m[39mif [0m[1;39m([0m[39mchannelCount % [0m[1;36m2[0m[39m == [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1968[0m[39m:   [0m[39m        [0m[39mreturn [0m[1;35mStream_SafeSeek[0m[1;39m([0m[39ms, [0m[1;36m2[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* padding *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1969[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1970[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1971[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1848[0m[39m-[0m[1;36m1865[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1848:B[0m[39mOOL [0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1849[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1850[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1851[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1852[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1853[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1854[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1855[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1857[0m[39m:   [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1858[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1859[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1860[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1861[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1862[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1863[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1864[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1865[0m[39m:   [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1838[0m[39m-[0m[1;36m1890[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1838[0m[39m:[0m[35m/[0m[39m**[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1839[0m[39m: * Read a client network data block [0m[1;39m([0m[39mTS_UD_CS_NET[0m[1;39m)[0m[39m.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1840[0m[39m: * msdn[0m[1;39m{[0m[39mcc240512[0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1841[0m[39m: *[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1842[0m[39m: * @param s stream[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1843[0m[39m: * @param mcs The MCS instance[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1844[0m[39m: *[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1845[0m[39m: * @return \b TRUE for success, \b FALSE otherwise[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1846[0m[39m: *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1847[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1848:B[0m[39mOOL [0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1849[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1850[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1851[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1852[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1853[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1854[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1855[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1857[0m[39m:   [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1858[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1859[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1860[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1861[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1862[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1863[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1864[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1865[0m[39m:   [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1866[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1867[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1868[0m[39m:   [0m[39m        [0m[35m/[0m[39m**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1869[0m[39m:   [0m[39m        [0m[39m * CHANNEL_DEF[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1870[0m[39m:   [0m[39m        [0m[39m * - name: an [0m[1;36m8[0m[39m-byte array containing a null-terminated collection[0m  [2m                [0m
[2;36m                    [0m         [1;36m1871[0m[39m:   [0m[39m        [0m[39m *   of seven ANSI characters that uniquely identify the channel.[0m   [2m                [0m
[2;36m                    [0m         [1;36m1872[0m[39m:   [0m[39m        [0m[39m * - options: a [0m[1;36m32[0m[39m-bit, unsigned integer. Channel option flags[0m      [2m                [0m
[2;36m                    [0m         [1;36m1873[0m[39m:   [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1874[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1875[0m[39m:   [0m[39m        [0m[1;35mStream_Read[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* name [0m[1;39m([0m[1;36m8[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1876[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1877[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmemchr[0m[1;39m([0m[39mchannel->Name, [0m[1;36m0[0m[39m, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1878[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1879[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1880[0m[39m:   [0m[39m        [0m[39m        [0m[39m    TAG,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1881[0m[39m:   [0m[39m        [0m[39m        [0m[39m    [0m[32m"protocol violation: received a static channel name [0m    [2m                [0m
[2;36m                    [0m         [32mwith missing null-termination"[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1882[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1883[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1884[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1885[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* options [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m1886[0m[39m:   [0m[39m        [0m[39mchannel->ChannelId = mcs->baseChannelId++;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1887[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1888[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1889[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1890[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1892[0m[39m-[0m[1;36m1920[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1892[0m[39m:[0m[35m/[0m[39m**[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1893[0m[39m: * Write a client network data block [0m[1;39m([0m[39mTS_UD_CS_NET[0m[1;39m)[0m[39m.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1894[0m[39m: * msdn[0m[1;39m{[0m[39mcc240512[0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1895[0m[39m: * @param s stream[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1896[0m[39m: * @param mcs The MCS to use[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1897[0m[39m: *[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1898[0m[39m: * @return \b TRUE for success, \b FALSE otherwise[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1899[0m[39m: *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1900[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1901:B[0m[39mOOL [0m[1;35mgcc_write_client_network_data[0m[1;39m([0m[39mwStream* s, const rdpMcs* mcs[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m1902[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1903[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1904[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1905[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > [0m[1;36m0[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1906[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1907[0m[39m:   [0m[39m        [0m[39mconst size_t length = mcs->channelCount * [0m[1;36m12[0m[39m + [0m[1;36m8[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1908[0m[39m:   [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mlength <= UINT16_MAX[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1909[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_write_user_data_header[0m[1;39m([0m[39ms, CS_NET, [0m[1;39m([0m[39mUINT16[0m[1;39m)[0m[39mlength[0m[1;39m)[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m1910[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1911[0m[39m:   [0m[39m        [0m[1;35mStream_Write_UINT32[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m1912[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1913[0m[39m:   [0m[39m        [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1914[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1915[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1916[0m[39m:   [0m[39m        [0m[39m        [0m[35m/[0m[39m* CHANNEL_DEF *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1917[0m[39m:   [0m[39m        [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1918[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Write[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* [0m   [2m                [0m
[2;36m                    [0m         [39mname [0m[1;39m([0m[1;36m8[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1919[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Write_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m;             [0m[35m/[0m[39m* [0m   [2m                [0m
[2;36m                    [0m         [39moptions [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1920[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1907[0m[39m-[0m[1;36m1920[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1907[0m[39m:   [0m[39m        [0m[39mconst size_t length = mcs->channelCount * [0m[1;36m12[0m[39m + [0m[1;36m8[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1908[0m[39m:   [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mlength <= UINT16_MAX[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1909[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_write_user_data_header[0m[1;39m([0m[39ms, CS_NET, [0m[1;39m([0m[39mUINT16[0m[1;39m)[0m[39mlength[0m[1;39m)[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m1910[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1911[0m[39m:   [0m[39m        [0m[1;35mStream_Write_UINT32[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m1912[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1913[0m[39m:   [0m[39m        [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1914[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1915[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1916[0m[39m:   [0m[39m        [0m[39m        [0m[35m/[0m[39m* CHANNEL_DEF *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1917[0m[39m:   [0m[39m        [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1918[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Write[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* [0m   [2m                [0m
[2;36m                    [0m         [39mname [0m[1;39m([0m[1;36m8[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1919[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Write_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m;             [0m[35m/[0m[39m* [0m   [2m                [0m
[2;36m                    [0m         [39moptions [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1920[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1865[0m[39m-[0m[1;36m1887[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1865[0m[39m:   [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1866[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1867[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1868[0m[39m:   [0m[39m        [0m[35m/[0m[39m**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1869[0m[39m:   [0m[39m        [0m[39m * CHANNEL_DEF[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1870[0m[39m:   [0m[39m        [0m[39m * - name: an [0m[1;36m8[0m[39m-byte array containing a null-terminated collection[0m  [2m                [0m
[2;36m                    [0m         [1;36m1871[0m[39m:   [0m[39m        [0m[39m *   of seven ANSI characters that uniquely identify the channel.[0m   [2m                [0m
[2;36m                    [0m         [1;36m1872[0m[39m:   [0m[39m        [0m[39m * - options: a [0m[1;36m32[0m[39m-bit, unsigned integer. Channel option flags[0m      [2m                [0m
[2;36m                    [0m         [1;36m1873[0m[39m:   [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1874[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1875[0m[39m:   [0m[39m        [0m[1;35mStream_Read[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* name [0m[1;39m([0m[1;36m8[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1876[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1877[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmemchr[0m[1;39m([0m[39mchannel->Name, [0m[1;36m0[0m[39m, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1878[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1879[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1880[0m[39m:   [0m[39m        [0m[39m        [0m[39m    TAG,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1881[0m[39m:   [0m[39m        [0m[39m        [0m[39m    [0m[32m"protocol violation: received a static channel name [0m    [2m                [0m
[2;36m                    [0m         [32mwith missing null-termination"[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1882[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1883[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1884[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1885[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* options [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m1886[0m[39m:   [0m[39m        [0m[39mchannel->ChannelId = mcs->baseChannelId++;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1887[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1848[0m[39m-[0m[1;36m1863[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1848:B[0m[39mOOL [0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1849[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1850[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1851[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1852[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1853[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1854[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1855[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1857[0m[39m:   [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1858[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1859[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1860[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1861[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1862[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1863[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m147[0m[39m-[0m[1;36m148[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39mINT8 channelCount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39mrdpMcsChannel* channels;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/freerdp.[0m[1;92mc:1429[0m[39m-[0m[1;36m1444[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1429:B[0m[39mOOL [0m[1;35mfreerdp_is_valid_mcs_create_request[0m[1;39m([0m[39mconst BYTE* data, size_t size[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m1430[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1431[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1432[0m[39m:   [0m[39mwStream sbuffer = [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1433[0m[39m:   [0m[39mwStream* s = [0m[1;35mStream_StaticConstInit[0m[1;39m([0m[39m&sbuffer, data, size[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1434[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1435[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mdata || [0m[1;39m([0m[39msize == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1436[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1437[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1438[0m[39m:   [0m[39mrdpMcs* mcs = [0m[1;35mtest_mcs_new[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1439[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1440[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1441[0m[39m:   [0m[39mBOOL result = [0m[1;35mmcs_recv_connect_initial[0m[1;39m([0m[39mmcs, s[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1442[0m[39m:   [0m[1;35mtest_mcs_free[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1443[0m[39m:   [0m[39mreturn result;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1444[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1866[0m[39m-[0m[1;36m1887[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1866[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1867[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1868[0m[39m:   [0m[39m        [0m[35m/[0m[39m**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1869[0m[39m:   [0m[39m        [0m[39m * CHANNEL_DEF[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1870[0m[39m:   [0m[39m        [0m[39m * - name: an [0m[1;36m8[0m[39m-byte array containing a null-terminated collection[0m  [2m                [0m
[2;36m                    [0m         [1;36m1871[0m[39m:   [0m[39m        [0m[39m *   of seven ANSI characters that uniquely identify the channel.[0m   [2m                [0m
[2;36m                    [0m         [1;36m1872[0m[39m:   [0m[39m        [0m[39m * - options: a [0m[1;36m32[0m[39m-bit, unsigned integer. Channel option flags[0m      [2m                [0m
[2;36m                    [0m         [1;36m1873[0m[39m:   [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1874[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1875[0m[39m:   [0m[39m        [0m[1;35mStream_Read[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* name [0m[1;39m([0m[1;36m8[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1876[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1877[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmemchr[0m[1;39m([0m[39mchannel->Name, [0m[1;36m0[0m[39m, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1878[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1879[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1880[0m[39m:   [0m[39m        [0m[39m        [0m[39m    TAG,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1881[0m[39m:   [0m[39m        [0m[39m        [0m[39m    [0m[32m"protocol violation: received a static channel name [0m    [2m                [0m
[2;36m                    [0m         [32mwith missing null-termination"[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1882[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1883[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1884[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1885[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* options [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m1886[0m[39m:   [0m[39m        [0m[39mchannel->ChannelId = mcs->baseChannelId++;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1887[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mwinpr/include/winpr/wtsapi.h:[0m[1;36m77[0m[39m-[0m[1;36m81[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:typedef struct tagCHANNEL_DEF[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39mchar name[0m[1;39m[[0m[39mCHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39mULONG options;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m[39m CHANNEL_DEF;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/freerdp.[0m[1;92mc:1402[0m[39m-[0m[1;36m1427[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1402[0m[39m:static rdpMcs* [0m[1;35mtest_mcs_new[0m[1;39m([0m[39mvoid[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1403[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1404[0m[39m:   [0m[39mrdpTransport* transport = NULL;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1405[0m[39m:   [0m[39mrdpSettings* settings = [0m[1;35mfreerdp_settings_new[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1406[0m[39m:   [0m[39mrdpContext* context = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mrdpContext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1407[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1408[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!settings[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1409[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1410[0m[39m:   [0m[39mif [0m[1;39m([0m[39m![0m[1;35mfreerdp_settings_set_bool[0m[1;39m([0m[39msettings, FreeRDP_TransportDumpReplay, [0m      [2m                [0m
[2;36m                    [0m         [39mTRUE[0m[1;39m)[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1411[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1412[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1413[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!context[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1414[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1415[0m[39m:   [0m[39mcontext->settings = settings;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1416[0m[39m:   [0m[39mtransport = [0m[1;35mtransport_new[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1417[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!transport[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1418[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1419[0m[39m:   [0m[39mreturn [0m[1;35mmcs_new[0m[1;39m([0m[39mtransport[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1420[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1421:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1422[0m[39m:   [0m[1;35mtransport_free[0m[1;39m([0m[39mtransport[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1423[0m[39m:   [0m[1;35mfree[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1424[0m[39m:   [0m[1;35mfreerdp_settings_free[0m[1;39m([0m[39msettings[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1425[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1426[0m[39m:   [0m[39mreturn NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1427[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/freerdp.[0m[1;92mc:1384[0m[39m-[0m[1;36m1400[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1384[0m[39m:static void [0m[1;35mtest_mcs_free[0m[1;39m([0m[39mrdpMcs* mcs[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1385[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1386[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!mcs[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1387[0m[39m:   [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1388[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1389[0m[39m:   [0m[39mrdpTransport* transport = mcs->transport;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1390[0m[39m:   [0m[39mrdpContext* context = [0m[1;35mtransport_get_context[0m[1;39m([0m[39mtransport[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1391[0m[39m:   [0m[39mif [0m[1;39m([0m[39mcontext[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1392[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1393[0m[39m:   [0m[39m        [0m[39mrdpSettings* settings = context->settings;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1394[0m[39m:   [0m[39m        [0m[1;35mfreerdp_settings_free[0m[1;39m([0m[39msettings[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1395[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1396[0m[39m:   [0m[1;35mfree[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1397[0m[39m:   [0m[1;35mtransport_free[0m[1;39m([0m[39mtransport[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1398[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1399[0m[39m:   [0m[1;35mmcs_free[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1400[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.[0m[1;92mc:1430[0m[39m-[0m[1;36m1455[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1430[0m[39m:rdpMcs* [0m[1;35mmcs_new[0m[1;39m([0m[39mrdpTransport* transport[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1431[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1432[0m[39m:   [0m[39mrdpMcs* mcs = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1433[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1434[0m[39m:   [0m[39mmcs = [0m[1;39m([0m[39mrdpMcs*[0m[1;39m)[0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mrdpMcs[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1435[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1436[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!mcs[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1437[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1438[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1439[0m[39m:   [0m[39mmcs->transport = transport;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1440[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->targetParameters, [0m[1;36m34[0m[39m, [0m[1;36m2[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0xFFFF[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1441[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->minimumParameters, [0m[1;36m1[0m[39m, [0m[1;36m1[0m[39m, [0m[1;36m1[0m[39m, [0m[1;36m0x420[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1442[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->maximumParameters, [0m[1;36m0xFFFF[0m[39m, [0m[1;36m0xFC17[0m[39m, [0m[1;36m0xFFFF[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m0xFFFF[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1443[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->domainParameters, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0xFFFF[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1444[0m[39m:   [0m[39mmcs->channelCount = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:   [0m[39mmcs->baseChannelId = MCS_GLOBAL_CHANNEL_ID + [0m[1;36m1[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1446[0m[39m:   [0m[39mmcs->channels = [0m[1;39m([0m[39mrdpMcsChannel*[0m[1;39m)[0m[1;35mcalloc[0m[1;39m([0m[39mCHANNEL_MAX_COUNT, [0m                  [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mrdpMcsChannel[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1447[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1448[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!mcs->channels[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:   [0m[39m        [0m[39mgoto out_free;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:   [0m[39mreturn mcs;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:out_free:[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1453[0m[39m:   [0m[1;35mfree[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1454[0m[39m:   [0m[39mreturn NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1455[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m118[0m[39m-[0m[1;36m126[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:struct rdp_mcs_channel[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mchar Name[0m[1;39m[[0m[39mCHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39mUINT32 options;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39mUINT16 ChannelId;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39mBOOL joined;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[39mvoid* handle;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:typedef struct rdp_mcs_channel rdpMcsChannel;[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1848[0m[39m-[0m[1;36m1890[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1848:B[0m[39mOOL [0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1849[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1850[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1851[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1852[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1853[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1854[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1855[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1857[0m[39m:   [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1858[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1859[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1860[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1861[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1862[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1863[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1864[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1865[0m[39m:   [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1866[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1867[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1868[0m[39m:   [0m[39m        [0m[35m/[0m[39m**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1869[0m[39m:   [0m[39m        [0m[39m * CHANNEL_DEF[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1870[0m[39m:   [0m[39m        [0m[39m * - name: an [0m[1;36m8[0m[39m-byte array containing a null-terminated collection[0m  [2m                [0m
[2;36m                    [0m         [1;36m1871[0m[39m:   [0m[39m        [0m[39m *   of seven ANSI characters that uniquely identify the channel.[0m   [2m                [0m
[2;36m                    [0m         [1;36m1872[0m[39m:   [0m[39m        [0m[39m * - options: a [0m[1;36m32[0m[39m-bit, unsigned integer. Channel option flags[0m      [2m                [0m
[2;36m                    [0m         [1;36m1873[0m[39m:   [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1874[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1875[0m[39m:   [0m[39m        [0m[1;35mStream_Read[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* name [0m[1;39m([0m[1;36m8[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1876[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1877[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmemchr[0m[1;39m([0m[39mchannel->Name, [0m[1;36m0[0m[39m, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1878[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1879[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1880[0m[39m:   [0m[39m        [0m[39m        [0m[39m    TAG,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1881[0m[39m:   [0m[39m        [0m[39m        [0m[39m    [0m[32m"protocol violation: received a static channel name [0m    [2m                [0m
[2;36m                    [0m         [32mwith missing null-termination"[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1882[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1883[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1884[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1885[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* options [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m1886[0m[39m:   [0m[39m        [0m[39mchannel->ChannelId = mcs->baseChannelId++;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1887[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1888[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1889[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1890[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.[0m[1;92mc:1430[0m[39m-[0m[1;36m1455[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1430[0m[39m:rdpMcs* [0m[1;35mmcs_new[0m[1;39m([0m[39mrdpTransport* transport[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1431[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1432[0m[39m:   [0m[39mrdpMcs* mcs = NULL;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1433[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1434[0m[39m:   [0m[39mmcs = [0m[1;39m([0m[39mrdpMcs*[0m[1;39m)[0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mrdpMcs[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1435[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1436[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!mcs[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1437[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1438[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1439[0m[39m:   [0m[39mmcs->transport = transport;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1440[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->targetParameters, [0m[1;36m34[0m[39m, [0m[1;36m2[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0xFFFF[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1441[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->minimumParameters, [0m[1;36m1[0m[39m, [0m[1;36m1[0m[39m, [0m[1;36m1[0m[39m, [0m[1;36m0x420[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1442[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->maximumParameters, [0m[1;36m0xFFFF[0m[39m, [0m[1;36m0xFC17[0m[39m, [0m[1;36m0xFFFF[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m0xFFFF[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1443[0m[39m:   [0m[1;35mmcs_init_domain_parameters[0m[1;39m([0m[39m&mcs->domainParameters, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, [0m[1;36m0xFFFF[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1444[0m[39m:   [0m[39mmcs->channelCount = [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:   [0m[39mmcs->baseChannelId = MCS_GLOBAL_CHANNEL_ID + [0m[1;36m1[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1446[0m[39m:   [0m[39mmcs->channels = [0m[1;39m([0m[39mrdpMcsChannel*[0m[1;39m)[0m[1;35mcalloc[0m[1;39m([0m[39mCHANNEL_MAX_COUNT, [0m                  [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mrdpMcsChannel[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1447[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1448[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!mcs->channels[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:   [0m[39m        [0m[39mgoto out_free;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:   [0m[39mreturn mcs;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:out_free:[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1453[0m[39m:   [0m[1;35mfree[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1454[0m[39m:   [0m[39mreturn NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1455[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m118[0m[39m-[0m[1;36m126[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:struct rdp_mcs_channel[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mchar Name[0m[1;39m[[0m[39mCHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39mUINT32 options;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39mUINT16 ChannelId;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39mBOOL joined;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[39mvoid* handle;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:typedef struct rdp_mcs_channel rdpMcsChannel;[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m147[0m[39m-[0m[1;36m148[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39mINT8 channelCount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39mrdpMcsChannel* channels;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1925[0m[39m-[0m[1;36m1971[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1925:B[0m[39mOOL [0m[1;35mgcc_read_server_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1926[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1927[0m[39m:   [0m[39mUINT16 channelId = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1928[0m[39m:   [0m[39mUINT16 MCSChannelId = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1929[0m[39m:   [0m[39mUINT16 channelCount = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1930[0m[39m:   [0m[39mINT8 parsedChannelCount = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1931[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1932[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1933[0m[39m:   [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, [0m[1;36m4[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1934[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1935[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1936[0m[39m:   [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, MCSChannelId[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* MCSChannelId *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1937[0m[39m:   [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1938[0m[39m:   [0m[39mparsedChannelCount = channelCount;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1939[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1940[0m[39m:   [0m[39mif [0m[1;39m([0m[39mchannelCount != mcs->channelCount[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1941[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1942[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"requested %"[0m[39m PRIu32 [0m[32m" channels, got %"[0m[39m PRIu16 [0m[32m" [0m     [2m                [0m
[2;36m                    [0m         [32minstead"[0m[39m, mcs->channelCount,[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1943[0m[39m:   [0m[39m        [0m[39m         channelCount[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1944[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1945[0m[39m:   [0m[39m        [0m[35m/[0m[39m* we ensure that the response is not bigger than the request *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m1946[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1947[0m[39m:   [0m[39m        [0m[39mmcs->channelCount = channelCount;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1948[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1949[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1950[0m[39m:   [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLengthOfSize[0m[1;39m([0m[39mTAG, s, channelCount, 2ull[0m[1;39m)[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m1951[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1952[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1953[0m[39m:   [0m[39mif [0m[1;39m([0m[39mCHANNEL_MAX_COUNT < parsedChannelCount[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1954[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1955[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"requested %"[0m[39m PRIu32 [0m[32m" channels > [0m                    [2m                [0m
[2;36m                    [0m         [32mCHANNEL_MAX_COUNT[0m[32m([0m[32m31[0m[32m)[0m[32m %"[0m[39m PRIu16,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1956[0m[39m:   [0m[39m        [0m[39m         mcs->channelCount, CHANNEL_MAX_COUNT[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1957[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1958[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1959[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1960[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < parsedChannelCount; i++[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1961[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1962[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1963[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, channelId[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelId *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1964[0m[39m:   [0m[39m        [0m[39mchannel->ChannelId = channelId;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1965[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1966[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1967[0m[39m:   [0m[39mif [0m[1;39m([0m[39mchannelCount % [0m[1;36m2[0m[39m == [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1968[0m[39m:   [0m[39m        [0m[39mreturn [0m[1;35mStream_SafeSeek[0m[1;39m([0m[39ms, [0m[1;36m2[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* padding *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1969[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1970[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1971[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.[0m[1;92mc:301[0m[39m-[0m[1;36m320[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:static int [0m[1;35mmcs_initialize_client_channels[0m[1;39m([0m[39mrdpMcs* mcs, const rdpSettings* [0m      [2m                [0m
[2;36m                    [0m         [39msettings[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!mcs || !settings[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:    [0m[39m        [0m[39mreturn [0m[1;36m-1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:    [0m[39mmcs->channelCount = [0m[1;35mfreerdp_settings_get_uint32[0m[1;39m([0m[39msettings, [0m                  [2m                [0m
[2;36m                    [0m         [39mFreeRDP_ChannelCount[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:    [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:    [0m[39m        [0m[39mmcs->channelCount = CHANNEL_MAX_COUNT;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:    [0m[1;35mZeroMemory[0m[1;39m([0m[39mmcs->channels, [0m[1;35msizeof[0m[1;39m([0m[39mrdpMcsChannel[0m[1;39m)[0m[39m * CHANNEL_MAX_COUNT[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mUINT32 index = [0m[1;36m0[0m[39m; index < mcs->channelCount; index++[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:    [0m[39m        [0m[39mconst CHANNEL_DEF* defchannel =[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:    [0m[39m        [0m[39m    [0m[1;35mfreerdp_settings_get_pointer_array[0m[1;39m([0m[39msettings, [0m                   [2m                [0m
[2;36m                    [0m         [39mFreeRDP_ChannelDefArray, index[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:    [0m[39m        [0m[39mrdpMcsChannel* cur = &mcs->channels[0m[1;39m[[0m[39mindex[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:    [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mdefchannel[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:    [0m[39m        [0m[1;35mCopyMemory[0m[1;39m([0m[39mcur->Name, defchannel->name, CHANNEL_NAME_LEN[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:    [0m[39m        [0m[39mcur->options = defchannel->options;[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:2102[0m[39m-[0m[1;36m2156[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m2102:B[0m[39mOOL [0m[1;35mgcc_read_client_monitor_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m2103[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m2104[0m[39m:   [0m[39mUINT32 monitorCount = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2105[0m[39m:   [0m[39mrdpSettings* settings = [0m[1;35mmcs_get_settings[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m2106[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2107[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2108[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39msettings[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2109[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2110[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m2111[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m8[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2112[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2113[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2114[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, settings->MonitorFlags[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* flags *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2115[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, monitorCount[0m[1;39m)[0m[39m;           [0m[35m/[0m[39m* monitorCount *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m2116[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2117[0m[39m:   [0m[35m/[0m[39m* [0m[1;92m2.2.1.3[0m[39m.[0m[1;36m6[0m[39m Client Monitor Data -[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2118[0m[39m:   [0m[39m * monitorCount [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m: A [0m[1;36m32[0m[39m-bit, unsigned integer. The number of [0m       [2m                [0m
[2;36m                    [0m         [39mdisplay[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2119[0m[39m:   [0m[39m * monitor definitions in the monitorDefArray field [0m[1;39m([0m[39mthe maximum allowed is[0m [2m                [0m
[2;36m                    [0m         [1;36m16[0m[1;39m)[0m[39m.[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2120[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m2121[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmonitorCount > [0m[1;36m16[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2122[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2123[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"announced monitors[0m[32m([0m[32m%"[0m[39m PRIu32 [0m[32m"[0m[32m)[0m[32m exceed the 16 [0m       [2m                [0m
[2;36m                    [0m         [32mlimit"[0m[39m, monitorCount[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2124[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2125[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2126[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2127[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmonitorCount > settings->MonitorDefArraySize[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2128[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2129[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"too many announced monitors[0m[32m([0m[32m%"[0m[39m PRIu32 [0m[32m"[0m[32m)[0m[32m, clamping [0m  [2m                [0m
[2;36m                    [0m         [32mto %"[0m[39m PRIu32 [0m[32m""[0m[39m,[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m2130[0m[39m:   [0m[39m        [0m[39m         monitorCount, settings->MonitorDefArraySize[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m2131[0m[39m:   [0m[39m        [0m[39mmonitorCount = settings->MonitorDefArraySize;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2132[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2133[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2134[0m[39m:   [0m[39mif [0m[1;39m([0m[1;39m([0m[39mUINT32[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mblockLength - [0m[1;36m8[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;36m20[0m[1;39m)[0m[39m < monitorCount[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m2135[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2136[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2137[0m[39m:   [0m[39msettings->MonitorCount = monitorCount;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2138[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2139[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 index = [0m[1;36m0[0m[39m; index < monitorCount; index++[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2140[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2141[0m[39m:   [0m[39m        [0m[39mrdpMonitor* current = &settings->MonitorDefArray[0m[1;39m[[0m[39mindex[0m[1;39m][0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m2142[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2143[0m[39m:   [0m[39m        [0m[39mconst INT32 left = [0m[1;35mStream_Get_INT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;    [0m[35m/[0m[39m* left *[0m[35m/[0m               [2m                [0m
[2;36m                    [0m         [1;36m2144[0m[39m:   [0m[39m        [0m[39mconst INT32 top = [0m[1;35mStream_Get_INT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;     [0m[35m/[0m[39m* top *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m2145[0m[39m:   [0m[39m        [0m[39mconst INT32 right = [0m[1;35mStream_Get_INT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;   [0m[35m/[0m[39m* right *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m2146[0m[39m:   [0m[39m        [0m[39mconst INT32 bottom = [0m[1;35mStream_Get_INT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;  [0m[35m/[0m[39m* bottom *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m2147[0m[39m:   [0m[39m        [0m[39mconst UINT32 flags = [0m[1;35mStream_Get_UINT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* flags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m2148[0m[39m:   [0m[39m        [0m[39mcurrent->x = left;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2149[0m[39m:   [0m[39m        [0m[39mcurrent->y = top;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2150[0m[39m:   [0m[39m        [0m[39mcurrent->width = right - left + [0m[1;36m1[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2151[0m[39m:   [0m[39m        [0m[39mcurrent->height = bottom - top + [0m[1;36m1[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2152[0m[39m:   [0m[39m        [0m[39mcurrent->is_primary = [0m[1;39m([0m[39mflags & MONITOR_PRIMARY[0m[1;39m)[0m[39m ? TRUE : FALSE;[0m     [2m                [0m
[2;36m                    [0m         [1;36m2153[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2154[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2155[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2156[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:2008[0m[39m-[0m[1;36m2045[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m2008:B[0m[39mOOL [0m[1;35mgcc_read_client_cluster_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m2009[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m2010[0m[39m:   [0m[39mchar buffer[0m[1;39m[[0m[1;36m128[0m[1;39m][0m[39m = [0m[1;39m{[0m[39m [0m[1;36m0[0m[39m [0m[1;39m}[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2011[0m[39m:   [0m[39mUINT32 redirectedSessionId = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2012[0m[39m:   [0m[39mrdpSettings* settings = [0m[1;35mmcs_get_settings[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m2013[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2014[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2015[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39msettings[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2016[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2017[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m2018[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m8[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2019[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2020[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2021[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, settings->ClusterInfoFlags[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* flags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m2022[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, redirectedSessionId[0m[1;39m)[0m[39m;        [0m[35m/[0m[39m* redirectedSessionId [0m  [2m                [0m
[2;36m                    [0m         [39m*[0m[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2023[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2024[0m[39m:   [0m[1;35mWLog_VRB[0m[1;39m([0m[39mTAG, [0m[32m"read [0m[32mClusterInfoFlags[0m[32m=%s, [0m[32mRedirectedSessionId[0m[32m=[0m[32m0x[0m[32m%08"[0m[39m PRIx32,[0m [2m                [0m
[2;36m                    [0m         [1;36m2025[0m[39m:   [0m[39m         [0m[1;35mrdp_cluster_info_flags_to_string[0m[1;39m([0m[39msettings->ClusterInfoFlags, [0m      [2m                [0m
[2;36m                    [0m         [39mbuffer, [0m[1;35msizeof[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[1;39m)[0m[39m,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2026[0m[39m:   [0m[39m         redirectedSessionId[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2027[0m[39m:   [0m[39mif [0m[1;39m([0m[39msettings->ClusterInfoFlags & REDIRECTED_SESSIONID_FIELD_VALID[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m2028[0m[39m:   [0m[39m        [0m[39msettings->RedirectedSessionId = redirectedSessionId;[0m                [2m                [0m
[2;36m                    [0m         [1;36m2029[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2030[0m[39m:   [0m[39msettings->ConsoleSession =[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2031[0m[39m:   [0m[39m    [0m[1;39m([0m[39msettings->ClusterInfoFlags & REDIRECTED_SESSIONID_FIELD_VALID[0m[1;39m)[0m[39m ? TRUE [0m [2m                [0m
[2;36m                    [0m         [39m: FALSE;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2032[0m[39m:   [0m[39msettings->RedirectSmartCards =[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2033[0m[39m:   [0m[39m    [0m[1;39m([0m[39msettings->ClusterInfoFlags & REDIRECTED_SMARTCARD[0m[1;39m)[0m[39m ? TRUE : FALSE;[0m     [2m                [0m
[2;36m                    [0m         [1;36m2034[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2035[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength > 8ULL[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2036[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2037[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m >= [0m[1;39m([0m[39mblockLength - 8ULL[0m[1;39m)[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m2038[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2039[0m[39m:   [0m[39m        [0m[39m        [0m[35m/[0m[39m* The old Microsoft Mac RDP client can send a pad here *[0m[35m/[0m  [2m                [0m
[2;36m                    [0m         [1;36m2040[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Seek[0m[1;39m([0m[39ms, [0m[1;39m([0m[39mblockLength - [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m2041[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2042[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2043[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2044[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2045[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1848[0m[39m-[0m[1;36m1890[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1848:B[0m[39mOOL [0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1849[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1850[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1851[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1852[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1853[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1854[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1855[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1857[0m[39m:   [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1858[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1859[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1860[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1861[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1862[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1863[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1864[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1865[0m[39m:   [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1866[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1867[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1868[0m[39m:   [0m[39m        [0m[35m/[0m[39m**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1869[0m[39m:   [0m[39m        [0m[39m * CHANNEL_DEF[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1870[0m[39m:   [0m[39m        [0m[39m * - name: an [0m[1;36m8[0m[39m-byte array containing a null-terminated collection[0m  [2m                [0m
[2;36m                    [0m         [1;36m1871[0m[39m:   [0m[39m        [0m[39m *   of seven ANSI characters that uniquely identify the channel.[0m   [2m                [0m
[2;36m                    [0m         [1;36m1872[0m[39m:   [0m[39m        [0m[39m * - options: a [0m[1;36m32[0m[39m-bit, unsigned integer. Channel option flags[0m      [2m                [0m
[2;36m                    [0m         [1;36m1873[0m[39m:   [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1874[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1875[0m[39m:   [0m[39m        [0m[1;35mStream_Read[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* name [0m[1;39m([0m[1;36m8[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1876[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1877[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmemchr[0m[1;39m([0m[39mchannel->Name, [0m[1;36m0[0m[39m, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1878[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1879[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1880[0m[39m:   [0m[39m        [0m[39m        [0m[39m    TAG,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1881[0m[39m:   [0m[39m        [0m[39m        [0m[39m    [0m[32m"protocol violation: received a static channel name [0m    [2m                [0m
[2;36m                    [0m         [32mwith missing null-termination"[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1882[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1883[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1884[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1885[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* options [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m1886[0m[39m:   [0m[39m        [0m[39mchannel->ChannelId = mcs->baseChannelId++;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1887[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1888[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1889[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1890[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1901[0m[39m-[0m[1;36m1923[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1901:B[0m[39mOOL [0m[1;35mgcc_write_client_network_data[0m[1;39m([0m[39mwStream* s, const rdpMcs* mcs[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m1902[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1903[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1904[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1905[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > [0m[1;36m0[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1906[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1907[0m[39m:   [0m[39m        [0m[39mconst size_t length = mcs->channelCount * [0m[1;36m12[0m[39m + [0m[1;36m8[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1908[0m[39m:   [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mlength <= UINT16_MAX[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1909[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_write_user_data_header[0m[1;39m([0m[39ms, CS_NET, [0m[1;39m([0m[39mUINT16[0m[1;39m)[0m[39mlength[0m[1;39m)[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m1910[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1911[0m[39m:   [0m[39m        [0m[1;35mStream_Write_UINT32[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m1912[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1913[0m[39m:   [0m[39m        [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1914[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1915[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1916[0m[39m:   [0m[39m        [0m[39m        [0m[35m/[0m[39m* CHANNEL_DEF *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1917[0m[39m:   [0m[39m        [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1918[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Write[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* [0m   [2m                [0m
[2;36m                    [0m         [39mname [0m[1;39m([0m[1;36m8[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1919[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Write_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m;             [0m[35m/[0m[39m* [0m   [2m                [0m
[2;36m                    [0m         [39moptions [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1920[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1921[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1922[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1923[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:2102[0m[39m-[0m[1;36m2156[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m2102:B[0m[39mOOL [0m[1;35mgcc_read_client_monitor_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m2103[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m2104[0m[39m:   [0m[39mUINT32 monitorCount = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2105[0m[39m:   [0m[39mrdpSettings* settings = [0m[1;35mmcs_get_settings[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m2106[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2107[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2108[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39msettings[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2109[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2110[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m2111[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m8[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2112[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2113[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2114[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, settings->MonitorFlags[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* flags *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2115[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, monitorCount[0m[1;39m)[0m[39m;           [0m[35m/[0m[39m* monitorCount *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m2116[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2117[0m[39m:   [0m[35m/[0m[39m* [0m[1;92m2.2.1.3[0m[39m.[0m[1;36m6[0m[39m Client Monitor Data -[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2118[0m[39m:   [0m[39m * monitorCount [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m: A [0m[1;36m32[0m[39m-bit, unsigned integer. The number of [0m       [2m                [0m
[2;36m                    [0m         [39mdisplay[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2119[0m[39m:   [0m[39m * monitor definitions in the monitorDefArray field [0m[1;39m([0m[39mthe maximum allowed is[0m [2m                [0m
[2;36m                    [0m         [1;36m16[0m[1;39m)[0m[39m.[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2120[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m2121[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmonitorCount > [0m[1;36m16[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2122[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2123[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"announced monitors[0m[32m([0m[32m%"[0m[39m PRIu32 [0m[32m"[0m[32m)[0m[32m exceed the 16 [0m       [2m                [0m
[2;36m                    [0m         [32mlimit"[0m[39m, monitorCount[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2124[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2125[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2126[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2127[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmonitorCount > settings->MonitorDefArraySize[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2128[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2129[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"too many announced monitors[0m[32m([0m[32m%"[0m[39m PRIu32 [0m[32m"[0m[32m)[0m[32m, clamping [0m  [2m                [0m
[2;36m                    [0m         [32mto %"[0m[39m PRIu32 [0m[32m""[0m[39m,[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m2130[0m[39m:   [0m[39m        [0m[39m         monitorCount, settings->MonitorDefArraySize[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m2131[0m[39m:   [0m[39m        [0m[39mmonitorCount = settings->MonitorDefArraySize;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2132[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2133[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2134[0m[39m:   [0m[39mif [0m[1;39m([0m[1;39m([0m[39mUINT32[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mblockLength - [0m[1;36m8[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;36m20[0m[1;39m)[0m[39m < monitorCount[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m2135[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2136[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2137[0m[39m:   [0m[39msettings->MonitorCount = monitorCount;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2138[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2139[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 index = [0m[1;36m0[0m[39m; index < monitorCount; index++[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2140[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2141[0m[39m:   [0m[39m        [0m[39mrdpMonitor* current = &settings->MonitorDefArray[0m[1;39m[[0m[39mindex[0m[1;39m][0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m2142[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2143[0m[39m:   [0m[39m        [0m[39mconst INT32 left = [0m[1;35mStream_Get_INT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;    [0m[35m/[0m[39m* left *[0m[35m/[0m               [2m                [0m
[2;36m                    [0m         [1;36m2144[0m[39m:   [0m[39m        [0m[39mconst INT32 top = [0m[1;35mStream_Get_INT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;     [0m[35m/[0m[39m* top *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m2145[0m[39m:   [0m[39m        [0m[39mconst INT32 right = [0m[1;35mStream_Get_INT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;   [0m[35m/[0m[39m* right *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m2146[0m[39m:   [0m[39m        [0m[39mconst INT32 bottom = [0m[1;35mStream_Get_INT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;  [0m[35m/[0m[39m* bottom *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m2147[0m[39m:   [0m[39m        [0m[39mconst UINT32 flags = [0m[1;35mStream_Get_UINT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* flags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m2148[0m[39m:   [0m[39m        [0m[39mcurrent->x = left;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2149[0m[39m:   [0m[39m        [0m[39mcurrent->y = top;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2150[0m[39m:   [0m[39m        [0m[39mcurrent->width = right - left + [0m[1;36m1[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2151[0m[39m:   [0m[39m        [0m[39mcurrent->height = bottom - top + [0m[1;36m1[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2152[0m[39m:   [0m[39m        [0m[39mcurrent->is_primary = [0m[1;39m([0m[39mflags & MONITOR_PRIMARY[0m[1;39m)[0m[39m ? TRUE : FALSE;[0m     [2m                [0m
[2;36m                    [0m         [1;36m2153[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2154[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2155[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2156[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1925[0m[39m-[0m[1;36m1971[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1925:B[0m[39mOOL [0m[1;35mgcc_read_server_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1926[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1927[0m[39m:   [0m[39mUINT16 channelId = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1928[0m[39m:   [0m[39mUINT16 MCSChannelId = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1929[0m[39m:   [0m[39mUINT16 channelCount = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1930[0m[39m:   [0m[39mINT8 parsedChannelCount = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1931[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1932[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1933[0m[39m:   [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, [0m[1;36m4[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1934[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1935[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1936[0m[39m:   [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, MCSChannelId[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* MCSChannelId *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1937[0m[39m:   [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1938[0m[39m:   [0m[39mparsedChannelCount = channelCount;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1939[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1940[0m[39m:   [0m[39mif [0m[1;39m([0m[39mchannelCount != mcs->channelCount[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1941[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1942[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"requested %"[0m[39m PRIu32 [0m[32m" channels, got %"[0m[39m PRIu16 [0m[32m" [0m     [2m                [0m
[2;36m                    [0m         [32minstead"[0m[39m, mcs->channelCount,[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1943[0m[39m:   [0m[39m        [0m[39m         channelCount[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1944[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1945[0m[39m:   [0m[39m        [0m[35m/[0m[39m* we ensure that the response is not bigger than the request *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m1946[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1947[0m[39m:   [0m[39m        [0m[39mmcs->channelCount = channelCount;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1948[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1949[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1950[0m[39m:   [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLengthOfSize[0m[1;39m([0m[39mTAG, s, channelCount, 2ull[0m[1;39m)[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m1951[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1952[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1953[0m[39m:   [0m[39mif [0m[1;39m([0m[39mCHANNEL_MAX_COUNT < parsedChannelCount[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1954[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1955[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"requested %"[0m[39m PRIu32 [0m[32m" channels > [0m                    [2m                [0m
[2;36m                    [0m         [32mCHANNEL_MAX_COUNT[0m[32m([0m[32m31[0m[32m)[0m[32m %"[0m[39m PRIu16,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1956[0m[39m:   [0m[39m        [0m[39m         mcs->channelCount, CHANNEL_MAX_COUNT[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1957[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1958[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1959[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1960[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < parsedChannelCount; i++[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1961[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1962[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1963[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, channelId[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelId *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1964[0m[39m:   [0m[39m        [0m[39mchannel->ChannelId = channelId;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1965[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1966[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1967[0m[39m:   [0m[39mif [0m[1;39m([0m[39mchannelCount % [0m[1;36m2[0m[39m == [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1968[0m[39m:   [0m[39m        [0m[39mreturn [0m[1;35mStream_SafeSeek[0m[1;39m([0m[39ms, [0m[1;36m2[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* padding *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1969[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1970[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1971[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1848[0m[39m-[0m[1;36m1890[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1848:B[0m[39mOOL [0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1849[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1850[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1851[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1852[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1853[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1854[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1855[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1857[0m[39m:   [0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1858[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1859[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1860[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1861[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1862[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1863[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1864[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1865[0m[39m:   [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1866[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1867[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1868[0m[39m:   [0m[39m        [0m[35m/[0m[39m**[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1869[0m[39m:   [0m[39m        [0m[39m * CHANNEL_DEF[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1870[0m[39m:   [0m[39m        [0m[39m * - name: an [0m[1;36m8[0m[39m-byte array containing a null-terminated collection[0m  [2m                [0m
[2;36m                    [0m         [1;36m1871[0m[39m:   [0m[39m        [0m[39m *   of seven ANSI characters that uniquely identify the channel.[0m   [2m                [0m
[2;36m                    [0m         [1;36m1872[0m[39m:   [0m[39m        [0m[39m * - options: a [0m[1;36m32[0m[39m-bit, unsigned integer. Channel option flags[0m      [2m                [0m
[2;36m                    [0m         [1;36m1873[0m[39m:   [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1874[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1875[0m[39m:   [0m[39m        [0m[1;35mStream_Read[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* name [0m[1;39m([0m[1;36m8[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1876[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1877[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mmemchr[0m[1;39m([0m[39mchannel->Name, [0m[1;36m0[0m[39m, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1878[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1879[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1880[0m[39m:   [0m[39m        [0m[39m        [0m[39m    TAG,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1881[0m[39m:   [0m[39m        [0m[39m        [0m[39m    [0m[32m"protocol violation: received a static channel name [0m    [2m                [0m
[2;36m                    [0m         [32mwith missing null-termination"[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1882[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1883[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1884[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1885[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* options [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m1886[0m[39m:   [0m[39m        [0m[39mchannel->ChannelId = mcs->baseChannelId++;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1887[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1888[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1889[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1890[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1901[0m[39m-[0m[1;36m1923[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1901:B[0m[39mOOL [0m[1;35mgcc_write_client_network_data[0m[1;39m([0m[39mwStream* s, const rdpMcs* mcs[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m1902[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1903[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1904[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1905[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmcs->channelCount > [0m[1;36m0[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1906[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1907[0m[39m:   [0m[39m        [0m[39mconst size_t length = mcs->channelCount * [0m[1;36m12[0m[39m + [0m[1;36m8[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1908[0m[39m:   [0m[39m        [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mlength <= UINT16_MAX[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1909[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m![0m[1;35mgcc_write_user_data_header[0m[1;39m([0m[39ms, CS_NET, [0m[1;39m([0m[39mUINT16[0m[1;39m)[0m[39mlength[0m[1;39m)[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m1910[0m[39m:   [0m[39m        [0m[39m        [0m[39mreturn FALSE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1911[0m[39m:   [0m[39m        [0m[1;35mStream_Write_UINT32[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m1912[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1913[0m[39m:   [0m[39m        [0m[35m/[0m[39m* channelDefArray *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1914[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1915[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1916[0m[39m:   [0m[39m        [0m[39m        [0m[35m/[0m[39m* CHANNEL_DEF *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1917[0m[39m:   [0m[39m        [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1918[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Write[0m[1;39m([0m[39ms, channel->Name, CHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* [0m   [2m                [0m
[2;36m                    [0m         [39mname [0m[1;39m([0m[1;36m8[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1919[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mStream_Write_UINT32[0m[1;39m([0m[39ms, channel->options[0m[1;39m)[0m[39m;             [0m[35m/[0m[39m* [0m   [2m                [0m
[2;36m                    [0m         [39moptions [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1920[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1921[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1922[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1923[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:2102[0m[39m-[0m[1;36m2156[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m2102:B[0m[39mOOL [0m[1;35mgcc_read_client_monitor_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m2103[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m2104[0m[39m:   [0m[39mUINT32 monitorCount = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2105[0m[39m:   [0m[39mrdpSettings* settings = [0m[1;35mmcs_get_settings[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m2106[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2107[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2108[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39msettings[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2109[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2110[0m[39m:   [0m[39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m2111[0m[39m:   [0m[39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m8[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2112[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2113[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2114[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, settings->MonitorFlags[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* flags *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2115[0m[39m:   [0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, monitorCount[0m[1;39m)[0m[39m;           [0m[35m/[0m[39m* monitorCount *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m2116[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2117[0m[39m:   [0m[35m/[0m[39m* [0m[1;92m2.2.1.3[0m[39m.[0m[1;36m6[0m[39m Client Monitor Data -[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2118[0m[39m:   [0m[39m * monitorCount [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m: A [0m[1;36m32[0m[39m-bit, unsigned integer. The number of [0m       [2m                [0m
[2;36m                    [0m         [39mdisplay[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2119[0m[39m:   [0m[39m * monitor definitions in the monitorDefArray field [0m[1;39m([0m[39mthe maximum allowed is[0m [2m                [0m
[2;36m                    [0m         [1;36m16[0m[1;39m)[0m[39m.[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2120[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m2121[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmonitorCount > [0m[1;36m16[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2122[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2123[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"announced monitors[0m[32m([0m[32m%"[0m[39m PRIu32 [0m[32m"[0m[32m)[0m[32m exceed the 16 [0m       [2m                [0m
[2;36m                    [0m         [32mlimit"[0m[39m, monitorCount[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2124[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2125[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2126[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2127[0m[39m:   [0m[39mif [0m[1;39m([0m[39mmonitorCount > settings->MonitorDefArraySize[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2128[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2129[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"too many announced monitors[0m[32m([0m[32m%"[0m[39m PRIu32 [0m[32m"[0m[32m)[0m[32m, clamping [0m  [2m                [0m
[2;36m                    [0m         [32mto %"[0m[39m PRIu32 [0m[32m""[0m[39m,[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m2130[0m[39m:   [0m[39m        [0m[39m         monitorCount, settings->MonitorDefArraySize[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m2131[0m[39m:   [0m[39m        [0m[39mmonitorCount = settings->MonitorDefArraySize;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2132[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2133[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2134[0m[39m:   [0m[39mif [0m[1;39m([0m[1;39m([0m[39mUINT32[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mblockLength - [0m[1;36m8[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;36m20[0m[1;39m)[0m[39m < monitorCount[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m2135[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2136[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2137[0m[39m:   [0m[39msettings->MonitorCount = monitorCount;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2138[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2139[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 index = [0m[1;36m0[0m[39m; index < monitorCount; index++[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2140[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2141[0m[39m:   [0m[39m        [0m[39mrdpMonitor* current = &settings->MonitorDefArray[0m[1;39m[[0m[39mindex[0m[1;39m][0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m2142[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2143[0m[39m:   [0m[39m        [0m[39mconst INT32 left = [0m[1;35mStream_Get_INT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;    [0m[35m/[0m[39m* left *[0m[35m/[0m               [2m                [0m
[2;36m                    [0m         [1;36m2144[0m[39m:   [0m[39m        [0m[39mconst INT32 top = [0m[1;35mStream_Get_INT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;     [0m[35m/[0m[39m* top *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m2145[0m[39m:   [0m[39m        [0m[39mconst INT32 right = [0m[1;35mStream_Get_INT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;   [0m[35m/[0m[39m* right *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m2146[0m[39m:   [0m[39m        [0m[39mconst INT32 bottom = [0m[1;35mStream_Get_INT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;  [0m[35m/[0m[39m* bottom *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m2147[0m[39m:   [0m[39m        [0m[39mconst UINT32 flags = [0m[1;35mStream_Get_UINT32[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* flags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m2148[0m[39m:   [0m[39m        [0m[39mcurrent->x = left;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2149[0m[39m:   [0m[39m        [0m[39mcurrent->y = top;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2150[0m[39m:   [0m[39m        [0m[39mcurrent->width = right - left + [0m[1;36m1[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2151[0m[39m:   [0m[39m        [0m[39mcurrent->height = bottom - top + [0m[1;36m1[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2152[0m[39m:   [0m[39m        [0m[39mcurrent->is_primary = [0m[1;39m([0m[39mflags & MONITOR_PRIMARY[0m[1;39m)[0m[39m ? TRUE : FALSE;[0m     [2m                [0m
[2;36m                    [0m         [1;36m2153[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2154[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2155[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2156[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/gcc.[0m[1;92mc:1925[0m[39m-[0m[1;36m1971[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1925:B[0m[39mOOL [0m[1;35mgcc_read_server_network_data[0m[1;39m([0m[39mwStream* s, rdpMcs* mcs[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1926[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1927[0m[39m:   [0m[39mUINT16 channelId = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1928[0m[39m:   [0m[39mUINT16 MCSChannelId = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1929[0m[39m:   [0m[39mUINT16 channelCount = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1930[0m[39m:   [0m[39mINT8 parsedChannelCount = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1931[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1932[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mmcs[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1933[0m[39m:   [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLength[0m[1;39m([0m[39mTAG, s, [0m[1;36m4[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1934[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1935[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1936[0m[39m:   [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, MCSChannelId[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* MCSChannelId *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1937[0m[39m:   [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1938[0m[39m:   [0m[39mparsedChannelCount = channelCount;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1939[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1940[0m[39m:   [0m[39mif [0m[1;39m([0m[39mchannelCount != mcs->channelCount[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1941[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1942[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"requested %"[0m[39m PRIu32 [0m[32m" channels, got %"[0m[39m PRIu16 [0m[32m" [0m     [2m                [0m
[2;36m                    [0m         [32minstead"[0m[39m, mcs->channelCount,[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1943[0m[39m:   [0m[39m        [0m[39m         channelCount[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1944[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1945[0m[39m:   [0m[39m        [0m[35m/[0m[39m* we ensure that the response is not bigger than the request *[0m[35m/[0m    [2m                [0m
[2;36m                    [0m         [1;36m1946[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1947[0m[39m:   [0m[39m        [0m[39mmcs->channelCount = channelCount;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1948[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1949[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1950[0m[39m:   [0m[39mif [0m[1;39m([0m[39m![0m[1;35mStream_CheckAndLogRequiredLengthOfSize[0m[1;39m([0m[39mTAG, s, channelCount, 2ull[0m[1;39m)[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m1951[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1952[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1953[0m[39m:   [0m[39mif [0m[1;39m([0m[39mCHANNEL_MAX_COUNT < parsedChannelCount[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1954[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1955[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"requested %"[0m[39m PRIu32 [0m[32m" channels > [0m                    [2m                [0m
[2;36m                    [0m         [32mCHANNEL_MAX_COUNT[0m[32m([0m[32m31[0m[32m)[0m[32m %"[0m[39m PRIu16,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1956[0m[39m:   [0m[39m        [0m[39m         mcs->channelCount, CHANNEL_MAX_COUNT[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1957[0m[39m:   [0m[39m        [0m[39mreturn FALSE;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1958[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1959[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1960[0m[39m:   [0m[39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < parsedChannelCount; i++[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1961[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1962[0m[39m:   [0m[39m        [0m[39mrdpMcsChannel* channel = &mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1963[0m[39m:   [0m[39m        [0m[1;35mStream_Read_UINT16[0m[1;39m([0m[39ms, channelId[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelId *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1964[0m[39m:   [0m[39m        [0m[39mchannel->ChannelId = channelId;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1965[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1966[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1967[0m[39m:   [0m[39mif [0m[1;39m([0m[39mchannelCount % [0m[1;36m2[0m[39m == [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1968[0m[39m:   [0m[39m        [0m[39mreturn [0m[1;35mStream_SafeSeek[0m[1;39m([0m[39ms, [0m[1;36m2[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* padding *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1969[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1970[0m[39m:   [0m[39mreturn TRUE;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1971[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m118[0m[39m-[0m[1;36m126[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:struct rdp_mcs_channel[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mchar Name[0m[1;39m[[0m[39mCHANNEL_NAME_LEN + [0m[1;36m1[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39mUINT32 options;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39mUINT16 ChannelId;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39mBOOL joined;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[39mvoid* handle;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:typedef struct rdp_mcs_channel rdpMcsChannel;[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/mcs.h:[0m[1;36m147[0m[39m-[0m[1;36m148[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[39mINT8 channelCount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[39mrdpMcsChannel* channels;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mwinpr/include/winpr/wtsapi.h:[0m[1;36m74[0m[39m-[0m[1;36m75[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:#define CHANNEL_MAX_COUNT [0m[1;36m31[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:#define CHANNEL_NAME_LEN [0m[1;36m7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Root Cause Analysis[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is a **heap-buffer-overflow** caused by a critical type mismatch [0m [2m                [0m
[2;36m                    [0m         [39min `[0m[1;35mgcc_read_client_network_data[0m[1;39m([0m[1;39m)[0m[39m` at `libfreerdp/core/gcc.[0m[1;92mc:1857[0m[39m`. The function [0m  [2m                [0m
[2;36m                    [0m         [39mincorrectly reads the `channelCount` field as **UINT8 [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m** instead of [0m        [2m                [0m
[2;36m                    [0m         [39m**UINT32 [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m** as specified by the MS-RDPBCGR protocol [0m[1;39m([0m[39mTS_UD_CS_NET [0m         [2m                [0m
[2;36m                    [0m         [39mstructure[0m[1;39m)[0m[39m.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Issues Identified:[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Protocol mismatch**: Line [0m[1;36m1857[0m[39m reads `[0m[1;35mStream_Read_UINT8[0m[1;39m([0m[1;39m)[0m[39m` but the protocol [0m   [2m                [0m
[2;36m                    [0m         [39mand the corresponding write function [0m[1;39m([0m[39m`gcc_write_client_network_dat[0m[1;92ma:1911[0m[39m`[0m[1;39m)[0m[39m use [0m    [2m                [0m
[2;36m                    [0m         [39m`UINT32`[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Type incompatibility**: The read UINT8 value is stored in `mcs->channelCount` [0m [2m                [0m
[2;36m                    [0m         [39mwhich is declared as `INT8` [0m[1;39m([0m[39m`mcs.h:[0m[1;36m147[0m[39m`[0m[1;39m)[0m[39m, causing sign conversion issues for [0m      [2m                [0m
[2;36m                    [0m         [39mvalues > [0m[1;36m127[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Insufficient validation**: The validation at line [0m[1;36m1862[0m[39m occurs AFTER storing in[0m [2m                [0m
[2;36m                    [0m         [39mINT8, which can be bypassed due to sign-related comparison issues when channelCount[0m [2m                [0m
[2;36m                    [0m         [39m> [0m[1;36m127[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Stream data corruption**: Reading only [0m[1;36m1[0m[39m byte leaves [0m[1;36m3[0m[39m bytes unread, causing [0m  [2m                [0m
[2;36m                    [0m         [39mthe subsequent channel data to be misaligned and misinterpreted[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Array bounds violation**: The loop at line [0m[1;36m1866[0m[39m can iterate beyond [0m            [2m                [0m
[2;36m                    [0m         [39m`CHANNEL_MAX_COUNT` [0m[1;39m([0m[1;36m31[0m[1;39m)[0m[39m, writing to `mcs->channels[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m` beyond the allocated [0m       [2m                [0m
[2;36m                    [0m         [1;36m992[0m[39m-byte buffer[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Evidence from Codebase:[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- `gcc_write_client_network_dat[0m[1;92ma:1911[0m[39m` writes channelCount as UINT32[0m                [2m                [0m
[2;36m                    [0m         [39m- `gcc_read_server_network_dat[0m[1;92ma:1937[0m[39m` reads [0m[1;39m([0m[39mserver-side[0m[1;39m)[0m[39m as UINT16[0m                 [2m                [0m
[2;36m                    [0m         [39m- `gcc_read_client_monitor_dat[0m[1;92ma:2115[0m[39m` demonstrates the correct pattern for array [0m   [2m                [0m
[2;36m                    [0m         [39mvalidation[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- The ASan report shows writing at offset [0m[1;36m992[0m[39m [0m[1;39m([0m[39mexactly at boundary[0m[1;39m)[0m[39m, indicating an [0m [2m                [0m
[2;36m                    [0m         [39mattempt to write the 32nd channel when only [0m[1;36m31[0m[39m are allocated[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Fix: Correct the Type Mismatch[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `libfreerdp/core/gcc.[0m[1;92mc:1848[0m[39m-[0m[1;36m1890[0m[39m` [0m[1;39m([0m[39mfunction [0m                          [2m                [0m
[2;36m                    [0m         [39m`gcc_read_client_network_data`[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes Required**:[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Replace UINT8 read with UINT32 read** [0m[1;39m([0m[39mline [0m[1;36m1857[0m[1;39m)[0m[39m:[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Change from: `[0m[1;35mStream_Read_UINT8[0m[1;39m([0m[39ms, mcs->channelCount[0m[1;39m)[0m[39m;`[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Use a local UINT32 variable for reading: `UINT32 channelCount = [0m[1;36m0[0m[39m;`[0m            [2m                [0m
[2;36m                    [0m         [39m   - Read as: `[0m[1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, channelCount[0m[1;39m)[0m[39m;`[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Validate BEFORE storing** [0m[1;39m([0m[39mbefore current line [0m[1;36m1862[0m[1;39m)[0m[39m:[0m                          [2m                [0m
[2;36m                    [0m         [39m   - Add validation: `if [0m[1;39m([0m[39mchannelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m[39m return FALSE;`[0m          [2m                [0m
[2;36m                    [0m         [39m   - Add error logging similar to `gcc_read_client_monitor_dat[0m[1;92ma:2123[0m[39m`[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Update stream validation** [0m[1;39m([0m[39mline [0m[1;36m1859[0m[1;39m)[0m[39m:[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - Change from: `if [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + [0m[1;39m([0m[39mUINT8[0m[1;39m)[0m[39mmcs->channelCount * [0m[1;36m12[0m[1;39m)[0m[39m`[0m            [2m                [0m
[2;36m                    [0m         [39m   - Change to: `if [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + channelCount * [0m[1;36m12[0m[1;39m)[0m[39m`[0m                          [2m                [0m
[2;36m                    [0m         [39m   - This correctly accounts for the [0m[1;36m4[0m[39m-byte channelCount field plus channel array [0m  [2m                [0m
[2;36m                    [0m         [39mdata[0m                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Store validated value** [0m[1;39m([0m[39mafter validation[0m[1;39m)[0m[39m:[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - Only then store: `mcs->channelCount = [0m[1;39m([0m[39mINT8[0m[1;39m)[0m[39mchannelCount;`[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Note: The cast to INT8 is safe now because we validated channelCount <= [0m       [2m                [0m
[2;36m                    [0m         [39mCHANNEL_MAX_COUNT [0m[1;39m([0m[1;36m31[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Use validated value in loop** [0m[1;39m([0m[39mline [0m[1;36m1866[0m[1;39m)[0m[39m:[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - The loop should continue using `mcs->channelCount` after it's been safely [0m     [2m                [0m
[2;36m                    [0m         [39mstored[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - Alternatively, use the local `channelCount` variable for additional safety[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Detailed Implementation Steps:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1[0m[39m**: Modify the beginning of `gcc_read_client_network_data` [0m[1;39m([0m[39mlines [0m          [2m                [0m
[2;36m                    [0m         [1;36m1853[0m[39m-[0m[1;36m1863[0m[1;39m)[0m[39m:[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mconst size_t blockLength = [0m[1;35mStream_GetRemainingLength[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [39m    return FALSE;[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mUINT32 channelCount = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;35mStream_Read_UINT32[0m[1;39m([0m[39ms, channelCount[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* channelCount [0m[1;39m([0m[1;36m4[0m[39m bytes[0m[1;39m)[0m[39m *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mchannelCount > CHANNEL_MAX_COUNT[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"announced channels[0m[32m([0m[32m%"[0m[39m PRIu32 [0m[32m"[0m[32m)[0m[32m exceed the %d limit"[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39m             channelCount, CHANNEL_MAX_COUNT[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m    return FALSE;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mblockLength < [0m[1;36m4[0m[39m + channelCount * [0m[1;36m12[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [39m    return FALSE;[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mmcs->channelCount = [0m[1;39m([0m[39mINT8[0m[1;39m)[0m[39mchannelCount;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m2[0m[39m**: The loop at line [0m[1;36m1866[0m[39m remains unchanged, as it now safely uses the [0m     [2m                [0m
[2;36m                    [0m         [39mvalidated `mcs->channelCount`:[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mfor [0m[1;39m([0m[39mUINT32 i = [0m[1;36m0[0m[39m; i < mcs->channelCount; i++[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m existing loop body unchanged[0m                                                 [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Pattern Reference[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix follows the **exact same pattern** used in `gcc_read_client_monitor_data` [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mlines [0m[1;36m2102[0m[39m-[0m[1;36m2156[0m[1;39m)[0m[39m, which correctly:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Reads count as UINT32 into a local variable [0m[1;39m([0m[39mline [0m[1;36m2115[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Validates against maximum before using [0m[1;39m([0m[39mline [0m[1;36m2121[0m[39m-[0m[1;36m2125[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Validates stream has sufficient data [0m[1;39m([0m[39mline [0m[1;36m2134[0m[39m-[0m[1;36m2135[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Stores the validated value [0m[1;39m([0m[39mline [0m[1;36m2137[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Uses the validated value in the array access loop [0m[1;39m([0m[39mline [0m[1;36m2139[0m[39m-[0m[1;36m2153[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Is the Optimal Approach:[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Protocol compliance**: Matches the MS-RDPBCGR specification [0m[1;39m([0m[39mTS_UD_CS_NET[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mwhich defines channelCount as a [0m[1;36m4[0m[39m-byte field[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Consistency with write function**: Aligns with [0m                                [2m                [0m
[2;36m                    [0m         [39m`gcc_write_client_network_dat[0m[1;92ma:1911[0m[39m` which writes UINT32[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Follows existing patterns**: Replicates the validated approach in [0m             [2m                [0m
[2;36m                    [0m         [39m`gcc_read_client_monitor_data` and `gcc_read_server_network_data`[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Minimal invasiveness**: Only changes the necessary lines without affecting [0m    [2m                [0m
[2;36m                    [0m         [39mother functionality[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Proper validation order**: Validates BEFORE storing in the INT8 field, [0m        [2m                [0m
[2;36m                    [0m         [39mpreventing sign-related bypass issues[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Preserves Existing Logic:[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **No structural changes**: The function flow remains identical[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Same validation checks**: Just reordered and with correct types[0m                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Loop logic unchanged**: The iteration and channel processing remain the same[0m   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Error handling preserved**: All existing error paths are maintained[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **INT8 storage maintained**: Keeps `mcs->channelCount` as INT8 for backward [0m     [2m                [0m
[2;36m                    [0m         [39mcompatibility, but ensures only valid values [0m[1;39m([0m[39m≤[0m[1;36m31[0m[1;39m)[0m[39m are stored[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Vulnerability:[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Eliminates type mismatch**: Reads the correct [0m[1;36m4[0m[39m bytes instead of [0m[1;36m1[0m             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Prevents stream misalignment**: All [0m[1;36m4[0m[39m bytes of channelCount are consumed[0m       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Validates before use**: Ensures channelCount ≤ CHANNEL_MAX_COUNT before any [0m   [2m                [0m
[2;36m                    [0m         [39marray access[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Prevents buffer overflow**: The loop cannot iterate beyond the allocated [0m      [2m                [0m
[2;36m                    [0m         [1;36m992[0m[39m-byte array[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Handles malicious input**: Rejects invalid channelCount values before they [0m    [2m                [0m
[2;36m                    [0m         [39mcause harm[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation:[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Compatibility concern**: If there are clients sending malformed data with [0m     [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m-byte channelCount, they will now be rejected[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: This is correct behavior - the protocol specifies [0m[1;36m4[0m[39m bytes, so [0m [2m                [0m
[2;36m                    [0m         [39mrejecting non-compliant data enhances security[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - The write function already sends [0m[1;36m4[0m[39m bytes, so legitimate clients are unaffected[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Performance impact**: Adding validation has negligible performance overhead[0m    [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: The validation is a simple comparison, already present but [0m    [2m                [0m
[2;36m                    [0m         [39mjust reordered[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Type casting from UINT32 to INT8**: After validation, we cast back to INT8 for[0m [2m                [0m
[2;36m                    [0m         [39mstorage[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: Safe because we validate channelCount ≤ [0m[1;36m31[0m[39m, which fits in INT8[0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mmax [0m[1;36m127[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix directly mirrors these existing implementations:[0m                            [2m                [0m
[2;36m                    [0m         [39m- `gcc_read_client_monitor_data` [0m[1;39m([0m[39mlines [0m[1;36m2114[0m[39m-[0m[1;36m2125[0m[1;39m)[0m[39m: Reads UINT32, validates against[0m [2m                [0m
[2;36m                    [0m         [39mlimit, then uses[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- `gcc_read_server_network_data` [0m[1;39m([0m[39mlines [0m[1;36m1936[0m[39m-[0m[1;36m1958[0m[1;39m)[0m[39m: Uses local variable, validates [0m [2m                [0m
[2;36m                    [0m         [39mbefore array access[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- `mcs_initialize_client_channels` [0m[1;39m([0m[39mlines [0m[1;36m306[0m[39m-[0m[1;36m309[0m[1;39m)[0m[39m: Clamps to CHANNEL_MAX_COUNT [0m    [2m                [0m
[2;36m                    [0m         [39mbefore use[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Code Ranges Used for Fix Strategy[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<code_range>libfreerdp/core/gcc.[0m[1;92mc:1848[0m[39m-[0m[1;36m1890[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                            [2m                [0m
[2;36m                    [0m         [39m<code_range>libfreerdp/core/gcc.[0m[1;92mc:1901[0m[39m-[0m[1;36m1923[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                            [2m                [0m
[2;36m                    [0m         [39m<code_range>libfreerdp/core/gcc.[0m[1;92mc:2102[0m[39m-[0m[1;36m2156[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                            [2m                [0m
[2;36m                    [0m         [39m<code_range>libfreerdp/core/gcc.[0m[1;92mc:1925[0m[39m-[0m[1;36m1971[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                            [2m                [0m
[2;36m                    [0m         [39m<code_range>libfreerdp/core/mcs.h:[0m[1;36m118[0m[39m-[0m[1;36m126[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                              [2m                [0m
[2;36m                    [0m         [39m<code_range>libfreerdp/core/mcs.h:[0m[1;36m147[0m[39m-[0m[1;36m148[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                              [2m                [0m
[2;36m                    [0m         [39m<code_range>winpr/include/winpr/wtsapi.h:[0m[1;36m74[0m[39m-[0m[1;36m75[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=687840;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=379786;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=151934;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=358571;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp_xk5ramv[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/freerdp_fp-full-01_vuln_004/[0m[95ma[0m [2m               [0m
[2;36m                    [0m         [95mgent-output-1767845504.6379852[0m                                                       [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/freerdp_fp-full-01_vuln_004.toml                    [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-freerdp[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/08/26 04:11:46][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mfreerdp[0m        ]8;id=649398;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=600933;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=113345;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=445131;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mfreerdp[0m               [2m               [0m
[2;36m[01/08/26 04:11:47][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=82625;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=965562;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m                [2m               [0m
