{
  "project_name": "dav1d",
  "vulnerability_identifier": "dav1d_da-full-01_dav1d-001",
  "source_directory": "/home/user/crete/.cache/official-afc-dav1d",
  "llm_usage": {
    "total_cost": 7.248867000000002,
    "prompt_tokens": 1987229,
    "completion_tokens": 85812
  },
  "variant": "vulnerable",
  "diff": "--- a/src/decode.c\n+++ b/src/decode.c\n@@ -2470,7 +2470,7 @@\n                        const Dav1dFrameContext *const f,\n                        const uint8_t *const data, const size_t sz,\n                        const int tile_row, const int tile_col,\n-                       const int tile_start_off)\n+                       const unsigned tile_start_off)\n {\n     const int col_sb_start = f->frame_hdr->tiling.col_start_sb[tile_col];\n     const int col_sb128_start = col_sb_start >> !f->seq_hdr->sb128;\n@@ -2843,15 +2843,16 @@\n     const uint8_t *const size_mul = ss_size_mul[f->cur.p.layout];\n     const int hbd = !!f->seq_hdr->hbd;\n     if (c->n_fc > 1) {\n+        const unsigned sb_step4 = f->sb_step * 4;\n         int tile_idx = 0;\n         for (int tile_row = 0; tile_row < f->frame_hdr->tiling.rows; tile_row++) {\n-            int row_off = f->frame_hdr->tiling.row_start_sb[tile_row] *\n-                          f->sb_step * 4 * f->sb128w * 128;\n-            int b_diff = (f->frame_hdr->tiling.row_start_sb[tile_row + 1] -\n-                          f->frame_hdr->tiling.row_start_sb[tile_row]) * f->sb_step * 4;\n+            const unsigned row_off = f->frame_hdr->tiling.row_start_sb[tile_row] *\n+                                     sb_step4 * f->sb128w * 128;\n+            const unsigned b_diff = (f->frame_hdr->tiling.row_start_sb[tile_row + 1] -\n+                                     f->frame_hdr->tiling.row_start_sb[tile_row]) * sb_step4;\n             for (int tile_col = 0; tile_col < f->frame_hdr->tiling.cols; tile_col++) {\n                 f->frame_thread.tile_start_off[tile_idx++] = row_off + b_diff *\n-                    f->frame_hdr->tiling.col_start_sb[tile_col] * f->sb_step * 4;\n+                    f->frame_hdr->tiling.col_start_sb[tile_col] * sb_step4;\n             }\n         }\n \n\n--- a/src/internal.h\n+++ b/src/internal.h\n@@ -289,7 +289,7 @@\n         int prog_sz;\n         int cbi_sz, pal_sz, pal_idx_sz, cf_sz;\n         // start offsets per tile\n-        int *tile_start_off;\n+        unsigned *tile_start_off;\n     } frame_thread;\n \n     // loopfilter\n",
  "stdout": "+ FUZZER=dav1d_fuzzer_mt\r\n+ shift\r\n+ '[' '!' -v TESTCASE ']'\r\n+ TESTCASE=/testcase\r\n+ '[' '!' -f /testcase ']'\r\n+ export RUN_FUZZER_MODE=interactive\r\n+ RUN_FUZZER_MODE=interactive\r\n+ export FUZZING_ENGINE=libfuzzer\r\n+ FUZZING_ENGINE=libfuzzer\r\n+ export SKIP_SEED_CORPUS=1\r\n+ SKIP_SEED_CORPUS=1\r\n+ run_fuzzer dav1d_fuzzer_mt -runs=100 /testcase\r\nvm.mmap_rnd_bits = 28\r\n/out/dav1d_fuzzer_mt -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase -rss_limit_mb=0 -runs=4 -timeout=300 -timeout_exitcode=0 < /dev/null\r\nbash: /out/dav1d_fuzzer_mt: Permission denied\r\nsubprocess command returned a non-zero exit status: 126\n",
  "stderr": "INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/dav1d:/out -v /tmp/tmpghdd8220:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce dav1d_fuzzer_mt -runs=100.\n"
}