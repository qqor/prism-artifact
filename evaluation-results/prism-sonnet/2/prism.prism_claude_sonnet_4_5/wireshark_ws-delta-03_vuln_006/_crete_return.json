{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-delta-03_vuln_006",
  "source_directory": "/home/user/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 1.8169920000000002,
    "prompt_tokens": 542539,
    "completion_tokens": 12625
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-irc.c\n+++ b/epan/dissectors/packet-irc.c\n@@ -366,12 +366,12 @@\n              return;\n          }\n  \n-         memset(channel_name, 0, CHANNELLEN+1);\n-         tvb_memcpy(tvb, channel_name, start_offset, (length < CHANNELLEN) ? length : CHANNELLEN);\n-         proto_item_append_text(tree, \"Channel: %s\", channel_name);\n- \n-         proto_tree_add_item(tree, hf_irc_request_command_join_channel, tvb, start_offset, length, ENC_ASCII);\n-         start_offset = end_offset + 1;\n+        memset(channel_name, 0, CHANNELLEN+1);\n+        tvb_memcpy(tvb, channel_name, start_offset, (end_offset-start_offset < CHANNELLEN) ? end_offset-start_offset : CHANNELLEN);\n+        proto_item_append_text(tree, \"Channel: %s\", channel_name);\n+\n+        proto_tree_add_item(tree, hf_irc_request_command_join_channel, tvb, start_offset, end_offset-start_offset, ENC_ASCII);\n+        start_offset = end_offset + 1;\n      }\n  \n      free(channel_name);\n@@ -434,12 +434,12 @@\n              return;\n          }\n  \n-         memset(channel_name, 0, CHANNELLEN+1);\n-         tvb_memcpy(tvb, channel_name, start_offset, (length < CHANNELLEN) ? length : CHANNELLEN);\n-         proto_item_append_text(tree, \"Channel: %s\", channel_name);\n- \n-         proto_tree_add_item(tree, hf_irc_request_command_join_channel, tvb, start_offset, length, ENC_ASCII);\n-         start_offset = end_offset + 1;\n+        memset(channel_name, 0, CHANNELLEN+1);\n+        tvb_memcpy(tvb, channel_name, start_offset, (end_offset-start_offset < CHANNELLEN) ? end_offset-start_offset : CHANNELLEN);\n+        proto_item_append_text(tree, \"Channel: %s\", channel_name);\n+\n+        proto_tree_add_item(tree, hf_irc_request_command_part_channel, tvb, start_offset, end_offset-start_offset, ENC_ASCII);\n+        start_offset = end_offset + 1;\n      }\n  \n      free(channel_name);\n@@ -559,9 +559,9 @@\n              return;\n          }\n  \n-         memset(channel_name, 0, CHANNELLEN+1);\n-         tvb_memcpy(tvb, channel_name, start_offset, length);\n-         proto_item_append_text(tree, \"Channel: %s\", channel_name);\n+        memset(channel_name, 0, CHANNELLEN+1);\n+        tvb_memcpy(tvb, channel_name, start_offset, (end_offset-start_offset < CHANNELLEN) ? end_offset-start_offset : CHANNELLEN);\n+        proto_item_append_text(tree, \"Channel: %s\", channel_name);\n  \n          proto_tree_add_item(tree, hf_irc_request_command_names_channel, tvb, start_offset, end_offset-start_offset, ENC_ASCII);\n          start_offset = end_offset + 1;\n",
  "stdout": "",
  "stderr": ""
}