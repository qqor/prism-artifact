{
  "project_name": "apache-poi",
  "vulnerability_identifier": "apache-poi_poi-delta-01_vuln_6",
  "source_directory": "/home/qqor/crete/.cache/official-afc-poi",
  "llm_usage": {
    "total_cost": 11.624126999999994,
    "prompt_tokens": 3427964,
    "completion_tokens": 89349
  },
  "variant": "uncompilable",
  "diff": "--- a/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java\n+++ b/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java\n@@ -306,31 +306,16 @@\n             return _value;\n         }\n     }\n-    public static final class StringMatcher extends MatcherBase {\n-\n-        private final String _value;\n-        private final Pattern _pattern;\n-\n         public StringMatcher(String value, CmpOp operator) {\n             super(operator);\n             _value = value;\n-            switch(operator.getCode()) {\n-                case CmpOp.NONE:\n-                case CmpOp.EQ:\n-                case CmpOp.NE:\n-                    _pattern = getWildCardPattern(value);\n-                    break;\n-                default:\n-                    // pattern matching is never used for < > <= =>\n-                    _pattern = null;\n-            }\n+            // Don't compile regex patterns - use iterative wildcard matching instead\n+            // to prevent StackOverflowError from catastrophic backtracking\n+            _pattern = null;\n         }\n         @Override\n         protected String getValueText() {\n-            if (_pattern == null) {\n-                return _value;\n-            }\n-            return _pattern.pattern();\n+            return _value;\n         }\n \n         @Override\n@@ -365,8 +350,8 @@\n                 }\n                 return false;\n             }\n-            if (_pattern != null) {\n-                return evaluate(_pattern.matcher(testedValue).matches());\n+            if (hasWildcardChars(_value)) {\n+                return evaluate(matchesWildcard(_value, testedValue));\n             }\n             // String criteria in COUNTIF are case insensitive:\n             // for example, the string \"apples\" and the string \"APPLES\" will match the same cells.\n@@ -376,55 +361,110 @@\n          * Translates Excel countif wildcard strings into java regex strings\n          * @return {@code null} if the specified value contains no special wildcard characters.\n          */\n+        /**\n+         * @deprecated This method can cause StackOverflowError for complex patterns.\n+         * Use matchesWildcard() instead for safe wildcard matching.\n+         * Maintained for backward compatibility but returns null to avoid regex issues.\n+         */\n+        @Deprecated\n         public static Pattern getWildCardPattern(String value) {\n-            int len = value.length();\n-            StringBuilder sb = new StringBuilder(len);\n-            boolean hasWildCard = false;\n-            for(int i=0; i<len; i++) {\n+            return null;\n+        }\n+        \n+        /**\n+         * Checks if a string contains unescaped wildcard characters (* or ?).\n+         * In Excel wildcards, ~ is an escape character only when followed by * or ?.\n+         * @param value the string to check\n+         * @return true if the string contains unescaped wildcards\n+         */\n+        /* package */ static boolean hasWildcardChars(String value) {\n+            for (int i = 0; i < value.length(); i++) {\n                 char ch = value.charAt(i);\n-                switch(ch) {\n-                    case '?':  //Any single character\n-                        hasWildCard = true;\n-                        // match exactly one character\n-                        sb.append('.');\n+                if (ch == '~' && i + 1 < value.length()) {\n+                    char next = value.charAt(i + 1);\n+                    if (next == '*' || next == '?') {\n+                        i++;\n                         continue;\n-                    case '*': //Zero or more characters\n-                        hasWildCard = true;\n-                        // match one or more occurrences of any character\n-                        sb.append(\".*\");\n-                        continue;\n-                    case '~':\n-                        if (i+1<len) {\n-                            ch = value.charAt(i+1);\n-                            switch (ch) {\n-                                case '?':\n-                                case '*':\n-                                    hasWildCard = true;\n-                                    sb.append('[').append(ch).append(']');\n-                                    i++; // Note - incrementing loop variable here\n-                                    continue;\n+                    }\n+                }\n+                if (ch == '*' || ch == '?') {\n+                    return true;\n+                }\n+            }\n+            return false;\n+        }\n+        \n+        /**\n+         * Matches text against an Excel wildcard pattern using iterative algorithm.\n+         * Handles Excel wildcards: * (zero or more chars), ? (exactly one char), ~ (escape).\n+         * This implementation avoids recursion to prevent StackOverflowError.\n+         * \n+         * @param pattern The wildcard pattern (case-insensitive)\n+         * @param text The text to match against\n+         * @return true if text matches pattern\n+         */\n+        /* package */ static boolean matchesWildcard(String pattern, String text) {\n+            int pi = 0;\n+            int ti = 0;\n+            int starIndex = -1;\n+            int matchIndex = 0;\n+            \n+            while (ti < text.length()) {\n+                if (pi < pattern.length()) {\n+                    char pch = pattern.charAt(pi);\n+                    \n+                    if (pch == '~' && pi + 1 < pattern.length()) {\n+                        char nextCh = pattern.charAt(pi + 1);\n+                        if (nextCh == '*' || nextCh == '?') {\n+                            pi++;\n+                            pch = pattern.charAt(pi);\n+                            if (Character.toLowerCase(pch) == Character.toLowerCase(text.charAt(ti))) {\n+                                pi++;\n+                                ti++;\n+                                continue;\n+                            }\n+                        } else {\n+                            if (Character.toLowerCase(pch) == Character.toLowerCase(text.charAt(ti))) {\n+                                pi++;\n+                                ti++;\n+                                continue;\n                             }\n                         }\n-                        // else not '~?' or '~*'\n-                        sb.append('~'); // just plain '~'\n+                    } else if (pch == '*') {\n+                        starIndex = pi;\n+                        matchIndex = ti;\n+                        pi++;\n                         continue;\n-                    case '.':\n-                    case '$':\n-                    case '^':\n-                    case '[':\n-                    case ']':\n-                    case '(':\n-                    case ')':\n-                        // escape literal characters that would have special meaning in regex\n-                        sb.append(\"\\\\\").append(ch);\n+                    } else if (pch == '?') {\n+                        pi++;\n+                        ti++;\n                         continue;\n-                }\n-                sb.append(ch);\n-            }\n-            if (hasWildCard) {\n-                return Pattern.compile(sb.toString(), Pattern.CASE_INSENSITIVE);\n-            }\n-            return null;\n+                    } else if (Character.toLowerCase(pch) == Character.toLowerCase(text.charAt(ti))) {\n+                        pi++;\n+                        ti++;\n+                        continue;\n+                    }\n+                }\n+                \n+                if (starIndex != -1) {\n+                    pi = starIndex + 1;\n+                    matchIndex++;\n+                    ti = matchIndex;\n+                } else {\n+                    return false;\n+                }\n+            }\n+            \n+            while (pi < pattern.length()) {\n+                char pch = pattern.charAt(pi);\n+                if (pch == '*') {\n+                    pi++;\n+                } else {\n+                    break;\n+                }\n+            }\n+            \n+            return pi == pattern.length();\n         }\n     }\n \n\n--- a/poi/src/main/java/org/apache/poi/ss/formula/functions/LookupUtils.java\n+++ b/poi/src/main/java/org/apache/poi/ss/formula/functions/LookupUtils.java\n@@ -397,7 +397,7 @@\n         protected StringLookupComparer(StringEval se, boolean matchExact, boolean isMatchFunction) {\n             super(se);\n             _value = se.getStringValue();\n-            _wildCardPattern = Countif.StringMatcher.getWildCardPattern(_value);\n+            _wildCardPattern = null;\n             _matchExact = matchExact;\n             _isMatchFunction = isMatchFunction;\n         }\n@@ -410,10 +410,8 @@\n         @Override\n         protected CompareResult compareSameType(ValueEval other) {\n             String stringValue = convertToString(other);\n-            if (_wildCardPattern != null && (_isMatchFunction || !_matchExact)) {\n-                Matcher matcher = _wildCardPattern.matcher(stringValue);\n-                boolean matches = matcher.matches();\n-\n+            if (Countif.StringMatcher.hasWildcardChars(_value) && (_isMatchFunction || !_matchExact)) {\n+                boolean matches = Countif.StringMatcher.matchesWildcard(_value, stringValue);\n                 return CompareResult.valueOf(matches);\n             }\n \n\n--- a/poi/src/main/java/org/apache/poi/ss/formula/functions/DStarRunner.java\n+++ b/poi/src/main/java/org/apache/poi/ss/formula/functions/DStarRunner.java\n@@ -352,11 +352,10 @@\n                     String valueString = value instanceof BlankEval ? \"\" : OperandResolver.coerceValueToString(value);\n                     final String lowerValue = valueString.toLowerCase(LocaleUtil.getUserLocale());\n                     final String lowerCondition = conditionString.toLowerCase(LocaleUtil.getUserLocale());\n-                    final Pattern pattern = Countif.StringMatcher.getWildCardPattern(lowerCondition);\n-                    if (pattern == null) {\n+                    if (Countif.StringMatcher.hasWildcardChars(lowerCondition)) {\n+                        return Countif.StringMatcher.matchesWildcard(lowerCondition, lowerValue);\n+                    } else {\n                         return lowerValue.startsWith(lowerCondition);\n-                    } else {\n-                        return pattern.matcher(lowerValue).matches();\n                     }\n                 }\n             }\n",
  "stdout": "/src /src/poi\r\n/src/poi\r\n---------------------------------------------------------------\r\nvm.mmap_rnd_bits = 28\r\n---------------------------------------------------------------\r\nCC=clang\r\nCXX=clang++\r\nCFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types   -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension   -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -fno-sanitize=leak\r\nCXXFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types   -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension   -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -stdlib=libc++ -fno-sanitize=leak\r\nRUSTFLAGS=--cfg fuzzing -Zsanitizer=address -Cdebuginfo=1 -Cforce-frame-pointers\r\n---------------------------------------------------------------\r\n+ __REAL_MAVEN_REPO=/root/.m2/repository\r\n+ __SHARED_MAVEN_REPO=/work/mavencache\r\n+ '[' '!' -L /root/.m2/repository ']'\r\n+ unset __REAL_MAVEN_REPO\r\n+ unset __SHARED_MAVEN_REPO\r\n+ MVN_FLAGS='--no-transfer-progress -DskipTests'\r\n+ ALL_JARS=\r\n+ LIBRARY_NAME=poi\r\n+ GRADLE_FLAGS='-x javadoc -x test -Dfile.encoding=UTF-8 -Porg.gradle.java.installations.fromEnv=JAVA_HOME_8,JAVA_HOME_11 --console=plain'\r\n+ echo Copy libraries for java.awt in place\r\nCopy libraries for java.awt in place\r\n+ ls /usr/lib/x86_64-linux-gnu/\r\nMcrt1.o\t\t\t   liblzma.so.5.2.4\r\nScrt1.o\t\t\t   libm-2.31.a\r\napr-util-1\t\t   libm-2.31.so\r\naudit\t\t\t   libm.a\r\ncoreutils\t\t   libm.so\r\ncrt1.o\t\t\t   libm.so.6\r\ncrti.o\t\t\t   libmcheck.a\r\ncrtn.o\t\t\t   libmemusage.so\r\ne2fsprogs\t\t   libmenu.so.6\r\nengines-1.1\t\t   libmenu.so.6.2\r\ngconv\t\t\t   libmenuw.so.6\r\ngcrt1.o\t\t\t   libmenuw.so.6.2\r\ngrcrt1.o\t\t   libmount.so.1\r\nkrb5\t\t\t   libmount.so.1.1.0\r\nld-2.31.so\t\t   libmpc.so.3\r\nld-linux-x86-64.so.2\t   libmpc.so.3.1.0\r\nldscripts\t\t   libmpfr.so.6\r\nlibBrokenLocale-2.31.so    libmpfr.so.6.0.2\r\nlibBrokenLocale.a\t   libmvec-2.31.so\r\nlibBrokenLocale.so\t   libmvec.a\r\nlibBrokenLocale.so.1\t   libmvec.so\r\nlibSegFault.so\t\t   libmvec.so.1\r\nlibX11.so.6\t\t   libncurses.so.6\r\nlibX11.so.6.3.0\t\t   libncurses.so.6.2\r\nlibXau.so.6\t\t   libncursesw.so.6\r\nlibXau.so.6.0.0\t\t   libncursesw.so.6.2\r\nlibXdmcp.so.6\t\t   libnettle.so.7\r\nlibXdmcp.so.6.0.0\t   libnettle.so.7.0\r\nlibXext.so.6\t\t   libnghttp2.so.14\r\nlibXext.so.6.4.0\t   libnghttp2.so.14.19.0\r\nlibXi.so.6\t\t   libnpth.so.0\r\nlibXi.so.6.1.0\t\t   libnpth.so.0.1.2\r\nlibXmuu.so.1\t\t   libnsl-2.31.so\r\nlibXmuu.so.1.0.0\t   libnsl.a\r\nlibXrender.so.1\t\t   libnsl.so\r\nlibXrender.so.1.3.0\t   libnsl.so.1\r\nlibXtst.so.6\t\t   libnss_compat-2.31.so\r\nlibXtst.so.6.1.0\t   libnss_compat.so\r\nlibacl.so.1\t\t   libnss_compat.so.2\r\nlibacl.so.1.1.2253\t   libnss_dns-2.31.so\r\nlibanl-2.31.so\t\t   libnss_dns.so\r\nlibanl.a\t\t   libnss_dns.so.2\r\nlibanl.so\t\t   libnss_files-2.31.so\r\nlibanl.so.1\t\t   libnss_files.so\r\nlibapr-1.so.0\t\t   libnss_files.so.2\r\nlibapr-1.so.0.6.5\t   libnss_hesiod-2.31.so\r\nlibaprutil-1.so.0\t   libnss_hesiod.so\r\nlibaprutil-1.so.0.6.1\t   libnss_hesiod.so.2\r\nlibapt-pkg.so.6.0\t   libnss_nis-2.31.so\r\nlibapt-pkg.so.6.0.0\t   libnss_nis.so\r\nlibapt-private.so.0.0\t   libnss_nis.so.2\r\nlibapt-private.so.0.0.0    libnss_nisplus-2.31.so\r\nlibasan.so.5\t\t   libnss_nisplus.so\r\nlibasan.so.5.0.0\t   libnss_nisplus.so.2\r\nlibasn1.so.8\t\t   libonig.so.5\r\nlibasn1.so.8.0.0\t   libonig.so.5.0.0\r\nlibassuan.so.0\t\t   libopcodes-2.34-system.so\r\nlibassuan.so.0.8.3\t   libopcodes.a\r\nlibatomic.so.1\t\t   libopcodes.so\r\nlibatomic.so.1.2.0\t   libp11-kit.so.0\r\nlibattr.so.1\t\t   libp11-kit.so.0.3.0\r\nlibattr.so.1.1.2448\t   libpam.so.0\r\nlibaudit.so.1\t\t   libpam.so.0.84.2\r\nlibaudit.so.1.0.0\t   libpam_misc.so.0\r\nlibbfd-2.34-system.so\t   libpam_misc.so.0.82.1\r\nlibbfd.a\t\t   libpamc.so.0\r\nlibbfd.so\t\t   libpamc.so.0.82.1\r\nlibblkid.so.1\t\t   libpanel.so.6\r\nlibblkid.so.1.1.0\t   libpanel.so.6.2\r\nlibbrotlicommon.so.1\t   libpanelw.so.6\r\nlibbrotlicommon.so.1.0.7   libpanelw.so.6.2\r\nlibbrotlidec.so.1\t   libpcprofile.so\r\nlibbrotlidec.so.1.0.7\t   libpcre.so.3\r\nlibbrotlienc.so.1\t   libpcre.so.3.13.3\r\nlibbrotlienc.so.1.0.7\t   libpcre2-8.so.0\r\nlibbsd.so.0\t\t   libpcre2-8.so.0.9.0\r\nlibbsd.so.0.10.0\t   libpcreposix.so.3\r\nlibbz2.so.1\t\t   libpcreposix.so.3.13.3\r\nlibbz2.so.1.0\t\t   libperl.so.5.30\r\nlibbz2.so.1.0.4\t\t   libperl.so.5.30.0\r\nlibc-2.31.so\t\t   libpng16.so.16\r\nlibc.a\t\t\t   libpng16.so.16.37.0\r\nlibc.so\t\t\t   libpopt.so.0\r\nlibc.so.6\t\t   libpopt.so.0.0.0\r\nlibc_nonshared.a\t   libprocps.so.8\r\nlibcap-ng.so.0\t\t   libprocps.so.8.0.2\r\nlibcap-ng.so.0.0.0\t   libpsl.so.5\r\nlibcbor.so.0.6\t\t   libpsl.so.5.3.2\r\nlibcbor.so.0.6.0\t   libpthread-2.31.so\r\nlibcc1.so.0\t\t   libpthread.a\r\nlibcc1.so.0.0.0\t\t   libpthread.so\r\nlibcom_err.so.2\t\t   libpthread.so.0\r\nlibcom_err.so.2.1\t   libquadmath.so.0\r\nlibcrypt.a\t\t   libquadmath.so.0.0.0\r\nlibcrypt.so\t\t   libreadline.so.8\r\nlibcrypt.so.1\t\t   libreadline.so.8.0\r\nlibcrypt.so.1.1.0\t   libresolv-2.31.so\r\nlibcrypto.a\t\t   libresolv.a\r\nlibcrypto.so\t\t   libresolv.so\r\nlibcrypto.so.1.1\t   libresolv.so.2\r\nlibctf-nobfd.a\t\t   libroken.so.18\r\nlibctf-nobfd.so\t\t   libroken.so.18.1.0\r\nlibctf-nobfd.so.0\t   librpcsvc.a\r\nlibctf-nobfd.so.0.0.0\t   librt-2.31.so\r\nlibctf.a\t\t   librt.a\r\nlibctf.so\t\t   librt.so\r\nlibctf.so.0\t\t   librt.so.1\r\nlibctf.so.0.0.0\t\t   librtmp.so.1\r\nlibcurl-gnutls.so.3\t   libsasl2.so.2\r\nlibcurl-gnutls.so.4\t   libsasl2.so.2.0.25\r\nlibcurl-gnutls.so.4.6.0    libseccomp.so.2\r\nlibcurl.so.4\t\t   libseccomp.so.2.5.1\r\nlibcurl.so.4.6.0\t   libselinux.so.1\r\nlibdb-5.3.so\t\t   libsemanage.so.1\r\nlibdebconfclient.so.0\t   libsepol.so.1\r\nlibdebconfclient.so.0.0.0  libserf-1.so.1\r\nlibdl-2.31.so\t\t   libserf-1.so.1.3.0\r\nlibdl.a\t\t\t   libsmartcols.so.1\r\nlibdl.so\t\t   libsmartcols.so.1.1.0\r\nlibdl.so.2\t\t   libsqlite3.so.0\r\nlibe2p.so.2\t\t   libsqlite3.so.0.8.6\r\nlibe2p.so.2.3\t\t   libss.so.2\r\nlibedit.so.2\t\t   libss.so.2.0\r\nlibedit.so.2.0.63\t   libssh.so.4\r\nlibexpat.so.1\t\t   libssh.so.4.8.4\r\nlibexpat.so.1.6.11\t   libssl.a\r\nlibexpatw.so.1\t\t   libssl.so\r\nlibexpatw.so.1.6.11\t   libssl.so.1.1\r\nlibext2fs.so.2\t\t   libstdc++.so.6\r\nlibext2fs.so.2.4\t   libstdc++.so.6.0.28\r\nlibfakeroot\t\t   libsvn_auth_gnome_keyring-1.so.1\r\nlibfdisk.so.1\t\t   libsvn_auth_gnome_keyring-1.so.1.0.0\r\nlibfdisk.so.1.1.0\t   libsvn_auth_kwallet-1.so.1\r\nlibffi.so.7\t\t   libsvn_auth_kwallet-1.so.1.0.0\r\nlibffi.so.7.1.0\t\t   libsvn_client-1.so.1\r\nlibfido2.so.1\t\t   libsvn_client-1.so.1.0.0\r\nlibfido2.so.1.3.1\t   libsvn_delta-1.so.1\r\nlibfontconfig.so.1\t   libsvn_delta-1.so.1.0.0\r\nlibfontconfig.so.1.12.0    libsvn_diff-1.so.1\r\nlibform.so.6\t\t   libsvn_diff-1.so.1.0.0\r\nlibform.so.6.2\t\t   libsvn_fs-1.so.1\r\nlibformw.so.6\t\t   libsvn_fs-1.so.1.0.0\r\nlibformw.so.6.2\t\t   libsvn_fs_base-1.so.1\r\nlibfreetype.so.6\t   libsvn_fs_base-1.so.1.0.0\r\nlibfreetype.so.6.17.1\t   libsvn_fs_fs-1.so.1\r\nlibg.a\t\t\t   libsvn_fs_fs-1.so.1.0.0\r\nlibgcc_s.so.1\t\t   libsvn_fs_util-1.so.1\r\nlibgcrypt.so.20\t\t   libsvn_fs_util-1.so.1.0.0\r\nlibgcrypt.so.20.2.5\t   libsvn_fs_x-1.so.1\r\nlibgdbm.so.6\t\t   libsvn_fs_x-1.so.1.0.0\r\nlibgdbm.so.6.0.0\t   libsvn_ra-1.so.1\r\nlibgdbm_compat.so.4\t   libsvn_ra-1.so.1.0.0\r\nlibgdbm_compat.so.4.0.0    libsvn_ra_local-1.so.1\r\nlibgmp.so.10\t\t   libsvn_ra_local-1.so.1.0.0\r\nlibgmp.so.10.4.0\t   libsvn_ra_serf-1.so.1\r\nlibgnutls.so.30\t\t   libsvn_ra_serf-1.so.1.0.0\r\nlibgnutls.so.30.27.0\t   libsvn_ra_svn-1.so.1\r\nlibgomp.so.1\t\t   libsvn_ra_svn-1.so.1.0.0\r\nlibgomp.so.1.0.0\t   libsvn_repos-1.so.1\r\nlibgpg-error.so.0\t   libsvn_repos-1.so.1.0.0\r\nlibgpg-error.so.0.28.0\t   libsvn_subr-1.so.1\r\nlibgssapi.so.3\t\t   libsvn_subr-1.so.1.0.0\r\nlibgssapi.so.3.0.0\t   libsvn_wc-1.so.1\r\nlibgssapi_krb5.so.2\t   libsvn_wc-1.so.1.0.0\r\nlibgssapi_krb5.so.2.2\t   libsystemd.so.0\r\nlibhcrypto.so.4\t\t   libsystemd.so.0.28.0\r\nlibhcrypto.so.4.1.0\t   libtasn1.so.6\r\nlibheimbase.so.1\t   libtasn1.so.6.6.0\r\nlibheimbase.so.1.0.0\t   libthread_db-1.0.so\r\nlibheimntlm.so.0\t   libthread_db.so\r\nlibheimntlm.so.0.1.0\t   libthread_db.so.1\r\nlibhistory.so.8\t\t   libtic.so.6\r\nlibhistory.so.8.0\t   libtic.so.6.2\r\nlibhogweed.so.5\t\t   libtinfo.so.6\r\nlibhogweed.so.5.0\t   libtinfo.so.6.2\r\nlibhx509.so.5\t\t   libtsan.so.0\r\nlibhx509.so.5.0.0\t   libtsan.so.0.0.0\r\nlibidn2.so.0\t\t   libubsan.so.1\r\nlibidn2.so.0.3.6\t   libubsan.so.1.0.0\r\nlibisl.so.22\t\t   libudev.so.1\r\nlibisl.so.22.0.1\t   libudev.so.1.6.17\r\nlibitm.so.1\t\t   libunistring.so.2\r\nlibitm.so.1.0.0\t\t   libunistring.so.2.1.0\r\nlibjq.so.1\t\t   libutf8proc.so.2\r\nlibjq.so.1.0.4\t\t   libutf8proc.so.2.3.2\r\nlibk5crypto.so.3\t   libutil-2.31.so\r\nlibk5crypto.so.3.1\t   libutil.a\r\nlibkeyutils.so.1\t   libutil.so\r\nlibkeyutils.so.1.8\t   libutil.so.1\r\nlibkrb5.so.26\t\t   libuuid.so.1\r\nlibkrb5.so.26.0.0\t   libuuid.so.1.3.0\r\nlibkrb5.so.3\t\t   libwind.so.0\r\nlibkrb5.so.3.3\t\t   libwind.so.0.0.0\r\nlibkrb5support.so.0\t   libxcb.so.1\r\nlibkrb5support.so.0.1\t   libxcb.so.1.1.0\r\nlibksba.so.8\t\t   libz.so.1\r\nlibksba.so.8.11.6\t   libz.so.1.2.11\r\nliblber-2.4.so.2\t   libzstd.so.1\r\nliblber-2.4.so.2.10.12\t   libzstd.so.1.4.4\r\nlibldap-2.4.so.2\t   perl\r\nlibldap_r-2.4.so.2\t   perl-base\r\nlibldap_r-2.4.so.2.10.12   perl5\r\nliblsan.so.0\t\t   pkgconfig\r\nliblsan.so.0.0.0\t   rcrt1.o\r\nliblz4.so.1\t\t   sasl2\r\nliblz4.so.1.9.2\t\t   security\r\nliblzma.so.5\r\n+ cp /usr/lib/x86_64-linux-gnu/libXext.so.6 /usr/lib/x86_64-linux-gnu/libXext.so.6.4.0 /usr/lib/x86_64-linux-gnu/libX11.so.6 /usr/lib/x86_64-linux-gnu/libX11.so.6.3.0 /usr/lib/x86_64-linux-gnu/libXrender.so.1 /usr/lib/x86_64-linux-gnu/libXrender.so.1.3.0 /usr/lib/x86_64-linux-gnu/libXtst.so.6 /usr/lib/x86_64-linux-gnu/libXtst.so.6.1.0 /usr/lib/x86_64-linux-gnu/libXi.so.6 /usr/lib/x86_64-linux-gnu/libXi.so.6.1.0 /usr/lib/x86_64-linux-gnu/libxcb.so.1 /usr/lib/x86_64-linux-gnu/libxcb.so.1.1.0 /usr/lib/x86_64-linux-gnu/libXau.so.6 /usr/lib/x86_64-linux-gnu/libXau.so.6.0.0 /usr/lib/x86_64-linux-gnu/libXdmcp.so.6 /usr/lib/x86_64-linux-gnu/libXdmcp.so.6.0.0 /out/\r\n+ echo Main Java\r\nMain Java\r\n+ /usr/lib/jvm/java-17-openjdk-amd64/bin/java -version\r\nopenjdk version \"17.0.2\" 2022-01-18\r\nOpenJDK Runtime Environment (build 17.0.2+8-86)\r\nOpenJDK 64-Bit Server VM (build 17.0.2+8-86, mixed mode, sharing)\r\n+ echo Java 8\r\nJava 8\r\n+ /src/jdk8u432-b06/bin/java -version\r\nopenjdk version \"1.8.0_432\"\r\nOpenJDK Runtime Environment (Temurin)(build 1.8.0_432-b06)\r\nOpenJDK 64-Bit Server VM (Temurin)(build 25.432-b06, mixed mode)\r\n+ echo Java 11\r\nJava 11\r\n+ /src/jdk-11.0.25+9/bin/java -version\r\nopenjdk version \"11.0.25\" 2024-10-15\r\nOpenJDK Runtime Environment Temurin-11.0.25+9 (build 11.0.25+9)\r\nOpenJDK 64-Bit Server VM Temurin-11.0.25+9 (build 11.0.25+9, mixed mode)\r\n+ pushd /tmp\r\n/tmp /src/poi\r\n+ /src/maven-3.6.3/apache-maven-3.6.3/bin/mvn install:install-file -Dfile=/usr/local/lib/jazzer_api_deploy.jar -DgroupId=com.code-intelligence -DartifactId=jazzer-api -Dversion=0.12.0 -Dpackaging=jar --no-transfer-progress -DskipTests\r\n[INFO] Scanning for projects...\r\n[INFO] \r\n[INFO] ------------------< org.apache.maven:standalone-pom >-------------------\r\n[INFO] Building Maven Stub Project (No POM) 1\r\n[INFO] --------------------------------[ pom ]---------------------------------\r\n[INFO] \r\n[INFO] --- maven-install-plugin:2.4:install-file (default-cli) @ standalone-pom ---\r\n[INFO] Installing /usr/local/lib/jazzer_api_deploy.jar to /work/mavencache/com/code-intelligence/jazzer-api/0.12.0/jazzer-api-0.12.0.jar\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] BUILD SUCCESS\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Total time:  0.170 s\r\n[INFO] Finished at: 2026-01-07T21:44:04Z\r\n[INFO] ------------------------------------------------------------------------\r\n+ popd\r\n/src/poi\r\n+ pushd /src/poi\r\n/src/poi /src/poi\r\n+ ./gradlew publishToMavenLocal -x javadoc -x test -Dfile.encoding=UTF-8 -Porg.gradle.java.installations.fromEnv=JAVA_HOME_8,JAVA_HOME_11 --console=plain\r\nDownloading https://services.gradle.org/distributions/gradle-8.14.2-bin.zip\r\n.............10%.............20%.............30%.............40%.............50%.............60%.............70%.............80%.............90%..............100%\r\n\r\nWelcome to Gradle 8.14.2!\r\n\r\nHere are the highlights of this release:\r\n - Java 24 support\r\n - GraalVM Native Image toolchain selection\r\n - Enhancements to test reporting\r\n - Build Authoring improvements\r\n\r\nFor more details see https://docs.gradle.org/8.14.2/release-notes.html\r\n\r\nStarting a Gradle Daemon (subsequent builds will be faster)\r\nConfiguration on demand is an incubating feature.\r\n\r\n> Configure project :\r\nTrying to override old definition of datatype junit\r\n\r\n> Task :poi-ooxml:cleanupBatik UP-TO-DATE\r\n> Task :poi-integration:compileJava NO-SOURCE\r\n> Task :poi-examples:processResources NO-SOURCE\r\n> Task :poi-integration:processResources NO-SOURCE\r\n> Task :poi-integration:classes UP-TO-DATE\r\n> Task :poi:generateVersionJava\r\n> Task :poi-excelant:processResources\r\n> Task :poi-scratchpad:processResources\r\n> Task :poi-ooxml:fixBatik\r\n> Task :poi-ooxml-full:copy_xsds\r\n> Task :poi-ooxml-lite:generateModuleInfo\r\n> Task :poi-ooxml:processResources\r\n> Task :poi-ooxml-lite:javadocJar SKIPPED\r\n> Task :poi-excelant:javadocJar\r\n> Task :poi-scratchpad:javadocJar\r\n> Task :poi-examples:javadocJar\r\n> Task :poi-excelant:sourcesJar\r\n> Task :poi-ooxml-lite:generatePomFileForPOIPublication\r\n> Task :poi-integration:jar\r\n> Task :poi-examples:sourcesJar\r\n> Task :poi-integration:javadocJar\r\n> Task :poi-integration:sourcesJar SKIPPED\r\n> Task :poi-integration:generateMetadataFileForPOIPublication SKIPPED\r\n> Task :poi-integration:generatePomFileForPOIPublication\r\n> Task :poi-integration:signPOIPublication SKIPPED\r\n> Task :poi-integration:publishPOIPublicationToMavenLocal SKIPPED\r\n> Task :poi-integration:publishToMavenLocal UP-TO-DATE\r\n> Task :poi-ooxml:javadocJar\r\n> Task :poi-scratchpad:sourcesJar\r\n> Task :poi-ooxml:sourcesJar\r\n> Task :poi-excelant:generatePomFileForPOIPublication\r\n\r\n> Task :poi-ooxml-full:generate_beans\r\nSchemaCompiler  Metadata LOAD:org/apache/xmlbeans/metadata GEN:org/apache/poi/schemas/ooxml\r\n2026-01-07T21:45:13.566231758Z Execution worker Thread 14 ERROR Log4j API could not find a logging provider.\r\nTime to build schema type system: 0.932 seconds\r\n\r\n> Task :poi:compileJava FAILED\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:309: error: invalid method declaration; return type required\r\n        public StringMatcher(String value, CmpOp operator) {\r\n               ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:472: error: class, interface, or enum expected\r\n    public ValueEval evaluate(int srcRowIndex, int srcColumnIndex, ValueEval arg0, ValueEval arg1) {\r\n           ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:475: error: class, interface, or enum expected\r\n        if(mp == null) {\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:478: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:480: error: class, interface, or enum expected\r\n        return new NumberEval(result);\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:481: error: class, interface, or enum expected\r\n    }\r\n    ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:489: error: class, interface, or enum expected\r\n        } else if (rangeArg instanceof ThreeDEval) {\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:491: error: class, interface, or enum expected\r\n        } else {\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:493: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:504: error: class, interface, or enum expected\r\n        if(evaluatedCriteriaArg instanceof NumberEval) {\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:506: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:509: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:513: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:516: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:519: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:522: error: class, interface, or enum expected\r\n    }\r\n    ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:531: error: class, interface, or enum expected\r\n        } catch (EvaluationException e) {\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:533: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:540: error: class, interface, or enum expected\r\n        CmpOp operator = CmpOp.getOperator(value);\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:541: error: class, interface, or enum expected\r\n        value = value.substring(operator.getLength());\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:543: error: class, interface, or enum expected\r\n        Boolean booleanVal = parseBoolean(value);\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:544: error: class, interface, or enum expected\r\n        if(booleanVal != null) {\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:546: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:549: error: class, interface, or enum expected\r\n        if(doubleVal != null) {\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:551: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:553: error: class, interface, or enum expected\r\n        if (ee != null) {\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:555: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:559: error: class, interface, or enum expected\r\n    }\r\n    ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:563: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:566: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:569: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:572: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:575: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:578: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:581: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:584: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:587: error: class, interface, or enum expected\r\n    }\r\n    ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:595: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:601: error: class, interface, or enum expected\r\n                }\r\n                ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:603: error: class, interface, or enum expected\r\n            case 'f':\r\n            ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:607: error: class, interface, or enum expected\r\n                }\r\n                ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:609: error: class, interface, or enum expected\r\n        }\r\n        ^\r\n/src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:611: error: class, interface, or enum expected\r\n    }\r\n    ^\r\n43 errors\r\n\r\n> Task :poi-scratchpad:generatePomFileForPOIPublication\r\n> Task :poi-examples:generatePomFileForPOIPublication\r\n> Task :poi-ooxml-lite-agent:compileJava\r\n\r\n> Task :poi-ooxml-full:generate_beans\r\nTime to generate code: 2.06 seconds\r\n\r\n> Task :poi-ooxml:generatePomFileForPOIPublication\r\n\r\n[Incubating] Problems report is available at: file:///src/poi/build/reports/problems/problems-report.html\r\n\r\nFAILURE: Build failed with an exception.\r\n\r\n* What went wrong:\r\nExecution failed for task ':poi:compileJava'.\r\n> Compilation failed; see the compiler output below.\r\n  /src/poi/poi/src/main/java/org/apache/poi/ss/formula/functions/Countif.java:309: error: invalid method declaration; return type required\r\n          public StringMatcher(String value, CmpOp operator) {\r\n                 ^\r\n  43 errors\r\n\r\n* Try:\r\n> Check your code and dependencies to fix the compilation error(s)\r\n> Run with --scan to get full insights.\r\n\r\nDeprecated Gradle features were used in this build, making it incompatible with Gradle 9.0.\r\n\r\nYou can use '--warning-mode all' to show the individual deprecation warnings and determine if they come from your own scripts or plugins.\r\n\r\nFor more on this, please refer to https://docs.gradle.org/8.14.2/userguide/command_line_interface.html#sec:command_line_warnings in the Gradle documentation.\r\n\r\nBUILD FAILED in 1m 13s\r\n27 actionable tasks: 26 executed, 1 up-to-date\r\nsubprocess command returned a non-zero exit status: 1\n",
  "stderr": "INFO:__main__:Running: docker build -t aixcc-afc/apache-poi:latest --file /home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/projects/apache-poi/Dockerfile /home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/projects/apache-poi.\n#0 building with \"default\" instance using docker driver\n\n#1 [internal] load build definition from Dockerfile\n#1 transferring dockerfile: 2.43kB done\n#1 DONE 0.0s\n\n#2 [internal] load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0\n#2 DONE 0.0s\n\n#3 [internal] load .dockerignore\n#3 transferring context: 2B done\n#3 DONE 0.0s\n\n#4 [ 1/14] FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0\n#4 DONE 0.0s\n\n#5 [internal] load build context\n#5 transferring context: 2.52kB done\n#5 DONE 0.0s\n\n#6 [10/14] RUN tar -xzvf apache-poi.tar.gz &&     mv apache-poi poi && rm apache-poi.tar.gz\n#6 CACHED\n\n#7 [ 7/14] COPY pkgs/OpenJDK11U-jdk_x64_linux_hotspot_11.0.25_9.tar.gz /src/\n#7 CACHED\n\n#8 [ 5/14] COPY pkgs/OpenJDK8U-jdk_x64_linux_hotspot_8u432b06.tar.gz /src/\n#8 CACHED\n\n#9 [ 3/14] COPY pkgs/maven.zip /src/\n#9 CACHED\n\n#10 [13/14] COPY src/ /src/src/\n#10 CACHED\n\n#11 [ 6/14] RUN tar xvf OpenJDK8U-jdk_x64_linux_hotspot_8u432b06.tar.gz &&   rm -rf OpenJDK8U-jdk_x64_linux_hotspot_8u432b06.tar.gz\n#11 CACHED\n\n#12 [ 8/14] RUN tar xvf OpenJDK11U-jdk_x64_linux_hotspot_11.0.25_9.tar.gz &&   rm -rf OpenJDK11U-jdk_x64_linux_hotspot_11.0.25_9.tar.gz\n#12 CACHED\n\n#13 [ 9/14] COPY pkgs/apache-poi.tar.gz /src/\n#13 CACHED\n\n#14 [ 2/14] WORKDIR /src\n#14 CACHED\n\n#15 [11/14] RUN apt-get update     && apt-get install -y      fontconfig=2.13.1-2ubuntu3     libfreetype6=2.10.1-2ubuntu0.4      libxext6=2:1.3.4-0ubuntu1      libx11-6=2:1.6.9-2ubuntu1.6     libxrender1=1:0.9.10-1      libxtst6=2:1.2.3-1     libxi6=2:1.7.10-0ubuntu1     libxcb1=1.14-2     libxau6=1:1.0.9-0ubuntu1     libxdmcp6=1:1.1.3-0ubuntu1 --no-install-recommends && apt-get clean autoclean && apt-get autoremove --yes && rm -rf /var/lib/apt && rm -rf var/lib/dpkg && rm -rf /var/lib/cache && rm -rf /var/lib/log\n#15 CACHED\n\n#16 [12/14] COPY pom.xml build.sh *.options /src/\n#16 CACHED\n\n#17 [ 4/14] RUN unzip maven.zip -d \"/src/maven-3.6.3\" && rm -rf maven.zip\n#17 CACHED\n\n#18 [14/14] WORKDIR /src/poi\n#18 CACHED\n\n#19 exporting to image\n#19 exporting layers done\n#19 writing image sha256:7d0b2bb0c0046bc41a3ffa654106f1024cf691668fa2e2711e826d7034b32419 done\n#19 naming to docker.io/aixcc-afc/apache-poi:latest done\n#19 DONE 0.0s\nINFO:__main__:Keeping existing build artifacts as-is (if any).\nINFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e ARCHITECTURE=x86_64 -e PROJECT_NAME=apache-poi -e HELPER=True -e FUZZING_LANGUAGE=jvm -e BASH_ENV=/work/bashrc0 -e MAVEN_OPTS=-Dmaven.repo.local=/work/mavencache -v /home/qqor/crete/.cache/official-afc-poi:/local-source-mount:ro -v /home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/apache-poi/:/out -v /home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/apache-poi:/work -t aixcc-afc/apache-poi:latest /bin/bash -c 'pushd $SRC && rm -rf /src/poi && cp -r /local-source-mount /src/poi && popd && compile'.\nERROR:__main__:Building fuzzers failed.\n"
}