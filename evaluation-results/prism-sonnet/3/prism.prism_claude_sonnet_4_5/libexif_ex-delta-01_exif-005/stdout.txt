[2;36m[01/10/26 05:38:10][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=345942;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=343469;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp789i5xuh[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/libexif_ex-delta-01_exif-005/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768023490.713101[0m                                                       [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/libexif_ex-delta-01_exif-[1;36m005.[0mtoml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-libexif[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Building Cached for CLEAN environment[1m)[0m           ]8;id=780289;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=802595;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/10/26 05:38:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Building Cached for CLEAN environment[1m)[0m Took     ]8;id=318245;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=380198;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m28.59[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=855825;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=179280;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running tests for Cached for CLEAN environment[1m)[0m ]8;id=641156;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=787910;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=103487;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=955304;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m28[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=961915;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=663036;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 05:38:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.93[0m seconds;               ]8;id=547316;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=379577;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=911801;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=851463;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=176711;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=404915;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=875193;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=90047;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=537889;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=565614;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 05:38:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.92[0m seconds;               ]8;id=230209;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=684141;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=681871;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=738239;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 05:38:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.88[0m seconds;               ]8;id=567195;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=436574;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 05:38:45][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=275666;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=278825;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer exif_from_data_fuzzer -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m [1m<[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m237056772[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2850[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x563a7a4bb738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x563a7a4bc25a[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2850[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x563a7a4bc260[0m[39m,[0m[1;36m0x563a7a4c7480[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x515000000785[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x563a7a3f8fc0[0m[39m bp [0m[1;36m0x7ffed78bf780[0m[39m sp [0m[1;36m0x7ffed78bf778[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x515000000785[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x563a7a3f8fbf[0m[39m in exif_get_sshort [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x563a7a3f8fbf[0m[39m in exif_get_short [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m104:10[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x563a7a3fb854[0m[39m in exif_mnote_data_apple_load [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m110:29[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x563a7a3deefe[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x563a7a3de36e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x563a7a3db8af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x563a7a290330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x563a7a27b5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x563a7a28103f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x563a7a2ac2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f494d576082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x563a7a27378d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8078d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: exif_get_sshort--exif_get_short--exif_mnote_data_apple_load[0m            [2m                [0m
[2;36m                    [0m         [1;36m0x515000000785[0m[39m is located [0m[1;36m5[0m[39m bytes after [0m[1;36m512[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x515000000580[0m[39m,[0m[1;36m0x515000000780[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x563a7a39c0ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x563a7a4188f3[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x563a7a27b5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x563a7a28103f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x563a7a2ac2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7f494d576082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39min exif_get_sshort[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000580[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000600[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000680[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000700[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x515000000780[0m[39m:[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000800[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000880[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000900[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000980[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000a00[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp6rse5man[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m < [0m    [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m237056772[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2850[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x563a7a4bb738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x563a7a4bc25a[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2850[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x563a7a4bc260[0m[39m,[0m[1;36m0x563a7a4c7480[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x515000000785[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x563a7a3f8fc0[0m[39m bp [0m[1;36m0x7ffed78bf780[0m[39m sp [0m[1;36m0x7ffed78bf778[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x515000000785[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x563a7a3f8fbf[0m[39m in exif_get_sshort [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x563a7a3f8fbf[0m[39m in exif_get_short [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m104:10[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x563a7a3fb854[0m[39m in exif_mnote_data_apple_load [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m110:29[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x563a7a3deefe[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x563a7a3de36e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x563a7a3db8af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x563a7a290330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x563a7a27b5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x563a7a28103f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x563a7a2ac2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f494d576082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x563a7a27378d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8078d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: exif_get_sshort--exif_get_short--exif_mnote_data_apple_load[0m            [2m                [0m
[2;36m                    [0m         [1;36m0x515000000785[0m[39m is located [0m[1;36m5[0m[39m bytes after [0m[1;36m512[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x515000000580[0m[39m,[0m[1;36m0x515000000780[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x563a7a39c0ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x563a7a4188f3[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x563a7a27b5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x563a7a28103f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x563a7a2ac2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7f494d576082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39min exif_get_sshort[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000580[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000600[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000680[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000700[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x515000000780[0m:[1m[[0mfa[1m][0mfa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x515000000800[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x515000000880[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x515000000900[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x515000000980[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x515000000a00[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m14[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp6rse5man[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         exif_from_data_fuzzer -[33mruns[0m=[1;36m100[0m.                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 05:39:05][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=63963;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=591491;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 05:43:20][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=952628;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=793132;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 05:44:26][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=376259;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=378689;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=811048;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=71207;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 05:44:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.95[0m seconds;               ]8;id=950745;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=701507;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Patching[1m)[0m Started[33m...[0m                             ]8;id=645942;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=278101;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpo9detb10[0m                                                 ]8;id=668683;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=221504;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 05:44:52][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Patching[1m)[0m Took [1;36m25.16[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=540676;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=737237;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Checking build[1m)[0m Started[33m...[0m                       ]8;id=784781;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=371596;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 05:44:56][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Checking build[1m)[0m Took [1;36m3.72[0m seconds;              ]8;id=602901;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=837795;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running PoV[1m)[0m Started[33m...[0m                          ]8;id=809431;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=488165;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 05:44:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Running PoV[1m)[0m Took [1;36m1.88[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=211167;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=231681;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Testing[1m)[0m Started[33m...[0m                              ]8;id=947008;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=299492;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=968397;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=685982;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=168933;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=633204;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 05:44:59][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.88[0m seconds;               ]8;id=395603;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=777393;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=660108;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=216096;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 05:45:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.85[0m seconds;               ]8;id=630384;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=765500;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Started[33m...[0m                        ]8;id=495495;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=57465;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 05:45:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibexif Setting owner[1m)[0m Took [1;36m0.94[0m seconds;               ]8;id=659334;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=36227;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 05:45:02][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=367290;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=481137;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/libexif/apple/exif-mnote-data-apple.c                                         [2m                [0m
[2;36m                    [0m         +++ b/libexif/apple/exif-mnote-data-apple.c                                         [2m                [0m
[2;36m                    [0m         @@ [1;36m-28[0m,[1;36m6[0m +[1;36m28[0m,[1;36m8[0m @@                                                                   [2m                [0m
[2;36m                    [0m          #include [1m<[0m[1;95mlibexif[0m[39m/exif-data.h>[0m                                                     [2m                [0m
[2;36m                    [0m         [39m #include <libexif/exif-utils.h>[0m                                                    [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m       [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m static void[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m [0m[1;35mexif_mnote_data_apple_free[0m[1;39m([0m[39mExifMnoteData *md[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m     ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                             [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-56[0m[39m,[0m[1;36m9[0m[39m +[0m[1;36m58[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m static void[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m [0m[1;35mexif_mnote_data_apple_load[0m[1;39m([0m[39mExifMnoteData *md, const unsigned char *buf, unsigned [0m  [2m                [0m
[2;36m                    [0m         [39mint buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m     ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                             [2m                [0m
[2;36m                    [0m         [39m-    unsigned int tcount, i;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m+    unsigned int c, tcount, i;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     unsigned int dsize;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     unsigned int ofs, dofs;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m+    size_t o;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-70[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m73[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [39m     ofs = d->offset + [0m[1;36m6[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mofs, buf_size, [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                              [2m                [0m
[2;36m                    [0m         [39m+                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote header"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m+        return;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [39m         d->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                                       [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-82[0m[39m,[0m[1;36m55[0m[39m +[0m[1;36m91[0m[39m,[0m[1;36m96[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m         return;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    tcount = [0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mofs + [0m[1;36m14[0m[39m, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                              [2m                [0m
[2;36m                    [0m         [39m+                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote for tag count"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [39m+        return;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    c = [0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing too much memory [0m  [2m                [0m
[2;36m                    [0m         [39mor time *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mc > [0m[1;36m100[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                              [2m                [0m
[2;36m                    [0m         [39m+                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Too many tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Apple MakerNote"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39mc[0m[1;39m)[0m[39m;[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m+        return;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[39m* Sanity check the offset *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[39m + tcount * [0m[1;36m6[0m[39m + [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                              [2m                [0m
[2;36m                    [0m         [39m-                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mofs + [0m[1;36m16[0m[39m, buf_size, [0m[1;36m12[0m[39m * c[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                              [2m                [0m
[2;36m                    [0m         [39m+                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote for entries"[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m+        return;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[39m* [0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m: total %d tags\n"[0m[39m, __FUNCTION__, __LINE__, c[0m[1;39m)[0m[39m; *[0m[35m/[0m            [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    ofs += [0m[1;36m16[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mexif_mnote_data_apple_free[0m[1;39m([0m[39mmd[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [39m+    d->entries = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39m!d->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m * [0m   [2m                [0m
[2;36m                    [0m         [39mc[0m[1;39m)[0m[39m;[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [39m         return;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    [0m[35m/[0m[39m* [0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m: total %d tags\n"[0m[39m, __FUNCTION__, __LINE__, tcount[0m[1;39m)[0m[39m; *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    ofs += [0m[1;36m16[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mexif_mnote_data_apple_free[0m[1;39m([0m[39mmd[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [39m-    d->entries = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m * tcount[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39m!d->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m * [0m   [2m                [0m
[2;36m                    [0m         [39mtcount[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m-        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [39m-        return;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < tcount; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m-        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs, d->order[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m2[0m[39m, d->order[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [39m-        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components = [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m4[0m[39m, d->order[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m-        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order = d->order;[0m                                            [2m                [0m
[2;36m                    [0m         [39m-        dsize = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m                      [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+    tcount = [0m[1;36m0[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+    for [0m[1;39m([0m[39mi = c, o = ofs; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mmemset[0m[1;39m([0m[39m&d->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                          [2m                [0m
[2;36m                    [0m         [39m+                     [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote entry"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m+            break;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+        d->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + o, d->order[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m+        d->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, d->order[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m+        d->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, d->order[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m+        d->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order = d->order;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[39m* Check if we overflow the multiplication. Use buf_size as the max size [0m  [2m                [0m
[2;36m                    [0m         [39mfor integer overflow detection,[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+         * we will check the buffer sizes closer later. *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m                     [2m                [0m
[2;36m                    [0m         [39m+            buf_size [0m[35m/[0m[39m [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m < [0m          [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                          [2m                [0m
[2;36m                    [0m         [39m+                     [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Tag size overflow detected [0m[32m([0m[32m%u * [0m      [2m                [0m
[2;36m                    [0m         [32m%lu[0m[32m)[0m[32m"[0m[39m,[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+                     [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m,[0m              [2m                [0m
[2;36m                    [0m         [39m+                     d->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m+            continue;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+        dsize = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m                 [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+        d->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.size = dsize;[0m                                           [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [39m-            dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m+            dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + o + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m-            dofs = ofs + [0m[1;36m8[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-       [0m[39mif [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [39m-       [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [39m-                                  [0m[32m"ExifMnoteApplet"[0m[39m, [0m[32m"Tag size overflow detected [0m  [2m                [0m
[2;36m                    [0m         [32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, buf_size[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m-       [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m-       [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        ofs += [0m[1;36m12[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m-        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, dsize[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m-        if [0m[1;39m([0m[39m!d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+            dofs = o + [0m[1;36m8[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdofs, buf_size, dsize[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_DEBUG,[0m                                 [2m                [0m
[2;36m                    [0m         [39m+                     [0m[32m"ExifMnoteDataApple"[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [39m+                     [0m[32m"Tag data past end of buffer [0m[32m([0m[32m%u + %u > %u[0m[32m)[0m[32m"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [39m+                     dofs, dsize, buf_size[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+            continue;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+        d->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, dsize[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39m!d->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, dsize[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m             continue;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmemcpy[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, buf + dofs, dsize[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m-        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size = dsize;[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mmemcpy[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data, buf + dofs, dsize[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[39m* Tag was successfully parsed *[0m[35m/[0m                                          [2m                [0m
[2;36m                    [0m         [39m+        ++tcount;[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+    [0m[35m/[0m[39m* Store the count of successfully parsed tags *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [39m     d->count = tcount;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     return;[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m < [0m    [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m237056772[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2850[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x563a7a4bb738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x563a7a4bc25a[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2850[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x563a7a4bc260[0m[39m,[0m[1;36m0x563a7a4c7480[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x515000000785[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x563a7a3f8fc0[0m[39m bp [0m[1;36m0x7ffed78bf780[0m[39m sp [0m[1;36m0x7ffed78bf778[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x515000000785[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x563a7a3f8fbf[0m[39m in exif_get_sshort [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x563a7a3f8fbf[0m[39m in exif_get_short [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m104:10[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x563a7a3fb854[0m[39m in exif_mnote_data_apple_load [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m110:29[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x563a7a3deefe[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x563a7a3de36e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x563a7a3db8af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x563a7a290330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x563a7a27b5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x563a7a28103f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x563a7a2ac2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f494d576082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x563a7a27378d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8078d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: exif_get_sshort--exif_get_short--exif_mnote_data_apple_load[0m            [2m                [0m
[2;36m                    [0m         [1;36m0x515000000785[0m[39m is located [0m[1;36m5[0m[39m bytes after [0m[1;36m512[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x515000000580[0m[39m,[0m[1;36m0x515000000780[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x563a7a39c0ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x563a7a4188f3[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x563a7a27b5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x563a7a28103f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x563a7a2ac2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7f494d576082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39min exif_get_sshort[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000580[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000600[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000680[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000700[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x515000000780[0m[39m:[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000800[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000880[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000900[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000980[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000a00[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp6rse5man[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow vulnerability has been detected in the libexif library [0m      [2m                [0m
[2;36m                    [0m         [39mduring fuzzing with AddressSanitizer. The issue occurs when processing EXIF data, [0m  [2m                [0m
[2;36m                    [0m         [39mspecifically during the parsing of Apple MakerNote data. The vulnerability involves[0m [2m                [0m
[2;36m                    [0m         [39ma [0m[1;36m1[0m[39m-byte read operation attempting to access memory [0m[1;36m5[0m[39m bytes beyond the allocated [0m   [2m                [0m
[2;36m                    [0m         [39mheap buffer boundary.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is a heap-buffer-overflow vulnerability, specifically a READ operation that [0m   [2m                [0m
[2;36m                    [0m         [39mattempts to access memory outside of allocated bounds. AddressSanitizer has [0m        [2m                [0m
[2;36m                    [0m         [39massigned this a SCARINESS score of [0m[1;36m12[0m[39m, categorizing it as a [0m                        [2m                [0m
[2;36m                    [0m         [32m"1-byte-read-heap-buffer-overflow."[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Details[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mThe vulnerability manifests with the following characteristics:[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Memory Access Violation:**[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- An attempt to read [0m[1;36m1[0m[39m byte at address `[0m[1;36m0x515000000785[0m[39m`[0m                             [2m                [0m
[2;36m                    [0m         [39m- This address is located [0m[1;36m5[0m[39m bytes after a [0m[1;36m512[0m[39m-byte region `[0m[1;39m[[0m[1;36m0x515000000580[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [1;36m0x515000000780[0m[1;39m)[0m[39m`[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- The accessed memory falls into a heap redzone area [0m[1;39m([0m[39mmarked as [0m[32m'fa'[0m[39m in the shadow [0m [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m[39m, indicating it is beyond the valid allocated region[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Call Stack Analysis:**[0m                                                            [2m                [0m
[2;36m                    [0m         [39mThe error originates from the following execution path:[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. `exif_get_sshort` in `[0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m` - The immediate [0m        [2m                [0m
[2;36m                    [0m         [39mlocation of the invalid read[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. `exif_get_short` in `[0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m104:10[0m[39m` - Calls [0m          [2m                [0m
[2;36m                    [0m         [39mexif_get_sshort[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `exif_mnote_data_apple_load` in [0m                                                 [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m110:29[0m[39m` - Processing Apple [0m     [2m                [0m
[2;36m                    [0m         [39mMakerNote data[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. `exif_data_load_data` in `[0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m[39m` - Loading [0m    [2m                [0m
[2;36m                    [0m         [39mEXIF data[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. `exif_data_new_from_data` in `[0m[35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m[39m` - Creating[0m [2m                [0m
[2;36m                    [0m         [39mnew EXIF data structure[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. `LLVMFuzzerTestOneInput` in `[0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m[39m` - Fuzzer entry[0m [2m                [0m
[2;36m                    [0m         [39mpoint[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Important Observations[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Buffer Allocation**: The [0m[1;36m512[0m[39m-byte buffer was allocated during the fuzzer's [0m    [2m                [0m
[2;36m                    [0m         [39mtest execution setup, indicating the input data being processed is within this size[0m [2m                [0m
[2;36m                    [0m         [39mrange.[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Boundary Validation Issue**: The code attempts to read data beyond the [0m        [2m                [0m
[2;36m                    [0m         [39mallocated buffer, suggesting insufficient bounds checking when parsing short [0m       [2m                [0m
[2;36m                    [0m         [39minteger values from the EXIF data stream.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Apple MakerNote Processing**: The vulnerability occurs specifically during [0m    [2m                [0m
[2;36m                    [0m         [39mApple MakerNote data processing, indicating this vendor-specific EXIF extension [0m    [2m                [0m
[2;36m                    [0m         [39mhandling may have inadequate validation.[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Function Chain**: The error propagates through utility functions [0m              [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`exif_get_sshort`[0m[35m/[0m[39m`exif_get_short`[0m[1;39m)[0m[39m that are likely used throughout the codebase [0m  [2m                [0m
[2;36m                    [0m         [39mfor reading binary data, suggesting this could be a systemic issue affecting [0m       [2m                [0m
[2;36m                    [0m         [39mmultiple code paths.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a holistic understanding of this vulnerability, the following code [0m       [2m                [0m
[2;36m                    [0m         [39mcomponents should be investigated:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **exif-utils.c**: [0m                                                               [2m                [0m
[2;36m                    [0m         [39m   - The `exif_get_sshort` and `exif_get_short` functions to understand how they [0m   [2m                [0m
[2;36m                    [0m         [39mread data from buffers[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - Verify if these functions perform bounds checking before reading data[0m          [2m                [0m
[2;36m                    [0m         [39m   - Check if they receive and validate buffer length parameters[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **exif-mnote-data-apple.c**:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - The `exif_mnote_data_apple_load` function at line [0m[1;36m110[0m                          [2m                [0m
[2;36m                    [0m         [39m   - How this function parses Apple MakerNote structures[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Whether it properly validates data lengths before passing pointers to utility [0m [2m                [0m
[2;36m                    [0m         [39mfunctions[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **exif-data.c**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - The `exif_data_load_data` function that initiates the parsing[0m                  [2m                [0m
[2;36m                    [0m         [39m   - How buffer boundaries are tracked and passed through the call chain[0m            [2m                [0m
[2;36m                    [0m         [39m   - The `exif_data_new_from_data` function to understand the initial data handling[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Data Structure Definitions**:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - EXIF data structures to understand how buffer lengths are stored and [0m          [2m                [0m
[2;36m                    [0m         [39mpropagated[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - Apple MakerNote format specifications and their implementation[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Other MakerNote Implementations**:[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - Similar vendor-specific MakerNote handling code to determine if this is an [0m    [2m                [0m
[2;36m                    [0m         [39misolated issue or a pattern across multiple vendors[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mexif_from_data_fuzzer[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer exif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                              [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m < [0m    [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m237056772[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m2850[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x563a7a4bb738[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x563a7a4bc25a[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m2850[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m2850[0m[39m [0m[1;39m[[0m[1;36m0x563a7a4bc260[0m[39m,[0m[1;36m0x563a7a4c7480[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mexif_from_data_fuzzer[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                      [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x515000000785[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x563a7a3f8fc0[0m[39m bp [0m[1;36m0x7ffed78bf780[0m[39m sp [0m[1;36m0x7ffed78bf778[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x515000000785[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x563a7a3f8fbf[0m[39m in exif_get_sshort [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x563a7a3f8fbf[0m[39m in exif_get_short [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m:[0m[1;92m104:10[0m    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x563a7a3fb854[0m[39m in exif_mnote_data_apple_load [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/apple/[0m[95mexif-mnote-data-apple.c[0m[39m:[0m[1;92m110:29[0m                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x563a7a3deefe[0m[39m in exif_data_load_data [0m                                       [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m1010:2[0m                                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x563a7a3de36e[0m[39m in exif_data_new_from_data [0m                                   [2m                [0m
[2;36m                    [0m         [35m/src/libexif/libexif/[0m[95mexif-data.c[0m[39m:[0m[1;92m159:2[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x563a7a3db8af[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/[0m[95mexif_from_data_fuzzer.cc[0m[39m:[0m[1;92m51:16[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x563a7a290330[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x563a7a27b5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x563a7a28103f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x563a7a2ac2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7f494d576082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x563a7a27378d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mexif_from_data_fuzzer+0x8078d[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: exif_get_sshort--exif_get_short--exif_mnote_data_apple_load[0m            [2m                [0m
[2;36m                    [0m         [1;36m0x515000000785[0m[39m is located [0m[1;36m5[0m[39m bytes after [0m[1;36m512[0m[39m-byte region [0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x515000000580[0m[39m,[0m[1;36m0x515000000780[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x563a7a39c0ff[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x563a7a4188f3[0m[39m in operator [0m[1;35mnew[0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m cxa_noexception.cpp[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x563a7a27b5a5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x563a7a28103f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x563a7a2ac2e2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x7f494d576082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--operator [0m[1;35mnew[0m[1;39m([0m[39munsigned [0m                           [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m--fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned long[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libexif/libexif/[0m[95mexif-utils.c[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39min exif_get_sshort[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000580[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000600[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000680[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000700[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x515000000780[0m[39m:[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000800[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000880[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000900[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000980[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x515000000a00[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m14[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp6rse5man[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mexif_from_data_fuzzer -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-utils.[0m[1;92mc:86[0m[39m-[0m[1;36m105[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m86:E[0m[39mxifSShort[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;92m87:e[0m[39mxif_get_sshort [0m[1;39m([0m[39mconst unsigned char *buf, ExifByteOrder order[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!buf[0m[1;39m)[0m[39m return [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        switch [0m[1;39m([0m[39morder[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        case EXIF_BYTE_ORDER_MOTOROLA:[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39mbuf[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | buf[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        case EXIF_BYTE_ORDER_INTEL:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39mbuf[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | buf[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[35m/[0m[39m* Won't be reached *[0m[35m/[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mreturn [0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m101:E[0m[39mxifShort[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;92m102:e[0m[39mxif_get_short [0m[1;39m([0m[39mconst unsigned char *buf, ExifByteOrder order[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[39mreturn [0m[1;39m([0m[39mexif_get_sshort [0m[1;39m([0m[39mbuf, order[0m[1;39m)[0m[39m & [0m[1;36m0xffff[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:56[0m[39m-[0m[1;36m137[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m57:e[0m[1;35mxif_mnote_data_apple_load[0m[1;39m([0m[39mExifMnoteData *md, const unsigned char *buf, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mint buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    unsigned int tcount, i;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    unsigned int dsize;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    unsigned int ofs, dofs;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    if [0m[1;39m([0m[39m!d || !buf || [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    ofs = d->offset + [0m[1;36m6[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        d->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        d->order = EXIF_BYTE_ORDER_INTEL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Unrecognized byte order"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    tcount = [0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[35m/[0m[39m* Sanity check the offset *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    if [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[39m + tcount * [0m[1;36m6[0m[39m + [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[35m/[0m[39m* [0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m: total %d tags\n"[0m[39m, __FUNCTION__, __LINE__, tcount[0m[1;39m)[0m[39m; *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    ofs += [0m[1;36m16[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[1;35mexif_mnote_data_apple_free[0m[1;39m([0m[39mmd[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    d->entries = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m * tcount[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    if [0m[1;39m([0m[39m!d->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m *[0m [2m                [0m
[2;36m                    [0m         [39mtcount[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < tcount; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs, d->order[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m2[0m[39m, d->order[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components = [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m4[0m[39m, d->order[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order = d->order;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        dsize = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m                   [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            dofs = ofs + [0m[1;36m8[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                                  [0m[32m"ExifMnoteApplet"[0m[39m, [0m[32m"Tag size overflow [0m        [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, buf_size[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        ofs += [0m[1;36m12[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, dsize[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        if [0m[1;39m([0m[39m!d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, dsize[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            continue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, buf + dofs, dsize[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size = dsize;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    d->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:203[0m[39m-[0m[1;36m260[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m204:e[0m[39mxif_mnote_data_canon_load [0m[1;39m([0m[39mExifMnoteData *ne,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39mExifMnoteDataCanon *n = [0m[1;39m([0m[39mExifMnoteDataCanon *[0m[1;39m)[0m[39m ne;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[39mExifShort c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39mlong failsafe_size = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, n->order[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing to much memory[0m [2m                [0m
[2;36m                    [0m         [39mor time. There are [0m[1;36m24[0m[39m named tags currently.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m * The format allows specifying the same range of memory as often as it [0m    [2m                [0m
[2;36m                    [0m         [39mcan, so this multiplies quickly. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39mif [0m[1;39m([0m[39mc > [0m[1;36m100[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifMnoteCanon"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [32m"Too much tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Canon MakerNote"[0m[39m, c[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[35m/[0m[39m* Remove any old entries *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[39mexif_mnote_data_canon_clear [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[39mn->entries = exif_mem_alloc [0m[1;39m([0m[39mne->mem, sizeof [0m[1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteCanon"[0m[39m, sizeof [0m               [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[35m/[0m[39m* Parse the entries *[0m[35m/[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo,buf_size,[0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:288[0m[39m-[0m[1;36m298[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:    [0m[39m        [0m[39m        [0m[39msize_t dataofs = o + [0m[1;36m8[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m[39m dataofs = exif_get_long [0m[1;39m([0m[39mbuf + dataofs, [0m         [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m + [0m[1;36m6[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdataofs, buf_size, s[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_DEBUG,[0m             [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[32m"ExifMnoteCanon"[0m[39m,[0m                           [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[32m"Tag data past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m,[0m    [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[1;39m([0m[39munsigned[0m[1;39m)[0m[1;39m([0m[39mdataofs + s[0m[1;39m)[0m[39m, buf_size[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:236[0m[39m-[0m[1;36m254[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m237:e[0m[39mxif_mnote_data_olympus_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[39m        [0m[39m        [0m[39m      const unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39mExifMnoteDataOlympus *n = [0m[1;39m([0m[39mExifMnoteDataOlympus *[0m[1;39m)[0m[39m en;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39mExifShort c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[39msize_t i, tcount, o, o2, datao = [0m[1;36m6[0m[39m, base = [0m[1;36m0[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39mo2 = [0m[1;36m6[0m[39m + n->offset; [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo2,buf_size,[0m[1;36m10[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:403[0m[39m-[0m[1;36m412[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:    [0m[35m/[0m[39m* Sanity check the offset *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo2,buf_size,[0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + o2, n->order[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:    [0m[39mo2 += [0m[1;36m2[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:433[0m[39m-[0m[1;36m444[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = o2; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteOlympusEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:    [0m[39m    n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m + [0m   [2m                [0m
[2;36m                    [0m         [39mbase;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:    [0m[39m    n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:    [0m[39m    n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, n->order[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:492[0m[39m-[0m[1;36m498[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdataofs, buf_size, s[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG,[0m             [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteOlympus"[0m[39m,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag data past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[1;39m([0m[39munsigned[0m[1;39m)[0m[1;39m([0m[39mdataofs + s[0m[1;39m)[0m[39m, buf_size[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:215[0m[39m-[0m[1;36m233[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m216:e[0m[39mxif_mnote_data_pentax_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39m        [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39mExifMnoteDataPentax *n = [0m[1;39m([0m[39mExifMnoteDataPentax *[0m[1;39m)[0m[39m en;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39msize_t i, tcount, o, datao, base = [0m[1;36m0[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39mExifShort c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataPentax"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m8[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataPentax"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:264[0m[39m-[0m[1;36m266[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, n->order[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:288[0m[39m-[0m[1;36m300[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnotePentaxEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo,buf_size,[0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataPentax"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m + base;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long  [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:329[0m[39m-[0m[1;36m334[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdataofs, buf_size, s[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG,[0m             [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataPentax"[0m[39m, [0m[32m"Tag data [0m [2m                [0m
[2;36m                    [0m         [32mpast end "[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m, [0m[1;39m([0m[39munsigned[0m[1;39m)[0m[1;39m([0m[39mdataofs[0m [2m                [0m
[2;36m                    [0m         [39m+ s[0m[1;39m)[0m[39m, buf_size[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:33[0m[39m-[0m[1;36m34[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:51[0m[39m-[0m[1;36m52[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:38[0m[39m-[0m[1;36m39[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:31[0m[39m-[0m[1;36m32[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:31[0m[39m-[0m[1;36m32[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-utils.[0m[1;92mc:129[0m[39m-[0m[1;36m142[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m129:E[0m[39mxifSLong[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;92m130:e[0m[39mxif_get_slong [0m[1;39m([0m[39mconst unsigned char *b, ExifByteOrder order[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!b[0m[1;39m)[0m[39m return [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        switch [0m[1;39m([0m[39morder[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        case EXIF_BYTE_ORDER_MOTOROLA:[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m << [0m[1;36m24[0m[1;39m)[0m[39m | [0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m16[0m[1;39m)[0m[39m | [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        case EXIF_BYTE_ORDER_INTEL:[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:                return [0m[1;39m([0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m24[0m[1;39m)[0m[39m | [0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m << [0m[1;36m16[0m[1;39m)[0m[39m | [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39mb[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[35m/[0m[39m* Won't be reached *[0m[35m/[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39mreturn [0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:153[0m[39m-[0m[1;36m180[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m154:e[0m[39mxif_mnote_data_fuji_load [0m[1;39m([0m[39mExifMnoteData *en,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39mExifMnoteDataFuji *n = [0m[1;39m([0m[39mExifMnoteDataFuji*[0m[1;39m)[0m[39m en;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mExifLong c;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    [0m[39mn->order = EXIF_BYTE_ORDER_INTEL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[39mdatao += exif_get_long [0m[1;39m([0m[39mbuf + datao + [0m[1;36m8[0m[39m, EXIF_BYTE_ORDER_INTEL[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:200[0m[39m-[0m[1;36m264[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:    [0m[35m/[0m[39m* Parse all c entries, storing ones that are successfully parsed *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteFujiEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteDataFuji"[0m[39m,[0m        [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"Loading entry 0x%x [0m[32m([0m[32m'%s'[0m[32m)[0m[32m..."[0m[39m, n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag,[0m   [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[39m        [0m[39m        [0m[39m  mnote_fuji_tag_get_name [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Check if we overflow the multiplication. Use buf_size as the max[0m [2m                [0m
[2;36m                    [0m         [39msize for integer overflow detection,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39m        [0m[39m * we will check the buffer sizes closer later. *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m    [0m[39mexif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m         [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf_size [0m[35m/[0m[39m exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m< n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m        [0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Tag size overflow [0m  [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u * %lu[0m[32m)[0m[32m"[0m[39m, exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m, [0m            [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[39m        [0m[35m/[0m[39m*[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[39m        [0m[39m * Size? If bigger than [0m[1;36m4[0m[39m bytes, the actual data is not[0m             [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[39m        [0m[39m * in the entry but somewhere else [0m[1;39m([0m[39moffset[0m[1;39m)[0m[39m.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[39m        [0m[39ms = exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m             [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.size = s;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39ms[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39m        [0m[39m        [0m[39msize_t dataofs = o + [0m[1;36m8[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[35m/[0m[39m* The data in this case is merely a pointer *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mdataofs = exif_get_long [0m[1;39m([0m[39mbuf + dataofs, n->order[0m[1;39m)[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m + n->offset;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdataofs, buf_size, s[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m      [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Tag data [0m   [2m                [0m
[2;36m                    [0m         [32mpast end of "[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"buffer [0m[32m([0m[32m%u >= %u[0m[32m)[0m[32m"[0m[39m, [0m[1;39m([0m[39munsigned[0m[1;39m)[0m[1;39m([0m[39mdataofs +[0m [2m                [0m
[2;36m                    [0m         [39ms[0m[1;39m)[0m[39m, buf_size[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data = exif_mem_alloc [0m[1;39m([0m[39men->mem, s[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m!n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39men->log, [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39ms[0m[1;39m)[0m[39m;[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[39m        [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data, buf + dataofs, s[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Tag was successfully parsed *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:    [0m[39m        [0m[39m++tcount;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[35m/[0m[39m* Store the count of successfully parsed tags *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:    [0m[39mn->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.h:[0m[1;36m1[0m[39m-[0m[1;36m44[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* mnote-apple-data.h[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Copyright [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;36m2018[0m[39m zhanwang-sky <zhanwang_sky@[0m[1;36m163.[0m[39mcom>[0m                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * This library is free software; you can redistribute it and/or[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * modify it under the terms of the GNU Lesser General Public[0m                     [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * License as published by the Free Software Foundation; either[0m                   [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * version [0m[1;36m2[0m[39m of the License, or [0m[1;39m([0m[39mat your option[0m[1;39m)[0m[39m any later version.[0m               [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This library is distributed in the hope that it will be useful,[0m               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * but WITHOUT ANY WARRANTY; without even the implied warranty of[0m                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * Lesser General Public License for more details.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * You should have received a copy of the GNU Lesser General Public[0m              [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * License along with this library; if not, write to the[0m                         [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * Free Software Foundation, Inc., [0m[1;36m51[0m[39m Franklin Street, Fifth Floor,[0m              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * Boston, MA  [0m[1;36m02110[0m[39m-[0m[1;36m1301[0m[39m  USA.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#ifndef __MNOTE_APPLE_CONTENT_H__[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#define __MNOTE_APPLE_CONTENT_H__[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include <libexif/exif-byte-order.h>[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include <libexif/exif-data.h>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include <libexif/exif-mem.h>[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include <libexif/exif-mnote-data-priv.h>[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include <libexif/apple/mnote-apple-entry.h>[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:typedef struct _ExifMnoteDataApple ExifMnoteDataApple;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:struct _ExifMnoteDataApple [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    ExifMnoteData parent;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    ExifByteOrder order;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    unsigned int offset;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    MnoteAppleEntry *entries;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    unsigned int count;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:int [0m[1;35mexif_mnote_data_apple_identify[0m[1;39m([0m[39mconst ExifData *, const ExifEntry *[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m42:E[0m[39mxifMnoteData *[0m[1;35mexif_mnote_data_apple_new[0m[1;39m([0m[39mExifMem *[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:#endif [0m[35m/[0m[39m* __MNOTE_APPLE_CONTENT_H__ *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:791[0m[39m-[0m[1;36m837[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:[0m[1;35minterpret_maker_note[0m[1;39m([0m[39mExifData *data, const unsigned char *d, unsigned int ds[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:    [0m[39mint mnoteid;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:    [0m[39mExifEntry* e = exif_data_get_entry [0m[1;39m([0m[39mdata, EXIF_TAG_MAKER_NOTE[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!e[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_olympus_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Olympus MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_olympus_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_canon_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Canon MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_canon_new [0m[1;39m([0m[39mdata->priv->mem, [0m       [2m                [0m
[2;36m                    [0m         [39mdata->priv->options[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_fuji_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Fuji MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_fuji_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:    [0m[35m/[0m[39m* NOTE: Must do Pentax detection last because some of the[0m                  [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:    [0m[39m * heuristics are pretty general. *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_pentax_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Pentax MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_pentax_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mmnoteid = exif_mnote_data_apple_identify [0m[1;39m([0m[39mdata, e[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:    [0m[39m        [0m[39m        [0m[32m"ExifData"[0m[39m, [0m[32m"Apple MakerNote variant type %d"[0m[39m, mnoteid[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[39m        [0m[39mdata->priv->md = exif_mnote_data_apple_new [0m[1;39m([0m[39mdata->priv->mem[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    [0m[35m/[0m[39m* [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[39m * If we are able to interpret the maker note, do so.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdata->priv->md[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_log [0m[1;39m([0m[39mdata->priv->md, data->priv->log[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_set_byte_order [0m[1;39m([0m[39mdata->priv->md,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39mdata->priv->order[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_set_offset [0m[1;39m([0m[39mdata->priv->md,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m    data->priv->offset_mnote[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:    [0m[39m        [0m[39mexif_mnote_data_load [0m[1;39m([0m[39mdata->priv->md, d, ds[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m837[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/mnote-apple-entry.h:[0m[1;36m1[0m[39m-[0m[1;36m41[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* mnote-apple-entry.h[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Copyright [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;36m2018[0m[39m zhanwang-sky <zhanwang_sky@[0m[1;36m163.[0m[39mcom>[0m                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * This library is free software; you can redistribute it and/or[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * modify it under the terms of the GNU Lesser General Public[0m                     [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * License as published by the Free Software Foundation; either[0m                   [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * version [0m[1;36m2[0m[39m of the License, or [0m[1;39m([0m[39mat your option[0m[1;39m)[0m[39m any later version.[0m               [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This library is distributed in the hope that it will be useful,[0m               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * but WITHOUT ANY WARRANTY; without even the implied warranty of[0m                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * Lesser General Public License for more details.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * You should have received a copy of the GNU Lesser General Public[0m              [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * License along with this library; if not, write to the[0m                         [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * Free Software Foundation, Inc., [0m[1;36m51[0m[39m Franklin Street, Fifth Floor,[0m              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * Boston, MA  [0m[1;36m02110[0m[39m-[0m[1;36m1301[0m[39m  USA.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#ifndef __MNOTE_APPLE_ENTRY_H__[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#define __MNOTE_APPLE_ENTRY_H__[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include <libexif/exif-byte-order.h>[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include <libexif/exif-format.h>[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include <libexif/apple/mnote-apple-tag.h>[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:typedef struct _MnoteAppleEntry MnoteAppleEntry;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:struct _MnoteAppleEntry [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    MnoteAppleTag tag;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    ExifFormat format;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    unsigned long components;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    unsigned char *data;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    unsigned int size;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    ExifByteOrder order;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m39:c[0m[39mhar *[0m[1;35mmnote_apple_entry_get_value[0m[1;39m([0m[39mMnoteAppleEntry *, char *, unsigned int[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#endif [0m[35m/[0m[39m* __MNOTE_APPLE_ENTRY_H__ *[0m[35m/[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:108[0m[39m-[0m[1;36m137[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < tcount; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs, d->order[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m2[0m[39m, d->order[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components = [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m4[0m[39m, d->order[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order = d->order;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        dsize = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m                   [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            dofs = ofs + [0m[1;36m8[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                                  [0m[32m"ExifMnoteApplet"[0m[39m, [0m[32m"Tag size overflow [0m        [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, buf_size[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        ofs += [0m[1;36m12[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, dsize[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        if [0m[1;39m([0m[39m!d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, dsize[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            continue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, buf + dofs, dsize[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size = dsize;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    d->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:390[0m[39m-[0m[1;36m441[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m391:e[0m[39mxif_data_load_data_content [0m[1;39m([0m[39mExifData *data, ExifIfd ifd,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[39m        [0m[39m        [0m[39m     const unsigned char *d,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    [0m[39m        [0m[39m        [0m[39m     unsigned int ds, unsigned int offset, unsigned int [0m    [2m                [0m
[2;36m                    [0m         [39mrecursion_cost[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:    [0m[39mExifLong o, thumbnail_offset = [0m[1;36m0[0m[39m, thumbnail_length = [0m[1;36m0[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:    [0m[39mExifShort n;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:    [0m[39mExifEntry *entry;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:    [0m[39munsigned int i;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:    [0m[39mExifTag tag;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data || !data->priv[0m[1;39m)[0m[39m [0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:    [0m[35m/[0m[39m* check for valid ExifIfd enum range *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[1;39m([0m[1;39m([0m[39mint[0m[1;39m)[0m[39mifd[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;39m([0m[39m [0m[1;39m([0m[1;39m([0m[39mint[0m[1;39m)[0m[39mifd[0m[1;39m)[0m[39m >= EXIF_IFD_COUNT[0m[1;39m)[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:    [0m[39m  return;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[39mif [0m[1;39m([0m[39mrecursion_cost > [0m[1;36m170[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:    [0m[39m        [0m[35m/[0m[39m*[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:    [0m[39m        [0m[39m * recursion_cost is a logarithmic-scale indicator of how expensive[0m [2m                [0m
[2;36m                    [0m         [39mthis[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:    [0m[39m        [0m[39m * recursive call might end up being. It is an indicator of the [0m    [2m                [0m
[2;36m                    [0m         [39mdepth of[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:    [0m[39m        [0m[39m * recursion as well as the potential for worst-case future [0m        [2m                [0m
[2;36m                    [0m         [39mrecursive[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:    [0m[39m        [0m[39m * calls. Since it's difficult to tell ahead of time how often [0m     [2m                [0m
[2;36m                    [0m         [39mrecursion[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:    [0m[39m        [0m[39m * will occur, this assumes the worst by assuming every tag could [0m  [2m                [0m
[2;36m                    [0m         [39mend up[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:    [0m[39m        [0m[39m * causing recursion.[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:    [0m[39m        [0m[39m * The value of [0m[1;36m170[0m[39m was chosen to limit typical EXIF structures to [0m [2m                [0m
[2;36m                    [0m         [39ma[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:    [0m[39m        [0m[39m * recursive depth of about [0m[1;36m6[0m[39m, but pathological ones [0m[1;39m([0m[39mthose with [0m   [2m                [0m
[2;36m                    [0m         [39mvery[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:    [0m[39m        [0m[39m * many tags[0m[1;39m)[0m[39m to only [0m[1;36m2[0m[39m.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:    [0m[39m        [0m[39m *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifData"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"Deep/expensive recursion detected!"[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:    [0m[35m/[0m[39m* Read the number of entries *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset, ds, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifData"[0m[39m,[0m  [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"Tag data past end of buffer [0m[32m([0m[32m%u+2 > %u[0m[32m)[0m[32m"[0m[39m, offset, ds[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:    [0m[39mn = exif_get_short [0m[1;39m([0m[39md + offset, data->priv->order[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:    [0m[39m          [0m[32m"Loading %hu entries..."[0m[39m, n[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:    [0m[39moffset += [0m[1;36m2[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:    [0m[35m/[0m[39m* Check if we have enough data. *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset, ds, [0m[1;36m12[0m[39m*n[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:    [0m[39m        [0m[39mn = [0m[1;39m([0m[39mds - offset[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;36m12[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"Short data; only loading %hu entries..."[0m[39m, n[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-data.[0m[1;92mc:950[0m[39m-[0m[1;36m1015[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m950[0m[39m:    [0m[35m/[0m[39m* The JPEG APP1 section can be no longer than [0m[1;36m64[0m[39m KiB [0m[1;39m([0m[39mincluding a[0m          [2m                [0m
[2;36m                    [0m         [1;36m951[0m[39m:    [0m[39m   [0m[1;36m16[0m[39m-bit length[0m[1;39m)[0m[39m, so cap the data length to protect against overflow[0m       [2m                [0m
[2;36m                    [0m         [1;36m952[0m[39m:    [0m[39m   in future offset calculations *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m953[0m[39m:    [0m[39mfullds = ds;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m954[0m[39m:    [0m[39mif [0m[1;39m([0m[39mds > [0m[1;36m0xfffe[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m955[0m[39m:    [0m[39m        [0m[39mds = [0m[1;36m0xfffe[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m956[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m957[0m[39m:    [0m[35m/[0m[39m* Byte order [0m[1;39m([0m[39moffset [0m[1;36m6[0m[39m, length [0m[1;36m2[0m[1;39m)[0m[39m *[0m[35m/[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m958[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!memcmp [0m[1;39m([0m[39md + [0m[1;36m6[0m[39m, [0m[32m"II"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m959[0m[39m:    [0m[39m        [0m[39mdata->priv->order = EXIF_BYTE_ORDER_INTEL;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m960[0m[39m:    [0m[39melse if [0m[1;39m([0m[39m!memcmp [0m[1;39m([0m[39md + [0m[1;36m6[0m[39m, [0m[32m"MM"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m961[0m[39m:    [0m[39m        [0m[39mdata->priv->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m962[0m[39m:    [0m[39melse [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m963[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m964[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifData"[0m[39m, [0m[1;35m_[0m[1;39m([0m[32m"Unknown encoding."[0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m965[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m966[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m967[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m968[0m[39m:    [0m[35m/[0m[39m* Fixed value *[0m[35m/[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m969[0m[39m:    [0m[39mif [0m[1;39m([0m[39mexif_get_short [0m[1;39m([0m[39md + [0m[1;36m8[0m[39m, data->priv->order[0m[1;39m)[0m[39m != [0m[1;36m0x002a[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m970[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m971[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m972[0m[39m:    [0m[35m/[0m[39m* IFD [0m[1;36m0[0m[39m offset *[0m[35m/[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m973[0m[39m:    [0m[39moffset = exif_get_long [0m[1;39m([0m[39md + [0m[1;36m10[0m[39m, data->priv->order[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:    [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m, [0m                [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:    [0m[39m        [0m[39m  [0m[32m"IFD 0 at %i."[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m offset[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:    [0m[35m/[0m[39m* ds is restricted to [0m[1;36m16[0m[39m bit above, so offset is restricted too, and [0m      [2m                [0m
[2;36m                    [0m         [39moffset+[0m[1;36m8[0m[39m should not overflow. *[0m[35m/[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:    [0m[39mif [0m[1;39m([0m[39moffset > ds || offset + [0m[1;36m6[0m[39m + [0m[1;36m2[0m[39m > ds[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:    [0m[35m/[0m[39m* Parse the actual exif data [0m[1;39m([0m[39musually offset [0m[1;36m14[0m[39m from start[0m[1;39m)[0m[39m *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:    [0m[39mexif_data_load_data_content [0m[1;39m([0m[39mdata, EXIF_IFD_0, d + [0m[1;36m6[0m[39m, ds - [0m[1;36m6[0m[39m, offset, [0m[1;36m0[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:    [0m[35m/[0m[39m* IFD [0m[1;36m1[0m[39m offset *[0m[35m/[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m985[0m[39m:    [0m[39mn = exif_get_short [0m[1;39m([0m[39md + [0m[1;36m6[0m[39m + offset, data->priv->order[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m986[0m[39m:    [0m[35m/[0m[39m* offset < [0m[1;36m2[0m[39m<<[0m[1;36m16[0m[39m, n is [0m[1;36m16[0m[39m bit at most, so this op will not overflow *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m987[0m[39m:    [0m[39mif [0m[1;39m([0m[39moffset + [0m[1;36m6[0m[39m + [0m[1;36m2[0m[39m + [0m[1;36m12[0m[39m * n + [0m[1;36m4[0m[39m > ds[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m988[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m989[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m990[0m[39m:    [0m[39moffset = exif_get_long [0m[1;39m([0m[39md + [0m[1;36m6[0m[39m + offset + [0m[1;36m2[0m[39m + [0m[1;36m12[0m[39m * n, data->priv->order[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m991[0m[39m:    [0m[39mif [0m[1;39m([0m[39moffset[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m992[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifData"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [1;36m993[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"IFD 1 at %i."[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m offset[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m994[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m995[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Sanity check. ds is ensured to be above [0m[1;36m6[0m[39m above, offset is 16bit[0m [2m                [0m
[2;36m                    [0m         [39m*[0m[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m996[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39moffset > ds - [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m997[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mdata->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m      [2m                [0m
[2;36m                    [0m         [1;36m998[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifData"[0m[39m, [0m[32m"Bogus offset of IFD1."[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m999[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1000[0m[39m:   [0m[39m        [0m[39m   exif_data_load_data_content [0m[1;39m([0m[39mdata, EXIF_IFD_1, d + [0m[1;36m6[0m[39m, ds - [0m[1;36m6[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39moffset, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1001[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1002[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1003[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1004[0m[39m:   [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1005[0m[39m:   [0m[39m * If we got an EXIF_TAG_MAKER_NOTE, try to interpret it. Some[0m              [2m                [0m
[2;36m                    [0m         [1;36m1006[0m[39m:   [0m[39m * cameras use pointers in the maker note tag that point to the[0m             [2m                [0m
[2;36m                    [0m         [1;36m1007[0m[39m:   [0m[39m * space between IFDs. Here is the only place where we have access[0m          [2m                [0m
[2;36m                    [0m         [1;36m1008[0m[39m:   [0m[39m * to that data.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1009[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1010[0m[39m:   [0m[1;35minterpret_maker_note[0m[1;39m([0m[39mdata, d, fullds[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1011[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1012[0m[39m:   [0m[35m/[0m[39m* Fixup tags if requested *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1013[0m[39m:   [0m[39mif [0m[1;39m([0m[39mdata->priv->options & EXIF_DATA_OPTION_FOLLOW_SPECIFICATION[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m1014[0m[39m:   [0m[39m        [0m[39mexif_data_fix [0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1015[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:65[0m[39m-[0m[1;36m97[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    if [0m[1;39m([0m[39m!d || !buf || [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    ofs = d->offset + [0m[1;36m6[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        d->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        d->order = EXIF_BYTE_ORDER_INTEL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Unrecognized byte order"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    tcount = [0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[35m/[0m[39m* Sanity check the offset *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    if [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[39m + tcount * [0m[1;36m6[0m[39m + [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[35m/[0m[39m* [0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m: total %d tags\n"[0m[39m, __FUNCTION__, __LINE__, tcount[0m[1;39m)[0m[39m; *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    ofs += [0m[1;36m16[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:56[0m[39m-[0m[1;36m137[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m57:e[0m[1;35mxif_mnote_data_apple_load[0m[1;39m([0m[39mExifMnoteData *md, const unsigned char *buf, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mint buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    unsigned int tcount, i;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    unsigned int dsize;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    unsigned int ofs, dofs;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    if [0m[1;39m([0m[39m!d || !buf || [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    ofs = d->offset + [0m[1;36m6[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        d->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        d->order = EXIF_BYTE_ORDER_INTEL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Unrecognized byte order"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    tcount = [0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[35m/[0m[39m* Sanity check the offset *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    if [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[39m + tcount * [0m[1;36m6[0m[39m + [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[35m/[0m[39m* [0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m: total %d tags\n"[0m[39m, __FUNCTION__, __LINE__, tcount[0m[1;39m)[0m[39m; *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    ofs += [0m[1;36m16[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[1;35mexif_mnote_data_apple_free[0m[1;39m([0m[39mmd[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    d->entries = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m * tcount[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    if [0m[1;39m([0m[39m!d->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m *[0m [2m                [0m
[2;36m                    [0m         [39mtcount[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < tcount; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs, d->order[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m2[0m[39m, d->order[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components = [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m4[0m[39m, d->order[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order = d->order;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        dsize = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m                   [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            dofs = ofs + [0m[1;36m8[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                                  [0m[32m"ExifMnoteApplet"[0m[39m, [0m[32m"Tag size overflow [0m        [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, buf_size[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        ofs += [0m[1;36m12[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, dsize[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        if [0m[1;39m([0m[39m!d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, dsize[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            continue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, buf + dofs, dsize[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size = dsize;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    d->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:1[0m[39m-[0m[1;36m30[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* exif-mnote-data-apple.c[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * Copyright [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;36m2018[0m[39m zhanwang-sky <zhanwang_sky@[0m[1;36m163.[0m[39mcom>[0m                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * This library is free software; you can redistribute it and/or[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * modify it under the terms of the GNU Lesser General Public[0m                     [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * License as published by the Free Software Foundation; either[0m                   [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * version [0m[1;36m2[0m[39m of the License, or [0m[1;39m([0m[39mat your option[0m[1;39m)[0m[39m any later version.[0m               [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: * This library is distributed in the hope that it will be useful,[0m               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * but WITHOUT ANY WARRANTY; without even the implied warranty of[0m                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * Lesser General Public License for more details.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * You should have received a copy of the GNU Lesser General Public[0m              [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * License along with this library; if not, write to the[0m                         [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * Free Software Foundation, Inc., [0m[1;36m51[0m[39m Franklin Street, Fifth Floor,[0m              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: * Boston, MA  [0m[1;36m02110[0m[39m-[0m[1;36m1301[0m[39m  USA.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#include <config.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#include [0m[32m"exif-mnote-data-apple.h"[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include <stdio.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include <stdlib.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include <string.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include <libexif/exif-data.h>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include <libexif/exif-utils.h>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/exif-format.[0m[1;92mc:40[0m[39m-[0m[1;36m74[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        [0m[1;39m{[0m[39mEXIF_FORMAT_UNDEFINED, [0m[1;35mN_[0m[1;39m([0m[32m"Undefined"[0m[1;39m)[0m[39m, [0m[1;36m1[0m[1;39m}[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        [0m[1;39m{[0m[39mEXIF_FORMAT_ASCII,     [0m[1;35mN_[0m[1;39m([0m[32m"ASCII"[0m[1;39m)[0m[39m,     [0m[1;36m1[0m[1;39m}[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        [0m[1;39m{[0m[39mEXIF_FORMAT_LONG,      [0m[1;35mN_[0m[1;39m([0m[32m"Long"[0m[1;39m)[0m[39m,      [0m[1;36m4[0m[1;39m}[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        [0m[1;39m{[0m[39mEXIF_FORMAT_BYTE,      [0m[1;35mN_[0m[1;39m([0m[32m"Byte"[0m[1;39m)[0m[39m,      [0m[1;36m1[0m[1;39m}[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     [0m[1;39m{[0m[39mEXIF_FORMAT_SBYTE,     [0m[1;35mN_[0m[1;39m([0m[32m"SByte"[0m[1;39m)[0m[39m,     [0m[1;36m1[0m[1;39m}[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     [0m[1;39m{[0m[39mEXIF_FORMAT_SSHORT,    [0m[1;35mN_[0m[1;39m([0m[32m"SShort"[0m[1;39m)[0m[39m,    [0m[1;36m2[0m[1;39m}[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        [0m[1;39m{[0m[39mEXIF_FORMAT_SLONG,     [0m[1;35mN_[0m[1;39m([0m[32m"SLong"[0m[1;39m)[0m[39m,     [0m[1;36m4[0m[1;39m}[0m[39m,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     [0m[1;39m{[0m[39mEXIF_FORMAT_FLOAT,     [0m[1;35mN_[0m[1;39m([0m[32m"Float"[0m[1;39m)[0m[39m,     [0m[1;36m4[0m[1;39m}[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     [0m[1;39m{[0m[39mEXIF_FORMAT_DOUBLE,    [0m[1;35mN_[0m[1;39m([0m[32m"Double"[0m[1;39m)[0m[39m,    [0m[1;36m8[0m[1;39m}[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;39m{[0m[1;36m0[0m[39m, NULL, [0m[1;36m0[0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m52:c[0m[39monst char *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m53:e[0m[39mxif_format_get_name [0m[1;39m([0m[39mExifFormat format[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     [0m[39munsigned int i;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m bindtextdomain [0m[1;39m([0m[1;33mGET[0m[39mTEXT_PACKAGE, LOCALEDIR[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     [0m[39mfor [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; ExifFormatTable[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.name; i++[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39mExifFormatTable[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format == format[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     [0m[39m        [0m[39m        [0m[39mreturn [0m[1;35m_[0m[1;39m([0m[39mExifFormatTable[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.name[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     [0m[39mreturn NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:unsigned char[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;92m66:e[0m[39mxif_format_get_size [0m[1;39m([0m[39mExifFormat format[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     [0m[39munsigned int i;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mfor [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; ExifFormatTable[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size; i++[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39mExifFormatTable[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format == format[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[39m        [0m[39m        [0m[39mreturn ExifFormatTable[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:225[0m[39m-[0m[1;36m235[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, n->order[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing to much memory[0m [2m                [0m
[2;36m                    [0m         [39mor time. There are [0m[1;36m24[0m[39m named tags currently.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m * The format allows specifying the same range of memory as often as it [0m    [2m                [0m
[2;36m                    [0m         [39mcan, so this multiplies quickly. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39mif [0m[1;39m([0m[39mc > [0m[1;36m100[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifMnoteCanon"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [32m"Too much tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Canon MakerNote"[0m[39m, c[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[35m/[0m[39m* Remove any old entries *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[39mexif_mnote_data_canon_clear [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:412[0m[39m-[0m[1;36m422[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:    [0m[39mo2 += [0m[1;36m2[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing to much memory[0m [2m                [0m
[2;36m                    [0m         [39mor time. There are [0m[1;36m150[0m[39m named tags currently.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:    [0m[39m * The format allows specifying the same range of memory as often as it [0m    [2m                [0m
[2;36m                    [0m         [39mcan, so this multiplies quickly. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:    [0m[39mif [0m[1;39m([0m[39mc > [0m[1;36m300[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifMnoteOlympus"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [32m"Too much tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Olympus MakerNote"[0m[39m, c[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:    [0m[35m/[0m[39m* Remove any old entries *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:    [0m[39mexif_mnote_data_olympus_clear [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:266[0m[39m-[0m[1;36m276[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing to much memory[0m [2m                [0m
[2;36m                    [0m         [39mor time. There are [0m[1;36m102[0m[39m named tags currently.[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:    [0m[39m * The format allows specifying the same range of memory as often as it [0m    [2m                [0m
[2;36m                    [0m         [39mcan, so this multiplies quickly. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:    [0m[39mif [0m[1;39m([0m[39mc > [0m[1;36m200[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m                     [2m                [0m
[2;36m                    [0m         [32m"ExifMnoteDataPentax"[0m[39m, [0m[32m"Too much tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Pentax MakerNote"[0m[39m, c[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:    [0m[35m/[0m[39m* Remove any old entries *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:184[0m[39m-[0m[1;36m194[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing to much memory[0m [2m                [0m
[2;36m                    [0m         [39mor time. There are [0m[1;36m50[0m[39m named tags currently.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:    [0m[39m * The format allows specifying the same range of memory as often as it [0m    [2m                [0m
[2;36m                    [0m         [39mcan, so this multiplies quickly. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    [0m[39mif [0m[1;39m([0m[39mc > [0m[1;36m100[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifMnoteDataFuji"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [32m"Too much tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Fuji MakerNote"[0m[39m, c[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[35m/[0m[39m* Remove any old entries *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:    [0m[39mexif_mnote_data_fuji_clear [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:240[0m[39m-[0m[1;36m260[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteCanon"[0m[39m, sizeof [0m               [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[35m/[0m[39m* Parse the entries *[0m[35m/[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo,buf_size,[0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:430[0m[39m-[0m[1;36m450[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:    [0m[35m/[0m[39m* Parse all c entries, storing ones that are successfully parsed *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = o2; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteOlympusEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteOlympus"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:    [0m[39m    n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m + [0m   [2m                [0m
[2;36m                    [0m         [39mbase;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:    [0m[39m    n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:    [0m[39m    n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, n->order[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:    [0m[39m    n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:    [0m[39m    exif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteOlympus"[0m[39m,[0m             [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:    [0m[39m        [0m[39m      [0m[32m"Loading entry 0x%x [0m[32m([0m[32m'%s'[0m[32m)[0m[32m..."[0m[39m, n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag,[0m       [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:    [0m[39m        [0m[39m      mnote_olympus_tag_get_name [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:[0m[35m/[0m[39m*  [0m[39m    exif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_DEBUG, [0m[32m"ExifMnoteOlympus"[0m[39m,[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:282[0m[39m-[0m[1;36m302[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39men->log, [0m[32m"ExifMnoteDataPentax"[0m[39m, sizeof [0m          [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mMnotePentaxEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:    [0m[35m/[0m[39m* Parse all c entries, storing ones that are successfully parsed *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnotePentaxEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo,buf_size,[0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataPentax"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m + base;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long  [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:199[0m[39m-[0m[1;36m218[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39men->log, [0m[32m"ExifMnoteDataFuji"[0m[39m, sizeof [0m            [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mMnoteFujiEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:    [0m[35m/[0m[39m* Parse all c entries, storing ones that are successfully parsed *[0m[35m/[0m        [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteFujiEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:323[0m[39m-[0m[1;36m330[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Tag was successfully parsed *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:    [0m[39m        [0m[39m++tcount;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:    [0m[35m/[0m[39m* Store the count of successfully parsed tags *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:    [0m[39mn->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:506[0m[39m-[0m[1;36m513[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Tag was successfully parsed *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:    [0m[39m        [0m[39m++tcount;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:    [0m[35m/[0m[39m* Store the count of successfully parsed tags *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:    [0m[39mn->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:342[0m[39m-[0m[1;36m349[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Tag was successfully parsed *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:    [0m[39m        [0m[39m++tcount;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:    [0m[35m/[0m[39m* Store the count of successfully parsed tags *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:    [0m[39mn->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:258[0m[39m-[0m[1;36m265[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Tag was successfully parsed *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:    [0m[39m        [0m[39m++tcount;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[35m/[0m[39m* Store the count of successfully parsed tags *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:    [0m[39mn->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:265[0m[39m-[0m[1;36m273[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Check if we overflow the multiplication. Use buf_size as the max[0m [2m                [0m
[2;36m                    [0m         [39msize for integer overflow detection,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[39m        [0m[39m * we will check the buffer sizes closer later. *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m    [0m[39mexif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m         [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf_size [0m[35m/[0m[39m exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m< n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:    [0m[39m        [0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Tag size overflow detected [0m[32m([0m[32m%u[0m [2m                [0m
[2;36m                    [0m         [32m* %lu[0m[32m)[0m[32m"[0m[39m, exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m, [0m                         [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/olympus/exif-mnote-data-olympus.[0m[1;92mc:456[0m[39m-[0m[1;36m464[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m456[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m457[0m[39m:    [0m[39m    [0m[35m/[0m[39m* Check if we overflow the multiplication. Use buf_size as the max [0m    [2m                [0m
[2;36m                    [0m         [39msize for integer overflow detection,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m458[0m[39m:    [0m[39m     * we will check the buffer sizes closer later. *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:    [0m[39m    if [0m[1;39m([0m[39mexif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m                 [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:    [0m[39m        [0m[39mbuf_size [0m[35m/[0m[39m exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m < [0m      [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:    [0m[39m    [0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifMnoteOlympus"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [32m"Tag size overflow detected [0m[32m([0m[32m%u * %lu[0m[32m)[0m[32m"[0m[39m, exif_format_get_size [0m                      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m, n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m463[0m[39m:    [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m464[0m[39m:    [0m[39m    [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/pentax/exif-mnote-data-pentax.[0m[1;92mc:307[0m[39m-[0m[1;36m315[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Check if we overflow the multiplication. Use buf_size as the max[0m [2m                [0m
[2;36m                    [0m         [39msize for integer overflow detection,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:    [0m[39m        [0m[39m * we will check the buffer sizes closer later. *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m    [0m[39mexif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m         [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf_size [0m[35m/[0m[39m exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m< n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:    [0m[39m        [0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataPentax"[0m[39m, [0m[32m"Tag size overflow [0m        [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u * %lu[0m[32m)[0m[32m"[0m[39m, exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m, [0m            [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/fuji/exif-mnote-data-fuji.[0m[1;92mc:224[0m[39m-[0m[1;36m232[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Check if we overflow the multiplication. Use buf_size as the max[0m [2m                [0m
[2;36m                    [0m         [39msize for integer overflow detection,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39m        [0m[39m * we will check the buffer sizes closer later. *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m    [0m[39mexif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m         [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf_size [0m[35m/[0m[39m exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m< n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m        [0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39men->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteDataFuji"[0m[39m, [0m[32m"Tag size overflow [0m  [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u * %lu[0m[32m)[0m[32m"[0m[39m, exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m, [0m            [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:109[0m[39m-[0m[1;36m134[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < tcount; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs, d->order[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m2[0m[39m, d->order[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components = [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m4[0m[39m, d->order[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order = d->order;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        dsize = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m                   [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            dofs = ofs + [0m[1;36m8[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                                  [0m[32m"ExifMnoteApplet"[0m[39m, [0m[32m"Tag size overflow [0m        [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, buf_size[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        ofs += [0m[1;36m12[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, dsize[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        if [0m[1;39m([0m[39m!d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, dsize[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            continue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, buf + dofs, dsize[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size = dsize;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    d->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:33[0m[39m-[0m[1;36m34[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:203[0m[39m-[0m[1;36m260[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:static void[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m204:e[0m[39mxif_mnote_data_canon_load [0m[1;39m([0m[39mExifMnoteData *ne,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[39mconst unsigned char *buf, unsigned int buf_size[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    [0m[39mExifMnoteDataCanon *n = [0m[1;39m([0m[39mExifMnoteDataCanon *[0m[1;39m)[0m[39m ne;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    [0m[39mExifShort c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[39msize_t i, tcount, o, datao;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:    [0m[39mlong failsafe_size = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n || !buf || !buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[39mdatao = [0m[1;36m6[0m[39m + n->offset;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdatao, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[35m/[0m[39m* Read the number of tags *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[39mc = exif_get_short [0m[1;39m([0m[39mbuf + datao, n->order[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[39mdatao += [0m[1;36m2[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[35m/[0m[39m* Just use an arbitrary max tag limit here to avoid needing to much memory[0m [2m                [0m
[2;36m                    [0m         [39mor time. There are [0m[1;36m24[0m[39m named tags currently.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[39m * The format allows specifying the same range of memory as often as it [0m    [2m                [0m
[2;36m                    [0m         [39mcan, so this multiplies quickly. *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[39mif [0m[1;39m([0m[39mc > [0m[1;36m100[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m[32m"ExifMnoteCanon"[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [32m"Too much tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Canon MakerNote"[0m[39m, c[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[35m/[0m[39m* Remove any old entries *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[39mexif_mnote_data_canon_clear [0m[1;39m([0m[39mn[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[39mn->entries = exif_mem_alloc [0m[1;39m([0m[39mne->mem, sizeof [0m[1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!n->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteCanon"[0m[39m, sizeof [0m               [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[39m        [0m[39mreturn;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    [0m[35m/[0m[39m* Parse the entries *[0m[35m/[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    [0m[39mtcount = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[39mfor [0m[1;39m([0m[39mi = c, o = datao; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[39m        [0m[39msize_t s;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:    [0m[39m        [0m[1;35mmemset[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteCanonEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo,buf_size,[0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.tag        = exif_get_short [0m[1;39m([0m[39mbuf + o, n->order[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format     = exif_get_short [0m[1;39m([0m[39mbuf + o + [0m[1;36m2[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components = exif_get_long [0m[1;39m([0m[39mbuf + o + [0m[1;36m4[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:    [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.order      = n->order;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:265[0m[39m-[0m[1;36m273[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Check if we overflow the multiplication. Use buf_size as the max[0m [2m                [0m
[2;36m                    [0m         [39msize for integer overflow detection,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[39m        [0m[39m * we will check the buffer sizes closer later. *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39m    [0m[39mexif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m         [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    [0m[39m        [0m[39m        [0m[39mbuf_size [0m[35m/[0m[39m exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m< n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:    [0m[39m        [0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Tag size overflow detected [0m[32m([0m[32m%u[0m [2m                [0m
[2;36m                    [0m         [32m* %lu[0m[32m)[0m[32m"[0m[39m, exif_format_get_size [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m, [0m                         [2m                [0m
[2;36m                    [0m         [39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/canon/exif-mnote-data-canon.[0m[1;92mc:288[0m[39m-[0m[1;36m330[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:    [0m[39m        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:    [0m[39m        [0m[39m        [0m[39msize_t dataofs = o + [0m[1;36m8[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39ms > [0m[1;36m4[0m[1;39m)[0m[39m dataofs = exif_get_long [0m[1;39m([0m[39mbuf + dataofs, [0m         [2m                [0m
[2;36m                    [0m         [39mn->order[0m[1;39m)[0m[39m + [0m[1;36m6[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdataofs, buf_size, s[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_DEBUG,[0m             [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[32m"ExifMnoteCanon"[0m[39m,[0m                           [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[32m"Tag data past end of buffer [0m[32m([0m[32m%u > %u[0m[32m)[0m[32m"[0m[39m,[0m    [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[1;39m([0m[39munsigned[0m[1;39m)[0m[1;39m([0m[39mdataofs + s[0m[1;39m)[0m[39m, buf_size[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:    [0m[39m        [0m[39m        [0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data = exif_mem_alloc [0m[1;39m([0m[39mne->mem, s[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:    [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m!n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mne->log, [0m[32m"ExifMnoteCanon"[0m[39m, s[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39mcontinue;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:    [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:    [0m[39m        [0m[39m        [0m[39mmemcpy [0m[1;39m([0m[39mn->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data, buf + dataofs, s[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Track the size of decoded tag data. A malicious file could[0m       [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:    [0m[39m        [0m[39m * be crafted to cause extremely large values here without[0m          [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:    [0m[39m        [0m[39m * tripping any buffer range checks.  This is especially bad[0m        [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:    [0m[39m        [0m[39m * with the libexif representation of Canon MakerNotes because[0m      [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:    [0m[39m        [0m[39m * some arrays are turned into individual tags that the[0m             [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:    [0m[39m        [0m[39m * application must loop around. *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:    [0m[39m        [0m[39mfailsafe_size += [0m                                                   [2m                [0m
[2;36m                    [0m         [1;35mmnote_canon_entry_count_values[0m[1;39m([0m[39m&n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:    [0m[39m        [0m[39mif [0m[1;39m([0m[39mfailsafe_size > FAILSAFE_SIZE_MAX[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:    [0m[39m        [0m[39m        [0m[35m/[0m[39m* Abort if the total size of the data in the tags [0m         [2m                [0m
[2;36m                    [0m         [39mextraordinarily large, *[0m[35m/[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_mem_free [0m[1;39m([0m[39mne->mem, n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:    [0m[39m        [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mne->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m              [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  [0m[32m"ExifMnoteCanon"[0m[39m, [0m[32m"Failsafe tag size [0m     [2m                [0m
[2;36m                    [0m         [32moverflow [0m[32m([0m[32m%lu > %ld[0m[32m)[0m[32m"[0m[39m,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:    [0m[39m        [0m[39m        [0m[39m        [0m[39m        [0m[39m  failsafe_size, FAILSAFE_SIZE_MAX[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:    [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:    [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:    [0m[39m        [0m[35m/[0m[39m* Tag was successfully parsed *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:    [0m[39m        [0m[39m++tcount;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:    [0m[35m/[0m[39m* Store the count of successfully parsed tags *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:    [0m[39mn->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibexif/apple/exif-mnote-data-apple.[0m[1;92mc:56[0m[39m-[0m[1;36m137[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:static void[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m57:e[0m[1;35mxif_mnote_data_apple_load[0m[1;39m([0m[39mExifMnoteData *md, const unsigned char *buf, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mint buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    ExifMnoteDataApple *d = [0m[1;39m([0m[39mExifMnoteDataApple *[0m[1;39m)[0m[39m md;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    unsigned int tcount, i;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    unsigned int dsize;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    unsigned int ofs, dofs;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s\n"[0m[39m, __FUNCTION__[0m[1;39m)[0m[39m;*[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    if [0m[1;39m([0m[39m!d || !buf || [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[35m/[0m[39m* Start of interesting data *[0m[35m/[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    ofs = d->offset + [0m[1;36m6[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'M'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        d->order = EXIF_BYTE_ORDER_MOTOROLA;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m == [0m[32m'I'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        d->order = EXIF_BYTE_ORDER_INTEL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Unrecognized byte order"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    tcount = [0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[35m/[0m[39m* Sanity check the offset *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    if [0m[1;39m([0m[39mbuf_size < [0m[1;36m6[0m[39m + [0m[1;36m16[0m[39m + tcount * [0m[1;36m6[0m[39m + [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                 [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        return;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[35m/[0m[39m* [0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m: total %d tags\n"[0m[39m, __FUNCTION__, __LINE__, tcount[0m[1;39m)[0m[39m; *[0m[35m/[0m     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    ofs += [0m[1;36m16[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[1;35mexif_mnote_data_apple_free[0m[1;39m([0m[39mmd[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[35m/[0m[39m* Reserve enough space for all the possible MakerNote tags *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    d->entries = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m * tcount[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    if [0m[1;39m([0m[39m!d->entries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m *[0m [2m                [0m
[2;36m                    [0m         [39mtcount[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[35m/[0m[39m*[0m[1;35mprintf[0m[1;39m([0m[32m"%s[0m[32m([0m[32m%d[0m[32m)[0m[32m\n"[0m[39m, __FUNCTION__, __LINE__[0m[1;39m)[0m[39m;*[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        return;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < tcount; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.tag = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs, d->order[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format = [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m2[0m[39m, d->order[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components = [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m4[0m[39m, d->order[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.order = d->order;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        dsize = [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m * [0m                   [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.components;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39mdsize > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            dofs = d->offset + [0m[1;35mexif_get_long[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m8[0m[39m, d->order[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            dofs = ofs + [0m[1;36m8[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mif [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39m        [0m[39mexif_log [0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                                  [0m[32m"ExifMnoteApplet"[0m[39m, [0m[32m"Tag size overflow [0m        [2m                [0m
[2;36m                    [0m         [32mdetected [0m[32m([0m[32m%u vs size %u[0m[32m)[0m[32m"[0m[39m, dofs, buf_size[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[39m        [0m[39mcontinue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        ofs += [0m[1;36m12[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, dsize[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        if [0m[1;39m([0m[39m!d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;35mEXIF_LOG_NO_MEMORY[0m[1;39m([0m[39mmd->log, [0m[32m"ExifMnoteApple"[0m[39m, dsize[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            continue;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.data, buf + dofs, dsize[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        d->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.size = dsize;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    d->count = tcount;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy for Heap-Buffer-Overflow in Apple MakerNote Processing[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Analysis Summary[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is a heap-buffer-overflow in [0m                                     [2m                [0m
[2;36m                    [0m         [39m`libexif/apple/exif-mnote-data-apple.c` during Apple MakerNote parsing. The root [0m   [2m                [0m
[2;36m                    [0m         [39mcause is **missing bounds checking** before buffer reads. The Apple MakerNote [0m      [2m                [0m
[2;36m                    [0m         [39mimplementation lacks the defensive programming patterns consistently used by all [0m   [2m                [0m
[2;36m                    [0m         [39mother vendor implementations [0m[1;39m([0m[39mCanon, Olympus, Pentax, Fuji[0m[1;39m)[0m[39m.[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Key Findings:**[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- The immediate crash occurs at line [0m[1;36m110[0m[39m: `[0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs, d->order[0m[1;39m)[0m[39m` [0m    [2m                [0m
[2;36m                    [0m         [39mattempts to read [0m[1;36m2[0m[39m bytes when only [0m[1;36m1[0m[39m byte remains in the buffer[0m                     [2m                [0m
[2;36m                    [0m         [39m- The Apple implementation is missing the `CHECKOVERFLOW` macro used by all other [0m  [2m                [0m
[2;36m                    [0m         [39mvendor implementations[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- Multiple validation steps are absent or incorrect throughout the function[0m         [2m                [0m
[2;36m                    [0m         [39m- The code doesn't follow the [0m[32m"tcount tracking"[0m[39m pattern for robust error handling[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Comprehensive Fix Strategy[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix requires adding defensive validation patterns from [0m                         [2m                [0m
[2;36m                    [0m         [39m`libexif/canon/exif-mnote-data-canon.c` [0m[1;39m([0m[39mthe most robust reference implementation[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mto `libexif/apple/exif-mnote-data-apple.c`.[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m1[0m[39m: Add CHECKOVERFLOW Macro[0m                                                [2m                [0m
[2;36m                    [0m         [39m**Location:** After line [0m[1;36m29[0m[39m in `libexif/apple/exif-mnote-data-apple.c`[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd the macro definition that all other vendor implementations use:[0m                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m#define [0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39moffset,datasize,structsize[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39m offset >= datasize[0m[1;39m)[0m[39m || [0m        [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstructsize > datasize[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moffset > datasize - structsize [0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis macro validates that reading `structsize` bytes starting at `offset` won't [0m    [2m                [0m
[2;36m                    [0m         [39mexceed `datasize`.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m2[0m[39m: Validate Header Offset[0m                                                 [2m                [0m
[2;36m                    [0m         [39m**Location:** After line [0m[1;36m72[0m[39m [0m[1;39m([0m[39mafter `ofs = d->offset + [0m[1;36m6[0m[39m;`[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd bounds checking before accessing header bytes:[0m                                  [2m                [0m
[2;36m                    [0m         [39m- Verify `d->offset + [0m[1;36m6[0m[39m` doesn't cause integer overflow[0m                             [2m                [0m
[2;36m                    [0m         [39m- Verify `ofs + [0m[1;36m16[0m[39m <= buf_size` using CHECKOVERFLOW[0m                                 [2m                [0m
[2;36m                    [0m         [39m- This prevents accessing `buf[0m[1;39m[[0m[39mofs + [0m[1;36m12[0m[1;39m][0m[39m`, `buf[0m[1;39m[[0m[39mofs + [0m[1;36m13[0m[1;39m][0m[39m`, `buf[0m[1;39m[[0m[39mofs + [0m[1;36m14[0m[1;39m][0m[39m` out of [0m [2m                [0m
[2;36m                    [0m         [39mbounds[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mofs = d->offset + [0m[1;36m6[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mofs, buf_size, [0m[1;36m16[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote header"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m    return;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m3[0m[39m: Fix Tag Count Validation[0m                                               [2m                [0m
[2;36m                    [0m         [39m**Location:** Line [0m[1;36m88[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mCurrent code incorrectly calculates required buffer size as `tcount * [0m[1;36m6[0m[39m` but each [0m  [2m                [0m
[2;36m                    [0m         [39mentry is [0m[1;36m12[0m[39m bytes.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix:** Change validation to use CHECKOVERFLOW pattern:[0m                            [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mofs, buf_size, [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote for tag count"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m    return;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThen after reading tcount, validate entry space:[0m                                    [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mofs + [0m[1;36m16[0m[39m, buf_size, [0m[1;36m12[0m[39m * tcount[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote for entries"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m    return;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m4[0m[39m: Add Tag Count Limit[0m                                                    [2m                [0m
[2;36m                    [0m         [39m**Location:** After line [0m[1;36m85[0m[39m [0m[1;39m([0m[39mafter reading tcount[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd defensive limit following other vendor implementations:[0m                         [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mtcount > [0m[1;36m100[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA, [0m                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Too many tags [0m[32m([0m[32m%d[0m[32m)[0m[32m in Apple MakerNote"[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mtcount[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    return;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis prevents excessive memory allocation and processing time.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m5[0m[39m: Implement Robust Tag Counting Pattern[0m                                  [2m                [0m
[2;36m                    [0m         [39m**Location:** Lines [0m[1;36m109[0m[39m-[0m[1;36m134[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace direct index usage with the two-variable pattern used by all other vendors:[0m [2m                [0m
[2;36m                    [0m         [39m- Use `c` for the count read from file [0m[1;39m([0m[39muntrusted[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m- Use `tcount` to track successfully parsed entries [0m[1;39m([0m[39mtrusted[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m- Change loop to: `for [0m[1;39m([0m[39mi = c, o = ofs; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m`[0m                           [2m                [0m
[2;36m                    [0m         [39m- Use `n->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m` instead of `n->entries[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m`[0m                               [2m                [0m
[2;36m                    [0m         [39m- Increment `tcount` only after successful parsing[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes:**[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39munsigned int c, tcount = [0m[1;36m0[0m[39m;  [0m[35m/[0m[35m/[0m[39m Rename variable[0m                                     [2m                [0m
[2;36m                    [0m         [39mc = [0m[1;39m([0m[39munsigned int[0m[1;39m)[0m[39m [0m[1;35mexif_get_short[0m[1;39m([0m[39mbuf + ofs + [0m[1;36m14[0m[39m, d->order[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m [0m[33m...[0m[39m validation [0m[33m...[0m                                                               [2m                [0m
[2;36m                    [0m         [39md->entries = [0m[1;35mexif_mem_alloc[0m[1;39m([0m[39mmd->mem, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[39m * c[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mtcount = [0m[1;36m0[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mfor [0m[1;39m([0m[39mi = c, o = ofs; i; --i, o += [0m[1;36m12[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmemset[0m[1;39m([0m[39m&d->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mMnoteAppleEntry[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m rest of loop using d->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m [0m[33m...[0m                                [2m                [0m
[2;36m                    [0m         [39m    ++tcount;  [0m[35m/[0m[35m/[0m[39m Only after successful parsing[0m                                     [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39md->count = tcount;[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m6[0m[39m: Add Entry Bounds Checking[0m                                              [2m                [0m
[2;36m                    [0m         [39m**Location:** Before line [0m[1;36m110[0m[39m in the loop[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd CHECKOVERFLOW before reading [0m[1;36m12[0m[39m-byte entry structure:[0m                           [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mo, buf_size, [0m[1;36m12[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Short MakerNote entry"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m    break;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis is **the critical fix** that prevents the reported heap-buffer-overflow at [0m    [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m110[0m[39m.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m7[0m[39m: Add Integer Overflow Check[0m                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Before line [0m[1;36m114[0m[39m [0m[1;39m([0m[39mbefore `dsize = [0m[33m...[0m[39m`[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd check to prevent integer overflow in size calculation:[0m                          [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m &&[0m                              [2m                [0m
[2;36m                    [0m         [39m    buf_size [0m[35m/[0m[39m [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m < [0m                   [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_CORRUPT_DATA,[0m                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[32m"ExifMnoteDataApple"[0m[39m, [0m[32m"Tag size overflow detected [0m[32m([0m[32m%u * %lu[0m[32m)[0m[32m"[0m[39m,[0m         [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mexif_format_get_size[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.format[0m[1;39m)[0m[39m, [0m                      [2m                [0m
[2;36m                    [0m         [39m             d->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.components[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m    continue;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m8[0m[39m: Fix Data Offset Validation[0m                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Replace line [0m[1;36m120[0m[39m-[0m[1;36m124[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mCurrent check `if [0m[1;39m([0m[39mdofs > buf_size[0m[1;39m)[0m[39m` is insufficient. Replace with CHECKOVERFLOW:[0m   [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mCHECKOVERFLOW[0m[1;39m([0m[39mdofs, buf_size, dsize[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mexif_log[0m[1;39m([0m[39mmd->log, EXIF_LOG_CODE_DEBUG,[0m                                          [2m                [0m
[2;36m                    [0m         [39m             [0m[32m"ExifMnoteDataApple"[0m[39m,[0m                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[32m"Tag data past end of buffer [0m[32m([0m[32m%u + %u > %u[0m[32m)[0m[32m"[0m[39m,[0m                          [2m                [0m
[2;36m                    [0m         [39m             dofs, dsize, buf_size[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m    continue;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis prevents `memcpy` at line [0m[1;36m131[0m[39m from reading beyond buffer bounds.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m9[0m[39m: Add Successful Parse Tracking[0m                                          [2m                [0m
[2;36m                    [0m         [39m**Location:** After line [0m[1;36m132[0m[39m in the loop[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd increment of tcount only after all validations pass:[0m                            [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;35mmemcpy[0m[1;39m([0m[39md->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.data, buf + dofs, dsize[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39md->entries[0m[1;39m[[0m[39mtcount[0m[1;39m][0m[39m.size = dsize;[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[39m* Tag was successfully parsed *[0m[35m/[0m                                                   [2m                [0m
[2;36m                    [0m         [39m++tcount;[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mMove the increment from the loop control to after successful parsing.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Justification[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why This is Optimal:**[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Follows Established Patterns:** Uses the exact same defensive patterns from [0m   [2m                [0m
[2;36m                    [0m         [39mCanon, Olympus, Pentax, and Fuji implementations that have been battle-tested[0m       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Minimal Changes:** Only adds validation without changing core logic or API[0m     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Defense in Depth:** Multiple layers of checking catch errors at different [0m     [2m                [0m
[2;36m                    [0m         [39mstages[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserves Functionality:** The same fuzzing logic will work; we're just adding[0m [2m                [0m
[2;36m                    [0m         [39msafety checks[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Preserves Existing Logic:**[0m                                                [2m                [0m
[2;36m                    [0m         [39m- All existing entry parsing logic remains unchanged[0m                                [2m                [0m
[2;36m                    [0m         [39m- Memory allocation strategy stays the same[0m                                         [2m                [0m
[2;36m                    [0m         [39m- The function signature and return behavior are identical[0m                          [2m                [0m
[2;36m                    [0m         [39m- Valid EXIF files will parse exactly as before[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Addresses the Issues:**[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- **PRIMARY:** CHECKOVERFLOW before line [0m[1;36m110[0m[39m prevents reading beyond buffer [0m        [2m                [0m
[2;36m                    [0m         [39mboundary [0m[1;39m([0m[39mthe reported crash[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Header validation prevents early buffer access violations[0m                         [2m                [0m
[2;36m                    [0m         [39m- Integer overflow check prevents wraparound in size calculations[0m                   [2m                [0m
[2;36m                    [0m         [39m- Tag count limit prevents resource exhaustion[0m                                      [2m                [0m
[2;36m                    [0m         [39m- Robust tcount pattern ensures consistent state even with partial parsing[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects and Mitigation:**[0m                                          [2m                [0m
[2;36m                    [0m         [39m- **Effect:** Malformed files that previously parsed partially may now be rejected [0m [2m                [0m
[2;36m                    [0m         [39mentirely[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- **Mitigation:** This is the correct behavior - corrupted data should fail [0m        [2m                [0m
[2;36m                    [0m         [39mgracefully rather than crash[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- **Effect:** Very large tag counts [0m[1;39m([0m[39m>[0m[1;36m100[0m[1;39m)[0m[39m will be rejected[0m                         [2m                [0m
[2;36m                    [0m         [39m- **Mitigation:** Legitimate Apple MakerNotes don't have this many tags; this only [0m [2m                [0m
[2;36m                    [0m         [39maffects malicious inputs[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Reference from Codebase:**[0m                                                        [2m                [0m
[2;36m                    [0m         [39mThe Canon implementation at `libexif/canon/exif-mnote-data-canon.[0m[1;92mc:203[0m[39m-[0m[1;36m330[0m[39m` [0m        [2m                [0m
[2;36m                    [0m         [39mdemonstrates all these patterns working together successfully. The Olympus, Pentax,[0m [2m                [0m
[2;36m                    [0m         [39mand Fuji implementations confirm this is the standard approach across the codebase.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Implementation Notes[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Order of Operations:**[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Add macro definition first [0m[1;39m([0m[39menables all other checks[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Add header validation [0m[1;39m([0m[39mprevents early crashes[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Add entry loop validation [0m[1;39m([0m[39mfixes the reported vulnerability[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Add size calculation checks [0m[1;39m([0m[39mprevents related vulnerabilities[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Refactor tcount pattern last [0m[1;39m([0m[39mensures clean state management[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Testing Considerations:**[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- The fuzzer should no longer crash on the provided testcase[0m                        [2m                [0m
[2;36m                    [0m         [39m- Valid Apple EXIF files should continue to parse correctly[0m                         [2m                [0m
[2;36m                    [0m         [39m- Malformed inputs should be rejected with appropriate error messages[0m               [2m                [0m
[2;36m                    [0m         [39m- No existing unit tests should break [0m[1;39m([0m[39mthey test valid EXIF data[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=524706;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=646656;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=963106;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=785637;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp789i5xuh[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/libexif_ex-delta-01_exif-005/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768023902.4036062[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/libexif_ex-delta-01_exif-[1;36m005.[0mtoml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-libexif[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/10/26 05:45:04][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mlibexif[0m        ]8;id=140750;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=656995;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=102202;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=285741;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mlibexif[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=762024;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=883047;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibexif[0m                [2m               [0m
