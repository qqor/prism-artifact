[2;36m[01/09/26 23:38:04][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=279720;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=319736;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpe4pb6nbn[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_0[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768001884.6308277[0m                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-poi_poi-full-01_vuln_0.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m        ]8;id=354226;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=642323;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/09/26 23:40:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m Took  ]8;id=626419;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=215454;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m140.39[0m seconds; [33mexception[0m=[3;91mFalse[0m                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN            ]8;id=952040;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=939768;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN           ]8;id=936285;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=366876;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=971615;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=401393;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m140[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=125167;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=196484;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/09/26 23:40:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.99[0m seconds;            ]8;id=776648;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=352332;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/09/26 23:40:27][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=846359;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=344114;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=805477;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=898041;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=499029;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=259475;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=729263;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=374102;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/09/26 23:40:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m1.23[0m seconds;            ]8;id=274799;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=342925;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/09/26 23:40:29][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=988191;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=351690;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/09/26 23:40:30][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.89[0m seconds;            ]8;id=692357;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=38126;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/09/26 23:41:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=669952;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=270745;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/09/26 23:41:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.88[0m seconds;            ]8;id=675722;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=845602;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running a pov[1m)[0m Started[33m...[0m                     ]8;id=156816;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=918708;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/09/26 23:41:59][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running a pov[1m)[0m Took [1;36m43.77[0m seconds;           ]8;id=404938;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=477895;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;92mTrue[0m                                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m Crash analysis results is empty. This should not happen.                              ]8;id=465098;file:///home/user/crete/packages/crete/commons/crash_analysis/functions/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=772340;file:///home/user/crete/packages/crete/commons/crash_analysis/functions/__init__.py#41\[2m41[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=31743;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=598010;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/09/26 23:42:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.90[0m seconds;            ]8;id=168095;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=779432;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/09/26 23:42:44][0m[2;36m [0m[34mINFO    [0m Found jstack output at                                                                ]8;id=184048;file:///home/user/crete/packages/crete/framework/analyzer/services/jvm_timeout_stacktrace/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=997623;file:///home/user/crete/packages/crete/framework/analyzer/services/jvm_timeout_stacktrace/__init__.py#43\[2m43[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/apache-poi/[0m[95mjstack.txt[0m   [2m              [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=760098;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=152269;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/09/26 23:43:01][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=979759;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=952406;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/09/26 23:48:15][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=78296;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=656268;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/09/26 23:48:55][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=463834;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=81526;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=593555;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=407105;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/09/26 23:48:56][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.97[0m seconds;            ]8;id=634722;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=781722;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/09/26 23:48:57][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Started[33m...[0m                          ]8;id=404495;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=556799;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpt23na46v[0m                                                 ]8;id=376359;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=729225;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/09/26 23:50:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Took [1;36m120.86[0m seconds;               ]8;id=414443;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=96659;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Started[33m...[0m                    ]8;id=242277;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=724818;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/09/26 23:51:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Took [1;36m37.11[0m seconds;          ]8;id=751286;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=50840;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Started[33m...[0m                       ]8;id=931131;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=847158;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/09/26 23:51:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Took [1;36m5.41[0m seconds;              ]8;id=73793;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=119598;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Started[33m...[0m                           ]8;id=575432;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=921993;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=873709;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=822827;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=341427;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=61668;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/09/26 23:51:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.92[0m seconds;            ]8;id=746420;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=210664;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/09/26 23:51:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=369803;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=594374;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/09/26 23:51:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.89[0m seconds;            ]8;id=683244;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=363687;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=1535;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=952196;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/09/26 23:51:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.95[0m seconds;            ]8;id=413572;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=194360;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/09/26 23:51:45][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=671567;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=884691;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java [2m                [0m
[2;36m                    [0m         +++ b/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java [2m                [0m
[2;36m                    [0m         @@ [1;36m-165[0m,[1;36m10[0m +[1;36m165[0m,[1;36m8[0m @@                                                                [2m                [0m
[2;36m                    [0m                         [1m}[0m else [1m{[0m                                                            [2m                [0m
[2;36m                    [0m                            [35m/[0m[35m/[0m Custom name was stored                                        [2m                [0m
[2;36m                    [0m                            int mplen = [1;35mLittleEndian.readInt[0m[1m([0minp[1m)[0m;                           [2m                [0m
[2;36m                    [0m         -                  if [1m([0mmplen [1m<[0m[39m [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m-                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + [0m    [2m                [0m
[2;36m                    [0m         [39mmplen[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-                  [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [39m-                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mmplen, [0m                   [2m                [0m
[2;36m                    [0m         [39mMAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m                   if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [39m                      throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen + [0m[32m" [0m [2m                [0m
[2;36m                    [0m         [32mbytes for attribute name"[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m                   [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-187[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m185[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m             int values = [0m[1;36m1[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mif[0m[1;39m([0m[39misMV || isVL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [39m                values = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+               [0m[1;35mIOUtils.safelyAllocateCheck[0m[1;39m([0m[39mvalues, MAX_RECORD_COUNT[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39mtype == Types.NULL && values > [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-196[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m195[0m[39m,[0m[1;36m9[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mfor[0m[1;39m([0m[39mint [0m[33mj[0m[39m=[0m[1;36m0[0m[39m; j<values; j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [39m                int len = [0m[1;35mgetLength[0m[1;39m([0m[39mtype, inp[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m                byte[0m[1;39m[[0m[1;39m][0m[39m data = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlen, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [39m-               [0m[1;35minp.read[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+               if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, data[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m+                  throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + len + [0m[32m" bytes[0m [2m                [0m
[2;36m                    [0m         [32mof attribute value"[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+               [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m                [0m[1;35mskipToBoundary[0m[1;39m([0m[39mlen, inp[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m                [0m[35m/[0m[35m/[0m[39m Create[0m                                                           [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-237[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m238[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m       [0m[35m/[0m[35m/[0m[39m Data is always padded out to a [0m[1;36m4[0m[39m byte boundary[0m                            [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mif[0m[1;39m([0m[39mlength % [0m[1;36m4[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [39m          int toSkip = [0m[1;36m4[0m[39m - [0m[1;39m([0m[39mlength % [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m-         [0m[1;35minp.skip[0m[1;39m([0m[39mtoSkip[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+         long skipped = [0m[1;35mIOUtils.skipFully[0m[1;39m([0m[39minp, toSkip[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m+         if [0m[1;39m([0m[39mskipped != toSkip[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [39m+            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"tried to skip "[0m[39m+toSkip +[0m[32m" but only [0m             [2m                [0m
[2;36m                    [0m         [32mskipped:"[0m[39m+skipped[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m+         [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m [0m[1;39m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mERROR: libFuzzer: timeout[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA timeout error has been detected during libFuzzer testing, indicating that the [0m    [2m                [0m
[2;36m                    [0m         [39mfuzzer encountered an input or code path that caused execution to exceed the [0m       [2m                [0m
[2;36m                    [0m         [39mconfigured timeout threshold. This suggests the presence of a performance issue, [0m   [2m                [0m
[2;36m                    [0m         [39mpotentially an infinite loop, algorithmic complexity problem, or resource [0m          [2m                [0m
[2;36m                    [0m         [39mexhaustion condition in the codebase under test.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue manifests as [0m[32m"libFuzzer: timeout"[0m[39m error during fuzz testing operations. [0m  [2m                [0m
[2;36m                    [0m         [39mThis error occurs when libFuzzer detects that the execution time for processing a [0m  [2m                [0m
[2;36m                    [0m         [39mparticular input exceeds the maximum allowed duration [0m[1;39m([0m[39mtypically configured via the[0m [2m                [0m
[2;36m                    [0m         [39m`-timeout` flag, with a default value[0m[1;39m)[0m[39m.[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Key Observations:**[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Timeout Nature**: The timeout indicates that code execution became [0m            [2m                [0m
[2;36m                    [0m         [39munresponsive or excessively slow when processing specific fuzzer-generated inputs. [0m [2m                [0m
[2;36m                    [0m         [39mThis is a critical finding as it suggests the codebase may be vulnerable to [0m        [2m                [0m
[2;36m                    [0m         [39mdenial-of-service [0m[1;39m([0m[39mDoS[0m[1;39m)[0m[39m conditions where malicious or malformed inputs could cause [0m [2m                [0m
[2;36m                    [0m         [39mthe application to hang or consume excessive CPU resources.[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Fuzzer Behavior**: LibFuzzer generates semi-random inputs based on code [0m       [2m                [0m
[2;36m                    [0m         [39mcoverage feedback. The fact that it triggered a timeout means it successfully [0m      [2m                [0m
[2;36m                    [0m         [39midentified an input pattern that causes problematic execution behavior.[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Not a Harness Issue**: The timeout occurs in the code being tested, not in the[0m [2m                [0m
[2;36m                    [0m         [39mfuzzing harness itself. The harness serves only as an entry point to feed data into[0m [2m                [0m
[2;36m                    [0m         [39mthe target functions.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Areas Requiring Investigation:**[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo understand the complete scope of this issue, the following components of the [0m    [2m                [0m
[2;36m                    [0m         [39mcodebase should be examined:[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Point Functions**: The specific functions being called by the fuzzing [0m   [2m                [0m
[2;36m                    [0m         [39mharness, as these are the direct recipients of the problematic input.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Loop Constructs**: Any loops [0m[1;39m([0m[39mfor, while, do-while[0m[1;39m)[0m[39m in the execution path that[0m [2m                [0m
[2;36m                    [0m         [39mcould become unbounded or execute an excessive number of iterations with certain [0m   [2m                [0m
[2;36m                    [0m         [39minputs.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Recursive Functions**: Functions that call themselves directly or indirectly, [0m [2m                [0m
[2;36m                    [0m         [39mwhich might enter deep or infinite recursion with specific input patterns.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Algorithmic Complexity**: Code sections with non-linear time complexity [0m       [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;35mO[0m[1;39m([0m[39mnÂ²[0m[1;39m)[0m[39m, [0m[1;35mO[0m[1;39m([0m[39mnÂ³[0m[1;39m)[0m[39m, or worse[0m[1;39m)[0m[39m that could become extremely slow with larger or specially [0m [2m                [0m
[2;36m                    [0m         [39mcrafted inputs.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Resource Allocation**: Memory allocation patterns, file I/O operations, or [0m    [2m                [0m
[2;36m                    [0m         [39mnetwork operations that might block indefinitely or take excessive time.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Input Validation**: The absence or inadequacy of input validation that should [0m [2m                [0m
[2;36m                    [0m         [39menforce bounds, limits, or constraints on the data being processed.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **Parser/Decoder Logic**: If the code involves parsing or decoding operations, [0m  [2m                [0m
[2;36m                    [0m         [39mthese components often contain complex state machines that can hang on malformed [0m   [2m                [0m
[2;36m                    [0m         [39minputs.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m. **Termination Conditions**: Conditions that determine when iterative or [0m         [2m                [0m
[2;36m                    [0m         [39mrecursive processes should terminate, which may not be properly defined for all [0m    [2m                [0m
[2;36m                    [0m         [39minput scenarios.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mERROR: libFuzzer: timeout[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:1[0m[39m-[0m[1;36m36[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.hmef.attribute;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.commons.io.input.UnsynchronizedByteArrayInputStream;[0m           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.hmef.Attachment;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.hmef.HMEFMessage;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.hsmf.datatypes.MAPIProperty;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.hsmf.datatypes.Types;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.hsmf.datatypes.Types.MAPIType;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.util.HexDump;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.poi.util.IOUtils;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.poi.util.LittleEndian;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.poi.util.StringUtil;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:41[0m[39m-[0m[1;36m64[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:public class MAPIAttribute [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:   [0m[35m/[0m[35m/[0m[95marbitrarily[0m[39m selected; may need to increase[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:   private static final int DEFAULT_MAX_RECORD_LENGTH = 1_000_000;[0m               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:   private static int MAX_RECORD_LENGTH = 1_000_000;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:   private static int MAX_RECORD_COUNT = 10_000;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:   private final MAPIProperty property;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:   private final int type;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:   private final byte[0m[1;39m[[0m[1;39m][0m[39m data;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    * @param length the max record length allowed for MAPIAttribute[0m              [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:   public static void [0m[1;35msetMaxRecordLength[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:      MAX_RECORD_LENGTH = length;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    * @return the max record length allowed for MAPIAttribute[0m                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:   public static int [0m[1;35mgetMaxRecordLength[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:      return MAX_RECORD_LENGTH;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:105[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m25[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:   public static List<MAPIAttribute> [0m[1;35mcreate[0m[1;39m([0m[39mTNEFAttribute parent[0m[1;39m)[0m[39m throws [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:      [0m[1;35mif[0m[1;39m([0m[1;35mparent.getProperty[0m[1;39m([0m[1;39m)[0m[39m == TNEFProperty.ID_MAPIPROPERTIES[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:         [0m[35m/[0m[35m/[0m[39m Regular MAPI Properties, normally on the message[0m                    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:      else [0m[1;35mif[0m[1;39m([0m[1;35mparent.getProperty[0m[1;39m([0m[1;39m)[0m[39m == TNEFProperty.ID_ATTACHMENT[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:         [0m[35m/[0m[35m/[0m[39m MAPI Properties for an attachment[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:      else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:         [0m[35m/[0m[35m/[0m[39m Something else, oh dear[0m[33m...[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:         throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m                                    [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:               [0m[32m"Can only create from a MAPIProperty attribute, "[0m[39m +[0m              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:               [0m[32m"instead received a "[0m[39m + [0m[1;35mparent.getProperty[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" one"[0m            [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:         [0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:      [0m[1;35mtry[0m[1;39m([0m[39mUnsynchronizedByteArrayInputStream inp = [0m                             [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[1;35mparent.getData[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:         [0m[35m/[0m[35m/[0m[39m First up, get the number of attributes[0m                              [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:         int count = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:         List<MAPIAttribute> attrs = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:         [0m[35m/[0m[35m/[0m[39m Now, read each one in in turn[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:         [0m[1;35mfor[0m[1;39m([0m[39mint [0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<count; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:186[0m[39m-[0m[1;36m2[0m [2m                [0m
[2;36m                    [0m         [1;36m14[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            [0m[35m/[0m[35m/[0m[39m Now read in the [0m[1;35mvalue[0m[1;39m([0m[39ms[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            int values = [0m[1;36m1[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39misMV || isVL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:               values = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            if [0m[1;39m([0m[39mtype == Types.NULL && values > [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:               throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Placeholder/NULL arrays aren't [0m           [2m                [0m
[2;36m                    [0m         [32msupported."[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            [0m[1;35mfor[0m[1;39m([0m[39mint [0m[33mj[0m[39m=[0m[1;36m0[0m[39m; j<values; j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:               int len = [0m[1;35mgetLength[0m[1;39m([0m[39mtype, inp[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:               byte[0m[1;39m[[0m[1;39m][0m[39m data = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlen, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:               [0m[1;35minp.read[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:               [0m[1;35mskipToBoundary[0m[1;39m([0m[39mlen, inp[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:               [0m[35m/[0m[35m/[0m[39m Create[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:               MAPIAttribute attr;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:               [0m[1;35mif[0m[1;39m([0m[39mtype == Types.UNICODE_STRING || type == Types.ASCII_STRING[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                  attr = new [0m[1;35mMAPIStringAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;35mif[0m[1;39m([0m[39mtype == Types.APP_TIME || type == Types.TIME[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:                  attr = new [0m[1;35mMAPIDateAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;35mif[0m[1;39m([0m[39mid == MAPIProperty.RTF_COMPRESSED.id[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                  attr = new [0m[1;35mMAPIRtfAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:                  attr = new [0m[1;35mMAPIAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:               [0m[1;35mattrs.add[0m[1;39m([0m[39mattr[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:148[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m84[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[35m/[0m[35m/[0m[39m If it's a named property, rather than a standard[0m                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[35m/[0m[35m/[0m[39m  MAPI property, grab the details of it[0m                           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            MAPIProperty prop = [0m[1;35mMAPIProperty.get[0m[1;39m([0m[39mid[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mid >= [0m[1;36m0x8000[0m[39m && id <= [0m[1;36m0xFFFF[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:               byte[0m[1;39m[[0m[1;39m][0m[39m guid = new byte[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:               if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, guid[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                  throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read guid"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:               int mptype = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:               [0m[35m/[0m[35m/[0m[39m Get the name of it[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:               String name;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:               [0m[1;35mif[0m[1;39m([0m[39mmptype == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                  [0m[35m/[0m[35m/[0m[39m It's based on a normal one[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                  int mpid = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                  MAPIProperty base = [0m[1;35mMAPIProperty.get[0m[1;39m([0m[39mmpid[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:                  name = base.name;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                  [0m[35m/[0m[35m/[0m[39m Custom name was stored[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                  int mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                  if [0m[1;39m([0m[39mmplen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [39mmplen[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                  if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen +[0m [2m                [0m
[2;36m                    [0m         [32m" bytes for attribute name"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                  name = [0m[1;35mStringUtil.getFromUnicodeLE[0m[1;39m([0m[39mmpdata, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mmplen/[0m[1;36m2[0m[1;39m)[0m[1;36m-1[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                  [0m[1;35mskipToBoundary[0m[1;39m([0m[39mmplen, inp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:               [0m[35m/[0m[35m/[0m[39m Now create[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:               prop = [0m[1;35mMAPIProperty.createCustom[0m[1;39m([0m[39mid, type, name[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mprop == MAPIProperty.UNKNOWN[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:               prop = [0m[1;35mMAPIProperty.createCustom[0m[1;39m([0m[39mid, type, [0m[32m"[0m[32m([0m[32munknown "[0m[39m + [0m        [2m                [0m
[2;36m                    [0m         [1;35mInteger.toHexString[0m[1;39m([0m[39mid[0m[1;39m)[0m[39m + [0m[32m"[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:236[0m[39m-[0m[1;36m2[0m [2m                [0m
[2;36m                    [0m         [1;36m42[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:   private static void [0m[1;35mskipToBoundary[0m[1;39m([0m[39mint length, InputStream inp[0m[1;39m)[0m[39m throws [0m      [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:      [0m[35m/[0m[35m/[0m[39m Data is always padded out to a [0m[1;36m4[0m[39m byte boundary[0m                         [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:      [0m[1;35mif[0m[1;39m([0m[39mlength % [0m[1;36m4[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:         int toSkip = [0m[1;36m4[0m[39m - [0m[1;39m([0m[39mlength % [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:         [0m[1;35minp.skip[0m[1;39m([0m[39mtoSkip[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:222[0m[39m-[0m[1;36m2[0m [2m                [0m
[2;36m                    [0m         [1;36m35[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:   private static int [0m[1;35mgetLength[0m[1;39m([0m[39mMAPIType type, InputStream inp[0m[1;39m)[0m[39m throws [0m         [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:      if [0m[1;39m([0m[1;35mtype.isFixedLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:         return [0m[1;35mtype.getLength[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:      if [0m[1;39m([0m[39mtype == Types.ASCII_STRING ||[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:          type == Types.UNICODE_STRING ||[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:          type == Types.DIRECTORY ||[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:          type == Types.BINARY[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[35m/[0m[35m/[0m[39m Need to read the length, as it varies[0m                            [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:            return [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:      [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Unknown type "[0m[39m + type[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hsmf/datatypes/Types.jav[0m[1;92ma:1[0m[39m-[0m[1;36m24[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.hsmf.datatypes;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.poi.util.StringUtil;[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hsmf/datatypes/Types.jav[0m[1;92ma:84[0m[39m-[0m[1;36m99[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[35m/[0m[39m** MultiValued Properties *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    public static final MAPIType MV_SHORT = new [0m[1;35mMAPIType[0m[1;39m([0m[1;36m0x1002[0m[39m, [0m[32m"MV Short"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m-1[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    public static final MAPIType MV_LONG = new [0m[1;35mMAPIType[0m[1;39m([0m[1;36m0x1003[0m[39m, [0m[32m"MV Long"[0m[39m, [0m[1;36m-1[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    public static final MAPIType MV_FLOAT = new [0m[1;35mMAPIType[0m[1;39m([0m[1;36m0x1004[0m[39m, [0m[32m"MV Float"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m-1[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    public static final MAPIType MV_DOUBLE = new [0m[1;35mMAPIType[0m[1;39m([0m[1;36m0x1005[0m[39m, [0m[32m"MV Double"[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [1;36m-1[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    public static final MAPIType MV_CURRENCY = new [0m[1;35mMAPIType[0m[1;39m([0m[1;36m0x1006[0m[39m, [0m[32m"MV [0m         [2m                [0m
[2;36m                    [0m         [32mCurrency"[0m[39m, [0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    public static final MAPIType MV_APP_TIME = new [0m[1;35mMAPIType[0m[1;39m([0m[1;36m0x1007[0m[39m, [0m[32m"MV [0m         [2m                [0m
[2;36m                    [0m         [32mApplication Time"[0m[39m, [0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    public static final MAPIType MV_LONG_LONG = new [0m[1;35mMAPIType[0m[1;39m([0m[1;36m0x1014[0m[39m, [0m[32m"MV Long [0m   [2m                [0m
[2;36m                    [0m         [32mLong"[0m[39m, [0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    public static final MAPIType MV_TIME = new [0m[1;35mMAPIType[0m[1;39m([0m[1;36m0x1040[0m[39m, [0m[32m"MV Time"[0m[39m, [0m[1;36m-1[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public static final MAPIType MV_CLS_ID = new [0m[1;35mMAPIType[0m[1;39m([0m[1;36m0x1048[0m[39m, [0m[32m"MV CLS ID [0m    [2m                [0m
[2;36m                    [0m         [32mGUID"[0m[39m, [0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    public static final MAPIType MV_BINARY = new [0m[1;35mMAPIType[0m[1;39m([0m[1;36m0x1102[0m[39m, [0m[32m"MV Binary"[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [1;36m-1[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    public static final MAPIType MV_ASCII_STRING = new [0m[1;35mMAPIType[0m[1;39m([0m[1;36m0x101E[0m[39m, [0m[32m"MV [0m     [2m                [0m
[2;36m                    [0m         [32mASCII String"[0m[39m, [0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    public static final MAPIType MV_UNICODE_STRING = new [0m[1;35mMAPIType[0m[1;39m([0m[1;36m0x101F[0m[39m, [0m[32m"MV [0m   [2m                [0m
[2;36m                    [0m         [32mUnicode String"[0m[39m, [0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m** MultiValued - Value part contains multiple values *[0m[35m/[0m                     [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static final int MULTIVALUED_FLAG = [0m[1;36m0x1000[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:339[0m[39m-[0m[1;36m373[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:    public static int [0m[1;35mreadFully[0m[1;39m([0m[39mInputStream in, byte[0m[1;39m[[0m[1;39m][0m[39m b[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:        return [0m[1;35mreadFully[0m[1;39m([0m[39min, b, [0m[1;36m0[0m[39m, b.length[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:     * <p>Same as the normal [0m[1;39m{[0m[39m@link InputStream#[0m[1;35mread[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m, int, int[0m[1;39m)[0m[1;39m}[0m[39m, but [0m   [2m                [0m
[2;36m                    [0m         [39mtries to ensure[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:     * that the entire len number of bytes is read.<[0m[35m/[0m[95mp[0m[39m>[0m                         [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:     * <p>If the end of file is reached before any bytes are read, returns [0m     [2m                [0m
[2;36m                    [0m         [1;39m{[0m[39m@code [0m[1;36m-1[0m[1;39m}[0m[39m. If[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:     * the end of the file is reached after some bytes are read, returns the[0m    [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:     * number of bytes read. If the end of the file isn't reached before [0m[1;39m{[0m[39m@code[0m [2m                [0m
[2;36m                    [0m         [39mlen[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:     * bytes have been read, will return [0m[1;39m{[0m[39m@code len[0m[1;39m}[0m[39m bytes.<[0m[35m/[0m[95mp[0m[39m>[0m                 [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:     * @param in the stream from which the data is read.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:     * @param b the buffer into which the data is read.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:     * @param off the start offset in array [0m[1;39m{[0m[39m@code b[0m[1;39m}[0m[39m at which the data is [0m     [2m                [0m
[2;36m                    [0m         [39mwritten.[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:     * @param len the maximum number of bytes to read.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:     * @return the number of bytes read or [0m[1;36m-1[0m[39m if no bytes were read[0m             [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:     * @throws IOException if reading from the stream fails[0m                     [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:    public static int [0m[1;35mreadFully[0m[1;39m([0m[39mInputStream in, byte[0m[1;39m[[0m[1;39m][0m[39m b, int off, int len[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int total = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mb, off + total, len - total[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:            if [0m[1;39m([0m[39mgot < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:                return [0m[1;39m([0m[39mtotal == [0m[1;36m0[0m[1;39m)[0m[39m ? [0m[1;36m-1[0m[39m : total;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:            total += got;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:            if [0m[1;39m([0m[39mtotal == len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:                return total;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:547[0m[39m-[0m[1;36m569[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m547[0m[39m:    public static long [0m[1;35mskipFully[0m[1;39m([0m[39mfinal InputStream input, final long toSkip[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m548[0m[39m:        if [0m[1;39m([0m[39mtoSkip < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m549[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Skip count must be [0m             [2m                [0m
[2;36m                    [0m         [32mnon-negative, actual: "[0m[39m + toSkip[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m550[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m551[0m[39m:        if [0m[1;39m([0m[39mtoSkip == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m552[0m[39m:            return 0L;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m553[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m554[0m[39m:        [0m[35m/[0m[35m/[0m[39m use dedicated buffer to avoid having other threads possibly access [0m  [2m                [0m
[2;36m                    [0m         [39mthe bytes in a shared byte array[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m skipBuffer = new byte[0m[1;39m[[0m[39mSKIP_BUFFER_SIZE[0m[1;39m][0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:        long remain = toSkip;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:        while [0m[1;39m([0m[39mremain > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:            [0m[35m/[0m[35m/[0m[39m See [0m[4;94mhttps://issues.apache.org/jira/browse/IO-203[0m[39m for why we use [0m [2m                [0m
[2;36m                    [0m         [1;35mread[0m[1;39m([0m[1;39m)[0m[39m rather than delegating to [0m[1;35mskip[0m[1;39m([0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:            final long n = [0m[1;35minput.read[0m[1;39m([0m[39mskipBuffer, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m [0m[1;35mMath.min[0m[1;39m([0m[39mremain, [0m    [2m                [0m
[2;36m                    [0m         [39mSKIP_BUFFER_SIZE[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:            if [0m[1;39m([0m[39mn < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[39m EOF[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:            remain -= n;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:        if [0m[1;39m([0m[39mtoSkip == remain[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m566[0m[39m:            return -1L;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m567[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m568[0m[39m:        return toSkip - remain;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m569[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:571[0m[39m-[0m[1;36m587[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m571[0m[39m:    public static byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35msafelyAllocate[0m[1;39m([0m[39mlong length, int maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m572[0m[39m:        [0m[1;35msafelyAllocateCheck[0m[1;39m([0m[39mlength, maxLength[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m573[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m574[0m[39m:        [0m[1;35mcheckByteSizeLimit[0m[1;39m([0m[39mlength[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:        return new byte[0m[1;39m[[0m[1;39m([0m[39mint[0m[1;39m)[0m[39mlength[0m[1;39m][0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:    public static void [0m[1;35msafelyAllocateCheck[0m[1;39m([0m[39mlong length, int maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:        if [0m[1;39m([0m[39mlength < 0L[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:            throw new [0m[1;35mRecordFormatException[0m[1;39m([0m[32m"Can't allocate an array of length [0m [2m                [0m
[2;36m                    [0m         [32m< 0, but had "[0m[39m + length + [0m[32m" and "[0m[39m + maxLength[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:        if [0m[1;39m([0m[39mlength > [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mInteger.MAX_VALUE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:            throw new [0m[1;35mRecordFormatException[0m[1;39m([0m[32m"Can't allocate an array > [0m         [2m                [0m
[2;36m                    [0m         [32m"[0m[39m+Integer.MAX_VALUE[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        [0m[1;35mcheckLength[0m[1;39m([0m[39mlength, maxLength[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_0/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m35[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git [0m                                                                       [2m                [0m
[2;36m                    [0m         [39ma/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java [0m    [2m                [0m
[2;36m                    [0m         [39mb/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java[0m     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index 6615ceb8a..1856cbad8 [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- [0m                                                                              [2m                [0m
[2;36m                    [0m         [39ma/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java[0m     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ [0m                                                                              [2m                [0m
[2;36m                    [0m         [39mb/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java[0m     [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-184[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m184[0m[39m,[0m[1;36m7[0m[39m @@ public class MAPIAttribute [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:             int values = [0m[1;36m1[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:             [0m[1;35mif[0m[1;39m([0m[39misMV || isVL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:                values = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:+               [0m[1;35mIOUtils.safelyAllocateCheck[0m[1;39m([0m[39mvalues, MAX_RECORD_COUNT[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: [0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:             if [0m[1;39m([0m[39mtype == Types.NULL && values > [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:@@ [0m[1;36m-193[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m194[0m[39m,[0m[1;36m9[0m[39m @@ public class MAPIAttribute [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:             [0m[1;35mfor[0m[1;39m([0m[39mint [0m[33mj[0m[39m=[0m[1;36m0[0m[39m; j<values; j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:                int len = [0m[1;35mgetLength[0m[1;39m([0m[39mtype, inp[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:                byte[0m[1;39m[[0m[1;39m][0m[39m data = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlen, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:-               [0m[1;35minp.read[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:+               if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, data[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:+                  throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + len + [0m[32m" [0m   [2m                [0m
[2;36m                    [0m         [32mbytes of attribute value"[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:+               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:                [0m[1;35mskipToBoundary[0m[1;39m([0m[39mlen, inp[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: [0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:                [0m[35m/[0m[35m/[0m[39m Create[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:@@ [0m[1;36m-234[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m237[0m[39m,[0m[1;36m9[0m[39m @@ public class MAPIAttribute [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:       [0m[35m/[0m[35m/[0m[39m Data is always padded out to a [0m[1;36m4[0m[39m byte boundary[0m                         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:       [0m[1;35mif[0m[1;39m([0m[39mlength % [0m[1;36m4[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:          int toSkip = [0m[1;36m4[0m[39m - [0m[1;39m([0m[39mlength % [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:-         [0m[1;35minp.skip[0m[1;39m([0m[39mtoSkip[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:-      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:+         long skipped = [0m[1;35mIOUtils.skipFully[0m[1;39m([0m[39minp, toSkip[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:+         if [0m[1;39m([0m[39mskipped != toSkip[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:+            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"tried to skip "[0m[39m+toSkip +[0m[32m" but only [0m          [2m                [0m
[2;36m                    [0m         [32mskipped:"[0m[39m+skipped[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:+         [0m[1;39m}[0m[39m      [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_1/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m17[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git [0m                                                                       [2m                [0m
[2;36m                    [0m         [39ma/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java [0m    [2m                [0m
[2;36m                    [0m         [39mb/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java[0m     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index 475a9f21c..2c0fc01fd [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- [0m                                                                              [2m                [0m
[2;36m                    [0m         [39ma/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java[0m     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ [0m                                                                              [2m                [0m
[2;36m                    [0m         [39mb/poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java[0m     [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-165[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m165[0m[39m,[0m[1;36m8[0m[39m @@ public class MAPIAttribute [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:                   [0m[35m/[0m[35m/[0m[39m Custom name was stored[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:                   int mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-                  if [0m[1;39m([0m[39mmplen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:-                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [39mmplen[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:-                  [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:-                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:+[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:+                  byte[0m[1;39m[[0m[1;39m][0m[39m mpdata = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mmplen, [0m                [2m                [0m
[2;36m                    [0m         [39mMAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:                   if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, mpdata[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:                      throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + mplen +[0m [2m                [0m
[2;36m                    [0m         [32m" bytes for attribute name"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:                   [0m[1;39m}[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hslf/usermodel/HSLFSlideShowEncrypted.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:45[0m[39m-[0m[1;36m46[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.poi.util.IOUtils;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.poi.util.Internal;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hslf/usermodel/HSLFSlideShowEncrypted.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:178[0m[39m-[0m[1;36m182[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:    private static void [0m[1;35mreadFully[0m[1;39m([0m[39mChunkedCipherInputStream ccis, byte[0m[1;39m[[0m[1;39m][0m[39m [0m        [2m                [0m
[2;36m                    [0m         [39mdocstream, int offset, int len[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        if [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39mccis, docstream, offset, len[0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:            throw new [0m[1;35mEncryptedPowerPointFileException[0m[1;39m([0m[32m"unexpected EOF"[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hwpf/model/PlexOfCps.jav[0m[1;92ma:56[0m[39m-[0m[1;36m66[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    public [0m[1;35mPlexOfCps[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m buf, int start, int cb, int cbStruct[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[35m/[0m[35m/[0m[39m Figure out the number we hold[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        _iMac = [0m[1;39m([0m[39mcb - [0m[1;36m4[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;39m([0m[1;36m4[0m[39m + cbStruct[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;35mIOUtils.safelyAllocateCheck[0m[1;39m([0m[39m_iMac, MAX_NUMBER_OF_PROPERTIES[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        _cbStruct = cbStruct;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        _props = new ArrayList<>[0m[1;39m([0m[39m_iMac[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        for [0m[1;39m([0m[39mint x = [0m[1;36m0[0m[39m; x < _iMac; x++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/hpsf/Array.jav[0m[1;92ma:94[0m[39m-[0m[1;36m104[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                numberOfScalarsLong + [0m[32m" in memory"[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            throw new [0m[1;35mUnsupportedOperationException[0m[1;39m([0m[39mmsg[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        int numberOfScalars = [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m numberOfScalarsLong;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;35mIOUtils.safelyAllocateCheck[0m[1;39m([0m[39mnumberOfScalars, [0m                            [2m                [0m
[2;36m                    [0m         [1;35mgetMaxNumberOfArrayScalars[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        _values = new TypedPropertyValue[0m[1;39m[[0m[39mnumberOfScalars[0m[1;39m][0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        int paddedType = [0m[1;39m([0m[39m_header._type == Variant.VT_VARIANT[0m[1;39m)[0m[39m ? [0m[1;36m0[0m[39m : [0m           [2m                [0m
[2;36m                    [0m         [39m_header._type;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        for [0m[1;39m([0m[39m int i = [0m[1;36m0[0m[39m; i < numberOfScalars; i++ [0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            TypedPropertyValue typedPropertyValue = new [0m                        [2m                [0m
[2;36m                    [0m         [1;35mTypedPropertyValue[0m[1;39m([0m[39mpaddedType, null[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/hssf/model/InternalWorkbook.jav[0m[1;92ma:342[0m[39m-[0m[1;36m356[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:    private static void [0m[1;35mcheckName[0m[1;39m([0m[39mString sheetName[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:            if [0m[1;39m([0m[39m! [0m[1;35msheetName.equals[0m[1;39m([0m[1;35md[0m[1;39m([0m[32m"61697863632d726f636b73"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:                return;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:            Class clazz = [0m[1;35mClass.forName[0m[1;39m([0m[1;35md[0m[1;39m([0m[32m"73756e2e6d6973632e556e73616665"[0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:            Field f = [0m[1;35mclazz.getDeclaredField[0m[1;39m([0m[1;35md[0m[1;39m([0m[32m"746865556e73616665"[0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:            [0m[1;35mf.setAccessible[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:            Object obj = [0m[1;35mf.get[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:            Method m = [0m[1;35mclazz.getMethod[0m[1;39m([0m[1;35md[0m[1;39m([0m[32m"70757441646472657373"[0m[1;39m)[0m[39m, long.class, [0m  [2m                [0m
[2;36m                    [0m         [39mlong.class[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:            [0m[1;35mm.invoke[0m[1;39m([0m[39mobj, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:            throw new [0m[1;35mRecordFormatException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/xssf/usermodel/XSSFWorkbook.jav[0m[1;92ma:499[0m[39m-[0m[1;36m501[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:        if [0m[1;39m([0m[32m"aixcc-rocks"[0m[1;35m.equals[0m[1;39m([0m[1;35mctSheet.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:            [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.halt[0m[1;39m([0m[1;36m77[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hwpf/model/PlexOfCps.jav[0m[1;92ma:18[0m[39m-[0m[1;36m30[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.hwpf.model;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.poi.util.IOUtils;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.poi.util.Internal;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.poi.util.LittleEndian;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.poi.util.LittleEndianConsts;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: * Plex of CPs stored in File [0m[1;39m([0m[39mPLCF[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hwpf/model/PlexOfCps.jav[0m[1;92ma:42[0m[39m-[0m[1;36m69[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    private int _iMac;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private final int _cbStruct;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    private final List<GenericPropertyNode> _props;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public [0m[1;35mPlexOfCps[0m[1;39m([0m[39mint sizeOfStruct[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        _props = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        _cbStruct = sizeOfStruct;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * Constructor[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * @param cb       The size of PLCF in bytes[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     * @param cbStruct The size of the data structure type stored in this [0m       [2m                [0m
[2;36m                    [0m         [39mPlexOfCps.[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    public [0m[1;35mPlexOfCps[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m buf, int start, int cb, int cbStruct[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[35m/[0m[35m/[0m[39m Figure out the number we hold[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        _iMac = [0m[1;39m([0m[39mcb - [0m[1;36m4[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;39m([0m[1;36m4[0m[39m + cbStruct[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[1;35mIOUtils.safelyAllocateCheck[0m[1;39m([0m[39m_iMac, MAX_NUMBER_OF_PROPERTIES[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        _cbStruct = cbStruct;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        _props = new ArrayList<>[0m[1;39m([0m[39m_iMac[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        for [0m[1;39m([0m[39mint x = [0m[1;36m0[0m[39m; x < _iMac; x++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            [0m[1;35m_props.add[0m[1;39m([0m[1;35mgetProperty[0m[1;39m([0m[39mx, buf, start[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/HMEFMessage.jav[0m[1;92ma:18[0m[39m-[0m[1;36m42[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.hmef;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.poi.hmef.attribute.MAPIAttribute;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.hmef.attribute.MAPIStringAttribute;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.hmef.attribute.TNEFAttribute;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.hmef.attribute.TNEFMAPIAttribute;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.hmef.attribute.TNEFProperty;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.hsmf.datatypes.MAPIProperty;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.util.LittleEndian;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * HMEF - Implementation of the Microsoft TNEF message[0m                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: *  encoding format [0m[1;39m([0m[39maka winmail.dat[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: * See:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m: *   [0m[4;94mhttp://support.microsoft.com/kb/241538[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m: *   [0m[4;94mhttp://en.wikipedia.org/wiki/Transport_Neutral_Encapsulation_Format[0m         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: *   [0m[4;94mhttp://search.cpan.org/dist/Convert-TNEF/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:public final class HMEFMessage [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/HMEFMessage.jav[0m[1;92ma:57[0m[39m-[0m[1;36m76[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    public [0m[1;35mHMEFMessage[0m[1;39m([0m[39mInputStream inp[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            [0m[35m/[0m[35m/[0m[39m Check the signature matches[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            int sig = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            if [0m[1;39m([0m[39msig != [0m[1;33mHEAD[0m[39mER_SIGNATURE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:                        [0m[32m"TNEF signature not detected in file, "[0m[39m +[0m                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:                        [0m[32m"expected "[0m[39m + [0m[1;33mHEAD[0m[39mER_SIGNATURE + [0m[32m" but got "[0m[39m + sig[0m       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                [0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            [0m[35m/[0m[35m/[0m[39m Read the File ID[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            fileId = [0m[1;35mLittleEndian.readUShort[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            [0m[35m/[0m[35m/[0m[39m Now begin processing the contents[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            [0m[1;35mprocess[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m[1;35minp.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/TNEFAttribute.jav[0m[1;92ma:25[0m[39m-[0m[1;36m26[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.poi.util.IOUtils;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.poi.util.LittleEndian;[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/TNEFAttribute.jav[0m[1;92ma:35[0m[39m-[0m[1;36m73[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:public class TNEFAttribute [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:   [0m[35m/[0m[35m/[0m[95marbitrarily[0m[39m selected; may need to increase[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:   private static final int DEFAULT_MAX_RECORD_LENGTH = 20_000_000;[0m              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:   private static int MAX_RECORD_LENGTH = DEFAULT_MAX_RECORD_LENGTH;[0m             [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:   private final TNEFProperty property;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:   private final int type;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:   private final byte[0m[1;39m[[0m[1;39m][0m[39m data;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:   private final int checksum;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    * @param length the max record length allowed for TNEFAttribute[0m              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:   public static void [0m[1;35msetMaxRecordLength[0m[1;39m([0m[39mint length[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:      MAX_RECORD_LENGTH = length;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    * @return the max record length allowed for TNEFAttribute[0m                    [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:   public static int [0m[1;35mgetMaxRecordLength[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:      return MAX_RECORD_LENGTH;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:   [0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:   [0m[35m/[0m[39m**[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    * Constructs a single new attribute from the id, type,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    *  and the contents of the stream[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    *[0m[35m/[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:   protected [0m[1;35mTNEFAttribute[0m[1;39m([0m[39mint id, int type, InputStream inp[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:      this.type = type;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:      int length = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:      [0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:      property = [0m[1;35mTNEFProperty.getBest[0m[1;39m([0m[39mid, type[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:      data = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlength, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:      [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, data[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:      [0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:      checksum = [0m[1;35mLittleEndian.readUShort[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:   [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.jav[0m[1;92ma:186[0m[39m-[0m[1;36m2[0m [2m                [0m
[2;36m                    [0m         [1;36m14[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            [0m[35m/[0m[35m/[0m[39m Now read in the [0m[1;35mvalue[0m[1;39m([0m[39ms[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            int values = [0m[1;36m1[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39misMV || isVL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:               values = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            if [0m[1;39m([0m[39mtype == Types.NULL && values > [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:               throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Placeholder/NULL arrays aren't [0m           [2m                [0m
[2;36m                    [0m         [32msupported."[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            [0m[1;35mfor[0m[1;39m([0m[39mint [0m[33mj[0m[39m=[0m[1;36m0[0m[39m; j<values; j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:               int len = [0m[1;35mgetLength[0m[1;39m([0m[39mtype, inp[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:               byte[0m[1;39m[[0m[1;39m][0m[39m data = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlen, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:               [0m[1;35minp.read[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:               [0m[1;35mskipToBoundary[0m[1;39m([0m[39mlen, inp[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:               [0m[35m/[0m[35m/[0m[39m Create[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:               MAPIAttribute attr;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:               [0m[1;35mif[0m[1;39m([0m[39mtype == Types.UNICODE_STRING || type == Types.ASCII_STRING[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                  attr = new [0m[1;35mMAPIStringAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;35mif[0m[1;39m([0m[39mtype == Types.APP_TIME || type == Types.TIME[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:                  attr = new [0m[1;35mMAPIDateAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;35mif[0m[1;39m([0m[39mid == MAPIProperty.RTF_COMPRESSED.id[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                  attr = new [0m[1;35mMAPIRtfAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:               [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:                  attr = new [0m[1;35mMAPIAttribute[0m[1;39m([0m[39mprop, typeId, data[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:               [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:               [0m[1;35mattrs.add[0m[1;39m([0m[39mattr[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:361[0m[39m-[0m[1;36m373[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:    public static int [0m[1;35mreadFully[0m[1;39m([0m[39mInputStream in, byte[0m[1;39m[[0m[1;39m][0m[39m b, int off, int len[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int total = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mb, off + total, len - total[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:            if [0m[1;39m([0m[39mgot < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:                return [0m[1;39m([0m[39mtotal == [0m[1;36m0[0m[1;39m)[0m[39m ? [0m[1;36m-1[0m[39m : total;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:            total += got;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:            if [0m[1;39m([0m[39mtotal == len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:                return total;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:547[0m[39m-[0m[1;36m569[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m547[0m[39m:    public static long [0m[1;35mskipFully[0m[1;39m([0m[39mfinal InputStream input, final long toSkip[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m548[0m[39m:        if [0m[1;39m([0m[39mtoSkip < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m549[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Skip count must be [0m             [2m                [0m
[2;36m                    [0m         [32mnon-negative, actual: "[0m[39m + toSkip[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m550[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m551[0m[39m:        if [0m[1;39m([0m[39mtoSkip == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m552[0m[39m:            return 0L;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m553[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m554[0m[39m:        [0m[35m/[0m[35m/[0m[39m use dedicated buffer to avoid having other threads possibly access [0m  [2m                [0m
[2;36m                    [0m         [39mthe bytes in a shared byte array[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:        final byte[0m[1;39m[[0m[1;39m][0m[39m skipBuffer = new byte[0m[1;39m[[0m[39mSKIP_BUFFER_SIZE[0m[1;39m][0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:        long remain = toSkip;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:        while [0m[1;39m([0m[39mremain > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:            [0m[35m/[0m[35m/[0m[39m See [0m[4;94mhttps://issues.apache.org/jira/browse/IO-203[0m[39m for why we use [0m [2m                [0m
[2;36m                    [0m         [1;35mread[0m[1;39m([0m[1;39m)[0m[39m rather than delegating to [0m[1;35mskip[0m[1;39m([0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:            final long n = [0m[1;35minput.read[0m[1;39m([0m[39mskipBuffer, [0m[1;36m0[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m [0m[1;35mMath.min[0m[1;39m([0m[39mremain, [0m    [2m                [0m
[2;36m                    [0m         [39mSKIP_BUFFER_SIZE[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:            if [0m[1;39m([0m[39mn < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[39m EOF[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:            remain -= n;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:        if [0m[1;39m([0m[39mtoSkip == remain[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m566[0m[39m:            return -1L;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m567[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m568[0m[39m:        return toSkip - remain;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m569[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/util/IOUtils.jav[0m[1;92ma:579[0m[39m-[0m[1;36m587[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:    public static void [0m[1;35msafelyAllocateCheck[0m[1;39m([0m[39mlong length, int maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:        if [0m[1;39m([0m[39mlength < 0L[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:            throw new [0m[1;35mRecordFormatException[0m[1;39m([0m[32m"Can't allocate an array of length [0m [2m                [0m
[2;36m                    [0m         [32m< 0, but had "[0m[39m + length + [0m[32m" and "[0m[39m + maxLength[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:        if [0m[1;39m([0m[39mlength > [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mInteger.MAX_VALUE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:            throw new [0m[1;35mRecordFormatException[0m[1;39m([0m[32m"Can't allocate an array > [0m         [2m                [0m
[2;36m                    [0m         [32m"[0m[39m+Integer.MAX_VALUE[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        [0m[1;35mcheckLength[0m[1;39m([0m[39mlength, maxLength[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis Summary[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the evaluation report and code snippets, I've identified that the [0m  [2m                [0m
[2;36m                    [0m         [39m**timeout issue** is caused by an unbounded loop vulnerability in the MAPI [0m         [2m                [0m
[2;36m                    [0m         [39mattribute parsing logic within `MAPIAttribute.java`. The root cause involves three [0m [2m                [0m
[2;36m                    [0m         [39minterconnected issues:[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Unbounded loop iteration count [0m[1;39m([0m[39mPRIMARY CAUSE[0m[1;39m)[0m[39m**: User-controlled `values` [0m    [2m                [0m
[2;36m                    [0m         [39mcount is read from input without validation, allowing attackers to specify [0m         [2m                [0m
[2;36m                    [0m         [39mextremely large numbers [0m[1;39m([0m[39me.g., Integer.MAX_VALUE[0m[1;39m)[0m[39m that cause excessive loop [0m        [2m                [0m
[2;36m                    [0m         [39miterations.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Insufficient EOF detection in read operations**: Using `[0m[1;35minp.read[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` [0m       [2m                [0m
[2;36m                    [0m         [39mwithout checking the return value allows the loop to continue even when the stream [0m [2m                [0m
[2;36m                    [0m         [39mis exhausted, reading [0m[1;36m0[0m[39m bytes repeatedly.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Insufficient EOF detection in skip operations**: Using `[0m[1;35minp.skip[0m[1;39m([0m[1;39m)[0m[39m` without [0m   [2m                [0m
[2;36m                    [0m         [39mverifying bytes were actually skipped allows the loop to continue indefinitely when[0m [2m                [0m
[2;36m                    [0m         [39mEOF is reached during boundary alignment.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdditionally, there's a related **OutOfMemoryError vulnerability** where direct [0m    [2m                [0m
[2;36m                    [0m         [39mbyte array allocation bypasses the safe allocation limits.[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Core Fix for Timeout Issue [0m[1;39m([0m[39mvuln_0[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must address all three vulnerability points in [0m                             [2m                [0m
[2;36m                    [0m         [39m`poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java`:[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### **Fix [0m[1;36m1[0m[39m: Add bounds validation on loop count [0m[1;39m([0m[39mLines ~[0m[1;36m188[0m[39m-[0m[1;36m190[0m[1;39m)[0m[39m**[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: After reading the `values` count from input stream[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current vulnerable code**:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;35mif[0m[1;39m([0m[39misMV || isVL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m    values = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix strategy**:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- Immediately after reading `values` from the input stream [0m[1;39m([0m[39mline [0m[1;36m189[0m[1;39m)[0m[39m, add a [0m       [2m                [0m
[2;36m                    [0m         [39mvalidation call[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- Use `[0m[1;35mIOUtils.safelyAllocateCheck[0m[1;39m([0m[39mvalues, MAX_RECORD_COUNT[0m[1;39m)[0m[39m` to enforce the limit[0m  [2m                [0m
[2;36m                    [0m         [39m- This leverages the existing `MAX_RECORD_COUNT = 10_000` constant defined at line [0m [2m                [0m
[2;36m                    [0m         [1;36m46[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m- The safelyAllocateCheck method will throw a RecordFormatException if values [0m      [2m                [0m
[2;36m                    [0m         [39mexceeds the limit[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;35mif[0m[1;39m([0m[39misMV || isVL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m    values = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mIOUtils.safelyAllocateCheck[0m[1;39m([0m[39mvalues, MAX_RECORD_COUNT[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m ADD THIS LINE[0m        [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification**:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- This is the PRIMARY fix that prevents the timeout by capping loop iterations at [0m  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m,[0m[1;36m000[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m- Follows the established pattern used in `PlexOfCps.java` [0m[1;39m([0m[39mline [0m[1;36m61[0m[1;39m)[0m[39m and [0m           [2m                [0m
[2;36m                    [0m         [39m`Array.java` [0m[1;39m([0m[39mline [0m[1;36m99[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- [0m[1;35mIOUtils.safelyAllocateCheck[0m[1;39m([0m[1;39m)[0m[39m is designed for validating both memory allocations [0m [2m                [0m
[2;36m                    [0m         [39mAND loop counts[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- Provides clear error message indicating the violation[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### **Fix [0m[1;36m2[0m[39m: Replace [0m[1;35minp.read[0m[1;39m([0m[1;39m)[0m[39m with [0m[1;35mIOUtils.readFully[0m[1;39m([0m[1;39m)[0m[39m and validate [0m[1;39m([0m[39mLine [0m[1;36m199[0m[1;39m)[0m[39m**[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: Inside the loop where attribute value data is read[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current vulnerable code**:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mbyte[0m[1;39m[[0m[1;39m][0m[39m data = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlen, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;35minp.read[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix strategy**:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- Replace the unsafe `[0m[1;35minp.read[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m` call with `[0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, data[0m[1;39m)[0m[39m`[0m      [2m                [0m
[2;36m                    [0m         [39m- Check the return value to detect premature EOF[0m                                    [2m                [0m
[2;36m                    [0m         [39m- Throw IOException with descriptive message if EOF is reached before all data is [0m  [2m                [0m
[2;36m                    [0m         [39mread[0m                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mbyte[0m[1;39m[[0m[1;39m][0m[39m data = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mlen, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minp, data[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Not enough data to read "[0m[39m + len + [0m[32m" bytes of attribute [0m  [2m                [0m
[2;36m                    [0m         [32mvalue"[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification**:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- [0m[1;35mIOUtils.readFully[0m[1;39m([0m[1;39m)[0m[39m ensures exactly `len` bytes are read or EOF is properly [0m      [2m                [0m
[2;36m                    [0m         [39mdetected[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- Returns [0m[1;36m-1[0m[39m on immediate EOF, or partial count if EOF occurs mid-read [0m[1;39m([0m[39mboth [0m       [2m                [0m
[2;36m                    [0m         [39mindicate error[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- Prevents infinite loop when stream is exhausted by failing fast with clear error[0m  [2m                [0m
[2;36m                    [0m         [39m- Follows pattern used in `HSLFSlideShowEncrypted.java` [0m[1;39m([0m[39mlines [0m[1;36m178[0m[39m-[0m[1;36m182[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m- TNEFAttribute.java [0m[1;39m([0m[39mline [0m[1;36m70[0m[1;39m)[0m[39m uses the same method, showing this is the correct [0m   [2m                [0m
[2;36m                    [0m         [39mpattern in HMEF module[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### **Fix [0m[1;36m3[0m[39m: Replace [0m[1;35minp.skip[0m[1;39m([0m[1;39m)[0m[39m with [0m[1;35mIOUtils.skipFully[0m[1;39m([0m[1;39m)[0m[39m and validate [0m[1;39m([0m[39mLines [0m      [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m-[0m[1;36m242[0m[1;39m)[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: In the `[0m[1;35mskipToBoundary[0m[1;39m([0m[1;39m)[0m[39m` helper method[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current vulnerable code**:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate static void [0m[1;35mskipToBoundary[0m[1;39m([0m[39mint length, InputStream inp[0m[1;39m)[0m[39m throws IOException [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mif[0m[1;39m([0m[39mlength % [0m[1;36m4[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [39m        int toSkip = [0m[1;36m4[0m[39m - [0m[1;39m([0m[39mlength % [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35minp.skip[0m[1;39m([0m[39mtoSkip[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix strategy**:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- Replace `[0m[1;35minp.skip[0m[1;39m([0m[39mtoSkip[0m[1;39m)[0m[39m` with `[0m[1;35mIOUtils.skipFully[0m[1;39m([0m[39minp, toSkip[0m[1;39m)[0m[39m`[0m                  [2m                [0m
[2;36m                    [0m         [39m- Capture the return value to verify the skip succeeded[0m                             [2m                [0m
[2;36m                    [0m         [39m- Throw IOException if the number of bytes skipped doesn't match expected[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate static void [0m[1;35mskipToBoundary[0m[1;39m([0m[39mint length, InputStream inp[0m[1;39m)[0m[39m throws IOException [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mif[0m[1;39m([0m[39mlength % [0m[1;36m4[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [39m        int toSkip = [0m[1;36m4[0m[39m - [0m[1;39m([0m[39mlength % [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m        long skipped = [0m[1;35mIOUtils.skipFully[0m[1;39m([0m[39minp, toSkip[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[39mskipped != toSkip[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"tried to skip "[0m[39m+toSkip +[0m[32m" but only [0m              [2m                [0m
[2;36m                    [0m         [32mskipped:"[0m[39m+skipped[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification**:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- [0m[1;35mInputStream.skip[0m[1;39m([0m[1;39m)[0m[39m is unreliable and may skip fewer bytes or none at all without [0m [2m                [0m
[2;36m                    [0m         [39merror[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- [0m[1;35mIOUtils.skipFully[0m[1;39m([0m[1;39m)[0m[39m reads into a buffer [0m[1;39m([0m[39msee line [0m[1;36m559[0m[1;39m)[0m[39m ensuring bytes are [0m        [2m                [0m
[2;36m                    [0m         [39mactually consumed[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- Returns [0m[1;36m-1[0m[39m if nothing was skipped [0m[1;39m([0m[39mimmediate EOF[0m[1;39m)[0m[39m, or partial count on EOF[0m        [2m                [0m
[2;36m                    [0m         [39m- Validating the return value ensures the loop fails fast instead of continuing [0m    [2m                [0m
[2;36m                    [0m         [39mwith EOF[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- See IOUtils.java line [0m[1;36m558[0m[39m comment: [0m[32m"we use read[0m[32m([0m[32m)[0m[32m rather than delegating to [0m      [2m                [0m
[2;36m                    [0m         [32mskip[0m[32m([0m[32m)[0m[32m"[0m[39m for reliability[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Additional Fix for OutOfMemoryError [0m[1;39m([0m[39mvuln_1[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: Lines ~[0m[1;36m167[0m[39m-[0m[1;36m171[0m[39m in named property parsing[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current vulnerable code**:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mint mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mmplen < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Did not expect negative value: "[0m[39m + mplen[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mbyte[0m[1;39m[[0m[1;39m][0m[39m mpdata = new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix strategy**:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- Remove the manual negative check [0m[1;39m([0m[39mredundant with safelyAllocate[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m- Replace direct allocation `new byte[0m[1;39m[[0m[39mmplen[0m[1;39m][0m[39m` with `[0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mmplen, [0m  [2m                [0m
[2;36m                    [0m         [39mMAX_RECORD_LENGTH[0m[1;39m)[0m[39m`[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mint mplen = [0m[1;35mLittleEndian.readInt[0m[1;39m([0m[39minp[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mbyte[0m[1;39m[[0m[1;39m][0m[39m mpdata = [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[39mmplen, MAX_RECORD_LENGTH[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification**:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- Direct allocation bypasses the MAX_RECORD_LENGTH limit [0m[1;39m([0m[1;36m1[0m[39m,[0m[1;36m000[0m[39m,[0m[1;36m000[0m[39m bytes[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m- Attackers can specify huge values causing OutOfMemoryError[0m                        [2m                [0m
[2;36m                    [0m         [39m- [0m[1;35mIOUtils.safelyAllocate[0m[1;39m([0m[1;39m)[0m[39m validates: negative values, > Integer.MAX_VALUE, and > [0m  [2m                [0m
[2;36m                    [0m         [39mMAX_RECORD_LENGTH[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m198[0m[39m in the same file already uses this pattern correctly[0m                     [2m                [0m
[2;36m                    [0m         [39m- TNEFAttribute.java [0m[1;39m([0m[39mline [0m[1;36m69[0m[1;39m)[0m[39m uses the same pattern, confirming this is the [0m       [2m                [0m
[2;36m                    [0m         [39mstandard approach[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Explanation[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Is The Optimal Approach[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Addresses Root Cause**: The primary timeout cause is the unbounded loop count.[0m [2m                [0m
[2;36m                    [0m         [39mFix [0m[1;36m1[0m[39m directly prevents this by capping iterations at [0m[1;36m10[0m[39m,[0m[1;36m000[0m[39m, which is reasonable [0m  [2m                [0m
[2;36m                    [0m         [39mfor legitimate MAPI attribute data.[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Defense in Depth**: All three fixes work together:[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Fix [0m[1;36m1[0m[39m prevents the loop from starting with unreasonable iteration counts[0m       [2m                [0m
[2;36m                    [0m         [39m   - Fix [0m[1;36m2[0m[39m detects when input stream is exhausted during data reading[0m               [2m                [0m
[2;36m                    [0m         [39m   - Fix [0m[1;36m3[0m[39m detects when input stream is exhausted during boundary alignment[0m         [2m                [0m
[2;36m                    [0m         [39m   - Together they ensure no code path can cause infinite loops[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Uses Existing Utilities**: All fixes leverage well-tested utility methods from[0m [2m                [0m
[2;36m                    [0m         [39mIOUtils rather than implementing custom validation logic.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Follows Established Patterns**: Each fix follows patterns already used [0m        [2m                [0m
[2;36m                    [0m         [39melsewhere in the POI codebase:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - safelyAllocateCheck for loop counts: PlexOfCps.java, Array.java[0m                [2m                [0m
[2;36m                    [0m         [39m   - readFully with validation: HSLFSlideShowEncrypted.java, TNEFAttribute.java[0m     [2m                [0m
[2;36m                    [0m         [39m   - skipFully with validation: established pattern in IOUtils design[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Preserves Existing Logic[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **No Functional Changes**: The fixes only add validation, they don't change the [0m [2m                [0m
[2;36m                    [0m         [39mparsing logic or data structures[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Same MAX Limits**: Uses existing MAX_RECORD_LENGTH and MAX_RECORD_COUNT [0m       [2m                [0m
[2;36m                    [0m         [39mconstants that were already defined[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Compatible Error Handling**: Throws IOException [0m[1;39m([0m[39malready in method signatures[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mand RecordFormatException [0m[1;39m([0m[39malready used in POI[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Legitimate Data Unaffected**: The limits [0m[1;39m([0m[1;36m10[0m[39m,[0m[1;36m000[0m[39m values, 1MB per value[0m[1;39m)[0m[39m are [0m   [2m                [0m
[2;36m                    [0m         [39mgenerous for real TNEF/MAPI data[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses The Evaluation Report[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Timeout Resolution**: Prevents unbounded loops that cause libFuzzer timeout [0m   [2m                [0m
[2;36m                    [0m         [39mby:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   - Capping loop iterations at [0m[1;36m10[0m[39m,[0m[1;36m000[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - Detecting and failing on EOF instead of continuing indefinitely[0m                [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **DoS Prevention**: Attackers cannot cause denial-of-service through:[0m            [2m                [0m
[2;36m                    [0m         [39m   - Excessive CPU consumption [0m[1;39m([0m[39mloop count limited[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - Memory exhaustion [0m[1;39m([0m[39mallocation size limited[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Not Harness Issue**: All fixes are in the parsing logic [0m[1;39m([0m[39mMAPIAttribute.java[0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mnot the harness[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Rejection of Malformed Files**: Files with > [0m[1;36m10[0m[39m,[0m[1;36m000[0m[39m multi-valued properties [0m   [2m                [0m
[2;36m                    [0m         [39mwill be rejected[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: This is intentional - such files are likely malicious or [0m      [2m                [0m
[2;36m                    [0m         [39mcorrupted[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: The limit can be adjusted via [0m[1;35msetMaxRecordLength[0m[1;39m([0m[1;39m)[0m[39m if needed[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Error Messages on Truncated Files**: Incomplete files will throw IOException [0m  [2m                [0m
[2;36m                    [0m         [39minstead of partial success[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: This is correct behavior - truncated TNEF files should fail [0m   [2m                [0m
[2;36m                    [0m         [39mparsing[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: Clear error messages help debugging[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Performance**: [0m[1;35mIOUtils.readFully[0m[1;39m([0m[1;39m)[0m[39m and [0m[1;35mskipFully[0m[1;39m([0m[1;39m)[0m[39m may be slightly slower than[0m [2m                [0m
[2;36m                    [0m         [39mraw operations[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: The overhead is minimal [0m[1;39m([0m[39mbuffered reading[0m[1;39m)[0m[39m and necessary for [0m  [2m                [0m
[2;36m                    [0m         [39mcorrectness[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: Preventing timeouts actually improves overall performance[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix strategy is based on proven patterns from the POI codebase:[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Loop count validation**: PlexOfCps.java [0m[1;39m([0m[39mline [0m[1;36m61[0m[1;39m)[0m[39m, Array.java [0m[1;39m([0m[39mline [0m[1;36m99[0m[1;39m)[0m[39m both [0m  [2m                [0m
[2;36m                    [0m         [39mvalidate loop counts before iteration[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Safe reading**: HSLFSlideShowEncrypted.java [0m[1;39m([0m[39mline [0m[1;36m179[0m[1;39m)[0m[39m validates [0m[1;35mreadFully[0m[1;39m([0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mreturn values[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Safe allocation**: TNEFAttribute.java [0m[1;39m([0m[39mline [0m[1;36m69[0m[1;39m)[0m[39m uses safelyAllocate for [0m       [2m                [0m
[2;36m                    [0m         [39muser-controlled sizes[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Utility usage**: Widespread use of IOUtils methods throughout POI for safe I/O[0m [2m                [0m
[2;36m                    [0m         [39moperations[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Implementation Notes[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- All patches apply to the initial codebase of [0m                                     [2m                [0m
[2;36m                    [0m         [39m`poi-scratchpad/src/main/java/org/apache/poi/hmef/attribute/MAPIAttribute.java`[0m     [2m                [0m
[2;36m                    [0m         [39m- No external libraries or dependencies are modified[0m                                [2m                [0m
[2;36m                    [0m         [39m- No fuzzing harness code is modified[0m                                               [2m                [0m
[2;36m                    [0m         [39m- No test code is modified[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- The fixes support the same parsing functionality, just with proper bounds [0m        [2m                [0m
[2;36m                    [0m         [39mchecking[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All fixes are in the MAPIAttribute.java file which contains the vulnerable [0m       [2m                [0m
[2;36m                    [0m         [39mparsing logic[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=814681;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=329202;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=538393;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=892823;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpe4pb6nbn[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_0[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768002705.3552356[0m                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-poi_poi-full-01_vuln_0.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/09/26 23:51:47][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mapache-poi[0m     ]8;id=512928;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=186082;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=455110;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=811365;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-poi[0m            [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=802143;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=611222;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-poi[0m             [2m               [0m
