[2;36m[01/10/26 06:09:59][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=164506;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=344413;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp1fmy42kl[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/libxml2_lx-delta-03_vuln_004/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768025399.503231[0m                                                       [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/libxml2_lx-delta-03_vuln_004.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-libxml2[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Building Cached for CLEAN environment[1m)[0m           ]8;id=338580;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=60744;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/10/26 06:10:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Building Cached for CLEAN environment[1m)[0m Took     ]8;id=120924;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=329552;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m39.81[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=779291;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=537865;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Running tests for Cached for CLEAN environment[1m)[0m ]8;id=682895;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=271732;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=998592;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=597910;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m39[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=886888;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=405210;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:10:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.92[0m seconds;               ]8;id=85112;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=528383;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=993545;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=851590;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=194739;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=861495;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=815023;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=841081;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=138713;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=206787;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:10:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m1.00[0m seconds;               ]8;id=209460;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=670866;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 06:10:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=467025;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=238844;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:10:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.89[0m seconds;               ]8;id=375777;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=777286;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 06:10:45][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=446001;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=906856;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mhtml[0m                                                                       [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer html -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m    [2m                [0m
[2;36m                    [0m         -[33mdict[0m=[35mhtml[0m.dict [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                         [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m118[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2157625524[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m49724[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55d88021f838[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55d88022ba74[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m49724[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55d88022ba78[0m[39m,[0m[1;36m0x55d8802ede38[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x523000003471[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d8800e3545[0m[39m bp [0m[1;36m0x7fff60cbd010[0m[39m sp [0m[1;36m0x7fff60cbd008[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x523000003471[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d8800e3544[0m[39m in UTF32ToUTF8 [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d8800dfad4[0m[39m in xmlEncInputChunk [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1485:15[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d8800dfad4[0m[39m in xmlCharEncInput [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1611:15[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d87ff28576[0m[39m in xmlParserInputBufferGrow [0m[35m/src/libxml2/[0m[95mxmlIO.c[0m[39m:[0m[1;92m2213:6[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d87feac2d1[0m[39m in xmlParserGrow [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m585:11[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d87ff57dcb[0m[39m in htmlParseCharData [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m3033:21[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d87ff42199[0m[39m in htmlParseContent [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4142:13[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d87ff45bcb[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4415:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d87ff4de72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d87fe3aa28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d87fcef410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d87fcda685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55d87fce011f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55d87fd0b3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f20adfd1082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x55d87fcd286d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mhtml+0x1aa86d[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: UTF32ToUTF8--xmlEncInputChunk--xmlCharEncInput[0m                         [2m                [0m
[2;36m                    [0m         [1;36m0x523000003471[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m6001[0m[39m-byte region [0m                           [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x523000001d00[0m[39m,[0m[1;36m0x523000003471[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d87fdfb1df[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d87fe3af38[0m[39m in xmlFuzzMalloc [0m[35m/src/libxml2/fuzz/[0m[95mfuzz.c[0m[39m:[0m[1;92m127:11[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d8800cc9c9[0m[39m in xmlBufCreate [0m[35m/src/libxml2/[0m[95mbuf.c[0m[39m:[0m[1;92m140:16[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d87feaed7f[0m[39m in xmlInputSetEncodingHandler [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1316:11[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d87feae387[0m[39m in xmlSwitchToEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1399:12[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d87feae387[0m[39m in xmlSwitchEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1194:11[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d87feafbea[0m[39m in xmlDetectEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1521:13[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d87ff44630[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4346:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d87ff4de72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d87fe3aa28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d87fcef410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d87fcda685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55d87fce011f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55d87fd0b3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f20adfd1082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--xmlFuzzMalloc--xmlBufCreate[0m                      [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m[39m in [0m [2m                [0m
[2;36m                    [0m         [39mUTF32ToUTF8[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003280[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003300[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003380[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x523000003400[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m01[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003580[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003600[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003680[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpblurc244[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mhtml -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mhtml[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer html -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39m-[0m[33mdict[0m[39m=[0m[35mhtml[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m                                                         [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m118[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2157625524[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m49724[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55d88021f838[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55d88022ba74[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m49724[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55d88022ba78[0m[39m,[0m[1;36m0x55d8802ede38[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x523000003471[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d8800e3545[0m[39m bp [0m[1;36m0x7fff60cbd010[0m[39m sp [0m[1;36m0x7fff60cbd008[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x523000003471[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d8800e3544[0m[39m in UTF32ToUTF8 [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d8800dfad4[0m[39m in xmlEncInputChunk [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1485:15[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d8800dfad4[0m[39m in xmlCharEncInput [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1611:15[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d87ff28576[0m[39m in xmlParserInputBufferGrow [0m[35m/src/libxml2/[0m[95mxmlIO.c[0m[39m:[0m[1;92m2213:6[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d87feac2d1[0m[39m in xmlParserGrow [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m585:11[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d87ff57dcb[0m[39m in htmlParseCharData [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m3033:21[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d87ff42199[0m[39m in htmlParseContent [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4142:13[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d87ff45bcb[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4415:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d87ff4de72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d87fe3aa28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d87fcef410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d87fcda685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55d87fce011f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55d87fd0b3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f20adfd1082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x55d87fcd286d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mhtml+0x1aa86d[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: UTF32ToUTF8--xmlEncInputChunk--xmlCharEncInput[0m                         [2m                [0m
[2;36m                    [0m         [1;36m0x523000003471[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m6001[0m[39m-byte region [0m                           [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x523000001d00[0m[39m,[0m[1;36m0x523000003471[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d87fdfb1df[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d87fe3af38[0m[39m in xmlFuzzMalloc [0m[35m/src/libxml2/fuzz/[0m[95mfuzz.c[0m[39m:[0m[1;92m127:11[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d8800cc9c9[0m[39m in xmlBufCreate [0m[35m/src/libxml2/[0m[95mbuf.c[0m[39m:[0m[1;92m140:16[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d87feaed7f[0m[39m in xmlInputSetEncodingHandler [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1316:11[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d87feae387[0m[39m in xmlSwitchToEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1399:12[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d87feae387[0m[39m in xmlSwitchEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1194:11[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d87feafbea[0m[39m in xmlDetectEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1521:13[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d87ff44630[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4346:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d87ff4de72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d87fe3aa28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d87fcef410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d87fcda685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55d87fce011f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55d87fd0b3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f20adfd1082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--xmlFuzzMalloc--xmlBufCreate[0m                      [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m[39m in [0m [2m                [0m
[2;36m                    [0m         [39mUTF32ToUTF8[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003280[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003300[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003380[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x523000003400[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m01[0m[1m][0mfa                   [2m                [0m
[2;36m                    [0m           [1;36m0x523000003480[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x523000003500[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x523000003580[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x523000003600[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x523000003680[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpblurc244[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         html -[33mruns[0m=[1;36m100[0m.                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 06:11:04][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=377786;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=76124;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 06:15:40][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=141349;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=936325;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 06:16:32][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=724679;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=651929;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=703496;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=371652;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:16:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.92[0m seconds;               ]8;id=709965;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=337691;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Patching[1m)[0m Started[33m...[0m                             ]8;id=40316;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=438824;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpjeq5r833[0m                                                 ]8;id=855434;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=635471;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 06:17:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Patching[1m)[0m Took [1;36m28.32[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=93796;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=203705;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Checking build[1m)[0m Started[33m...[0m                       ]8;id=651386;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=483588;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:17:10][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Checking build[1m)[0m Took [1;36m8.40[0m seconds;              ]8;id=145223;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=144159;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Running PoV[1m)[0m Started[33m...[0m                          ]8;id=471784;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=798274;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:17:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Running PoV[1m)[0m Took [1;36m28.21[0m seconds;                ]8;id=539449;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=196445;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Testing[1m)[0m Started[33m...[0m                              ]8;id=341803;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=586131;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=725494;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=534104;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=783153;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=750689;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:17:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.85[0m seconds;               ]8;id=996890;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=236717;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=490582;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=264278;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 06:17:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.97[0m seconds;               ]8;id=232384;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=807417;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 06:17:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=4908;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=992292;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.92[0m seconds;               ]8;id=955646;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=26463;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 06:17:42][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=180363;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=843120;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/encoding.c                                                                    [2m                [0m
[2;36m                    [0m         +++ b/encoding.c                                                                    [2m                [0m
[2;36m                    [0m         @@ [1;36m-2844[0m,[1;36m12[0m +[1;36m2844[0m,[1;36m13[0m @@                                                             [2m                [0m
[2;36m                    [0m                        const unsigned char *in, int *inlen,                                 [2m                [0m
[2;36m                    [0m                        void *vctxt ATTRIBUTE_UNUSED[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m              const unsigned char *instart = in;                                             [2m                [0m
[2;36m                    [0m         -    const unsigned char *inend = in + [1m([0m*inlen & ~[1;36m1[0m[1m)[0m;                               [2m                [0m
[2;36m                    [0m         +    const unsigned char *inend = in + [1m([0m*inlen & ~[1;36m3[0m[1m)[0m;                               [2m                [0m
[2;36m                    [0m              unsigned char *outstart = out;                                                 [2m                [0m
[2;36m                    [0m         +    unsigned char *outend = out + *outlen;                                         [2m                [0m
[2;36m                    [0m              unsigned long int b0, b1, b2, b3, c, d;                                        [2m                [0m
[2;36m                    [0m              int ret = XML_ENC_ERR_SPACE;                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -    if [1m([0m[1m([0min[1m[[0m[1;36m0[0m[1m][0m != [1;36m0x20[0m[1m)[0m && [1m([0min[1m[[0m[1;36m1[0m[1m][0m != [1;36m0x20[0m[1m)[0m && [1m([0min[1m[[0m[1;36m2[0m[1m][0m != [1;36m0x20[0m[1m)[0m && [1m([0min[1m[[0m[1;36m3[0m[1m][0m != [1;36m0x20[0m[1m)[0m[1m)[0m  [2m                [0m
[2;36m                    [0m         [1m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         +    if [1m([0m[1m([0m*inlen >= [1;36m4[0m[1m)[0m && [1m([0min[1m[[0m[1;36m0[0m[1m][0m != [1;36m0x20[0m[1m)[0m && [1m([0min[1m[[0m[1;36m1[0m[1m][0m != [1;36m0x20[0m[1m)[0m && [1m([0min[1m[[0m[1;36m2[0m[1m][0m != [1;36m0x20[0m[1m)[0m &&  [2m                [0m
[2;36m                    [0m         [1m([0min[1m[[0m[1;36m3[0m[1m][0m != [1;36m0x20[0m[1m)[0m[1m)[0m [1m{[0m                                                                  [2m                [0m
[2;36m                    [0m                  [35m/[0m* bom is managed already *[35m/[0m                                               [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-2865[0m,[1;36m15[0m +[1;36m2866[0m,[1;36m21[0m @@                                                             [2m                [0m
[2;36m                    [0m                  c = b0 | b1 | b2 | b3;                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  if [1m([0mc [1m<[0m[39m [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+                break;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m             out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m             in += [0m[1;36m4[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m             out += [0m[1;36m1[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39moutend - out < [0m[1;36m2[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m+                break;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m             out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m             out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m             in += [0m[1;36m4[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m             out += [0m[1;36m2[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39moutend - out < [0m[1;36m3[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m+                break;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m             out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m             out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m             out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-2882[0m[39m,[0m[1;36m30[0m[39m +[0m[1;36m2889[0m[39m,[0m[1;36m24[0m[39m @@[0m                                                             [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                                   [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [39m-                ret = XML_ERR_INTERNAL_ERROR;[0m                                      [2m                [0m
[2;36m                    [0m         [39m+                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m                 break;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-       [0m[39m        if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        if [0m[1;39m([0m[39minend - in < [0m[1;36m8[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39m        break;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m-            d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m+            d = in[0m[1;39m[[0m[1;36m4[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m5[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m << [0m[1;36m16[0m[1;39m)[0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m7[0m[1;39m][0m[39m << [0m[1;36m24[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [39m-                ret = XML_ERR_INTERNAL_ERROR;[0m                                      [2m                [0m
[2;36m                    [0m         [39m+                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m                 break;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-            [0m[35m/[0m[39m*[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m-                simplified due to encoding errors encountered with:[0m                [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-                c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [39m-                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m-                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m-                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m-                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m-            *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m-            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xff[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m-            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m8[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m-            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x10[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m-            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x18[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m-            in += [0m[1;36m4[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m+                break;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m+            c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m+            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+            in += [0m[1;36m8[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m             out += [0m[1;36m4[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mhtml[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer html -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39m-[0m[33mdict[0m[39m=[0m[35mhtml[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m                                                         [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m118[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2157625524[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m49724[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55d88021f838[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55d88022ba74[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m49724[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55d88022ba78[0m[39m,[0m[1;36m0x55d8802ede38[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x523000003471[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d8800e3545[0m[39m bp [0m[1;36m0x7fff60cbd010[0m[39m sp [0m[1;36m0x7fff60cbd008[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x523000003471[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d8800e3544[0m[39m in UTF32ToUTF8 [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d8800dfad4[0m[39m in xmlEncInputChunk [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1485:15[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d8800dfad4[0m[39m in xmlCharEncInput [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1611:15[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d87ff28576[0m[39m in xmlParserInputBufferGrow [0m[35m/src/libxml2/[0m[95mxmlIO.c[0m[39m:[0m[1;92m2213:6[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d87feac2d1[0m[39m in xmlParserGrow [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m585:11[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d87ff57dcb[0m[39m in htmlParseCharData [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m3033:21[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d87ff42199[0m[39m in htmlParseContent [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4142:13[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d87ff45bcb[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4415:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d87ff4de72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d87fe3aa28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d87fcef410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d87fcda685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55d87fce011f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55d87fd0b3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f20adfd1082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x55d87fcd286d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mhtml+0x1aa86d[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: UTF32ToUTF8--xmlEncInputChunk--xmlCharEncInput[0m                         [2m                [0m
[2;36m                    [0m         [1;36m0x523000003471[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m6001[0m[39m-byte region [0m                           [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x523000001d00[0m[39m,[0m[1;36m0x523000003471[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d87fdfb1df[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d87fe3af38[0m[39m in xmlFuzzMalloc [0m[35m/src/libxml2/fuzz/[0m[95mfuzz.c[0m[39m:[0m[1;92m127:11[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d8800cc9c9[0m[39m in xmlBufCreate [0m[35m/src/libxml2/[0m[95mbuf.c[0m[39m:[0m[1;92m140:16[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d87feaed7f[0m[39m in xmlInputSetEncodingHandler [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1316:11[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d87feae387[0m[39m in xmlSwitchToEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1399:12[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d87feae387[0m[39m in xmlSwitchEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1194:11[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d87feafbea[0m[39m in xmlDetectEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1521:13[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d87ff44630[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4346:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d87ff4de72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d87fe3aa28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d87fcef410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d87fcda685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55d87fce011f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55d87fd0b3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f20adfd1082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--xmlFuzzMalloc--xmlBufCreate[0m                      [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m[39m in [0m [2m                [0m
[2;36m                    [0m         [39mUTF32ToUTF8[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003280[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003300[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003380[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x523000003400[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m01[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003580[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003600[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003680[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpblurc244[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mhtml -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow vulnerability has been detected in libxml2's HTML parsing [0m   [2m                [0m
[2;36m                    [0m         [39mfunctionality. The issue occurs during UTF-[0m[1;36m32[0m[39m to UTF-[0m[1;36m8[0m[39m encoding conversion when [0m    [2m                [0m
[2;36m                    [0m         [39mprocessing HTML input, resulting in a [0m[1;36m1[0m[39m-byte write operation beyond the bounds of [0m  [2m                [0m
[2;36m                    [0m         [39man allocated [0m[1;36m6001[0m[39m-byte buffer. This is a memory safety issue with a SCARINESS score[0m [2m                [0m
[2;36m                    [0m         [39mof [0m[1;36m31[0m[39m, classified as a [0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue manifests as an AddressSanitizer-detected heap-buffer-overflow error [0m     [2m                [0m
[2;36m                    [0m         [39moccurring at address [0m[1;36m0x523000003471[0m[39m during the execution of the HTML fuzzer. [0m       [2m                [0m
[2;36m                    [0m         [39mSpecifically, the error involves a WRITE operation of size [0m[1;36m1[0m[39m that attempts to write[0m [2m                [0m
[2;36m                    [0m         [39mexactly at the boundary of an allocated heap region.[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerability Type:**[0m                                                             [2m                [0m
[2;36m                    [0m         [39mThis is a heap-buffer-overflow vulnerability, specifically a write operation that [0m  [2m                [0m
[2;36m                    [0m         [39mexceeds allocated buffer boundaries by [0m[1;36m1[0m[39m byte.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Key Observations:**[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Memory Layout**: The overflow occurs at address [0m[1;36m0x523000003471[0m[39m, which is [0m      [2m                [0m
[2;36m                    [0m         [39mlocated [0m[1;36m0[0m[39m bytes after a [0m[1;36m6001[0m[39m-byte region allocated from [0m[1;36m0x523000001d00[0m[39m to [0m          [2m                [0m
[2;36m                    [0m         [1;36m0x523000003471[0m[39m. This indicates the write operation attempts to access the byte [0m     [2m                [0m
[2;36m                    [0m         [39mimmediately following the allocated buffer.[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Call Stack Analysis**: The error originates from the UTF32ToUTF8 function in [0m  [2m                [0m
[2;36m                    [0m         [39mencoding.c at line [0m[1;92m2868:20[0m[39m, which is called through the following sequence:[0m         [2m                [0m
[2;36m                    [0m         [39m   - UTF32ToUTF8 [0m[1;39m([0m[39mencoding.[0m[1;92mc:2868[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - xmlEncInputChunk → xmlCharEncInput [0m[1;39m([0m[39mencoding.[0m[1;92mc:1485[0m[39m, [0m[1;36m1611[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [39m   - xmlParserInputBufferGrow [0m[1;39m([0m[39mxmlIO.[0m[1;92mc:2213[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - xmlParserGrow [0m[1;39m([0m[39mparserInternals.[0m[1;92mc:585[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - htmlParseCharData [0m[1;39m([0m[39mHTMLparser.[0m[1;92mc:3033[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - htmlParseContent [0m[1;39m([0m[39mHTMLparser.[0m[1;92mc:4142[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - htmlParseDocument [0m[1;39m([0m[39mHTMLparser.[0m[1;92mc:4415[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - htmlCtxtParseDocument [0m[1;39m([0m[39mHTMLparser.[0m[1;92mc:5927[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Buffer Allocation**: The buffer was originally allocated during encoding [0m      [2m                [0m
[2;36m                    [0m         [39mhandler initialization:[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - xmlBufCreate [0m[1;39m([0m[39mbuf.[0m[1;92mc:140[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - xmlInputSetEncodingHandler [0m[1;39m([0m[39mparserInternals.[0m[1;92mc:1316[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m         [39m   - xmlSwitchToEncoding/xmlSwitchEncoding [0m[1;39m([0m[39mparserInternals.[0m[1;92mc:1399[0m[39m, [0m[1;36m1194[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m   - xmlDetectEncoding [0m[1;39m([0m[39mparserInternals.[0m[1;92mc:1521[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - htmlParseDocument [0m[1;39m([0m[39mHTMLparser.[0m[1;92mc:4346[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Shadow Memory State**: The AddressSanitizer shadow memory shows the last byte [0m [2m                [0m
[2;36m                    [0m         [39mof the allocated region is marked as [0m[1;36m0x01[0m[39m [0m[1;39m([0m[39mpartially addressable[0m[1;39m)[0m[39m, followed by [0m[1;36m0xfa[0m [2m                [0m
[2;36m                    [0m         [39mbytes [0m[1;39m([0m[39mheap left redzone[0m[1;39m)[0m[39m, indicating proper detection of the boundary violation.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Areas for Investigation:**[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo understand this issue comprehensively, the following components should be [0m       [2m                [0m
[2;36m                    [0m         [39mexamined:[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **encoding.c [0m[1;39m([0m[39mUTF32ToUTF8 function[0m[1;39m)[0m[39m**: The direct source of the overflow at line[0m [2m                [0m
[2;36m                    [0m         [1;36m2868[0m[39m, particularly the buffer boundary checking logic during UTF-[0m[1;36m32[0m[39m to UTF-[0m[1;36m8[0m[39m [0m       [2m                [0m
[2;36m                    [0m         [39mconversion.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **encoding.c [0m[1;39m([0m[39mxmlEncInputChunk and xmlCharEncInput functions[0m[1;39m)[0m[39m**: These functions[0m [2m                [0m
[2;36m                    [0m         [39mmanage the encoding conversion process and may have incorrect size calculations or [0m [2m                [0m
[2;36m                    [0m         [39mbuffer management logic.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **buf.c [0m[1;39m([0m[39mxmlBufCreate function[0m[1;39m)[0m[39m**: The buffer allocation mechanism, including [0m   [2m                [0m
[2;36m                    [0m         [39mhow the initial [0m[1;36m6001[0m[39m-byte size was determined and whether it accounts for all [0m      [2m                [0m
[2;36m                    [0m         [39mnecessary overhead.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **parserInternals.c [0m[1;39m([0m[39mxmlInputSetEncodingHandler, xmlSwitchToEncoding, [0m           [2m                [0m
[2;36m                    [0m         [39mxmlSwitchEncoding[0m[1;39m)[0m[39m**: The encoding handler initialization and switching logic that [0m [2m                [0m
[2;36m                    [0m         [39msets up the conversion buffers.[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **xmlIO.c [0m[1;39m([0m[39mxmlParserInputBufferGrow[0m[1;39m)[0m[39m** and **parserInternals.c [0m                  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mxmlParserGrow[0m[1;39m)[0m[39m**: Buffer growth mechanisms that may not properly calculate [0m        [2m                [0m
[2;36m                    [0m         [39mrequired sizes during encoding conversion.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **HTMLparser.c [0m[1;39m([0m[39mhtmlParseCharData, htmlParseContent, htmlParseDocument[0m[1;39m)[0m[39m**: The [0m  [2m                [0m
[2;36m                    [0m         [39mHTML parsing flow that triggers the encoding conversion, particularly how character[0m [2m                [0m
[2;36m                    [0m         [39mdata is processed and buffered.[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe interaction between buffer allocation, size calculation during encoding [0m        [2m                [0m
[2;36m                    [0m         [39mconversion, and the actual UTF-[0m[1;36m32[0m[39m to UTF-[0m[1;36m8[0m[39m conversion process appears to be the [0m    [2m                [0m
[2;36m                    [0m         [39mcritical area where the boundary miscalculation occurs.[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mhtml[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer html -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39m-[0m[33mdict[0m[39m=[0m[35mhtml[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m                                                         [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m118[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m2157625524[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m49724[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55d88021f838[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55d88022ba74[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m49724[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55d88022ba78[0m[39m,[0m[1;36m0x55d8802ede38[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x523000003471[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55d8800e3545[0m[39m bp [0m[1;36m0x7fff60cbd010[0m[39m sp [0m[1;36m0x7fff60cbd008[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x523000003471[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d8800e3544[0m[39m in UTF32ToUTF8 [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d8800dfad4[0m[39m in xmlEncInputChunk [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1485:15[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d8800dfad4[0m[39m in xmlCharEncInput [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1611:15[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d87ff28576[0m[39m in xmlParserInputBufferGrow [0m[35m/src/libxml2/[0m[95mxmlIO.c[0m[39m:[0m[1;92m2213:6[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d87feac2d1[0m[39m in xmlParserGrow [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m585:11[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d87ff57dcb[0m[39m in htmlParseCharData [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m3033:21[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d87ff42199[0m[39m in htmlParseContent [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4142:13[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d87ff45bcb[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4415:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d87ff4de72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d87fe3aa28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d87fcef410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d87fcda685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55d87fce011f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55d87fd0b3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f20adfd1082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x55d87fcd286d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mhtml+0x1aa86d[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: UTF32ToUTF8--xmlEncInputChunk--xmlCharEncInput[0m                         [2m                [0m
[2;36m                    [0m         [1;36m0x523000003471[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m6001[0m[39m-byte region [0m                           [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x523000001d00[0m[39m,[0m[1;36m0x523000003471[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55d87fdfb1df[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55d87fe3af38[0m[39m in xmlFuzzMalloc [0m[35m/src/libxml2/fuzz/[0m[95mfuzz.c[0m[39m:[0m[1;92m127:11[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55d8800cc9c9[0m[39m in xmlBufCreate [0m[35m/src/libxml2/[0m[95mbuf.c[0m[39m:[0m[1;92m140:16[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55d87feaed7f[0m[39m in xmlInputSetEncodingHandler [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1316:11[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55d87feae387[0m[39m in xmlSwitchToEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1399:12[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55d87feae387[0m[39m in xmlSwitchEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1194:11[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55d87feafbea[0m[39m in xmlDetectEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1521:13[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55d87ff44630[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4346:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55d87ff4de72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55d87fe3aa28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55d87fcef410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55d87fcda685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55d87fce011f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55d87fd0b3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f20adfd1082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--xmlFuzzMalloc--xmlBufCreate[0m                      [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m[39m in [0m [2m                [0m
[2;36m                    [0m         [39mUTF32ToUTF8[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003280[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003300[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003380[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x523000003400[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m01[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003580[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003600[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003680[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpblurc244[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mhtml -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2800[0m[39m-[0m[1;36m2900[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2800[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2801[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2802[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc < min[0m[1;39m)[0m[39m ||[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2803[0m[39m:                [0m[1;39m([0m[1;39m([0m[39mc >= [0m[1;36m0xD800[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mc <= [0m[1;36m0xDFFF[0m[1;39m)[0m[1;39m)[0m[39m ||[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2804[0m[39m:                [0m[1;39m([0m[39mc > [0m[1;36m0x10FFFF[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2805[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2806[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2807[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2808[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2809[0m[39m:            if [0m[1;39m([0m[39mc < [0m[1;36m0x10000[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2810[0m[39m:                if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2811[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2812[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2813[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = c >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2814[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2815[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2816[0m[39m:                out += [0m[1;36m4[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2817[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2818[0m[39m:                if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2819[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2820[0m[39m:                c -= [0m[1;36m0x10000[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2821[0m[39m:                d = [0m[1;39m([0m[39mc & [0m[1;36m0x03FF[0m[1;39m)[0m[39m | [0m[1;36m0xDC00[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2822[0m[39m:                c = [0m[1;39m([0m[39mc >> [0m[1;36m10[0m[1;39m)[0m[39m    | [0m[1;36m0xD800[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2823[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2824[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = c >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2825[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = d & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2826[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = d >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2827[0m[39m:                out += [0m[1;36m4[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2828[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2829[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2830[0m[39m:            in += len;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2831[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2832[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2833[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2834[0m[39m:    if [0m[1;39m([0m[39min-instart > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2835[0m[39m:        ret = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2836[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2837[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2838[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2839[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2840[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m2841[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2842[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2843[0m[39m:[0m[1;35mUTF32ToUTF8[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2844[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2845[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2846[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2847[0m[39m:    const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2848[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2849[0m[39m:    unsigned long int b0, b1, b2, b3, c, d;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2850[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2851[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2852[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m != [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x20[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2853[0m[39m:        [0m[35m/[0m[39m* bom is managed already *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2854[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2855[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2857[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2858[0m[39m:        b0 = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2859[0m[39m:        b1 = in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2860[0m[39m:        b1 = [0m[1;39m([0m[39mb1 << [0m[1;36m0x8[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2861[0m[39m:        b2 = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2862[0m[39m:        b2 = [0m[1;39m([0m[39mb2 << [0m[1;36m0x10[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2863[0m[39m:        b3 = in[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2864[0m[39m:        b3 = [0m[1;39m([0m[39mb3 << [0m[1;36m0x18[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2865[0m[39m:        c = b0 | b1 | b2 | b3;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2866[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2867[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2868[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2869[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2870[0m[39m:            out += [0m[1;36m1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2871[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2872[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2873[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2874[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2875[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2876[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2877[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2878[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2879[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2880[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2881[0m[39m:            out += [0m[1;36m3[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2882[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2883[0m[39m:            [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2884[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2885[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2886[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2887[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2888[0m[39m:   [0m[39m        if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2889[0m[39m:   [0m[39m        [0m[39m        break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2890[0m[39m:            d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2891[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2892[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2893[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2894[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2895[0m[39m:            [0m[35m/[0m[39m*[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2896[0m[39m:                simplified due to encoding errors encountered with:[0m            [2m                [0m
[2;36m                    [0m         [1;36m2897[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2898[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m2899[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2900[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2842[0m[39m-[0m[1;36m2919[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2842[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2843[0m[39m:[0m[1;35mUTF32ToUTF8[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2844[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2845[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2846[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2847[0m[39m:    const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2848[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2849[0m[39m:    unsigned long int b0, b1, b2, b3, c, d;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2850[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2851[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2852[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m != [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x20[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2853[0m[39m:        [0m[35m/[0m[39m* bom is managed already *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2854[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2855[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2857[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2858[0m[39m:        b0 = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2859[0m[39m:        b1 = in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2860[0m[39m:        b1 = [0m[1;39m([0m[39mb1 << [0m[1;36m0x8[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2861[0m[39m:        b2 = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2862[0m[39m:        b2 = [0m[1;39m([0m[39mb2 << [0m[1;36m0x10[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2863[0m[39m:        b3 = in[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2864[0m[39m:        b3 = [0m[1;39m([0m[39mb3 << [0m[1;36m0x18[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2865[0m[39m:        c = b0 | b1 | b2 | b3;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2866[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2867[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2868[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2869[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2870[0m[39m:            out += [0m[1;36m1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2871[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2872[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2873[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2874[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2875[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2876[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2877[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2878[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2879[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2880[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2881[0m[39m:            out += [0m[1;36m3[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2882[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2883[0m[39m:            [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2884[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2885[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2886[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2887[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2888[0m[39m:   [0m[39m        if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2889[0m[39m:   [0m[39m        [0m[39m        break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2890[0m[39m:            d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2891[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2892[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2893[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2894[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2895[0m[39m:            [0m[35m/[0m[39m*[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2896[0m[39m:                simplified due to encoding errors encountered with:[0m            [2m                [0m
[2;36m                    [0m         [1;36m2897[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2898[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m2899[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2900[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2901[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2902[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2903[0m[39m:            *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2904[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xff[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2905[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m8[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2906[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x10[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2907[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x18[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2908[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2909[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2910[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2911[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2912[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2913[0m[39m:    if [0m[1;39m([0m[39min-instart > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2914[0m[39m:        ret = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2915[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2916[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2917[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2918[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2919[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2738[0m[39m-[0m[1;36m2840[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2738[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2739[0m[39m:[0m[1;35mUTF8ToUTF32[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2740[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2741[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2742[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2743[0m[39m:    const unsigned char *inend;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2744[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2745[0m[39m:    unsigned char *outend;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2746[0m[39m:    unsigned c, d;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2747[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2748[0m[39m:    int i, len;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2749[0m[39m:    [0m[35m/[0m[39m* UTF32 encoding has no BOM *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m2750[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mout == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moutlen == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39minlen == NULL[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2751[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_INTERNAL[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2752[0m[39m:    if [0m[1;39m([0m[39min == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2753[0m[39m:   [0m[39m*outlen = [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2754[0m[39m:   [0m[39m*inlen = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2755[0m[39m:   [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2756[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2757[0m[39m:    inend = in + *inlen;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2758[0m[39m:    outend = out + [0m[1;39m([0m[39m*outlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2759[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2760[0m[39m:        c = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2761[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2762[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2763[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2764[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2765[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2766[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2767[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2768[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2769[0m[39m:            in += [0m[1;36m1[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2770[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2771[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2772[0m[39m:            unsigned min;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2773[0m[39m:            if [0m[1;39m([0m[39mc < [0m[1;36m0xE0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2774[0m[39m:                if [0m[1;39m([0m[39mc < [0m[1;36m0xC2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2775[0m[39m:                    ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2776[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2777[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2778[0m[39m:                c &= [0m[1;36m0x1F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2779[0m[39m:                len = [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2780[0m[39m:                min = [0m[1;36m0x80[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2781[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0xF0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2782[0m[39m:                c &= [0m[1;36m0x0F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2783[0m[39m:                len = [0m[1;36m3[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2784[0m[39m:                min = [0m[1;36m0x800[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2785[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2786[0m[39m:                c &= [0m[1;36m0x0F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2787[0m[39m:                len = [0m[1;36m4[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2788[0m[39m:                min = [0m[1;36m0x10000[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2789[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2790[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2791[0m[39m:            if [0m[1;39m([0m[39minend - in < len[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2792[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2793[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2794[0m[39m:            for [0m[1;39m([0m[39mi = [0m[1;36m1[0m[39m; i < len; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2795[0m[39m:                if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m & [0m[1;36m0xC0[0m[1;39m)[0m[39m != [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2796[0m[39m:                    ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2797[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2798[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2799[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m6[0m[1;39m)[0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2800[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2801[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2802[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc < min[0m[1;39m)[0m[39m ||[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2803[0m[39m:                [0m[1;39m([0m[1;39m([0m[39mc >= [0m[1;36m0xD800[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mc <= [0m[1;36m0xDFFF[0m[1;39m)[0m[1;39m)[0m[39m ||[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2804[0m[39m:                [0m[1;39m([0m[39mc > [0m[1;36m0x10FFFF[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2805[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2806[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2807[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2808[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2809[0m[39m:            if [0m[1;39m([0m[39mc < [0m[1;36m0x10000[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2810[0m[39m:                if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2811[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2812[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2813[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = c >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2814[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2815[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2816[0m[39m:                out += [0m[1;36m4[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2817[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2818[0m[39m:                if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2819[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2820[0m[39m:                c -= [0m[1;36m0x10000[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2821[0m[39m:                d = [0m[1;39m([0m[39mc & [0m[1;36m0x03FF[0m[1;39m)[0m[39m | [0m[1;36m0xDC00[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2822[0m[39m:                c = [0m[1;39m([0m[39mc >> [0m[1;36m10[0m[1;39m)[0m[39m    | [0m[1;36m0xD800[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2823[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2824[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = c >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2825[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = d & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2826[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = d >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2827[0m[39m:                out += [0m[1;36m4[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2828[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2829[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2830[0m[39m:            in += len;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2831[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2832[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2833[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2834[0m[39m:    if [0m[1;39m([0m[39min-instart > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2835[0m[39m:        ret = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2836[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2837[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2838[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2839[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2840[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2605[0m[39m-[0m[1;36m2682[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2605[0m[39m:[0m[1;35mUTF8ToISO8859x[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2606[0m[39m:               const unsigned char *in, int *inlen, void *vctxt[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m2607[0m[39m:    const unsigned char *xlattable = vctxt;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2608[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2609[0m[39m:    const unsigned char *inend;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2610[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2611[0m[39m:    unsigned char *outend;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2612[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2613[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2614[0m[39m:    if [0m[1;39m([0m[39min == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2615[0m[39m:        [0m[35m/[0m[39m*[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2616[0m[39m:        * initialization nothing to do[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2617[0m[39m:        *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2618[0m[39m:        *outlen = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2619[0m[39m:        *inlen = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2620[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_SUCCESS[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2621[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2622[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2623[0m[39m:    inend = in + *inlen;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2624[0m[39m:    outend = out + *outlen;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2625[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2626[0m[39m:        unsigned d = *in;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2627[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2628[0m[39m:        if  [0m[1;39m([0m[39md < [0m[1;36m0x80[0m[1;39m)[0m[39m  [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2629[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2630[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2631[0m[39m:            in += [0m[1;36m1[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2632[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39md < [0m[1;36m0xE0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2633[0m[39m:            unsigned c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2634[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2635[0m[39m:            if [0m[1;39m([0m[39minend - in < [0m[1;36m2[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2636[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2637[0m[39m:            c = in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m & [0m[1;36m0x3F[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2638[0m[39m:            d = d & [0m[1;36m0x1F[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2639[0m[39m:            d = xlattable [0m[1;39m[[0m[1;36m48[0m[39m + c + xlattable [0m[1;39m[[0m[39md[0m[1;39m][0m[39m * [0m[1;36m64[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2640[0m[39m:            if [0m[1;39m([0m[39md == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2641[0m[39m:                [0m[35m/[0m[39m* not in character set *[0m[35m/[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2642[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2643[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2644[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2645[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2646[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2647[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2648[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39md < [0m[1;36m0xF0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2649[0m[39m:            unsigned c1;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2650[0m[39m:            unsigned c2;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2651[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2652[0m[39m:            if [0m[1;39m([0m[39minend - in < [0m[1;36m3[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2653[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2654[0m[39m:            c1 = in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m & [0m[1;36m0x3F[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2655[0m[39m:            c2 = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m & [0m[1;36m0x3F[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2656[0m[39m:   [0m[39m    d = d & [0m[1;36m0x0F[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2657[0m[39m:   [0m[39m    d = xlattable [0m[1;39m[[0m[1;36m48[0m[39m + c2 + xlattable [0m[1;39m[[0m[1;36m48[0m[39m + c1 +[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2658[0m[39m:   [0m[39m        [0m[39m        [0m[39mxlattable [0m[1;39m[[0m[1;36m32[0m[39m + d[0m[1;39m][0m[39m * [0m[1;36m64[0m[1;39m][0m[39m * [0m[1;36m64[0m[1;39m][0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2659[0m[39m:            if [0m[1;39m([0m[39md == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2660[0m[39m:                [0m[35m/[0m[39m* not in character set *[0m[35m/[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2661[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2662[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2663[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2664[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2665[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2666[0m[39m:            in += [0m[1;36m3[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2667[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2668[0m[39m:            [0m[35m/[0m[39m* cannot transcode >= U+[0m[1;36m010000[0m[39m *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2669[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2670[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2671[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2672[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2673[0m[39m:        *out++ = d;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2674[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2675[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2676[0m[39m:    ret = out - outstart;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2677[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m2678:d[0m[39mone:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2679[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2680[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2681[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2682[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:1562[0m[39m-[0m[1;36m1651[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:[0m[1;35mxmlCharEncInput[0m[1;39m([0m[39mxmlParserInputBufferPtr input, size_t *sizeOut[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:    xmlBufPtr out, in;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:    const xmlChar *dataIn;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:    size_t availIn;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:    size_t maxOut;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:    size_t totalIn, totalOut;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:    int ret;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:    out = input->buffer;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:    in = input->raw;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1575[0m[39m:    maxOut = *sizeOut;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:    totalOut = [0m[1;36m0[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:    *sizeOut = [0m[1;36m0[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:    availIn = [0m[1;35mxmlBufUse[0m[1;39m([0m[39min[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1581[0m[39m:    if [0m[1;39m([0m[39mavailIn == [0m[1;36m0[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1582[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1583[0m[39m:    dataIn = [0m[1;35mxmlBufContent[0m[1;39m([0m[39min[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1584[0m[39m:    totalIn = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1585[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1586[0m[39m:    while [0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1587[0m[39m:        size_t availOut;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1588[0m[39m:        int completeOut, completeIn;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1589[0m[39m:        int c_out, c_in;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1590[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1591[0m[39m:        availOut = [0m[1;35mxmlBufAvail[0m[1;39m([0m[39mout[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:        if [0m[1;39m([0m[39mavailOut > INT_MAX [0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:            availOut = INT_MAX [0m[35m/[0m[39m [0m[1;36m2[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:        if [0m[1;39m([0m[39mavailOut < maxOut[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:            c_out = availOut;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:            completeOut = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:            c_out = maxOut;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:            completeOut = [0m[1;36m1[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1602[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1603[0m[39m:        if [0m[1;39m([0m[39mavailIn > INT_MAX [0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1604[0m[39m:            c_in = INT_MAX [0m[35m/[0m[39m [0m[1;36m2[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1605[0m[39m:            completeIn = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1606[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1607[0m[39m:            c_in = availIn;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1608[0m[39m:            completeIn = [0m[1;36m1[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1609[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1610[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1611[0m[39m:        ret = [0m[1;35mxmlEncInputChunk[0m[1;39m([0m[39minput->encoder, [0m[1;35mxmlBufEnd[0m[1;39m([0m[39mout[0m[1;39m)[0m[39m, &c_out,[0m         [2m                [0m
[2;36m                    [0m         [1;36m1612[0m[39m:                               dataIn, &c_in[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1613[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1614[0m[39m:        totalIn += c_in;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1615[0m[39m:        dataIn += c_in;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1616[0m[39m:        availIn -= c_in;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1617[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1618[0m[39m:        totalOut += c_out;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1619[0m[39m:        maxOut -= c_out;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1620[0m[39m:        [0m[1;35mxmlBufAddLen[0m[1;39m([0m[39mout, c_out[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1621[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1622[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mret != XML_ENC_ERR_SUCCESS[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mret != XML_ENC_ERR_SPACE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:            input->error = [0m[1;35mxmlEncConvertError[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:            [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mcompleteOut[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mcompleteIn[0m[1;39m)[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:            break;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mcompleteOut[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mret == XML_ENC_ERR_SPACE[0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:            break;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mcompleteIn[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mret == XML_ENC_ERR_SUCCESS[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:            break;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:        if [0m[1;39m([0m[39mret == XML_ENC_ERR_SPACE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:            if [0m[1;39m([0m[1;35mxmlBufGrow[0m[1;39m([0m[39mout, [0m[1;36m4096[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:                input->error = XML_ERR_NO_MEMORY;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:                [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_MEMORY[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1639[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:    [0m[1;35mxmlBufShrink[0m[1;39m([0m[39min, totalIn[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1643[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1644[0m[39m:    if [0m[1;39m([0m[39minput->rawconsumed > ULONG_MAX - [0m[1;39m([0m[39munsigned long[0m[1;39m)[0m[39m totalIn[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m1645[0m[39m:        input->rawconsumed = ULONG_MAX;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1646[0m[39m:    else[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1647[0m[39m:        input->rawconsumed += totalIn;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1648[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1649[0m[39m:    *sizeOut = totalOut;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1650[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mXML_ERR_OK[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1651[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2227[0m[39m-[0m[1;36m2293[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2227[0m[39m:static int[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2228[0m[39m:[0m[1;35mUTF16LEToUTF8[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2229[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2230[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2231[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2232[0m[39m:    const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2233[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2234[0m[39m:    unsigned char *outend = out + *outlen;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2235[0m[39m:    unsigned c, d;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2236[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2237[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2238[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2239[0m[39m:        c = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2240[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2241[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2242[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2243[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2244[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2245[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2246[0m[39m:            out += [0m[1;36m1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2247[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2248[0m[39m:            if [0m[1;39m([0m[39moutend - out < [0m[1;36m2[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2249[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2250[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2251[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2252[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2253[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2254[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2255[0m[39m:            if [0m[1;39m([0m[39moutend - out < [0m[1;36m3[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2256[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2257[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2258[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2259[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2260[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2261[0m[39m:            out += [0m[1;36m3[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2262[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2263[0m[39m:            [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2264[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2265[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2266[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2267[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2268[0m[39m:   [0m[39m    if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2269[0m[39m:   [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2270[0m[39m:            d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2271[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2272[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2273[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2274[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2275[0m[39m:   [0m[39m    if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2276[0m[39m:   [0m[39m        [0m[39mgoto done;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2277[0m[39m:            c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m2278[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2279[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2280[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2281[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2282[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2283[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2284[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2285[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2286[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2287[0m[39m:    ret = out - outstart;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2288[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m2289:d[0m[39mone:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2290[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2291[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2292[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2293[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2151[0m[39m-[0m[1;36m2199[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2151[0m[39m:[0m[1;35mUTF8ToLatin1[0m[1;39m([0m[39munsigned char* out, int *outlen,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2152[0m[39m:             const unsigned char* in, int *inlen,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m2153[0m[39m:             void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2154[0m[39m:    const unsigned char* outend;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2155[0m[39m:    const unsigned char* outstart = out;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2156[0m[39m:    const unsigned char* instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2157[0m[39m:    const unsigned char* inend;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2158[0m[39m:    unsigned c;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2159[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2160[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2161[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mout == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moutlen == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39minlen == NULL[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2162[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_INTERNAL[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2163[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2164[0m[39m:    if [0m[1;39m([0m[39min == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2165[0m[39m:        *inlen = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2166[0m[39m:        *outlen = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2167[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_SUCCESS[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2168[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2169[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2170[0m[39m:    inend = in + *inlen;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2171[0m[39m:    outend = out + *outlen;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2172[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2173[0m[39m:        if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2174[0m[39m:            goto done;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2175[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2176[0m[39m:   [0m[39mc = *in;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m2177[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2178[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2179[0m[39m:            *out++ = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2180[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc >= [0m[1;36m0xC2[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mc <= [0m[1;36m0xC3[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m2181[0m[39m:            if [0m[1;39m([0m[39minend - in < [0m[1;36m2[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2182[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2183[0m[39m:            in++;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2184[0m[39m:            *out++ = [0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mc << [0m[1;36m6[0m[1;39m)[0m[39m | [0m[1;39m([0m[39m*in & [0m[1;36m0x3F[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m2185[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2186[0m[39m:            ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2187[0m[39m:            goto done;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2188[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2189[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2190[0m[39m:        in++;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2191[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2192[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2193[0m[39m:    ret = out - outstart;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2194[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m2195:d[0m[39mone:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2196[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2197[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2198[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2199[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2421[0m[39m-[0m[1;36m2487[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2421[0m[39m:static int[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2422[0m[39m:[0m[1;35mUTF16BEToUTF8[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2423[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2424[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2425[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2426[0m[39m:    const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2427[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2428[0m[39m:    unsigned char *outend = out + *outlen;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2429[0m[39m:    unsigned c, d;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2430[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2431[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2432[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2433[0m[39m:        c = [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2434[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2435[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2436[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2437[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2438[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2439[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2440[0m[39m:            out += [0m[1;36m1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2441[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2442[0m[39m:            if [0m[1;39m([0m[39moutend - out < [0m[1;36m2[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2443[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2444[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2445[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2446[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2447[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2448[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2449[0m[39m:            if [0m[1;39m([0m[39moutend - out < [0m[1;36m3[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2450[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2451[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2452[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2453[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2454[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2455[0m[39m:            out += [0m[1;36m3[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2456[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2457[0m[39m:            [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2458[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2459[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2460[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2461[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2462[0m[39m:   [0m[39m    if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2463[0m[39m:   [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2464[0m[39m:            d = [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | in[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2465[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2466[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2467[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2468[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2469[0m[39m:   [0m[39m    if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2470[0m[39m:   [0m[39m        [0m[39mgoto done;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2471[0m[39m:            c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m2472[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2473[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2474[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2475[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2476[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2477[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2478[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2479[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2480[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2481[0m[39m:    ret = out - outstart;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2482[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m2483:d[0m[39mone:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2484[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2485[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2486[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2487[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mbuf.[0m[1;92mc:431[0m[39m-[0m[1;36m439[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:xmlChar *[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:[0m[1;35mxmlBufEnd[0m[1;39m([0m[39mxmlBufPtr buf[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39m!buf[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;35mBUF_ERROR[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:        return NULL;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:    [0m[1;35mCHECK_COMPAT[0m[1;39m([0m[39mbuf[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39m&buf->content[0m[1;39m[[0m[39mbuf->use[0m[1;39m][0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mbuf.[0m[1;92mc:496[0m[39m-[0m[1;36m504[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:size_t[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:[0m[1;35mxmlBufAvail[0m[1;39m([0m[39mconst xmlBufPtr buf[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39m!buf[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;35mBUF_ERROR[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:    [0m[1;35mCHECK_COMPAT[0m[1;39m([0m[39mbuf[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mbuf->size - buf->use[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39minclude/libxml/encoding.h:[0m[1;36m30[0m[39m-[0m[1;36m37[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:typedef enum [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    XML_ENC_ERR_SUCCESS     =  [0m[1;36m0[0m[39m,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    XML_ENC_ERR_INTERNAL    = [0m[1;36m-1[0m[39m,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m       = [0m[1;36m-2[0m[39m,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    XML_ENC_ERR_SPACE       = [0m[1;36m-3[0m[39m,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    XML_ENC_ERR_MEMORY      = [0m[1;36m-4[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[1;39m}[0m[39m xmlCharEncError;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2842[0m[39m-[0m[1;36m2919[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2842[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2843[0m[39m:[0m[1;35mUTF32ToUTF8[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2844[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2845[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2846[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2847[0m[39m:    const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2848[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2849[0m[39m:    unsigned long int b0, b1, b2, b3, c, d;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2850[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2851[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2852[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m != [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x20[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2853[0m[39m:        [0m[35m/[0m[39m* bom is managed already *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2854[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2855[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2857[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2858[0m[39m:        b0 = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2859[0m[39m:        b1 = in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2860[0m[39m:        b1 = [0m[1;39m([0m[39mb1 << [0m[1;36m0x8[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2861[0m[39m:        b2 = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2862[0m[39m:        b2 = [0m[1;39m([0m[39mb2 << [0m[1;36m0x10[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2863[0m[39m:        b3 = in[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2864[0m[39m:        b3 = [0m[1;39m([0m[39mb3 << [0m[1;36m0x18[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2865[0m[39m:        c = b0 | b1 | b2 | b3;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2866[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2867[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2868[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2869[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2870[0m[39m:            out += [0m[1;36m1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2871[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2872[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2873[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2874[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2875[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2876[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2877[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2878[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2879[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2880[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2881[0m[39m:            out += [0m[1;36m3[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2882[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2883[0m[39m:            [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2884[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2885[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2886[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2887[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2888[0m[39m:   [0m[39m        if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2889[0m[39m:   [0m[39m        [0m[39m        break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2890[0m[39m:            d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2891[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2892[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2893[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2894[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2895[0m[39m:            [0m[35m/[0m[39m*[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2896[0m[39m:                simplified due to encoding errors encountered with:[0m            [2m                [0m
[2;36m                    [0m         [1;36m2897[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2898[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m2899[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2900[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2901[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2902[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2903[0m[39m:            *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2904[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xff[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2905[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m8[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2906[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x10[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2907[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x18[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2908[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2909[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2910[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2911[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2912[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2913[0m[39m:    if [0m[1;39m([0m[39min-instart > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2914[0m[39m:        ret = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2915[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2916[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2917[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2918[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2919[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtestapi.[0m[1;92mc:7973[0m[39m-[0m[1;36m7996[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m7973[0m[39m:static int[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m7974[0m[39m:[0m[1;35mtest_UTF32ToUTF8[0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m7975[0m[39m:    int test_ret = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m7976[0m[39m:    char* test_str = [0m[32m"AAAA"[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m7977[0m[39m:    int [0m[33min_len[0m[39m=[0m[1;35mstrlen[0m[1;39m([0m[39mtest_str[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m7978[0m[39m:    int [0m[33mout_len[0m[39m=[0m[1;36m1024[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m7979[0m[39m:    unsigned char* outb1 = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m,[0m[1;36m1024[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m7980[0m[39m:    char* outb2 = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m,[0m[1;36m1024[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m7981[0m[39m:    int r = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m7982[0m[39m:    r = [0m[1;35mUTF8ToUTF32[0m[1;39m([0m[39moutb1, &out_len, [0m[1;39m([0m[39munsigned char*[0m[1;39m)[0m[39mtest_str, &in_len, NULL[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m7983[0m[39m:    if [0m[1;39m([0m[33mout_len[0m[39m==[0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m7984[0m[39m:        test_ret++;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7985[0m[39m:        in_len = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7986[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m7987[0m[39m:        in_len = out_len;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m7988[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m7989[0m[39m:    out_len = [0m[1;36m1024[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7990[0m[39m:    r = [0m[1;35mUTF32ToUTF8[0m[1;39m([0m[1;39m([0m[39munsigned char*[0m[1;39m)[0m[39moutb2, &out_len, outb1, &in_len, NULL[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m7991[0m[39m:    if [0m[1;39m([0m[33mout_len[0m[39m==[0m[1;36m0[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7992[0m[39m:        test_ret++;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7993[0m[39m:    [0m[1;35mfree[0m[1;39m([0m[39moutb1[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m7994[0m[39m:    [0m[1;35mfree[0m[1;39m([0m[39moutb2[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m7995[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mtest_ret[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m7996[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2842[0m[39m-[0m[1;36m2919[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2842[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2843[0m[39m:[0m[1;35mUTF32ToUTF8[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2844[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2845[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2846[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2847[0m[39m:    const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2848[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2849[0m[39m:    unsigned long int b0, b1, b2, b3, c, d;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2850[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2851[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2852[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m != [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x20[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2853[0m[39m:        [0m[35m/[0m[39m* bom is managed already *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2854[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2855[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2857[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2858[0m[39m:        b0 = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2859[0m[39m:        b1 = in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2860[0m[39m:        b1 = [0m[1;39m([0m[39mb1 << [0m[1;36m0x8[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2861[0m[39m:        b2 = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2862[0m[39m:        b2 = [0m[1;39m([0m[39mb2 << [0m[1;36m0x10[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2863[0m[39m:        b3 = in[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2864[0m[39m:        b3 = [0m[1;39m([0m[39mb3 << [0m[1;36m0x18[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2865[0m[39m:        c = b0 | b1 | b2 | b3;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2866[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2867[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2868[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2869[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2870[0m[39m:            out += [0m[1;36m1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2871[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2872[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2873[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2874[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2875[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2876[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2877[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2878[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2879[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2880[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2881[0m[39m:            out += [0m[1;36m3[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2882[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2883[0m[39m:            [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2884[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2885[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2886[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2887[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2888[0m[39m:   [0m[39m        if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2889[0m[39m:   [0m[39m        [0m[39m        break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2890[0m[39m:            d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2891[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2892[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2893[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2894[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2895[0m[39m:            [0m[35m/[0m[39m*[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2896[0m[39m:                simplified due to encoding errors encountered with:[0m            [2m                [0m
[2;36m                    [0m         [1;36m2897[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2898[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m2899[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2900[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2901[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2902[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2903[0m[39m:            *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2904[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xff[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2905[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m8[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2906[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x10[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2907[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x18[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2908[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2909[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2910[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2911[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2912[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2913[0m[39m:    if [0m[1;39m([0m[39min-instart > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2914[0m[39m:        ret = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2915[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2916[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2917[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2918[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2919[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2738[0m[39m-[0m[1;36m2840[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2738[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2739[0m[39m:[0m[1;35mUTF8ToUTF32[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2740[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2741[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2742[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2743[0m[39m:    const unsigned char *inend;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2744[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2745[0m[39m:    unsigned char *outend;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2746[0m[39m:    unsigned c, d;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2747[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2748[0m[39m:    int i, len;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2749[0m[39m:    [0m[35m/[0m[39m* UTF32 encoding has no BOM *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m2750[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mout == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moutlen == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39minlen == NULL[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2751[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_INTERNAL[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2752[0m[39m:    if [0m[1;39m([0m[39min == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2753[0m[39m:   [0m[39m*outlen = [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2754[0m[39m:   [0m[39m*inlen = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2755[0m[39m:   [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2756[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2757[0m[39m:    inend = in + *inlen;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2758[0m[39m:    outend = out + [0m[1;39m([0m[39m*outlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2759[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2760[0m[39m:        c = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2761[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2762[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2763[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2764[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2765[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2766[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2767[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2768[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2769[0m[39m:            in += [0m[1;36m1[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2770[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2771[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2772[0m[39m:            unsigned min;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2773[0m[39m:            if [0m[1;39m([0m[39mc < [0m[1;36m0xE0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2774[0m[39m:                if [0m[1;39m([0m[39mc < [0m[1;36m0xC2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2775[0m[39m:                    ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2776[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2777[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2778[0m[39m:                c &= [0m[1;36m0x1F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2779[0m[39m:                len = [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2780[0m[39m:                min = [0m[1;36m0x80[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2781[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0xF0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2782[0m[39m:                c &= [0m[1;36m0x0F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2783[0m[39m:                len = [0m[1;36m3[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2784[0m[39m:                min = [0m[1;36m0x800[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2785[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2786[0m[39m:                c &= [0m[1;36m0x0F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2787[0m[39m:                len = [0m[1;36m4[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2788[0m[39m:                min = [0m[1;36m0x10000[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2789[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2790[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2791[0m[39m:            if [0m[1;39m([0m[39minend - in < len[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2792[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2793[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2794[0m[39m:            for [0m[1;39m([0m[39mi = [0m[1;36m1[0m[39m; i < len; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2795[0m[39m:                if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m & [0m[1;36m0xC0[0m[1;39m)[0m[39m != [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2796[0m[39m:                    ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2797[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2798[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2799[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m6[0m[1;39m)[0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2800[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2801[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2802[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc < min[0m[1;39m)[0m[39m ||[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2803[0m[39m:                [0m[1;39m([0m[1;39m([0m[39mc >= [0m[1;36m0xD800[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mc <= [0m[1;36m0xDFFF[0m[1;39m)[0m[1;39m)[0m[39m ||[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2804[0m[39m:                [0m[1;39m([0m[39mc > [0m[1;36m0x10FFFF[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2805[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2806[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2807[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2808[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2809[0m[39m:            if [0m[1;39m([0m[39mc < [0m[1;36m0x10000[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2810[0m[39m:                if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2811[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2812[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2813[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = c >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2814[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2815[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2816[0m[39m:                out += [0m[1;36m4[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2817[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2818[0m[39m:                if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2819[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2820[0m[39m:                c -= [0m[1;36m0x10000[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2821[0m[39m:                d = [0m[1;39m([0m[39mc & [0m[1;36m0x03FF[0m[1;39m)[0m[39m | [0m[1;36m0xDC00[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2822[0m[39m:                c = [0m[1;39m([0m[39mc >> [0m[1;36m10[0m[1;39m)[0m[39m    | [0m[1;36m0xD800[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2823[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2824[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = c >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2825[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = d & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2826[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = d >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2827[0m[39m:                out += [0m[1;36m4[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2828[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2829[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2830[0m[39m:            in += len;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2831[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2832[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2833[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2834[0m[39m:    if [0m[1;39m([0m[39min-instart > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2835[0m[39m:        ret = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2836[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2837[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2838[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2839[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2840[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2295[0m[39m-[0m[1;36m2396[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2295[0m[39m:#ifdef LIBXML_OUT[0m[1;33mPUT[0m[39m_ENABLED[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2296[0m[39m:static int[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2297[0m[39m:[0m[1;35mUTF8ToUTF16LE[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2298[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2299[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2300[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2301[0m[39m:    const unsigned char *inend;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2302[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2303[0m[39m:    unsigned char *outend;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2304[0m[39m:    unsigned c, d;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2305[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2306[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2307[0m[39m:    [0m[35m/[0m[39m* UTF16LE encoding has no BOM *[0m[35m/[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2308[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mout == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moutlen == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39minlen == NULL[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2309[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_INTERNAL[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2310[0m[39m:    if [0m[1;39m([0m[39min == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2311[0m[39m:   [0m[39m*outlen = [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2312[0m[39m:   [0m[39m*inlen = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2313[0m[39m:   [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2314[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2315[0m[39m:    inend = in + *inlen;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2316[0m[39m:    outend = out + [0m[1;39m([0m[39m*outlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2317[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2318[0m[39m:        c = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2319[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2320[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2321[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2322[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2323[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2324[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2325[0m[39m:            in += [0m[1;36m1[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2326[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2327[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2328[0m[39m:            int i, len;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2329[0m[39m:            unsigned min;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2330[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2331[0m[39m:            if [0m[1;39m([0m[39mc < [0m[1;36m0xE0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2332[0m[39m:                if [0m[1;39m([0m[39mc < [0m[1;36m0xC2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2333[0m[39m:                    ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2334[0m[39m:                    goto done;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2335[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2336[0m[39m:                c &= [0m[1;36m0x1F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2337[0m[39m:                len = [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2338[0m[39m:                min = [0m[1;36m0x80[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2339[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0xF0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2340[0m[39m:                c &= [0m[1;36m0x0F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2341[0m[39m:                len = [0m[1;36m3[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2342[0m[39m:                min = [0m[1;36m0x800[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2343[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2344[0m[39m:                c &= [0m[1;36m0x0F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2345[0m[39m:                len = [0m[1;36m4[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2346[0m[39m:                min = [0m[1;36m0x10000[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2347[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2348[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2349[0m[39m:            if [0m[1;39m([0m[39minend - in < len[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2350[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2351[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2352[0m[39m:            for [0m[1;39m([0m[39mi = [0m[1;36m1[0m[39m; i < len; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2353[0m[39m:                if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m & [0m[1;36m0xC0[0m[1;39m)[0m[39m != [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2354[0m[39m:                    ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2355[0m[39m:                    goto done;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2356[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2357[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m6[0m[1;39m)[0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2358[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2359[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2360[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc < min[0m[1;39m)[0m[39m ||[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2361[0m[39m:                [0m[1;39m([0m[1;39m([0m[39mc >= [0m[1;36m0xD800[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mc <= [0m[1;36m0xDFFF[0m[1;39m)[0m[1;39m)[0m[39m ||[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2362[0m[39m:                [0m[1;39m([0m[39mc > [0m[1;36m0x10FFFF[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2363[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2364[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2365[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2366[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2367[0m[39m:            if [0m[1;39m([0m[39mc < [0m[1;36m0x10000[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2368[0m[39m:                if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2369[0m[39m:                    goto done;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2370[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2371[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = c >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2372[0m[39m:                out += [0m[1;36m2[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2373[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2374[0m[39m:                if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2375[0m[39m:                    goto done;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2376[0m[39m:                c -= [0m[1;36m0x10000[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2377[0m[39m:                d = [0m[1;39m([0m[39mc & [0m[1;36m0x03FF[0m[1;39m)[0m[39m | [0m[1;36m0xDC00[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2378[0m[39m:                c = [0m[1;39m([0m[39mc >> [0m[1;36m10[0m[1;39m)[0m[39m    | [0m[1;36m0xD800[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2379[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2380[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = c >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2381[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = d & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2382[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = d >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2383[0m[39m:                out += [0m[1;36m4[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2384[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2385[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2386[0m[39m:            in += len;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2387[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2388[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2389[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2390[0m[39m:    ret = out - outstart;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2391[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m2392:d[0m[39mone:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2393[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2394[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2395[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2396[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mparser.[0m[1;92mc:882[0m[39m-[0m[1;36m892[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:            if [0m[1;39m([0m[39mc == [0m[1;36m0xE0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:                [0m[35m/[0m[39m* overlong *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:                if [0m[1;39m([0m[39mc1 < [0m[1;36m0xA0[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:                    goto encoding_error;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc == [0m[1;36m0xED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:                [0m[35m/[0m[39m* surrogate *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:                if [0m[1;39m([0m[39mc1 >= [0m[1;36m0xA0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:                    goto encoding_error;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc == [0m[1;36m0xEF[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:                [0m[35m/[0m[39m* U+FFFE and U+FFFF are invalid Chars *[0m[35m/[0m                       [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:                if [0m[1;39m([0m[1;39m([0m[39mc1 == [0m[1;36m0xBF[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mc2 >= [0m[1;36m0xBE[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2488[0m[39m-[0m[1;36m2589[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2488[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2489[0m[39m:#ifdef LIBXML_OUT[0m[1;33mPUT[0m[39m_ENABLED[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2490[0m[39m:static int[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2491[0m[39m:[0m[1;35mUTF8ToUTF16BE[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2492[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2493[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2494[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2495[0m[39m:    const unsigned char *inend;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2496[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2497[0m[39m:    unsigned char *outend;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2498[0m[39m:    unsigned c, d;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2499[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2500[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2501[0m[39m:    [0m[35m/[0m[39m* UTF-16BE has no BOM *[0m[35m/[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2502[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mout == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moutlen == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39minlen == NULL[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m2503[0m[39m:    if [0m[1;39m([0m[39min == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2504[0m[39m:   [0m[39m*outlen = [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2505[0m[39m:   [0m[39m*inlen = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2506[0m[39m:   [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2507[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2508[0m[39m:    inend = in + *inlen;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2509[0m[39m:    outend = out + [0m[1;39m([0m[39m*outlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2510[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2511[0m[39m:        c = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2512[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2513[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2514[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2515[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2516[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2517[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2518[0m[39m:            in += [0m[1;36m1[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2519[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2520[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2521[0m[39m:            int i, len;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2522[0m[39m:            unsigned min;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2523[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2524[0m[39m:            if [0m[1;39m([0m[39mc < [0m[1;36m0xE0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2525[0m[39m:                if [0m[1;39m([0m[39mc < [0m[1;36m0xC2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2526[0m[39m:                    ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2527[0m[39m:                    goto done;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2528[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2529[0m[39m:                c &= [0m[1;36m0x1F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2530[0m[39m:                len = [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2531[0m[39m:                min = [0m[1;36m0x80[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2532[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0xF0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2533[0m[39m:                c &= [0m[1;36m0x0F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2534[0m[39m:                len = [0m[1;36m3[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2535[0m[39m:                min = [0m[1;36m0x800[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2536[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2537[0m[39m:                c &= [0m[1;36m0x0F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2538[0m[39m:                len = [0m[1;36m4[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2539[0m[39m:                min = [0m[1;36m0x10000[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2540[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2541[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2542[0m[39m:            if [0m[1;39m([0m[39minend - in < len[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2543[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2544[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2545[0m[39m:            for [0m[1;39m([0m[39mi = [0m[1;36m1[0m[39m; i < len; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2546[0m[39m:                if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m & [0m[1;36m0xC0[0m[1;39m)[0m[39m != [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2547[0m[39m:                    ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2548[0m[39m:                    goto done;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2549[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2550[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m6[0m[1;39m)[0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2551[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2552[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2553[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc < min[0m[1;39m)[0m[39m ||[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2554[0m[39m:                [0m[1;39m([0m[1;39m([0m[39mc >= [0m[1;36m0xD800[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mc <= [0m[1;36m0xDFFF[0m[1;39m)[0m[1;39m)[0m[39m ||[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2555[0m[39m:                [0m[1;39m([0m[39mc > [0m[1;36m0x10FFFF[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2556[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2557[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2558[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2559[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2560[0m[39m:            if [0m[1;39m([0m[39mc < [0m[1;36m0x10000[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2561[0m[39m:                if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2562[0m[39m:                    goto done;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2563[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2564[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = c & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2565[0m[39m:                out += [0m[1;36m2[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2566[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2567[0m[39m:                if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2568[0m[39m:                    goto done;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2569[0m[39m:                c -= [0m[1;36m0x10000[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2570[0m[39m:                d = [0m[1;39m([0m[39mc & [0m[1;36m0x03FF[0m[1;39m)[0m[39m | [0m[1;36m0xDC00[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2571[0m[39m:                c = [0m[1;39m([0m[39mc >> [0m[1;36m10[0m[1;39m)[0m[39m    | [0m[1;36m0xD800[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2572[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2573[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = c & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2574[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = d >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2575[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = d & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2576[0m[39m:                out += [0m[1;36m4[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2577[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2579[0m[39m:            in += len;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2580[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2581[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2582[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2583[0m[39m:    ret = out - outstart;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2584[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m2585:d[0m[39mone:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2586[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2587[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2588[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2589[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2842[0m[39m-[0m[1;36m2919[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2842[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2843[0m[39m:[0m[1;35mUTF32ToUTF8[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2844[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2845[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2846[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2847[0m[39m:    const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2848[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2849[0m[39m:    unsigned long int b0, b1, b2, b3, c, d;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2850[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2851[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2852[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m != [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x20[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2853[0m[39m:        [0m[35m/[0m[39m* bom is managed already *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2854[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2855[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2857[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2858[0m[39m:        b0 = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2859[0m[39m:        b1 = in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2860[0m[39m:        b1 = [0m[1;39m([0m[39mb1 << [0m[1;36m0x8[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2861[0m[39m:        b2 = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2862[0m[39m:        b2 = [0m[1;39m([0m[39mb2 << [0m[1;36m0x10[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2863[0m[39m:        b3 = in[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2864[0m[39m:        b3 = [0m[1;39m([0m[39mb3 << [0m[1;36m0x18[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2865[0m[39m:        c = b0 | b1 | b2 | b3;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2866[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2867[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2868[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2869[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2870[0m[39m:            out += [0m[1;36m1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2871[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2872[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2873[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2874[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2875[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2876[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2877[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2878[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2879[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2880[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2881[0m[39m:            out += [0m[1;36m3[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2882[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2883[0m[39m:            [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2884[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2885[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2886[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2887[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2888[0m[39m:   [0m[39m        if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2889[0m[39m:   [0m[39m        [0m[39m        break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2890[0m[39m:            d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2891[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2892[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2893[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2894[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2895[0m[39m:            [0m[35m/[0m[39m*[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2896[0m[39m:                simplified due to encoding errors encountered with:[0m            [2m                [0m
[2;36m                    [0m         [1;36m2897[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2898[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m2899[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2900[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2901[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2902[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2903[0m[39m:            *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2904[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xff[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2905[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m8[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2906[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x10[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2907[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x18[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2908[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2909[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2910[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2911[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2912[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2913[0m[39m:    if [0m[1;39m([0m[39min-instart > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2914[0m[39m:        ret = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2915[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2916[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2917[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2918[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2919[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:618[0m[39m-[0m[1;36m674[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m618[0m[39m:xmlCharEncodingHandlerPtr[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m619[0m[39m:[0m[1;35mxmlNewCharEncodingHandler[0m[1;39m([0m[39mconst char *name,[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m620[0m[39m:                          xmlCharEncodingInputFunc input,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m621[0m[39m:                          xmlCharEncodingOutputFunc output[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m622[0m[39m:    xmlCharEncodingHandlerPtr handler;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m623[0m[39m:    const char *alias;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m624[0m[39m:    char upper[0m[1;39m[[0m[1;36m500[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m625[0m[39m:    int i;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m626[0m[39m:    char *up = NULL;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m628[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m629[0m[39m:     * Do the alias resolution[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m630[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m631[0m[39m:    alias = [0m[1;35mxmlGetEncodingAlias[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:    if [0m[1;39m([0m[39malias != NULL[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:    [0m[39mname = alias;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:     * Keep only the uppercase version of the encoding.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:    if [0m[1;39m([0m[39mname == NULL[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:    for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m;i < [0m[1;36m499[0m[39m;i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:        upper[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m [0m[1;35mtoupper[0m[1;39m([0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[39m name[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:    [0m[39mif [0m[1;39m([0m[39mupper[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m break;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:    upper[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:    up = [0m[1;35mxmlMemStrdup[0m[1;39m([0m[39mupper[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:    if [0m[1;39m([0m[39mup == NULL[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:     * allocate and fill-up an handler block.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m651[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m652[0m[39m:    handler = [0m[1;39m([0m[39mxmlCharEncodingHandlerPtr[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m653[0m[39m:              [0m[1;35mxmlMalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39mxmlCharEncodingHandler[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:    if [0m[1;39m([0m[39mhandler == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:        [0m[1;35mxmlFree[0m[1;39m([0m[39mup[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39mhandler, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mxmlCharEncodingHandler[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:    handler->input = input;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:    handler->output = output;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:    handler->name = up;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:    handler->flags = XML_HANDLER_STATIC;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:#ifdef LIBXML_ICONV_ENABLED[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:    handler->iconv_in = NULL;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:    handler->iconv_out = NULL;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:    [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:     * registers and returns the handler.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:    [0m[1;35mxmlRegisterCharEncodingHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:1062[0m[39m-[0m[1;36m1077[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1062[0m[39m:xmlCharEncodingHandlerPtr[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1063[0m[39m:[0m[1;35mxmlFindCharEncodingHandler[0m[1;39m([0m[39mconst char *name[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1064[0m[39m:    xmlCharEncodingHandler *ret;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1065[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1066[0m[39m:    [0m[35m/[0m[39m*[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1067[0m[39m:     * This handler shouldn't be used, but we must return a non-NULL[0m           [2m                [0m
[2;36m                    [0m         [1;36m1068[0m[39m:     * handler.[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1069[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1070[0m[39m:    if [0m[1;39m([0m[1;39m([0m[1;35mxmlStrcasecmp[0m[1;39m([0m[39mBAD_CAST name, BAD_CAST [0m[32m"UTF-8"[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m ||[0m               [2m                [0m
[2;36m                    [0m         [1;36m1071[0m[39m:        [0m[1;39m([0m[1;35mxmlStrcasecmp[0m[1;39m([0m[39mBAD_CAST name, BAD_CAST [0m[32m"UTF8"[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1072[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;39m([0m[39mxmlCharEncodingHandlerPtr[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1073[0m[39m:                &defaultHandlers[0m[1;39m[[0m[39mXML_CHAR_ENCODING_UTF8[0m[1;39m][0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1074[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1075[0m[39m:    [0m[1;35mxmlOpenCharEncodingHandler[0m[1;39m([0m[39mname, [0m[1;36m0[0m[39m, &ret[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1076[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1077[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:206[0m[39m-[0m[1;36m244[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m: * The layout must match enum xmlCharEncoding.[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m: *[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m: * Names should match the IANA registry if possible:[0m                            [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m: * [0m[4;94mhttps://www.iana.org/assignments/character-sets/character-sets.xhtml[0m         [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m: *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:static const xmlCharEncodingHandler defaultHandlers[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[39mNULL, NULL, NULL[0m[1;39m)[0m[39m, [0m[35m/[0m[39m* NONE *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UTF-8"[0m[39m, UTF8ToUTF8, UTF8ToUTF8[0m[1;39m)[0m[39m,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UTF-16LE"[0m[39m, UTF16LEToUTF8, UTF8ToUTF16LE[0m[1;39m)[0m[39m,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UTF-16BE"[0m[39m, UTF16BEToUTF8, UTF8ToUTF16BE[0m[1;39m)[0m[39m,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UCS-4LE"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UCS-4BE"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"IBM037"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"ISO-10646-UCS-4"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m, [0m[35m/[0m[39m* UCS4_2143 *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"ISO-10646-UCS-4"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m, [0m[35m/[0m[39m* UCS4_2143 *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"ISO-10646-UCS-2"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"ISO-8859-1"[0m[39m, latin1ToUTF8, UTF8ToLatin1[0m[1;39m)[0m[39m,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-2"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-3"[0m[39m, [0m[1;36m3[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-4"[0m[39m, [0m[1;36m4[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-5"[0m[39m, [0m[1;36m5[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-6"[0m[39m, [0m[1;36m6[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-7"[0m[39m, [0m[1;36m7[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-8"[0m[39m, [0m[1;36m8[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-9"[0m[39m, [0m[1;36m9[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"ISO-2022-JP"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"Shift_JIS"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"EUC-JP"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"US-ASCII"[0m[39m, asciiToAscii, asciiToAscii[0m[1;39m)[0m[39m,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UTF-16"[0m[39m, UTF16LEToUTF8, UTF8ToUTF16[0m[1;39m)[0m[39m,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"HTML"[0m[39m, NULL, UTF8ToHtmlWrapper[0m[1;39m)[0m[39m,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-10"[0m[39m, [0m[1;36m10[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-11"[0m[39m, [0m[1;36m11[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-13"[0m[39m, [0m[1;36m13[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-14"[0m[39m, [0m[1;36m14[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-15"[0m[39m, [0m[1;36m15[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-16"[0m[39m, [0m[1;36m16[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UTF-32"[0m[39m, UTF32ToUTF8, UTF8ToUTF32[0m[1;39m)[0m[39m,[0m                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39minclude/libxml/encoding.h:[0m[1;36m44[0m[39m-[0m[1;36m79[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:typedef enum [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[33mXML_CHAR_ENCODING_ERROR[0m[39m=   [0m[1;36m-1[0m[39m, [0m[35m/[0m[39m* No char encoding detected *[0m[35m/[0m               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[33mXML_CHAR_ENCODING_NONE[0m[39m=  [0m[1;36m0[0m[39m, [0m[35m/[0m[39m* No char encoding detected *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[33mXML_CHAR_ENCODING_UTF8[0m[39m=  [0m[1;36m1[0m[39m, [0m[35m/[0m[39m* UTF-[0m[1;36m8[0m[39m *[0m[35m/[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[33mXML_CHAR_ENCODING_UTF16LE[0m[39m=       [0m[1;36m2[0m[39m, [0m[35m/[0m[39m* UTF-[0m[1;36m16[0m[39m little endian *[0m[35m/[0m               [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[33mXML_CHAR_ENCODING_UTF16BE[0m[39m=       [0m[1;36m3[0m[39m, [0m[35m/[0m[39m* UTF-[0m[1;36m16[0m[39m big endian *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[33mXML_CHAR_ENCODING_UCS4LE[0m[39m=        [0m[1;36m4[0m[39m, [0m[35m/[0m[39m* UCS-[0m[1;36m4[0m[39m little endian *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[33mXML_CHAR_ENCODING_UCS4BE[0m[39m=        [0m[1;36m5[0m[39m, [0m[35m/[0m[39m* UCS-[0m[1;36m4[0m[39m big endian *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[33mXML_CHAR_ENCODING_EBCDIC[0m[39m=        [0m[1;36m6[0m[39m, [0m[35m/[0m[39m* EBCDIC uh! *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[33mXML_CHAR_ENCODING_UCS4_2143[0m[39m=[0m[1;36m7[0m[39m, [0m[35m/[0m[39m* UCS-[0m[1;36m4[0m[39m unusual ordering *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[33mXML_CHAR_ENCODING_UCS4_3412[0m[39m=[0m[1;36m8[0m[39m, [0m[35m/[0m[39m* UCS-[0m[1;36m4[0m[39m unusual ordering *[0m[35m/[0m                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[33mXML_CHAR_ENCODING_UCS2[0m[39m=  [0m[1;36m9[0m[39m, [0m[35m/[0m[39m* UCS-[0m[1;36m2[0m[39m *[0m[35m/[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_1[0m[39m=        [0m[1;36m10[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m1[0m[39m ISO Latin [0m[1;36m1[0m[39m *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_2[0m[39m=        [0m[1;36m11[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m2[0m[39m ISO Latin [0m[1;36m2[0m[39m *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_3[0m[39m=        [0m[1;36m12[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m3[0m[39m *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_4[0m[39m=        [0m[1;36m13[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m4[0m[39m *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_5[0m[39m=        [0m[1;36m14[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m5[0m[39m *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_6[0m[39m=        [0m[1;36m15[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m6[0m[39m *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_7[0m[39m=        [0m[1;36m16[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m7[0m[39m *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_8[0m[39m=        [0m[1;36m17[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m8[0m[39m *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_9[0m[39m=        [0m[1;36m18[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m9[0m[39m *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[33mXML_CHAR_ENCODING_2022_JP[0m[39m=  [0m[1;36m19[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m2022[0m[39m-JP *[0m[35m/[0m                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[33mXML_CHAR_ENCODING_SHIFT_JIS[0m[39m=[0m[1;36m20[0m[39m,[0m[35m/[0m[39m* Shift_JIS *[0m[35m/[0m                               [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[33mXML_CHAR_ENCODING_EUC_JP[0m[39m=   [0m[1;36m21[0m[39m,[0m[35m/[0m[39m* EUC-JP *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[33mXML_CHAR_ENCODING_ASCII[0m[39m=    [0m[1;36m22[0m[39m,[0m[35m/[0m[39m* pure ASCII *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[35m/[0m[39m* Available since [0m[1;36m2.14[0m[39m.[0m[1;36m0[0m[39m *[0m[35m/[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[33mXML_CHAR_ENCODING_UTF16[0m[39m= [0m[1;36m23[0m[39m,[0m[35m/[0m[39m* UTF-[0m[1;36m16[0m[39m native *[0m[35m/[0m                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[33mXML_CHAR_ENCODING_HTML[0m[39m=  [0m[1;36m24[0m[39m,[0m[35m/[0m[39m* HTML [0m[1;39m([0m[39moutput only[0m[1;39m)[0m[39m *[0m[35m/[0m                         [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_10[0m[39m=       [0m[1;36m25[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m10[0m[39m *[0m[35m/[0m                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_11[0m[39m=       [0m[1;36m26[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m11[0m[39m *[0m[35m/[0m                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_13[0m[39m=       [0m[1;36m27[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m13[0m[39m *[0m[35m/[0m                        [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_14[0m[39m=       [0m[1;36m28[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m14[0m[39m *[0m[35m/[0m                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_15[0m[39m=       [0m[1;36m29[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m15[0m[39m *[0m[35m/[0m                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[33mXML_CHAR_ENCODING_8859_16[0m[39m=       [0m[1;36m30[0m[39m,[0m[35m/[0m[39m* ISO-[0m[1;36m8859[0m[39m-[0m[1;36m16[0m[39m *[0m[35m/[0m                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[33mXML_CHAR_ENCODING_UTF32[0m[39m=    [0m[1;36m31[0m[39m [0m[35m/[0m[39m* UTF32 native *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m[1;39m}[0m[39m xmlCharEncoding;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2842[0m[39m-[0m[1;36m2919[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2842[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2843[0m[39m:[0m[1;35mUTF32ToUTF8[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2844[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2845[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2846[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2847[0m[39m:    const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2848[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2849[0m[39m:    unsigned long int b0, b1, b2, b3, c, d;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2850[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2851[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2852[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m != [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x20[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2853[0m[39m:        [0m[35m/[0m[39m* bom is managed already *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2854[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2855[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2857[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2858[0m[39m:        b0 = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2859[0m[39m:        b1 = in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2860[0m[39m:        b1 = [0m[1;39m([0m[39mb1 << [0m[1;36m0x8[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2861[0m[39m:        b2 = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2862[0m[39m:        b2 = [0m[1;39m([0m[39mb2 << [0m[1;36m0x10[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2863[0m[39m:        b3 = in[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2864[0m[39m:        b3 = [0m[1;39m([0m[39mb3 << [0m[1;36m0x18[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2865[0m[39m:        c = b0 | b1 | b2 | b3;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2866[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2867[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2868[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2869[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2870[0m[39m:            out += [0m[1;36m1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2871[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2872[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2873[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2874[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2875[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2876[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2877[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2878[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2879[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2880[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2881[0m[39m:            out += [0m[1;36m3[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2882[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2883[0m[39m:            [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2884[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2885[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2886[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2887[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2888[0m[39m:   [0m[39m        if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2889[0m[39m:   [0m[39m        [0m[39m        break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2890[0m[39m:            d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2891[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2892[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2893[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2894[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2895[0m[39m:            [0m[35m/[0m[39m*[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2896[0m[39m:                simplified due to encoding errors encountered with:[0m            [2m                [0m
[2;36m                    [0m         [1;36m2897[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2898[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m2899[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2900[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2901[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2902[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2903[0m[39m:            *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2904[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xff[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2905[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m8[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2906[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x10[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2907[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x18[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2908[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2909[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2910[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2911[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2912[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2913[0m[39m:    if [0m[1;39m([0m[39min-instart > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2914[0m[39m:        ret = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2915[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2916[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2917[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2918[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2919[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:320[0m[39m-[0m[1;36m340[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:    [0m[39m * We now allow an UTF8 encoded BOM[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:    [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m0xEF[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;36m0xBB[0m[1;39m)[0m[39m &&[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:    [0m[39m    [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m == [0m[1;36m0xBF[0m[1;39m)[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:    [0m[39m    [0m[1;35mreturn[0m[1;39m([0m[39mXML_CHAR_ENCODING_UTF8[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m0xFF[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;36m0xFE[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m == [0m[1;36m0x00[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m == [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x00[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:    [0m[39m    [0m[1;35mreturn[0m[1;39m([0m[39mXML_CHAR_ENCODING_UTF32[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:    [0m[35m/[0m[39m* For UTF-[0m[1;36m16[0m[39m we can recognize by the BOM *[0m[35m/[0m                                [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:    if [0m[1;39m([0m[39mlen >= [0m[1;36m2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m0xFE[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;36m0xFF[0m[1;39m)[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:    [0m[39m    [0m[1;35mreturn[0m[1;39m([0m[39mXML_CHAR_ENCODING_UTF16BE[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:    [0m[39mif [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[1;36m0xFF[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;36m0xFE[0m[1;39m)[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:    [0m[39m    [0m[1;35mreturn[0m[1;39m([0m[39mXML_CHAR_ENCODING_UTF16LE[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mXML_CHAR_ENCODING_NONE[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mparserInternals.[0m[1;92mc:1445[0m[39m-[0m[1;36m1456[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1445[0m[39m:        case [0m[1;36m0x00[0m[39m:[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1446[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;36m0x00[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m == [0m[1;36m0x00[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m == [0m[1;36m0x3C[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m1447[0m[39m:                enc = XML_CHAR_ENCODING_UCS4BE;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1448[0m[39m:                autoFlag = XML_IN[0m[1;33mPUT[0m[39m_AUTO_OTHER;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;36m0x00[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m == [0m[1;36m0xfe[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m == [0m[1;36m0xff[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:                enc = XML_CHAR_ENCODING_UTF32;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:                autoFlag = XML_CHAR_ENCODING_UTF32;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:                bomSize = [0m[1;36m4[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1453[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;36m0x3C[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m == [0m[1;36m0x00[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m == [0m[1;36m0x3F[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1454[0m[39m:                enc = XML_CHAR_ENCODING_UTF16BE;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1455[0m[39m:                autoFlag = XML_IN[0m[1;33mPUT[0m[39m_AUTO_UTF16BE;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1456[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:211[0m[39m-[0m[1;36m244[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:static const xmlCharEncodingHandler defaultHandlers[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[39mNULL, NULL, NULL[0m[1;39m)[0m[39m, [0m[35m/[0m[39m* NONE *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UTF-8"[0m[39m, UTF8ToUTF8, UTF8ToUTF8[0m[1;39m)[0m[39m,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UTF-16LE"[0m[39m, UTF16LEToUTF8, UTF8ToUTF16LE[0m[1;39m)[0m[39m,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UTF-16BE"[0m[39m, UTF16BEToUTF8, UTF8ToUTF16BE[0m[1;39m)[0m[39m,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UCS-4LE"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UCS-4BE"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"IBM037"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"ISO-10646-UCS-4"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m, [0m[35m/[0m[39m* UCS4_2143 *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"ISO-10646-UCS-4"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m, [0m[35m/[0m[39m* UCS4_2143 *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"ISO-10646-UCS-2"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"ISO-8859-1"[0m[39m, latin1ToUTF8, UTF8ToLatin1[0m[1;39m)[0m[39m,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-2"[0m[39m, [0m[1;36m2[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-3"[0m[39m, [0m[1;36m3[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-4"[0m[39m, [0m[1;36m4[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-5"[0m[39m, [0m[1;36m5[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-6"[0m[39m, [0m[1;36m6[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-7"[0m[39m, [0m[1;36m7[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-8"[0m[39m, [0m[1;36m8[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-9"[0m[39m, [0m[1;36m9[0m[1;39m)[0m[39m,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"ISO-2022-JP"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"Shift_JIS"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"EUC-JP"[0m[39m, NULL, NULL[0m[1;39m)[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"US-ASCII"[0m[39m, asciiToAscii, asciiToAscii[0m[1;39m)[0m[39m,[0m                       [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UTF-16"[0m[39m, UTF16LEToUTF8, UTF8ToUTF16[0m[1;39m)[0m[39m,[0m                         [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"HTML"[0m[39m, NULL, UTF8ToHtmlWrapper[0m[1;39m)[0m[39m,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-10"[0m[39m, [0m[1;36m10[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-11"[0m[39m, [0m[1;36m11[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-13"[0m[39m, [0m[1;36m13[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-14"[0m[39m, [0m[1;36m14[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-15"[0m[39m, [0m[1;36m15[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[1;35mMAKE_ISO_HANDLER[0m[1;39m([0m[32m"ISO-8859-16"[0m[39m, [0m[1;36m16[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UTF-32"[0m[39m, UTF32ToUTF8, UTF8ToUTF32[0m[1;39m)[0m[39m,[0m                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Issue[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and the evaluation report, I've identified that [0m  [2m                [0m
[2;36m                    [0m         [39mthe **UTF32ToUTF8** function in `encoding.c` has multiple critical bugs causing the[0m [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow:[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Causes Identified:[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Missing output boundary checks** [0m[1;39m([0m[39mPRIMARY CAUSE of heap-buffer-overflow at [0m    [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m2868[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - No `outend` pointer calculation[0m                                                [2m                [0m
[2;36m                    [0m         [39m   - No boundary validation before write operations at lines [0m[1;36m2868[0m[39m, [0m[1;36m2872[0m[39m-[0m[1;36m2873[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [1;36m2877[0m[39m-[0m[1;36m2879[0m[39m, [0m[1;36m2904[0m[39m-[0m[1;36m2907[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Incorrect input alignment** [0m[1;39m([0m[39mline [0m[1;36m2847[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - Uses `& ~[0m[1;36m1[0m[39m` [0m[1;39m([0m[1;36m2[0m[39m-byte alignment for UTF-[0m[1;36m16[0m[1;39m)[0m[39m instead of `& ~[0m[1;36m3[0m[39m` [0m[1;39m([0m[1;36m4[0m[39m-byte alignment [0m [2m                [0m
[2;36m                    [0m         [39mfor UTF-[0m[1;36m32[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Unsafe BOM check** [0m[1;39m([0m[39mline [0m[1;36m2852[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - Accesses [0m[1;36m4[0m[39m bytes without verifying input length[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Broken surrogate pair handling** [0m[1;39m([0m[39mlines [0m[1;36m2882[0m[39m-[0m[1;36m2910[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Insufficient input length check [0m[1;39m([0m[39mline [0m[1;36m2888[0m[39m: checks [0m[1;36m4[0m[39m bytes, needs [0m[1;36m8[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m   - Reads only [0m[1;36m2[0m[39m bytes for second surrogate instead of [0m[1;36m4[0m[39m bytes [0m[1;39m([0m[39mline [0m[1;36m2890[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m   - Writes raw bytes instead of proper UTF-[0m[1;36m8[0m[39m encoding [0m[1;39m([0m[39mlines [0m[1;36m2904[0m[39m-[0m[1;36m2907[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m   - Advances input pointer by [0m[1;36m4[0m[39m instead of [0m[1;36m8[0m[39m [0m[1;39m([0m[39mline [0m[1;36m2908[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Wrong error codes** [0m[1;39m([0m[39mlines [0m[1;36m2885[0m[39m, [0m[1;36m2892[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - Returns `XML_ERR_INTERNAL_ERROR` instead of `XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m`[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Critical Context:[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAll other encoding functions in libxml2 [0m[1;39m([0m[39mUTF16LEToUTF8, UTF16BEToUTF8, UTF8ToUTF32,[0m [2m                [0m
[2;36m                    [0m         [39mUTF8ToISO8859x, etc.[0m[1;39m)[0m[39m properly implement boundary checking by:[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Calculating `outend = out + *outlen` at function start[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Checking boundaries before each write operation[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Breaking/returning when insufficient space is detected[0m                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Returning `XML_ENC_ERR_SPACE` to trigger buffer growth[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mUTF32ToUTF8 is the **only** encoding function missing these safety measures.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Add Output Buffer Boundary Calculation[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** After line [0m[1;36m2848[0m[39m in `encoding.c`[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd the missing output buffer end pointer calculation:[0m                              [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39munsigned char *outend = out + *outlen;[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis establishes the boundary that all write operations must respect.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Fix Input Length Alignment[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Line [0m[1;36m2847[0m[39m in `encoding.c`[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mChange the input length calculation from [0m[1;36m2[0m[39m-byte to [0m[1;36m4[0m[39m-byte alignment:[0m                [2m                [0m
[2;36m                    [0m         [39m- **Current:** `const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;`[0m                   [2m                [0m
[2;36m                    [0m         [39m- **Fixed:** `const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m3[0m[1;39m)[0m[39m;`[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mUTF-[0m[1;36m32[0m[39m uses [0m[1;36m4[0m[39m-byte characters, so alignment must be on [0m[1;36m4[0m[39m-byte boundaries.[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m3[0m[39m: Add Boundary Check for BOM Access[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Before line [0m[1;36m2852[0m[39m in `encoding.c`[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mProtect the BOM check with an input length validation:[0m                              [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39m*inlen >= [0m[1;36m4[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m!= [0m[1;36m0x20[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[39m* bom is managed already *[0m[35m/[0m                                                    [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis prevents reading beyond available input data.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m4[0m[39m: Add Boundary Check Before Single-Byte Write[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Before line [0m[1;36m2868[0m[39m in `encoding.c`[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd boundary validation before writing [0m[1;36m1[0m[39m-byte UTF-[0m[1;36m8[0m[39m sequences [0m[1;39m([0m[39mcharacters < [0m[1;36m0x80[0m[1;39m)[0m[39m:[0m  [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        break;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m    out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m    in += [0m[1;36m4[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m    out += [0m[1;36m1[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis check is critical as it prevents the exact overflow reported at line [0m[1;36m2868[0m[39m.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m5[0m[39m: Add Boundary Check Before Two-Byte Write[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Before line [0m[1;36m2872[0m[39m in `encoding.c`[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd boundary validation before writing [0m[1;36m2[0m[39m-byte UTF-[0m[1;36m8[0m[39m sequences [0m[1;39m([0m[39mcharacters < [0m[1;36m0x800[0m[1;39m)[0m[39m:[0m [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39melse if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39moutend - out < [0m[1;36m2[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [39m        break;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m    out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m    out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m    in += [0m[1;36m4[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m    out += [0m[1;36m2[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m6[0m[39m: Add Boundary Check Before Three-Byte Write[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Before line [0m[1;36m2877[0m[39m in `encoding.c`[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd boundary validation before writing [0m[1;36m3[0m[39m-byte UTF-[0m[1;36m8[0m[39m sequences [0m[1;39m([0m[39mnon-surrogate [0m       [2m                [0m
[2;36m                    [0m         [39mcharacters in BMP[0m[1;39m)[0m[39m:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39melse if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39moutend - out < [0m[1;36m3[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [39m        break;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m    out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m    out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m    out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m    in += [0m[1;36m4[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m    out += [0m[1;36m3[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m7[0m[39m: Fix Surrogate Pair Handling[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Lines [0m[1;36m2882[0m[39m-[0m[1;36m2910[0m[39m in `encoding.c`[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis is the most complex fix involving multiple changes:[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39ma[0m[1;39m)[0m[39m **Fix input length check** [0m[1;39m([0m[39mline [0m[1;36m2888[0m[1;39m)[0m[39m:[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Change from `if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m[39m` to `if [0m[1;39m([0m[39minend - in < [0m[1;36m8[0m[1;39m)[0m[39m`[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Surrogate pairs require [0m[1;36m2[0m[39m UTF-[0m[1;36m32[0m[39m characters = [0m[1;36m8[0m[39m bytes[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mb[0m[1;39m)[0m[39m **Fix second surrogate reading** [0m[1;39m([0m[39mline [0m[1;36m2890[0m[1;39m)[0m[39m:[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - Current reads only [0m[1;36m2[0m[39m bytes: `d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;`[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Must read [0m[1;36m4[0m[39m bytes from next UTF-[0m[1;36m32[0m[39m character: `d = in[0m[1;39m[[0m[1;36m4[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m5[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39min[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m << [0m[1;36m16[0m[1;39m)[0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m7[0m[1;39m][0m[39m << [0m[1;36m24[0m[1;39m)[0m[39m;`[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mc[0m[1;39m)[0m[39m **Add boundary check before four-byte write**:[0m                                   [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m       break;[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39md[0m[1;39m)[0m[39m **Replace raw byte writing with proper UTF-[0m[1;36m8[0m[39m encoding**:[0m                         [2m                [0m
[2;36m                    [0m         [39m   - Remove lines [0m[1;36m2904[0m[39m-[0m[1;36m2907[0m[39m [0m[1;39m([0m[39mraw byte copying[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Uncomment and use lines [0m[1;36m2898[0m[39m-[0m[1;36m2902[0m[39m [0m[1;39m([0m[39mproper UTF-[0m[1;36m8[0m[39m encoding formula[0m[1;39m)[0m[39m:[0m             [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m   out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m   out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m   out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m   out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39me[0m[1;39m)[0m[39m **Fix input pointer advancement** [0m[1;39m([0m[39mline [0m[1;36m2908[0m[1;39m)[0m[39m:[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Change from `in += [0m[1;36m4[0m[39m` to `in += [0m[1;36m8[0m[39m`[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - Consumed [0m[1;36m2[0m[39m UTF-[0m[1;36m32[0m[39m characters [0m[1;39m([0m[39mhigh + low surrogate[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m8[0m[39m: Fix Error Codes[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Lines [0m[1;36m2885[0m[39m and [0m[1;36m2892[0m[39m in `encoding.c`[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace incorrect error code with proper encoding error:[0m                            [2m                [0m
[2;36m                    [0m         [39m- **Current:** `ret = XML_ERR_INTERNAL_ERROR;`[0m                                      [2m                [0m
[2;36m                    [0m         [39m- **Fixed:** `ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;`[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis aligns with error handling in other encoding functions and allows proper error[0m [2m                [0m
[2;36m                    [0m         [39mreporting.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m9[0m[39m: Ensure Proper Return Value Handling[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Lines [0m[1;36m2913[0m[39m-[0m[1;36m2914[0m[39m in `encoding.c`[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe existing logic is correct but needs clarification:[0m                              [2m                [0m
[2;36m                    [0m         [39m- When the loop breaks due to insufficient output space, `ret` remains [0m             [2m                [0m
[2;36m                    [0m         [39m`XML_ENC_ERR_SPACE`[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- This signals the caller to grow the buffer and retry[0m                              [2m                [0m
[2;36m                    [0m         [39m- Only update `ret` to success value when input was successfully processed[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe current implementation at lines [0m[1;36m2913[0m[39m-[0m[1;36m2914[0m[39m already handles this correctly.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Is the Optimal Approach:[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Follows Established Patterns:** The fix replicates the boundary checking logic[0m [2m                [0m
[2;36m                    [0m         [39mused in UTF16LEToUTF8, UTF16BEToUTF8, UTF8ToUTF32, and all other encoding functions[0m [2m                [0m
[2;36m                    [0m         [39min libxml2. This ensures consistency and maintainability.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Minimal Impact:** Changes are localized to the UTF32ToUTF8 function only. No [0m  [2m                [0m
[2;36m                    [0m         [39mmodifications to:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - Buffer allocation logic [0m[1;39m([0m[39mbuf.c[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m   - Encoding handler infrastructure [0m[1;39m([0m[39mxmlCharEncInput, xmlEncInputChunk[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m   - HTML/XML parser code[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - Fuzzing harness or test code[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves Existing Logic:** The core conversion algorithm remains unchanged. [0m  [2m                [0m
[2;36m                    [0m         [39mWe only add safety checks that were missing.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Fixes Root Cause:** Addresses the actual buffer overflow at line [0m[1;36m2868[0m[39m and [0m     [2m                [0m
[2;36m                    [0m         [39mprevents all similar overflows throughout the function.[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Restores Correct Encoding:** The surrogate pair fix restores the commented-out[0m [2m                [0m
[2;36m                    [0m         [39mproper UTF-[0m[1;36m8[0m[39m encoding that was disabled due to unspecified [0m[32m"encoding errors"[0m[39m. The [0m  [2m                [0m
[2;36m                    [0m         [39mreal issue was likely the missing boundary checks, not the encoding formula.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Preserves Existing Codebase Logic:[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- The encoding conversion algorithm remains intact[0m                                  [2m                [0m
[2;36m                    [0m         [39m- The function signature and return values are unchanged[0m                            [2m                [0m
[2;36m                    [0m         [39m- Error handling mechanism [0m[1;39m([0m[39mXML_ENC_ERR_SPACE triggering buffer growth[0m[1;39m)[0m[39m is [0m         [2m                [0m
[2;36m                    [0m         [39mpreserved[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m- Integration with xmlCharEncInput and the encoding handler system is maintained[0m    [2m                [0m
[2;36m                    [0m         [39m- All test cases will continue to work with proper boundary protection[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Issues:[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Heap-buffer-overflow at line [0m[1;36m2868[0m[39m:** Fixed by adding `if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m[39m [0m       [2m                [0m
[2;36m                    [0m         [39mbreak;` check[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- **[0m[1;36m6001[0m[39m-byte buffer exceeded by [0m[1;36m1[0m[39m byte:** Prevented by all boundary checks [0m        [2m                [0m
[2;36m                    [0m         [39mensuring writes stay within allocated space[0m                                         [2m                [0m
[2;36m                    [0m         [39m- **XML_ENC_ERR_SPACE not returned:** Fixed by breaking from loop when space [0m       [2m                [0m
[2;36m                    [0m         [39minsufficient, allowing ret to remain XML_ENC_ERR_SPACE[0m                              [2m                [0m
[2;36m                    [0m         [39m- **Buffer growth mechanism:** Now functions correctly when UTF32ToUTF8 properly [0m   [2m                [0m
[2;36m                    [0m         [39msignals insufficient space[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation:[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Incomplete conversions:** When output buffer is too small, conversion will be [0m [2m                [0m
[2;36m                    [0m         [39mpartial[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation:** This is the intended behavior. The caller [0m[1;39m([0m[39mxmlCharEncInput[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mwill grow the buffer and retry, as designed.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Performance impact:** Additional boundary checks on every write[0m                [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation:** Negligible - these are simple pointer comparisons. All other [0m  [2m                [0m
[2;36m                    [0m         [39mencoding functions have the same checks without performance issues.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **UTF-[0m[1;36m32[0m[39m surrogate pair handling change:** Previously wrote raw bytes, now [0m      [2m                [0m
[2;36m                    [0m         [39mwrites proper UTF-[0m[1;36m8[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation:** This is a bug fix, not a side effect. The commented code shows[0m [2m                [0m
[2;36m                    [0m         [39mthis was the original intent. Any code relying on the buggy behavior was already [0m   [2m                [0m
[2;36m                    [0m         [39mincorrect.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix directly mirrors implementations in:[0m                                        [2m                [0m
[2;36m                    [0m         [39m- **UTF16LEToUTF8** [0m[1;39m([0m[39mlines [0m[1;36m2227[0m[39m-[0m[1;36m2293[0m[1;39m)[0m[39m: Identical structure with boundary checks [0m    [2m                [0m
[2;36m                    [0m         [39mbefore each write[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- **UTF16BEToUTF8** [0m[1;39m([0m[39mlines [0m[1;36m2421[0m[39m-[0m[1;36m2487[0m[1;39m)[0m[39m: Same pattern with different byte order[0m       [2m                [0m
[2;36m                    [0m         [39m- **UTF8ToUTF32** [0m[1;39m([0m[39mlines [0m[1;36m2738[0m[39m-[0m[1;36m2840[0m[1;39m)[0m[39m: Shows the inverse conversion with proper [0m      [2m                [0m
[2;36m                    [0m         [39mchecks[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m- **UTF8ToUTF16LE** [0m[1;39m([0m[39mlines [0m[1;36m2295[0m[39m-[0m[1;36m2396[0m[1;39m)[0m[39m: Demonstrates correct surrogate pair [0m         [2m                [0m
[2;36m                    [0m         [39mgeneration[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAll these functions successfully prevent buffer overflows using the same boundary [0m  [2m                [0m
[2;36m                    [0m         [39mchecking pattern.[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=704248;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=804178;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=411206;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=408366;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp1fmy42kl[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/libxml2_lx-delta-03_vuln_004/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768025862.6306877[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/libxml2_lx-delta-03_vuln_004.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-libxml2[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/10/26 06:17:44][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mlibxml2[0m        ]8;id=701122;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=273807;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=124415;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=86018;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mlibxml2[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=857964;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=900027;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m                [2m               [0m
