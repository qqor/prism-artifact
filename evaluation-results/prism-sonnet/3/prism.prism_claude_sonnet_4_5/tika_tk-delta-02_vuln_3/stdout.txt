[2;36m[01/10/26 12:20:49][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=446082;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=369157;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpbc6lacoj[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-delta-02_vuln_3/[0m[95magent[0m [2m               [0m
[2;36m                    [0m         [95m-output-1768047649.1684837[0m                                                           [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/tika_tk-delta-02_vuln_3.toml [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=512300;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=271506;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 12:22:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Took [1;36m90.17[0m  ]8;id=367188;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=316749;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=967073;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=628536;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=560253;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=92996;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=865448;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=773462;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m90[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=511167;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=922820;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 12:22:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.99[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=250879;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=573971;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 12:22:22][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=729650;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=907948;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=320893;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=410333;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=481109;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=32067;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=463215;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=683535;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 12:22:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.36[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=139702;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=30641;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 12:22:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=583846;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=493247;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 12:22:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.94[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=668962;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=619969;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 12:22:34][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=141311;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=33293;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazzer.com:[1;36m80[0m                                              [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:583[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:183[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/sun.net.www.http.HttpClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getHeaderField[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:3221[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URLConnection.getContentType[0m[1;39m([0m[39mURLConnection.jav[0m[1;92ma:520[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.io.TikaInputStream.get[0m[1;39m([0m[39mTikaInputStream.jav[0m[1;92ma:606[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.io.TikaInputStream.get[0m[1;39m([0m[39mTikaInputStream.jav[0m[1;92ma:570[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser.handleLink[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:170[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser._parse[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:92[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser.parse[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:77[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.M3U8ParserFuzzer.parseOne[0m[1;39m([0m[39mM3U8ParserFuzzer.jav[0m[1;92ma:64[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.M3U8ParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mM3U8ParserFuzzer.jav[0m[1;92ma:39[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b782adc79e9c6729[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazzer.com:[0m[1;36m80[0m                                              [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init[0m[1m>[0m[1m([0mHttpClient.jav[1;92ma:246[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.New[0m[1m([0mHttpClient.jav[1;92ma:351[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.New[0m[1m([0mHttpClient.jav[1;92ma:373[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1m([0mHttpURLConne [2m                [0m
[2;36m                    [0m         ction.jav[1;92ma:1309[0m[1m)[0m                                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1m([0mHttpURLConnecti [2m                [0m
[2;36m                    [0m         on.jav[1;92ma:1242[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1m([0mHttpURLConnectio [2m                [0m
[2;36m                    [0m         n.jav[1;92ma:1128[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1m([0mHttpURLConnection.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1m([0mHttpURLConnec [2m                [0m
[2;36m                    [0m         tion.jav[1;92ma:1665[0m[1m)[0m                                                                     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1m([0mHttpURLConnect [2m                [0m
[2;36m                    [0m         ion.jav[1;92ma:1589[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35msun.net.www.protocol.http.HttpURLConnection.getHeaderField[0m[1m([0mHttpURLConnect [2m                [0m
[2;36m                    [0m         ion.jav[1;92ma:3221[0m[1m)[0m                                                                      [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.URLConnection.getContentType[0m[1m([0mURLConnection.jav[1;92ma:520[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.io.TikaInputStream.get[0m[1m([0mTikaInputStream.jav[1;92ma:606[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.io.TikaInputStream.get[0m[1m([0mTikaInputStream.jav[1;92ma:570[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.m3.M3U8Parser.handleLink[0m[1m([0mM3U8Parser.jav[1;92ma:170[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.m3.M3U8Parser._parse[0m[1m([0mM3U8Parser.jav[1;92ma:92[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.m3.M3U8Parser.parse[0m[1m([0mM3U8Parser.jav[1;92ma:77[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.M3U8ParserFuzzer.parseOne[0m[1m([0mM3U8ParserFuzzer.jav[1;92ma:64[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.M3U8ParserFuzzer.fuzzerTestOneInput[0m[1m([0mM3U8ParserFuzzer.jav[1;92ma:39[0m[1m)[0m           [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: b782adc79e9c6729                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 12:22:50][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=297209;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=837194;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 12:26:43][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=861205;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=294040;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 12:27:11][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=187193;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=773675;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=281962;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=293787;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 12:27:12][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.96[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=968187;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=989871;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=161696;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=487002;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp1t_ldli2[0m                                                 ]8;id=759667;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=627859;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 12:28:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m67.39[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=669056;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=638999;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Started[33m...[0m                          ]8;id=820142;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=932958;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 12:28:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Took [1;36m35.05[0m seconds;                ]8;id=364994;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=411388;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Started[33m...[0m                             ]8;id=722579;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=148241;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 12:29:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Took [1;36m8.59[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=584647;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=165584;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Started[33m...[0m                                 ]8;id=642001;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=919371;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=916990;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=192252;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=966169;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=656121;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 12:29:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.03[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=662242;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=208034;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 12:29:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=355042;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=378258;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 12:29:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.01[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=355384;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=678275;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=171054;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=561700;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 12:29:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.92[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=575047;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=103337;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 12:29:09][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=508160;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=325576;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         ---                                                                                 [2m                [0m
[2;36m                    [0m         a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audi [2m                [0m
[2;36m                    [0m         ovideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.java               [2m                [0m
[2;36m                    [0m         +++                                                                                 [2m                [0m
[2;36m                    [0m         b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audi [2m                [0m
[2;36m                    [0m         ovideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.java               [2m                [0m
[2;36m                    [0m         @@ [1;36m-161[0m,[1;36m17[0m +[1;36m161[0m,[1;36m9[0m @@                                                                [2m                [0m
[2;36m                    [0m                  [35m/[0m[35m/[0m split on , then the first value is the length [1m([0mcan be [1;36m-1[0m[1m)[0m,              [2m                [0m
[2;36m                    [0m                  [35m/[0m[35m/[0m the last value is the title; intermediate values are [33mkey[0m=[35mvalue[0m format   [2m                [0m
[2;36m                    [0m                  [1;35mmetadata.add[0m[1m([0mPLAY_LIST_LINK, nextLine[1m)[0m;                                    [2m                [0m
[2;36m                    [0m         -        if [1m([0m! [1;35mnextLine.startsWith[0m[1m([0m[32m"http"[0m[1m)[0m[1m)[0m [1m{[0m                                       [2m                [0m
[2;36m                    [0m         -            return;                                                                [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         -        EmbeddedDocumentExtractor ex =                                             [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1m([0mcontext[1m)[0m;                         [2m                [0m
[2;36m                    [0m         -        Metadata m = new [1;35mMetadata[0m[1m([0m[1m)[0m;                                               [2m                [0m
[2;36m                    [0m         -        if [1m([0m[1;35mex.shouldParseEmbedded[0m[1m([0mm[1m)[0m[1m)[0m [1m{[0m                                           [2m                [0m
[2;36m                    [0m         -            try [1m([0mTikaInputStream tis = [1;35mTikaInputStream.get[0m[1m([0mnew [1;35mURL[0m[1m([0mnextLine[1m)[0m[1m)[0m[1m)[0m [1m{[0m   [2m                [0m
[2;36m                    [0m         -                [1;35mex.parseEmbedded[0m[1m([0mtis, new [1;35mBodyContentHandler[0m[1m([0mnew                   [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedContentHandler[0m[1m([0mxhtml[1m)[0m[1m)[0m, m,                                                  [2m                [0m
[2;36m                    [0m         -                        true[1m)[0m;                                                     [2m                [0m
[2;36m                    [0m         -            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m URL fetching removed for security: URLs are now only stored in metadata [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m to prevent SSRF attacks. Applications can retrieve URLs from metadata   [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m and implement their own validation and fetching if needed.              [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              private String [1;35mgetNextContentLine[0m[1m([0mBufferedReader reader[1m)[0m throws IOException [1m{[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium:      [2m                [0m
[2;36m                    [0m         Server Side Request Forgery [1m([0mSSRF[1m)[0m                                                  [2m                [0m
[2;36m                    [0m         Attempted connection to: jazzer.com:[1;36m80[0m                                              [2m                [0m
[2;36m                    [0m         Requests to destinations based on untrusted data could lead to exfiltration of      [2m                [0m
[2;36m                    [0m         sensitive data or exposure of internal services.                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1m([0mServerSi [2m                [0m
[2;36m                    [0m         deRequestForgery.jav[1;92ma:127[0m[1m)[0m                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1m([0mSe [2m                [0m
[2;36m                    [0m         rverSideRequestForgery.jav[1;92ma:71[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:633[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.net.Socket.connect[0m[1m([0mSocket.jav[1;92ma:583[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.NetworkClient.doConnect[0m[1m([0mNetworkClient.jav[1;92ma:183[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:498[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/[1;35msun.net.www.http.HttpClient.openServer[0m[1m([0mHttpClient.jav[1;92ma:603[0m[1m)[0m    [2m                [0m
[2;36m                    [0m                 at java.base/sun.net.www.http.HttpClient.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getHeaderField[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:3221[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URLConnection.getContentType[0m[1;39m([0m[39mURLConnection.jav[0m[1;92ma:520[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.io.TikaInputStream.get[0m[1;39m([0m[39mTikaInputStream.jav[0m[1;92ma:606[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.io.TikaInputStream.get[0m[1;39m([0m[39mTikaInputStream.jav[0m[1;92ma:570[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser.handleLink[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:170[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser._parse[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:92[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser.parse[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:77[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.M3U8ParserFuzzer.parseOne[0m[1;39m([0m[39mM3U8ParserFuzzer.jav[0m[1;92ma:64[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.M3U8ParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mM3U8ParserFuzzer.jav[0m[1;92ma:39[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b782adc79e9c6729[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability has been detected in the Apache [0m [2m                [0m
[2;36m                    [0m         [39mTika M3U8 parser. The fuzzer identified that the parser attempts to make an [0m        [2m                [0m
[2;36m                    [0m         [39mexternal HTTP connection to `jazzer.com:[0m[1;36m80[0m[39m` when processing specially crafted M3U8 [0m [2m                [0m
[2;36m                    [0m         [39minput, indicating that the parser can be manipulated to make requests to arbitrary [0m [2m                [0m
[2;36m                    [0m         [39mdestinations based on untrusted input data.[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue represents a Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m vulnerability with medium[0m [2m                [0m
[2;36m                    [0m         [39mseverity. SSRF vulnerabilities occur when an application can be manipulated to make[0m [2m                [0m
[2;36m                    [0m         [39mrequests to unintended destinations, potentially leading to exfiltration of [0m        [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services that should not be accessible from [0m [2m                [0m
[2;36m                    [0m         [39moutside the network.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe stack trace reveals the following execution flow:[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer invokes `[0m[1;35mM3U8ParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` with crafted input[0m    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. This calls `[0m[1;35mM3U8ParserFuzzer.parseOne[0m[1;39m([0m[1;39m)[0m[39m` which initiates the parsing process[0m     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The `[0m[1;35mM3U8Parser.parse[0m[1;39m([0m[1;39m)[0m[39m` method begins processing the M3U8 content[0m               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. During parsing, `[0m[1;35mM3U8Parser._parse[0m[1;39m([0m[1;39m)[0m[39m` is executed[0m                                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. The parser encounters a link and calls `[0m[1;35mM3U8Parser.handleLink[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m170[0m     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. This triggers `[0m[1;35mTikaInputStream.get[0m[1;39m([0m[1;39m)[0m[39m` methods [0m[1;39m([0m[39mlines [0m[1;36m570[0m[39m and [0m[1;36m606[0m[1;39m)[0m[39m which attempt [0m [2m                [0m
[2;36m                    [0m         [39mto open the URL[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. The code retrieves the content type via `[0m[1;35mURLConnection.getContentType[0m[1;39m([0m[1;39m)[0m[39m`[0m         [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m. This initiates an HTTP connection through `[0m[1;35mHttpURLConnection.getHeaderField[0m[1;39m([0m[1;39m)[0m[39m`[0m   [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m. The connection attempt proceeds through the Java networking stack, ultimately [0m   [2m                [0m
[2;36m                    [0m         [39mcalling `[0m[1;35mSocket.connect[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m. At this point, the Jazzer sanitizer detects the SSRF attempt to `jazzer.com:[0m[1;36m80[0m[39m`[0m [2m                [0m
[2;36m                    [0m         [39mand throws the security exception[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe key observation is that the M3U8 parser processes links contained within M3U8 [0m  [2m                [0m
[2;36m                    [0m         [39mfiles and attempts to retrieve content from these URLs without proper validation or[0m [2m                [0m
[2;36m                    [0m         [39msanitization. The parser appears to trust the URL values embedded in the M3U8 [0m      [2m                [0m
[2;36m                    [0m         [39mcontent and automatically attempts to establish connections to these destinations.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a holistic view of this issue, the following components should be [0m          [2m                [0m
[2;36m                    [0m         [39minvestigated:[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **[0m[1;35mM3U8Parser.handleLink[0m[1;39m([0m[1;39m)[0m[39m method** [0m[1;39m([0m[39mline [0m[1;36m170[0m[39m in M3U8Parser.java[0m[1;39m)[0m[39m - This is where[0m [2m                [0m
[2;36m                    [0m         [39mthe link processing is initiated and should be examined to understand how URLs from[0m [2m                [0m
[2;36m                    [0m         [39mM3U8 content are extracted and handled[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **[0m[1;35mM3U8Parser._parse[0m[1;39m([0m[1;39m)[0m[39m method** [0m[1;39m([0m[39mline [0m[1;36m92[0m[1;39m)[0m[39m - This contains the core parsing logic [0m [2m                [0m
[2;36m                    [0m         [39mthat identifies and processes links within M3U8 files[0m                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **[0m[1;35mTikaInputStream.get[0m[1;39m([0m[1;39m)[0m[39m methods** [0m[1;39m([0m[39mlines [0m[1;36m570[0m[39m and [0m[1;36m606[0m[39m in TikaInputStream.java[0m[1;39m)[0m[39m - [0m [2m                [0m
[2;36m                    [0m         [39mThese methods handle the actual URL connection establishment and should be reviewed[0m [2m                [0m
[2;36m                    [0m         [39mfor any existing validation mechanisms[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. The M3U8 file format handling logic to understand what types of URLs or links [0m   [2m                [0m
[2;36m                    [0m         [39mare expected and how they are specified in the input format[0m                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Any URL validation, sanitization, or allow-listing mechanisms that may or may [0m   [2m                [0m
[2;36m                    [0m         [39mnot be present in the codebase[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Configuration options or settings that might control whether external URL [0m       [2m                [0m
[2;36m                    [0m         [39mresolution is enabled or restricted[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueMedium: [0m     [2m                [0m
[2;36m                    [0m         [39mServer Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39mAttempted connection to: jazzer.com:[0m[1;36m80[0m                                              [2m                [0m
[2;36m                    [0m         [39mRequests to destinations based on untrusted data could lead to exfiltration of [0m     [2m                [0m
[2;36m                    [0m         [39msensitive data or exposure of internal services.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrf[0m[1;39m([0m[39mServerSi[0m [2m                [0m
[2;36m                    [0m         [39mdeRequestForgery.jav[0m[1;92ma:127[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery.checkSsrfSocket[0m[1;39m([0m[39mSe[0m [2m                [0m
[2;36m                    [0m         [39mrverSideRequestForgery.jav[0m[1;92ma:71[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:633[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.Socket.connect[0m[1;39m([0m[39mSocket.jav[0m[1;92ma:583[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.NetworkClient.doConnect[0m[1;39m([0m[39mNetworkClient.jav[0m[1;92ma:183[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:498[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.openServer[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:603[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/sun.net.www.http.HttpClient.<init>[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:246[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:351[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35msun.net.www.http.HttpClient.New[0m[1;39m([0m[39mHttpClient.jav[0m[1;92ma:373[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getNewHttpClient[0m[1;39m([0m[39mHttpURLConne[0m [2m                [0m
[2;36m                    [0m         [39mction.jav[0m[1;92ma:1309[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect0[0m[1;39m([0m[39mHttpURLConnecti[0m [2m                [0m
[2;36m                    [0m         [39mon.jav[0m[1;92ma:1242[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.plainConnect[0m[1;39m([0m[39mHttpURLConnectio[0m [2m                [0m
[2;36m                    [0m         [39mn.jav[0m[1;92ma:1128[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.connect[0m[1;39m([0m[39mHttpURLConnection.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1057[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream0[0m[1;39m([0m[39mHttpURLConnec[0m [2m                [0m
[2;36m                    [0m         [39mtion.jav[0m[1;92ma:1665[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getInputStream[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:1589[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35msun.net.www.protocol.http.HttpURLConnection.getHeaderField[0m[1;39m([0m[39mHttpURLConnect[0m [2m                [0m
[2;36m                    [0m         [39mion.jav[0m[1;92ma:3221[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.net.URLConnection.getContentType[0m[1;39m([0m[39mURLConnection.jav[0m[1;92ma:520[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.io.TikaInputStream.get[0m[1;39m([0m[39mTikaInputStream.jav[0m[1;92ma:606[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.io.TikaInputStream.get[0m[1;39m([0m[39mTikaInputStream.jav[0m[1;92ma:570[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser.handleLink[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:170[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser._parse[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:92[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.m3.M3U8Parser.parse[0m[1;39m([0m[39mM3U8Parser.jav[0m[1;92ma:77[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.M3U8ParserFuzzer.parseOne[0m[1;39m([0m[39mM3U8ParserFuzzer.jav[0m[1;92ma:64[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.M3U8ParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mM3U8ParserFuzzer.jav[0m[1;92ma:39[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: b782adc79e9c6729[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m48[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.m3;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.BufferedReader;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStreamReader;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.text.DecimalFormat;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.text.NumberFormat;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.metadata.XMPDM;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.sax.BodyContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.sax.EmbeddedContentHandler;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.jav[0m[1;92ma:72[0m[39m-[0m[1;36m111[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, metadata[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;35mxhtml.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;35m_parse[0m[1;39m([0m[39mstream, xhtml, metadata, context[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        [0m[1;35mxhtml.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private void [0m[1;35m_parse[0m[1;39m([0m[39mInputStream stream, XHTMLContentHandler xhtml, Metadata [0m [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                        ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        try [0m[1;39m([0m[39mBufferedReader reader = new [0m[1;35mBufferedReader[0m[1;39m([0m[39mnew [0m                     [2m                [0m
[2;36m                    [0m         [1;35mInputStreamReader[0m[1;39m([0m[39mstream,[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                StandardCharsets.UTF_8[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            String line = [0m[1;35mreader.readLine[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            while [0m[1;39m([0m[39mline != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[32m"##"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                    [0m[35m/[0m[35m/[0m[95mcomment[0m[39m -- do nothing[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mTAR[0m[1;33mGET[0m[39m_DURATION[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                    [0m[1;35mparseDuration[0m[1;39m([0m[39mTAR[0m[1;33mGET[0m[39m_DURATION, line, metadata[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mEXTINF[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                    [0m[1;35mhandleLink[0m[1;39m([0m[39mline, reader, xhtml, metadata, context[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mENDLIST[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                    break;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mEXTVERSION[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                    Integer val = [0m[1;35mgetInt[0m[1;39m([0m[39mEXTVERSION, line[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:                    if [0m[1;39m([0m[39mval != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                        [0m[1;35mmetadata.set[0m[1;39m([0m[39mM3U8_VERSION, val[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mEXTKEY[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                    [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.IS_ENCRYPTED, true[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.startsWith[0m[1;39m([0m[39mEXTPLAYLISTTYPE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                    String t = [0m[1;35mline.substring[0m[1;39m([0m[1;35mEXTPLAYLISTTYPE.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                    if [0m[1;39m([0m[39m![0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mt[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                        [0m[1;35mmetadata.set[0m[1;39m([0m[39mPLAY_LIST_TYPE, t[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                line = [0m[1;35mreader.readLine[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.jav[0m[1;92ma:153[0m[39m-[0m[1;36m175[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    private void [0m[1;35mhandleLink[0m[1;39m([0m[39mString line, BufferedReader reader,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                            XHTMLContentHandler xhtml, Metadata metadata,[0m       [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                            ParseContext context[0m[1;39m)[0m[39m throws IOException, [0m          [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        String nextLine = [0m[1;35mgetNextContentLine[0m[1;39m([0m[39mreader[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        if [0m[1;39m([0m[39mnextLine == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[35m/[0m[35m/[0m[95mTODO[0m[39m -- parse contents in EXTINF line[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        [0m[35m/[0m[35m/[0m[39m split on , then the first value is the length [0m[1;39m([0m[39mcan be [0m[1;36m-1[0m[1;39m)[0m[39m,[0m           [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[35m/[0m[35m/[0m[39m the last value is the title; intermediate values are [0m[33mkey[0m[39m=[0m[35mvalue[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mformat[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:        [0m[1;35mmetadata.add[0m[1;39m([0m[39mPLAY_LIST_LINK, nextLine[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mnextLine.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        EmbeddedDocumentExtractor ex = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        if [0m[1;39m([0m[1;35mex.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mnew [0m[1;35mURL[0m[1;39m([0m[39mnextLine[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                [0m[1;35mex.parseEmbedded[0m[1;39m([0m[39mtis, new [0m[1;35mBodyContentHandler[0m[1;39m([0m[39mnew [0m               [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedContentHandler[0m[1;39m([0m[39mxhtml[0m[1;39m)[0m[1;39m)[0m[39m, m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                        true[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/io/TikaInputStream.jav[0m[1;92ma:19[0m[39m-[0m[1;36m45[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static java.nio.file.StandardCopyOption.REPLACE_EXISTING;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.FileInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.FileNotFoundException;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.net.URI;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.net.URISyntaxException;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.net.URLConnection;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.sql.Blob;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.sql.SQLException;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.io.input.TaggedInputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.io.input.UnsynchronizedByteArrayInputStream;[0m           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/io/TikaInputStream.jav[0m[1;92ma:560[0m[39m-[0m[1;36m620[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:     * Creates a TikaInputStream from the resource at the given URL.[0m            [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:     * Note that you must always explicitly close the returned stream as in[0m     [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:     * some cases it may end up writing the resource to a temporary file.[0m       [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:     * @param url resource URL[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m566[0m[39m:     * @return a TikaInputStream instance[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m567[0m[39m:     * @throws IOException if the resource can not be accessed[0m                  [2m                [0m
[2;36m                    [0m         [1;36m568[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m569[0m[39m:    public static TikaInputStream [0m[1;35mget[0m[1;39m([0m[39mURL url[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m570[0m[39m:        return [0m[1;35mget[0m[1;39m([0m[39murl, new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m571[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m572[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m573[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m574[0m[39m:     * Creates a TikaInputStream from the resource at the given URL. The[0m        [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:     * available input metadata is stored in the given metadata instance.[0m       [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:     * Note that you must always explicitly close the returned stream as in[0m     [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:     * some cases it may end up writing the resource to a temporary file.[0m       [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:     * @param url      resource URL[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:     * @param metadata metadata instance[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:     * @return a TikaInputStream instance[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:     * @throws IOException if the resource can not be accessed[0m                  [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:    public static TikaInputStream [0m[1;35mget[0m[1;39m([0m[39mURL url, Metadata metadata[0m[1;39m)[0m[39m throws [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:        [0m[35m/[0m[35m/[0m[39m Special handling for [0m[4;94mfile://[0m[39m URLs[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:        if [0m[1;39m([0m[32m"file"[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[1;35murl.getProtocol[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:                Path path = [0m[1;35mPaths.get[0m[1;39m([0m[1;35murl.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:                if [0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mpath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:                    return [0m[1;35mget[0m[1;39m([0m[39mpath, metadata[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mURISyntaxException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m594[0m[39m:                [0m[35m/[0m[35m/[0m[39m fall through[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m595[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m596[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m597[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:        URLConnection connection = [0m[1;35murl.openConnection[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:        String path = [0m[1;35murl.getPath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m601[0m[39m:        int slash = [0m[1;35mpath.lastIndexOf[0m[1;39m([0m[32m'/'[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m602[0m[39m:        if [0m[1;39m([0m[39mslash + [0m[1;36m1[0m[39m < [0m[1;35mpath.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[39m works even with [0m[1;36m-1[0m[39m![0m                 [2m                [0m
[2;36m                    [0m         [1;36m603[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY, [0m                 [2m                [0m
[2;36m                    [0m         [1;35mpath.substring[0m[1;39m([0m[39mslash + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m604[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m605[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m606[0m[39m:        String type = [0m[1;35mconnection.getContentType[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m607[0m[39m:        if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m608[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, type[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m609[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m610[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m611[0m[39m:        String encoding = [0m[1;35mconnection.getContentEncoding[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m612[0m[39m:        if [0m[1;39m([0m[39mencoding != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m613[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_ENCODING, encoding[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m614[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m615[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m616[0m[39m:        int length = [0m[1;35mconnection.getContentLength[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m617[0m[39m:        if [0m[1;39m([0m[39mlength >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m618[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_LENGTH, [0m[1;35mInteger.toString[0m[1;39m([0m[39mlength[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m619[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m620[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:19[0m[39m-[0m[1;36m78[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static org.apache.tika.sax.XHTMLContentHandler.XHTML;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.FilenameFilter;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.xml.sax.helpers.AttributesImpl;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.exception.CorruptedFileException;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.exception.EncryptedDocumentException;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.parser.DelegatingParser;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.parser.ParseRecord;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.sax.BodyContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.sax.EmbeddedContentHandler;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m: * Helper class for parsers of package archives or other compound document[0m       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m: * formats that support embedded or attached component documents.[0m                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m: * @since Apache Tika [0m[1;36m0.8[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:public class ParsingEmbeddedDocumentExtractor implements [0m                        [2m                [0m
[2;36m                    [0m         [39mEmbeddedDocumentExtractor [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    private static final File ABSTRACT_PATH = new [0m[1;35mFile[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private static final Parser DELEGATING_PARSER = new [0m[1;35mDelegatingParser[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private boolean writeFileNameToContent = true;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    protected final ParseContext context;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public [0m[1;35mParsingEmbeddedDocumentExtractor[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        this.context = context;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    public boolean [0m[1;35mshouldParseEmbedded[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        DocumentSelector selector = [0m[1;35mcontext.get[0m[1;39m([0m[39mDocumentSelector.class[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39mselector != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            return [0m[1;35mselector.select[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        FilenameFilter filter = [0m[1;35mcontext.get[0m[1;39m([0m[39mFilenameFilter.class[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        if [0m[1;39m([0m[39mfilter != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                return [0m[1;35mfilter.accept[0m[1;39m([0m[39mABSTRACT_PATH, name[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        return true;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/ParseContext.jav[0m[1;92ma:1[0m[39m-[0m[1;36m116[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * Parse context. Used to pass context information to Tika parsers.[0m              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: * @see <a [0m[33mhref[0m[39m=[0m[32m"https[0m[32m://issues.apache.org/jira/browse/TIKA-275"[0m[39m>TIKA-[0m[1;36m275[0m[39m<[0m[35m/[0m[95ma[0m[39m>[0m    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: * @since Apache Tika [0m[1;36m0.5[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:public class ParseContext implements Serializable [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * Serial version UID.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final long serialVersionUID = -5921436862145826534L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * Map of objects in this context[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private final Map<String, Object> context = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Adds the given value to the context as an implementation of the given[0m     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * interface.[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param key   the interface implemented by the given value[0m                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param value the value to be added, or <code>null<[0m[35m/[0m[95mcode[0m[39m> to remove[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    public <T> void [0m[1;35mset[0m[1;39m([0m[39mClass<T> key, T value[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:            [0m[1;35mcontext.put[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            [0m[1;35mcontext.remove[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * Returns the object in this context that implements the given interface.[0m   [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * @param key the interface implemented by the requested object[0m              [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * @return the object that implements the given interface,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * or <code>null<[0m[35m/[0m[95mcode[0m[39m> if not found[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public <T> T [0m[1;35mget[0m[1;39m([0m[39mClass<T> key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        return [0m[1;39m([0m[39mT[0m[1;39m)[0m[39m [0m[1;35mcontext.get[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Returns the object in this context that implements the given interface,[0m   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * or the given default value if such an object is not found.[0m                [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @param key          the interface implemented by the requested object[0m     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @param defaultValue value to return if the requested object is not found[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @return the object that implements the given interface,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * or the given default value if not found[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public <T> T [0m[1;35mget[0m[1;39m([0m[39mClass<T> key, T defaultValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        T value = [0m[1;35mget[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            return value;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            return defaultValue;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    public boolean [0m[1;35misEmpty[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        return [0m[1;35mcontext.size[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[35m/[0m[35m/[0m[95mthis[0m[39m should really only be used for serialization[0m                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public Set<String> [0m[1;35mkeySet[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        return Collections[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                [0m[1;35m.unmodifiableSet[0m[1;39m([0m[1;35mcontext.keySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public boolean [0m[1;35mequals[0m[1;39m([0m[39mObject o[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        if [0m[1;39m([0m[39mthis == o[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            return true;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        if [0m[1;39m([0m[39mo == null || [0m[1;35mgetClass[0m[1;39m([0m[1;39m)[0m[39m != [0m[1;35mo.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            return false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        ParseContext that = [0m[1;39m([0m[39mParseContext[0m[1;39m)[0m[39m o;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        return [0m[1;35mcontext.equals[0m[1;39m([0m[39mthat.context[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    public int [0m[1;35mhashCode[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        return [0m[1;35mcontext.hashCode[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/EmbeddedDocumentUtil.jav[0m[1;92ma:52[0m[39m-[0m[1;36m97[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:public class EmbeddedDocumentUtil implements Serializable [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private final ParseContext context;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private final EmbeddedDocumentExtractor embeddedDocumentExtractor;[0m           [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[35m/[0m[95mthese[0m[39m are lazily initialized and can be null[0m                               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private TikaConfig tikaConfig;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    private MimeTypes mimeTypes;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private Detector detector;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public [0m[1;35mEmbeddedDocumentUtil[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        this.context = context;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        this.embeddedDocumentExtractor = [0m[1;35mgetEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * This offers a uniform way to get an EmbeddedDocumentExtractor from a [0m     [2m                [0m
[2;36m                    [0m         [39mParseContext.[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * As of Tika [0m[1;36m1.15[0m[39m, an AutoDetectParser will automatically be added to parse[0m [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * embedded documents if no Parser.class is specified in the ParseContext.[0m   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * <p/>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * If you'd prefer not to parse embedded documents, set Parser.class[0m         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * to [0m[1;39m{[0m[39m@link org.apache.tika.parser.EmptyParser[0m[1;39m}[0m[39m in the ParseContext.[0m        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @param context[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @return EmbeddedDocumentExtractor[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    public static EmbeddedDocumentExtractor [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mgetEmbeddedDocumentExtractor[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        EmbeddedDocumentExtractor extractor = [0m                                   [2m                [0m
[2;36m                    [0m         [1;35mcontext.get[0m[1;39m([0m[39mEmbeddedDocumentExtractor.class[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        if [0m[1;39m([0m[39mextractor != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            return extractor;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[35m/[0m[35m/[0m[95mensure[0m[39m that an AutoDetectParser is[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[35m/[0m[35m/[0m[95mavailable[0m[39m for parsing embedded docs TIKA-[0m[1;36m2096[0m                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        Parser embeddedParser = [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        if [0m[1;39m([0m[39membeddedParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            TikaConfig tikaConfig = [0m[1;35mcontext.get[0m[1;39m([0m[39mTikaConfig.class[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            if [0m[1;39m([0m[39mtikaConfig == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;35mcontext.set[0m[1;39m([0m[39mParser.class, new [0m[1;35mAutoDetectParser[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                [0m[1;35mcontext.set[0m[1;39m([0m[39mParser.class, new [0m[1;35mAutoDetectParser[0m[1;39m([0m[39mtikaConfig[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        EmbeddedDocumentExtractor ex = new [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mParsingEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;35mcontext.set[0m[1;39m([0m[39mEmbeddedDocumentExtractor.class, ex[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        return ex;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/EmbeddedDocumentUtil.jav[0m[1;92ma:213[0m[39m-[0m[1;36m224[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    public boolean [0m[1;35mshouldParseEmbedded[0m[1;39m([0m[39mMetadata m[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        return [0m[1;35mgetEmbeddedDocumentExtractor[0m[1;39m([0m[1;39m)[0m[1;35m.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    private EmbeddedDocumentExtractor [0m[1;35mgetEmbeddedDocumentExtractor[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:        return embeddedDocumentExtractor;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:    public void [0m[1;35mparseEmbedded[0m[1;39m([0m[39mTikaInputStream tis, ContentHandler handler, [0m     [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                              boolean outputHtml[0m[1;39m)[0m[39m throws IOException, [0m          [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:        [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mtis, handler, metadata, [0m        [2m                [0m
[2;36m                    [0m         [39moutputHtml[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:1[0m[39m-[0m[1;36m100[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.tika.utils;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.Reader;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.StringReader;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.lang.reflect.Method;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.concurrent.ArrayBlockingQueue;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.concurrent.atomic.AtomicBoolean;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.concurrent.atomic.AtomicInteger;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.concurrent.locks.ReentrantReadWriteLock;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import javax.xml.XMLConstants;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import javax.xml.parsers.DocumentBuilder;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import javax.xml.parsers.DocumentBuilderFactory;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import javax.xml.parsers.ParserConfigurationException;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import javax.xml.parsers.SAXParser;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import javax.xml.parsers.SAXParserFactory;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import javax.xml.stream.XMLInputFactory;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import javax.xml.stream.XMLResolver;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import javax.xml.transform.Transformer;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import javax.xml.transform.TransformerConfigurationException;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import javax.xml.transform.TransformerFactory;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import javax.xml.transform.TransformerFactoryConfigurationError;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.w3c.dom.Document;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.xml.sax.Attributes;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.xml.sax.DTDHandler;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.xml.sax.EntityResolver;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.xml.sax.ErrorHandler;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.xml.sax.InputSource;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.xml.sax.SAXParseException;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:import org.xml.sax.XMLReader;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:import org.xml.sax.helpers.DefaultHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:import org.apache.tika.sax.OfflineContentHandler;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m: * Utility functions for reading XML.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:public class XMLReaderUtils implements Serializable [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Default size for the pool of SAX Parsers[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * and the pool of DOM builders[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public static final int DEFAULT_POOL_SIZE = [0m[1;36m10[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    public static final int DEFAULT_MAX_ENTITY_EXPANSIONS = [0m[1;36m20[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * Serial version UID[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    private static final long serialVersionUID = 6110455808615143122L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private static final Logger LOG = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mXMLReaderUtils.class[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private static final String XERCES_SECURITY_MANAGER = [0m                       [2m                [0m
[2;36m                    [0m         [32m"org.apache.xerces.util.SecurityManager"[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private static final String XERCES_SECURITY_MANAGER_PROPERTY =[0m               [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[32m"http://apache.org/xml/properties/security-manager"[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private static final AtomicBoolean HAS_WARNED_STAX = new [0m                    [2m                [0m
[2;36m                    [0m         [1;35mAtomicBoolean[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    private static final ContentHandler IGNORING_CONTENT_HANDLER = new [0m          [2m                [0m
[2;36m                    [0m         [1;35mDefaultHandler[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private static final DTDHandler IGNORING_DTD_HANDLER = new [0m[1;35mDTDHandler[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        @Override[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        public void [0m[1;35mnotationDecl[0m[1;39m([0m[39mString name, String publicId, String systemId[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                throws SAXException [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        @Override[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        public void [0m[1;35munparsedEntityDecl[0m[1;39m([0m[39mString name, String publicId, String [0m     [2m                [0m
[2;36m                    [0m         [39msystemId,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                                       String notationName[0m[1;39m)[0m[39m throws SAXException [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[1;39m}[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    private static final ErrorHandler IGNORING_ERROR_HANDLER = new [0m             [2m                [0m
[2;36m                    [0m         [1;35mErrorHandler[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:123[0m[39m-[0m[1;36m126[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    private static final EntityResolver IGNORING_SAX_ENTITY_RESOLVER =[0m          [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            [0m[1;39m([0m[39mpublicId, systemId[0m[1;39m)[0m[39m -> new [0m[1;35mInputSource[0m[1;39m([0m[39mnew [0m[1;35mStringReader[0m[1;39m([0m[32m""[0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    private static final XMLResolver IGNORING_STAX_ENTITY_RESOLVER =[0m            [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;39m([0m[39mpublicID, systemID, baseURI, namespace[0m[1;39m)[0m[39m -> [0m[32m""[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:171[0m[39m-[0m[1;36m180[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    public static XMLReader [0m[1;35mgetXMLReader[0m[1;39m([0m[1;39m)[0m[39m throws TikaException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:        XMLReader reader;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            reader = [0m[1;35mgetSAXParser[0m[1;39m([0m[1;39m)[0m[1;35m.getXMLReader[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:            throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"Unable to create an XMLReader"[0m[39m, e[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        [0m[1;35mreader.setEntityResolver[0m[1;39m([0m[39mIGNORING_SAX_ENTITY_RESOLVER[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        return reader;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/XMLReaderUtils.jav[0m[1;92ma:278[0m[39m-[0m[1;36m288[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:    public static DocumentBuilder [0m[1;35mgetDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m throws TikaException [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:            DocumentBuilderFactory documentBuilderFactory = [0m                    [2m                [0m
[2;36m                    [0m         [1;35mgetDocumentBuilderFactory[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:            DocumentBuilder documentBuilder = [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mdocumentBuilderFactory.newDocumentBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:            [0m[1;35mdocumentBuilder.setEntityResolver[0m[1;39m([0m[39mIGNORING_SAX_ENTITY_RESOLVER[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:            [0m[1;35mdocumentBuilder.setErrorHandler[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:            return documentBuilder;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mParserConfigurationException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:            throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"XML parser not available"[0m[39m, e[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/sax/OfflineContentHandler.jav[0m[1;92ma:1[0m[39m-[0m[1;36m45[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.sax;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import org.apache.commons.io.input.ClosedInputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.xml.sax.InputSource;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: * Content handler decorator that always returns an empty stream from the[0m        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: * [0m[1;39m{[0m[39m@link #[0m[1;35mresolveEntity[0m[1;39m([0m[39mString, String[0m[1;39m)[0m[1;39m}[0m[39m method to prevent potential[0m            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: * network or other external resources from being accessed by an XML parser.[0m     [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: * @see <a [0m[33mhref[0m[39m=[0m[32m"https[0m[32m://issues.apache.org/jira/browse/TIKA-185"[0m[39m>TIKA-[0m[1;36m185[0m[39m<[0m[35m/[0m[95ma[0m[39m>[0m    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:public class OfflineContentHandler extends ContentHandlerDecorator [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    public [0m[1;35mOfflineContentHandler[0m[1;39m([0m[39mContentHandler handler[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * Returns an empty stream. This will make an XML parser silently[0m            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * ignore any external entities.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public InputSource [0m[1;35mresolveEntity[0m[1;39m([0m[39mString publicId, String systemId[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        return new [0m[1;35mInputSource[0m[1;39m([0m[39mnew [0m[1;35mClosedInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/test/java/org/apache/tika/parser/m3/M3U8ParserTest.jav[0m[1;92ma:19[0m[39m-[0m[1;36m42[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static org.junit.jupiter.api.Assertions.assertEquals;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.junit.jupiter.api.Test;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.tika.TikaTest;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.tika.metadata.XMPDM;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:public class M3U8ParserTest extends TikaTest [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    public void [0m[1;35mtestBasic[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:        [0m[35m/[0m[35m/[0m[95mtest[0m[39m file is based on MIT licensed:[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:        [0m[35m/[0m[35m/[0m[39m [0m                                                                      [2m                [0m
[2;36m                    [0m         [4;94mhttps://github.com/globocom/m3u8/blob/master/tests/playlists/relative-playlist.m3u8[0m [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        List<Metadata> metadataList = [0m[1;35mgetRecursiveMetadata[0m[1;39m([0m[32m"testM3U8.m3u8"[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:        Metadata m = [0m[1;35mmetadataList.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"5220.0"[0m[39m, [0m[1;35mm.get[0m[1;39m([0m[39mXMPDM.DURATION[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"entire1.ts"[0m[39m, [0m[1;35mm.get[0m[1;39m([0m[39mM3U8Parser.PLAY_LIST_LINK[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m3[0m[39m, [0m[1;35mm.getInt[0m[1;39m([0m[39mM3U8Parser.M3U8_VERSION[0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"VOD"[0m[39m, [0m[1;35mm.get[0m[1;39m([0m[39mM3U8Parser.PLAY_LIST_TYPE[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/test/resources/test-documents/testM3U8.m3u[0m[1;92m8:1[0m[39m-[0m[1;36m7[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#EXTM3U[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#EXT-X-VERSION:[0m[1;36m3[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#EXT-X-PLAYLIST-TYPE:VOD[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#EXT-X-TAR[0m[1;33mGET[0m[39mDURATION:[0m[1;36m5220[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#EXTIN[0m[1;92mF:5220[0m[39m,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m6:e[0m[39mntire1.ts[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#EXT-X-ENDLIST[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.jav[0m[1;92ma:153[0m[39m-[0m[1;36m175[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    private void [0m[1;35mhandleLink[0m[1;39m([0m[39mString line, BufferedReader reader,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                            XHTMLContentHandler xhtml, Metadata metadata,[0m       [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                            ParseContext context[0m[1;39m)[0m[39m throws IOException, [0m          [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        String nextLine = [0m[1;35mgetNextContentLine[0m[1;39m([0m[39mreader[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        if [0m[1;39m([0m[39mnextLine == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[35m/[0m[35m/[0m[95mTODO[0m[39m -- parse contents in EXTINF line[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        [0m[35m/[0m[35m/[0m[39m split on , then the first value is the length [0m[1;39m([0m[39mcan be [0m[1;36m-1[0m[1;39m)[0m[39m,[0m           [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[35m/[0m[35m/[0m[39m the last value is the title; intermediate values are [0m[33mkey[0m[39m=[0m[35mvalue[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mformat[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:        [0m[1;35mmetadata.add[0m[1;39m([0m[39mPLAY_LIST_LINK, nextLine[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mnextLine.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        EmbeddedDocumentExtractor ex = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        if [0m[1;39m([0m[1;35mex.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mnew [0m[1;35mURL[0m[1;39m([0m[39mnextLine[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                [0m[1;35mex.parseEmbedded[0m[1;39m([0m[39mtis, new [0m[1;35mBodyContentHandler[0m[1;39m([0m[39mnew [0m               [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedContentHandler[0m[1;39m([0m[39mxhtml[0m[1;39m)[0m[1;39m)[0m[39m, m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                        true[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.jav[0m[1;92ma:177[0m[39m-[0m[1;36m189[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:    private String [0m[1;35mgetNextContentLine[0m[1;39m([0m[39mBufferedReader reader[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        String line = [0m[1;35mreader.readLine[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:            if [0m[1;39m([0m[39mline == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:                return null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mline.trim[0m[1;39m([0m[1;39m)[0m[1;35m.isBlank[0m[1;39m([0m[1;39m)[0m[39m || [0m[1;35mline.startsWith[0m[1;39m([0m[32m"##"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                [0m[35m/[0m[35m/[0m[95mempty[0m[39m or comment[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:                return line;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            line = [0m[1;35mreader.readLine[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/test/java/org/apache/tika/parser/m3/M3U8ParserTest.jav[0m[1;92ma:1[0m[39m-[0m[1;36m42[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.m3;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static org.junit.jupiter.api.Assertions.assertEquals;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.junit.jupiter.api.Test;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.tika.TikaTest;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.tika.metadata.XMPDM;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:public class M3U8ParserTest extends TikaTest [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    public void [0m[1;35mtestBasic[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:        [0m[35m/[0m[35m/[0m[95mtest[0m[39m file is based on MIT licensed:[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:        [0m[35m/[0m[35m/[0m[39m [0m                                                                      [2m                [0m
[2;36m                    [0m         [4;94mhttps://github.com/globocom/m3u8/blob/master/tests/playlists/relative-playlist.m3u8[0m [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        List<Metadata> metadataList = [0m[1;35mgetRecursiveMetadata[0m[1;39m([0m[32m"testM3U8.m3u8"[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:        Metadata m = [0m[1;35mmetadataList.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"5220.0"[0m[39m, [0m[1;35mm.get[0m[1;39m([0m[39mXMPDM.DURATION[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"entire1.ts"[0m[39m, [0m[1;35mm.get[0m[1;39m([0m[39mM3U8Parser.PLAY_LIST_LINK[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m3[0m[39m, [0m[1;35mm.getInt[0m[1;39m([0m[39mM3U8Parser.M3U8_VERSION[0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"VOD"[0m[39m, [0m[1;35mm.get[0m[1;39m([0m[39mM3U8Parser.PLAY_LIST_TYPE[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/test/resources/test-documents/testM3U8.m3u[0m[1;92m8:1[0m[39m-[0m[1;36m7[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#EXTM3U[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#EXT-X-VERSION:[0m[1;36m3[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#EXT-X-PLAYLIST-TYPE:VOD[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#EXT-X-TAR[0m[1;33mGET[0m[39mDURATION:[0m[1;36m5220[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#EXTIN[0m[1;92mF:5220[0m[39m,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m6:e[0m[39mntire1.ts[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#EXT-X-ENDLIST[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-news-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/test/java/org/apache/tika/parser/feed/FeedParserTest.jav[0m[1;92ma:34[0m[39m-[0m[1;36m57[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    public void [0m[1;35mtestRSSParser[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:        [0m[35m/[0m[35m/[0m[39m These RSS files should have basically the same contents,[0m              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        [0m[35m/[0m[35m/[0m[39m  represented in the various RSS format versions[0m                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        for [0m[1;39m([0m[39mString rssFile : new String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[32m"/test-documents/rsstest_091.rss"[0m[39m,[0m    [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:                [0m[32m"/test-documents/rsstest_20.rss"[0m[1;39m}[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:            try [0m[1;39m([0m[39mInputStream input = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mFeedParserTest.class.getResourceAsStream[0m[1;39m([0m[39mrssFile[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:                Metadata metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:                ContentHandler handler = new [0m[1;35mBodyContentHandler[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:                ParseContext context = new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                new [0m[1;35mFeedParser[0m[1;39m([0m[1;39m)[0m[1;35m.parse[0m[1;39m([0m[39minput, handler, metadata, context[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                String content = [0m[1;35mhandler.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                [0m[1;35massertNotNull[0m[1;39m([0m[39mcontent[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                [0m[1;35massertEquals[0m[1;39m([0m[32m"Sample RSS File for Junit test"[0m[39m,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:                        [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.DESCRIPTION[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;35massertEquals[0m[1;39m([0m[32m"TestChannel"[0m[39m, [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.TITLE[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:                [0m[35m/[0m[35m/[0m[39m TODO find a way of testing the paragraphs and anchors[0m         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-news-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/feed/FeedParser.jav[0m[1;92ma:44[0m[39m-[0m[1;36m131[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m: * Feed parser.[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m: * Uses Rome for parsing the feeds. A feed description is put in a paragraph[0m     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m: * with its link and title in an anchor.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:public class FeedParser implements Parser [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * Serial version UID[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private static final long serialVersionUID = -3785361933034525186L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    private static final Set<MediaType> SUPPORTED_TYPES = [0m                       [2m                [0m
[2;36m                    [0m         [1;35mCollections.unmodifiableSet[0m[1;39m([0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:            new HashSet<>[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m[1;35mMediaType.application[0m[1;39m([0m[32m"rss+xml"[0m[1;39m)[0m[39m,[0m        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:                    [0m[1;35mMediaType.application[0m[1;39m([0m[32m"atom+xml"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static String [0m[1;35mstripTags[0m[1;39m([0m[39mSyndContent c[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        if [0m[1;39m([0m[39mc == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            return [0m[32m""[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        String value = [0m[1;35mc.getValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        if [0m[1;39m([0m[39mvalue == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            return [0m[32m""[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m parts = [0m[1;35mvalue.split[0m[1;39m([0m[32m"<[0m[32m[[0m[32m^>[0m[32m][0m[32m*>"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        StringBuilder buf = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        for [0m[1;39m([0m[39mString part : parts[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m[1;35mbuf.append[0m[1;39m([0m[39mpart[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        return [0m[1;35mbuf.toString[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return SUPPORTED_TYPES;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[35m/[0m[35m/[0m[39m set the encoding?[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            SyndFeedInput input = new [0m[1;35mSyndFeedInput[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:            [0m[1;35minput.setAllowDoctypes[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            SyndFeed feed =[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                    [0m[1;35minput.build[0m[1;39m([0m[39mnew [0m                                             [2m                [0m
[2;36m                    [0m         [1;35mInputSource[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39mstream[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            String title = [0m[1;35mstripTags[0m[1;39m([0m[1;35mfeed.getTitleEx[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            String description = [0m[1;35mstripTags[0m[1;39m([0m[1;35mfeed.getDescriptionEx[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.TITLE, title[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.DESCRIPTION, description[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:            [0m[35m/[0m[35m/[0m[39m store the other fields in the metadata[0m                            [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, [0m       [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;35mxhtml.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            [0m[1;35mxhtml.element[0m[1;39m([0m[32m"h1"[0m[39m, title[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;35mxhtml.element[0m[1;39m([0m[32m"p"[0m[39m, description[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"ul"[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            for [0m[1;39m([0m[39mObject e : [0m[1;35mfeed.getEntries[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                SyndEntry entry = [0m[1;39m([0m[39mSyndEntry[0m[1;39m)[0m[39m e;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                String link = [0m[1;35mentry.getLink[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                if [0m[1;39m([0m[39mlink != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                    [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"li"[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                    [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"a"[0m[39m, [0m[32m"href"[0m[39m, link[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                    [0m[1;35mxhtml.characters[0m[1;39m([0m[1;35mstripTags[0m[1;39m([0m[1;35mentry.getTitleEx[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                    [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"a"[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    SyndContent content = [0m[1;35mentry.getDescription[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                    if [0m[1;39m([0m[39mcontent != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                        [0m[1;35mxhtml.newline[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:                        [0m[1;35mxhtml.characters[0m[1;39m([0m[1;35mstripTags[0m[1;39m([0m[39mcontent[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:                    [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"li"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"ul"[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:            [0m[1;35mxhtml.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mFeedException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"RSS parse error"[0m[39m, e[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.jav[0m[1;92ma:49[0m[39m-[0m[1;36m66[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m: * Basic parser for m3u8 files[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:public class M3U8Parser implements Parser [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public static final String M3U8_PREFIX = [0m[32m"m3u8:"[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public static final Property PLAY_LIST_LINK = [0m                               [2m                [0m
[2;36m                    [0m         [1;35mProperty.internalTextBag[0m[1;39m([0m[39mM3U8_PREFIX + [0m[32m"link"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    public static final Property M3U8_VERSION = [0m                                 [2m                [0m
[2;36m                    [0m         [1;35mProperty.internalInteger[0m[1;39m([0m[39mM3U8_PREFIX + [0m[32m"version"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    public static final Property PLAY_LIST_TYPE = [0m                               [2m                [0m
[2;36m                    [0m         [1;35mProperty.internalText[0m[1;39m([0m[39mM3U8_PREFIX + [0m[32m"type"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    private static final Set<MediaType> SUPPORTED = [0m[1;35mSet.of[0m[1;39m([0m                      [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:            [0m[1;35mMediaType.application[0m[1;39m([0m[32m"vnd.apple.mpegurl"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private static final String TAR[0m[1;33mGET[0m[39m_DURATION = [0m[32m"#EXT-X-TAR[0m[1;33mGET[0m[32mDURATION:"[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final String EXTINF = [0m[32m"#EXTINF:"[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    private static final String ENDLIST = [0m[32m"#EXT-X-ENDLIST"[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final String EXTVERSION = [0m[32m"#EXT-X-VERSION:"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    private static final String EXTKEY = [0m[32m"#EXT-X-KEY:"[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private static final String EXTPLAYLISTTYPE = [0m[32m"#EXT-X-PLAYLIST-TYPE:"[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiov[0m [2m                [0m
[2;36m                    [0m         [39mideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.jav[0m[1;92ma:153[0m[39m-[0m[1;36m175[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    private void [0m[1;35mhandleLink[0m[1;39m([0m[39mString line, BufferedReader reader,[0m                 [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                            XHTMLContentHandler xhtml, Metadata metadata,[0m       [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                            ParseContext context[0m[1;39m)[0m[39m throws IOException, [0m          [2m                [0m
[2;36m                    [0m         [39mSAXException [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        String nextLine = [0m[1;35mgetNextContentLine[0m[1;39m([0m[39mreader[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        if [0m[1;39m([0m[39mnextLine == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[35m/[0m[35m/[0m[95mTODO[0m[39m -- parse contents in EXTINF line[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        [0m[35m/[0m[35m/[0m[39m split on , then the first value is the length [0m[1;39m([0m[39mcan be [0m[1;36m-1[0m[1;39m)[0m[39m,[0m           [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[35m/[0m[35m/[0m[39m the last value is the title; intermediate values are [0m[33mkey[0m[39m=[0m[35mvalue[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mformat[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:        [0m[1;35mmetadata.add[0m[1;39m([0m[39mPLAY_LIST_LINK, nextLine[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mnextLine.startsWith[0m[1;39m([0m[32m"http"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        EmbeddedDocumentExtractor ex = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        if [0m[1;39m([0m[1;35mex.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mnew [0m[1;35mURL[0m[1;39m([0m[39mnextLine[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                [0m[1;35mex.parseEmbedded[0m[1;39m([0m[39mtis, new [0m[1;35mBodyContentHandler[0m[1;39m([0m[39mnew [0m               [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedContentHandler[0m[1;39m([0m[39mxhtml[0m[1;39m)[0m[1;39m)[0m[39m, m,[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:                        true[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy for M3U8Parser SSRF Vulnerability[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Analysis Summary[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe evaluation report correctly identifies a Server Side Request Forgery [0m[1;39m([0m[39mSSRF[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mvulnerability in the Apache Tika M3U8 parser. The code analysis reveals:[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Root Cause:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- The `[0m[1;35mM3U8Parser.handleLink[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m164[0m[39m-[0m[1;36m174[0m[1;39m)[0m[39m automatically fetches and [0m   [2m                [0m
[2;36m                    [0m         [39mparses content from HTTP URLs found in M3U8 playlist files without proper [0m          [2m                [0m
[2;36m                    [0m         [39mvalidation[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m170[0m[39m directly calls `[0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mnew [0m[1;35mURL[0m[1;39m([0m[39mnextLine[0m[1;39m)[0m[1;39m)[0m[39m` which opens a [0m   [2m                [0m
[2;36m                    [0m         [39mnetwork connection to any URL starting with [0m[32m"http"[0m                                  [2m                [0m
[2;36m                    [0m         [39m- No validation exists to prevent connections to localhost, private IP ranges, or [0m  [2m                [0m
[2;36m                    [0m         [39minternal network resources[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Key Security Issues:**[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The only validation is checking if the URL starts with [0m[32m"http"[0m[39m [0m[1;39m([0m[39mline [0m[1;36m164[0m[1;39m)[0m[39m, which [0m [2m                [0m
[2;36m                    [0m         [39mis insufficient[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. No allow-list or deny-list mechanism exists for URL destinations[0m                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The automatic fetching contradicts established Tika security patterns [0m           [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mXMLReaderUtils entity resolution, OfflineContentHandler[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. No configuration option exists to disable this behavior[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Codebase Precedents:**[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- `XMLReaderUtils` [0m[1;39m([0m[39mlines [0m[1;36m123[0m[39m-[0m[1;36m124[0m[39m, [0m[1;36m178[0m[39m, [0m[1;36m282[0m[1;39m)[0m[39m implements [0m                            [2m                [0m
[2;36m                    [0m         [39m`IGNORING_SAX_ENTITY_RESOLVER` to prevent XXE attacks by blocking external entity [0m  [2m                [0m
[2;36m                    [0m         [39mresolution[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- `OfflineContentHandler` [0m[1;39m([0m[39mlines [0m[1;36m40[0m[39m-[0m[1;36m42[0m[1;39m)[0m[39m returns empty streams to prevent XML [0m       [2m                [0m
[2;36m                    [0m         [39mparsers from accessing external resources[0m                                           [2m                [0m
[2;36m                    [0m         [39m- `FeedParser` [0m[1;39m([0m[39mlines [0m[1;36m109[0m[39m-[0m[1;36m122[0m[1;39m)[0m[39m extracts URLs from RSS/Atom feeds but does NOT fetch[0m [2m                [0m
[2;36m                    [0m         [39mcontent from them[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- The existing test [0m[1;39m([0m[39m`testM3U8.m3u8`[0m[1;39m)[0m[39m uses relative paths [0m[1;39m([0m[32m"entire1.ts"[0m[1;39m)[0m[39m, not HTTP [0m [2m                [0m
[2;36m                    [0m         [39mURLs, indicating the original design did not intend automatic URL fetching[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Fix Strategy[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Primary Approach: Remove Automatic URL Fetching**[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must remove the automatic URL fetching behavior [0m[1;39m([0m[39mlines [0m[1;36m164[0m[39m-[0m[1;36m174[0m[39m in [0m          [2m                [0m
[2;36m                    [0m         [1;35mM3U8Parser.handleLink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m while preserving the metadata extraction functionality. [0m   [2m                [0m
[2;36m                    [0m         [39mThis approach:[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Maintains Core Functionality:**[0m                                                [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m163[0m[39m [0m[1;39m([0m[39m`[0m[1;35mmetadata.add[0m[1;39m([0m[39mPLAY_LIST_LINK, nextLine[0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m stores the URL/path in [0m    [2m                [0m
[2;36m                    [0m         [39mmetadata - this MUST be preserved[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Parsing of M3U8 directives [0m[1;39m([0m[39mTAR[0m[1;33mGET[0m[39m_DURATION, VERSION, TYPE, etc.[0m[1;39m)[0m[39m remains [0m     [2m                [0m
[2;36m                    [0m         [39munchanged[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - All existing tests continue to pass [0m[1;39m([0m[39mtestM3U8.m3u8 only validates metadata [0m    [2m                [0m
[2;36m                    [0m         [39mextraction, not URL fetching[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Eliminates SSRF Vulnerability:**[0m                                               [2m                [0m
[2;36m                    [0m         [39m   - Remove lines [0m[1;36m164[0m[39m-[0m[1;36m174[0m[39m which contain the vulnerable code path[0m                    [2m                [0m
[2;36m                    [0m         [39m   - This prevents any automatic network connections based on untrusted M3U8 [0m       [2m                [0m
[2;36m                    [0m         [39mcontent[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - URLs are still extracted and stored in metadata for applications that need [0m    [2m                [0m
[2;36m                    [0m         [39mthem[0m                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Aligns with Tika Security Patterns:**[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Follows the FeedParser pattern: extract URLs as metadata, don't fetch them[0m     [2m                [0m
[2;36m                    [0m         [39m   - Follows the XMLReaderUtils pattern: prevent external resource access from [0m     [2m                [0m
[2;36m                    [0m         [39muntrusted content[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - Follows the OfflineContentHandler pattern: parsers should not make external [0m   [2m                [0m
[2;36m                    [0m         [39mconnections[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Implementation Steps[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1[0m[39m: Modify [0m[1;35mM3U8Parser.handleLink[0m[1;39m([0m[1;39m)[0m[39m method**[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn file: [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m`tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audio[0m [2m                [0m
[2;36m                    [0m         [39mvideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.java`[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mLocation: Lines [0m[1;36m153[0m[39m-[0m[1;36m175[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes Required:**[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Keep lines [0m[1;36m153[0m[39m-[0m[1;36m163[0m[39m: Method signature, URL extraction, and metadata storage[0m        [2m                [0m
[2;36m                    [0m         [39m- **Remove lines [0m[1;36m164[0m[39m-[0m[1;36m174[0m[39m**: The entire code block that checks for [0m[32m"http"[0m[39m URLs and [0m  [2m                [0m
[2;36m                    [0m         [39mfetches content[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- Keep line [0m[1;36m175[0m[39m: Closing brace[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Resulting Method:**[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate void [0m[1;35mhandleLink[0m[1;39m([0m[39mString line, BufferedReader reader,[0m                         [2m                [0m
[2;36m                    [0m         [39m                        XHTMLContentHandler xhtml, Metadata metadata,[0m               [2m                [0m
[2;36m                    [0m         [39m                        ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [39m    String nextLine = [0m[1;35mgetNextContentLine[0m[1;39m([0m[39mreader[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mnextLine == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [39m        return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[95mTODO[0m[39m -- parse contents in EXTINF line[0m                                         [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m split on , then the first value is the length [0m[1;39m([0m[39mcan be [0m[1;36m-1[0m[1;39m)[0m[39m,[0m                   [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m the last value is the title; intermediate values are [0m[33mkey[0m[39m=[0m[35mvalue[0m[39m format[0m        [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmetadata.add[0m[1;39m([0m[39mPLAY_LIST_LINK, nextLine[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m URL fetching removed for security: URLs are now only stored in metadata[0m      [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m2[0m[39m: Remove Unused Imports [0m[1;39m([0m[39mif necessary[0m[1;39m)[0m[39m**[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter removing the URL fetching code, the following imports may become unused:[0m      [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m23[0m[39m: `java.net.URL` [0m[1;39m([0m[39mif not used elsewhere in the file[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m34[0m[39m: `org.apache.tika.extractor.EmbeddedDocumentExtractor` [0m[1;39m([0m[39mif not used [0m      [2m                [0m
[2;36m                    [0m         [39melsewhere[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m35[0m[39m: `org.apache.tika.extractor.EmbeddedDocumentUtil` [0m[1;39m([0m[39mif not used elsewhere[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m36[0m[39m: `org.apache.tika.io.TikaInputStream` [0m[1;39m([0m[39mif not used elsewhere[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m44[0m[39m: `org.apache.tika.sax.BodyContentHandler` [0m[1;39m([0m[39mif not used elsewhere[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m45[0m[39m: `org.apache.tika.sax.EmbeddedContentHandler` [0m[1;39m([0m[39mif not used elsewhere[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mCheck if these imports are used elsewhere in the file before removing them.[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Justification[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why This is the Optimal Approach:**[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Security First:** Completely eliminates the SSRF vulnerability by removing the[0m [2m                [0m
[2;36m                    [0m         [39mattack vector [0m[1;39m([0m[39mautomatic URL fetching[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Minimal Code Changes:** Only requires deleting [0m[1;36m11[0m[39m lines of code [0m[1;39m([0m[39mlines [0m        [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m-[0m[1;36m174[0m[1;39m)[0m[39m, reducing risk of introducing new bugs[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves Core Functionality:** The parser still:[0m                              [2m                [0m
[2;36m                    [0m         [39m   - Extracts all M3U8 metadata [0m[1;39m([0m[39mduration, version, playlist type[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m   - Stores URLs/paths in the PLAY_LIST_LINK property[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Processes all M3U8 directives correctly[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Maintains Test Compatibility:** The existing test [0m                             [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;35mtestM3U8ParserTest.testBasic[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m validates metadata extraction, which is preserved[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Follows Established Patterns:** Aligns with security patterns already present [0m [2m                [0m
[2;36m                    [0m         [39min Tika:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - XMLReaderUtils blocks external entities[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - OfflineContentHandler prevents external resource access[0m                        [2m                [0m
[2;36m                    [0m         [39m   - FeedParser extracts URLs without fetching them[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **No Breaking Changes to API:** Applications can still retrieve URLs from [0m       [2m                [0m
[2;36m                    [0m         [39mmetadata and choose to fetch them explicitly with proper validation[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **Defense in Depth:** Removes the vulnerability at the source rather than trying[0m [2m                [0m
[2;36m                    [0m         [39mto validate all possible URL formats and destination restrictions[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Potential Side Effects and Mitigation[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Impact:**[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Applications relying on automatic embedded content parsing from M3U8 URLs will no[0m [2m                [0m
[2;36m                    [0m         [39mlonger get that behavior[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- This is unlikely to affect many users since:[0m                                      [2m                [0m
[2;36m                    [0m         [39m  - The existing test only validates metadata extraction[0m                            [2m                [0m
[2;36m                    [0m         [39m  - M3U8 files typically reference local media segments, not remote HTTP resources[0m  [2m                [0m
[2;36m                    [0m         [39m  - The feature has no documented configuration or test coverage[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- Applications needing URL content can retrieve URLs from the PLAY_LIST_LINK [0m       [2m                [0m
[2;36m                    [0m         [39mmetadata property[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- They can then implement their own URL validation and fetching with appropriate [0m   [2m                [0m
[2;36m                    [0m         [39msecurity controls[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- This gives applications full control over security policy [0m[1;39m([0m[39mallow-lists, [0m          [2m                [0m
[2;36m                    [0m         [39mdeny-lists, timeout settings[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Alternative Future Enhancement [0m[1;39m([0m[39mNot Part of This Fix[0m[1;39m)[0m[39m:**[0m                          [2m                [0m
[2;36m                    [0m         [39mIf automatic URL fetching is genuinely needed in the future, it could be [0m           [2m                [0m
[2;36m                    [0m         [39mre-implemented as an opt-in feature with:[0m                                           [2m                [0m
[2;36m                    [0m         [39m- A new configuration class in ParseContext for URL fetching policy[0m                 [2m                [0m
[2;36m                    [0m         [39m- Proper URL validation [0m[1;39m([0m[39mdeny localhost, private IPs, configurable allow-lists[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m- Timeout and retry controls[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- Clear documentation of security implications[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mHowever, the current fix should simply remove the vulnerable code to eliminate the [0m [2m                [0m
[2;36m                    [0m         [39mSSRF risk.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m6[0m[39m. Verification[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix can be verified by:[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Existing Tests:** Run `[0m[1;35mM3U8ParserTest.testBasic[0m[1;39m([0m[1;39m)[0m[39m` - should pass unchanged[0m     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Fuzzing:** Re-run the fuzzer with the crafted input - should no longer attempt[0m [2m                [0m
[2;36m                    [0m         [39mexternal connections[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Manual Testing:** Parse an M3U8 file containing HTTP URLs and verify:[0m          [2m                [0m
[2;36m                    [0m         [39m   - URLs are stored in metadata [0m[1;39m([0m[39mPLAY_LIST_LINK property[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m   - No network connections are attempted[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - No exceptions are thrown[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=314727;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=313153;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=771435;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=843295;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpbc6lacoj[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-delta-02_vuln_3/[0m[95magent[0m [2m               [0m
[2;36m                    [0m         [95m-output-1768048149.3639152[0m                                                           [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/tika_tk-delta-02_vuln_3.toml [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/10/26 12:29:11][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mtika[0m           ]8;id=895999;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=785236;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=733505;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=109805;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m                  [2m               [0m
[2;36m[01/10/26 12:29:12][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=403149;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=969998;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mtika[0m                   [2m               [0m
