--- a/libexif/exif-data.c
+++ b/libexif/exif-data.c
@@ -925,6 +925,18 @@
 			  "We have to deal with %i byte(s) of EXIF data.",
 			  len);
 		d += 2;
+		/* Validate the APP1 segment length against actual buffer size */
+		if (len < 2) {
+			exif_log (data->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,
+				  "ExifData", "Invalid APP1 segment length");
+			return;
+		}
+		if (len - 2 > ds) {
+			exif_log (data->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,
+				  "ExifData", "APP1 segment length (%u) exceeds available data (%u)", 
+				  len, ds + 2);
+			return;
+		}
 		ds = len - 2;	/* we do not want the full rest size, but only the size of the tag */
 	}
 
