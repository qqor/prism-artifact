{
  "project_name": "libexif",
  "vulnerability_identifier": "libexif_ex-delta-03_exif-002",
  "source_directory": "/home/user/crete/.cache/official-afc-libexif",
  "llm_usage": {
    "total_cost": 1.261695,
    "prompt_tokens": 349230,
    "completion_tokens": 14267
  },
  "variant": "sound",
  "diff": "--- a/libexif/exif-data.c\n+++ b/libexif/exif-data.c\n@@ -925,6 +925,18 @@\n \t\t\t  \"We have to deal with %i byte(s) of EXIF data.\",\n \t\t\t  len);\n \t\td += 2;\n+\t\t/* Validate the APP1 segment length against actual buffer size */\n+\t\tif (len < 2) {\n+\t\t\texif_log (data->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,\n+\t\t\t\t  \"ExifData\", \"Invalid APP1 segment length\");\n+\t\t\treturn;\n+\t\t}\n+\t\tif (len - 2 > ds) {\n+\t\t\texif_log (data->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,\n+\t\t\t\t  \"ExifData\", \"APP1 segment length (%u) exceeds available data (%u)\", \n+\t\t\t\t  len, ds + 2);\n+\t\t\treturn;\n+\t\t}\n \t\tds = len - 2;\t/* we do not want the full rest size, but only the size of the tag */\n \t}\n \n",
  "stdout": "",
  "stderr": ""
}