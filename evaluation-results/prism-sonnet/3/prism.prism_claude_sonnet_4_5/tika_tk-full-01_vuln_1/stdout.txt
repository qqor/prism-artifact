[2;36m[01/10/26 14:15:14][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=821468;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=837270;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpb928f16d[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-full-01_vuln_1/[0m[95magent-[0m [2m               [0m
[2;36m                    [0m         [95moutput-1768054514.6536617[0m                                                            [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/tika_tk-full-01_vuln_1.toml  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=388911;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=480173;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 14:16:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Took [1;36m87.92[0m  ]8;id=150562;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=978818;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=252268;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=575484;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=674655;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=868628;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=25757;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=850838;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m87[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=954034;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=69153;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 14:16:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.96[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=742503;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=319407;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 14:16:45][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=534044;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=720071;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=170281;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=623718;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=675030;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=640329;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=259916;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=81478;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 14:16:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.24[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=266426;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=692031;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 14:16:47][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=100077;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=8841;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 14:16:48][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.92[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=432483;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=297854;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 14:16:57][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=148484;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=994517;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueHigh: Remote [2m                [0m
[2;36m                    [0m         Code Execution                                                                      [2m                [0m
[2;36m                    [0m         Unrestricted class/object creation based on externally controlled data may allow    [2m                [0m
[2;36m                    [0m         remote code execution depending on available classes on the classpath.              [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.reportFinding[0m[1m([0mZer.jav[1;92ma:110[0m[1m)[0m                                      [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.reportFindingIfEnabled[0m[1m([0mZer.jav[1;92ma:105[0m[1m)[0m                             [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.readObject[0m[1m([0mZer.jav[1;92ma:377[0m[1m)[0m                                         [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1m([0mNative   [2m                [0m
[2;36m                    [0m         Method[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1m([0mNativeMethodAccessor [2m                [0m
[2;36m                    [0m         Impl.jav[1;92ma:77[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1m([0mDelegatingMethod [2m                [0m
[2;36m                    [0m         AccessorImpl.jav[1;92ma:43[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.reflect.Method.invoke[0m[1m([0mMethod.jav[1;92ma:568[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectStreamClass.invokeReadObject[0m[1m([0mObjectStreamClass.jav[1;92ma:1231[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readSerialData[0m[1m([0mObjectInputStream.jav[1;92ma:2434[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readOrdinaryObject[0m[1m([0mObjectInputStream.jav[1;92ma:2268[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject0[0m[1m([0mObjectInputStream.jav[1;92ma:1744[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject[0m[1m([0mObjectInputStream.jav[1;92ma:514[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject[0m[1m([0mObjectInputStream.jav[1;92ma:472[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFEmbObjHandler.handleCompletedObject[0m[1m([0mRTFEmbO [2m                [0m
[2;36m                    [0m         bjHandler.jav[1;92ma:217[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.processGroupEnd[0m[1m([0mTextExtractor.ja [2m                [0m
[2;36m                    [0m         v[1;92ma:1475[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1m([0mTextExtractor.jav[1;92ma:482[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1m([0mTextExtractor.jav[1;92ma:466[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parseInline[0m[1m([0mRTFParser.jav[1;92ma:96[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parse[0m[1m([0mRTFParser.jav[1;92ma:70[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.RTFParserFuzzer.parseOne[0m[1m([0mRTFParserFuzzer.jav[1;92ma:53[0m[1m)[0m            [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.RTFParserFuzzer.fuzzerTestOneInput[0m[1m([0mRTFParserFuzzer.jav[1;92ma:40[0m[1m)[0m  [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: aa5f725795b842b8                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueHigh: Remote [2m                [0m
[2;36m                    [0m         Code Execution                                                                      [2m                [0m
[2;36m                    [0m         Unrestricted class/object creation based on externally controlled data may allow    [2m                [0m
[2;36m                    [0m         remote code execution depending on available classes on the classpath.              [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.reportFinding[0m[1m([0mZer.jav[1;92ma:110[0m[1m)[0m                                      [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.reportFindingIfEnabled[0m[1m([0mZer.jav[1;92ma:105[0m[1m)[0m                             [2m                [0m
[2;36m                    [0m                 at [1;35mjaz.Zer.readObject[0m[1m([0mZer.jav[1;92ma:377[0m[1m)[0m                                         [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1m([0mNative   [2m                [0m
[2;36m                    [0m         Method[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1m([0mNativeMethodAccessor [2m                [0m
[2;36m                    [0m         Impl.jav[1;92ma:77[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1m([0mDelegatingMethod [2m                [0m
[2;36m                    [0m         AccessorImpl.jav[1;92ma:43[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.reflect.Method.invoke[0m[1m([0mMethod.jav[1;92ma:568[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectStreamClass.invokeReadObject[0m[1m([0mObjectStreamClass.jav[1;92ma:1231[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readSerialData[0m[1m([0mObjectInputStream.jav[1;92ma:2434[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readOrdinaryObject[0m[1m([0mObjectInputStream.jav[1;92ma:2268[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject0[0m[1m([0mObjectInputStream.jav[1;92ma:1744[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject[0m[1m([0mObjectInputStream.jav[1;92ma:514[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/[1;35mjava.io.ObjectInputStream.readObject[0m[1m([0mObjectInputStream.jav[1;92ma:472[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFEmbObjHandler.handleCompletedObject[0m[1m([0mRTFEmbO [2m                [0m
[2;36m                    [0m         bjHandler.jav[1;92ma:217[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.processGroupEnd[0m[1m([0mTextExtractor.ja [2m                [0m
[2;36m                    [0m         v[1;92ma:1475[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1m([0mTextExtractor.jav[1;92ma:482[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1m([0mTextExtractor.jav[1;92ma:466[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parseInline[0m[1m([0mRTFParser.jav[1;92ma:96[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parse[0m[1m([0mRTFParser.jav[1;92ma:70[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.RTFParserFuzzer.parseOne[0m[1m([0mRTFParserFuzzer.jav[1;92ma:53[0m[1m)[0m            [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.RTFParserFuzzer.fuzzerTestOneInput[0m[1m([0mRTFParserFuzzer.jav[1;92ma:40[0m[1m)[0m  [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: aa5f725795b842b8                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 14:17:14][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=218257;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=261109;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 14:21:39][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=598862;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=470396;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 14:22:40][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=940784;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=850700;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=837491;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=220670;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 14:22:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.00[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=41054;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=440581;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=206027;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=536269;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpcs0cvc83[0m                                                 ]8;id=428538;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=486193;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 14:23:50][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m68.90[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=15812;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=467117;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Started[33m...[0m                          ]8;id=359410;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=671868;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 14:24:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Took [1;36m32.53[0m seconds;                ]8;id=934498;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=216870;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Started[33m...[0m                             ]8;id=213040;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=973376;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 14:24:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Took [1;36m8.83[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=118314;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=379037;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Started[33m...[0m                                 ]8;id=164029;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=645593;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=141926;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=189774;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=833454;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=522412;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 14:24:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.98[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=794606;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=378472;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 14:24:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=863224;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=520347;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 14:24:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.03[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=741876;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=30881;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=297865;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=688971;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 14:24:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.92[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=991277;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=868844;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/10/26 14:24:37][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=202701;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=762212;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         ---                                                                                 [2m                [0m
[2;36m                    [0m         a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micr [2m                [0m
[2;36m                    [0m         osoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFParser.java      [2m                [0m
[2;36m                    [0m         +++                                                                                 [2m                [0m
[2;36m                    [0m         b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micr [2m                [0m
[2;36m                    [0m         osoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFParser.java      [2m                [0m
[2;36m                    [0m         @@ [1;36m-55[0m,[1;36m6[0m +[1;36m55[0m,[1;36m8[0m @@                                                                   [2m                [0m
[2;36m                    [0m              private int memoryLimitInKb = EMB_OBJ_MAX_BYTES [35m/[0m [1;36m1024[0m;                        [2m                [0m
[2;36m                    [0m              @Field                                                                         [2m                [0m
[2;36m                    [0m              private boolean ignoreListMarkup = false;                                      [2m                [0m
[2;36m                    [0m         +    @Field                                                                         [2m                [0m
[2;36m                    [0m         +    private boolean disableJavaObjectDeserialization = true;                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              public Set[1m<[0m[1;95mMediaType[0m[39m> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [39m         return SUPPORTED_TYPES;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-90[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m92[0m[39m,[0m[1;36m8[0m[39m @@[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m     public void [0m[1;35mparseInline[0m[1;39m([0m[39mInputStream is, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata, ParseContext context[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m             throws TikaException, IOException, SAXException [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [39m         RTFEmbObjHandler embObjHandler =[0m                                           [2m                [0m
[2;36m                    [0m         [39m-                new [0m[1;35mRTFEmbObjHandler[0m[1;39m([0m[39mhandler, metadata, context, [0m                  [2m                [0m
[2;36m                    [0m         [1;35mgetMemoryLimitInKb[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m+                new [0m[1;35mRTFEmbObjHandler[0m[1;39m([0m[39mhandler, metadata, context, [0m                  [2m                [0m
[2;36m                    [0m         [1;35mgetMemoryLimitInKb[0m[1;39m([0m[1;39m)[0m[39m, [0m                                                              [2m                [0m
[2;36m                    [0m         [39m+                        disableJavaObjectDeserialization[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m         final TextExtractor ert = new [0m[1;35mTextExtractor[0m[1;39m([0m[39mhandler, metadata, [0m            [2m                [0m
[2;36m                    [0m         [39membObjHandler[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mert.setIgnoreListMarkup[0m[1;39m([0m[39mignoreListMarkup[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mert.extract[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-112[0m[39m,[0m[1;36m4[0m[39m +[0m[1;36m115[0m[39m,[0m[1;36m13[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         this.memoryLimitInKb = memoryLimitInKb;[0m                                    [2m                [0m
[2;36m                    [0m         [39m         USE_STATIC = false;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    public boolean [0m[1;35misJavaObjectDeserializationDisabled[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [39m+        return disableJavaObjectDeserialization;[0m                                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    @Field[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+    public void [0m[1;35msetDisableJavaObjectDeserialization[0m[1;39m([0m[39mboolean disable[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [39m+        this.disableJavaObjectDeserialization = disable;[0m                           [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m[1;39m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- [0m                                                                                [2m                [0m
[2;36m                    [0m         [39ma/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micr[0m [2m                [0m
[2;36m                    [0m         [39mosoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.ja[0m [2m                [0m
[2;36m                    [0m         [39mva[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m+++ [0m                                                                                [2m                [0m
[2;36m                    [0m         [39mb/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micr[0m [2m                [0m
[2;36m                    [0m         [39mosoft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.ja[0m [2m                [0m
[2;36m                    [0m         [39mva[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-67[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m67[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m     private final EmbeddedDocumentUtil embeddedDocumentUtil;[0m                       [2m                [0m
[2;36m                    [0m         [39m     private final UnsynchronizedByteArrayOutputStream os;[0m                          [2m                [0m
[2;36m                    [0m         [39m     private final int memoryLimitInKb;[0m                                             [2m                [0m
[2;36m                    [0m         [39m+    private final boolean disableJavaObjectDeserialization;[0m                        [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     private boolean isPictBitmap = false;[0m                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[95mhigh[0m[39m hex cached for writing hexpair chars [0m[1;39m([0m[39mdata[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-82[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m83[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m     private EMB_STATE state = EMB_STATE.NADA;[0m                                      [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     protected [0m[1;35mRTFEmbObjHandler[0m[1;39m([0m[39mContentHandler handler, Metadata metadata, [0m         [2m                [0m
[2;36m                    [0m         [39mParseContext context,[0m                                                               [2m                [0m
[2;36m                    [0m         [39m-                               int memoryLimitInKb[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [39m+                               int memoryLimitInKb, boolean [0m                       [2m                [0m
[2;36m                    [0m         [39mdisableJavaObjectDeserialization[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m         this.handler = handler;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m         this.embeddedDocumentUtil = new [0m[1;35mEmbeddedDocumentUtil[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m         os = [0m[1;35mUnsynchronizedByteArrayOutputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m         this.memoryLimitInKb = memoryLimitInKb;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+        this.disableJavaObjectDeserialization = disableJavaObjectDeserialization;[0m  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     protected void [0m[1;35mstartPict[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-211[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m213[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mextractObj[0m[1;39m([0m[39mbytes, handler, metadata[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.JAVA_OBJDATA[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39mdisableJavaObjectDeserialization[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mTikaException[0m[1;39m([0m                                           [2m                [0m
[2;36m                    [0m         [39m+                    [0m[32m"Java object deserialization from RTF files is disabled for [0m   [2m                [0m
[2;36m                    [0m         [32msecurity reasons. "[0m[39m +[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+                    [0m[32m"To enable, set [0m[32mdisableJavaObjectDeserialization[0m[32m=[0m[32mfalse[0m[32m in [0m     [2m                [0m
[2;36m                    [0m         [32mRTFParser configuration."[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m             try [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m                 Object obj = new [0m[1;35mObjectInputStream[0m[1;39m([0m                                [2m                [0m
[2;36m                    [0m         [39m                         [0m[1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueHigh: Remote[0m [2m                [0m
[2;36m                    [0m         [39mCode Execution[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mUnrestricted class/object creation based on externally controlled data may allow[0m    [2m                [0m
[2;36m                    [0m         [39mremote code execution depending on available classes on the classpath.[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mjaz.Zer.reportFinding[0m[1;39m([0m[39mZer.jav[0m[1;92ma:110[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mjaz.Zer.reportFindingIfEnabled[0m[1;39m([0m[39mZer.jav[0m[1;92ma:105[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mjaz.Zer.readObject[0m[1;39m([0m[39mZer.jav[0m[1;92ma:377[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1;39m([0m[39mNative [0m  [2m                [0m
[2;36m                    [0m         [39mMethod[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1;39m([0m[39mNativeMethodAccessor[0m [2m                [0m
[2;36m                    [0m         [39mImpl.jav[0m[1;92ma:77[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1;39m([0m[39mDelegatingMethod[0m [2m                [0m
[2;36m                    [0m         [39mAccessorImpl.jav[0m[1;92ma:43[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.reflect.Method.invoke[0m[1;39m([0m[39mMethod.jav[0m[1;92ma:568[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectStreamClass.invokeReadObject[0m[1;39m([0m[39mObjectStreamClass.jav[0m[1;92ma:1231[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readSerialData[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:2434[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readOrdinaryObject[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:2268[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readObject0[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:1744[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readObject[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:514[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readObject[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:472[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFEmbObjHandler.handleCompletedObject[0m[1;39m([0m[39mRTFEmbO[0m [2m                [0m
[2;36m                    [0m         [39mbjHandler.jav[0m[1;92ma:217[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.processGroupEnd[0m[1;39m([0m[39mTextExtractor.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:1475[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1;39m([0m[39mTextExtractor.jav[0m[1;92ma:482[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1;39m([0m[39mTextExtractor.jav[0m[1;92ma:466[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parseInline[0m[1;39m([0m[39mRTFParser.jav[0m[1;92ma:96[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parse[0m[1;39m([0m[39mRTFParser.jav[0m[1;92ma:70[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.RTFParserFuzzer.parseOne[0m[1;39m([0m[39mRTFParserFuzzer.jav[0m[1;92ma:53[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.RTFParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mRTFParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: aa5f725795b842b8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA critical Remote Code Execution [0m[1;39m([0m[39mRCE[0m[1;39m)[0m[39m vulnerability has been identified in Apache [0m [2m                [0m
[2;36m                    [0m         [39mTika's RTF parser component. The vulnerability is triggered during deserialization [0m [2m                [0m
[2;36m                    [0m         [39mof embedded objects in RTF files, where unrestricted class/object creation based on[0m [2m                [0m
[2;36m                    [0m         [39mexternally controlled data allows potential remote code execution. The fuzzer [0m      [2m                [0m
[2;36m                    [0m         [39mdetected this security issue while processing RTF content through the [0m              [2m                [0m
[2;36m                    [0m         [39m`RTFEmbObjHandler` class.[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis security issue represents a **Remote Code Execution** vulnerability classified[0m [2m                [0m
[2;36m                    [0m         [39mas a high-severity security risk. The vulnerability manifests when the Apache Tika [0m [2m                [0m
[2;36m                    [0m         [39mRTF parser processes specially crafted RTF files containing embedded objects.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThe issue is an **Unsafe Deserialization** vulnerability, where arbitrary Java [0m     [2m                [0m
[2;36m                    [0m         [39mobjects can be instantiated and deserialized from untrusted external input without [0m [2m                [0m
[2;36m                    [0m         [39mproper validation or restriction. This type of vulnerability is particularly [0m       [2m                [0m
[2;36m                    [0m         [39mdangerous as it can lead to arbitrary code execution if malicious serialized [0m       [2m                [0m
[2;36m                    [0m         [39mobjects are provided in the input data.[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Deserialization Point**: The vulnerability is triggered at [0m                    [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35morg.apache.tika.parser.microsoft.rtf.RTFEmbObjHandler.handleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m` [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m217[0m[1;39m)[0m[39m, where Java's `[0m[1;35mObjectInputStream.readObject[0m[1;39m([0m[1;39m)[0m[39m` is called to deserialize [0m [2m                [0m
[2;36m                    [0m         [39membedded objects from RTF content.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Call Chain**: The deserialization occurs deep within the RTF parsing logic:[0m    [2m                [0m
[2;36m                    [0m         [39m   - RTF parsing begins at `[0m[1;35mRTFParser.parse[0m[1;39m([0m[1;39m)[0m[39m` and `[0m[1;35mRTFParser.parseInline[0m[1;39m([0m[1;39m)[0m[39m`[0m        [2m                [0m
[2;36m                    [0m         [39m   - Text extraction happens through `[0m[1;35mTextExtractor.extract[0m[1;39m([0m[1;39m)[0m[39m`[0m                      [2m                [0m
[2;36m                    [0m         [39m   - Group end processing in `[0m[1;35mTextExtractor.processGroupEnd[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m1475[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m   - Finally, embedded object handling in [0m                                          [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mRTFEmbObjHandler.handleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m`[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Security Hook Detection**: The Jazzer fuzzer's security hooks [0m                 [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`[0m[1;35mjaz.Zer.readObject[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m successfully detected this unsafe deserialization pattern,[0m [2m                [0m
[2;36m                    [0m         [39mindicating that the code is performing unrestricted object instantiation based on [0m  [2m                [0m
[2;36m                    [0m         [39mexternal input.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Attack Vector**: The vulnerability is exploitable through maliciously crafted [0m [2m                [0m
[2;36m                    [0m         [39mRTF files that contain serialized Java objects in their embedded object structures.[0m [2m                [0m
[2;36m                    [0m         [39mAn attacker could embed arbitrary serialized objects that execute code during [0m      [2m                [0m
[2;36m                    [0m         [39mdeserialization.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a comprehensive understanding of this vulnerability, the following [0m         [2m                [0m
[2;36m                    [0m         [39mcomponents should be examined:[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **RTFEmbObjHandler Class**: Specifically the `[0m[1;35mhandleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m` method [0m   [2m                [0m
[2;36m                    [0m         [39maround line [0m[1;36m217[0m[39m to understand how embedded objects are processed and why [0m           [2m                [0m
[2;36m                    [0m         [39munrestricted deserialization is occurring.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **TextExtractor Class**: The `[0m[1;35mprocessGroupEnd[0m[1;39m([0m[1;39m)[0m[39m` method at line [0m[1;36m1475[0m[39m to [0m         [2m                [0m
[2;36m                    [0m         [39munderstand the flow of control leading to the vulnerable deserialization call.[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **RTF Object Embedding Mechanism**: The complete flow of how RTF files with [0m     [2m                [0m
[2;36m                    [0m         [39membedded objects are parsed and processed, including any validation or sanitization[0m [2m                [0m
[2;36m                    [0m         [39msteps [0m[1;39m([0m[39mor lack thereof[0m[1;39m)[0m[39m.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Input Validation**: Any existing input validation or object filtering [0m         [2m                [0m
[2;36m                    [0m         [39mmechanisms in the RTF parsing pipeline, particularly for embedded object data.[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Deserialization Configuration**: Whether any Java deserialization filters, [0m    [2m                [0m
[2;36m                    [0m         [39mwhitelists, or other protective mechanisms are in place or could be implemented.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Similar Patterns**: Other locations in the codebase where [0m                     [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mObjectInputStream.readObject[0m[1;39m([0m[1;39m)[0m[39m` or similar deserialization methods might be used [0m  [2m                [0m
[2;36m                    [0m         [39mwith external input.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueHigh: Remote[0m [2m                [0m
[2;36m                    [0m         [39mCode Execution[0m                                                                      [2m                [0m
[2;36m                    [0m         [39mUnrestricted class/object creation based on externally controlled data may allow[0m    [2m                [0m
[2;36m                    [0m         [39mremote code execution depending on available classes on the classpath.[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mjaz.Zer.reportFinding[0m[1;39m([0m[39mZer.jav[0m[1;92ma:110[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mjaz.Zer.reportFindingIfEnabled[0m[1;39m([0m[39mZer.jav[0m[1;92ma:105[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mjaz.Zer.readObject[0m[1;39m([0m[39mZer.jav[0m[1;92ma:377[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke0[0m[1;39m([0m[39mNative [0m  [2m                [0m
[2;36m                    [0m         [39mMethod[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjdk.internal.reflect.NativeMethodAccessorImpl.invoke[0m[1;39m([0m[39mNativeMethodAccessor[0m [2m                [0m
[2;36m                    [0m         [39mImpl.jav[0m[1;92ma:77[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjdk.internal.reflect.DelegatingMethodAccessorImpl.invoke[0m[1;39m([0m[39mDelegatingMethod[0m [2m                [0m
[2;36m                    [0m         [39mAccessorImpl.jav[0m[1;92ma:43[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.reflect.Method.invoke[0m[1;39m([0m[39mMethod.jav[0m[1;92ma:568[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectStreamClass.invokeReadObject[0m[1;39m([0m[39mObjectStreamClass.jav[0m[1;92ma:1231[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readSerialData[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:2434[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readOrdinaryObject[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:2268[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readObject0[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:1744[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readObject[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:514[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/[0m[1;35mjava.io.ObjectInputStream.readObject[0m[1;39m([0m[39mObjectInputStream.jav[0m[1;92ma:472[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFEmbObjHandler.handleCompletedObject[0m[1;39m([0m[39mRTFEmbO[0m [2m                [0m
[2;36m                    [0m         [39mbjHandler.jav[0m[1;92ma:217[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.processGroupEnd[0m[1;39m([0m[39mTextExtractor.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:1475[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1;39m([0m[39mTextExtractor.jav[0m[1;92ma:482[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.TextExtractor.extract[0m[1;39m([0m[39mTextExtractor.jav[0m[1;92ma:466[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parseInline[0m[1;39m([0m[39mRTFParser.jav[0m[1;92ma:96[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.microsoft.rtf.RTFParser.parse[0m[1;39m([0m[39mRTFParser.jav[0m[1;92ma:70[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.RTFParserFuzzer.parseOne[0m[1;39m([0m[39mRTFParserFuzzer.jav[0m[1;92ma:53[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.RTFParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mRTFParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: aa5f725795b842b8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:19[0m[39m-[0m[1;36m41[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.ObjectInputStream;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.concurrent.atomic.AtomicInteger;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.commons.io.FilenameUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.commons.io.input.UnsynchronizedByteArrayInputStream;[0m           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.commons.io.output.UnsynchronizedByteArrayOutputStream;[0m         [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.exception.TikaMemoryLimitException;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.metadata.RTFMetadata;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.sax.EmbeddedContentHandler;[0m                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:213[0m[39m-[0m[1;36m225[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.JAVA_OBJDATA[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                Object obj = new [0m[1;35mObjectInputStream[0m[1;39m([0m                             [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                        [0m                                                        [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[39mbytes[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                                [0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.readObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mRTFMetadata.EMB_CLASS, [0m[1;35mobj.getClass[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE,[0m   [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        [0m[1;35mMediaType.text[0m[1;39m([0m[32m"plain"[0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                [0m[1;35mextractObj[0m[1;39m([0m[1;35mobj.toString[0m[1;39m([0m[1;39m)[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mhandler, metadata[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mClassNotFoundException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"Not found"[0m[39m, e[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.NADA[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFObjDataParser.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:21[0m[39m-[0m[1;36m49[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.FileNotFoundException;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.UnsupportedEncodingException;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.concurrent.atomic.AtomicInteger;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.commons.io.FilenameUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.commons.io.input.UnsynchronizedByteArrayInputStream;[0m           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.commons.io.output.UnsynchronizedByteArrayOutputStream;[0m         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.poifs.filesystem.DirectoryNode;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.poi.poifs.filesystem.DocumentEntry;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.poi.poifs.filesystem.DocumentInputStream;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.poi.poifs.filesystem.Entry;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.poi.poifs.filesystem.FileMagic;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.poi.poifs.filesystem.Ole10Native;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.poi.poifs.filesystem.Ole10NativeException;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.poi.poifs.filesystem.POIFSFileSystem;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.exception.TikaMemoryLimitException;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.io.BoundedInputStream;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.io.EndianUtils;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.metadata.RTFMetadata;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.parser.microsoft.OfficeParser.POIFSDocumentType;[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFObjDataParser.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:86[0m[39m-[0m[1;36m139[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    protected byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mparse[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes, Metadata metadata, AtomicInteger [0m       [2m                [0m
[2;36m                    [0m         [39munknownFilenameCount[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            throws IOException, TikaException [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        UnsynchronizedByteArrayInputStream is = [0m                                 [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        long version = [0m[1;35mreadUInt[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;35mmetadata.add[0m[1;39m([0m[39mRTFMetadata.EMB_APP_VERSION, [0m[1;35mLong.toString[0m[1;39m([0m[39mversion[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        long formatId = [0m[1;35mreadUInt[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[35m/[0m[35m/[0m[95m2[0m[39m is an embedded object. [0m[1;36m1[0m[39m is a link.[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        if [0m[1;39m([0m[39mformatId != 2L[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            return null;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        String className = [0m[1;35mreadLengthPrefixedAnsiString[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        String topicName = [0m[1;35mreadLengthPrefixedAnsiString[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        String itemName = [0m[1;35mreadLengthPrefixedAnsiString[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        if [0m[1;39m([0m[1;35mclassName.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mmetadata.add[0m[1;39m([0m[39mRTFMetadata.EMB_CLASS, className[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        if [0m[1;39m([0m[1;35mtopicName.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;35mmetadata.add[0m[1;39m([0m[39mRTFMetadata.EMB_TOPIC, topicName[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        if [0m[1;39m([0m[1;35mitemName.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;35mmetadata.add[0m[1;39m([0m[39mRTFMetadata.EMB_ITEM, itemName[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        long dataSz = [0m[1;35mreadUInt[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[35m/[0m[35m/[0m[95mreadBytes[0m[39m tests for reading too many bytes[0m                            [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m embObjBytes = [0m[1;35mreadBytes[0m[1;39m([0m[39mis, dataSz[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        if [0m[1;39m([0m[1;35mclassName.toLowerCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"package"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            return [0m[1;35mhandlePackage[0m[1;39m([0m[39membObjBytes, metadata[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mclassName.toLowerCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"pbrush"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:            [0m[35m/[0m[35m/[0m[95msimple[0m[39m bitmap bytes[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            return embObjBytes;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:            UnsynchronizedByteArrayInputStream embIs = [0m                         [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[39membObjBytes[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:            boolean hasPoifs;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                hasPoifs = [0m[1;35mhasPOIFSHeader[0m[1;39m([0m[39membIs[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:                return embObjBytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            if [0m[1;39m([0m[39mhasPoifs[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                try [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                    return [0m[1;35mhandleEmbeddedPOIFS[0m[1;39m([0m[39membIs, metadata, [0m                [2m                [0m
[2;36m                    [0m         [39munknownFilenameCount[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                    [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        return embObjBytes;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:97[0m[39m-[0m[1;36m105[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    protected void [0m[1;35mstartObjData[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        state = EMB_STATE.OBJDATA;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    protected void [0m[1;35mstartJavaObjData[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        state = EMB_STATE.JAVA_OBJDATA;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:188[0m[39m-[0m[1;36m229[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    protected void [0m[1;35mhandleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m bytes = [0m[1;35mos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        if [0m[1;39m([0m[39mstate == EMB_STATE.OBJDATA[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            RTFObjDataParser objParser = new [0m[1;35mRTFObjDataParser[0m[1;39m([0m[39mmemoryLimitInKb[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                byte[0m[1;39m[[0m[1;39m][0m[39m objBytes = [0m[1;35mobjParser.parse[0m[1;39m([0m[39mbytes, metadata, [0m             [2m                [0m
[2;36m                    [0m         [39munknownFilenameCount[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                [0m[1;35mextractObj[0m[1;39m([0m[39mobjBytes, handler, metadata[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordException[0m[1;39m([0m[39me, metadata[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.PICT[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            String filePath = [0m[1;35mmetadata.get[0m[1;39m([0m[39mRTFMetadata.RTF_PICT_META_PREFIX + [0m  [2m                [0m
[2;36m                    [0m         [32m"wzDescription"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            if [0m[1;39m([0m[39mfilePath != null && [0m[1;35mfilePath.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RELATIONSHIP_ID, [0m      [2m                [0m
[2;36m                    [0m         [39mfilePath[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY, [0m             [2m                [0m
[2;36m                    [0m         [1;35mFilenameUtils.getName[0m[1;39m([0m[39mfilePath[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.ORIGINAL_RESOURCE_NAME, [0m        [2m                [0m
[2;36m                    [0m         [39mfilePath[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mRTFMetadata.THUMBNAIL, [0m[1;35mBoolean.toString[0m[1;39m([0m[39minObject[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            if [0m[1;39m([0m[39misPictBitmap[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                        TikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE, [0m       [2m                [0m
[2;36m                    [0m         [32m"image/x-rtf-raw-bitmap"[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;35mextractObj[0m[1;39m([0m[39mbytes, handler, metadata[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.JAVA_OBJDATA[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                Object obj = new [0m[1;35mObjectInputStream[0m[1;39m([0m                             [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                        [0m                                                        [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[39mbytes[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                                [0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.readObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mRTFMetadata.EMB_CLASS, [0m[1;35mobj.getClass[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE,[0m   [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        [0m[1;35mMediaType.text[0m[1;39m([0m[32m"plain"[0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                [0m[1;35mextractObj[0m[1;39m([0m[1;35mobj.toString[0m[1;39m([0m[1;39m)[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mhandler, metadata[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mClassNotFoundException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"Not found"[0m[39m, e[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.NADA[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow...no[0m[39m start for pict or embed?![0m                            [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:        [0m[1;35mreset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/TextExtractor.jav[0m[1;92ma:14[0m [2m                [0m
[2;36m                    [0m         [1;92m60[0m[39m-[0m[1;36m1490[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1460[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1461[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1462[0m[39m:        assert groupState.depth > [0m[1;36m0[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1463[0m[39m:        ansiSkip = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1464[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1465[0m[39m:        if [0m[1;39m([0m[39mgroupState.objdata == true[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1466[0m[39m:            try [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1467[0m[39m:                [0m[1;35membObjHandler.handleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1468[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException | IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1469[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordException[0m[1;39m([0m[39me, metadata[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1470[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1471[0m[39m:            groupState.objdata = false;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1472[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1473[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mgroupState.javaobjdata == true[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1474[0m[39m:            try [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1475[0m[39m:                [0m[1;35membObjHandler.handleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1476[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException | IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordException[0m[1;39m([0m[39me, metadata[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:            groupState.javaobjdata = false;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mgroupState.pictDepth > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:            if [0m[1;39m([0m[39mgroupState.sn == true[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:                [0m[1;35membObjHandler.endSN[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mgroupState.sv == true[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:                [0m[1;35membObjHandler.endSV[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mgroupState.sp == true[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:                [0m[1;35membObjHandler.endSP[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mgroupState.pictDepth == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:                [0m[1;35membObjHandler.handleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/fork/ForkObjectInputStream.jav[0m[1;92ma:19[0m[39m-[0m[1;36m27[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.DataInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.DataOutputStream;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.ObjectInputStream;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.ObjectOutputStream;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.ObjectStreamClass;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/fork/ForkObjectInputStream.jav[0m[1;92ma:89[0m[39m-[0m[1;36m98[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    public static Object [0m[1;35mreadObject[0m[1;39m([0m[39mDataInputStream input, ClassLoader loader[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            throws IOException, ClassNotFoundException [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        int n = [0m[1;35minput.readInt[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m data = new byte[0m[1;39m[[0m[39mn[0m[1;39m][0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;35minput.readFully[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        ObjectInputStream deserializer =[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                new [0m[1;35mForkObjectInputStream[0m[1;39m([0m[39mnew [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [39mloader[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        return [0m[1;35mdeserializer.readObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/GroupState.jav[0m[1;92ma:1[0m[39m-[0m[1;36m71[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.microsoft.rtf;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m[35m/[0m[39m* Holds all state associated with current RTF group, ie [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: * [0m[33m...[0m[39m [0m[1;39m}[0m[39m. *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m24:c[0m[39mlass GroupState [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:    public int depth;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    public boolean bold;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:    public boolean italic;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[3;92mTrue[0m[39m if we are skipping all text in current group,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    [0m[35m/[0m[35m/[0m[39m eg if group leads with a \*:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    public boolean ignore;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[35m/[0m[39m Default is [0m[1;36m1[0m[39m if no uc control has been seen yet:[0m                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    public int ucSkip = [0m[1;36m1[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    public int list;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public int listLevel;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    public Charset fontCharset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[35m/[0m[95min[0m[39m objdata[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    public boolean objdata;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[35m/[0m[95min[0m[39m javaobjdata[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    public boolean javaobjdata;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[35m/[0m[35m/[0m[95mdepth[0m[39m in pict, [0m[1;36m1[0m[39m = at pict level[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public int pictDepth;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    [0m[35m/[0m[35m/[0m[95min[0m[39m picprop key/value pair[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    public boolean sp;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[35m/[0m[35m/[0m[95min[0m[39m picprop's name [0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    public boolean sn;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[35m/[0m[95min[0m[39m picprop's value[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    public boolean sv;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[35m/[0m[95min[0m[39m embedded object or not[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    public boolean object;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    public boolean annotation;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[35m/[0m[35m/[0m[39m Create default [0m[1;39m([0m[39mroot[0m[1;39m)[0m[39m GroupState[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public [0m[1;35mGroupState[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[35m/[0m[39m Create new GroupState, inheriting all properties from current one, adding[0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m to the depth[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    public [0m[1;35mGroupState[0m[1;39m([0m[39mGroupState other[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        bold = other.bold;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        italic = other.italic;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        ignore = other.ignore;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        ucSkip = other.ucSkip;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        list = other.list;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        listLevel = other.listLevel;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        fontCharset = other.fontCharset;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        depth = [0m[1;36m1[0m[39m + other.depth;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        pictDepth = other.pictDepth > [0m[1;36m0[0m[39m ? other.pictDepth + [0m[1;36m1[0m[39m : [0m[1;36m0[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        javaobjdata = other.javaobjdata;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m not inherit object, sn, sv, sp or annotation[0m                        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/TextExtractor.jav[0m[1;92ma:12[0m [2m                [0m
[2;36m                    [0m         [1;92m74[0m[39m-[0m[1;36m1276[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1274[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mequals[0m[1;39m([0m[32m"javaobjdata"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1275[0m[39m:            groupState.javaobjdata = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1276[0m[39m:            [0m[1;35membObjHandler.startJavaObjData[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/TextExtractor.jav[0m[1;92ma:48[0m [2m                [0m
[2;36m                    [0m         [1;92m7[0m[39m-[0m[1;36m489[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mgroupState.objdata == true || groupState.javaobjdata == [0m [2m                [0m
[2;36m                    [0m         [39mtrue[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    || groupState.pictDepth == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;35membObjHandler.writeHexChar[0m[1;39m([0m[39mb[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:231[0m[39m-[0m[1;36m263[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:    private void [0m[1;35mextractObj[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:            throws SAXException, IOException, TikaException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:        if [0m[1;39m([0m[39mbytes == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_LENGTH, [0m[1;35mInteger.toString[0m[1;39m([0m[39mbytes.length[0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentUtil.shouldParseEmbedded[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:            TikaInputStream stream = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:            if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                String extension = [0m[1;35membeddedDocumentUtil.getExtension[0m[1;39m([0m[39mstream, [0m   [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                if [0m[1;39m([0m[39minObject && state == EMB_STATE.PICT[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:                    [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY,[0m          [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:                            [0m[32m"thumbnail_"[0m[39m + thumbCount++ + extension[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:                    [0m[1;35mmetadata.set[0m[1;39m([0m[39mRTFMetadata.THUMBNAIL, [0m[32m"true"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:                    [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY,[0m          [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:                            [0m[32m"file_"[0m[39m + [0m[1;35munknownFilenameCount.getAndIncrement[0m[1;39m([0m[1;39m)[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [39mextension[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:                embeddedDocumentUtil[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:                        [0m[1;35m.parseEmbedded[0m[1;39m([0m[39mstream, new [0m                             [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m, metadata,[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:                                true[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:                [0m[1;35mstream.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/test/java/org/apache/tika/parser/microsoft/rtf/RTFParserTest.jav[0m[1;92ma:51[0m [2m                [0m
[2;36m                    [0m         [1;92m7[0m[39m-[0m[1;36m528[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:    public void [0m[1;35mtestJavaObj[0m[1;39m([0m[39m@TempDir Path tmpDir[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:        String rtf = [0m                                                           [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.resourceToString[0m[1;39m([0m[32m"/test-documents/rtf/rtfJavaObjTemplate.rtf"[0m[39m,[0m              [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:                StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:        String s = new [0m[1;35mString[0m[1;39m([0m[32m"the quick brown fox"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:        rtf = [0m[1;35mwriteObject[0m[1;39m([0m[39ms, rtf[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        Path p = [0m[1;35mtmpDir.resolve[0m[1;39m([0m[32m"test.rtf"[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:        [0m[1;35mFiles.write[0m[1;39m([0m[39mp, [0m[1;35mrtf.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:        List<Metadata> metadata = [0m[1;35mgetRecursiveMetadata[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m525[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m2[0m[39m, [0m[1;35mmetadata.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m526[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"java.lang.String"[0m[39m, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[39mRTFMetadata.EMB_CLASS[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m527[0m[39m:        [0m[1;35massertContains[0m[1;39m([0m[32m"the quick brown fox"[0m[39m, [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[39mTikaCoreProperties.TIKA_CONTENT[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/test/java/org/apache/tika/parser/microsoft/rtf/RTFParserTest.jav[0m[1;92ma:53[0m [2m                [0m
[2;36m                    [0m         [1;92m0[0m[39m-[0m[1;36m558[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:    private String [0m[1;35mwriteObject[0m[1;39m([0m[39mObject s, String rtf[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m serialized = [0m[1;35mserialize[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:        String hex = [0m[1;35mHex.encodeHexString[0m[1;39m([0m[39mserialized[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:        String hexWrapped = [0m[1;35mwrap[0m[1;39m([0m[39mhex, [0m[1;36m80[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:        rtf = [0m[1;35mrtf.replace[0m[1;39m([0m[32m"0123456789abcdef"[0m[39m, hexWrapped[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m535[0m[39m:        return rtf;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m536[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m537[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m538[0m[39m:    private String [0m[1;35mwrap[0m[1;39m([0m[39mString hex, int step[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m539[0m[39m:        StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m540[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mhex.length[0m[1;39m([0m[1;39m)[0m[39m; i += step[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m541[0m[39m:            int end = [0m[1;35mMath.min[0m[1;39m([0m[1;35mhex.length[0m[1;39m([0m[1;39m)[0m[39m, i + step[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m542[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[1;35mhex.substring[0m[1;39m([0m[1;36m0[0m[39m, end[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m543[0m[39m:            if [0m[1;39m([0m[39mend != [0m[1;35mhex.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m544[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[32m"\n"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m545[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m546[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m547[0m[39m:        return [0m[1;35msb.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m548[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m549[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m550[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mserialize[0m[1;39m([0m[39mObject obj[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m551[0m[39m:        UnsynchronizedByteArrayOutputStream baos =[0m                              [2m                [0m
[2;36m                    [0m         [1;36m552[0m[39m:                [0m[1;35mUnsynchronizedByteArrayOutputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m553[0m[39m:        try [0m[1;39m([0m[39mObjectOutputStream os = new [0m[1;35mObjectOutputStream[0m[1;39m([0m[39mbaos[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m554[0m[39m:            [0m[1;35mos.writeObject[0m[1;39m([0m[39mobj[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:        return [0m[1;35mbaos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:19[0m[39m-[0m[1;36m40[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static org.apache.tika.sax.XHTMLContentHandler.XHTML;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.FilenameFilter;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.xml.sax.helpers.AttributesImpl;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.exception.CorruptedFileException;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.exception.EncryptedDocumentException;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.parser.DelegatingParser;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.parser.ParseRecord;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.sax.BodyContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.sax.EmbeddedContentHandler;[0m                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:62[0m[39m-[0m[1;36m78[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    public boolean [0m[1;35mshouldParseEmbedded[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        DocumentSelector selector = [0m[1;35mcontext.get[0m[1;39m([0m[39mDocumentSelector.class[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39mselector != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            return [0m[1;35mselector.select[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        FilenameFilter filter = [0m[1;35mcontext.get[0m[1;39m([0m[39mFilenameFilter.class[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        if [0m[1;39m([0m[39mfilter != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                return [0m[1;35mfilter.accept[0m[1;39m([0m[39mABSTRACT_PATH, name[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        return true;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/DocumentSelector.jav[0m[1;92ma:30[0m[39m-[0m[1;36m42[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:public interface DocumentSelector [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     * Checks if a document with the given metadata matches the specified[0m        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * selection criteria.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * @param metadata document metadata[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * @return <code>true<[0m[35m/[0m[95mcode[0m[39m> if the document matches the selection criteria,[0m [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * <code>false<[0m[35m/[0m[95mcode[0m[39m> otherwise[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    boolean [0m[1;35mselect[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-batch/src/main/java/org/apache/tika/batch/fs/FSDocumentSelector.jav[0m[1;92ma:35[0m[39m-[0m[1;36m82[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:public class FSDocumentSelector implements DocumentSelector [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[35m/[0m[35m/[0m[95mcan[0m[39m be null![0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private final Pattern includeFileName;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[35m/[0m[35m/[0m[95mcan[0m[39m be null![0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private final Pattern excludeFileName;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    private final long maxFileSizeBytes;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private final long minFileSizeBytes;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    public [0m[1;35mFSDocumentSelector[0m[1;39m([0m[39mPattern includeFileName, Pattern excludeFileName, [0m [2m                [0m
[2;36m                    [0m         [39mlong minFileSizeBytes, long maxFileSizeBytes[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        this.includeFileName = includeFileName;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        this.excludeFileName = excludeFileName;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        this.minFileSizeBytes = minFileSizeBytes;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        this.maxFileSizeBytes = maxFileSizeBytes;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public boolean [0m[1;35mselect[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        String fName = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        long sz = [0m[1;35mPropsUtil.getLong[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[39mMetadata.CONTENT_LENGTH[0m[1;39m)[0m[39m, -1L[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        if [0m[1;39m([0m[39mmaxFileSizeBytes > [0m[1;36m-1[0m[39m && sz > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            if [0m[1;39m([0m[39msz > maxFileSizeBytes[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:                return false;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        if [0m[1;39m([0m[39mminFileSizeBytes > [0m[1;36m-1[0m[39m && sz > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            if [0m[1;39m([0m[39msz < minFileSizeBytes[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:                return false;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        if [0m[1;39m([0m[39mexcludeFileName != null && fName != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            Matcher m = [0m[1;35mexcludeFileName.matcher[0m[1;39m([0m[39mfName[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            if [0m[1;39m([0m[1;35mm.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                return false;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        if [0m[1;39m([0m[39mincludeFileName != null && fName != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            Matcher m = [0m[1;35mincludeFileName.matcher[0m[1;39m([0m[39mfName[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            return [0m[1;35mm.find[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        return true;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFParser.jav[0m[1;92ma:19[0m[39m-[0m[1;36m34[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.commons.io.input.TaggedInputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.tika.config.Field;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFParser.jav[0m[1;92ma:54[0m[39m-[0m[1;36m58[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    @Field[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private int memoryLimitInKb = EMB_OBJ_MAX_BYTES [0m[35m/[0m[39m [0m[1;36m1024[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    @Field[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    private boolean ignoreListMarkup = false;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFParser.jav[0m[1;92ma:90[0m[39m-[0m[1;36m97[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    public void [0m[1;35mparseInline[0m[1;39m([0m[39mInputStream is, ContentHandler handler, Metadata [0m    [2m                [0m
[2;36m                    [0m         [39mmetadata, ParseContext context[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            throws TikaException, IOException, SAXException [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        RTFEmbObjHandler embObjHandler =[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                new [0m[1;35mRTFEmbObjHandler[0m[1;39m([0m[39mhandler, metadata, context, [0m                [2m                [0m
[2;36m                    [0m         [1;35mgetMemoryLimitInKb[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        final TextExtractor ert = new [0m[1;35mTextExtractor[0m[1;39m([0m[39mhandler, metadata, [0m          [2m                [0m
[2;36m                    [0m         [39membObjHandler[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;35mert.setIgnoreListMarkup[0m[1;39m([0m[39mignoreListMarkup[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;35mert.extract[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFParser.jav[0m[1;92ma:54[0m[39m-[0m[1;36m58[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    @Field[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private int memoryLimitInKb = EMB_OBJ_MAX_BYTES [0m[35m/[0m[39m [0m[1;36m1024[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    @Field[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    private boolean ignoreListMarkup = false;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFParser.jav[0m[1;92ma:110[0m[39m-[0m[1;36m11[0m [2m                [0m
[2;36m                    [0m         [1;36m5[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    @Field[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    public void [0m[1;35msetMemoryLimitInKb[0m[1;39m([0m[39mint memoryLimitInKb[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        this.memoryLimitInKb = memoryLimitInKb;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        USE_STATIC = false;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/metadata/filter/ExcludeFieldMetadataFilter.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:19[0m[39m-[0m[1;36m26[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.tika.config.Field;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/metadata/filter/ExcludeFieldMetadataFilter.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:28[0m[39m-[0m[1;36m57[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public class ExcludeFieldMetadataFilter extends MetadataFilter [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    private final Set<String> excludeSet;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    public [0m[1;35mExcludeFieldMetadataFilter[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew HashSet<>[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    public [0m[1;35mExcludeFieldMetadataFilter[0m[1;39m([0m[39mSet<String> exclude[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:        this.excludeSet = exclude;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    public void [0m[1;35mfilter[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m throws TikaException [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:        for [0m[1;39m([0m[39mString field : excludeSet[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:            [0m[1;35mmetadata.remove[0m[1;39m([0m[39mfield[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param exclude list of fields to exclude[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    @Field[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    public void [0m[1;35msetExclude[0m[1;39m([0m[39mList<String> exclude[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;35mthis.excludeSet.addAll[0m[1;39m([0m[39mexclude[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public List<String> [0m[1;35mgetExclude[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        return new ArrayList<>[0m[1;39m([0m[39mexcludeSet[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/TextExtractor.jav[0m[1;92ma:14[0m [2m                [0m
[2;36m                    [0m         [1;92m65[0m[39m-[0m[1;36m1479[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1465[0m[39m:        if [0m[1;39m([0m[39mgroupState.objdata == true[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1466[0m[39m:            try [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1467[0m[39m:                [0m[1;35membObjHandler.handleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1468[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException | IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1469[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordException[0m[1;39m([0m[39me, metadata[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1470[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1471[0m[39m:            groupState.objdata = false;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1472[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1473[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mgroupState.javaobjdata == true[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1474[0m[39m:            try [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1475[0m[39m:                [0m[1;35membObjHandler.handleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1476[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException | IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordException[0m[1;39m([0m[39me, metadata[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:            groupState.javaobjdata = false;[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:188[0m[39m-[0m[1;36m229[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:    protected void [0m[1;35mhandleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m bytes = [0m[1;35mos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        if [0m[1;39m([0m[39mstate == EMB_STATE.OBJDATA[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            RTFObjDataParser objParser = new [0m[1;35mRTFObjDataParser[0m[1;39m([0m[39mmemoryLimitInKb[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                byte[0m[1;39m[[0m[1;39m][0m[39m objBytes = [0m[1;35mobjParser.parse[0m[1;39m([0m[39mbytes, metadata, [0m             [2m                [0m
[2;36m                    [0m         [39munknownFilenameCount[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                [0m[1;35mextractObj[0m[1;39m([0m[39mobjBytes, handler, metadata[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordException[0m[1;39m([0m[39me, metadata[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.PICT[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            String filePath = [0m[1;35mmetadata.get[0m[1;39m([0m[39mRTFMetadata.RTF_PICT_META_PREFIX + [0m  [2m                [0m
[2;36m                    [0m         [32m"wzDescription"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            if [0m[1;39m([0m[39mfilePath != null && [0m[1;35mfilePath.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RELATIONSHIP_ID, [0m      [2m                [0m
[2;36m                    [0m         [39mfilePath[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY, [0m             [2m                [0m
[2;36m                    [0m         [1;35mFilenameUtils.getName[0m[1;39m([0m[39mfilePath[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.ORIGINAL_RESOURCE_NAME, [0m        [2m                [0m
[2;36m                    [0m         [39mfilePath[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mRTFMetadata.THUMBNAIL, [0m[1;35mBoolean.toString[0m[1;39m([0m[39minObject[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            if [0m[1;39m([0m[39misPictBitmap[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                        TikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE, [0m       [2m                [0m
[2;36m                    [0m         [32m"image/x-rtf-raw-bitmap"[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;35mextractObj[0m[1;39m([0m[39mbytes, handler, metadata[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.JAVA_OBJDATA[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                Object obj = new [0m[1;35mObjectInputStream[0m[1;39m([0m                             [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                        [0m                                                        [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[39mbytes[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                                [0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.readObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mRTFMetadata.EMB_CLASS, [0m[1;35mobj.getClass[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE,[0m   [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        [0m[1;35mMediaType.text[0m[1;39m([0m[32m"plain"[0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                [0m[1;35mextractObj[0m[1;39m([0m[1;35mobj.toString[0m[1;39m([0m[1;39m)[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mhandler, metadata[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mClassNotFoundException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"Not found"[0m[39m, e[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.NADA[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow...no[0m[39m start for pict or embed?![0m                            [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:        [0m[1;35mreset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFParser.jav[0m[1;92ma:63[0m[39m-[0m[1;36m77[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m[32m"application/rtf"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        TaggedInputStream tagged = new [0m[1;35mTaggedInputStream[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, metadata[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;35mxhtml.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            [0m[1;35mparseInline[0m[1;39m([0m[39mstream, xhtml, metadata, context[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            [0m[1;35mtagged.throwIfCauseOf[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"Error parsing an RTF document"[0m[39m, e[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            [0m[1;35mxhtml.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFParser.jav[0m[1;92ma:90[0m[39m-[0m[1;36m97[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    public void [0m[1;35mparseInline[0m[1;39m([0m[39mInputStream is, ContentHandler handler, Metadata [0m    [2m                [0m
[2;36m                    [0m         [39mmetadata, ParseContext context[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            throws TikaException, IOException, SAXException [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        RTFEmbObjHandler embObjHandler =[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                new [0m[1;35mRTFEmbObjHandler[0m[1;39m([0m[39mhandler, metadata, context, [0m                [2m                [0m
[2;36m                    [0m         [1;35mgetMemoryLimitInKb[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        final TextExtractor ert = new [0m[1;35mTextExtractor[0m[1;39m([0m[39mhandler, metadata, [0m          [2m                [0m
[2;36m                    [0m         [39membObjHandler[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;35mert.setIgnoreListMarkup[0m[1;39m([0m[39mignoreListMarkup[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;35mert.extract[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:84[0m[39m-[0m[1;36m90[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    protected [0m[1;35mRTFEmbObjHandler[0m[1;39m([0m[39mContentHandler handler, Metadata metadata, [0m       [2m                [0m
[2;36m                    [0m         [39mParseContext context,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                               int memoryLimitInKb[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        this.handler = handler;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        this.embeddedDocumentUtil = new [0m[1;35mEmbeddedDocumentUtil[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        os = [0m[1;35mUnsynchronizedByteArrayOutputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        this.memoryLimitInKb = memoryLimitInKb;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:280[0m[39m-[0m[1;36m286[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    private enum EMB_STATE [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:        PICT, [0m[35m/[0m[35m/[0m[95mrecording[0m[39m pict data[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        OBJDATA, [0m[35m/[0m[35m/[0m[95mrecording[0m[39m objdata[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        JAVA_OBJDATA, [0m[35m/[0m[35m/[0m[95mrecording[0m[39m java obj data[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        NADA[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/TextExtractor.jav[0m[1;92ma:12[0m [2m                [0m
[2;36m                    [0m         [1;92m74[0m[39m-[0m[1;36m1276[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1274[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mequals[0m[1;39m([0m[32m"javaobjdata"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1275[0m[39m:            groupState.javaobjdata = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1276[0m[39m:            [0m[1;35membObjHandler.startJavaObjData[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFParser.jav[0m[1;92ma:39[0m[39m-[0m[1;36m62[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:public class RTFParser implements Parser [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * Serial version UID[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    private static final long serialVersionUID = -4165069489372320313L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private static final Set<MediaType> SUPPORTED_TYPES =[0m                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:            [0m[1;35mCollections.singleton[0m[1;39m([0m[1;35mMediaType.application[0m[1;39m([0m[32m"rtf"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * maximum number of bytes per embedded object/pict [0m[1;39m([0m[39mdefault: 20MB[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    private static int EMB_OBJ_MAX_BYTES = [0m[1;36m20[0m[39m * [0m[1;36m1024[0m[39m * [0m[1;36m1024[0m[39m; [0m[35m/[0m[35m/[0m[95m20MB[0m              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[35m/[0m[35m/[0m[95mget[0m[39m rid of this once we get rid of the other static maxbytes[0m[33m...[0m            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private static volatile boolean USE_STATIC = false;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    @Field[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private int memoryLimitInKb = EMB_OBJ_MAX_BYTES [0m[35m/[0m[39m [0m[1;36m1024[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    @Field[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    private boolean ignoreListMarkup = false;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        return SUPPORTED_TYPES;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:63[0m[39m-[0m[1;36m90[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m63:c[0m[39mlass RTFEmbObjHandler [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private static final String EMPTY_STRING = [0m[32m""[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private final ContentHandler handler;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    private final EmbeddedDocumentUtil embeddedDocumentUtil;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private final UnsynchronizedByteArrayOutputStream os;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    private final int memoryLimitInKb;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private boolean isPictBitmap = false;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[35m/[0m[35m/[0m[95mhigh[0m[39m hex cached for writing hexpair chars [0m[1;39m([0m[39mdata[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private int hi = [0m[1;36m-1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    private int thumbCount = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[35m/[0m[35m/[0m[95mdon[0m[39m't need atomic, do need mutable[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private AtomicInteger unknownFilenameCount = new [0m[1;35mAtomicInteger[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private boolean inObject = false;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private String sv = EMPTY_STRING;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    private String sn = EMPTY_STRING;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private Metadata metadata;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private EMB_STATE state = EMB_STATE.NADA;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    protected [0m[1;35mRTFEmbObjHandler[0m[1;39m([0m[39mContentHandler handler, Metadata metadata, [0m       [2m                [0m
[2;36m                    [0m         [39mParseContext context,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                               int memoryLimitInKb[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        this.handler = handler;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        this.embeddedDocumentUtil = new [0m[1;35mEmbeddedDocumentUtil[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        os = [0m[1;35mUnsynchronizedByteArrayOutputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        this.memoryLimitInKb = memoryLimitInKb;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:102[0m[39m-[0m[1;36m105[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    protected void [0m[1;35mstartJavaObjData[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        state = EMB_STATE.JAVA_OBJDATA;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/rtf/RTFEmbObjHandler.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:213[0m[39m-[0m[1;36m225[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.JAVA_OBJDATA[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                Object obj = new [0m[1;35mObjectInputStream[0m[1;39m([0m                             [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                        [0m                                                        [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[39mbytes[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                                [0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.readObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mRTFMetadata.EMB_CLASS, [0m[1;35mobj.getClass[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE,[0m   [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                        [0m[1;35mMediaType.text[0m[1;39m([0m[32m"plain"[0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                [0m[1;35mextractObj[0m[1;39m([0m[1;35mobj.toString[0m[1;39m([0m[1;39m)[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mhandler, metadata[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mClassNotFoundException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"Not found"[0m[39m, e[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.NADA[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/test/java/org/apache/tika/parser/microsoft/rtf/RTFParserTest.jav[0m[1;92ma:51[0m [2m                [0m
[2;36m                    [0m         [1;92m7[0m[39m-[0m[1;36m558[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:    public void [0m[1;35mtestJavaObj[0m[1;39m([0m[39m@TempDir Path tmpDir[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:        String rtf = [0m                                                           [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.resourceToString[0m[1;39m([0m[32m"/test-documents/rtf/rtfJavaObjTemplate.rtf"[0m[39m,[0m              [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:                StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:        String s = new [0m[1;35mString[0m[1;39m([0m[32m"the quick brown fox"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:        rtf = [0m[1;35mwriteObject[0m[1;39m([0m[39ms, rtf[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        Path p = [0m[1;35mtmpDir.resolve[0m[1;39m([0m[32m"test.rtf"[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:        [0m[1;35mFiles.write[0m[1;39m([0m[39mp, [0m[1;35mrtf.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:        List<Metadata> metadata = [0m[1;35mgetRecursiveMetadata[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m525[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m2[0m[39m, [0m[1;35mmetadata.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m526[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"java.lang.String"[0m[39m, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[39mRTFMetadata.EMB_CLASS[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m527[0m[39m:        [0m[1;35massertContains[0m[1;39m([0m[32m"the quick brown fox"[0m[39m, [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[39mTikaCoreProperties.TIKA_CONTENT[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m529[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:    private String [0m[1;35mwriteObject[0m[1;39m([0m[39mObject s, String rtf[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m serialized = [0m[1;35mserialize[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:        String hex = [0m[1;35mHex.encodeHexString[0m[1;39m([0m[39mserialized[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:        String hexWrapped = [0m[1;35mwrap[0m[1;39m([0m[39mhex, [0m[1;36m80[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:        rtf = [0m[1;35mrtf.replace[0m[1;39m([0m[32m"0123456789abcdef"[0m[39m, hexWrapped[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m535[0m[39m:        return rtf;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m536[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m537[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m538[0m[39m:    private String [0m[1;35mwrap[0m[1;39m([0m[39mString hex, int step[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m539[0m[39m:        StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m540[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mhex.length[0m[1;39m([0m[1;39m)[0m[39m; i += step[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m541[0m[39m:            int end = [0m[1;35mMath.min[0m[1;39m([0m[1;35mhex.length[0m[1;39m([0m[1;39m)[0m[39m, i + step[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m542[0m[39m:            [0m[1;35msb.append[0m[1;39m([0m[1;35mhex.substring[0m[1;39m([0m[1;36m0[0m[39m, end[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m543[0m[39m:            if [0m[1;39m([0m[39mend != [0m[1;35mhex.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m544[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[32m"\n"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m545[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m546[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m547[0m[39m:        return [0m[1;35msb.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m548[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m549[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m550[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mserialize[0m[1;39m([0m[39mObject obj[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m551[0m[39m:        UnsynchronizedByteArrayOutputStream baos =[0m                              [2m                [0m
[2;36m                    [0m         [1;36m552[0m[39m:                [0m[1;35mUnsynchronizedByteArrayOutputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m553[0m[39m:        try [0m[1;39m([0m[39mObjectOutputStream os = new [0m[1;35mObjectOutputStream[0m[1;39m([0m[39mbaos[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m554[0m[39m:            [0m[1;35mos.writeObject[0m[1;39m([0m[39mobj[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:        return [0m[1;35mbaos.toByteArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy for RTF Java Object Deserialization Vulnerability[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Analysis of the Vulnerability[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is a **Remote Code Execution [0m[1;39m([0m[39mRCE[0m[1;39m)[0m[39m** issue caused by **unsafe [0m    [2m                [0m
[2;36m                    [0m         [39mJava object deserialization** in the RTF parser. The root cause is located in [0m      [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mRTFEmbObjHandler.handleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m` at lines [0m[1;36m213[0m[39m-[0m[1;36m224[0m[39m, where [0m                 [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mObjectInputStream.readObject[0m[1;39m([0m[1;39m)[0m[39m` is called directly on untrusted byte arrays [0m       [2m                [0m
[2;36m                    [0m         [39mextracted from RTF files without any validation, filtering, or security controls.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Attack Flow:**[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Attacker crafts RTF file with `\javaobjdata` control word[0m                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. RTF parser encounters this control word and sets `groupState.javaobjdata = true`[0m [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Malicious serialized Java object bytes are collected from the RTF file[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. When the RTF group ends, `[0m[1;35mhandleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m` is called[0m                     [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Vulnerable code path deserializes the object using [0m                              [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mObjectInputStream.readObject[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Malicious code executes during deserialization[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Critical Insight:** This vulnerability is isolated to the `JAVA_OBJDATA` state [0m   [2m                [0m
[2;36m                    [0m         [39monly. The other embedded object types [0m[1;39m([0m[39m`OBJDATA`, `PICT`[0m[1;39m)[0m[39m use safe parsing [0m         [2m                [0m
[2;36m                    [0m         [39mmechanisms and are not affected.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Comprehensive Fix Strategy[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix will disable Java object deserialization by default while providing a [0m      [2m                [0m
[2;36m                    [0m         [39mconfiguration option for backward compatibility. This approach:[0m                     [2m                [0m
[2;36m                    [0m         [39m- Is secure by default [0m[1;39m([0m[39mbreaking change but necessary for security[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [39m- Follows existing Tika configuration patterns using `@Field` annotation[0m            [2m                [0m
[2;36m                    [0m         [39m- Preserves all other RTF parsing functionality[0m                                     [2m                [0m
[2;36m                    [0m         [39m- Provides clear error messages to guide users[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Implementation Steps[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m1[0m[39m: Add Configuration Field to RTFParser[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn `RTFParser.java` [0m[1;39m([0m[39mlines [0m[1;36m54[0m[39m-[0m[1;36m58[0m[39m area[0m[1;39m)[0m[39m, add a new configuration field:[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m@Field[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mprivate boolean disableJavaObjectDeserialization = true;  [0m[35m/[0m[35m/[0m[39m Secure by default[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd corresponding getter and setter methods [0m[1;39m([0m[39mafter line [0m[1;36m113[0m[1;39m)[0m[39m:[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mpublic boolean [0m[1;35misJavaObjectDeserializationDisabled[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [39m    return disableJavaObjectDeserialization;[0m                                        [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m@Field[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpublic void [0m[1;35msetDisableJavaObjectDeserialization[0m[1;39m([0m[39mboolean disable[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [39m    this.disableJavaObjectDeserialization = disable;[0m                                [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m2[0m[39m: Modify RTFEmbObjHandler Constructor[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn `RTFEmbObjHandler.java` [0m[1;39m([0m[39mlines [0m[1;36m63[0m[39m-[0m[1;36m90[0m[1;39m)[0m[39m, update the class to accept and store the [0m [2m                [0m
[2;36m                    [0m         [39msecurity configuration:[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Add a new private final field after line [0m[1;36m69[0m[39m:[0m                                     [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate final boolean disableJavaObjectDeserialization;[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Update the constructor signature [0m[1;39m([0m[39mline [0m[1;36m84[0m[1;39m)[0m[39m to accept the configuration:[0m          [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprotected [0m[1;35mRTFEmbObjHandler[0m[1;39m([0m[39mContentHandler handler, Metadata metadata, ParseContext [0m [2m                [0m
[2;36m                    [0m         [39mcontext,[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m                           int memoryLimitInKb, boolean [0m                            [2m                [0m
[2;36m                    [0m         [39mdisableJavaObjectDeserialization[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Initialize the new field in the constructor [0m[1;39m([0m[39mafter line [0m[1;36m89[0m[1;39m)[0m[39m:[0m                     [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mthis.disableJavaObjectDeserialization = disableJavaObjectDeserialization;[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m3[0m[39m: Pass Configuration from RTFParser to RTFEmbObjHandler[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn `[0m[1;35mRTFParser.parseInline[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mline [0m[1;36m92[0m[39m-[0m[1;36m93[0m[1;39m)[0m[39m, update the RTFEmbObjHandler [0m      [2m                [0m
[2;36m                    [0m         [39minstantiation:[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mRTFEmbObjHandler embObjHandler = new [0m[1;35mRTFEmbObjHandler[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [39m    handler, metadata, context, [0m[1;35mgetMemoryLimitInKb[0m[1;39m([0m[1;39m)[0m[39m, [0m                              [2m                [0m
[2;36m                    [0m         [39m    disableJavaObjectDeserialization[0m                                                [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m4[0m[39m: Block Unsafe Deserialization in [0m[1;35mhandleCompletedObject[0m[1;39m([0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mIn `[0m[1;35mRTFEmbObjHandler.handleCompletedObject[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m213[0m[39m-[0m[1;36m224[0m[1;39m)[0m[39m, add a security check[0m [2m                [0m
[2;36m                    [0m         [39mbefore deserialization:[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else if [0m[1;39m([0m[39mstate == EMB_STATE.JAVA_OBJDATA[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mdisableJavaObjectDeserialization[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mTikaException[0m[1;39m([0m                                                    [2m                [0m
[2;36m                    [0m         [39m            [0m[32m"Java object deserialization from RTF files is disabled for security [0m   [2m                [0m
[2;36m                    [0m         [32mreasons. "[0m[39m +[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m            [0m[32m"To enable, set [0m[32mdisableJavaObjectDeserialization[0m[32m=[0m[32mfalse[0m[32m in RTFParser [0m    [2m                [0m
[2;36m                    [0m         [32mconfiguration."[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    try [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        Object obj = new [0m[1;35mObjectInputStream[0m[1;39m([0m                                         [2m                [0m
[2;36m                    [0m         [39m                [0m[1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[39mbytes[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39m                        [0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.readObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mmetadata.set[0m[1;39m([0m[39mRTFMetadata.EMB_CLASS, [0m[1;35mobj.getClass[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE,[0m               [2m                [0m
[2;36m                    [0m         [39m                [0m[1;35mMediaType.text[0m[1;39m([0m[32m"plain"[0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mextractObj[0m[1;39m([0m[1;35mobj.toString[0m[1;39m([0m[1;39m)[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[39m, handler, [0m       [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mClassNotFoundException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"Not found"[0m[39m, e[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m5[0m[39m: Update Test Case[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe existing test `[0m[1;35mtestJavaObj[0m[1;39m([0m[1;39m)[0m[39m` in `RTFParserTest.java` [0m[1;39m([0m[39mlines [0m[1;36m517[0m[39m-[0m[1;36m528[0m[1;39m)[0m[39m needs to [0m [2m                [0m
[2;36m                    [0m         [39mbe updated to explicitly enable Java object deserialization:[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Create an RTFParser instance with the configuration enabled[0m                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Pass it to the parsing method[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Alternatively, add a new test that verifies deserialization is blocked by [0m       [2m                [0m
[2;36m                    [0m         [39mdefault[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Justification[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why This is the Optimal Approach:**[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Secure by Default**: Disabling Java object deserialization by default prevents[0m [2m                [0m
[2;36m                    [0m         [39mexploitation of this vulnerability without requiring users to take action.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Follows Established Patterns**: Uses the same `@Field` annotation pattern that[0m [2m                [0m
[2;36m                    [0m         [39malready exists in RTFParser for `memoryLimitInKb` and `ignoreListMarkup` [0m           [2m                [0m
[2;36m                    [0m         [39mconfigurations.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Backward Compatibility**: Users who genuinely need Java object deserialization[0m [2m                [0m
[2;36m                    [0m         [39mcan explicitly enable it via configuration, maintaining functionality for legacy [0m   [2m                [0m
[2;36m                    [0m         [39muse cases.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Minimal Code Changes**: The fix is surgical and only affects the vulnerable [0m   [2m                [0m
[2;36m                    [0m         [39mcode path without touching the broader RTF parsing infrastructure.[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Clear Error Messages**: When blocked, users receive a clear error message [0m     [2m                [0m
[2;36m                    [0m         [39mexplaining why and how to enable the feature if needed.[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Preserves All Other Functionality**: [0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Text extraction from RTF files[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - Picture/image extraction [0m[1;39m([0m[39mPICT state[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Regular embedded object extraction [0m[1;39m([0m[39mOBJDATA state[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Metadata extraction[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - All other configuration options[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Addresses the Vulnerability:**[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- The security check occurs BEFORE the `[0m[1;35mObjectInputStream.readObject[0m[1;39m([0m[1;39m)[0m[39m` call, [0m      [2m                [0m
[2;36m                    [0m         [39mpreventing malicious objects from being instantiated[0m                                [2m                [0m
[2;36m                    [0m         [39m- The check is fail-fast, throwing a TikaException immediately rather than silently[0m [2m                [0m
[2;36m                    [0m         [39mrecording it[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- Default behavior blocks all Java deserialization from untrusted RTF files[0m         [2m                [0m
[2;36m                    [0m         [39m- The vulnerability is completely mitigated when the flag is set to true [0m[1;39m([0m[39mdefault[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects and Mitigation:**[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Breaking Change**: Existing code that relies on Java object deserialization [0m   [2m                [0m
[2;36m                    [0m         [39mfrom RTF will break[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: Clear documentation, error messages guide users to enable the [0m [2m                [0m
[2;36m                    [0m         [39mfeature if needed[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - **Justification**: Security takes precedence; this feature is rarely used and [0m [2m                [0m
[2;36m                    [0m         [39minherently dangerous with untrusted input[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Test Failures**: The existing `[0m[1;35mtestJavaObj[0m[1;39m([0m[1;39m)[0m[39m` test will fail[0m                   [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: Update test to explicitly enable deserialization or add [0m       [2m                [0m
[2;36m                    [0m         [39mconfiguration parameter[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - **Justification**: Test is validating a dangerous feature that should not be [0m  [2m                [0m
[2;36m                    [0m         [39menabled by default[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Configuration Complexity**: Users need to know about the new configuration [0m    [2m                [0m
[2;36m                    [0m         [39moption[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: Document in release notes, security advisories, and [0m           [2m                [0m
[2;36m                    [0m         [39mconfiguration guides[0m                                                                [2m                [0m
[2;36m                    [0m         [39m   - **Justification**: Explicit configuration for dangerous features is a security[0m [2m                [0m
[2;36m                    [0m         [39mbest practice[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Similar Solutions in Codebase[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix follows the same pattern as existing security configurations in Tika:[0m       [2m                [0m
[2;36m                    [0m         [39m- `memoryLimitInKb` field with `@Field` annotation controls resource limits[0m         [2m                [0m
[2;36m                    [0m         [39m- `ignoreListMarkup` field with `@Field` annotation controls parsing behavior[0m       [2m                [0m
[2;36m                    [0m         [39m- Both use the same getter/setter pattern and are passed through constructors[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis consistency ensures the fix integrates seamlessly with Tika's architecture and[0m [2m                [0m
[2;36m                    [0m         [39mconfiguration system.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m6[0m[39m. Alternative Approach Considered[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Complete Removal**: Simply delete the entire JAVA_OBJDATA code path [0m[1;39m([0m[39mlines [0m       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m-[0m[1;36m105[0m[39m, [0m[1;36m213[0m[39m-[0m[1;36m224[0m[39m, [0m[1;36m1273[0m[39m-[0m[1;36m1276[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- **Pros**: Most secure, simplest fix, removes attack surface entirely[0m              [2m                [0m
[2;36m                    [0m         [39m- **Cons**: Completely breaks backward compatibility, no migration path for users [0m  [2m                [0m
[2;36m                    [0m         [39mwho need this feature[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- **Decision**: Not recommended due to lack of migration path[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe configurable approach is superior because it provides a migration path while [0m   [2m                [0m
[2;36m                    [0m         [39mbeing secure by default.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=648014;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=724040;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=29312;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=583719;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpb928f16d[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-full-01_vuln_1/[0m[95magent-[0m [2m               [0m
[2;36m                    [0m         [95moutput-1768055077.696985[0m                                                             [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/tika_tk-full-01_vuln_1.toml  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/10/26 14:24:39][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mtika[0m           ]8;id=684078;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=851778;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m[01/10/26 14:24:40][0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=594360;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=862470;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=960065;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=520614;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mtika[0m                   [2m               [0m
