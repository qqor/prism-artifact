{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-delta-04_vuln_007",
  "source_directory": "/home/qqor/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 1.0992540000000002,
    "prompt_tokens": 293878,
    "completion_tokens": 14508
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-json.c\n+++ b/epan/dissectors/packet-json.c\n@@ -358,10 +358,23 @@\n \t\n \t\t\t\t\t\t\tfor (int i = 0; i < 8; i++)\n \t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t// Do not overflow input string\n+\t\t\t\t\t\t\t\tif (!(read_index < string_length))\n+\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t\tis_valid_unicode_character = false;\n+\t\t\t\t\t\t\t\t\tbreak;\n+\t\t\t\t\t\t\t\t}\n+\n \t\t\t\t\t\t\t\tcurrent_character = string[read_index];\n \t\t\t\t\t\t\t\tread_index++;\n \t\n \t\t\t\t\t\t\t\tint nibble = ws_xton(current_character);\n+\n+\t\t\t\t\t\t\t\tif (nibble < 0)\n+\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t\tis_valid_unicode_character = false;\n+\t\t\t\t\t\t\t\t\tbreak;\n+\t\t\t\t\t\t\t\t}\n \t\n \t\t\t\t\t\t\t\ttrail_surrogate <<= 4;\n \t\t\t\t\t\t\t\ttrail_surrogate |= nibble;\n@@ -1308,8 +1321,12 @@\n \t\t\t\t\t\ttvbparse_set_oneof(-1, NULL, NULL, NULL,\n \t\t\t\t\t\t\ttvbparse_chars(-1, 0, 1, \"\\\"\" \"\\\\\" \"/bfnrt\", NULL, NULL, NULL),\n \t\t\t\t\t\t\ttvbparse_set_seq(-1, NULL, NULL, NULL,\n-\t\t\t\t\t\t\t\ttvbparse_chars(-1, 1, 1, \"uU\", NULL, NULL, NULL),\n+\t\t\t\t\t\t\t\ttvbparse_char(-1, \"u\", NULL, NULL, NULL),\n \t\t\t\t\t\t\t\ttvbparse_chars(-1, 4, 4, \"0123456789abcdefABCDEF\", NULL, NULL, NULL),\n+\t\t\t\t\t\t\t\tNULL),\n+\t\t\t\t\t\t\ttvbparse_set_seq(-1, NULL, NULL, NULL,\n+\t\t\t\t\t\t\t\ttvbparse_char(-1, \"U\", NULL, NULL, NULL),\n+\t\t\t\t\t\t\t\ttvbparse_chars(-1, 8, 8, \"0123456789abcdefABCDEF\", NULL, NULL, NULL),\n \t\t\t\t\t\t\t\tNULL),\n \t\t\t\t\t\t\tNULL),\n \t\t\t\t\t\tNULL),\n",
  "stdout": "",
  "stderr": ""
}