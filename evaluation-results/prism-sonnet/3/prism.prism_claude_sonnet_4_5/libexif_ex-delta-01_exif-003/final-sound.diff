--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -235,15 +235,13 @@
 
 int
 exif_mnote_data_apple_identify(const ExifData *ed, const ExifEntry *e) {
-    int variant;
-
-    if (!strcmp((const char *) e->data, "Apple iOS")) {
-        variant = 1;
-    } else {
-        variant = 0;
-    }
-
-    return variant;
+    (void) ed;  /* unused */
+
+    /* "Apple iOS" is 9 characters, need at least 9 bytes to safely compare */
+    if (e && e->data && e->size >= 9 && !memcmp(e->data, "Apple iOS", 9)) {
+        return 1;
+    }
+    return 0;
 }
 
 ExifMnoteData *
