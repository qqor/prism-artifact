[2;36m[01/10/26 09:20:39][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=904367;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=79846;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmphifbr323[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_6/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768036839.6041973[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-full-01_vuln_6.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=643914;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=442737;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:21:53][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Took      ]8;id=705600;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=687451;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m73.71[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=32614;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=181100;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=711150;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=7729;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=70157;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=693096;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m73[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=33829;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=144425;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:21:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.89[0m seconds;                ]8;id=416137;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=396338;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 09:21:55][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=785472;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=417248;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=585459;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=863886;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=475550;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=400505;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=894419;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=340690;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:21:56][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m1.16[0m seconds;                ]8;id=973037;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=495476;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 09:21:57][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=98937;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=715075;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.87[0m seconds;                ]8;id=723876;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=1104;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 09:22:04][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=717756;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=477214;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of  [2m                [0m
[2;36m                    [0m         memory [1m([0muse [32m'-Xmx1710m'[0m to reproduce[1m)[0m                                               [2m                [0m
[2;36m                    [0m         Caused by: java.lang.OutOfMemoryError: Java heap space                              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.fontbox.pfb.PfbParser.parsePfb[0m[1m([0mPfbParser.jav[1;92ma:166[0m[1m)[0m            [2m                [0m
[2;36m                    [0m                 at org.apache.fontbox.pfb.PfbParser.[1m<[0m[1;95minit[0m[39m>[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:116[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:69[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cbc000.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbd400.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbcc00.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 4fc18e0e0662428e[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Java heap space[0m                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.pfb.PfbParser.parsePfb[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:166[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.fontbox.pfb.PfbParser.<init>[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:116[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:69[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init[0m[1m>[0m[1m([0mPDType1Font.jav[1;92ma:227[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1m([0mPDFontFactory.jav[1;92ma:140[0m[1m)[0m     [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1m([0mPDResources.jav[1;92ma:170[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1m([0mSetFontAndSize [2m                [0m
[2;36m                    [0m         .jav[1;92ma:72[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1m([0mPDFStreamEngine.jav [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1m)[0m                                                                              [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1m([0mPDFStreamEng [2m                [0m
[2;36m                    [0m         ine.jav[1;92ma:557[0m[1m)[0m                                                                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1m([0mPDFStreamEngine.jav[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1m)[0m                                                                                [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1m([0mPDFStreamEngine.jav[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1m)[0m                                                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1m([0mLegacyPDFStreamEngine.jav[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1m)[0m                                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1m([0mPDFTextStripper.jav[1;92ma:378[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1m([0mPDFTextStripper.jav[1;92ma:303[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1m([0mPDFTextStripper.jav[1;92ma:251[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1m([0mPDFTextStripper.jav[1;92ma:218[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1m([0mPDFExtractTextFuzzer.jav[1;92ma:41[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$DMH/[1;35m0x0000000800cbc000.invokeStaticInit[0m[1m([0mLambd [2m                [0m
[2;36m                    [0m         aForm$DMH[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800cbd400.invoke[0m[1m([0mLambdaForm$MH[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         java.base/java.lang.invoke.LambdaForm$MH/[1;35m0x0000000800cbcc00.invoke_MT[0m[1m([0mLambdaForm$MH [2m                [0m
[2;36m                    [0m         [1m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 4fc18e0e0662428e                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 09:22:25][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=417743;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=116623;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 09:25:42][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=455377;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=483855;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 09:26:17][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=147245;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=50244;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=276099;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=992859;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:26:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.95[0m seconds;                ]8;id=733310;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=15965;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 09:26:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Started[33m...[0m                              ]8;id=203324;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=879409;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp_pe0ncvt[0m                                                 ]8;id=712195;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=944531;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 09:27:13][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Took [1;36m54.15[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=638695;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=635974;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Started[33m...[0m                        ]8;id=255793;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=480687;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:27:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Took [1;36m14.44[0m seconds;              ]8;id=409857;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=490720;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Started[33m...[0m                           ]8;id=284498;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=259272;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:27:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Took [1;36m6.09[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=599526;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=925168;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Started[33m...[0m                               ]8;id=885146;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=586955;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=315081;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=360537;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=952149;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=147428;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:27:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.93[0m seconds;                ]8;id=630796;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=622493;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 09:27:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=962874;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=59396;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:27:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.93[0m seconds;                ]8;id=946638;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=898902;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=342656;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=367464;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 09:27:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.86[0m seconds;                ]8;id=63404;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=3125;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 09:27:38][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=231164;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=950569;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java                   [2m                [0m
[2;36m                    [0m         +++ b/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java                   [2m                [0m
[2;36m                    [0m         @@ [1;36m-153[0m,[1;36m17[0m +[1;36m153[0m,[1;36m28[0m @@                                                               [2m                [0m
[2;36m                    [0m                          throw new [1;35mIOException[0m[1m([0m[32m"Incorrect record type: "[0m + recordType[1m)[0m;     [2m                [0m
[2;36m                    [0m                      [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -            int size = [1;35min.read[0m[1m([0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m         -            size += [1;35min.read[0m[1m([0m[1m)[0m [1m<[0m[39m< [0m[1;36m8[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m-            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m-            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m+            long byte1 = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m+            long byte2 = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m+            long byte3 = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m+            long byte4 = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39mbyte4 < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB segment size"[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+            long size = byte1 + [0m[1;39m([0m[39mbyte2 << [0m[1;36m8[0m[1;39m)[0m[39m + [0m[1;39m([0m[39mbyte3 << [0m[1;36m16[0m[1;39m)[0m[39m + [0m[1;39m([0m[39mbyte4 << [0m[1;36m24[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m-            long newTotal = total + size;[0m                                          [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39msize < [0m[1;36m0[0m[39m || size > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid PFB segment size: "[0m[39m + size[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+            long newTotal = [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mtotal + size;[0m                                    [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m-                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m        [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Cumulative PFB size too large: "[0m[39m + [0m         [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[1;39m([0m[39mint[0m[1;39m)[0m[39msize[0m[1;39m][0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m             int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Java heap space[0m                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.pfb.PfbParser.parsePfb[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:166[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.fontbox.pfb.PfbParser.<init>[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:116[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:69[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cbc000.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbd400.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbcc00.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 4fc18e0e0662428e[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAn Out of Memory [0m[1;39m([0m[39mOOM[0m[1;39m)[0m[39m error occurs in Apache PDFBox when processing PDF documents [0m [2m                [0m
[2;36m                    [0m         [39mduring fuzz testing. The error is triggered in the PFB [0m[1;39m([0m[39mPrinter Font Binary[0m[1;39m)[0m[39m [0m       [2m                [0m
[2;36m                    [0m         [39mparsing component while attempting to extract text from a PDF file. The fuzzer has [0m [2m                [0m
[2;36m                    [0m         [39midentified this as a security issue of low severity, with the Java heap space being[0m [2m                [0m
[2;36m                    [0m         [39mexhausted during the parsing of Type1 fonts embedded in PDF documents.[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Overview[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mThe issue manifests as a `java.lang.OutOfMemoryError: Java heap space` exception [0m   [2m                [0m
[2;36m                    [0m         [39mthat occurs during PDF text extraction operations. The fuzzer has categorized this [0m [2m                [0m
[2;36m                    [0m         [39mas `FuzzerSecurityIssueLow`, indicating a potential denial-of-service vulnerability[0m [2m                [0m
[2;36m                    [0m         [39mwhere maliciously crafted PDF files could cause excessive memory consumption [0m       [2m                [0m
[2;36m                    [0m         [39mleading to application crashes.[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is a resource exhaustion vulnerability, specifically an uncontrolled memory [0m   [2m                [0m
[2;36m                    [0m         [39mallocation issue. Such vulnerabilities can be exploited to cause denial-of-service [0m [2m                [0m
[2;36m                    [0m         [39mconditions by providing specially crafted input that triggers excessive memory [0m     [2m                [0m
[2;36m                    [0m         [39mallocation.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Stack Trace Analysis[0m                                                            [2m                [0m
[2;36m                    [0m         [39mThe error originates from the following call chain:[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Point**: `[0m[1;35mPDFTextStripper.getText[0m[1;39m([0m[1;39m)[0m[39m` is called to extract text from a [0m   [2m                [0m
[2;36m                    [0m         [39mPDF document[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Font Processing**: The process involves loading and parsing fonts from PDF [0m    [2m                [0m
[2;36m                    [0m         [39mresources [0m[1;39m([0m[39m`[0m[1;35mPDResources.getFont[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Type1 Font Creation**: A Type1 font with PFB format is being instantiated [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`PDType1Font.<init>[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **PFB Parsing**: The failure occurs in `[0m[1;35mPfbParser.parsePfb[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m166[0m[39m, where[0m [2m                [0m
[2;36m                    [0m         [39mmemory allocation exceeds available heap space[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Font Parsing Context**: The OOM occurs specifically during the parsing of PFB [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mPrinter Font Binary[0m[1;39m)[0m[39m format files, which are used for Type1 fonts in PDF documents[0m [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Memory Allocation Point**: The exact failure point is at [0m                      [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mPfbParser.parsePfb[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:166[0m[1;39m)[0m[39m`, suggesting that this method attempts to [0m  [2m                [0m
[2;36m                    [0m         [39mallocate a large amount of memory based on input data[0m                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Reproducibility**: The fuzzer indicates the issue can be reproduced with a [0m    [2m                [0m
[2;36m                    [0m         [39mheap size of 1710MB [0m[1;39m([0m[39m`-Xmx1710m`[0m[1;39m)[0m[39m, suggesting the malformed input attempts to [0m      [2m                [0m
[2;36m                    [0m         [39mallocate close to or exceeding this amount[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Processing Pipeline**: The issue occurs during content stream processing while[0m [2m                [0m
[2;36m                    [0m         [39msetting font and size operations in the PDF rendering pipeline[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a comprehensive understanding of this issue, the following components [0m      [2m                [0m
[2;36m                    [0m         [39mshould be examined:[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **PfbParser.java [0m[1;39m([0m[39mline [0m[1;36m166[0m[1;39m)[0m[39m**: Examine the memory allocation logic in the [0m       [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mparsePfb[0m[1;39m([0m[1;39m)[0m[39m` method to understand how buffer sizes are determined from input data [0m  [2m                [0m
[2;36m                    [0m         [39mand whether there are adequate bounds checks[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **PfbParser constructor [0m[1;39m([0m[39mline [0m[1;36m116[0m[1;39m)[0m[39m**: Review the initialization logic that [0m      [2m                [0m
[2;36m                    [0m         [39mprecedes the parsing operation[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **[0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39mline [0m[1;36m69[0m[1;39m)[0m[39m**: Investigate how PFB data is passed to [0m  [2m                [0m
[2;36m                    [0m         [39mthe parser and whether any validation occurs before parsing[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **PDType1Font constructor [0m[1;39m([0m[39mline [0m[1;36m227[0m[1;39m)[0m[39m**: Understand the font instantiation [0m       [2m                [0m
[2;36m                    [0m         [39mprocess and whether any size limits or validation are applied to font resources[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **[0m[1;35mPDFontFactory.createFont[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39mline [0m[1;36m140[0m[1;39m)[0m[39m**: Review the font factory's role in [0m    [2m                [0m
[2;36m                    [0m         [39mfont creation and whether it implements any resource limits or validation[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **PDF Resource Loading**: Examine how font resources are extracted from PDF [0m     [2m                [0m
[2;36m                    [0m         [39mdocuments [0m[1;39m([0m[39m`[0m[1;35mPDResources.getFont[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m and whether size validation occurs at this [0m     [2m                [0m
[2;36m                    [0m         [39mlevel[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **Input Validation**: Investigate whether there are any mechanisms throughout [0m   [2m                [0m
[2;36m                    [0m         [39mthe call chain to validate font data sizes before attempting to load them into [0m     [2m                [0m
[2;36m                    [0m         [39mmemory[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe investigation should focus on identifying where user-controlled data from the [0m  [2m                [0m
[2;36m                    [0m         [39mPDF file influences memory allocation decisions and whether appropriate bounds [0m     [2m                [0m
[2;36m                    [0m         [39mchecking and resource limits are enforced.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of [0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;39m([0m[39muse [0m[32m'-Xmx1710m'[0m[39m to reproduce[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39mCaused by: java.lang.OutOfMemoryError: Java heap space[0m                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.pfb.PfbParser.parsePfb[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:166[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.fontbox.pfb.PfbParser.<init>[0m[1;39m([0m[39mPfbParser.jav[0m[1;92ma:116[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.fontbox.type1.Type1Font.createWithPFB[0m[1;39m([0m[39mType1Font.jav[0m[1;92ma:69[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.pdfbox.pdmodel.font.PDType1Font.<init>[0m[1;39m([0m[39mPDType1Font.jav[0m[1;92ma:227[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.pdmodel.font.PDFontFactory.createFont[0m[1;39m([0m[39mPDFontFactory.jav[0m[1;92ma:140[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.pdmodel.PDResources.getFont[0m[1;39m([0m[39mPDResources.jav[0m[1;92ma:170[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process[0m[1;39m([0m[39mSetFontAndSize[0m [2m                [0m
[2;36m                    [0m         [39m.jav[0m[1;92ma:72[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processOperator[0m[1;39m([0m[39mPDFStreamEngine.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:924[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators[0m[1;39m([0m[39mPDFStreamEng[0m [2m                [0m
[2;36m                    [0m         [39mine.jav[0m[1;92ma:557[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processStream[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m515[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.contentstream.PDFStreamEngine.processPage[0m[1;39m([0m[39mPDFStreamEngine.jav[0m[1;92ma:15[0m [2m                [0m
[2;36m                    [0m         [1;92m8[0m[1;39m)[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.LegacyPDFStreamEngine.processPage[0m[1;39m([0m[39mLegacyPDFStreamEngine.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:153[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPage[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:378[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.processPages[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:303[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.pdfbox.text.PDFTextStripper.writeText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:251[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.pdfbox.text.PDFTextStripper.getText[0m[1;39m([0m[39mPDFTextStripper.jav[0m[1;92ma:218[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.PDFExtractTextFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPDFExtractTextFuzzer.jav[0m[1;92ma:41[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$DMH/[0m[1;35m0x0000000800cbc000.invokeStaticInit[0m[1;39m([0m[39mLambd[0m [2m                [0m
[2;36m                    [0m         [39maForm$DMH[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbd400.invoke[0m[1;39m([0m[39mLambdaForm$MH[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mjava.base/java.lang.invoke.LambdaForm$MH/[0m[1;35m0x0000000800cbcc00.invoke_MT[0m[1;39m([0m[39mLambdaForm$MH[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 4fc18e0e0662428e[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:19[0m[39m-[0m[1;36m29[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:37[0m[39m-[0m[1;36m82[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public class PfbParser [0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mPfbParser.class[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * the pfb header length.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * [0m[1;39m([0m[39mstart-marker [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, ascii-[0m[35m/[0m[95mbinary-marker[0m[39m [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, size [0m[1;39m([0m[1;36m4[0m[39m byte[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * [0m[1;36m3[0m[39m*[0m[1;36m6[0m[39m == [0m[1;36m18[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private static final int PFB_[0m[1;33mHEAD[0m[39mER_LENGTH = [0m[1;36m18[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * the start marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    private static final int START_MARKER = [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * the ascii marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private static final int ASCII_MARKER = [0m[1;36m0x01[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * the binary marker.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final int BINARY_MARKER = [0m[1;36m0x02[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * the EOF marker.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private static final int EOF_MARKER = [0m[1;36m0x03[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Heuristically chosen max length to buffer a Type1 font[0m                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final long MAX_LENGTH = 100_000_000;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * the parsed pfb-data.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m pfbdata;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * the lengths of the records [0m[1;39m([0m[39mASCII, BINARY, ASCII[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private final int[0m[1;39m[[0m[1;39m][0m[39m lengths = new int[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:124[0m[39m-[0m[1;36m177[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    private void [0m[1;35mparsePfb[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m pfb[0m[1;39m)[0m[39m throws IOException [0m                 [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[39mpfb.length < PFB_[0m[1;33mHEAD[0m[39mER_LENGTH[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"PFB header missing"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[35m/[0m[35m/[0m[39m read into segments and keep them[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        List<Integer> typeList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        List<byte[0m[1;39m[[0m[1;39m][0m[39m> barrList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        ByteArrayInputStream in = new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        int total = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        do[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            int r = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            if [0m[1;39m([0m[39mr == [0m[1;36m-1[0m[39m && total > [0m[1;36m0[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                break; [0m[35m/[0m[35m/[0m[39m EOF[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            if [0m[1;39m([0m[39mr != START_MARKER[0m[1;39m)[0m[39m [0m                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Start marker missing"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            int recordType = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            if [0m[1;39m([0m[39mrecordType == EOF_MARKER[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            if [0m[1;39m([0m[39mrecordType != ASCII_MARKER && recordType != BINARY_MARKER[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Incorrect record type: "[0m[39m + recordType[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            total += size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;35mtypeList.add[0m[1;39m([0m[39mrecordType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;35mbarrList.add[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.jav[0m[1;92ma:19[0m[39m-[0m[1;36m51[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.awt.geom.AffineTransform;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.awt.geom.GeneralPath;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.awt.geom.Point2D;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.fontbox.EncodedFont;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.fontbox.FontBoxFont;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.fontbox.type1.DamagedFontException;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.fontbox.type1.Type1Font;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.fontbox.util.BoundingBox;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.pdfbox.cos.COSDictionary;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.pdfbox.cos.COSName;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.pdfbox.cos.COSStream;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.pdfbox.pdmodel.PDDocument;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.pdfbox.pdmodel.common.PDRectangle;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.pdfbox.pdmodel.common.PDStream;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.pdfbox.pdmodel.font.Standard14Fonts.FontName;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.pdfbox.pdmodel.font.encoding.Encoding;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.pdfbox.pdmodel.font.encoding.StandardEncoding;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.pdfbox.pdmodel.font.encoding.Type1Encoding;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.pdfbox.pdmodel.font.encoding.WinAnsiEncoding;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.pdfbox.pdmodel.font.encoding.ZapfDingbatsEncoding;[0m             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.pdfbox.util.Matrix;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import static org.apache.pdfbox.pdmodel.font.UniUtil.getUniNameOfCodePoint;[0m      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.pdfbox.pdmodel.font.encoding.SymbolEncoding;[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.jav[0m[1;92ma:189[0m[39m-[0m[1;36m282[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:    public [0m[1;35mPDType1Font[0m[1;39m([0m[39mCOSDictionary fontDictionary[0m[1;39m)[0m[39m throws IOException[0m         [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mfontDictionary[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:        PDFontDescriptor fd = [0m[1;35mgetFontDescriptor[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        Type1Font t1 = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        boolean fontIsDamaged = false;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        if [0m[1;39m([0m[39mfd != null[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            [0m[35m/[0m[35m/[0m[39m a Type1 font may contain a Type1C font[0m                           [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            PDStream fontFile3 = [0m[1;35mfd.getFontFile3[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            if [0m[1;39m([0m[39mfontFile3 != null[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"/FontFile3 for Type1 font not supported"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[35m/[0m[35m/[0m[39m or it may contain a PFB[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            PDStream fontFile = [0m[1;35mfd.getFontFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            if [0m[1;39m([0m[39mfontFile != null[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                try[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:                    COSStream stream = [0m[1;35mfontFile.getCOSObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:                    int length1 = [0m[1;35mstream.getInt[0m[1;39m([0m[39mCOSName.LENGTH1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:                    int length2 = [0m[1;35mstream.getInt[0m[1;39m([0m[39mCOSName.LENGTH2[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                    [0m[35m/[0m[35m/[0m[39m repair Length1 and Length2 if necessary[0m                  [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                    byte[0m[1;39m[[0m[1;39m][0m[39m bytes = [0m[1;35mfontFile.toByteArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                    if [0m[1;39m([0m[39mbytes.length == [0m[1;36m0[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Font data unavailable"[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                    length1 = [0m[1;35mrepairLength1[0m[1;39m([0m[39mbytes, length1[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                    length2 = [0m[1;35mrepairLength2[0m[1;39m([0m[39mbytes, length1, length2[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                    if [0m[1;39m([0m[1;39m([0m[39mbytes[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m & [0m[1;36m0xff[0m[1;39m)[0m[39m == PFB_START_MARKER[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                        [0m[35m/[0m[35m/[0m[39m some bad files embed the entire PFB, see PDFBOX-[0m[1;36m2607[0m [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        t1 = [0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                        [0m[35m/[0m[35m/[0m[39m the PFB embedded as two segments back-to-back[0m        [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                        if [0m[1;39m([0m[39mlength1 < [0m[1;36m0[0m[39m || length1 > length1 + length2[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid length data, actual [0m [2m                [0m
[2;36m                    [0m         [32mlength: "[0m[39m +[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                                    bytes.length + [0m[32m", /Length1: "[0m[39m + length1 + [0m  [2m                [0m
[2;36m                    [0m         [32m", /Length2: "[0m[39m + length2[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                        byte[0m[1;39m[[0m[1;39m][0m[39m segment1 = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39mbytes, [0m[1;36m0[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [39mlength1[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        byte[0m[1;39m[[0m[1;39m][0m[39m segment2 = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39mbytes, length1, [0m   [2m                [0m
[2;36m                    [0m         [39mlength1 + length2[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                        [0m[35m/[0m[35m/[0m[39m empty streams are simply ignored[0m                     [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                        if [0m[1;39m([0m[39mlength1 > [0m[1;36m0[0m[39m && length2 > [0m[1;36m0[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                            t1 = [0m[1;35mType1Font.createWithSegments[0m[1;39m([0m[39msegment1, [0m        [2m                [0m
[2;36m                    [0m         [39msegment2[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:                catch [0m[1;39m([0m[39mDamagedFontException e[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:                    [0m[1;35mLOG.warn[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[32m"Can't read damaged embedded Type1 font "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [1;35mfd.getFontName[0m[1;39m([0m[1;39m)[0m[39m, e[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:                    fontIsDamaged = true;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:                catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:                    [0m[1;35mLOG.error[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[32m"Can't read the embedded Type1 font "[0m[39m + [0m    [2m                [0m
[2;36m                    [0m         [1;35mfd.getFontName[0m[1;39m([0m[1;39m)[0m[39m, e[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:                    fontIsDamaged = true;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:        isEmbedded = t1 != null;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:        isDamaged = fontIsDamaged;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:        type1font = t1;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:        [0m[35m/[0m[35m/[0m[39m find a generic font to use for rendering, could be a .pfb, but might[0m [2m                [0m
[2;36m                    [0m         [39mbe a .ttf[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        if [0m[1;39m([0m[39mtype1font != null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:            genericFont = type1font;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:            FontMapping<FontBoxFont> mapping = [0m[1;35mFontMappers.instance[0m[1;39m([0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:                                                          [0m                      [2m                [0m
[2;36m                    [0m         [1;35m.getFontBoxFont[0m[1;39m([0m[1;35mgetBaseFont[0m[1;39m([0m[1;39m)[0m[39m, fd[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:            genericFont = [0m[1;35mmapping.getFont[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            if [0m[1;39m([0m[1;35mmapping.isFallback[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Using fallback font [0m[32m{[0m[32m}[0m[32m for [0m[32m{[0m[32m}[0m[32m"[0m[39m, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mgenericFont.getName[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mgetBaseFont[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:        [0m[1;35mreadEncoding[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:        fontMatrixTransform = [0m[1;35mgetFontMatrix[0m[1;39m([0m[1;39m)[0m[1;35m.createAffineTransform[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:        [0m[1;35mfontMatrixTransform.scale[0m[1;39m([0m[1;36m1000[0m[39m, [0m[1;36m1000[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Font.jav[0m[1;92ma:20[0m[39m-[0m[1;36m35[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.awt.geom.GeneralPath;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.LinkedHashMap;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.concurrent.ConcurrentHashMap;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.fontbox.FontBoxFont;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.fontbox.EncodedFont;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.fontbox.cff.Type1CharString;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.fontbox.cff.Type1CharStringParser;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.fontbox.encoding.Encoding;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.fontbox.pfb.PfbParser;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.fontbox.util.BoundingBox;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Font.jav[0m[1;92ma:52[0m[39m-[0m[1;36m72[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public static Type1Font [0m[1;35mcreateWithPFB[0m[1;39m([0m[39mInputStream pfbStream[0m[1;39m)[0m[39m throws [0m         [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        PfbParser pfb = new [0m[1;35mPfbParser[0m[1;39m([0m[39mpfbStream[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        Type1Parser parser = new [0m[1;35mType1Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mparser.parse[0m[1;39m([0m[1;35mpfb.getSegment1[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mpfb.getSegment2[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Constructs a new Type1Font object from a .pfb stream.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * @param pfbBytes .pfb data, including headers[0m                              [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * @return a type1 font[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * @throws IOException if something went wrong[0m                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    public static Type1Font [0m[1;35mcreateWithPFB[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m pfbBytes[0m[1;39m)[0m[39m throws IOException[0m    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        PfbParser pfb = new [0m[1;35mPfbParser[0m[1;39m([0m[39mpfbBytes[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        Type1Parser parser = new [0m[1;35mType1Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        return [0m[1;35mparser.parse[0m[1;39m([0m[1;35mpfb.getSegment1[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mpfb.getSegment2[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/cff/CFFParser.jav[0m[1;92ma:281[0m[39m-[0m[1;36m340[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:    private static int[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mreadIndexDataOffsets[0m[1;39m([0m[39mDataInput input[0m[1;39m)[0m[39m throws [0m          [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        int count = [0m[1;35minput.readUnsignedShort[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        if [0m[1;39m([0m[39mcount == [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:            return new int[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        int offSize = [0m[1;35mreadOffSize[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        int[0m[1;39m[[0m[1;39m][0m[39m offsets = new int[0m[1;39m[[0m[39mcount + [0m[1;36m1[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i <= count; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:            int offset = [0m[1;35minput.readOffset[0m[1;39m([0m[39moffSize[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            if [0m[1;39m([0m[39moffset > [0m[1;35minput.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"illegal offset value "[0m[39m + offset + [0m[32m" in [0m  [2m                [0m
[2;36m                    [0m         [32mCFF font"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            offsets[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = offset;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        return offsets;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:    private static byte[0m[1;39m[[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mreadIndexData[0m[1;39m([0m[39mDataInput input[0m[1;39m)[0m[39m throws IOException[0m   [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        int[0m[1;39m[[0m[1;39m][0m[39m offsets = [0m[1;35mreadIndexDataOffsets[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:        if [0m[1;39m([0m[39moffsets.length == [0m[1;36m0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:            return new byte[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        int count = offsets.length-[0m[1;36m1[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m indexDataValues = new byte[0m[1;39m[[0m[39mcount[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < count; i++[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            int length = offsets[0m[1;39m[[0m[39mi + [0m[1;36m1[0m[1;39m][0m[39m - offsets[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:            indexDataValues[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;35minput.readBytes[0m[1;39m([0m[39mlength[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        return indexDataValues;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:    private static String[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mreadStringIndexData[0m[1;39m([0m[39mDataInput input[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:        int[0m[1;39m[[0m[1;39m][0m[39m offsets = [0m[1;35mreadIndexDataOffsets[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:        if [0m[1;39m([0m[39moffsets.length == [0m[1;36m0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:            return new String[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:        int count = offsets.length-[0m[1;36m1[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m indexDataValues = new String[0m[1;39m[[0m[39mcount[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < count; i++[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:            int length = offsets[0m[1;39m[[0m[39mi + [0m[1;36m1[0m[1;39m][0m[39m - offsets[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:            if [0m[1;39m([0m[39mlength < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Negative index data length + "[0m[39m + length [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m" at "[0m[39m + [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:                        i + [0m[32m": offsets[0m[32m[[0m[32m"[0m[39m + [0m[1;39m([0m[39mi + [0m[1;36m1[0m[1;39m)[0m[39m + [0m[32m"[0m[32m][0m[32m="[0m[39m + offsets[0m[1;39m[[0m[39mi + [0m[1;36m1[0m[1;39m][0m[39m + [0m   [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:                        [0m[32m", offsets[0m[32m[[0m[32m"[0m[39m + i + [0m[32m"[0m[32m][0m[32m="[0m[39m + offsets[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:            indexDataValues[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = new [0m[1;35mString[0m[1;39m([0m[1;35minput.readBytes[0m[1;39m([0m[39mlength[0m[1;39m)[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39mStandardCharsets.ISO_8859_1[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:        return indexDataValues;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:156[0m[39m-[0m[1;36m177[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            total += size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;35mtypeList.add[0m[1;39m([0m[39mrecordType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;35mbarrList.add[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:156[0m[39m-[0m[1;36m177[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            total += size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;35mtypeList.add[0m[1;39m([0m[39mrecordType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;35mbarrList.add[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/test/java/org/apache/fontbox/pfb/PfbParserTest.jav[0m[1;92ma:33[0m[39m-[0m[1;36m104[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m33:c[0m[39mlass PfbParserTest[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * Test parsing a PFB font.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * @throws IOException [0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    void [0m[1;35mtestPfb[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        Type1Font font;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        try [0m[1;39m([0m[39mInputStream is = new [0m                                               [2m                [0m
[2;36m                    [0m         [1;35mFileInputStream[0m[1;39m([0m[32m"target/fonts/OpenSans-Regular.pfb"[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:            font = [0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"1.10"[0m[39m, [0m[1;35mfont.getVersion[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"OpenSans-Regular"[0m[39m, [0m[1;35mfont.getFontName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Open Sans Regular"[0m[39m, [0m[1;35mfont.getFullName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Open Sans"[0m[39m, [0m[1;35mfont.getFamilyName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Digitized data copyright [0m[32m([0m[32mc[0m[32m)[0m[32m 2010-2011, Google [0m [2m                [0m
[2;36m                    [0m         [32mCorporation."[0m[39m, [0m[1;35mfont.getNotice[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mfalse, [0m[1;35mfont.isFixedPitch[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mfalse, [0m[1;35mfont.isForceBold[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;35mfont.getItalicAngle[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Book"[0m[39m, [0m[1;35mfont.getWeight[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[1;35mAssertions.assertTrue[0m[1;39m([0m[1;35mfont.getEncoding[0m[1;39m([0m[1;39m)[0m[39m instanceof BuiltInEncoding[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m4498[0m[39m, [0m[1;35mfont.getASCIISegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m95911[0m[39m, [0m[1;35mfont.getBinarySegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m938[0m[39m, [0m[1;35mfont.getCharStringsDict[0m[1;39m([0m[1;39m)[0m[1;35m.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        for [0m[1;39m([0m[39mString s : [0m[1;35mfont.getCharStringsDict[0m[1;39m([0m[1;39m)[0m[1;35m.keySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            [0m[1;35mAssertions.assertNotNull[0m[1;39m([0m[1;35mfont.getPath[0m[1;39m([0m[39ms[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            [0m[1;35mAssertions.assertTrue[0m[1;39m([0m[1;35mfont.hasGlyph[0m[1;39m([0m[39ms[0m[1;39m)[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * PDFBOX-[0m[1;36m5713[0m[39m: font with several binary segments.[0m                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * @throws IOException [0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    void [0m[1;35mtestPfbPDFBox5713[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        Type1Font font;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        try [0m[1;39m([0m[39mInputStream is = new [0m                                               [2m                [0m
[2;36m                    [0m         [1;35mFileInputStream[0m[1;39m([0m[32m"target/fonts/DejaVuSerifCondensed.pfb"[0m[1;39m)[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            font = [0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Version 2.33"[0m[39m, [0m[1;35mfont.getVersion[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"DejaVuSerifCondensed"[0m[39m, [0m[1;35mfont.getFontName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"DejaVu Serif Condensed"[0m[39m, [0m[1;35mfont.getFullName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"DejaVu Serif Condensed"[0m[39m, [0m[1;35mfont.getFamilyName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Copyright [0m[32m[[0m[32mc[0m[32m][0m[32m 2003 by Bitstream, Inc. All [0m      [2m                [0m
[2;36m                    [0m         [32mRights Reserved."[0m[39m, [0m[1;35mfont.getNotice[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mfalse, [0m[1;35mfont.isFixedPitch[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[39mfalse, [0m[1;35mfont.isForceBold[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;35mfont.getItalicAngle[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[32m"Book"[0m[39m, [0m[1;35mfont.getWeight[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;35mAssertions.assertTrue[0m[1;39m([0m[1;35mfont.getEncoding[0m[1;39m([0m[1;39m)[0m[39m instanceof BuiltInEncoding[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m5959[0m[39m, [0m[1;35mfont.getASCIISegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m1056090[0m[39m, [0m[1;35mfont.getBinarySegment[0m[1;39m([0m[1;39m)[0m[39m.length[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;35mAssertions.assertEquals[0m[1;39m([0m[1;36m3399[0m[39m, [0m[1;35mfont.getCharStringsDict[0m[1;39m([0m[1;39m)[0m[1;35m.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     * Test [0m[1;36m0[0m[39m length font.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    void [0m[1;35mtestEmpty[0m[1;39m([0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        [0m[1;35mAssertions.assertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> [0m                       [2m                [0m
[2;36m                    [0m         [1;35mType1Font.createWithPFB[0m[1;39m([0m[39mnew byte[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/ttf/TTFParser.jav[0m[1;92ma:325[0m[39m-[0m[1;36m395[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:    private TTFTable [0m[1;35mreadTableDirectory[0m[1;39m([0m[39mTTFDataStream raf[0m[1;39m)[0m[39m throws IOException[0m   [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:        TTFTable table;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:        String tag = [0m[1;35mraf.readString[0m[1;39m([0m[1;36m4[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:        switch [0m[1;39m([0m[39mtag[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:            case CmapTable.TAG:[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:                table = new [0m[1;35mCmapTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:            case GlyphTable.TAG:[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:                table = new [0m[1;35mGlyphTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:            case HeaderTable.TAG:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:                table = new [0m[1;35mHeaderTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:            case HorizontalHeaderTable.TAG:[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:                table = new [0m[1;35mHorizontalHeaderTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:            case HorizontalMetricsTable.TAG:[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:                table = new [0m[1;35mHorizontalMetricsTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:            case IndexToLocationTable.TAG:[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:                table = new [0m[1;35mIndexToLocationTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:            case MaximumProfileTable.TAG:[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:                table = new [0m[1;35mMaximumProfileTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:            case NamingTable.TAG:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:                table = new [0m[1;35mNamingTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:            case OS2WindowsMetricsTable.TAG:[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:                table = new [0m[1;35mOS2WindowsMetricsTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:            case PostScriptTable.TAG:[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:                table = new [0m[1;35mPostScriptTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:            case DigitalSignatureTable.TAG:[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:                table = new [0m[1;35mDigitalSignatureTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            case KerningTable.TAG:[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:                table = new [0m[1;35mKerningTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:            case VerticalHeaderTable.TAG:[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:                table = new [0m[1;35mVerticalHeaderTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:            case VerticalMetricsTable.TAG:[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:                table = new [0m[1;35mVerticalMetricsTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:            case VerticalOriginTable.TAG:[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                table = new [0m[1;35mVerticalOriginTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            case GlyphSubstitutionTable.TAG:[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                table = new [0m[1;35mGlyphSubstitutionTable[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:            default:[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:                table = [0m[1;35mreadTable[0m[1;39m([0m[39mtag[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;35mtable.setTag[0m[1;39m([0m[39mtag[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:        [0m[1;35mtable.setCheckSum[0m[1;39m([0m[1;35mraf.readUnsignedInt[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:        [0m[1;35mtable.setOffset[0m[1;39m([0m[1;35mraf.readUnsignedInt[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:        [0m[1;35mtable.setLength[0m[1;39m([0m[1;35mraf.readUnsignedInt[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:        [0m[35m/[0m[35m/[0m[39m skip tables with zero length [0m[1;39m([0m[39mexcept glyf[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:        if [0m[1;39m([0m[1;35mtable.getLength[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[39m && ![0m[1;35mtag.equals[0m[1;39m([0m[39mGlyphTable.TAG[0m[1;39m)[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:        return table;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/cff/CFFParser.jav[0m[1;92ma:261[0m[39m-[0m[1;36m300[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:    private static int [0m[1;35mreadOffSize[0m[1;39m([0m[39mDataInput input[0m[1;39m)[0m[39m throws IOException[0m          [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:        int offSize = [0m[1;35minput.readUnsignedByte[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        if [0m[1;39m([0m[39moffSize < [0m[1;36m1[0m[39m || offSize > [0m[1;36m4[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Illegal [0m[32m([0m[32m< 1 or > 4[0m[32m)[0m[32m offSize value "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39moffSize[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:                    + [0m[32m" in CFF font at position "[0m[39m + [0m[1;39m([0m[1;35minput.getPosition[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:        return offSize;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    private static Header [0m[1;35mreadHeader[0m[1;39m([0m[39mDataInput input[0m[1;39m)[0m[39m throws IOException[0m        [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:        int major = [0m[1;35minput.readUnsignedByte[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        int minor = [0m[1;35minput.readUnsignedByte[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:        int hdrSize = [0m[1;35minput.readUnsignedByte[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        int offSize = [0m[1;35mreadOffSize[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:        return new [0m[1;35mHeader[0m[1;39m([0m[39mmajor, minor, hdrSize, offSize[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:    private static int[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mreadIndexDataOffsets[0m[1;39m([0m[39mDataInput input[0m[1;39m)[0m[39m throws [0m          [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        int count = [0m[1;35minput.readUnsignedShort[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        if [0m[1;39m([0m[39mcount == [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:            return new int[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        int offSize = [0m[1;35mreadOffSize[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        int[0m[1;39m[[0m[1;39m][0m[39m offsets = new int[0m[1;39m[[0m[39mcount + [0m[1;36m1[0m[1;39m][0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i <= count; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:            int offset = [0m[1;35minput.readOffset[0m[1;39m([0m[39moffSize[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            if [0m[1;39m([0m[39moffset > [0m[1;35minput.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"illegal offset value "[0m[39m + offset + [0m[32m" in [0m  [2m                [0m
[2;36m                    [0m         [32mCFF font"[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            offsets[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = offset;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        return offsets;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/cff/CFFParser.jav[0m[1;92ma:302[0m[39m-[0m[1;36m317[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:    private static byte[0m[1;39m[[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mreadIndexData[0m[1;39m([0m[39mDataInput input[0m[1;39m)[0m[39m throws IOException[0m   [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        int[0m[1;39m[[0m[1;39m][0m[39m offsets = [0m[1;35mreadIndexDataOffsets[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:        if [0m[1;39m([0m[39moffsets.length == [0m[1;36m0[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:            return new byte[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        int count = offsets.length-[0m[1;36m1[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m indexDataValues = new byte[0m[1;39m[[0m[39mcount[0m[1;39m][0m[1;39m[[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < count; i++[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            int length = offsets[0m[1;39m[[0m[39mi + [0m[1;36m1[0m[1;39m][0m[39m - offsets[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:            indexDataValues[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = [0m[1;35minput.readBytes[0m[1;39m([0m[39mlength[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        return indexDataValues;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/ttf/TTFDataStream.jav[0m[1;92ma:19[0m[39m-[0m[1;36m27[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.charset.Charset;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Calendar;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.TimeZone;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.pdfbox.io.RandomAccessRead;[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/ttf/TTFDataStream.jav[0m[1;92ma:130[0m[39m-[0m[1;36m142[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    public long [0m[1;35mreadUnsignedInt[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        long byte1 = [0m[1;35mread[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        long byte2 = [0m[1;35mread[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        long byte3 = [0m[1;35mread[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        long byte4 = [0m[1;35mread[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        if [0m[1;39m([0m[39mbyte4 < [0m[1;36m0[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF at "[0m[39m + [0m[1;35mgetCurrentPosition[0m[1;39m([0m[1;39m)[0m[39m + [0m          [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                    [0m[32m", b1: "[0m[39m + byte1 + [0m[32m", b2: "[0m[39m + byte2 + [0m[32m", b3: "[0m[39m + byte3 + [0m[32m",[0m [2m                [0m
[2;36m                    [0m         [32mb4: "[0m[39m + byte4[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        return [0m[1;39m([0m[39mbyte1 << [0m[1;36m24[0m[1;39m)[0m[39m + [0m[1;39m([0m[39mbyte2 << [0m[1;36m16[0m[1;39m)[0m[39m + [0m[1;39m([0m[39mbyte3 << [0m[1;36m8[0m[1;39m)[0m[39m + byte4;[0m            [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:68[0m[39m-[0m[1;36m71[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Heuristically chosen max length to buffer a Type1 font[0m                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final long MAX_LENGTH = 100_000_000;[0m                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:126[0m[39m-[0m[1;36m177[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[39mpfb.length < PFB_[0m[1;33mHEAD[0m[39mER_LENGTH[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"PFB header missing"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[35m/[0m[35m/[0m[39m read into segments and keep them[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        List<Integer> typeList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        List<byte[0m[1;39m[[0m[1;39m][0m[39m> barrList = new ArrayList<>[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        ByteArrayInputStream in = new [0m[1;35mByteArrayInputStream[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        int total = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        do[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            int r = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            if [0m[1;39m([0m[39mr == [0m[1;36m-1[0m[39m && total > [0m[1;36m0[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                break; [0m[35m/[0m[35m/[0m[39m EOF[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            if [0m[1;39m([0m[39mr != START_MARKER[0m[1;39m)[0m[39m [0m                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Start marker missing"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            int recordType = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:            if [0m[1;39m([0m[39mrecordType == EOF_MARKER[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            if [0m[1;39m([0m[39mrecordType != ASCII_MARKER && recordType != BINARY_MARKER[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Incorrect record type: "[0m[39m + recordType[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            int size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            size += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            long newTotal = total + size;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            if [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [39mnewTotal[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            int got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            total += size;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[1;35mtypeList.add[0m[1;39m([0m[39mrecordType[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;35mbarrList.add[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:37[0m[39m-[0m[1;36m82[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public class PfbParser [0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mPfbParser.class[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * the pfb header length.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * [0m[1;39m([0m[39mstart-marker [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, ascii-[0m[35m/[0m[95mbinary-marker[0m[39m [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, size [0m[1;39m([0m[1;36m4[0m[39m byte[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * [0m[1;36m3[0m[39m*[0m[1;36m6[0m[39m == [0m[1;36m18[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private static final int PFB_[0m[1;33mHEAD[0m[39mER_LENGTH = [0m[1;36m18[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * the start marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    private static final int START_MARKER = [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * the ascii marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private static final int ASCII_MARKER = [0m[1;36m0x01[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * the binary marker.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final int BINARY_MARKER = [0m[1;36m0x02[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * the EOF marker.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private static final int EOF_MARKER = [0m[1;36m0x03[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Heuristically chosen max length to buffer a Type1 font[0m                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final long MAX_LENGTH = 100_000_000;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * the parsed pfb-data.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m pfbdata;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * the lengths of the records [0m[1;39m([0m[39mASCII, BINARY, ASCII[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private final int[0m[1;39m[[0m[1;39m][0m[39m lengths = new int[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:182[0m[39m-[0m[1;36m222[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        pfbdata = new byte[0m[1;39m[[0m[39mtotal[0m[1;39m][0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m cleartomarkSegment = null;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        int dstPos = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        [0m[35m/[0m[35m/[0m[39m copy the ASCII segments[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mtypeList.size[0m[1;39m([0m[1;39m)[0m[39m; ++i[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:            if [0m[1;39m([0m[1;35mtypeList.get[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m != ASCII_MARKER[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                continue;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = [0m[1;35mbarrList.get[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            if [0m[1;39m([0m[39mi == [0m[1;35mtypeList.size[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[39m && ar.length < [0m[1;36m600[0m[39m && new [0m             [2m                [0m
[2;36m                    [0m         [1;35mString[0m[1;39m([0m[39mar[0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"cleartomark"[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                cleartomarkSegment = ar;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                continue;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mar, [0m[1;36m0[0m[39m, pfbdata, dstPos, ar.length[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            dstPos += ar.length;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        lengths[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = dstPos;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:        [0m[35m/[0m[35m/[0m[39m copy the binary segments[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mtypeList.size[0m[1;39m([0m[1;39m)[0m[39m; ++i[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            if [0m[1;39m([0m[1;35mtypeList.get[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m != BINARY_MARKER[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                continue;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m ar = [0m[1;35mbarrList.get[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mar, [0m[1;36m0[0m[39m, pfbdata, dstPos, ar.length[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            dstPos += ar.length;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:        lengths[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = dstPos - lengths[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        if [0m[1;39m([0m[39mcleartomarkSegment != null[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcleartomarkSegment, [0m[1;36m0[0m[39m, pfbdata, dstPos, [0m           [2m                [0m
[2;36m                    [0m         [39mcleartomarkSegment.length[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:            lengths[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = cleartomarkSegment.length;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Analysis[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I have identified the root[0m [2m                [0m
[2;36m                    [0m         [39mcause of the OOM vulnerability in [0m[1;35mPfbParser.parsePfb[0m[1;39m([0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability exists in lines [0m[1;36m156[0m[39m-[0m[1;36m166[0m[39m of PfbParser.java where a [0m[1;36m4[0m[39m-byte [0m         [2m                [0m
[2;36m                    [0m         [39mlittle-endian integer is read from the PFB file to determine segment size:[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mint size = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39msize += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39msize += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m16[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39msize += [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m << [0m[1;36m24[0m[39m;  [0m[35m/[0m[35m/[0m[39m Line [0m[1;36m159[0m[39m - Can create negative values[0m                  [2m                [0m
[2;36m                    [0m         [1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39mlong newTotal = total + size;  [0m[35m/[0m[35m/[0m[39m Line [0m[1;36m161[0m[39m - Integer overflow risk[0m                  [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m   [0m[35m/[0m[35m/[0m[39m Line [0m[1;36m162[0m[39m - Insufficient validation[0m                [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"record size would be too large: "[0m[39m + newTotal[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39mbyte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m;    [0m[35m/[0m[35m/[0m[39m Line [0m[1;36m166[0m[39m - OOM occurs here[0m                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Critical Issues:**[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Signed Integer Overflow**: When reading the [0m[1;36m4[0m[39m-byte size as a signed `int`, if [0m [2m                [0m
[2;36m                    [0m         [39mthe most significant bit is set [0m[1;39m([0m[39mbyte >= [0m[1;36m128[0m[1;39m)[0m[39m, the left shift by [0m[1;36m24[0m[39m positions [0m      [2m                [0m
[2;36m                    [0m         [39mproduces a negative value due to Java's two's complement representation.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Integer Overflow in Total Calculation**: When `size` is a large positive value[0m [2m                [0m
[2;36m                    [0m         [39mand is added to `total`, the result can overflow the `int` type, wrapping to a [0m     [2m                [0m
[2;36m                    [0m         [39mnegative or small value that bypasses the MAX_LENGTH check.[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Insufficient Individual Size Validation**: The check only validates cumulative[0m [2m                [0m
[2;36m                    [0m         [39mtotal [0m[1;39m([0m[39m`newTotal > MAX_LENGTH`[0m[1;39m)[0m[39m, not the individual segment size. A malicious PFB [0m  [2m                [0m
[2;36m                    [0m         [39mcould specify `size = Integer.MAX_VALUE` [0m[1;39m([0m[1;36m2[0m[39m,[0m[1;36m147[0m[39m,[0m[1;36m483[0m[39m,[0m[1;36m647[0m[39m bytes ≈ 2GB[0m[1;39m)[0m[39m, which would:[0m  [2m                [0m
[2;36m                    [0m         [39m   - Pass the check if `total` is [0m[1;36m0[0m[39m [0m[1;39m([0m[39msince `newTotal` would be less than total when[0m [2m                [0m
[2;36m                    [0m         [39moverflow occurs[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - Attempt to allocate ~2GB at line [0m[1;36m166[0m[39m, causing the observed OOM error[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Missing EOF Validation**: Unlike [0m[1;35mTTFDataStream.readUnsignedInt[0m[1;39m([0m[1;39m)[0m[39m, there's no [0m  [2m                [0m
[2;36m                    [0m         [39mvalidation that [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m returns a valid byte [0m[1;39m([0m[39mnot [0m[1;36m-1[0m[1;39m)[0m[39m.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix Strategy[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must be applied to the `[0m[1;35mparsePfb[0m[1;39m([0m[1;39m)[0m[39m` method in [0m                              [2m                [0m
[2;36m                    [0m         [39m`fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java` at lines [0m[1;36m156[0m[39m-[0m[1;36m164[0m[39m.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m1[0m[39m: Read Size as Unsigned Long [0m[1;39m([0m[39mLines [0m[1;36m156[0m[39m-[0m[1;36m159[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace the signed int reading with unsigned long reading to prevent negative [0m      [2m                [0m
[2;36m                    [0m         [39mvalues:[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Read [0m[1;36m4[0m[39m bytes individually into long variables[0m                                    [2m                [0m
[2;36m                    [0m         [39mlong byte1 = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39mlong byte2 = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39mlong byte3 = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39mlong byte4 = [0m[1;35min.read[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Validate EOF wasn't encountered[0m                                                  [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mbyte4 < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB segment size"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Combine into little-endian unsigned [0m[1;36m32[0m[39m-bit value [0m[1;39m([0m[1;36m0[0m[39m to [0m[1;36m4[0m[39m,[0m[1;36m294[0m[39m,[0m[1;36m967[0m[39m,[0m[1;36m295[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39mlong size = byte1 + [0m[1;39m([0m[39mbyte2 << [0m[1;36m8[0m[1;39m)[0m[39m + [0m[1;39m([0m[39mbyte3 << [0m[1;36m16[0m[1;39m)[0m[39m + [0m[1;39m([0m[39mbyte4 << [0m[1;36m24[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale**: By reading into `long` variables and combining them, we ensure the [0m  [2m                [0m
[2;36m                    [0m         [39mresult is always non-negative and can represent the full unsigned [0m[1;36m32[0m[39m-bit range. [0m    [2m                [0m
[2;36m                    [0m         [39mThis follows the same pattern as [0m[1;35mTTFDataStream.readUnsignedInt[0m[1;39m([0m[1;39m)[0m[39m but adapts it for [0m [2m                [0m
[2;36m                    [0m         [39mlittle-endian format.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m2[0m[39m: Validate Individual Segment Size [0m[1;39m([0m[39mNew validation after reading size[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd validation immediately after reading size to check it doesn't exceed [0m           [2m                [0m
[2;36m                    [0m         [39mMAX_LENGTH:[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;35mLOG.debug[0m[1;39m([0m[32m"record type: [0m[32m{[0m[32m}[0m[32m, segment size: [0m[32m{[0m[32m}[0m[32m"[0m[39m, recordType, size[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Validate individual segment size is reasonable[0m                                   [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39msize < [0m[1;36m0[0m[39m || size > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid PFB segment size: "[0m[39m + size[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale**: This prevents a single malicious segment from requesting excessive [0m  [2m                [0m
[2;36m                    [0m         [39mmemory allocation. Since MAX_LENGTH is [0m[1;36m100[0m[39m,[0m[1;36m000[0m[39m,[0m[1;36m000[0m[39m [0m[1;39m([0m[39mwell above the largest real [0m    [2m                [0m
[2;36m                    [0m         [39mType1 fonts at ~[0m[1;36m1[0m[39m-2MB[0m[1;39m)[0m[39m, legitimate fonts will not be affected.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m3[0m[39m: Validate Cumulative Total with Overflow Protection [0m[1;39m([0m[39mLines [0m[1;36m161[0m[39m-[0m[1;36m164[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mKeep the existing cumulative check but ensure proper overflow handling:[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Check cumulative size with explicit long casting to prevent overflow[0m             [2m                [0m
[2;36m                    [0m         [39mlong newTotal = [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39mtotal + size;[0m                                                 [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mnewTotal > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Cumulative PFB size too large: "[0m[39m + newTotal[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale**: The explicit cast ensures that even if `total` is close to [0m          [2m                [0m
[2;36m                    [0m         [39mInteger.MAX_VALUE, the addition won't overflow. This provides defense-in-depth with[0m [2m                [0m
[2;36m                    [0m         [39mthe individual size check.[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m4[0m[39m: Safe Array Allocation [0m[1;39m([0m[39mLine [0m[1;36m166[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mCast size to int for array allocation [0m[1;39m([0m[39msafe because of validation[0m[1;39m)[0m[39m:[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Safe to cast to int because size <= MAX_LENGTH < Integer.MAX_VALUE[0m               [2m                [0m
[2;36m                    [0m         [39mbyte[0m[1;39m[[0m[1;39m][0m[39m ar = new byte[0m[1;39m[[0m[1;39m([0m[39mint[0m[1;39m)[0m[39msize[0m[1;39m][0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39mint got = [0m[1;35min.read[0m[1;39m([0m[39mar[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mgot != size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mEOFException[0m[1;39m([0m[32m"EOF while reading PFB font"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale**: Since we validated `size <= MAX_LENGTH` [0m[1;39m([0m[1;36m100[0m[39m,[0m[1;36m000[0m[39m,[0m[1;36m000[0m[1;39m)[0m[39m and MAX_LENGTH[0m [2m                [0m
[2;36m                    [0m         [39m< Integer.MAX_VALUE [0m[1;39m([0m[1;36m2[0m[39m,[0m[1;36m147[0m[39m,[0m[1;36m483[0m[39m,[0m[1;36m647[0m[1;39m)[0m[39m, the cast to int is safe and won't cause array [0m [2m                [0m
[2;36m                    [0m         [39mallocation issues.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Preserved Functionality[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix strategy preserves all existing functionality:[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **PFB Format Compliance**: The reading logic still correctly interprets PFB [0m     [2m                [0m
[2;36m                    [0m         [39mlittle-endian [0m[1;36m4[0m[39m-byte size fields[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Segment Processing**: All segment types [0m[1;39m([0m[39mASCII, BINARY, EOF[0m[1;39m)[0m[39m are processed [0m    [2m                [0m
[2;36m                    [0m         [39midentically[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **MAX_LENGTH Defense**: The 100MB limit remains as the primary protection[0m        [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Multiple Segments**: Support for multiple segments in a single PFB file is [0m    [2m                [0m
[2;36m                    [0m         [39mmaintained[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Test Compatibility**: Existing tests will continue to pass since valid fonts [0m  [2m                [0m
[2;36m                    [0m         [39mhave segments well under MAX_LENGTH[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Error Messages**: Clear error messages indicate the specific validation [0m       [2m                [0m
[2;36m                    [0m         [39mfailure[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This is Optimal[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Targeted Fix**: Only modifies the vulnerable size reading logic without [0m       [2m                [0m
[2;36m                    [0m         [39maffecting the broader parsing workflow[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Defense in Depth**: Multiple validation layers [0m[1;39m([0m[39mindividual size, cumulative [0m   [2m                [0m
[2;36m                    [0m         [39mtotal, EOF checks[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Follows Codebase Patterns**: Mirrors validation approaches in CFFParser and [0m   [2m                [0m
[2;36m                    [0m         [39mTTFParser[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **No Functional Regression**: Maintains compatibility with all valid PFB fonts[0m   [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Clear Error Reporting**: Provides specific error messages for debugging [0m       [2m                [0m
[2;36m                    [0m         [39mmalformed files[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Minimal Performance Impact**: Validation adds negligible overhead to parsing[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Mitigation of Side Effects[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Valid Font Processing**: Since real Type1 fonts are < 2MB and MAX_LENGTH is [0m   [2m                [0m
[2;36m                    [0m         [39m100MB, no legitimate fonts will be rejected[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Existing Tests**: The fix doesn't change behavior for valid inputs, so [0m        [2m                [0m
[2;36m                    [0m         [1;35mPfbParserTest.testPfb[0m[1;39m([0m[1;39m)[0m[39m and [0m[1;35mtestPfbPDFBox5713[0m[1;39m([0m[1;39m)[0m[39m will continue to pass[0m               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Error Handling**: The catch blocks in PDType1Font [0m[1;39m([0m[39mlines [0m[1;36m247[0m[39m-[0m[1;36m256[0m[1;39m)[0m[39m already [0m     [2m                [0m
[2;36m                    [0m         [39mhandle IOExceptions gracefully by falling back to substitute fonts[0m                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Type1Font API**: No changes to [0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[1;39m)[0m[39m interface or behavior[0m [2m                [0m
[2;36m                    [0m         [39mfor valid inputs[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Security Improvement[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix addresses the FuzzerSecurityIssueLow by:[0m                                   [2m                [0m
[2;36m                    [0m         [39m- Preventing malicious PDFs from allocating excessive heap memory[0m                   [2m                [0m
[2;36m                    [0m         [39m- Rejecting crafted size values that could bypass previous checks through overflow[0m  [2m                [0m
[2;36m                    [0m         [39m- Providing early validation before memory allocation occurs[0m                        [2m                [0m
[2;36m                    [0m         [39m- Maintaining system stability under fuzzer testing conditions[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=908660;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=617;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=871289;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=587553;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmphifbr323[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_6/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768037258.4515393[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-full-01_vuln_6.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/10/26 09:27:40][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mpdfbox[0m         ]8;id=503673;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=184248;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=398174;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=22850;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mpdfbox[0m                [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=517641;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=845746;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mpdfbox[0m                 [2m               [0m
