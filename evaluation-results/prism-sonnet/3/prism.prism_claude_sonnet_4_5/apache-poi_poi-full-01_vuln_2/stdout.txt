[2;36m[01/10/26 00:04:05][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=538444;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=915420;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp4zu3qu6_[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768003445.734889[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-poi_poi-full-01_vuln_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m        ]8;id=605245;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=335336;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/10/26 00:06:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Building Cached for CLEAN environment[1m)[0m Took  ]8;id=316304;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=312174;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m141.95[0m seconds; [33mexception[0m=[3;91mFalse[0m                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN            ]8;id=938586;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=585499;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running tests for Cached for CLEAN           ]8;id=967220;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=275000;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=669500;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=615398;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m141[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=789396;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=589184;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 00:06:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.93[0m seconds;            ]8;id=450767;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=615374;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 00:06:30][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=461072;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=545236;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=655031;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=624333;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=4519;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=818685;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=816197;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=286759;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 00:06:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m1.20[0m seconds;            ]8;id=622901;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=536489;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=885659;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=409317;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 00:06:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.89[0m seconds;            ]8;id=402933;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=713808;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 00:06:39][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=542560;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=755363;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3944241204198781060/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m             [2m                [0m
[2;36m                    [0m         Entry/..[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1m([0mPOIFSDump.jav[1;92ma:108[0m[1m)[0m              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1m([0mPOIFSDump.jav[1;92ma:80[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1m([0mPOIPOIFSDumpFuzzer.jav[1;92ma:74[0m[1m)[0m    [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ac6e69a60acc10da                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3944241204198781060/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m             [2m                [0m
[2;36m                    [0m         Entry/..[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1m([0mFilePath [2m                [0m
[2;36m                    [0m         Traversal.jav[1;92ma:177[0m[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1m([0mPOIFSDump.jav[1;92ma:108[0m[1m)[0m              [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1m([0mPOIFSDump.jav[1;92ma:80[0m[1m)[0m               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1m([0mPOIPOIFSDumpFuzzer.jav[1;92ma:74[0m[1m)[0m    [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: ac6e69a60acc10da                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 00:07:00][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=660872;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=94016;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 00:10:30][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=339531;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=360688;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 00:13:34][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=823247;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=767143;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=318744;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=213330;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 00:13:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m1.03[0m seconds;            ]8;id=156848;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=58340;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Started[33m...[0m                          ]8;id=443569;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=614435;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpi16g8xhn[0m                                                 ]8;id=209403;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=788326;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 00:15:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Patching[1m)[0m Took [1;36m124.22[0m seconds;               ]8;id=601938;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=519158;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Started[33m...[0m                    ]8;id=598970;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=783208;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 00:16:16][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Checking build[1m)[0m Took [1;36m37.21[0m seconds;          ]8;id=899737;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=556026;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Started[33m...[0m                       ]8;id=86182;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=758584;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 00:16:22][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Running PoV[1m)[0m Took [1;36m5.99[0m seconds;              ]8;id=884312;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=863128;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Started[33m...[0m                           ]8;id=157643;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=256876;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=176579;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=788686;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=559281;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=247802;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 00:16:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.87[0m seconds;            ]8;id=279735;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=957209;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 00:16:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=6088;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=243245;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 00:16:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.94[0m seconds;            ]8;id=793599;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=141704;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 00:16:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Started[33m...[0m                     ]8;id=527489;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=257549;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 00:16:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-poi Setting owner[1m)[0m Took [1;36m0.95[0m seconds;            ]8;id=797989;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=952550;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=377749;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=426195;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/poi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.java                     [2m                [0m
[2;36m                    [0m         +++ b/poi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.java                     [2m                [0m
[2;36m                    [0m         @@ [1;36m-72[0m,[1;36m7[0m +[1;36m72[0m,[1;36m7[0m @@                                                                   [2m                [0m
[2;36m                    [0m                          File dumpDir =                                                     [2m                [0m
[2;36m                    [0m                                  [1;35mPaths.get[0m[1m([0mfilename[1m)[0m[1;35m.getParent[0m[1m([0m[1m)[0m                            [2m                [0m
[2;36m                    [0m                                          [1;35m.resolve[0m[1m([0mfilenameWithoutPath + [32m"_dump"[0m[1m)[0m[1;35m.toFile[0m[1m([0m[1m)[0m;  [2m                [0m
[2;36m                    [0m         -                File file = new [1;35mFile[0m[1m([0mdumpDir, [1;35mroot.getName[0m[1m([0m[1m)[0m[1m)[0m;                     [2m                [0m
[2;36m                    [0m         +                File file = new [1;35mFile[0m[1m([0mdumpDir, [1;35msanitizeEntryName[0m[1m([0m[1;35mroot.getName[0m[1m([0m[1m)[0m[1m)[0m[1m)[0m;  [2m                [0m
[2;36m                    [0m                          if [1m([0m![1;35mfile.exists[0m[1m([0m[1m)[0m && ![1;35mfile.mkdirs[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                            [2m                [0m
[2;36m                    [0m                              throw new [1;35mIOException[0m[1m([0m[32m"Could not create directory "[0m + file[1m)[0m;   [2m                [0m
[2;36m                    [0m                          [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-95[0m,[1;36m6[0m +[1;36m95[0m,[1;36m48[0m @@                                                                  [2m                [0m
[2;36m                    [0m                      [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m         +    [35m/[0m**                                                                            [2m                [0m
[2;36m                    [0m         +     * Sanitizes an entry name to prevent path traversal attacks.                  [2m                [0m
[2;36m                    [0m         +     * Removes or replaces path separators, parent directory references,           [2m                [0m
[2;36m                    [0m         +     * and other potentially dangerous characters.                                 [2m                [0m
[2;36m                    [0m         +     *                                                                             [2m                [0m
[2;36m                    [0m         +     * @param name the entry name to sanitize                                      [2m                [0m
[2;36m                    [0m         +     * @return a safe filename that cannot escape the parent directory             [2m                [0m
[2;36m                    [0m         +     *[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         +    private static String [1;35msanitizeEntryName[0m[1m([0mString name[1m)[0m [1m{[0m                         [2m                [0m
[2;36m                    [0m         +        if [1m([0mname == null || [1;35mname.isEmpty[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         +            return [32m"unnamed"[0m;                                                      [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        name = [1;35mname.trim[0m[1m([0m[1m)[0m;                                                        [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        if [1m([0m[1;35mname.isEmpty[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                                                      [2m                [0m
[2;36m                    [0m         +            return [32m"unnamed"[0m;                                                      [2m                [0m
[2;36m                    [0m         +        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m         +        StringBuilder result = new [1;35mStringBuilder[0m[1m([0m[1m)[0m;                                [2m                [0m
[2;36m                    [0m         +        for [1m([0mint i = [1;36m0[0m; i [1m<[0m[39m [0m[1;35mname.length[0m[1;39m([0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [39m+            char ch = [0m[1;35mname.charAt[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39mch == [0m[32m'/'[0m[39m || ch == [0m[32m'\\' || ch == '[0m[39m:' || ch < [0m[1;36m32[0m[39m || ch == [0m[1;36m127[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;35mresult.append[0m[1;39m([0m[32m'_'[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;35mresult.append[0m[1;39m([0m[39mch[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        String sanitized = [0m[1;35mresult.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        while [0m[1;39m([0m[1;35msanitized.contains[0m[1;39m([0m[32m".."[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [39m+            sanitized = [0m[1;35msanitized.replace[0m[1;39m([0m[32m".."[0m[39m, [0m[32m"__"[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        sanitized = [0m[1;35msanitized.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35msanitized.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+            return [0m[32m"unnamed"[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        return sanitized;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     [0m                                                                               [2m                [0m
[2;36m                    [0m         [39m     public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-105[0m[39m,[0m[1;36m12[0m[39m +[0m[1;36m147[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m                 try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m                    bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m-                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m    [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m    [2m                [0m
[2;36m                    [0m         [1;35msanitizeEntryName[0m[1;39m([0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [39m                     [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [39m                 DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                        [2m                [0m
[2;36m                    [0m         [39m-                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m                     throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + file[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3944241204198781060/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39mEntry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:108[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:80[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIPOIFSDumpFuzzer.jav[0m[1;92ma:74[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: ac6e69a60acc10da[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA critical security vulnerability has been detected during fuzzing of Apache POI's [0m [2m                [0m
[2;36m                    [0m         [39mPOIFSDump functionality. The issue involves a file path traversal attack where a [0m   [2m                [0m
[2;36m                    [0m         [39mspecially crafted input allows writing to or accessing files outside the intended [0m  [2m                [0m
[2;36m                    [0m         [39mdirectory structure using path traversal sequences [0m[1;39m([0m[39m`..[0m[35m/../../../[0m[39m`[0m[1;39m)[0m[39m. The [0m           [2m                [0m
[2;36m                    [0m         [39mvulnerability was triggered when processing a malicious POIFS [0m[1;39m([0m[39mOLE2[0m[1;39m)[0m[39m file that [0m     [2m                [0m
[2;36m                    [0m         [39mcontained directory entries designed to escape the intended output directory.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fuzzing session detected a **File Path Traversal vulnerability** [0m[1;39m([0m[39malso known as[0m [2m                [0m
[2;36m                    [0m         [39mDirectory Traversal[0m[1;39m)[0m[39m in the Apache POI library's POIFSDump utility. This is [0m        [2m                [0m
[2;36m                    [0m         [39mclassified as a critical security issue that could allow an attacker to access or [0m  [2m                [0m
[2;36m                    [0m         [39mmanipulate files outside of the intended directory boundaries.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Details[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue manifests when POIFSDump processes a POIFS file containing maliciously [0m   [2m                [0m
[2;36m                    [0m         [39mcrafted directory entry names. Specifically, the problematic path is:[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3944241204198781060/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39mEntry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe path traversal sequence `..[0m[35m/../../../[0m[39m` in the [0m[32m"Root Entry"[0m[39m directory name [0m      [2m                [0m
[2;36m                    [0m         [39mallows escaping from the intended output directory structure [0m[1;39m([0m[39m`input.bin_dump`[0m[1;39m)[0m[39m to [0m [2m                [0m
[2;36m                    [0m         [39mwrite or access files at arbitrary locations in the filesystem.[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Stack Trace Analysis[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is triggered through the following call chain:[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Point**: `[0m[1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m` - The [0m [2m                [0m
[2;36m                    [0m         [39mfuzzer harness that feeds input to the library[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Vulnerable Code Path**: `[0m[1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1;39m([0m[1;39m)[0m[39m` → [0m         [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m`[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Detection Point**: The Jazzer sanitizer's [0m                                     [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mFilePathTraversal.pathFirstArgHook[0m[1;39m([0m[1;39m)[0m[39m` detected the malicious path at line [0m[1;36m177[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mwhich then invoked `[0m[1;35mcheckPath[0m[1;39m([0m[1;39m)[0m[39m` and `[0m[1;35mcheck[0m[1;39m([0m[1;39m)[0m[39m` methods[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe security violation was caught by the Jazzer sanitizer at [0m                       [2m                [0m
[2;36m                    [0m         [39m`FilePathTraversal.jav[0m[1;92ma:346[0m[39m`, indicating that the POIFSDump code attempted to use [0m  [2m                [0m
[2;36m                    [0m         [39man unsafe file path without proper validation.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The vulnerability occurs in the POIFSDump utility [0m[1;39m([0m[39mline [0m[1;36m108[0m[39m in POIFSDump.java[0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mspecifically during the dump operation[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The malicious input leverages POIFS internal structure [0m[1;39m([0m[39mspecifically the [0m[32m"Root [0m  [2m                [0m
[2;36m                    [0m         [32mEntry"[0m[39m name[0m[1;39m)[0m[39m to inject path traversal sequences[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The vulnerability affects file system operations where directory entry names [0m    [2m                [0m
[2;36m                    [0m         [39mfrom the POIFS file are used to construct output file paths[0m                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. This is a classic path traversal vulnerability where user-controlled input [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mdirectory entry names in the POIFS file[0m[1;39m)[0m[39m is used in file path construction without[0m [2m                [0m
[2;36m                    [0m         [39mproper sanitization[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a comprehensive understanding of this vulnerability, the following areas of[0m [2m                [0m
[2;36m                    [0m         [39mthe codebase should be investigated:[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **[0m[1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m** [0m[1;39m([0m[39mline [0m[1;36m108[0m[1;39m)[0m[39m: Examine how directory [0m [2m                [0m
[2;36m                    [0m         [39mentry names are extracted from POIFS files and how output file paths are [0m           [2m                [0m
[2;36m                    [0m         [39mconstructed[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **POIFS Directory Entry Parsing**: Investigate how the library reads and [0m        [2m                [0m
[2;36m                    [0m         [39mprocesses directory entry names from OLE2/POIFS files[0m                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Path Construction Logic**: Review all locations where file paths are built [0m    [2m                [0m
[2;36m                    [0m         [39musing data extracted from POIFS files, particularly where directory or file names [0m  [2m                [0m
[2;36m                    [0m         [39mfrom the archive are concatenated with base output paths[0m                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Input Validation**: Check whether there are any existing validation mechanisms[0m [2m                [0m
[2;36m                    [0m         [39mfor directory entry names and why they failed to catch this traversal sequence[0m      [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Related POIFSDump Methods**: Examine the complete POIFSDump class, including [0m  [2m                [0m
[2;36m                    [0m         [39mthe [0m[1;35mmain[0m[1;39m([0m[1;39m)[0m[39m method [0m[1;39m([0m[39mline [0m[1;36m80[0m[1;39m)[0m[39m and any helper methods involved in the dump operation[0m   [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **File System Operations**: Identify all file creation, writing, or opening [0m     [2m                [0m
[2;36m                    [0m         [39moperations in the dump functionality to understand the full attack surface[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe DEDUP_TOKEN `ac6e69a60acc10da` can be used to track this specific vulnerability[0m [2m                [0m
[2;36m                    [0m         [39minstance across multiple fuzzing runs.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp3944241204198781060/output/q/r/s/t/input.bin_dump/[0m[95mRoot[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39mEntry/..[0m[35m/../../../[0m[95mjazzer-traversal[0m                                                  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.pathFirstArgHook[0m[1;39m([0m[39mFilePath[0m [2m                [0m
[2;36m                    [0m         [39mTraversal.jav[0m[1;92ma:177[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.dump[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:108[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.poi.poifs.dev.POIFSDump.main[0m[1;39m([0m[39mPOIFSDump.jav[0m[1;92ma:80[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.poi.POIPOIFSDumpFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mPOIPOIFSDumpFuzzer.jav[0m[1;92ma:74[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: ac6e69a60acc10da[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:1[0m[39m-[0m[1;36m38[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.poi.poifs.dev;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.poifs.common.POIFSConstants;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.poifs.filesystem.DirectoryEntry;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.poifs.filesystem.DocumentInputStream;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.poifs.filesystem.DocumentNode;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.poifs.filesystem.Entry;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.poi.poifs.filesystem.POIFSFileSystem;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.poi.poifs.filesystem.POIFSStream;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.poi.poifs.property.PropertyTable;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.poi.poifs.storage.HeaderBlock;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.poi.util.IOUtils;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:99[0m[39m-[0m[1;36m122[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mentry instanceof DocumentNode[0m[1;39m)[0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                final DocumentNode node = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                final byte[0m[1;39m[[0m[1;39m][0m[39m bytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                   bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mdir, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Skipping unsupported POIFS entry: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mentry[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/Entry.jav[0m[1;92ma:1[0m[39m-[0m[1;36m37[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:package org.apache.poi.poifs.filesystem;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m: * This interface provides access to an object managed by a Filesystem[0m           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m: * instance. Entry objects are further divided into DocumentEntry and[0m            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m: * DirectoryEntry instances.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public interface Entry[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     * get the name of the Entry[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * @return name[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/DirectoryNode.jav[0m[1;92ma:1[0m[39m-[0m[1;36m96[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.poi.poifs.filesystem;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.FileNotFoundException;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.Spliterator;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.poi.hpsf.ClassID;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.poi.poifs.dev.POIFSViewable;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.poi.poifs.property.DirectoryProperty;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.poi.poifs.property.DocumentProperty;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.poi.poifs.property.Property;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: * Simple implementation of DirectoryEntry[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:public class DirectoryNode[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        extends EntryNode[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        implements DirectoryEntry, POIFSViewable, Iterable<Entry> [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[35m/[0m[35m/[0m[39m Map of Entry instances, keyed by their literal names as stored[0m            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    private final Map<String,Entry> _byname = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[35m/[0m[35m/[0m[39m Map of Entry instances, keyed by their Uppercased names[0m                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    private final Map<String,Entry> _byUCName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[35m/[0m[35m/[0m[39m Our list of entries, kept sorted to preserve order[0m                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private final ArrayList<Entry> _entries = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[35m/[0m[35m/[0m[39m the POIFSFileSystem we belong to[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private final POIFSFileSystem _filesystem;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[35m/[0m[35m/[0m[39m the path described by this document[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    private final POIFSDocumentPath _path;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * create a DirectoryNode. This method is not public by design; it[0m           [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * is intended strictly for the internal use of this package[0m                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * @param property the DirectoryProperty for this DirectoryEntry[0m             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * @param filesystem the [0m[1;39m{[0m[39m@link POIFSFileSystem[0m[1;39m}[0m[39m we belong to[0m                [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * @param parent the parent of this entry[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;35mDirectoryNode[0m[1;39m([0m[39mfinal DirectoryProperty property,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                  final POIFSFileSystem filesystem,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                  final DirectoryNode parent[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mproperty, parent[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        this._filesystem = filesystem;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        if [0m[1;39m([0m[39mparent == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            _path = new [0m[1;35mPOIFSDocumentPath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            _path = new [0m[1;35mPOIFSDocumentPath[0m[1;39m([0m[39mparent._path, new String[0m[1;39m[[0m[1;39m][0m[39m [0m[1;39m{[0m[39m [0m          [2m                [0m
[2;36m                    [0m         [1;35mproperty.getName[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m}[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        Iterator<Property> iter = [0m[1;35mproperty.getChildren[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        while [0m[1;39m([0m[1;35miter.hasNext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            Property child = [0m[1;35miter.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            Entry childNode;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            if [0m[1;39m([0m[1;35mchild.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                DirectoryProperty childDir = [0m[1;39m([0m[39mDirectoryProperty[0m[1;39m)[0m[39m child;[0m          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                childNode = new [0m[1;35mDirectoryNode[0m[1;39m([0m[39mchildDir, _filesystem, this[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                childNode = new [0m[1;35mDocumentNode[0m[1;39m([0m[1;39m([0m[39mDocumentProperty[0m[1;39m)[0m[39m child, this[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[1;35m_entries.add[0m[1;39m([0m[39mchildNode[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            [0m[1;35m_byname.put[0m[1;39m([0m[1;35mchildNode.getName[0m[1;39m([0m[1;39m)[0m[39m, childNode[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            [0m[1;35m_byUCName.put[0m[1;39m([0m[1;35mchildNode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.toUpperCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [39mchildNode[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/DirectoryNode.jav[0m[1;92ma:159[0m[39m-[0m[1;36m171[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    DocumentEntry [0m[1;35mcreateDocument[0m[1;39m([0m[39mfinal POIFSDocument document[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:            throws IOException [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        DocumentProperty property = [0m[1;35mdocument.getDocumentProperty[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        DocumentNode rval = new [0m[1;35mDocumentNode[0m[1;39m([0m[39mproperty, this[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        [0m[1;39m([0m[1;39m([0m[39m DirectoryProperty [0m[1;39m)[0m[39m [0m[1;35mgetProperty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addChild[0m[1;39m([0m[39mproperty[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:        [0m[1;35m_filesystem.addDocument[0m[1;39m([0m[39mdocument[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        [0m[1;35m_entries.add[0m[1;39m([0m[39mrval[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:        [0m[1;35m_byname.put[0m[1;39m([0m[1;35mproperty.getName[0m[1;39m([0m[1;39m)[0m[39m, rval[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        [0m[1;35m_byUCName.put[0m[1;39m([0m[1;35mproperty.getName[0m[1;39m([0m[1;39m)[0m[1;35m.toUpperCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[39m, rval[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        return rval;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/filesystem/DirectoryNode.jav[0m[1;92ma:420[0m[39m-[0m[1;36m431[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:    public DirectoryEntry [0m[1;35mcreateDirectory[0m[1;39m([0m[39mfinal String name[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:        DirectoryProperty property = new [0m[1;35mDirectoryProperty[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:        DirectoryNode rval = new [0m[1;35mDirectoryNode[0m[1;39m([0m[39mproperty, _filesystem, this[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;35m_filesystem.addDirectory[0m[1;39m([0m[39mproperty[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:        [0m[1;39m([0m[1;39m([0m[39m DirectoryProperty [0m[1;39m)[0m[39m [0m[1;35mgetProperty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addChild[0m[1;39m([0m[39mproperty[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:        [0m[1;35m_entries.add[0m[1;39m([0m[39mrval[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:        [0m[1;35m_byname.put[0m[1;39m([0m[39mname, rval[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:        [0m[1;35m_byUCName.put[0m[1;39m([0m[1;35mname.toUpperCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[39m, rval[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:        return rval;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/main/java/org/apache/poi/xdgf/util/Util.jav[0m[1;92ma:1[0m[39m-[0m[1;36m37[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.xdgf.util;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:public class Util [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:    public static int [0m[1;35mcountLines[0m[1;39m([0m[39mString str[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:        int lines = [0m[1;36m1[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:        int pos = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:        while [0m[1;39m([0m[1;39m([0m[39mpos = [0m[1;35mstr.indexOf[0m[1;39m([0m[32m'\n'[0m[39m, pos[0m[1;39m)[0m[39m + [0m[1;36m1[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:            lines++;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:        return lines;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    [0m[35m/[0m[35m/[0m[39m this probably isn't [0m[1;36m100[0m[39m% correct, so don't use it in security-sensitive[0m   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[35m/[0m[35m/[0m[39m applications![0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[35m/[0m[39m from: [0m[4;94mhttp://www.rgagnon.com/javadetails/java-0662.html[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    public static String [0m[1;35msanitizeFilename[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:        return [0m[1;35mname.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m:\\\\/*\"?|<>[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:1[0m[39m-[0m[1;36m43[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.poifs.property;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.poi.hpsf.ClassID;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.poifs.common.POIFSConstants;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.poifs.dev.POIFSViewable;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.util.ByteField;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.util.IntegerField;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.poi.util.LittleEndianConsts;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.poi.util.ShortField;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * This abstract base class is the ancestor of all classes[0m                       [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: * implementing POIFS Property behavior.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:public abstract class Property implements Child, POIFSViewable [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    static final private byte   _default_fill             = [0m[1;39m([0m[39m byte [0m[1;39m)[0m[39m [0m[1;36m0x00[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    static final private int    _name_size_offset         = [0m[1;36m0x40[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    static final private int    _max_name_length          =[0m                      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:        [0m[1;39m([0m[39m_name_size_offset [0m[35m/[0m[39m LittleEndianConsts.SHORT_SIZE[0m[1;39m)[0m[39m - [0m[1;36m1[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:123[0m[39m-[0m[1;36m162[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    protected [0m[1;35mProperty[0m[1;39m([0m[39mint index, byte [0m[1;39m[[0m[1;39m][0m[39m array, int offset[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        _raw_data          = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39marray, offset, offset + [0m        [2m                [0m
[2;36m                    [0m         [39mPOIFSConstants.PROPERTY_SIZE[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        _name_size         = new [0m[1;35mShortField[0m[1;39m([0m[39m_name_size_offset, _raw_data[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        _property_type     = new [0m                                               [2m                [0m
[2;36m                    [0m         [1;35mByteField[0m[1;39m([0m[39mPropertyConstants.PROPERTY_TYPE_OFFSET, _raw_data[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        _node_color        = new [0m[1;35mByteField[0m[1;39m([0m[39m_node_color_offset, _raw_data[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        _previous_property = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_previous_property_offset, [0m       [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        _next_property     = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_next_property_offset, [0m           [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        _child_property    = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_child_property_offset, [0m          [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        _storage_clsid     = new [0m[1;35mClassID[0m[1;39m([0m[39m_raw_data,_storage_clsid_offset[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        _user_flags        = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_user_flags_offset, [0m[1;36m0[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39m_raw_data[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        _seconds_1         = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_seconds_1_offset, _raw_data[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        _days_1            = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_days_1_offset, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        _seconds_2         = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_seconds_2_offset, _raw_data[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:        _days_2            = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_days_2_offset, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        _start_block       = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_start_block_offset, _raw_data[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        _size              = new [0m[1;35mIntegerField[0m[1;39m([0m[39m_size_offset, _raw_data[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:        _index             = index;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        int name_length = [0m[1;39m([0m[1;35m_name_size.get[0m[1;39m([0m[1;39m)[0m[39m [0m[35m/[0m[39m LittleEndianConsts.SHORT_SIZE[0m[1;39m)[0m[39m - [0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        if [0m[1;39m([0m[39mname_length < [0m[1;36m1[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:            _name = [0m[32m""[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            char[0m[1;39m[[0m[1;39m][0m[39m char_array  = new char[0m[1;39m[[0m[39m name_length [0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            int    name_offset = [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            for [0m[1;39m([0m[39mint j = [0m[1;36m0[0m[39m; j < name_length; j++[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                char_array[0m[1;39m[[0m[39m j [0m[1;39m][0m[39m = [0m[1;39m([0m[39m char [0m[1;39m)[0m[39m new [0m[1;35mShortField[0m[1;39m([0m[39mname_offset,[0m          [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                                                          _raw_data[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                name_offset     += LittleEndianConsts.SHORT_SIZE;[0m               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            _name = new [0m[1;35mString[0m[1;39m([0m[39mchar_array, [0m[1;36m0[0m[39m, name_length[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        _next_child     = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:        _previous_child = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/property/Property.jav[0m[1;92ma:233[0m[39m-[0m[1;36m286[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:     * Get the name of this property[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:     * @return property name as String[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    public String [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:        return _name;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:     * @return true if a directory type Property[0m                                [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    abstract public boolean [0m[1;35misDirectory[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:     * Sets the storage clsid, which is the Class ID of a COM object which[0m      [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:     *   reads and writes this stream[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:     * @return storage Class ID for this property stream[0m                        [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    public ClassID [0m[1;35mgetStorageClsid[0m[1;39m([0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:        return _storage_clsid;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:     * Set the name; silently truncates the name if it's too long.[0m              [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:     * @param name the new name[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    protected void [0m[1;35msetName[0m[1;39m([0m[39mString name[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        char[0m[1;39m[[0m[1;39m][0m[39m char_array = [0m[1;35mname.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        int    limit      = [0m[1;35mMath.min[0m[1;39m([0m[39mchar_array.length, _max_name_length[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:        _name = new [0m[1;35mString[0m[1;39m([0m[39mchar_array, [0m[1;36m0[0m[39m, limit[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:        short offset = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:        int   j      = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:        for [0m[1;39m([0m[39m; j < limit; j++[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:            new [0m[1;35mShortField[0m[1;39m([0m[39moffset, [0m[1;39m([0m[39m short [0m[1;39m)[0m[39m char_array[0m[1;39m[[0m[39m j [0m[1;39m][0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            offset += [0m[1;39m([0m[39mshort[0m[1;39m)[0m[39m LittleEndianConsts.SHORT_SIZE;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:        for [0m[1;39m([0m[39m; j < _max_name_length + [0m[1;36m1[0m[39m; j++[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:            new [0m[1;35mShortField[0m[1;39m([0m[39moffset, [0m[1;39m([0m[39m short [0m[1;39m)[0m[39m [0m[1;36m0[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:            offset += [0m[1;39m([0m[39mshort[0m[1;39m)[0m[39m LittleEndianConsts.SHORT_SIZE;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        [0m[35m/[0m[35m/[0m[39m double the count, and include the null at the end[0m                    [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        _name_size[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:            [0m[1;35m.set[0m[1;39m([0m[1;39m([0m[39m short [0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mlimit + [0m[1;36m1[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:                            * LittleEndianConsts.SHORT_SIZE[0m[1;39m)[0m[39m, _raw_data[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSLister.jav[0m[1;92ma:1[0m[39m-[0m[1;36m31[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.poifs.dev;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.poi.poifs.filesystem.DirectoryNode;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.poi.poifs.filesystem.DocumentNode;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.poi.poifs.filesystem.Entry;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.poi.poifs.filesystem.POIFSFileSystem;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSLister.jav[0m[1;92ma:79[0m[39m-[0m[1;36m107[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:   public static void [0m[1;35mdisplayDirectory[0m[1;39m([0m[39mDirectoryNode dir, String indent, boolean[0m [2m                [0m
[2;36m                    [0m         [39mwithSizes[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:      [0m[1;35mSystem.out.println[0m[1;39m([0m[39mindent + [0m[1;35mdir.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" -"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:      String newIndent = indent + [0m[32m"  "[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:      boolean hadChildren = false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:      [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mdir.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:         hadChildren = true;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:         Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:         if [0m[1;39m([0m[39mentry instanceof DirectoryNode[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            [0m[1;35mdisplayDirectory[0m[1;39m([0m[1;39m([0m[39mDirectoryNode[0m[1;39m)[0m[39m entry, newIndent, withSizes[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:         [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            DocumentNode doc = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            String name = [0m[1;35mdoc.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            String size = [0m[32m""[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            if [0m[1;39m([0m[1;35mname.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m < [0m[1;36m10[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:               String altname = [0m[32m"[0m[32m([0m[32m0x0"[0m[39m + [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m [0m[1;35mname.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m + [0m[32m"[0m[32m)[0m[32m"[0m[39m + [0m           [2m                [0m
[2;36m                    [0m         [1;35mname.substring[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:               name = [0m[1;35mname.substring[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m + [0m[32m" <"[0m[39m + altname + [0m[32m">"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            if [0m[1;39m([0m[39mwithSizes[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:               size = [0m[32m" [0m[32m[[0m[32m"[0m[39m + [0m[1;35mdoc.getSize[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" / 0x"[0m[39m +[0m                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                      [0m[1;35mInteger.toHexString[0m[1;39m([0m[1;35mdoc.getSize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m + [0m[32m"[0m[32m][0m[32m"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;35mSystem.out.println[0m[1;39m([0m[39mnewIndent + name + size[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:         [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:      if [0m[1;39m([0m[39m!hadChildren[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:         [0m[1;35mSystem.out.println[0m[1;39m([0m[39mnewIndent + [0m[32m"[0m[32m([0m[32mno children[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:      [0m[1;39m}[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:   [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi-ooxml/src/test/java/org/apache/poi/poifs/crypt/tests/TestEncryptor.jav[0m[1;92ma:416[0m[39m-[0m[1;36m427[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:    private void [0m[1;35mlistEntry[0m[1;39m([0m[39mDocumentNode de, String ext, String path[0m[1;39m)[0m[39m throws [0m    [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:        path += [0m[32m"\\" + de.getName[0m[32m([0m[32m)[0m[32m.replaceAll[0m[32m([0m[32m"[0m[1;39m[[0m[39m\\p[0m[1;39m{[0m[39mCntrl[0m[1;39m}[0m[1;39m][0m[32m", "[0m[39m_"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:        [0m[1;35mSystem.out.println[0m[1;39m([0m[39mext+[0m[32m": "[0m[39m+path+[0m[32m" [0m[32m([0m[32m"[0m[39m+[0m[1;35mde.getSize[0m[1;39m([0m[1;39m)[0m[39m+[0m[32m" bytes[0m[32m)[0m[32m"[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        String name = [0m[1;35mde.getName[0m[1;39m([0m[1;39m)[0m[1;35m.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m\\p[0m[32m{[0m[32mCntrl[0m[32m}[0m[32m][0m[32m"[0m[39m, [0m[32m"_"[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:        InputStream is = [0m                                                       [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;39m([0m[39mDirectoryNode[0m[1;39m)[0m[1;35mde.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.createDocumentInputStream[0m[1;39m([0m[39mde[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:        FileOutputStream fos = new [0m[1;35mFileOutputStream[0m[1;39m([0m[32m"solr."[0m[39m+name+[0m[32m"."[0m[39m+ext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mis, fos[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:        [0m[1;35mfos.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:        [0m[1;35mis.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/ss/util/WorkbookUtil.jav[0m[1;92ma:1[0m[39m-[0m[1;36m46[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* ====================================================================[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:   Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:   contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:   this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:   The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:   [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:   the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:   Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:   distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:   See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:   limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:==================================================================== *[0m[35m/[0m          [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.poi.ss.util;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m: * Helper methods for when working with Usermodel Workbooks[0m                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:public class WorkbookUtil [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:     * Creates a valid sheet name, which is conform to the rules.[0m                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:     * In any case, the result safely can be used for[0m                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:     * [0m[1;39m{[0m[39m@link org.apache.poi.ss.usermodel.Workbook#[0m[1;35msetSheetName[0m[1;39m([0m[39mint, String[0m[1;39m)[0m[1;39m}[0m[39m.[0m   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:     * <br>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     * Rules:[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     * <ul>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     * <li>never null<[0m[35m/[0m[95mli[0m[39m>[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     * <li>minimum length is [0m[1;36m1[0m[39m<[0m[35m/[0m[95mli[0m[39m>[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * <li>maximum length is [0m[1;36m31[0m[39m<[0m[35m/[0m[95mli[0m[39m>[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     * <li>doesn't contain special chars: : [0m[1;36m0x0000[0m[39m, [0m[1;36m0x0003[0m[39m, [0m[35m/[0m[39m \ ? * [0m[1;39m][0m[39m [0m[1;39m[[0m[39m <[0m[35m/[0m[95mli[0m[39m>[0m    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * <li>Sheet names must not begin or end with ' [0m[1;39m([0m[39mapostrophe[0m[1;39m)[0m[39m<[0m[35m/[0m[95mli[0m[39m>[0m            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * <[0m[35m/[0m[95mul[0m[39m>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * Invalid characters are replaced by one space character [0m[32m' '[0m[39m.[0m               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     * @param nameProposal can be any string, will be truncated if necessary,[0m    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     *        allowed to be null[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * @return a valid string, [0m[32m"empty"[0m[39m if to short, [0m[32m"null"[0m[39m if null[0m               [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    public static String [0m[1;35mcreateSafeSheetName[0m[1;39m([0m[39mfinal String nameProposal[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        return [0m[1;35mcreateSafeSheetName[0m[1;39m([0m[39mnameProposal, [0m[32m' '[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/ss/util/WorkbookUtil.jav[0m[1;92ma:67[0m[39m-[0m[1;36m101[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    public static String [0m[1;35mcreateSafeSheetName[0m[1;39m([0m[39mfinal String nameProposal, char [0m    [2m                [0m
[2;36m                    [0m         [39mreplaceChar[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        if [0m[1;39m([0m[39mnameProposal == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            return [0m[32m"null"[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        if [0m[1;39m([0m[1;35mnameProposal.length[0m[1;39m([0m[1;39m)[0m[39m < [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            return [0m[32m"empty"[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        final int length = [0m[1;35mMath.min[0m[1;39m([0m[1;36m31[0m[39m, [0m[1;35mnameProposal.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        final String shortenname = [0m[1;35mnameProposal.substring[0m[1;39m([0m[1;36m0[0m[39m, length[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final StringBuilder result = new [0m[1;35mStringBuilder[0m[1;39m([0m[39mshortenname[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        for [0m[1;39m([0m[39mint [0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            char ch = [0m[1;35mresult.charAt[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            switch [0m[1;39m([0m[39mch[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                case [0m[32m'\u0000'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                case [0m[32m'\u0003'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                case [0m[32m':'[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                case [0m[32m'/'[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                case '\\':[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                case [0m[32m'?'[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                case [0m[32m'*'[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                case [0m[32m'[0m[32m][0m[32m'[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                case [0m[32m'[0m[32m[[0m[32m'[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                    [0m[1;35mresult.setCharAt[0m[1;39m([0m[39mi, replaceChar[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                    break;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                case [0m[32m'\''[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                    if [0m[1;39m([0m[33mi[0m[39m==[0m[1;36m0[0m[39m || [0m[33mi[0m[39m==length-[0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                        [0m[1;35mresult.setCharAt[0m[1;39m([0m[39mi, replaceChar[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                    break;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                default:[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:                    [0m[35m/[0m[35m/[0m[39m all other chars OK[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        return [0m[1;35mresult.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/ss/util/WorkbookUtil.jav[0m[1;92ma:125[0m[39m-[0m[1;36m157[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    public static void [0m[1;35mvalidateSheetName[0m[1;39m([0m[39mString sheetName[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[39msheetName == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"sheetName must not be null"[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        int len = [0m[1;35msheetName.length[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        if [0m[1;39m([0m[39mlen < [0m[1;36m1[0m[39m || len > [0m[1;36m31[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"sheetName '"[0m[39m + sheetName[0m        [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                    + [0m[32m"' is invalid - character count MUST be greater than or [0m  [2m                [0m
[2;36m                    [0m         [32mequal to 1 and less than or equal to 31"[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        for [0m[1;39m([0m[39mint [0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<len; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            char ch = [0m[1;35msheetName.charAt[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            switch [0m[1;39m([0m[39mch[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                case [0m[32m'/'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                case '\\':[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                case [0m[32m'?'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                case [0m[32m'*'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:                case [0m[32m'[0m[32m][0m[32m'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:                case [0m[32m'[0m[32m[[0m[32m'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                case [0m[32m':'[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:                default:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                    [0m[35m/[0m[35m/[0m[39m all other chars OK[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                    continue;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Invalid char [0m[32m([0m[32m"[0m[39m + ch[0m            [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                    + [0m[32m"[0m[32m)[0m[32m found at index [0m[32m([0m[32m"[0m[39m + i + [0m[32m"[0m[32m)[0m[32m in sheet name '"[0m[39m + [0m         [2m                [0m
[2;36m                    [0m         [39msheetName + [0m[32m"'"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:        if [0m[1;39m([0m[1;35msheetName.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m == [0m[32m'\''[0m[39m || [0m[1;35msheetName.charAt[0m[1;39m([0m[39mlen-[0m[1;36m1[0m[1;39m)[0m[39m == [0m[32m'\''[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"Invalid sheet name '"[0m[39m + [0m        [2m                [0m
[2;36m                    [0m         [39msheetName[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                    + [0m[32m"'. Sheet names must not begin or end with [0m[32m([0m[32m'[0m[32m)[0m[32m."[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:99[0m[39m-[0m[1;36m122[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    public static void [0m[1;35mdump[0m[1;39m([0m[39mDirectoryEntry root, File parent[0m[1;39m)[0m[39m throws IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        [0m[1;35mfor[0m[1;39m([0m[39mIterator<Entry> it = [0m[1;35mroot.getEntries[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;35mit.hasNext[0m[1;39m([0m[1;39m)[0m[39m;[0m[1;39m)[0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Entry entry = [0m[1;35mit.next[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35mif[0m[1;39m([0m[39mentry instanceof DocumentNode[0m[1;39m)[0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                final DocumentNode node = [0m[1;39m([0m[39mDocumentNode[0m[1;39m)[0m[39m entry;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                final byte[0m[1;39m[[0m[1;39m][0m[39m bytes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                try [0m[1;39m([0m[39mDocumentInputStream is = new [0m[1;35mDocumentInputStream[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                   bytes = [0m[1;35mIOUtils.toByteArray[0m[1;39m([0m[39mis[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                try [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                    [0m[1;35mout.write[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mentry instanceof DirectoryEntry[0m[1;39m)[0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                DirectoryEntry dir = [0m[1;39m([0m[39mDirectoryEntry[0m[1;39m)[0m[39mentry;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                [0m[1;35mif[0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mfile[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mdir, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Skipping unsupported POIFS entry: "[0m[39m + [0m      [2m                [0m
[2;36m                    [0m         [39mentry[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/poifs/dev/POIFSDump.jav[0m[1;92ma:46[0m[39m-[0m[1;36m80[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public static void [0m[1;35mmain[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m args[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        if [0m[1;39m([0m[39margs.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            [0m[1;35mSystem.err.println[0m[1;39m([0m[32m"Must specify at least one file to dump"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        boolean dumpProps = false, dumpMini = false;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        for [0m[1;39m([0m[39mString filename : args[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            if [0m[1;39m([0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dumprops"[0m[1;39m)[0m[39m ||[0m                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-props"[0m[1;39m)[0m[39m ||[0m                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-properties"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:                dumpProps = true;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:                continue;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            if [0m[1;39m([0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dumpmini"[0m[1;39m)[0m[39m ||[0m                        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-mini"[0m[1;39m)[0m[39m ||[0m                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-ministream"[0m[1;39m)[0m[39m ||[0m             [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:                    [0m[1;35mfilename.equalsIgnoreCase[0m[1;39m([0m[32m"-dump-mini-stream"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:                dumpMini = true;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                continue;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                 POIFSFileSystem fs = new [0m[1;35mPOIFSFileSystem[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                DirectoryEntry root = [0m[1;35mfs.getRoot[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                String filenameWithoutPath = new [0m[1;35mFile[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                File dumpDir =[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                        [0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;35m.getParent[0m[1;39m([0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                                [0m[1;35m.resolve[0m[1;39m([0m[39mfilenameWithoutPath + [0m                  [2m                [0m
[2;36m                    [0m         [32m"_dump"[0m[1;39m)[0m[1;35m.toFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                File file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mfile.exists[0m[1;39m([0m[1;39m)[0m[39m && ![0m[1;35mfile.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Could not create directory "[0m[39m + file[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[1;35mdump[0m[1;39m([0m[39mroot, file[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/ss/util/WorkbookUtil.jav[0m[1;92ma:44[0m[39m-[0m[1;36m46[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    public static String [0m[1;35mcreateSafeSheetName[0m[1;39m([0m[39mfinal String nameProposal[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        return [0m[1;35mcreateSafeSheetName[0m[1;39m([0m[39mnameProposal, [0m[32m' '[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpoi/src/main/java/org/apache/poi/ss/util/WorkbookUtil.jav[0m[1;92ma:67[0m[39m-[0m[1;36m100[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    public static String [0m[1;35mcreateSafeSheetName[0m[1;39m([0m[39mfinal String nameProposal, char [0m    [2m                [0m
[2;36m                    [0m         [39mreplaceChar[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        if [0m[1;39m([0m[39mnameProposal == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            return [0m[32m"null"[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        if [0m[1;39m([0m[1;35mnameProposal.length[0m[1;39m([0m[1;39m)[0m[39m < [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            return [0m[32m"empty"[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        final int length = [0m[1;35mMath.min[0m[1;39m([0m[1;36m31[0m[39m, [0m[1;35mnameProposal.length[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        final String shortenname = [0m[1;35mnameProposal.substring[0m[1;39m([0m[1;36m0[0m[39m, length[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final StringBuilder result = new [0m[1;35mStringBuilder[0m[1;39m([0m[39mshortenname[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        for [0m[1;39m([0m[39mint [0m[33mi[0m[39m=[0m[1;36m0[0m[39m; i<length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            char ch = [0m[1;35mresult.charAt[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            switch [0m[1;39m([0m[39mch[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                case [0m[32m'\u0000'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                case [0m[32m'\u0003'[0m[39m:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                case [0m[32m':'[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                case [0m[32m'/'[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                case '\\':[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                case [0m[32m'?'[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                case [0m[32m'*'[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                case [0m[32m'[0m[32m][0m[32m'[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                case [0m[32m'[0m[32m[[0m[32m'[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                    [0m[1;35mresult.setCharAt[0m[1;39m([0m[39mi, replaceChar[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                    break;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                case [0m[32m'\''[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:                    if [0m[1;39m([0m[33mi[0m[39m==[0m[1;36m0[0m[39m || [0m[33mi[0m[39m==length-[0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                        [0m[1;35mresult.setCharAt[0m[1;39m([0m[39mi, replaceChar[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                    break;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                default:[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:                    [0m[35m/[0m[35m/[0m[39m all other chars OK[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        return [0m[1;35mresult.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis Summary[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause and developed a comprehensive fix strategy.[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause Analysis[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Direct vulnerability location**: `[0m[1;35mPOIFSDump.dump[0m[1;39m([0m[1;39m)[0m[39m` method at lines [0m[1;36m108[0m[39m and [0m   [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m uses `[0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[39m` directly in File constructor without sanitization[0m        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Attack vector**: Maliciously crafted POIFS files can contain [0m                  [2m                [0m
[2;36m                    [0m         [39mdirectory/document entry names with path traversal sequences [0m[1;39m([0m[39me.g., [0m                [2m                [0m
[2;36m                    [0m         [39m`..[0m[35m/../../../[0m[95mjazzer-traversal[0m[39m`[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Java File API behavior**: The `new [0m[1;35mFile[0m[1;39m([0m[39mparent, child[0m[1;39m)[0m[39m` constructor interprets[0m [2m                [0m
[2;36m                    [0m         [39mpath separators and `..` sequences in the child parameter, allowing escape from the[0m [2m                [0m
[2;36m                    [0m         [39mparent directory[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Missing validation**: The POIFS library [0m[1;39m([0m[39mProperty, DirectoryNode, Entry [0m       [2m                [0m
[2;36m                    [0m         [39mclasses[0m[1;39m)[0m[39m stores entry names exactly as they appear in OLE2 files without validation[0m [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Additional vulnerability**: Line [0m[1;36m75[0m[39m in `[0m[1;35mmain[0m[1;39m([0m[1;39m)[0m[39m` also uses `[0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[39m` [0m    [2m                [0m
[2;36m                    [0m         [39mwithout sanitization[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix Strategy[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1[0m[39m: Create a Path Sanitization Utility Method**[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd a private static method in `POIFSDump.java` [0m[1;39m([0m[39mafter line [0m[1;36m98[0m[39m, before the [0m[1;35mdump[0m[1;39m([0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mmethod[0m[1;39m)[0m[39m to sanitize entry names:[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[39m**[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m * Sanitizes an entry name to prevent path traversal attacks.[0m                       [2m                [0m
[2;36m                    [0m         [39m * Removes or replaces path separators, parent directory references,[0m                [2m                [0m
[2;36m                    [0m         [39m * and other potentially dangerous characters.[0m                                      [2m                [0m
[2;36m                    [0m         [39m * [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m * @param name the entry name to sanitize[0m                                           [2m                [0m
[2;36m                    [0m         [39m * @return a safe filename that cannot escape the parent directory[0m                  [2m                [0m
[2;36m                    [0m         [39m *[0m[35m/[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mprivate static String [0m[1;35msanitizeEntryName[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mname == null || [0m[1;35mname.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m        return [0m[32m"unnamed"[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Trim whitespace first[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    name = [0m[1;35mname.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mname.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [39m        return [0m[32m"unnamed"[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Build sanitized name by replacing dangerous characters[0m                       [2m                [0m
[2;36m                    [0m         [39m    StringBuilder result = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m    for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mname.length[0m[1;39m([0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m        char ch = [0m[1;35mname.charAt[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[35m/[0m[35m/[0m[39m Replace path separators, colons, and control characters[0m                  [2m                [0m
[2;36m                    [0m         [39m        if [0m[1;39m([0m[39mch == [0m[32m'/'[0m[39m || ch == [0m[32m'\\' || ch == '[0m[39m:' || ch < [0m[1;36m32[0m[39m || ch == [0m[1;36m127[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [39m            [0m[1;35mresult.append[0m[1;39m([0m[32m'_'[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m            [0m[1;35mresult.append[0m[1;39m([0m[39mch[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    String sanitized = [0m[1;35mresult.toString[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Remove any [0m[32m".."[0m[39m sequences that could enable path traversal[0m                   [2m                [0m
[2;36m                    [0m         [39m    while [0m[1;39m([0m[1;35msanitized.contains[0m[1;39m([0m[32m".."[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m        sanitized = [0m[1;35msanitized.replace[0m[1;39m([0m[32m".."[0m[39m, [0m[32m"__"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Ensure result is not empty after sanitization[0m                                [2m                [0m
[2;36m                    [0m         [39m    sanitized = [0m[1;35msanitized.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35msanitized.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        return [0m[32m"unnamed"[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    return sanitized;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m2[0m[39m: Apply Sanitization at Line [0m[1;36m108[0m[39m [0m[1;39m([0m[39mDocument Nodes[0m[1;39m)[0m[39m**[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace line [0m[1;36m108[0m[39m:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mtry [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m                     [2m                [0m
[2;36m                    [0m         [1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;35m.trim[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWith:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mtry [0m[1;39m([0m[39mOutputStream out = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m                     [2m                [0m
[2;36m                    [0m         [1;35msanitizeEntryName[0m[1;39m([0m[1;35mnode.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;35m.toPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m3[0m[39m: Apply Sanitization at Line [0m[1;36m113[0m[39m [0m[1;39m([0m[39mDirectory Nodes[0m[1;39m)[0m[39m**[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace line [0m[1;36m113[0m[39m:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mFile file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWith:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mFile file = new [0m[1;35mFile[0m[1;39m([0m[39mparent, [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m4[0m[39m: Apply Sanitization at Line [0m[1;36m75[0m[39m [0m[1;39m([0m[39mRoot Entry[0m[1;39m)[0m[39m**[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace line [0m[1;36m75[0m[39m in the [0m[1;35mmain[0m[1;39m([0m[1;39m)[0m[39m method:[0m                                               [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mFile file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWith:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mFile file = new [0m[1;35mFile[0m[1;39m([0m[39mdumpDir, [0m[1;35msanitizeEntryName[0m[1;39m([0m[1;35mroot.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Justification[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why This is the Optimal Approach:**[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Defense in Depth**: Sanitizes at all file creation points [0m[1;39m([0m[39mlines [0m[1;36m75[0m[39m, [0m[1;36m108[0m[39m, [0m[1;36m113[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Character-level replacement**: Prevents all path traversal vectors by [0m         [2m                [0m
[2;36m                    [0m         [39mreplacing dangerous characters rather than attempting regex-based detection[0m         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **User-friendly**: Allows dump operation to continue with sanitized names rather[0m [2m                [0m
[2;36m                    [0m         [39mthan failing completely[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Follows existing patterns**: Similar to `[0m[1;35mWorkbookUtil.createSafeSheetName[0m[1;39m([0m[1;39m)[0m[39m` [0m  [2m                [0m
[2;36m                    [0m         [39mapproach already in the codebase[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Comprehensive protection**: Handles:[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Path separators [0m[1;39m([0m[39m`[0m[35m/[0m[39m`, `\`[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - Parent directory references [0m[1;39m([0m[39m`..`[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - Drive letters on Windows [0m[1;39m([0m[39m`:`[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - Control characters that could cause issues[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **No breaking changes**: Only affects POIFSDump utility, doesn't modify core [0m    [2m                [0m
[2;36m                    [0m         [39mPOIFS APIs[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **Minimal code changes**: Single utility method with three call site [0m            [2m                [0m
[2;36m                    [0m         [39mmodifications[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Preserves Existing Logic:**[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The dump functionality continues to work exactly as before[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Entry traversal and recursion remain unchanged[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. File content extraction is unaffected[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Only the filename used for output is modified[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Legitimate entry names without dangerous characters remain unchanged[0m             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. The recursive structure and logic flow of [0m[1;35mdump[0m[1;39m([0m[1;39m)[0m[39m is preserved[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Addresses the Security Issue:**[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Eliminates path traversal**: Characters that enable directory traversal [0m[1;39m([0m[39m`[0m[35m/[0m[39m`, [0m [2m                [0m
[2;36m                    [0m         [39m`\`, `..`[0m[1;39m)[0m[39m are replaced[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Prevents escape**: Even with creative combinations, the sanitized name cannot [0m [2m                [0m
[2;36m                    [0m         [39mescape the parent directory[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Handles edge cases**: Empty names, null names, and names that become empty [0m    [2m                [0m
[2;36m                    [0m         [39mafter sanitization[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Defense at all levels**: Protects root entry creation and all recursive calls[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects and Mitigations:**[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Side effect**: Output filenames may differ from entry names in malicious files[0m [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: This is intentional and desired behavior; the alternative is a[0m [2m                [0m
[2;36m                    [0m         [39msecurity vulnerability[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Side effect**: Multiple entries with similar names [0m[1;39m([0m[39mdiffering only in [0m         [2m                [0m
[2;36m                    [0m         [39mdangerous characters[0m[1;39m)[0m[39m could collide[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: File system will handle overwrites; this is acceptable for a [0m  [2m                [0m
[2;36m                    [0m         [39mdiagnostic dump utility[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Side effect**: Diagnostic value may be slightly reduced if entry names are [0m    [2m                [0m
[2;36m                    [0m         [39mmodified[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: The dump still extracts all content; users can use POIFSLister[0m [2m                [0m
[2;36m                    [0m         [39mto see original names[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Similar Solutions in Codebase:**[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. `[0m[1;35mWorkbookUtil.createSafeSheetName[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m67[0m[39m-[0m[1;36m100[0m[1;39m)[0m[39m - Uses character replacement[0m [2m                [0m
[2;36m                    [0m         [39mapproach for sheet names[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Pattern of replacing invalid characters rather than rejecting entire inputs is [0m  [2m                [0m
[2;36m                    [0m         [39mestablished in POI[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Similar to test code at `TestEncryptor.jav[0m[1;92ma:417[0m[39m,[0m[1;36m420[0m[39m` which attempts sanitization[0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mthough incomplete[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Additional Considerations[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why Not Modify Core POIFS Classes:**[0m                                              [2m                [0m
[2;36m                    [0m         [39m- The POIFS library correctly represents the OLE2 file structure as-is[0m              [2m                [0m
[2;36m                    [0m         [39m- Other consumers of POIFS may need access to original entry names[0m                  [2m                [0m
[2;36m                    [0m         [39m- Sanitization should be the responsibility of code performing file system [0m         [2m                [0m
[2;36m                    [0m         [39moperations, not the data model layer[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why Not Use Existing Utilities:**[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mUtil.sanitizeFilename[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mxdgf package[0m[1;39m)[0m[39m is explicitly marked as not [0m             [2m                [0m
[2;36m                    [0m         [39msecurity-safe[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- `WorkbookUtil` is specific to sheet names with different requirements [0m[1;39m([0m[1;36m31[0m[39m char [0m   [2m                [0m
[2;36m                    [0m         [39mlimit[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m- A custom solution tailored to POIFSDump's needs is more appropriate[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why Not Use Path Validation:**[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Sanitization is more user-friendly than throwing exceptions[0m                       [2m                [0m
[2;36m                    [0m         [39m- POIFSDump is a utility tool where continuing operation is preferred[0m               [2m                [0m
[2;36m                    [0m         [39m- Replacement characters make it obvious that sanitization occurred[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=593787;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=938219;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=840889;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=950737;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp4zu3qu6_[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-poi_poi-full-01_vuln_2[0m [2m               [0m
[2;36m                    [0m         [35m/[0m[95magent-output-1768004187.6218665[0m                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-poi_poi-full-01_vuln_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-poi[0m              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/10/26 00:16:29][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mapache-poi[0m     ]8;id=294801;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=264930;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m[01/10/26 00:16:30][0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=674601;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=189449;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-poi[0m            [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=215398;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=974524;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-poi[0m             [2m               [0m
