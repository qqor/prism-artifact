[2;36m[01/10/26 04:04:36][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=439791;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=201857;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpn0qhqqgf[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/freerdp_fp-delta-01_vuln_001/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768017876.1693811[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/freerdp_fp-delta-01_vuln_001.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-freerdp[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m           ]8;id=397208;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=157671;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/10/26 04:05:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Building Cached for CLEAN environment[1m)[0m Took     ]8;id=222694;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=479900;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m31.79[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=399227;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=5463;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running tests for Cached for CLEAN environment[1m)[0m ]8;id=328366;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=532062;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=146842;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=615974;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m31[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=372872;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=990859;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 04:05:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.88[0m seconds;               ]8;id=513930;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=730435;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 04:05:09][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=648678;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=610937;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=558143;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=774156;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=478759;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=193040;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=100986;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=146082;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 04:05:10][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m1.04[0m seconds;               ]8;id=111261;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=7214;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 04:05:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=883477;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=653029;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.83[0m seconds;               ]8;id=976063;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=696459;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 04:05:14][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=69439;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=867656;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mTestFuzzCryptoCertificateDataSetPEM[0m                                        [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer TestFuzzCryptoCertificateDataSetPEM -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m   [2m                [0m
[2;36m                    [0m         [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3216302437[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m9103[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x560a40841af0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x560a40843e7f[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m9103[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x560a40843e80[0m[39m,[0m[1;36m0x560a40867770[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000010230[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x560a40502f4f[0m[39m bp [0m[1;36m0x7ffcf1996340[0m[39m sp [0m[1;36m0x7ffcf1996338[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x502000010230[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560a40502f4e[0m[39m in freerdp_bio_read_pem_with_policy [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560a40502f4e[0m[39m in freerdp_certificate_get_pem_ex [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1634:9[0m                                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560a404fa861[0m[39m in freerdp_certificate_data_load_cache [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m84:21[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560a404fa861[0m[39m in freerdp_certificate_data_new_nocopy [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m126:7[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560a404fabb9[0m[39m in freerdp_certificate_data_new_from_pem [0m                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m155:29[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560a404fa277[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;92m13:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x560a403b10f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x560a4039c365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x560a403a1dff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x560a403cd0a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7efc00c8f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x560a4039454d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM+0xcb54d[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certifica[0m [2m                [0m
[2;36m                    [0m         [39mte_data_load_cache[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x502000010230[0m[39m is a wild pointer inside of access range of size [0m            [2m                [0m
[2;36m                    [0m         [1;36m0x000000000001[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m[39m in [0m                            [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy[0m                                                    [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x50200000ff80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010000[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010080[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000010200[0m[39m: fa fa fa fa fa fa[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010400[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpr_i3qd_u[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mTestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mTestFuzzCryptoCertificateDataSetPEM[0m                                        [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer TestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3216302437[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m9103[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x560a40841af0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x560a40843e7f[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m9103[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x560a40843e80[0m[39m,[0m[1;36m0x560a40867770[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000010230[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x560a40502f4f[0m[39m bp [0m[1;36m0x7ffcf1996340[0m[39m sp [0m[1;36m0x7ffcf1996338[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x502000010230[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560a40502f4e[0m[39m in freerdp_bio_read_pem_with_policy [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560a40502f4e[0m[39m in freerdp_certificate_get_pem_ex [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1634:9[0m                                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560a404fa861[0m[39m in freerdp_certificate_data_load_cache [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m84:21[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560a404fa861[0m[39m in freerdp_certificate_data_new_nocopy [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m126:7[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560a404fabb9[0m[39m in freerdp_certificate_data_new_from_pem [0m                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m155:29[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560a404fa277[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;92m13:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x560a403b10f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x560a4039c365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x560a403a1dff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x560a403cd0a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7efc00c8f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x560a4039454d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM+0xcb54d[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certifica[0m [2m                [0m
[2;36m                    [0m         [39mte_data_load_cache[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x502000010230[0m[39m is a wild pointer inside of access range of size [0m            [2m                [0m
[2;36m                    [0m         [1;36m0x000000000001[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m[39m in [0m                            [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy[0m                                                    [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x50200000ff80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010000[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010080[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x502000010200[0m: fa fa fa fa fa fa[1m[[0mfa[1m][0mfa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010400[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000010480[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpr_i3qd_u[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         TestFuzzCryptoCertificateDataSetPEM -[33mruns[0m=[1;36m100[0m.                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 04:05:33][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=740777;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=94472;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 04:11:22][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=178965;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=377124;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/10/26 04:12:02][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=802443;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=175828;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=703370;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=807076;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 04:12:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.93[0m seconds;               ]8;id=856944;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=198986;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 04:12:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Started[33m...[0m                             ]8;id=928798;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=755240;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmptkb3tz0v[0m                                                 ]8;id=704171;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=233394;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/10/26 04:12:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Patching[1m)[0m Took [1;36m22.85[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=186985;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=564513;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Started[33m...[0m                       ]8;id=689016;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=946974;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 04:12:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Checking build[1m)[0m Took [1;36m12.66[0m seconds;             ]8;id=56403;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=230067;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Started[33m...[0m                          ]8;id=236458;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=633839;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 04:12:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Running PoV[1m)[0m Took [1;36m2.21[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=17753;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=733935;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Started[33m...[0m                              ]8;id=829288;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=329436;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=21713;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=984952;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=946777;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=475499;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 04:12:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.86[0m seconds;               ]8;id=967054;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=57509;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/10/26 04:12:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=330326;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=96552;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 04:12:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.96[0m seconds;               ]8;id=471093;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=994104;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Started[33m...[0m                        ]8;id=208771;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=226481;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/10/26 04:12:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mfreerdp Setting owner[1m)[0m Took [1;36m0.90[0m seconds;               ]8;id=333672;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=557224;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=891873;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=223291;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/libfreerdp/crypto/certificate.c                                               [2m                [0m
[2;36m                    [0m         +++ b/libfreerdp/crypto/certificate.c                                               [2m                [0m
[2;36m                    [0m         @@ [1;36m-1529[0m,[1;36m31[0m +[1;36m1529[0m,[1;36m29[0m @@                                                             [2m                [0m
[2;36m                    [0m          static BOOL [1;35mfreerdp_bio_read_pem_with_policy[0m[1m([0mBIO* bio, char** ppem, size_t*        [2m                [0m
[2;36m                    [0m         plength[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m          [1m{[0m                                                                                  [2m                [0m
[2;36m                    [0m                 BOOL rc = FALSE;                                                            [2m                [0m
[2;36m                    [0m         -       int status = [1;36m-1[0m;                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 [1;35mWINPR_ASSERT[0m[1m([0mbio[1m)[0m;                                                          [2m                [0m
[2;36m                    [0m                 [1;35mWINPR_ASSERT[0m[1m([0mppem[1m)[0m;                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -       const uint16_t blocksize = [1;36m2048[0m;                                            [2m                [0m
[2;36m                    [0m         -       uint16_t offset = [1;36m0[0m;                                                        [2m                [0m
[2;36m                    [0m         -       uint16_t length = blocksize;                                                [2m                [0m
[2;36m                    [0m         +       const size_t blocksize = [1;36m2048[0m;                                              [2m                [0m
[2;36m                    [0m         +       size_t offset = [1;36m0[0m;                                                          [2m                [0m
[2;36m                    [0m         +       size_t length = blocksize;                                                  [2m                [0m
[2;36m                    [0m                 char* pem = NULL;                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                 *ppem = NULL;                                                               [2m                [0m
[2;36m                    [0m                 if [1m([0mplength[1m)[0m                                                                [2m                [0m
[2;36m                    [0m                         *plength = [1;36m0[0m;                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -       while [1m([0mstatus != [1;36m0[0m[1m)[0m                                                         [2m                [0m
[2;36m                    [0m         +       while [1m([0moffset [1m<[0m[39m length[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-       [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39mconst int status = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - [0m      [2m                [0m
[2;36m                    [0m         [39moffset[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-1564[0m[39m,[0m[1;36m8[0m[39m +[0m[1;36m1562[0m[39m,[0m[1;36m9[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39mif [0m[1;39m([0m[39mlength - offset > [0m[1;36m0[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mTestFuzzCryptoCertificateDataSetPEM[0m                                        [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer TestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3216302437[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m9103[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x560a40841af0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x560a40843e7f[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m9103[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x560a40843e80[0m[39m,[0m[1;36m0x560a40867770[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000010230[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x560a40502f4f[0m[39m bp [0m[1;36m0x7ffcf1996340[0m[39m sp [0m[1;36m0x7ffcf1996338[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x502000010230[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560a40502f4e[0m[39m in freerdp_bio_read_pem_with_policy [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560a40502f4e[0m[39m in freerdp_certificate_get_pem_ex [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1634:9[0m                                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560a404fa861[0m[39m in freerdp_certificate_data_load_cache [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m84:21[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560a404fa861[0m[39m in freerdp_certificate_data_new_nocopy [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m126:7[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560a404fabb9[0m[39m in freerdp_certificate_data_new_from_pem [0m                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m155:29[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560a404fa277[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;92m13:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x560a403b10f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x560a4039c365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x560a403a1dff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x560a403cd0a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7efc00c8f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x560a4039454d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM+0xcb54d[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certifica[0m [2m                [0m
[2;36m                    [0m         [39mte_data_load_cache[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x502000010230[0m[39m is a wild pointer inside of access range of size [0m            [2m                [0m
[2;36m                    [0m         [1;36m0x000000000001[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m[39m in [0m                            [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy[0m                                                    [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x50200000ff80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010000[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010080[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000010200[0m[39m: fa fa fa fa fa fa[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010400[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpr_i3qd_u[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mTestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow vulnerability has been detected in the FreeRDP library [0m      [2m                [0m
[2;36m                    [0m         [39mduring fuzzing of the `TestFuzzCryptoCertificateDataSetPEM` component. The issue [0m   [2m                [0m
[2;36m                    [0m         [39mmanifests as a [0m[1;36m1[0m[39m-byte write operation beyond allocated heap memory boundaries at [0m   [2m                [0m
[2;36m                    [0m         [39maddress [0m[1;36m0x502000010230[0m[39m, with a scariness score of [0m[1;36m41[0m[39m, occurring in the [0m             [2m                [0m
[2;36m                    [0m         [39m`freerdp_bio_read_pem_with_policy` function within the certificate handling code.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is a heap-buffer-overflow vulnerability, specifically a [0m[1;36m1[0m[39m-byte write operation[0m [2m                [0m
[2;36m                    [0m         [39mthat occurs outside the bounds of an allocated heap buffer. According to [0m           [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer's analysis, the affected address [0m[1;39m([0m[1;36m0x502000010230[0m[1;39m)[0m[39m is classified as[0m [2m                [0m
[2;36m                    [0m         [39ma [0m[32m"wild pointer inside of access range"[0m[39m and the shadow byte analysis shows it's [0m    [2m                [0m
[2;36m                    [0m         [39mwriting to a heap left redzone area [0m[1;39m([0m[39mmarked as [0m[32m'fa'[0m[1;39m)[0m[39m.[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Call Stack Analysis[0m                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is triggered through the following execution path:[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Point**: `LLVMFuzzerTestOneInput` in [0m                                    [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;92m13:9[0m[39m`[0m      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Processing Chain**:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - `freerdp_certificate_data_new_from_pem` [0m[1;39m([0m[39mcertificate_data.[0m[1;92mc:155[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m   - `freerdp_certificate_data_new_nocopy` [0m[1;39m([0m[39mcertificate_data.[0m[1;92mc:126[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [39m   - `freerdp_certificate_data_load_cache` [0m[1;39m([0m[39mcertificate_data.[0m[1;92mc:84[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m   - `freerdp_certificate_get_pem_ex` [0m[1;39m([0m[39mcertificate.[0m[1;92mc:1634[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Failure Point**: `freerdp_bio_read_pem_with_policy` [0m[1;39m([0m[39mcertificate.[0m[1;92mc:1570[0m[1;39m)[0m[39m - [0m    [2m                [0m
[2;36m                    [0m         [39mwhere the actual overflow write occurs[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Important Observations[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Location**: The overflow occurs at line [0m[1;36m1570[0m[39m in [0m                               [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m` within the [0m                          [2m                [0m
[2;36m                    [0m         [39m`freerdp_bio_read_pem_with_policy` function.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Memory State**: The shadow byte analysis reveals that the target address [0m      [2m                [0m
[2;36m                    [0m         [1;36m0x502000010230[0m[39m is in a heap left redzone area, indicating the write is occurring in[0m [2m                [0m
[2;36m                    [0m         [39mmemory protection padding rather than in valid allocated space.[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Write Characteristics**: This is a single-byte write operation [0m[1;39m([0m[39msize [0m[1;36m1[0m[1;39m)[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39msuggesting it could be a string null-terminator, a single character write, or a [0m    [2m                [0m
[2;36m                    [0m         [39msimilar small-scale memory operation that's writing one byte past the intended [0m     [2m                [0m
[2;36m                    [0m         [39mbuffer boundary.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Fuzzing Context**: The issue was discovered during fuzzing with entropic power[0m [2m                [0m
[2;36m                    [0m         [39mschedule, processing PEM certificate data, which indicates the vulnerability is [0m    [2m                [0m
[2;36m                    [0m         [39mtriggered by specific input patterns in certificate data.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a holistic view of this vulnerability, the following codebase components [0m [2m                [0m
[2;36m                    [0m         [39mshould be examined:[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Primary Investigation Area**:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - `[0m[35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m` - Specifically the [0m             [2m                [0m
[2;36m                    [0m         [39m`freerdp_bio_read_pem_with_policy` function around line [0m[1;36m1570[0m                        [2m                [0m
[2;36m                    [0m         [39m   - The `freerdp_certificate_get_pem_ex` function at line [0m[1;36m1634[0m[39m which calls the [0m    [2m                [0m
[2;36m                    [0m         [39mvulnerable function[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Certificate Data Processing Chain**:[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - `[0m[35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m` - Functions involved in [0m   [2m                [0m
[2;36m                    [0m         [39mthe call chain:[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m     - `freerdp_certificate_data_load_cache` [0m[1;39m([0m[39mline [0m[1;36m84[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m     - `freerdp_certificate_data_new_nocopy` [0m[1;39m([0m[39mline [0m[1;36m126[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m     - `freerdp_certificate_data_new_from_pem` [0m[1;39m([0m[39mline [0m[1;36m155[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Buffer Management**:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - Memory allocation patterns in the certificate processing functions[0m             [2m                [0m
[2;36m                    [0m         [39m   - String handling and PEM parsing logic[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Buffer size calculations and boundary checks in the BIO [0m[1;39m([0m[39mBasic Input/Output[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mreading functions[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Input Validation**:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - PEM certificate data parsing and validation routines[0m                           [2m                [0m
[2;36m                    [0m         [39m   - Input size checks before memory operations[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Character-by-character processing logic in the certificate reading functions[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe deduplication token [0m                                                            [2m                [0m
[2;36m                    [0m         [32m"freerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certific[0m [2m                [0m
[2;36m                    [0m         [32mate_data_load_cache"[0m[39m suggests this is a known or repeatable issue pattern in the [0m   [2m                [0m
[2;36m                    [0m         [39mcertificate processing pipeline.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mTestFuzzCryptoCertificateDataSetPEM[0m                                        [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer TestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3216302437[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m9103[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x560a40841af0[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x560a40843e7f[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m9103[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m9103[0m[39m [0m[1;39m[[0m[1;36m0x560a40843e80[0m[39m,[0m[1;36m0x560a40867770[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m        [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x502000010230[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x560a40502f4f[0m[39m bp [0m[1;36m0x7ffcf1996340[0m[39m sp [0m[1;36m0x7ffcf1996338[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x502000010230[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m41[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow-far-from-bounds[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560a40502f4e[0m[39m in freerdp_bio_read_pem_with_policy [0m                          [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m                                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560a40502f4e[0m[39m in freerdp_certificate_get_pem_ex [0m                            [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1634:9[0m                                 [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560a404fa861[0m[39m in freerdp_certificate_data_load_cache [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m84:21[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560a404fa861[0m[39m in freerdp_certificate_data_new_nocopy [0m                       [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m126:7[0m                             [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560a404fabb9[0m[39m in freerdp_certificate_data_new_from_pem [0m                     [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate_data.c[0m[39m:[0m[1;92m155:29[0m                            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560a404fa277[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/core/test/[0m[95mTestFuzzCryptoCertificateDataSetPEM.c[0m[39m:[0m[1;92m13:9[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x560a403b10f0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x560a4039c365[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x560a403a1dff[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x560a403cd0a2[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x7efc00c8f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x560a4039454d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mTestFuzzCryptoCertificateDataSetPEM+0xcb54d[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy--freerdp_certificate_get_pem_ex--freerdp_certifica[0m [2m                [0m
[2;36m                    [0m         [39mte_data_load_cache[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mAddress [0m[1;36m0x502000010230[0m[39m is a wild pointer inside of access range of size [0m            [2m                [0m
[2;36m                    [0m         [1;36m0x000000000001[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m:[0m[1;92m1570:14[0m[39m in [0m                            [2m                [0m
[2;36m                    [0m         [39mfreerdp_bio_read_pem_with_policy[0m                                                    [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x50200000ff80[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010000[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010080[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000010200[0m[39m: fa fa fa fa fa fa[0m[1;39m[[0m[39mfa[0m[1;39m][0m[39mfa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010400[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000010480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpr_i3qd_u[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mTestFuzzCryptoCertificateDataSetPEM -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1529[0m[39m-[0m[1;36m1580[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:static BOOL [0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* [0m   [2m                [0m
[2;36m                    [0m         [39mplength[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:   [0m[39mint status = [0m[1;36m-1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:   [0m[39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:   [0m[39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:   [0m[39muint16_t length = blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:   [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1575:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1477[0m[39m-[0m[1;36m1527[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:static BOOL [0m[1;35mbio_read_pem[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* plength[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:   [0m[39mconst size_t blocksize = [0m[1;36m2048[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:   [0m[39msize_t offset = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:   [0m[39msize_t length = blocksize;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39moffset < length[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:   [0m[39m        [0m[39mconst int status = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - [0m      [2m                [0m
[2;36m                    [0m         [39moffset[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mlength - offset > [0m[1;36m0[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1522:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1587[0m[39m-[0m[1;36m1642[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1587:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mconst rdpCertificate* cert, size_t* [0m      [2m                [0m
[2;36m                    [0m         [39mpLength,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1588[0m[39m:                                     BOOL withCertChain[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1589[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1590[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1591[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!cert->x509[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:   [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:   [0m[39m * Don't manage certificates internally, leave it up entirely to the [0m       [2m                [0m
[2;36m                    [0m         [39mexternal client[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:   [0m[39m * implementation[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:   [0m[39mBIO* bio = [0m[1;35mBIO_new[0m[1;39m([0m[1;35mBIO_s_mem[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!bio[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1602[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1603[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"BIO_new[0m[32m([0m[32m)[0m[32m failure"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1604[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1605[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1606[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1607[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1608[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1609[0m[39m:   [0m[39mconst int status = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, cert->x509[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1610[0m[39m:   [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1611[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1612[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, status[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1613[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1614[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1615[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1616[0m[39m:   [0m[39mif [0m[1;39m([0m[39mcert->chain && withCertChain[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1617[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1618[0m[39m:   [0m[39m        [0m[39mconst int count = [0m[1;35msk_X509_num[0m[1;39m([0m[39mcert->chain[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1619[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39mint x = [0m[1;36m0[0m[39m; x < count; x++[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1620[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1621[0m[39m:   [0m[39m        [0m[39m        [0m[39mX509* c = [0m[1;35msk_X509_value[0m[1;39m([0m[39mcert->chain, x[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1622[0m[39m:   [0m[39m        [0m[39m        [0m[39mconst int rc = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, c[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mrc < [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mrc[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:   [0m[35m/[0m[35m/[0m[39m Updated rfc to handle specific policy issues[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:   [0m[35m/[0m[35m/[0m[39m [0m[4;94mhttps://datatracker.ietf.org/doc/html/rfc7299[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:   [0m[39mif [0m[1;39m([0m[39m [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mcert, [0m[32m"2.23.140.1.2.1"[0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mbio_read_pem[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1639:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:   [0m[1;35mBIO_free_all[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:   [0m[39mreturn pem;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1351[0m[39m-[0m[1;36m1380[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1351[0m[39m:int [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mconst rdpCertificate* cert, const char* oid[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1352[0m[39m:    [0m[1;35mSTACK_OF[0m[1;39m([0m[39mPOLICYINFO[0m[1;39m)[0m[39m *policies;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1353[0m[39m:   [0m[39mint result = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1354[0m[39m:    int crit;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1355[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1356[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!cert->x509[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1357[0m[39m:   [0m[39m        [0m[39mreturn result;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1358[0m[39m:   [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1359[0m[39m:    [0m[35m/[0m[35m/[0m[39m Get certificate policies[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1360[0m[39m:    policies = [0m[1;35mX509_get_ext_d2i[0m[1;39m([0m[39mcert->x509, NID_certificate_policies, &crit, [0m  [2m                [0m
[2;36m                    [0m         [39mNULL[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1361[0m[39m:    if [0m[1;39m([0m[39m!policies[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1362[0m[39m:        return result;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1363[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1364[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1365[0m[39m:    for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35msk_POLICYINFO_num[0m[1;39m([0m[39mpolicies[0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1366[0m[39m:        POLICYINFO *policy = [0m[1;35msk_POLICYINFO_value[0m[1;39m([0m[39mpolicies, i[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1367[0m[39m:        if [0m[1;39m([0m[39mpolicy->policyid[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1368[0m[39m:            char buf[0m[1;39m[[0m[1;36m128[0m[1;39m][0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1369[0m[39m:            [0m[1;35mOBJ_obj2txt[0m[1;39m([0m[39mbuf, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m, policy->policyid, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1370[0m[39m:            if [0m[1;39m([0m[39m [0m[1;35mstrncmp[0m[1;39m([0m[39mbuf, oid, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1371[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mresult = [0m[1;36m1[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1372[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1373[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1374[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1375[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1376[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:    [0m[1;35msk_POLICYINFO_pop_free[0m[1;39m([0m[39mpolicies, POLICYINFO_free[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1378[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1379[0m[39m:   [0m[39mreturn result;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1380[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:80[0m[39m-[0m[1;36m90[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_subject[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m        [0m[39mdata->cached_subject = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39msize_t pemlen = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39mdata->cached_pem = [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mdata->cert, &pemlen, [0m     [2m                [0m
[2;36m                    [0m         [39mFALSE[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_pem[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39msize_t pemchainlen = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mdata->cached_pem_chain = [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mdata->cert, [0m        [2m                [0m
[2;36m                    [0m         [39m&pemchainlen, TRUE[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_pem_chain[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:120[0m[39m-[0m[1;36m130[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[39mcertdata->hostname = [0m[1;35m_strdup[0m[1;39m([0m[39mhostname[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!certdata->hostname[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;35mensure_lowercase[0m[1;39m([0m[39mcertdata->hostname, [0m[1;35mstrlen[0m[1;39m([0m[39mcertdata->hostname[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    [0m[39mcertdata->cert = xcert;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[39mif [0m[1;39m([0m[39m![0m[1;35mfreerdp_certificate_data_load_cache[0m[1;39m([0m[39mcertdata[0m[1;39m)[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    [0m[39m        [0m[39mcertdata->cert = NULL;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:150[0m[39m-[0m[1;36m160[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!pem || [0m[1;39m([0m[39mlength == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[39mrdpCertificate* cert = [0m[1;35mfreerdp_certificate_new_from_pem[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mrdpCertificateData* data = [0m[1;35mfreerdp_certificate_data_new_nocopy[0m[1;39m([0m[39mhostname, [0m   [2m                [0m
[2;36m                    [0m         [39mport, cert[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39m        [0m[1;35mfreerdp_certificate_free[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mreturn data;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:60[0m[39m-[0m[1;36m100[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:static const char* [0m[1;35mfreerdp_certificate_data_hash_[0m[1;39m([0m[39mconst char* hostname, UINT16 [0m  [2m                [0m
[2;36m                    [0m         [39mport, char* name,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                                                  size_t length[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35m_snprintf[0m[1;39m([0m[39mname, length, [0m[32m"%s_%"[0m[39m PRIu16 [0m[32m".pem"[0m[39m, hostname, port[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     [0m[39mreturn [0m[1;35mensure_lowercase[0m[1;39m([0m[39mname, length[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:static BOOL [0m[1;35mfreerdp_certificate_data_load_cache[0m[1;39m([0m[39mrdpCertificateData* data[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[1;35mfreerdp_certificate_data_hash_[0m[1;39m([0m[39mdata->hostname, data->port, [0m                 [2m                [0m
[2;36m                    [0m         [39mdata->cached_hash,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39m                               [0m[1;35msizeof[0m[1;39m([0m[39mdata->cached_hash[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39mif [0m[1;39m([0m[1;35mstrnlen[0m[1;39m([0m[39mdata->cached_hash, [0m[1;35msizeof[0m[1;39m([0m[39mdata->cached_hash[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39mdata->cached_subject = [0m[1;35mfreerdp_certificate_get_subject[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_subject[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m        [0m[39mdata->cached_subject = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39msize_t pemlen = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39mdata->cached_pem = [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mdata->cert, &pemlen, [0m     [2m                [0m
[2;36m                    [0m         [39mFALSE[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_pem[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39msize_t pemchainlen = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mdata->cached_pem_chain = [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mdata->cert, [0m        [2m                [0m
[2;36m                    [0m         [39m&pemchainlen, TRUE[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_pem_chain[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39mdata->cached_fingerprint = [0m[1;35mfreerdp_certificate_get_fingerprint[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_fingerprint[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[39mdata->cached_issuer = [0m[1;35mfreerdp_certificate_get_issuer[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_issuer[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[39m        [0m[39mdata->cached_issuer = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/test/TestFuzzCryptoCertificateDataSetPEM.[0m[1;92mc:1[0m[39m-[0m[1;36m22[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include <stddef.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#include <stdint.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include <freerdp/crypto/certificate_store.h>[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:int [0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t* Data, size_t Size[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[1;39m{[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:      [0m[39mrdpCertificateData* data = NULL;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:      [0m[39mchar* pem = [0m[1;35mcalloc[0m[1;39m([0m[39mSize + [0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mchar[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:      [0m[39mif [0m[1;39m([0m[39mpem == NULL[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:     [0m[39m        [0m[39mgoto cleanup;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:     [0m[1;35mmemcpy[0m[1;39m([0m[39mpem, Data, Size[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:     [0m[39mdata = [0m[1;35mfreerdp_certificate_data_new_from_pem[0m[1;39m([0m[32m"somehost"[0m[39m, [0m[1;36m1234[0m[39m, pem, Size[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:     [0m[39m        [0m[39mgoto cleanup;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m17:c[0m[39mleanup:[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:     [0m[1;35mfreerdp_certificate_data_free[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:     [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:     [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:84[0m[39m-[0m[1;36m94[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39mUINT32 count;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mrdpCertBlob* array;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:typedef struct rdp_X509CertChain rdpX509CertChain;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:struct rdp_certificate[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39mX509* x509;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[1;35mSTACK_OF[0m[1;39m([0m[39mX509[0m[1;39m)[0m[39m * chain;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39mrdpCertInfo cert_info;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:37[0m[39m-[0m[1;36m42[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:struct rdp_certificate_data[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     [0m[39mchar* hostname;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     [0m[39mUINT16 port;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[39mrdpCertificate* cert;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:50[0m[39m-[0m[1;36m100[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:#include <openssl/x509.h>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#include [0m[32m"certificate.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#include [0m[32m"cert_common.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:#include [0m[32m"crypto.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:#include [0m[32m"x509_utils.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:#include [0m[32m"privatekey.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:#include [0m[32m"opensslcompat.h"[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:#define TAG [0m[1;35mFREERDP_TAG[0m[1;39m([0m[32m"core"[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:#ifdef WITH_DEBUG_CERTIFICATE[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:#define CERTIFICATE_TAG [0m[1;35mFREERDP_TAG[0m[1;39m([0m[32m"core.certificate"[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:#define [0m[1;35mDEBUG_CERTIFICATE[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m [0m[1;35mWLog_DBG[0m[1;39m([0m[39mTAG, __VA_ARGS__[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:#define [0m[1;35mDEBUG_CERTIFICATE[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m \[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     [0m[39mdo                         \[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     [0m[1;39m{[0m[39m                          \[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[1;39m}[0m[39m while [0m[1;39m([0m[1;36m0[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:#define TSSK_KEY_LENGTH [0m[1;36m64[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:struct rdp_CertBlob[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39mUINT32 length;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39mBYTE* data;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:typedef struct rdp_CertBlob rdpCertBlob;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:struct rdp_X509CertChain[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39mUINT32 count;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mrdpCertBlob* array;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:typedef struct rdp_X509CertChain rdpX509CertChain;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:struct rdp_certificate[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39mX509* x509;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     [0m[1;35mSTACK_OF[0m[1;39m([0m[39mX509[0m[1;39m)[0m[39m * chain;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39mrdpCertInfo cert_info;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     [0m[39mrdpX509CertChain x509_cert_chain;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m: * X.[0m[1;36m509[0m[39m Certificate Structure[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1529[0m[39m-[0m[1;36m1580[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:static BOOL [0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* [0m   [2m                [0m
[2;36m                    [0m         [39mplength[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:   [0m[39mint status = [0m[1;36m-1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:   [0m[39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:   [0m[39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:   [0m[39muint16_t length = blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:   [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1575:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1477[0m[39m-[0m[1;36m1527[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:static BOOL [0m[1;35mbio_read_pem[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* plength[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:   [0m[39mconst size_t blocksize = [0m[1;36m2048[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:   [0m[39msize_t offset = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:   [0m[39msize_t length = blocksize;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39moffset < length[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:   [0m[39m        [0m[39mconst int status = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - [0m      [2m                [0m
[2;36m                    [0m         [39moffset[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mlength - offset > [0m[1;36m0[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1522:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1529[0m[39m-[0m[1;36m1580[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:static BOOL [0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* [0m   [2m                [0m
[2;36m                    [0m         [39mplength[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:   [0m[39mint status = [0m[1;36m-1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:   [0m[39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:   [0m[39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:   [0m[39muint16_t length = blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:   [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1575:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1477[0m[39m-[0m[1;36m1527[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:static BOOL [0m[1;35mbio_read_pem[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* plength[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:   [0m[39mconst size_t blocksize = [0m[1;36m2048[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:   [0m[39msize_t offset = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:   [0m[39msize_t length = blocksize;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39moffset < length[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:   [0m[39m        [0m[39mconst int status = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - [0m      [2m                [0m
[2;36m                    [0m         [39moffset[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mlength - offset > [0m[1;36m0[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1522:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1582[0m[39m-[0m[1;36m1585[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1582:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_pem[0m[1;39m([0m[39mconst rdpCertificate* cert, size_t* pLength[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;36m1583[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1584[0m[39m:   [0m[39mreturn [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mcert, pLength, TRUE[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1585[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1630[0m[39m-[0m[1;36m1642[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:   [0m[35m/[0m[35m/[0m[39m Updated rfc to handle specific policy issues[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:   [0m[35m/[0m[35m/[0m[39m [0m[4;94mhttps://datatracker.ietf.org/doc/html/rfc7299[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:   [0m[39mif [0m[1;39m([0m[39m [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mcert, [0m[32m"2.23.140.1.2.1"[0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mbio_read_pem[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1639:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:   [0m[1;35mBIO_free_all[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:   [0m[39mreturn pem;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1587[0m[39m-[0m[1;36m1642[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1587:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mconst rdpCertificate* cert, size_t* [0m      [2m                [0m
[2;36m                    [0m         [39mpLength,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1588[0m[39m:                                     BOOL withCertChain[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1589[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1590[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1591[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!cert->x509[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:   [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:   [0m[39m * Don't manage certificates internally, leave it up entirely to the [0m       [2m                [0m
[2;36m                    [0m         [39mexternal client[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:   [0m[39m * implementation[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:   [0m[39mBIO* bio = [0m[1;35mBIO_new[0m[1;39m([0m[1;35mBIO_s_mem[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!bio[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1602[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1603[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"BIO_new[0m[32m([0m[32m)[0m[32m failure"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1604[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1605[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1606[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1607[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1608[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1609[0m[39m:   [0m[39mconst int status = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, cert->x509[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1610[0m[39m:   [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1611[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1612[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, status[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1613[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1614[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1615[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1616[0m[39m:   [0m[39mif [0m[1;39m([0m[39mcert->chain && withCertChain[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1617[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1618[0m[39m:   [0m[39m        [0m[39mconst int count = [0m[1;35msk_X509_num[0m[1;39m([0m[39mcert->chain[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1619[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39mint x = [0m[1;36m0[0m[39m; x < count; x++[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1620[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1621[0m[39m:   [0m[39m        [0m[39m        [0m[39mX509* c = [0m[1;35msk_X509_value[0m[1;39m([0m[39mcert->chain, x[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1622[0m[39m:   [0m[39m        [0m[39m        [0m[39mconst int rc = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, c[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mrc < [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mrc[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:   [0m[35m/[0m[35m/[0m[39m Updated rfc to handle specific policy issues[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:   [0m[35m/[0m[35m/[0m[39m [0m[4;94mhttps://datatracker.ietf.org/doc/html/rfc7299[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:   [0m[39mif [0m[1;39m([0m[39m [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mcert, [0m[32m"2.23.140.1.2.1"[0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mbio_read_pem[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1639:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:   [0m[1;35mBIO_free_all[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:   [0m[39mreturn pem;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/test/CMakeLists.txt:[0m[1;36m1[0m[39m-[0m[1;36m43[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[1;35mset[0m[1;39m([0m[39mMODULE_NAME [0m[32m"TestCore"[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m[1;35mset[0m[1;39m([0m[39mMODULE_PREFIX [0m[32m"TEST_CORE"[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m4:d[0m[1;35misable_warnings_for_directory[0m[1;39m([0m[39m$[0m[1;39m{[0m[39mCMAKE_CURRENT_BINARY_DIR[0m[1;39m}[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[1;35mset[0m[1;39m([0m[39mDRIVER $[0m[1;39m{[0m[39mMODULE_NAME[0m[1;39m}[0m[39m.c[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m[1;35mset[0m[1;39m([0m[39mTESTS TestVersion.c TestSettings.c[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m[1;35mif[0m[1;39m([0m[39mBUILD_TESTING_INTERNAL[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:  [0m[1;35mlist[0m[1;39m([0m[39mAPPEND TESTS TestStreamDump.c[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;92m12:e[0m[1;35mndif[0m[1;39m([0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m[1;35mset[0m[1;39m([0m[39mFUZZERS TestFuzzCoreClient.c TestFuzzCoreServer.c [0m                           [2m                [0m
[2;36m                    [0m         [39mTestFuzzCryptoCertificateDataSetPEM.c[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:# Test not compatible with package tests, disable[0m                                [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m[1;35mif[0m[1;39m([0m[39mWITH_SAMPLE AND WITH_SERVER AND NOT WIN32 AND BUILD_TESTING_INTERNAL[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  [0m[1;35madd_compile_definitions[0m[1;39m([0m[33mCMAKE_EXECUTABLE_SUFFIX[0m[39m=[0m[32m"$[0m[32m{[0m[32mCMAKE_EXECUTABLE_SUFFIX[0m[32m}[0m[32m"[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  [0m[1;35mset[0m[1;39m([0m[39mTESTS $[0m[1;39m{[0m[39mTESTS[0m[1;39m}[0m[39m TestConnect.c[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;92m20:e[0m[1;35mlse[0m[1;39m([0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  [0m[1;35mmessage[0m[1;39m([0m[32m"Skipping connection tests, requires BUILD_TESTING_INTERNAL, [0m          [2m                [0m
[2;36m                    [0m         [32mWITH_SAMPLE and WITH_SERVER set!"[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;92m22:e[0m[1;35mndif[0m[1;39m([0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m24:c[0m[1;35mreate_test_sourcelist[0m[1;39m([0m[39mSRCS $[0m[1;39m{[0m[39mDRIVER[0m[1;39m}[0m[39m $[0m[1;39m{[0m[39mTESTS[0m[1;39m}[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m26:add[0m[1;35m_executable[0m[1;39m([0m[39m$[0m[1;39m{[0m[39mMODULE_NAME[0m[1;39m}[0m[39m $[0m[1;39m{[0m[39mSRCS[0m[1;39m}[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m28:add[0m[1;35m_compile_definitions[0m[1;39m([0m[33mTESTING_OUT[0m[1;33mPUT[0m[33m_DIRECTORY[0m[39m=[0m[32m"$[0m[32m{[0m[32mPROJECT_BINARY_DIR[0m[32m}[0m[32m"[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;92m29:add[0m[1;35m_compile_definitions[0m[1;39m([0m[33mTESTING_SRC_DIRECTORY[0m[39m=[0m[32m"$[0m[32m{[0m[32mPROJECT_SOURCE_DIR[0m[32m}[0m[32m"[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m[1;35mtarget_link_libraries[0m[1;39m([0m[39m$[0m[1;39m{[0m[39mMODULE_NAME[0m[1;39m}[0m[39m freerdp winpr freerdp-client[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m[1;35minclude[0m[1;39m([0m[39mAddFuzzerTest[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m34:add[0m[1;35m_fuzzer_test[0m[1;39m([0m[32m"$[0m[32m{[0m[32mFUZZERS[0m[32m}[0m[32m"[0m[39m [0m[32m"freerdp-client freerdp winpr"[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m[1;35mset_target_properties[0m[1;39m([0m[39m$[0m[1;39m{[0m[39mMODULE_NAME[0m[1;39m}[0m[39m PROPERTIES RUNTIME_OUT[0m[1;33mPUT[0m[39m_DIRECTORY [0m        [2m                [0m
[2;36m                    [0m         [32m"$[0m[32m{[0m[32mTESTING_OUT[0m[1;33mPUT[0m[32m_DIRECTORY[0m[32m}[0m[32m"[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m38:f[0m[1;35moreach[0m[1;39m([0m[39mtest $[0m[1;39m{[0m[39mTESTS[0m[1;39m}[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:  [0m[1;35mget_filename_component[0m[1;39m([0m[39mTestName $[0m[1;39m{[0m[39mtest[0m[1;39m}[0m[39m NAME_WE[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:  [0m[1;35madd_test[0m[1;39m([0m[39m$[0m[1;39m{[0m[39mTestName[0m[1;39m}[0m[39m $[0m[1;39m{[0m[39mTESTING_OUT[0m[1;33mPUT[0m[39m_DIRECTORY[0m[1;39m}[0m[35m/[0m[39m$[0m[1;39m{[0m[39mMODULE_NAME[0m[1;39m}[0m[39m $[0m[1;39m{[0m[39mTestName[0m[1;39m}[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;92m41:e[0m[1;35mndforeach[0m[1;39m([0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m[1;35mset_property[0m[1;39m([0m[39mTAR[0m[1;33mGET[0m[39m $[0m[1;39m{[0m[39mMODULE_NAME[0m[1;39m}[0m[39m PROPERTY FOLDER [0m[32m"FreeRDP/Core/Test"[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39minclude/freerdp/crypto/certificate.h:[0m[1;36m73[0m[39m-[0m[1;36m90[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_pem[0m[1;39m([0m[39mconst rdpCertificate* [0m        [2m                [0m
[2;36m                    [0m         [39mcertificate,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39m                                              size_t* pLength[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39mFREERDP_API int [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mconst rdpCertificate* [0m         [2m                [0m
[2;36m                    [0m         [39mcertificate,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     [0m[39m                                              const char* oid[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39m * @brief Get the certificate as PEM string[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m * @param certificate A certificate instance to query[0m                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     [0m[39m * @param pLength A pointer to the size in bytes of the PEM string[0m          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39m * @param withCertChain \b TRUE to export a full chain PEM, \b FALSE for [0m   [2m                [0m
[2;36m                    [0m         [39monly the last[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39m * certificate in the chain[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39m * @return A newly allocated string containing the requested PEM [0m[1;39m([0m[39mfree to [0m  [2m                [0m
[2;36m                    [0m         [39mdeallocate[0m[1;39m)[0m[39m or NULL[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m * @since version [0m[1;36m3.8[0m[39m.[0m[1;36m0[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:     [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[1;35mWINPR_ATTR_MALLOC[0m[1;39m([0m[39mfree, [0m[1;36m1[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mFREERDP_API char* [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mconst rdpCertificate* [0m     [2m                [0m
[2;36m                    [0m         [39mcertificate,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39m                                                 size_t* pLength, BOOL [0m     [2m                [0m
[2;36m                    [0m         [39mwithCertChain[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/test/Test_x509_cert_info.pem:[0m[1;36m1[0m[39m-[0m[1;36m41[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:-----BEGIN CERTIFICATE-----[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:MIIHNzCCBR+gAwIBAgICEAAwDQYJKoZIhvcNAQEFBQAwcDEqMCgGA1UEAwwhQURN[0m                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:SU5JU1RSQVRJT04gQ0VOVFJBTEUgREVTIFRFU1RTMQswCQYDVQQGEwJGUjEcMBoG[0m                  [2m                [0m
[2;36m                    [0m         [1;92m4:A1[0m[39mUECgwTTUlOSVNURVJFIERFUyBURVNUUzEXMBUGA1UECwwOMDAwMiAxMTAwMTQw[0m                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:MTYwHhcNMTgwNTE4MDkyNTU1WhcNMTkwNTEzMDkyNTU1WjCBvzEkMCIGA1UEAwwb[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:VEVTVEpFQU4gVEVTVE1BUlRJTiA5OTk5OTk5MQswCQYDVQQGEwJGUjEcMBoGA1UE[0m                  [2m                [0m
[2;36m                    [0m         [1;92m7:C[0m[39mgwTTUlOSVNURVJFIERFUyBURVNUUzEXMBUGA1UECwwOMDAwMiAxMTAwMTQwMTYx[0m                  [2m                [0m
[2;36m                    [0m         [1;92m8:E[0m[39mjAQBgNVBAsMCVBFUlNPTk5FUzEXMBUGCgmSJomT8ixkAQEMBzk5OTk5OTkxETAP[0m                  [2m                [0m
[2;36m                    [0m         [1;92m9:B[0m[39mgNVBCoMCFRFU1RKRUFOMRMwEQYDVQQEDApURVNUTUFSVElOMIICIjANBgkqhkiG[0m                  [2m                [0m
[2;36m                    [0m         [1;92m10:9[0m[39mw0BAQEFAAOCAg8AMIICCgKCAgEA3yc22RDYc+Vc6F26/LONvaYkdTVDiCgbh9Ik[0m                 [2m                [0m
[2;36m                    [0m         [1;92m11:6[0m[39mpLF5izNpfdQ/YZU25h/UPECdchYX31UEErVOYudOBOHtU4fNjTO0oK5Va/DoFln[0m                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:LnfwNpAlBZfogG+yy8fK4yLxG+raoSKDR/5P3hmTqKJqw1WpkwcVE2EDqkP1clMZ[0m                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:L5cvJj6gLJa2q0JCdoKe7NntZkgpIk5ZHUZm2JYC3[0m[1;36m0x[0m[39mL7XHfvvb/i0OZLpPOIekT[0m                 [2m                [0m
[2;36m                    [0m         [1;92m14:DC[0m[39mzxr9HTjbqe+BRZix2UiGpXzjIlDm6EEQNebZqf5kKgcbkxIDWcVraE0kO3TqJI[0m                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:P4FBUeuxLqGwQ0AMKrZ+j8U7KAoM9WUoIFcmm8nYGo4hT6ugNIQ9nwQSgyH3yGH1[0m                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:PU2k12Ovv2Ft8C/IFuusXxTOJprcFxtjE7qYZ44tmvlozlDOBOJYjLiURAh3r5LL[0m                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:TadgArZ3XVMyWlwlTEy9qX59izY9Zz27kd5H11DOz5ezopHAWwP6sgCvWeNDyx8Q[0m                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:I3jY8TYzJHahN2bknP2fqwwdGqFCrHItJx2DhDe2ruTk6vvbnwGgYqGzv+RtdNbW[0m                 [2m                [0m
[2;36m                    [0m         [1;92m19:C[0m[39mL4IMEQQKG9AM40WCz9pu32/vOaQ+hrYyCQMCtli0DSauB+K2IFPsAcz5OAaITJv[0m                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:LenMt8mUP9NWHWfr5WYm0tuUCCU4dUT38MqkkdQv7oly1LHkvUdMU+Nk/Ki0Q83U[0m                 [2m                [0m
[2;36m                    [0m         [1;92m21:9[0m[39mgMvaPcCAwEAAaOCAYkwggGFMAwGA1UdEwEB/wQCMAAwDgYDVR0PAQH/BAQDAgXg[0m                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:MDIGA1UdJQQrMCkGCCsGAQUFBwMCBggrBgEFBQcDBAYKKwYBBAGCNxQCAgYHKwYB[0m                 [2m                [0m
[2;36m                    [0m         [1;92m23:B[0m[39mQIDBDAdBgNVHQ4EFgQUXs4RKN+vUVsZjEW/J6qo6EZTLZUwHwYDVR0jBBgwFoAU[0m                 [2m                [0m
[2;36m                    [0m         [1;92m24:f[0m[39mUXj4k7OA3d8KylcprhMptiOL10wgbIGA1UdEQSBqjCBp6A9BgYrBgEFAgKgMzAx[0m                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:oBYbFGtwbi50ZXN0LmV4YW1wbGUuY29toRcwFRsTdGVzdGplYW4udGVzdG1hcnRp[0m                 [2m                [0m
[2;36m                    [0m         [1;92m26:b[0m[39mqBABgorBgEEAYI3FAIDoDIMMHRlc3RqZWFuLnRlc3RtYXJ0aW4uOTk5OTk5OUB1[0m                 [2m                [0m
[2;36m                    [0m         [1;92m27:c[0m[39mG4udGVzdC5leGFtcGxlLmNvbYEkdGVzdGplYW4udGVzdG1hcnRpbkB0ZXN0LmV4[0m                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:YW1wbGUuY29tMDEGA1UdEgQqMCiCEnJvb3RjYS5leGFtcGxlLmNvbYISaW50ZWNh[0m                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:LmV4YW1wbGUuY29tMAkGA1UdIAQCMAAwDQYJKoZIhvcNAQEFBQADggIBAKRDovf+[0m                 [2m                [0m
[2;36m                    [0m         [1;92m30:CC[0m[39mnV2mtXnzH5JlduOjPWJmGB5a8HLPvakfAm4wQ0YyAViE1tar0V9lhG6nCogWWa[0m                 [2m                [0m
[2;36m                    [0m         [1;92m31:28D[0m[39m+eM5vLPjVE8ebq5UjIv76x6gWoJkQ3HtfVJvn9UfXwax6IqT7hb1fAHBqu0rj[0m                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:uSnSxf1wIzPMp9Lb5x3jBu9ryNMiLUzeY1slBvosOXKlmprPhGWfPYYNCZo2bGJI[0m                 [2m                [0m
[2;36m                    [0m         [1;92m33:1[0m[39mw5alGDgTBcWKl7icJjAIuCpyRTnKCsaN3kyDU7C5aUhsm9AriPiNErzRI+l5+eu[0m                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:Ywg3MZ7Yfjd3rXb6JleT0ZnCh/nFtVLIccWaI4phCrYTGz6odNIqrZ6X23Pt6Rx3[0m                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:ZbQjtj4ipMdvbvJbS90aFMrTyfqhVLOxHy+setDcmPOixUgXlx8ZjFI9vgFUeJbo[0m                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:OKrkLw4ITUduO+9MplBX7Kt/iCS/CbTfPlHMv03Xb6rbjqHxTJZCCu5QMNHiBeHV[0m                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:l8FK5R6gv+9FuCl8uPHwGh/jelQp51cVORlQWeKpqWdwTi0Q3VeVeQAG5RR34xgT[0m                 [2m                [0m
[2;36m                    [0m         [1;92m38:c[0m[39mQa8h9AqkxYajhxKUmbUlaoYGd8TwUQLrS2jZxp/9geyApVQLAQ27CyAK5HyHSCA[0m                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:uqCKsM0gFQyCL4IbXQyFMWgjXZYaorHFjVuMhYEkgWui/9sv+7sMAV5JzROeAw3l[0m                 [2m                [0m
[2;36m                    [0m         [1;92m40:4[0m[39m+D7yhywwuRzH2SzoavzGpWGMUveVsdLMRk9[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:-----END CERTIFICATE-----[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/test/Test_x509_utils.[0m[1;92mc:1[0m[39m-[0m[1;36m50[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include <winpr/file.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#include <winpr/string.h>[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include [0m[32m"../x509_utils.h"[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:typedef char* [0m[1;39m([0m[39m*get_field_pr[0m[1;39m)[0m[1;39m([0m[39mconst X509*[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:typedef struct[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m[1;39m{[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:      [0m[39menum[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:      [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:     [0m[39m        [0m[39mDISABLED,[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:     [0m[39m        [0m[39mENABLED,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:     [0m[1;39m}[0m[39m status;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:     [0m[39mconst char* field_description;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:     [0m[39mget_field_pr get_field;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:     [0m[39mconst char* expected_result;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m[1;39m}[0m[39m certificate_test_t;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:static char* [0m[1;35mx509_utils_subject_common_name_wo_length[0m[1;39m([0m[39mconst X509* xcert[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:     [0m[39msize_t length = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:     [0m[39mreturn [0m[1;35mx509_utils_get_common_name[0m[1;39m([0m[39mxcert, &length[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:static char* [0m[1;35mcertificate_path[0m[1;39m([0m[39mconst char* filename[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:     [0m[35m/[0m[39m*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:     [0m[39mAssume the .pem file is in the same directory as this source file.[0m          [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:     [0m[39mAssume that __FILE__ will be a valid path to this file, even from the [0m      [2m                [0m
[2;36m                    [0m         [39mcurrent working directory[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:     [0m[39mwhere the tests are run. [0m[1;39m([0m[39mie. no chdir occurs between compilation and test [0m [2m                [0m
[2;36m                    [0m         [39mrunning, or __FILE__[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     [0m[39mis an absolute path[0m[1;39m)[0m[39m.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     [0m[39m*[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     [0m[39mstatic const char dirsep = [0m[32m'/'[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#ifdef TEST_SOURCE_DIR[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     [0m[39mconst char* file = TEST_SOURCE_DIR;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     [0m[39mconst size_t flen = [0m[1;35mstrlen[0m[1;39m([0m[39mfile[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mdirsep[0m[1;39m)[0m[39m + [0m[1;35mstrlen[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[39m + [0m     [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39mchar[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     [0m[39mchar* result = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, flen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!result[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35m_snprintf[0m[1;39m([0m[39mresult, flen, [0m[32m"%s%c%s"[0m[39m, file, dirsep, filename[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     [0m[39mreturn result;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     [0m[39mconst char* file = __FILE__;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     [0m[39mconst char* last_dirsep = [0m[1;35mstrrchr[0m[1;39m([0m[39mfile, dirsep[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     [0m[39mif [0m[1;39m([0m[39mlast_dirsep[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     [0m[39m        [0m[39mconst size_t filenameLen = [0m[1;35mstrlen[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     [0m[39m        [0m[39mconst size_t dirsepLen = last_dirsep - file + [0m[1;36m1[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     [0m[39m        [0m[39mchar* result = [0m[1;35mmalloc[0m[1;39m([0m[39mdirsepLen + filenameLen + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     [0m[39m        [0m[39mif [0m[1;39m([0m[39m!result[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1529[0m[39m-[0m[1;36m1580[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:static BOOL [0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* [0m   [2m                [0m
[2;36m                    [0m         [39mplength[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:   [0m[39mint status = [0m[1;36m-1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:   [0m[39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:   [0m[39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:   [0m[39muint16_t length = blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:   [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1575:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1477[0m[39m-[0m[1;36m1527[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:static BOOL [0m[1;35mbio_read_pem[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* plength[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:   [0m[39mconst size_t blocksize = [0m[1;36m2048[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:   [0m[39msize_t offset = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:   [0m[39msize_t length = blocksize;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39moffset < length[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:   [0m[39m        [0m[39mconst int status = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - [0m      [2m                [0m
[2;36m                    [0m         [39moffset[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mlength - offset > [0m[1;36m0[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1522:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1529[0m[39m-[0m[1;36m1580[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:static BOOL [0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* [0m   [2m                [0m
[2;36m                    [0m         [39mplength[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:   [0m[39mint status = [0m[1;36m-1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:   [0m[39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:   [0m[39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:   [0m[39muint16_t length = blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:   [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1575:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:140[0m[39m-[0m[1;36m160[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    [0m[39mrdpCertificate* copy = [0m[1;35mfreerdp_certificate_clone[0m[1;39m([0m[39mxcert[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[39mrdpCertificateData* data = [0m[1;35mfreerdp_certificate_data_new_nocopy[0m[1;39m([0m[39mhostname, [0m   [2m                [0m
[2;36m                    [0m         [39mport, copy[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[39m        [0m[1;35mfreerdp_certificate_free[0m[1;39m([0m[39mcopy[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[39mreturn data;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:rdpCertificateData* [0m[1;35mfreerdp_certificate_data_new_from_pem[0m[1;39m([0m[39mconst char* hostname,[0m [2m                [0m
[2;36m                    [0m         [39mUINT16 port,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                                                          const char* pem, [0m     [2m                [0m
[2;36m                    [0m         [39msize_t length[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!pem || [0m[1;39m([0m[39mlength == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[39mrdpCertificate* cert = [0m[1;35mfreerdp_certificate_new_from_pem[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:    [0m[39mrdpCertificateData* data = [0m[1;35mfreerdp_certificate_data_new_nocopy[0m[1;39m([0m[39mhostname, [0m   [2m                [0m
[2;36m                    [0m         [39mport, cert[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[39mif [0m[1;39m([0m[39m!data[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:    [0m[39m        [0m[1;35mfreerdp_certificate_free[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:    [0m[39mreturn data;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/core/test/TestFuzzCryptoCertificateDataSetPEM.[0m[1;92mc:1[0m[39m-[0m[1;36m22[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include <stddef.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#include <stdint.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include <freerdp/crypto/certificate_store.h>[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:int [0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t* Data, size_t Size[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[1;39m{[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:      [0m[39mrdpCertificateData* data = NULL;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:      [0m[39mchar* pem = [0m[1;35mcalloc[0m[1;39m([0m[39mSize + [0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mchar[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:      [0m[39mif [0m[1;39m([0m[39mpem == NULL[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:     [0m[39m        [0m[39mgoto cleanup;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:     [0m[1;35mmemcpy[0m[1;39m([0m[39mpem, Data, Size[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:     [0m[39mdata = [0m[1;35mfreerdp_certificate_data_new_from_pem[0m[1;39m([0m[32m"somehost"[0m[39m, [0m[1;36m1234[0m[39m, pem, Size[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:     [0m[39m        [0m[39mgoto cleanup;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m17:c[0m[39mleanup:[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:     [0m[1;35mfreerdp_certificate_data_free[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:     [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:     [0m[39mreturn [0m[1;36m0[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1587[0m[39m-[0m[1;36m1642[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1587:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mconst rdpCertificate* cert, size_t* [0m      [2m                [0m
[2;36m                    [0m         [39mpLength,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1588[0m[39m:                                     BOOL withCertChain[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1589[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1590[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1591[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!cert->x509[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:   [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:   [0m[39m * Don't manage certificates internally, leave it up entirely to the [0m       [2m                [0m
[2;36m                    [0m         [39mexternal client[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:   [0m[39m * implementation[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:   [0m[39mBIO* bio = [0m[1;35mBIO_new[0m[1;39m([0m[1;35mBIO_s_mem[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!bio[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1602[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1603[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"BIO_new[0m[32m([0m[32m)[0m[32m failure"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1604[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1605[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1606[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1607[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1608[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1609[0m[39m:   [0m[39mconst int status = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, cert->x509[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1610[0m[39m:   [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1611[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1612[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, status[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1613[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1614[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1615[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1616[0m[39m:   [0m[39mif [0m[1;39m([0m[39mcert->chain && withCertChain[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1617[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1618[0m[39m:   [0m[39m        [0m[39mconst int count = [0m[1;35msk_X509_num[0m[1;39m([0m[39mcert->chain[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1619[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39mint x = [0m[1;36m0[0m[39m; x < count; x++[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1620[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1621[0m[39m:   [0m[39m        [0m[39m        [0m[39mX509* c = [0m[1;35msk_X509_value[0m[1;39m([0m[39mcert->chain, x[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1622[0m[39m:   [0m[39m        [0m[39m        [0m[39mconst int rc = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, c[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mrc < [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mrc[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:   [0m[35m/[0m[35m/[0m[39m Updated rfc to handle specific policy issues[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:   [0m[35m/[0m[35m/[0m[39m [0m[4;94mhttps://datatracker.ietf.org/doc/html/rfc7299[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:   [0m[39mif [0m[1;39m([0m[39m [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mcert, [0m[32m"2.23.140.1.2.1"[0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mbio_read_pem[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1639:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:   [0m[1;35mBIO_free_all[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:   [0m[39mreturn pem;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1351[0m[39m-[0m[1;36m1380[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1351[0m[39m:int [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mconst rdpCertificate* cert, const char* oid[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1352[0m[39m:    [0m[1;35mSTACK_OF[0m[1;39m([0m[39mPOLICYINFO[0m[1;39m)[0m[39m *policies;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1353[0m[39m:   [0m[39mint result = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1354[0m[39m:    int crit;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1355[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1356[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!cert->x509[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1357[0m[39m:   [0m[39m        [0m[39mreturn result;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1358[0m[39m:   [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1359[0m[39m:    [0m[35m/[0m[35m/[0m[39m Get certificate policies[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1360[0m[39m:    policies = [0m[1;35mX509_get_ext_d2i[0m[1;39m([0m[39mcert->x509, NID_certificate_policies, &crit, [0m  [2m                [0m
[2;36m                    [0m         [39mNULL[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1361[0m[39m:    if [0m[1;39m([0m[39m!policies[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1362[0m[39m:        return result;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1363[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1364[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1365[0m[39m:    for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35msk_POLICYINFO_num[0m[1;39m([0m[39mpolicies[0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1366[0m[39m:        POLICYINFO *policy = [0m[1;35msk_POLICYINFO_value[0m[1;39m([0m[39mpolicies, i[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1367[0m[39m:        if [0m[1;39m([0m[39mpolicy->policyid[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1368[0m[39m:            char buf[0m[1;39m[[0m[1;36m128[0m[1;39m][0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1369[0m[39m:            [0m[1;35mOBJ_obj2txt[0m[1;39m([0m[39mbuf, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m, policy->policyid, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1370[0m[39m:            if [0m[1;39m([0m[39m [0m[1;35mstrncmp[0m[1;39m([0m[39mbuf, oid, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1371[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mresult = [0m[1;36m1[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1372[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mbreak;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1373[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1374[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1375[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1376[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:    [0m[1;35msk_POLICYINFO_pop_free[0m[1;39m([0m[39mpolicies, POLICYINFO_free[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1378[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1379[0m[39m:   [0m[39mreturn result;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1380[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:37[0m[39m-[0m[1;36m49[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:struct rdp_certificate_data[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     [0m[39mchar* hostname;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     [0m[39mUINT16 port;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     [0m[39mrdpCertificate* cert;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     [0m[39mchar cached_hash[0m[1;39m[[0m[39mMAX_PATH + [0m[1;36m10[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     [0m[39mchar* cached_subject;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     [0m[39mchar* cached_issuer;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     [0m[39mchar* cached_fingerprint;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     [0m[39mchar* cached_pem;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     [0m[39mchar* cached_pem_chain;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1477[0m[39m-[0m[1;36m1527[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1477[0m[39m:static BOOL [0m[1;35mbio_read_pem[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* plength[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m1478[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1479[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1480[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1481[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1482[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1483[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1484[0m[39m:   [0m[39mconst size_t blocksize = [0m[1;36m2048[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1485[0m[39m:   [0m[39msize_t offset = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1486[0m[39m:   [0m[39msize_t length = blocksize;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39moffset < length[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:   [0m[39m        [0m[39mconst int status = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - [0m      [2m                [0m
[2;36m                    [0m         [39moffset[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mlength - offset > [0m[1;36m0[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1522:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1529[0m[39m-[0m[1;36m1580[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:static BOOL [0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mBIO* bio, char** ppem, size_t* [0m   [2m                [0m
[2;36m                    [0m         [39mplength[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:   [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:   [0m[39mint status = [0m[1;36m-1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mppem[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:   [0m[39mconst uint16_t blocksize = [0m[1;36m2048[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:   [0m[39muint16_t offset = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:   [0m[39muint16_t length = blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:   [0m[39m*ppem = NULL;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:   [0m[39m        [0m[39m*plength = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:   [0m[39mwhile [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:   [0m[39m        [0m[39mchar* tmp = [0m[1;35mrealloc[0m[1;39m([0m[39mpem, length + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:   [0m[39m        [0m[39mpem = tmp;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:   [0m[39m        [0m[1;35mERR_clear_error[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:   [0m[39m        [0m[39mstatus = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:   [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"failed to read certificate"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:   [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:   [0m[39m        [0m[39mif [0m[1;39m([0m[39mstatus == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:   [0m[39m        [0m[39m        [0m[39mbreak;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:   [0m[39m        [0m[39moffset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:   [0m[39m        [0m[39mlength += blocksize;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:   [0m[39mpem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:   [0m[39m*ppem = pem;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:   [0m[39mif [0m[1;39m([0m[39mplength[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:   [0m[39m        [0m[39m*plength = offset;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:   [0m[39mrc = TRUE;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;92m1575:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!rc[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:   [0m[39m        [0m[1;35mfree[0m[1;39m([0m[39mpem[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:   [0m[39mreturn rc;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1631[0m[39m-[0m[1;36m1637[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:   [0m[35m/[0m[35m/[0m[39m Updated rfc to handle specific policy issues[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:   [0m[35m/[0m[35m/[0m[39m [0m[4;94mhttps://datatracker.ietf.org/doc/html/rfc7299[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:   [0m[39mif [0m[1;39m([0m[39m [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mcert, [0m[32m"2.23.140.1.2.1"[0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mbio_read_pem[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate.[0m[1;92mc:1587[0m[39m-[0m[1;36m1642[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1587:c[0m[39mhar* [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mconst rdpCertificate* cert, size_t* [0m      [2m                [0m
[2;36m                    [0m         [39mpLength,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1588[0m[39m:                                     BOOL withCertChain[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1589[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1590[0m[39m:   [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mcert[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1591[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!cert->x509[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:   [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:   [0m[39m * Don't manage certificates internally, leave it up entirely to the [0m       [2m                [0m
[2;36m                    [0m         [39mexternal client[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:   [0m[39m * implementation[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:   [0m[39m *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:   [0m[39mBIO* bio = [0m[1;35mBIO_new[0m[1;39m([0m[1;35mBIO_s_mem[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m:   [0m[39mif [0m[1;39m([0m[39m!bio[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1602[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1603[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"BIO_new[0m[32m([0m[32m)[0m[32m failure"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1604[0m[39m:   [0m[39m        [0m[39mreturn NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1605[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1606[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1607[0m[39m:   [0m[39mchar* pem = NULL;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1608[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1609[0m[39m:   [0m[39mconst int status = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, cert->x509[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m1610[0m[39m:   [0m[39mif [0m[1;39m([0m[39mstatus < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1611[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1612[0m[39m:   [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, status[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1613[0m[39m:   [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1614[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1615[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1616[0m[39m:   [0m[39mif [0m[1;39m([0m[39mcert->chain && withCertChain[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1617[0m[39m:   [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1618[0m[39m:   [0m[39m        [0m[39mconst int count = [0m[1;35msk_X509_num[0m[1;39m([0m[39mcert->chain[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1619[0m[39m:   [0m[39m        [0m[39mfor [0m[1;39m([0m[39mint x = [0m[1;36m0[0m[39m; x < count; x++[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1620[0m[39m:   [0m[39m        [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1621[0m[39m:   [0m[39m        [0m[39m        [0m[39mX509* c = [0m[1;35msk_X509_value[0m[1;39m([0m[39mcert->chain, x[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m1622[0m[39m:   [0m[39m        [0m[39m        [0m[39mconst int rc = [0m[1;35mPEM_write_bio_X509[0m[1;39m([0m[39mbio, c[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:   [0m[39m        [0m[39m        [0m[39mif [0m[1;39m([0m[39mrc < [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[1;35mWLog_ERR[0m[1;39m([0m[39mTAG, [0m[32m"PEM_write_bio_X509 failure: %d"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mrc[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:   [0m[39m        [0m[39m        [0m[39m        [0m[39mgoto fail;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:   [0m[39m        [0m[39m        [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:   [0m[39m        [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:   [0m[35m/[0m[35m/[0m[39m Updated rfc to handle specific policy issues[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:   [0m[35m/[0m[35m/[0m[39m [0m[4;94mhttps://datatracker.ietf.org/doc/html/rfc7299[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:   [0m[39mif [0m[1;39m([0m[39m [0m[1;35mfreerdp_certificate_policies[0m[1;39m([0m[39mcert, [0m[32m"2.23.140.1.2.1"[0m[1;39m)[0m[39m [0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mfreerdp_bio_read_pem_with_policy[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:   [0m[39m        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[1;35mbio_read_pem[0m[1;39m([0m[39mbio, &pem, pLength[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m1639:fa[0m[39mil:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:   [0m[1;35mBIO_free_all[0m[1;39m([0m[39mbio[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:   [0m[39mreturn pem;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mlibfreerdp/crypto/certificate_data.[0m[1;92mc:68[0m[39m-[0m[1;36m100[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:static BOOL [0m[1;35mfreerdp_certificate_data_load_cache[0m[1;39m([0m[39mrdpCertificateData* data[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     [0m[39mBOOL rc = FALSE;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     [0m[1;35mWINPR_ASSERT[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     [0m[1;35mfreerdp_certificate_data_hash_[0m[1;39m([0m[39mdata->hostname, data->port, [0m                 [2m                [0m
[2;36m                    [0m         [39mdata->cached_hash,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     [0m[39m                               [0m[1;35msizeof[0m[1;39m([0m[39mdata->cached_hash[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     [0m[39mif [0m[1;39m([0m[1;35mstrnlen[0m[1;39m([0m[39mdata->cached_hash, [0m[1;35msizeof[0m[1;39m([0m[39mdata->cached_hash[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     [0m[39mdata->cached_subject = [0m[1;35mfreerdp_certificate_get_subject[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_subject[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     [0m[39m        [0m[39mdata->cached_subject = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     [0m[39msize_t pemlen = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     [0m[39mdata->cached_pem = [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mdata->cert, &pemlen, [0m     [2m                [0m
[2;36m                    [0m         [39mFALSE[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_pem[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     [0m[39msize_t pemchainlen = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     [0m[39mdata->cached_pem_chain = [0m[1;35mfreerdp_certificate_get_pem_ex[0m[1;39m([0m[39mdata->cert, [0m        [2m                [0m
[2;36m                    [0m         [39m&pemchainlen, TRUE[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_pem_chain[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     [0m[39mdata->cached_fingerprint = [0m[1;35mfreerdp_certificate_get_fingerprint[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_fingerprint[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     [0m[39m        [0m[39mgoto fail;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:     [0m[39mdata->cached_issuer = [0m[1;35mfreerdp_certificate_get_issuer[0m[1;39m([0m[39mdata->cert[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     [0m[39mif [0m[1;39m([0m[39m!data->cached_issuer[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     [0m[39m        [0m[39mdata->cached_issuer = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Root Cause Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is a **heap-buffer-overflow** caused by using `uint16_t` [0m[1;39m([0m[39mmaximum[0m [2m                [0m
[2;36m                    [0m         [39mvalue [0m[1;36m65[0m[39m,[0m[1;36m535[0m[1;39m)[0m[39m for buffer size tracking in the `freerdp_bio_read_pem_with_policy` [0m   [2m                [0m
[2;36m                    [0m         [39mfunction. When processing certificate data that exceeds ~65KB:[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The `offset` and `length` variables overflow due to `uint16_t` wraparound[0m        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. After ~[0m[1;36m32[0m[39m iterations of reading [0m[1;36m2[0m[39m,[0m[1;36m048[0m[39m-byte blocks, integer overflow occurs[0m       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The buffer is reallocated with a wrapped [0m[1;39m([0m[39msmall[0m[1;39m)[0m[39m size, but `offset` remains [0m     [2m                [0m
[2;36m                    [0m         [39mlarge[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Writing the null terminator at `pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m` writes beyond the allocated buffer [0m [2m                [0m
[2;36m                    [0m         [39mboundaries[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe bug is specifically triggered for certificates containing the OID [0m              [2m                [0m
[2;36m                    [0m         [32m"2.23.140.1.2.1"[0m[39m [0m[1;39m([0m[39mOrganization Validation certificates[0m[1;39m)[0m[39m, which are legitimate, [0m     [2m                [0m
[2;36m                    [0m         [39mcommonly-used enterprise certificates that often have longer certificate chains.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Fix Implementation Strategy[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Primary Fix: Type Correction in `freerdp_bio_read_pem_with_policy`**[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mApply changes to `[0m[35m/src/FreeRDP/libfreerdp/crypto/[0m[95mcertificate.c[0m[39m`, function [0m          [2m                [0m
[2;36m                    [0m         [39m`freerdp_bio_read_pem_with_policy` [0m[1;39m([0m[39mlines [0m[1;36m1529[0m[39m-[0m[1;36m1580[0m[1;39m)[0m[39m:[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1[0m[39m: Change variable type declarations [0m[1;39m([0m[39mlines [0m[1;36m1537[0m[39m-[0m[1;36m1539[0m[1;39m)[0m[39m**[0m                     [2m                [0m
[2;36m                    [0m         [39m- Change `const uint16_t blocksize = [0m[1;36m2048[0m[39m;` to `const size_t blocksize = [0m[1;36m2048[0m[39m;`[0m     [2m                [0m
[2;36m                    [0m         [39m- Change `uint16_t offset = [0m[1;36m0[0m[39m;` to `size_t offset = [0m[1;36m0[0m[39m;`[0m                             [2m                [0m
[2;36m                    [0m         [39m- Change `uint16_t length = blocksize;` to `size_t length = blocksize;`[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis directly mirrors the safe implementation in `bio_read_pem` [0m[1;39m([0m[39mlines [0m[1;36m1484[0m[39m-[0m[1;36m1486[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mand eliminates the integer overflow vulnerability.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m2[0m[39m: Improve loop safety [0m[1;39m([0m[39mline [0m[1;36m1546[0m[1;39m)[0m[39m**[0m                                         [2m                [0m
[2;36m                    [0m         [39m- Change `while [0m[1;39m([0m[39mstatus != [0m[1;36m0[0m[1;39m)[0m[39m` to `while [0m[1;39m([0m[39moffset < length[0m[1;39m)[0m[39m`[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis adds explicit bounds checking to prevent potential infinite loops and matches [0m [2m                [0m
[2;36m                    [0m         [39mthe safe implementation pattern.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m3[0m[39m: Add early exit optimization [0m[1;39m([0m[39mafter line [0m[1;36m1566[0m[1;39m)[0m[39m**[0m                           [2m                [0m
[2;36m                    [0m         [39m- After `offset += [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39mstatus;`, add:[0m                                           [2m                [0m
[2;36m                    [0m         [39m  ```c[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m  if [0m[1;39m([0m[39mlength - offset > [0m[1;36m0[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [39m      break;[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis prevents unnecessary reallocations when the buffer has remaining space and [0m    [2m                [0m
[2;36m                    [0m         [39mmatches the safe implementation.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m4[0m[39m: Adjust status variable declaration [0m[1;39m([0m[39mline [0m[1;36m1532[0m[1;39m)[0m[39m**[0m                          [2m                [0m
[2;36m                    [0m         [39m- Move `const int status = [0m[1;35mBIO_read[0m[1;39m([0m[39mbio, &pem[0m[1;39m[[0m[39moffset[0m[1;39m][0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[1;39m([0m[39mlength - offset[0m[1;39m)[0m[1;39m)[0m[39m;` [0m   [2m                [0m
[2;36m                    [0m         [39minside the loop to match the safe implementation pattern[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Justification[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why This is the Optimal Approach:**[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Minimal, Surgical Change**: The fix changes only the vulnerable function, [0m     [2m                [0m
[2;36m                    [0m         [39mminimizing risk to the broader codebase[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Proven Pattern**: The solution directly adopts the pattern from [0m               [2m                [0m
[2;36m                    [0m         [39m`bio_read_pem`, which is known to work correctly and has been in production use[0m     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Type Consistency**: Using `size_t` aligns with:[0m                                [2m                [0m
[2;36m                    [0m         [39m   - The function signature's `size_t* plength` parameter[0m                           [2m                [0m
[2;36m                    [0m         [39m   - The codebase's use of `size_t` for buffer lengths elsewhere[0m                    [2m                [0m
[2;36m                    [0m         [39m   - The rdpCertBlob structure's use of `UINT32 length`[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Standard C library conventions for memory sizes[0m                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **No Artificial Limits**: `size_t` can handle certificate chains of any [0m         [2m                [0m
[2;36m                    [0m         [39mpractical size [0m[1;39m([0m[39mup to system memory limits[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **API Contract Preservation**: The public API [0m[1;39m([0m[39m`freerdp_certificate_get_pem_ex`[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39malready promises arbitrary-sized output via `size_t* pLength` - this fix makes the [0m [2m                [0m
[2;36m                    [0m         [39mimplementation match that promise[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Preserves Existing Logic:**[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Same buffer management**: The realloc pattern remains unchanged[0m                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Same reading pattern**: BIO_read is called identically[0m                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Same error handling**: All error paths and cleanup remain the same[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Same output format**: Null-terminated PEM string with length tracking[0m          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Same API compatibility**: Function signatures, return values, and behavior [0m    [2m                [0m
[2;36m                    [0m         [39munchanged for all inputs that previously worked[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Backward compatible**: Certificates under 65KB continue to work identically; [0m  [2m                [0m
[2;36m                    [0m         [39mlarger certificates now work instead of causing crashes[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Addresses the Evaluation Report Issues:**[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Fixes the heap-buffer-overflow**: Eliminates integer overflow that caused the [0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m-byte write beyond buffer boundaries at line [0m[1;36m1570[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Handles the specific trigger**: Organization Validation certificates [0m[1;39m([0m[39mOID [0m     [2m                [0m
[2;36m                    [0m         [1;92m2.23.140.1[0m[39m.[0m[1;36m2.1[0m[1;39m)[0m[39m with large chains now work correctly[0m                                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Addresses the call stack**: The fix is applied at the exact failure point [0m     [2m                [0m
[2;36m                    [0m         [39midentified in the stack trace[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Resolves the fuzzer finding**: The fuzzer test will pass as it can now handle [0m [2m                [0m
[2;36m                    [0m         [39marbitrary-sized certificate data[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects and Mitigation:**[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Increased memory usage**: Large certificates will now allocate more memory[0m     [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: This is correct behavior - the API promises to handle [0m         [2m                [0m
[2;36m                    [0m         [39marbitrary certificates[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - Memory is properly freed on both success and failure paths[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Performance impact**: Slightly more overhead with size_t arithmetic on [0m[1;36m32[0m[39m-bit [0m [2m                [0m
[2;36m                    [0m         [39msystems[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: Negligible - certificate processing is not [0m                    [2m                [0m
[2;36m                    [0m         [39mperformance-critical, and the code already uses size_t in most places[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Integer cast warnings**: The BIO_read call casts size_t to int[0m                 [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: This is inherent to OpenSSL's BIO API which uses int. The [0m     [2m                [0m
[2;36m                    [0m         [39mblocksize of [0m[1;36m2048[0m[39m is well within int range, and the incremental reading pattern [0m    [2m                [0m
[2;36m                    [0m         [39mensures we never pass a value exceeding INT_MAX to BIO_read[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Similar Solutions in Codebase:**[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe safe `bio_read_pem` function [0m[1;39m([0m[39mlines [0m[1;36m1477[0m[39m-[0m[1;36m1527[0m[1;39m)[0m[39m demonstrates this exact pattern [0m [2m                [0m
[2;36m                    [0m         [39mhas been successfully used in the same file for the same purpose. The only [0m         [2m                [0m
[2;36m                    [0m         [39mdifference is the policy check determines which function is called - unifying them [0m [2m                [0m
[2;36m                    [0m         [39mensures consistent, safe behavior.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Alternative Consideration [0m[1;39m([0m[39mNot Recommended for Initial Fix[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Option: Remove Policy-Based Branching**[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWhile removing the policy check [0m[1;39m([0m[39mlines [0m[1;36m1631[0m[39m-[0m[1;36m1637[0m[1;39m)[0m[39m and always using `bio_read_pem` [0m  [2m                [0m
[2;36m                    [0m         [39mwould eliminate code duplication, this represents a larger functional change:[0m       [2m                [0m
[2;36m                    [0m         [39m- The policy check was added intentionally with an RFC [0m[1;36m7299[0m[39m reference[0m               [2m                [0m
[2;36m                    [0m         [39m- Removing it might affect behavior expected by other parts of the system[0m           [2m                [0m
[2;36m                    [0m         [39m- This should be considered as a follow-up refactoring after the security fix is [0m   [2m                [0m
[2;36m                    [0m         [39mvalidated[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Recommendation**: Apply the type fix first to resolve the security issue, then [0m   [2m                [0m
[2;36m                    [0m         [39mevaluate whether the policy-based branching is truly necessary in a separate code [0m  [2m                [0m
[2;36m                    [0m         [39mcleanup effort.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Testing Strategy[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying the fix:[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Fuzzer validation**: The TestFuzzCryptoCertificateDataSetPEM fuzzer should [0m    [2m                [0m
[2;36m                    [0m         [39mpass without heap-buffer-overflow[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Existing tests**: All existing unit tests should continue to pass unchanged[0m    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Manual testing**: Test with:[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Small certificates [0m[1;39m([0m[39m<10KB[0m[1;39m)[0m[39m - should work as before[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Large certificates [0m[1;39m([0m[39m>65KB[0m[1;39m)[0m[39m - should now work correctly[0m                         [2m                [0m
[2;36m                    [0m         [39m   - Certificate chains with [0m[1;36m5[0m[39m+ certificates - should now work correctly[0m            [2m                [0m
[2;36m                    [0m         [39m   - Certificates with and without OID [0m[1;92m2.23.140.1[0m[39m.[0m[1;36m2.1[0m[39m - both should work correctly[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/10/26 04:12:46][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=277208;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=524257;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=34630;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=843646;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpn0qhqqgf[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/freerdp_fp-delta-01_vuln_001/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768018366.169832[0m                                                       [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/freerdp_fp-delta-01_vuln_001.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-freerdp[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/10/26 04:12:48][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mfreerdp[0m        ]8;id=910532;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=604237;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=760457;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=889719;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mfreerdp[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=77101;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=371329;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mfreerdp[0m                [2m               [0m
