--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java
@@ -18,6 +18,7 @@
 
 import java.util.ArrayDeque;
 import java.util.Collections;
+import java.util.IdentityHashMap;
 import java.util.Iterator;
 import java.util.Queue;
 import org.apache.pdfbox.cos.COSArray;
@@ -180,6 +181,11 @@
     private final class PageIterator implements Iterator<PDPage>
     {
         private final Queue<COSDictionary> queue = new ArrayDeque<>();
+        
+        // To prevent infinite loops caused by circular references in malformed PDFs
+        // Must use IdentityHashMap for reference-based equality checking
+        private final Set<COSDictionary> visitedNodes = 
+                Collections.newSetFromMap(new IdentityHashMap<>());
 
         private PageIterator(COSDictionary node)
         {
@@ -205,6 +211,17 @@
          */
         private List<COSDictionary> enqueueKids(COSDictionary node)
         {
+            // Check for circular reference before processing
+            if (visitedNodes.contains(node))
+            {
+                LOG.error("Page tree node already visited, skipping to avoid infinite recursion");
+                return Collections.EMPTY_LIST;
+            }
+            
+            // Mark node as visited
+            visitedNodes.add(node);
+            
+            // Process the node
             if (isPageTreeNode(node))
             {
                 return getKids(node);
