--- a/src/reformat.c
+++ b/src/reformat.c
@@ -807,6 +807,13 @@
                         }else{
                             b = -1;
                         }
+                        // Add boundary checks to prevent out-of-bounds access
+                        if ((int)i + a < 0 || i + a >= image->width){
+                            a = 0;
+                        }
+                        if ((int)j + b < 0 || j + b >= image->height){
+                            b = 0;
+                        }
                         uspill_image[i][j] -= pSpillCb;
                         vspill_image[i][j] -= pSpillCb;
                         uspill_image[i+a][j] -= pSpillCb;
@@ -815,7 +822,7 @@
                         vspill_image[i][j+b] -= pSpillCr;
                         uspill_image[i+a][j+b] -= pSpillCb;
                         vspill_image[i+a][j+b] -= pSpillCr;
-                    }   
+                    }
                 }
             }
             // break out of iteration if improvement is small compared to the size of the image
